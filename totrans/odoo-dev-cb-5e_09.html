<html><head></head><body>
		<div><h1 id="_idParaDest-372" class="chapter-number"><a id="_idTextAnchor446"/>9</h1>
			<h1 id="_idParaDest-373"><a id="_idTextAnchor447"/>Backend Views</h1>
			<p>In all previous chapters, you have seen the server and database side of Odoo. In this chapter, you will see the UI side of Odoo. You will learn how to create different types of views. Aside from the views, this chapter also covers other components, such as action buttons, menus, and widgets, which will help you make your application more user-friendly. After completing this chapter, you will be able to design the UI of an Odoo backend. Note that this chapter does not cover the website part of Odoo; we have a separate chapter (<em class="italic">14</em>) for that.</p>
			<p>In this chapter, we will cover the following recipes:</p>
			<ul>
				<li>Adding a menu item and window actions</li>
				<li>Having an action open a specific view</li>
				<li>Adding content and widgets to a form view</li>
				<li>Adding buttons to forms</li>
				<li>Passing parameters to forms and actions – Context</li>
				<li>Defining filters on record lists – Domain</li>
				<li>Defining list views</li>
				<li>Defining search views</li>
				<li>Adding a search filter side panel</li>
				<li>Changing existing views – View inheritance</li>
				<li>Defining document-style forms</li>
				<li>Dynamic form elements using attributes</li>
				<li>Defining embedded views</li>
				<li>Displaying attachments on the side of the form view</li>
				<li>Defining kanban views</li>
				<li>Showing kanban cards in columns according to their state</li>
				<li>Defining calendar views</li>
				<li>Defining graph view and pivot view</li>
				<li>Defining the cohort view</li>
				<li>Defining the gantt view</li>
				<li>Defining the activity view</li>
				<li>Defining the map view</li>
			</ul>
			<h1 id="_idParaDest-374"><a id="_idTextAnchor448"/>Technical requirements</h1>
			<p>Throughout this chapter, we will assume that you have a database with the base add-on installed and an empty Odoo add-on module where you can add XML code from the recipes to a data file referenced in the add-on’s manifest. Refer to <a href="B20997_03.xhtml#_idTextAnchor083"><em class="italic">Chapter 3</em></a>, <em class="italic">Creating Odoo Add-On Modules</em>, for more information on how to activate changes in your add-on.</p>
			<p>The technical requirements for this chapter include an online Odoo platform.</p>
			<p>All of the code used in this chapter can be downloaded from the GitHub repository at <a href="https://github.com/PacktPublishing/Odoo-17-Development-Cookbook-Fifth-Edition/tree/main/Chapter09">https://github.com/PacktPublishing/Odoo-17-Development-Cookbook-Fifth-Edition/tree/main/Chapter09</a>.</p>
			<h1 id="_idParaDest-375"><a id="_idTextAnchor449"/>Adding a menu item and window actions</h1>
			<p>The most obvious way<a id="_idIndexMarker533"/> to make<a id="_idIndexMarker534"/> a new feature available to users is by adding a menu item. When you click on a <strong class="bold">Menu</strong> item, something happens. This recipe walks you through how to define that something.</p>
			<p>We will create a top-level menu and its sub-menu, which will open a list of all hostel rooms.</p>
			<p>This can also be done using the <strong class="bold">web user interface</strong> through the <strong class="bold">Settings</strong> menu, but we prefer to use XML data files since this is what we’ll have to use when creating our add-on modules.</p>
			<h2 id="_idParaDest-376"><a id="_idTextAnchor450"/>Getting ready</h2>
			<p>In this recipe, we will<a id="_idIndexMarker535"/> need a module<a id="_idIndexMarker536"/> with a dependency on the <code>base</code> module, as the <code>my_hostel</code> module adds new models to the <code>hostel.room</code>. So, if you are using an existing module, please add the <code>base</code> dependency in the manifest. Alternatively, you can grab the initial module from <a href="https://github.com/PacktPublishing/Odoo-17-Development-Cookbook-Fifth-Edition/tree/main/Chapter09/00_initial_module">https://github.com/PacktPublishing/Odoo-17-Development-Cookbook-Fifth-Edition/tree/main/Chapter09/00_initial_module</a>.</p>
			<h2 id="_idParaDest-377"><a id="_idTextAnchor451"/>How to do it...</h2>
			<p>In an XML data file of our add-on module, perform the following steps:</p>
			<ol>
				<li>Define an action to be executed:<pre class="source-code">
&lt;record id="action_hostel_room" model="ir.actions.act_window"&gt;
    &lt;field name="name"&gt;All Hostel Room&lt;/field&gt;
    &lt;field name="res_model"&gt;hostel.room&lt;/field&gt;
    &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Create the top-level menu, which will be as follows:<pre class="source-code">
    &lt;menuitem id="menu_custom_hostel_room"
    name="Hostel Room" web_icon="my_hostel,static/description/icon.png"/&gt;</pre></li>				<li>Refer to our action in the menu:<pre class="source-code">
&lt;menuitem id="menu_all_hostel_room"
    parent="menu_custom_hostel_room" action="action_hostel_room"       sequence="10" groups="" /&gt;</pre></li>			</ol>
			<p>If we now upgrade the module, we will see a top-level menu with the label <strong class="bold">Hostel Room</strong> that opens a sub-menu called <strong class="bold">All Hostel Room</strong>. Clicking on that menu item will open a list of all hostel rooms.</p>
			<h2 id="_idParaDest-378"><a id="_idTextAnchor452"/>How it works...</h2>
			<p>The first XML<a id="_idIndexMarker537"/> element, <code>record model="ir.actions.act_window"</code>, declares a window<a id="_idIndexMarker538"/> action to display a list view with all the hostel rooms. We used the most important attributes:</p>
			<ul>
				<li><code>name</code>: To be used as the title for the views opened by the action.</li>
				<li><code>res_model</code>: This is the model to be used. We are using <code>hostel.room</code>, where Odoo stores all <code>hostel room</code>.</li>
				<li><code>view_mode</code>: This lists the view types to make available. It is a comma-separated values file of the views type. The default value is <code>tree, form</code>, which makes a list and form view available. If you just want to show the calendar and form views, then the value of <code>view_mode</code> should be <code>calendar, form</code>. Other possible view choices are <code>kanban</code>, <code>graph</code>, <code>pivot</code>, <code>calendar</code>, and <code>cohort</code>. You will learn more about these views in forthcoming recipes.</li>
				<li><code>domain</code>: This is optional and allows you to set a filter on the records to be made available in the views. We will see all of these views in more detail in the <em class="italic">Defining filters on record lists – Domain</em> recipe of this chapter.</li>
				<li><code>context</code>: This can set values made available to the opened views, affecting their behavior. In our example, on new records, we want the room rank’s default value to be <code>1</code>. This will be covered in more depth in the <em class="italic">Passing parameters to forms and actions – Context</em> recipe of this chapter.</li>
				<li><code>limit</code>: This sets the default amount of records that can be seen on list views. In our example, we have given a limit of <code>20</code>, but if you don’t give a <code>limit</code> value, Odoo will use the default value of <code>80</code>.</li>
			</ul>
			<p>Next, we create the menu<a id="_idIndexMarker539"/> item hierarchy <a id="_idIndexMarker540"/>from the top-level menu to the clickable end menu item. The most important attributes of the <code>menuitem</code> element are as follows:</p>
			<ul>
				<li><code>name</code>: This is used as the text that the menu items display. If your menu item links to an action, you can leave this out because the action’s name will be used in that case.</li>
				<li><code>parent</code> (<code>parent_id</code> if using the <code>record</code> element): This is the XML ID that references the parent menu item. Items with no parents are top-level menus.</li>
				<li><code>action</code>: This is the XML ID that references the action to be called.</li>
				<li><code>sequence</code>: This is used to order the sibling menu items.</li>
				<li><code>groups</code> (<code>groups_id</code> with the <code>record</code> tag): This is an optional list of user groups that can access the menu item. If empty, it will be available to all users.</li>
				<li><code>web_icon</code>: This option only works on the top-level menu. It will display an icon of your application in the Enterprise edition.</li>
			</ul>
			<p>Window actions automatically determine the view to be used by looking up views for the target model with the intended type (<code>form</code>, <code>tree</code>, and so on) and picking the one with the lowest sequence number. <code>ir.actions.act_window</code> and <code>menuitem</code> are convenient shortcut XML tags that hide what you’re actually doing. If you don’t want to use the shortcut XML tags, then you can create a record of the <code>ir.actions.act_window</code> and <code>ir.ui.menu</code> models via the <code>&lt;record&gt;</code> tag. For example, if you want to load <code>act_window</code> with <code>&lt;record&gt;</code>, you can do so as follows:</p>
			<pre class="source-code">
&lt;record id="action_hostel_room" model="ir.actions.act_window"&gt;
    &lt;field name="name"&gt;All Hostel Room&lt;/field&gt;
    &lt;field name="res_model"&gt;hostel.room&lt;/field&gt;
    &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;
    &lt;field name="context"&gt;{'default_room_rating': 1.0}&lt;/field&gt;
    &lt;field name="domain"&gt;[('state', '=', 'draft')]&lt;/field&gt;
&lt;/record&gt;</pre>			<p>In the same way, you can create a <code>menuitem</code> instance through <code>&lt;record&gt;</code>.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Be aware that names used with the <code>menuitem</code> shortcut may not map to the field names that are used when using a <code>record</code> element; <code>parent</code> should be <code>parent_id</code> and <code>groups</code> should be <code>groups_id</code>.</p>
			<p>To build the menu, the web client<a id="_idIndexMarker541"/> reads all the<a id="_idIndexMarker542"/> records from <code>ir.ui.menu</code> and infers their hierarchy from the <code>parent_id</code> field. The menus are also filtered based on user permissions to models and groups assigned to menus and actions. When a user clicks on a menu item, its <code>action</code> is executed.</p>
			<h2 id="_idParaDest-379"><a id="_idTextAnchor453"/>There’s more…</h2>
			<p>Window actions also support a <code>target</code> attribute to specify how the view is to be presented. The possible choices are as follows:</p>
			<ul>
				<li><strong class="bold">current</strong>: This is the default and opens the view in the web client’s main content area.</li>
				<li><strong class="bold">new</strong>: This opens the view in a popup.</li>
				<li><code>current,</code> but it opens a form in edit mode and disables the <strong class="bold">Action</strong> menu.</li>
				<li><strong class="bold">Fullscreen</strong>: The action will cover the whole browser window, so this will overlay <a id="_idIndexMarker543"/>the menus, too. Sometimes, this is called <strong class="bold">tablet mode</strong>.</li>
				<li><strong class="bold">main</strong>: This is like <strong class="bold">current</strong>, but it also clears out the breadcrumbs.</li>
			</ul>
			<p>There are also some additional attributes available for window actions that are not supported by the <code>ir.actions.act_window</code> shortcut tag. To use them, we must use the <code>record</code> element with the following fields:</p>
			<ul>
				<li><code>res_id</code>: If opening a form, you can use it to open a specific record by setting its ID here. This can be useful for multi-step wizards or in cases when you have to view or edit a specific record frequently.</li>
				<li><code>search_view_id</code>: This specifies a specific search view to use for tree and graph views.</li>
			</ul>
			<p>Keep in mind that the menu in the top left (or the apps icon in the Enterprise version) and the menu in the bar at the top are both made up of menu items. The only difference is that the items in the menu in the top left don’t have any parent menus, while the ones on the top bar have the respective menu items from the top bar as a parent. In the left bar, the hierarchical structure is more obvious.</p>
			<p>Additionally, bear in mind that for design reasons, the first-level menus will open the dropdown menu if your second-level menu has child menus. In any case, Odoo will open the first menu item’s action based on the sequence of child menu items.</p>
			<p>Refer to the following to learn more<a id="_idIndexMarker544"/> about menus<a id="_idIndexMarker545"/> and views:</p>
			<ul>
				<li>The <code>ir.actions.act_window</code> action type is the most common action type, but a menu can refer to any type of action. Technically, it is the same if you link to a client action, a server action, or any other model defined in the <code>ir.actions.*</code> namespace. It just differs in what the backend makes of the action.</li>
				<li>If you need just a tiny bit more flexibility in the concrete action to be called, look into server actions that return a window action. If you need complete flexibility, take a look at the client actions (<code>ir.actions.client</code>), which allow you to have a completely custom user interface. However, only do this as a last resort as you lose a lot of Odoo’s convenient helpers when using them.</li>
			</ul>
			<h2 id="_idParaDest-380"><a id="_idTextAnchor454"/>See also</h2>
			<ul>
				<li>For a detailed explanation of filters in all of the views, have a look at the <em class="italic">Defining filters on record lists – Domain</em> recipe in this chapter.</li>
			</ul>
			<h1 id="_idParaDest-381"><a id="_idTextAnchor455"/>Having an action open a specific view</h1>
			<p>Window actions automatically determine<a id="_idIndexMarker546"/> the view to be used if none is given, but sometimes, we want an action to open a specific view.</p>
			<p>We will create a basic form view for the <code>hostel.room</code> model, and then we will create a new window action specifically to open that form view.</p>
			<h2 id="_idParaDest-382"><a id="_idTextAnchor456"/>How to do it...</h2>
			<ol>
				<li>Define the <code>hostel room</code> minimal tree and form view:<pre class="source-code">
<strong class="bold">&lt;record id="hostel_room_view_tree" model="ir.ui.view"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;Hostel Room List&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    </strong><strong class="bold">&lt;field name="arch" type="xml"&gt;</strong>
<strong class="bold">        &lt;tree&gt;</strong>
<strong class="bold">        &lt;field name="name"/&gt;</strong>
<strong class="bold">            &lt;field name="room_no"/&gt;</strong>
<strong class="bold">            &lt;field name="state"/&gt;</strong>
<strong class="bold">        &lt;/tree&gt;</strong>
<strong class="bold">    &lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong>
<strong class="bold">&lt;record id="hostel_room_view_form" model="ir.ui.view"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;Hostel Room Form&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    </strong><strong class="bold">&lt;field name="arch" type="xml"&gt;</strong>
<strong class="bold">        &lt;form&gt;</strong>
<strong class="bold">            &lt;header&gt;</strong>
<strong class="bold">                &lt;button name="make_available" string="Make Available" type="object"/&gt;</strong>
<strong class="bold">                &lt;button name="make_closed"  string="Make Closed" type="object"/&gt;</strong>
<strong class="bold">                &lt;field name="state" widget="statusbar"/&gt;</strong>
<strong class="bold">            &lt;/header&gt;</strong>
<strong class="bold">            &lt;group&gt;</strong>
<strong class="bold">                &lt;group&gt;</strong>
<strong class="bold">                    </strong><strong class="bold">&lt;field name="name"/&gt;</strong>
<strong class="bold">                    &lt;field name="room_no"/&gt;</strong>
<strong class="bold">                &lt;/group&gt;</strong>
<strong class="bold">                &lt;group&gt;</strong>
<strong class="bold">                    &lt;field name="description"/&gt;</strong>
<strong class="bold">                &lt;/group&gt;</strong>
<strong class="bold">            &lt;/group&gt;</strong>
<strong class="bold">        &lt;/form&gt;</strong>
<strong class="bold">    &lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Update the action<a id="_idIndexMarker547"/> from the <em class="italic">Adding a menu item and window action</em> recipe to use a new form view:<pre class="source-code">
<strong class="bold">&lt;record id="action_hostel_room_tree" model="ir.actions.act_window.view"&gt;</strong>
<strong class="bold">    &lt;field name="act_window_id" ref="action_hostel_room" /&gt;</strong>
<strong class="bold">    &lt;field name="view_id" ref="hostel_room_view_tree" /&gt;</strong>
<strong class="bold">    &lt;field name="view_mode"&gt;tree&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="sequence" eval="1"/&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong>
<strong class="bold">&lt;record id="action_hostel_room_form" model="ir.actions.act_window.view"&gt;</strong>
<strong class="bold">    &lt;field name="act_window_id" ref="action_hostel_room" /&gt;</strong>
<strong class="bold">    &lt;field name="view_id" ref="hostel_room_view_form" /&gt;</strong>
<strong class="bold">    &lt;field name="view_mode"&gt;form&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="sequence" eval="2"/&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>			</ol>
			<p>Now, if you open your menu<a id="_idIndexMarker548"/> and click on a <strong class="bold">partner</strong> in the list, you should see the very minimal form and tree that we just defined.</p>
			<h2 id="_idParaDest-383"><a id="_idTextAnchor457"/>How it works...</h2>
			<p>This time, we used the generic XML code for any type of record, that is, the <code>record</code> element with the required <code>id</code> and <code>model</code> attributes. The <code>id</code> attribute on the <code>record</code> element is an arbitrary string that must be unique for your add-on. The <code>model</code> attribute refers to the name of the model you want to create. Given that we want to create a view, we need to create a record of the <code>ir.ui.view</code> model. Within this element, you set fields as defined in the model you chose through the <code>model</code> attribute. For <code>ir.ui.view</code>, the crucial fields are <code>model</code> and <code>arch</code>. The <code>model</code> field contains the model for which you want to define a view, while the <code>arch</code> field contains the definition of the view itself. We’ll come to its contents in a short while.</p>
			<p>The <code>name</code> field, while not strictly necessary, is helpful when debugging problems with views. So, set it to a string that tells you what this view is intended to do. This field’s content is not shown to the user, so you can fill in any technical hints that you deem sensible. If you set nothing<a id="_idIndexMarker549"/> here, you’ll get a default name that contains the model name and view type.</p>
			<h3>ir.actions.act_window.view</h3>
			<p>The second record<a id="_idIndexMarker550"/> we defined works in tandem with <code>act_window</code>, which we defined earlier in the <em class="italic">Adding a menu item and window action</em> recipe. We already know that by setting the <code>view_id</code> field there, we can select which view is used for the first view mode. However, given that we set the <code>view_mode</code> field to the <code>tree, form</code> view, <code>view_id</code> would have to pick a tree view, but we want to set the form view, which comes second here.</p>
			<p>If you find yourself in a situation like this, use the <code>ir.actions.act_window.view</code> model, which gives you fine-grained control over which views to load for which view type. The first two fields defined here are examples of the generic way to refer to other objects; you keep the element’s body empty but add an attribute called <code>ref</code>, which contains the XML ID of the object you want to reference. So, what happens here is we refer to our action from the previous recipe in the <code>act_window_id</code> field and refer to the view we just created in the <code>view_id</code> field. Then, though not strictly necessary, we add a sequence number to position this view assignment relative to the other view assignments for the same action. This is only relevant if you assign views for different view modes by creating multiple <code>ir.actions.act_window.view</code> records.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Once you define the <code>ir.actions.act_window.view</code> records, they take precedence over what you filled in the action’s <code>view_mode</code> field. So, with the preceding records, you won’t see a list at all, but only a form. You should add another <code>ir.actions.act_window.view</code> record that points to a list view for the <code>hostel.room</code> model.</p>
			<h2 id="_idParaDest-384"><a id="_idTextAnchor458"/>There’s more...</h2>
			<p>As we saw in the <em class="italic">Adding a menu item and window action</em> recipe, we can replace <code>act_window</code> with <code>&lt;record&gt;</code>. If you want to use a custom view, you can follow the given syntax:</p>
			<pre class="source-code">
&lt;record id="action_hostel_room" model="ir.actions.act_window"&gt;
    &lt;field name="name"&gt;All Hostel Room&lt;/field&gt;
    &lt;field name="res_model"&gt;hostel.room&lt;/field&gt;
    &lt;field name="view_id" ref="hostel_room_view_tree"/&gt;
    &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;
&lt;/record&gt;</pre>			<p>This example is just an alternative to <code>act_window</code>. In the code base of Odoo, you will find both types of action.</p>
			<h1 id="_idParaDest-385"><a id="_idTextAnchor459"/>Adding content and widgets to a form view</h1>
			<p>The preceding recipe<a id="_idIndexMarker551"/> showed how to pick<a id="_idIndexMarker552"/> a specific view<a id="_idIndexMarker553"/> for an<a id="_idIndexMarker554"/> action. Now, we’ll demonstrate how to make the form view more useful. In this recipe, we will use the <strong class="bold">form view</strong> that we defined earlier in the <em class="italic">Having an action open a specific view</em> recipe. In the form view, we will add the widgets and content.</p>
			<h2 id="_idParaDest-386"><a id="_idTextAnchor460"/>How to do it...</h2>
			<ol>
				<li>Define the basic structure of the form view:<pre class="source-code">
&lt;record id="hostel_room_view_form" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Form&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
    &lt;form&gt;
        &lt;!--form content goes here --&gt;
    &lt;/form&gt;
&lt;/record&gt;</pre></li>				<li>To add a head<a id="_idIndexMarker555"/> bar, which is usually <a id="_idIndexMarker556"/>used for action<a id="_idIndexMarker557"/> buttons<a id="_idIndexMarker558"/> and stage pipelines, add this inside the form:<pre class="source-code">
&lt;header&gt;
    &lt;button name="make_available" string="Make Available" type="object"/&gt;
    &lt;button name="make_closed"  string="Make Closed" type="object"/&gt;
    &lt;field name="state" widget="statusbar"/&gt;
&lt;/header&gt;</pre></li>				<li>Add fields to the form, using <code>group</code> tags to organize them visually:<pre class="source-code">
&lt;group string="Content" name="my_content"&gt;
    &lt;field name="name"/&gt;
    &lt;field name="room_no"/&gt;
&lt;/group&gt;
&lt;group&gt;
    &lt;field name="description"/&gt;
&lt;/group&gt;
&lt;notebook&gt;
    &lt;page string="Other Information" name="other_information"&gt;
        &lt;field name="other_info" widget="html"/&gt;
    &lt;/page&gt;
&lt;/notebook&gt;</pre></li>			</ol>
			<p>Now, the form should display a top bar with a button and two vertically aligned fields, as shown in the following screenshot:</p>
			<div><div><img src="img/B20997_09_1.jpg" alt="Figure 9.1 – Screenshot of the form view"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.1 – Screenshot of the form view</p>
			<h2 id="_idParaDest-387"><a id="_idTextAnchor461"/>How it works...</h2>
			<p>We’ll look at<a id="_idIndexMarker559"/> the <code>arch</code> field<a id="_idIndexMarker560"/> of the <code>ir.ui.view</code> model<a id="_idIndexMarker561"/> first. First, note<a id="_idIndexMarker562"/> that views are defined in XML, so you need to pass the <code>type="xml"</code> attribute for the <code>arch</code> field; otherwise, the parser will be confused. It is also mandatory that your view definition contains well-formed XML; otherwise, you’ll get an error such as “Element odoo has extra content” when you upgrade/install the module.</p>
			<p>We’ll now walk through the tags that we used previously and summarize the others that are available.</p>
			<h3>form</h3>
			<p>When you define a form<a id="_idIndexMarker563"/> view, it is mandatory that the first element within the <code>arch</code> field is a <code>form</code> element. This is used internally to derive the record’s <code>type</code> field.</p>
			<p>In addition to the following elements, you can use arbitrary HTML within the form tag. The algorithm has it that every element unknown to Odoo is considered plain HTML and is simply passed through to the browser. Be careful with that, as the HTML you fill in can interact with the HTML code the Odoo <a id="_idIndexMarker564"/>elements generate, which might distort the rendering.</p>
			<h3>header</h3>
			<p>This element is a container for elements <a id="_idIndexMarker565"/>that should be shown in a form’s header, which is rendered as a white bar. Usually, as in this example, you place action buttons here. Alternatively, if your model has a <code>state</code> field, you could opt for a <strong class="bold">status bar</strong>.</p>
			<h3>button</h3>
			<p>The <code>button</code> element is used to allow<a id="_idIndexMarker566"/> the user to trigger an action. Refer to the <em class="italic">Adding buttons to forms</em> recipe for details.</p>
			<h3>&lt;group&gt;</h3>
			<p>The <code>&lt;group&gt;</code> element is Odoo’s main element <a id="_idIndexMarker567"/>and is used for organizing content. Fields placed within a <code>&lt;group&gt;</code> element are rendered with their title, and all fields within the same group are aligned so that there’s also a visual indicator that they belong together. You can also nest <code>&lt;group&gt;</code> elements; this causes Odoo to render the contained fields in adjacent columns.</p>
			<p>In general, you should use the <code>&lt;group&gt;</code> mechanism to display all of your fields in the form view and only revert to the other elements, such as <code>&lt;notebook&gt;</code>, <code>&lt;label&gt;</code>, <code>&lt;newline&gt;</code>, and more, when necessary.</p>
			<p>If you assign the <code>string</code> attribute to a group, its content will be rendered as a heading for the group.</p>
			<p>You should develop the habit of assigning a name to every logical group of fields, too. This name is not visible to the user but is very helpful when we override views in the following recipes. Keep the name unique within the form definition to avoid confusion about which group you refer to. Don’t use the <code>string</code> attribute for this because the value of the string will eventually change because of translations.</p>
			<h3>field</h3>
			<p>In order to actually show and manipulate<a id="_idIndexMarker568"/> data, your form view should contain some <code>field</code> elements. Here is an example:</p>
			<pre class="source-code">
&lt;field name="other_info" widget="html"/&gt;</pre>			<p>These have one mandatory attribute, called <code>name</code>, which refers to the field’s name in the model. Earlier, we offered the user the ability to edit the partner’s categories. If we only want to disable the editing feature on a field, we can set the <code>readonly</code> attribute to <code>1</code> or <code>True</code>. This attribute may actually contain a small subset of Python code, so <code>readonly="2&gt;1"</code> will make the field read-only too. This also applies to the <code>invisible</code> attribute, for which you used to obtain a value that is read from the database but is not shown to the user. Later, we’ll take a look at which situations this can be used in.</p>
			<p>You must have noticed the <code>widget</code> attribute in the <code>categories</code> field. This defines how the data in the field are supposed to be presented to the user. Every type of field has a standard widget, so you don’t have to explicitly choose a widget. However, several types provide multiple ways of representation, so you might opt for something other than the default. As a complete list of available widgets would exceed the scope of this recipe, consult <strong class="bold">Odoo’s source code</strong> to try them out. Take a look at <a href="B20997_14.xhtml#_idTextAnchor734"><em class="italic">Chapter 14</em></a>, <em class="italic">CMS Website Development</em>, for details on how to make your own.</p>
			<h3>&lt;notebook&gt; and &lt;page&gt;</h3>
			<p>If your model<a id="_idIndexMarker569"/> has too many<a id="_idIndexMarker570"/> fields, then you can use the <code>&lt;notebook&gt;</code> and <code>&lt;page&gt;</code> tags to create tabs. Each <code>&lt;page&gt;</code> in the <code>&lt;notebook&gt;</code> tag will create a new tab, and the content inside the page will be the tab content. The following example will create two tabs with three fields in each tab:</p>
			<pre class="source-code">
&lt;notebook&gt;
    &lt;page string="Tab 1"&gt;
        &lt;field name="field1"/&gt;
        &lt;field name="field2"/&gt;
        &lt;field name="field3"/&gt;
    &lt;/page&gt;
    &lt;page string="Tab 2"&gt;
        &lt;field name="field4"/&gt;
        &lt;field name="field5"/&gt;
        &lt;field name="field6"/&gt;
    &lt;/page&gt;
&lt;/notebook&gt;</pre>			<p>The <code>string</code> attribute in the <code>&lt;page&gt;</code> tag will be the name of the tab. You can only use <code>&lt;page&gt;</code> tags in the <code>&lt;notebook&gt;</code> tag, but in the <code>&lt;page&gt;</code> tag, you <a id="_idIndexMarker571"/>can use any other<a id="_idIndexMarker572"/> elements.</p>
			<h3>General attributes</h3>
			<p>On most elements (this includes <code>group</code>, <code>field</code>, and <code>button</code>), you <a id="_idIndexMarker573"/>can set the <code>attributes</code> and <code>groups</code> attributes. Here is a small example:</p>
			<pre class="source-code">
&lt;field name="other_info"
    readonly="state == 'available'"
    groups="base.group_no_one"/&gt;</pre>			<p>While <code>attributes</code> are discussed in the <em class="italic">Dynamic form elements using attributes</em> recipe, the <code>groups</code> attribute gives you the possibility to show some elements only to members of certain groups. Simply put, the group’s full XML ID (separated by commas for multiple groups) is the attribute, and the element will be hidden for everyone who is not a member of at least one of the groups mentioned.</p>
			<h3>Other tags</h3>
			<p>There are situations<a id="_idIndexMarker574"/> in which you might want to deviate from the strict layout groups prescribed. For example, if you want the <code>name</code> field of a record to be rendered as a heading, the field’s label will interfere with the appearance. In this case, don’t put your field into a <code>group</code> element but, instead, put it into a plain HTML <code>h1</code> element. Then, before the <code>h1</code> element, put a <code>label</code> element with the <code>for</code> attribute set to your <code>field name</code>:</p>
			<pre class="source-code">
&lt;label for="name" /&gt;
&lt;h1&gt;&lt;field name="name" /&gt;&lt;/h1&gt;</pre>			<p>This will be rendered with the field’s content as a big heading, but the field’s name will be written in a smaller type above the big heading. This is basically what the standard partner form does.</p>
			<p>If you need a line break within a group, use the <code>newline</code> element. It’s always empty:</p>
			<pre class="source-code">
&lt;newline /&gt;</pre>			<p>Another useful element is <code>footer</code>. When you open a form as a popup, this is a good place to put the action buttons. It will be rendered as a separate bar too, analogous to the <code>header</code> element.</p>
			<p>The form view also has special widgets, such as <code>web_ribbon</code>. You can use it with the <code>&lt;widget&gt;</code> tag as follows:</p>
			<pre class="source-code">
&lt;widget name="web_ribbon" title="Archived" bg_color="bg-danger"
invisible="active"/&gt;</pre>			<p>You can use <code>attributes</code> to hide and show the ribbon based on a condition. Don’t worry if you are not aware of <code>attributes</code>. It will be covered in the <em class="italic">Dynamic form elements using attributes</em> recipe<a id="_idIndexMarker575"/> of this chapter.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Don’t address <code>string</code> attribute (or any other translated attribute, for that matter), as your view overrides will break for other languages because views are translated before inheritance is applied.</p>
			<h2 id="_idParaDest-388"><a id="_idTextAnchor462"/>There’s more…</h2>
			<p>Since form views are basically HTML with some extensions, Odoo also makes extensive use of CSS classes. Two very useful ones are <code>oe_read_only</code> and <code>oe_edit_only</code>. Elements with<a id="_idIndexMarker576"/> these classes<a id="_idIndexMarker577"/> will be visible only in <strong class="bold">read-only mode</strong> or <strong class="bold">edit mode</strong>, respectively. For example, to have the label visible only in edit mode, use the following:</p>
			<pre class="source-code">
&lt;label f"r="n"me" cla"s="oe_edit_o"ly" /&gt;</pre>			<p>Another very useful class is <code>oe_inline</code>, which you can use on fields to make them render as an inline element to avoid causing unwanted line breaks. Use this class when you embed a field into text or other markup tags.</p>
			<p>Furthermore, the <code>form</code> element can have the <code>create</code>, <code>edit</code>, and <code>delete</code> attributes. If you set one of these to <code>false</code>, the corresponding action ’on’t be available for this form. Without this being explicitly set, the availability of the action is inferred from the u’er’s permissions. Note that this is purely for straightening up the UI; ’on’t use this for security.</p>
			<h2 id="_idParaDest-389"><a id="_idTextAnchor463"/>See also</h2>
			<p>The widgets and views already offer a lot of functionality, but sooner or later, you will have requirements that cannot be fulfilled with the existing widgets and views. Refer to the following recipes to create your own views and widgets:</p>
			<ul>
				<li>Refer to the <em class="italic">Adding buttons to forms</em> recipe in this chapter for more details about using the <code>button</code> element to trigger an action.</li>
				<li>To define your own widgets, refer to the <em class="italic">Creating custom widgets</em> recipe of <a href="B20997_15.xhtml#_idTextAnchor861"><em class="italic">Chapter 15</em></a>, <em class="italic">Web </em><em class="italic">Client Development</em>.</li>
				<li>Refer to the <em class="italic">Creating a new view</em> recipe of <a href="B20997_15.xhtml#_idTextAnchor861"><em class="italic">Chapter 15</em></a>, <em class="italic">Web Client Development</em>, to create your own view.</li>
			</ul>
			<h1 id="_idParaDest-390"><a id="_idTextAnchor464"/>Adding buttons to forms</h1>
			<p><code>header</code> element.</p>
			<h2 id="_idParaDest-391"><a id="_idTextAnchor465"/>How to do it...</h2>
			<p>Add a button that refers to an action:</p>
			<pre class="source-code">
&lt;button type="action" name="%(my_hostel.hostel_room_category_action)d" string="Open Hotel Room Category" /&gt;</pre>			<h2 id="_idParaDest-392"><a id="_idTextAnchor466"/>How it works...</h2>
			<p>The button’s <code>type</code> attribute determines<a id="_idIndexMarker580"/> the semantics<a id="_idIndexMarker581"/> of the other fields, so we’ll first take a look at the possible values:</p>
			<ul>
				<li><code>action</code>: This makes the button call an action, as defined in the <code>ir.actions.*</code> namespace. The <code>name</code> attribute needs to contain the action’s database ID, which you can conveniently have Odoo look up with a Python-format string that contains the XML ID of the action in question.</li>
				<li><code>object</code>: This calls a method from the current model. The <code>name</code> attribute contains the function’s name.</li>
				<li><code>string</code>: The <code>string</code> attribute is used to assign the text the user sees.</li>
			</ul>
			<h2 id="_idParaDest-393"><a id="_idTextAnchor467"/>There’s more...</h2>
			<p>Use the <code>btn-primary</code> CSS classes to render highlighted button and <code>btn-default</code> to render a normal button. This is commonly used for cancel buttons in wizards or to offer secondary actions in a visually unobtrusive way. Setting the <code>oe_link</code> class causes the button to look like a link. You can also use other bootstrap button classes to get different button colors.</p>
			<p>A call with a button of the <strong class="bold">object</strong> type can return a dictionary that describes an action, which will then be executed on the client side. This way, you can implement multiscreen wizards or just open another record.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Note that clicking on a button always causes the client to issue a <code>write</code> or <code>create</code> call before running the method.</p>
			<p>You can also add content within the <code>button</code> tag by replacing the <code>string</code> attribute. This is commonly used in button boxes, as described in the <em class="italic">Document style </em><em class="italic">forms</em> recipe.</p>
			<h1 id="_idParaDest-394"><a id="_idTextAnchor468"/>Passing parameters to forms and actions – context</h1>
			<p>Internally, every method<a id="_idIndexMarker582"/> in Odoo has<a id="_idIndexMarker583"/> access to a dictionary<a id="_idIndexMarker584"/> called <strong class="bold">context</strong>, which <a id="_idIndexMarker585"/>is propagated<a id="_idIndexMarker586"/> from every action to the methods involved in delivering that action. The UI also has access to it, and it can be modified in various ways by setting values in the context. In this recipe, we’ll explore some of the applications of this mechanism by toying with the language, default values, and implicit filters.</p>
			<h2 id="_idParaDest-395"><a id="_idTextAnchor469"/>Getting ready</h2>
			<p>While not strictly necessary, this recipe will be more fun if you install the French language if you haven’t got this already. Consult <a href="B20997_11.xhtml#_idTextAnchor595"><em class="italic">Chapter 11</em></a>, <em class="italic">Internationalization</em>, for how to do this. If you have a French database, change <code>fr_FR</code> to some other language, e.g., <code>en_US</code> will do for English. Additionally, click on the <strong class="bold">Active</strong> button (changing to <strong class="bold">Archive</strong> when you hover over it) for one of the hostel rooms in order to archive it and verify that this partner doesn’t show up in the list anymore.</p>
			<h2 id="_idParaDest-396"><a id="_idTextAnchor470"/>How to do it...</h2>
			<ol>
				<li>Create a new action, very similar to the one from the <em class="italic">Adding a menu item and window </em><em class="italic">action</em> recipe:<pre class="source-code">
<strong class="bold">&lt;record id="action_hostel_room" model="ir.actions.act_window"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;All Hostel Room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="res_model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    </strong><strong class="bold">&lt;field name="view_id" ref="hostel_room_view_tree"/&gt;</strong>
<strong class="bold">    &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="context"&gt;{'lang': 'fr_FR','default_lang': 'fr_FR', 'active_test': False, 'default_room_rating': 1.0}&lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Add a menu that calls this action. This is left as an exercise for the reader.</li>
			</ol>
			<p>When you open this<a id="_idIndexMarker587"/> menu, the views<a id="_idIndexMarker588"/> will show<a id="_idIndexMarker589"/> up in<a id="_idIndexMarker590"/> French, and if you create a new partner, they will have French as their pre-selected language. A less obvious difference is that you will also see <strong class="bold">deactivated (archived) </strong><strong class="bold">partner records</strong>.</p>
			<h2 id="_idParaDest-397"><a id="_idTextAnchor471"/>How it works...</h2>
			<p>The context dictionary is populated from several sources. First, some values from the current user’s record (<code>lang</code> and <code>tz</code> for the user’s language and the user’s time zone, respectively) are read. Then, we have some add-ons that add keys for their own purposes. Furthermore, the UI adds keys about which model and which record we’re busy using at the moment (<code>active_id</code>, <code>active_ids</code>, <code>active_model</code>). Moreover, as seen in the <em class="italic">Having an action open a specific view</em> recipe, we can add our own keys in actions. These are merged together and passed to the underlying server functions and the client-side UI.</p>
			<p>So, by setting the <code>lang</code> context key, we force the display language to be <strong class="bold">French</strong>. You will note that this doesn’t change the whole UI language; this is because only the list view that we open lies within the scope of this context. The rest of the UI was loaded already with another context that contained the user’s original language. However, if you open a record in this list view, it will be presented in French, too, and if you open a linked record on the form or press a button that executes an action, the language will be propagated, too.</p>
			<p>By setting <code>default_lang</code>, we set a default value for every record created within the scope of this context. The general pattern is <code>default_$fieldname: my_default_value</code>, which enables you to set default values for newly created partners in this case. Given that our menu is about hostel rooms, we have added <code>default_room_rating: 1</code> as the value for the <code>Hostel Average Rating</code> field by default. However, this is a model-wide default for <code>hostel.room</code>, so this wouldn’t have changed anything. For scalar fields, the syntax for this is the same as what you would write in Python code: <code>string</code> fields go in quotes, <code>number</code> fields stay as they are, and <code>Boolean</code> fields are either <code>True</code> or <code>False</code>. For relational fields, the syntax is slightly more complicated; refer to <a href="B20997_06.xhtml#_idTextAnchor319"><em class="italic">Chapter 6</em></a>, <em class="italic">Managing Module Data</em>, to learn how to write them.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Note that the default values set in the context override the default values set in the model definition, so you can have different default values in different situations.</p>
			<p>The last key is <code>active_test</code>, which has very special semantics. For every model that has a field called <code>active</code>, Odoo automatically filters out records where this field is <code>False</code>. This is why the partner from where<a id="_idIndexMarker591"/> you unchecked this field disappeared<a id="_idIndexMarker592"/> from the list. By setting<a id="_idIndexMarker593"/> this key, we can suppress<a id="_idIndexMarker594"/> this behavior.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">This is useful for the UI in its own right but even more useful in your Python code when you need to ensure that an operation is applied to all the records, not just the active ones.</p>
			<h2 id="_idParaDest-398"><a id="_idTextAnchor472"/>There’s more...</h2>
			<p>When defining a context, you have access to some variables, with the most important one being <code>uid</code>, which evaluates the current user’s ID. You’ll need this to set default filters (refer to the next recipe, <em class="italic">Defining filters on record lists – Domain</em>). Furthermore, you have access to the <code>context_today</code> function and the <code>current_date</code> variable, where the first is a <code>date</code> object that represents the current date, as seen from the user’s time zone, and the latter is the current date, as seen in UTC, formatted as <code>YYYY-MM-DD</code>. To set a default value for a <code>date</code> field to the current date, use <code>current_date</code>, and for default filters, use <code>context_today()</code>.</p>
			<p>Furthermore, you can do some date calculations with a subset of Python’s <code>datetime</code>, <code>time</code>, and <code>relativedelta</code> classes.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Most of the domains are evaluated on the client side. The server-side domain evaluation is restricted for security reasons. When client-side evaluation<a id="_idIndexMarker595"/> was introduced, the best option in order to not break the whole system was to implement a part of Python in JavaScript. There is a small JavaScript Python interpreter built into Odoo that works well for simple expressions, and that is usually enough.</p>
			<p class="callout">Beware of the use of the <code>context</code> variable in the <code>&lt;record id="action_name" model="ir.actions.act_window.view"&gt;</code> shortcut. These are evaluated at installation time, which is nearly never what you want. If you need variables in your context, use the <code>&lt;record /&gt;</code> syntax.</p>
			<p>We can also add different contexts for the buttons. It works the same way as how we added context keys to our action. This causes the function or action that the button calls to be run in the context given.</p>
			<p>Most form element attributes that are evaluated as Python also have access to the context dictionary. The <code>invisible</code> and <code>readonly</code> attributes are examples<a id="_idIndexMarker596"/> of these. So, in cases where you want an element to show up in a form sometimes but not at other<a id="_idIndexMarker597"/> times, set the <code>invisible</code> attribute to <code>context.get('my_key')</code>. For actions that lead to a case in which the field is supposed to be invisible, set the context key to <code>my_key: True</code>. This strategy enables you to adapt your form without having to rewrite it for different occasions.</p>
			<p>You can also set a context for relational fields, which influences how the field is loaded. By setting the <code>form_view_ref</code> or <code>tree_view_ref</code> keys to the full XML ID of a view, you can select a specific view for this field. This is necessary when you have multiple views of the same type for the same object. Without this key, you get the view with the lowest sequence number, which might not always be desirable.</p>
			<h2 id="_idParaDest-399"><a id="_idTextAnchor473"/>See also</h2>
			<ul>
				<li>The context is also used to set a default search filter. You can learn more about the default search filter in the <em class="italic">Defining search views</em> recipe of this chapter.</li>
				<li>For more details on setting default recipes, refer to the next recipe, <em class="italic">Defining filters on record lists – </em><em class="italic">Domain</em>.</li>
				<li>To learn how to install the French language, consult <a href="B20997_11.xhtml#_idTextAnchor595"><em class="italic">Chapter </em><em class="italic">11</em></a>,<em class="italic"> Internationalization</em>.</li>
				<li>You can refer to <a href="B20997_06.xhtml#_idTextAnchor319"><em class="italic">Chapter 6</em></a>, <em class="italic">Managing Module Data</em> to learn how to write the syntax for relational fields.</li>
			</ul>
			<h1 id="_idParaDest-400"><a id="_idTextAnchor474"/>Defining filters on record lists – domain</h1>
			<p>We’ve already seen <a id="_idIndexMarker598"/>an example<a id="_idIndexMarker599"/> of a domain in the first recipe of this chapter, which was <code>[('state', '=', 'draft')]</code>. Often, you need to display a subset of all available records from an action or allow only a subset of possible records to be the target of a <code>many2one</code> relation. The way to describe these filters in Odoo is by using domains. This recipe illustrates how to use a domain to display a selection of partners.</p>
			<h2 id="_idParaDest-401"><a id="_idTextAnchor475"/>How to do it...</h2>
			<p>To display a subset of partners from your action, you need to perform the following steps:</p>
			<ol>
				<li>Create an action for when “state” is set to “draft:”<pre class="source-code">
<strong class="bold">&lt;record id="action_hostel_room" model="ir.actions.act_window"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;All Hostel Room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="res_model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    </strong><strong class="bold">&lt;field name="view_id" ref="hostel_room_view_tree"/&gt;</strong>
<strong class="bold">    &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="context"&gt;{'lang': 'fr_FR','default_lang': 'fr_FR', 'active_test': False, 'default_room_rating': 1.0}&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="domain"&gt;[('state', '=', 'draft'), ('room_rating', '&amp;gt;', '0.0')]&lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Add menus that call these actions. This is left as an exercise for the reader.</li>
			</ol>
			<h2 id="_idParaDest-402"><a id="_idTextAnchor476"/>How it works...</h2>
			<p>The simplest form<a id="_idIndexMarker600"/> of a domain<a id="_idIndexMarker601"/> is a list of three tuples that contain a field name (of the model in question) as <code>string</code> in the first element, an operator as <code>string</code> in the second element, and the value that the field is to be checked against as the third element. This is what we did before, and this is interpreted as, “<em class="italic">All those conditions have to apply to the records we’re interested in</em>.” This is actually a shortcut because the domains know the two prefix operators—<code>&amp;</code> and <code>|</code>—where <code>&amp;</code> is the default. So, in normalized form, the first domain will be written as follows:</p>
			<pre class="source-code">
['&amp;',('state', '=', 'draft'), ('room_rating', '&amp;gt;', '0.0')]</pre>			<p>While these can be a bit hard to read for bigger expressions, the advantage of prefix operators is that their scope is rigidly defined, which saves you from having to worry about operator precedence and brackets. It’s always two expressions: the first <code>&amp;</code> applies to <code>'&amp;',('state', '=', 'draft')</code>, with <code>('room_rating', '&amp;gt;', '0.0')</code> as the first operand and <code>('room_rating', '&amp;gt;', '0.0')</code>  as the second. Then, we have the first operand and <code>('room_rating', '&amp;gt;', '0.0')</code> as the second.</p>
			<p>In the second step, we have to write out the full form because we need the <code>|</code> operator.</p>
			<p>For example, say we have a complex domain such as this: <code>['|',</code> <code>('user_id',</code> <code>'=', uid), '&amp;', ('lang', '!=', 'fr_FR'), '|', ('phone', '=', False), ('email', '=', False)]</code>. See the following figure to learn about how this domain is evaluated:</p>
			<div><div><img src="img/B20997_09_2.jpg" alt="Figure 9.2 – The evaluation of a domain"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.2 – The evaluation of a domain</p>
			<p>There is also a <code>!</code> operator for negation, but given logical equivalences and negated comparison operators such as <code>!=</code> and <code>not in</code>, it is not really necessary.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Note that this is a unary prefix operator, so it only applies to the following expression in the domain and not to everything that follows.</p>
			<p>Note that the right operand<a id="_idIndexMarker602"/> doesn’t need<a id="_idIndexMarker603"/> to be a fixed value when you write a domain for a window action or other client-side domains. You can use the same minimal Python as is used in the <em class="italic">Passing parameters to forms and actions – Context</em> recipe, so you can write filters such as <strong class="bold">changed last week</strong> or <strong class="bold">my partners</strong>.</p>
			<h2 id="_idParaDest-403"><a id="_idTextAnchor477"/>There’s more...</h2>
			<p>The preceding domains work only for the fields of the model itself, while we often need to filter based on the properties of linked records. To do this, you can use the notation that’s also used in <code>@api.depends</code> definitions or related fields: create a dotted path from the current model to the model you want to filter for. To search partners that have a salesperson who is a member of a group starting with the letter <code>G</code>, you would use the <code>[('user_id.groups_id.name', '=like', 'G%')]</code> domain. The path can be long, so you only have to be sure that there are relation fields between the current model and the model you want to filter for.</p>
			<h3>Operators</h3>
			<p>The following table<a id="_idIndexMarker604"/> lists the available operators and their semantics:</p>
			<div><div><img src="img/Table_011.jpg" alt="Table 9.1 – Operators and their semantics"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 9.1 – Operators and their semantics</p>
			<p>Note that some of the operators work only with certain fields and values. For example, the domain <code>[('category_id', 'in', 1)]</code> is invalid and will generate an error, while the domain <code>[('category_id', 'in', [1])]</code> is valid.</p>
			<h3>Pitfalls of searching using domains</h3>
			<p>This all works fine <a id="_idIndexMarker605"/>for traditional fields, but a notorious problem is searching for the value of a non-stored function field. People often omit the search function. This is simple enough to fix by providing the search function in your own code, as described in <a href="B20997_04.xhtml#_idTextAnchor118"><em class="italic">Chapter 4</em></a>, <em class="italic">Application Models</em>.</p>
			<p>Another issue that might baffle developers is Odoo’s behavior when searching through <code>one2many</code> or <code>many2many</code> fields with a negative operator. Imagine that you have a partner with the <code>A</code> tag, and you search for <code>[('category_id.name', '!=', 'B')]</code>. Your partner shows up in the result, and this is what you expected, but if you add the <code>B</code> tag to this partner, it still shows up in your results because, for the search algorithm, it is enough that there is one linked record (<code>A</code> in this case) that does not fulfill the criterion. Now, if you remove the <code>A</code> tag so that <code>B</code> is the only tag, the partner will be filtered out. If you also remove the <code>B</code> tag so that the partner has no tags, it is still filtered out because the conditions of the linked records presuppose the existence of this record. In other situations, though, this is the behavior you want, so it is not really an option to change the standard behavior. If you need a different behavior here, provide a search function that interprets the negation the way you need.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">People often forget that they are writing XML files when it comes to domains. You need to escape the less-than operator. Searching for records that have been created before the current day will have to be written as <code>[('create_date', '&amp;lt;', current_date)]</code> in XML.</p>
			<p>Domains are used widely in Odoo. You will find them everywhere in Odoo; they are used for searching, filtering, security rules, search views, user actions, and more.</p>
			<p>If you ever need to manipulate a domain that you didn’t create programmatically, use the utility functions provided in <code>odoo.osv.expression</code>. The <code>is_leaf</code>, <code>normalize_domain</code>, <code>AND</code>, and <code>OR</code> functions will allow you to combine domains exactly the way that Odoo does. Don’t do this yourself because there are many corner cases<a id="_idIndexMarker606"/> that you have to take into account, and it is likely that you’ll overlook one.</p>
			<h2 id="_idParaDest-404"><a id="_idTextAnchor478"/>See also</h2>
			<ul>
				<li>For the standard application of domains, see the <em class="italic">Defining search </em><em class="italic">views</em> recipe.</li>
			</ul>
			<h1 id="_idParaDest-405"><a id="_idTextAnchor479"/>Defining list views</h1>
			<p>After having spent quite some time<a id="_idIndexMarker607"/> on the form view, we’ll now take a quick look at how to define list views. Internally, these are called tree views in some places and list views in others, but given that there is another construction within the Odoo view framework called <strong class="bold">tree</strong>, we’ll stick to <strong class="bold">list</strong> here.</p>
			<h2 id="_idParaDest-406"><a id="_idTextAnchor480"/>How to do it...</h2>
			<ol>
				<li>Define your list view:<pre class="source-code">
<strong class="bold">&lt;record id="hostel_room_view_tree" model="ir.ui.view"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;Hostel Room List&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="arch" type="xml"&gt;</strong>
<strong class="bold">        &lt;tree&gt;</strong>
<strong class="bold">            &lt;field name="name"/&gt;</strong>
<strong class="bold">            </strong><strong class="bold">&lt;field name="room_no"/&gt;</strong>
<strong class="bold">            &lt;field name="state"/&gt;</strong>
<strong class="bold">        &lt;/tree&gt;</strong>
<strong class="bold">    &lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Register a tree view in the action that we created in the <em class="italic">Adding a menu item and window action</em> recipe of this chapter:<pre class="source-code">
<strong class="bold">&lt;record id="action_hostel_room" model="ir.actions.act_window"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;All Hostel Room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="res_model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="view_id" ref="hostel_room_view_tree"/&gt;</strong>
<strong class="bold">    &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;</strong>
<strong class="bold">    </strong><strong class="bold">&lt;field name="context"&gt;{'tree_view_ref': 'my_hostel.hostel_room_view_tree', 'lang': 'fr_FR','default_lang': 'fr_FR', 'active_test': False, 'default_room_rating': 1.0}&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="domain"&gt;[('state', '=', 'draft')]&lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Add menus that call these actions. This is left as an exercise for the reader.</li>
			</ol>
			<p><strong class="bold">Install</strong>/<strong class="bold">Upgrade</strong> the module. After that, you will see <a id="_idIndexMarker608"/>our tree view for the hostel room, and if you check it, it will show different row styles based on our conditions.</p>
			<h2 id="_idParaDest-407"><a id="_idTextAnchor481"/>How it works...</h2>
			<p>You already know most of what happens here. We define a view, using the <code>tree</code> type this time, and attach it to our action with an <code>ir.actions.act_window.view</code> element. So, the only thing left to discuss is the <code>tree</code> element and its semantics. With a list, you don’t have many design choices, so the only valid children of this element are the <code>field</code> and <code>button</code> elements. You can also use some widgets in the list view; in our example, we have used the <code>many2one_avatar_user</code> widget. The tree view has the support of a special widget called <code>handle</code>. This is specific to list views. It is meant for integer fields and renders a drag handle that the user can use to drag a row to a different position in the list, thereby updating the field’s value. This is useful for sequence or priority fields.</p>
			<p>By using the <code>optional</code> attribute, you can show fields optionally. Adding the <code>optional</code> attribute to a field will allow the user to hide and show the column at any time from the UI. In our example, we have used it for the <code>country</code> and <code>state</code> fields.</p>
			<p>What is new here are the <code>decoration</code> attributes in the <code>tree</code> element. This contains rules as to which font and/or color is chosen for the row, given in the form of <code>decoration-$name="Python code"</code>. We made these invisible because we only need the data and don’t want to bother our users with the two extra columns. The possible classes are <code>decoration-bf</code> (bold) and <code>decoration-it</code> (italic), and the semantic bootstrap classes<a id="_idIndexMarker609"/> are <code>decoration-danger</code>, <code>decoration-info</code>, <code>decoration-muted</code>, <code>decoration-primary</code>, <code>decoration-success</code>, and <code>decoration-warning</code>.</p>
			<h2 id="_idParaDest-408"><a id="_idTextAnchor482"/>There’s more...</h2>
			<p>For numeric fields, you can add a <code>sum</code> attribute that causes this column to be summed up with the text you set in the attribute as a tooltip. Less common are the <code>avg</code>, <code>min</code>, and <code>max</code> attributes, which display the average, minimum, and maximum, respectively. Note that these four only work on the records that are currently visible, so you might want to adjust the action’s <code>limit</code> (covered earlier in the <em class="italic">Adding a menu item and window action</em> recipe) in order for the user to see all the records immediately.</p>
			<p>A very interesting attribute for the <code>tree</code> element is <code>editable</code>. If you set this to top or bottom, the list behaves entirely differently. Without it, clicking on a row opens a form view for the row. With it, clicking on a row makes it editable inline, with the visible fields rendered as form fields. This is particularly useful in embedded list views, which are discussed later in the <em class="italic">Defining embedded views</em> recipe of this chapter. The choice of top or bottom relates to whether new lines will be added to the top or bottom of the list.</p>
			<p>By default, records are ordered according to the <code>_order</code> property of the displayed model. The user can change the ordering by clicking on a column header, but you can also set a different initial order by setting the <code>default_order</code> property in the <code>tree</code> element. The syntax is the same as in <code>_order</code>.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Ordering is often <a id="_idIndexMarker610"/>a source of frustration for new developers. As Odoo lets PostgreSQL do the work here, you can only order according to the fields that PostgreSQL knows about and only the fields that live in the same database table. So, if you want to order according to a function or a related field, ensure that you set <code>store=True</code>. If you need to order according to a field inherited from another model, declare a stored related field.</p>
			<p>The <code>create</code>, <code>edit</code>, and <code>delete</code> attributes of the <code>tree</code> element work the same as for the <code>form</code> element we described earlier in the <em class="italic">Adding content and widgets to a form view</em> recipe of this chapter. They also determine the available controls if the <code>editable</code> attribute is set.</p>
			<h1 id="_idParaDest-409"><a id="_idTextAnchor483"/>Defining search views</h1>
			<p>When opening your<a id="_idIndexMarker611"/> list view, you’ll notice the search field in the upper right. If you type something there, you will receive suggestions about what to search for, and there is also a set of predefined filters to choose from. This recipe will walk you through how to define these suggestions and options.</p>
			<h2 id="_idParaDest-410"><a id="_idTextAnchor484"/>How to do it...</h2>
			<ol>
				<li>Define your search view:<pre class="source-code">
<strong class="bold">&lt;record id="hostel_room_view_search" model="ir.ui.view"&gt;</strong>
<strong class="bold">    &lt;field name="model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="arch" type="xml"&gt;</strong>
<strong class="bold">        &lt;search&gt;</strong>
<strong class="bold">            &lt;field name="name"/&gt;</strong>
<strong class="bold">            &lt;field name="room_no"/&gt;</strong>
<strong class="bold">            &lt;group expand="0" string="Group By"&gt;</strong>
<strong class="bold">                &lt;filter string="State" name="state" context="{'group_by':'state'}"/&gt;</strong>
<strong class="bold">           &lt;/group&gt;</strong>
<strong class="bold">        &lt;/search&gt;</strong>
<strong class="bold">    &lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Tell your action to use it:<pre class="source-code">
<strong class="bold">&lt;record id="action_hostel_room" model="ir.actions.act_window"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;All Hostel Room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="res_model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="search_view_id" ref="hostel_room_view_search" /&gt;</strong>
<strong class="bold">    &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="context"&gt;{'tree_view_ref': 'my_hostel.hostel_room_view_tree', 'lang': 'fr_FR','default_lang': 'fr_FR', 'active_test': False, 'default_room_rating': 1.0}&lt;/field&gt;</strong>
<strong class="bold">    </strong><strong class="bold">&lt;field name="domain"&gt;[('state', '=', 'draft')]&lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>			</ol>
			<p>When you type something into the search bar now, you’ll be offered the ability to search for this term in the <code>name</code>, <code>room no</code>, and <code>state</code> fields. If your term happens to be a substring of a bank <a id="_idIndexMarker612"/>account number in your system, you’ll even be offered the option to search exactly for this bank account.</p>
			<h2 id="_idParaDest-411"><a id="_idTextAnchor485"/>How it works...</h2>
			<p>In the case of <code>name</code>, we simply listed the field as the one to be offered to the user to search for. We left the semantics as the default, which is a substring search for character fields.</p>
			<p>For categories, we do something more interesting. By default, your search term is applied to a <code>many2many</code> field trigger called <code>name_search</code>, which would be a substring search in the category names in this case. However, depending on your category structure, it can be very convenient to search for partners who have the category you’re interested<a id="_idIndexMarker613"/> in or a child of it. Think of a main category, <strong class="bold">newsletter subscribers</strong>, with the subcategories <strong class="bold">weekly newsletter</strong>, <strong class="bold">monthly newsletter</strong>, and a couple of other newsletter types. Searching for <strong class="bold">newsletter subscribers</strong> with the preceding search view definition will give you everyone who is subscribed to any of those newsletters in one go, which is a lot more convenient than searching for every single type and combining the results.</p>
			<p>The <code>filter_domain</code> attribute can contain an arbitrary domain, so you’re not restricted to searching for the same field you named in the <code>name</code> attribute nor to using only one term. The <code>self</code> variable is what the user filled in and is also the only variable that you can use here.</p>
			<p>Here’s a more elaborate example from the default search view for hostel room:</p>
			<pre class="source-code">
&lt;field name="name"
    filter_domain="[
        '|',
        ('display_name', 'ilike', self),
        ('room_no', '=', self)]"/&gt;</pre>			<p>This means that the user doesn’t have to think about what to search for. All they need to do is type in some letters, press <em class="italic">Enter</em>, and, with a bit of luck, one of the fields mentioned contains the string we’re looking for.</p>
			<p>For the <code>child_ids</code> field, we used another trick. The type of field not only decides the default way of searching for the user’s input but also defines the way in which Odoo presents the suggestions. Additionally, given that <code>many2one</code> fields are the only ones that offer auto-completion, we force Odoo to do that, even though <code>child_ids</code> is a <code>one2many</code> field, by setting the <code>widget</code> attribute. Without this, we will have to search in this field without suggestions for completion. The same applies to <code>many2many</code> fields.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Note that every field with a <code>many2one</code> widget set will trigger a search on its model for every one of the user’s keystrokes; don’t use too many of them.</p>
			<p>You should also put the most-used fields<a id="_idIndexMarker614"/> on the top because the first field is what is searched for if the user just types something and presses <em class="italic">Enter</em>. The search bar can also be used with the keyboard; select a suggestion by pressing the down arrow and open the completion suggestion of <code>many2one</code> by pressing the right arrow. If you educate your users on this and pay attention to the sensible ordering of fields in the search view, this will be much more efficient than typing something first, grabbing the mouse, and selecting an option.</p>
			<p>The <code>filter</code> element creates a button that adds the content of the filter’s <code>domain</code> attribute to the search domain. You should add a logical internal <code>name</code> and a <code>string</code> attribute to describe the filter to your users.</p>
			<p>The <code>&lt;group&gt;</code> tag is used to provide a grouping option under the <code>country_id</code> field.</p>
			<h2 id="_idParaDest-412"><a id="_idTextAnchor486"/>There’s more...</h2>
			<p>You can group filters using the <code>group</code> tag, which causes them to be<a id="_idIndexMarker616"/> rendered slightly closer together than the other filters, but this has semantic implications, too. If you put multiple filters in the same group and activate more than one of them, their domains will be combined with the <code>|</code> operator, while the filters and fields not in the same group are combined with the <code>&amp;</code> operator. Sometimes, you might want disjunction for your filters, which is where they filter for mutually exclusive sets, in which case, selecting both of them will always lead to an empty result set. Within the same group, you can achieve the same effect with the <code>separator</code> element.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Note that if the user fills in multiple queries for the same field, they will be combined with <code>|</code>, too, so you don’t need to worry about that.</p>
			<p>Apart from the <code>field</code> attribute, the <code>filter</code> element can have a <code>context</code> attribute, whose content will be merged with the current context and eventually other context attributes in the search view. This is essential for views that support grouping (refer to the <em class="italic">Defining kanban view</em> and <em class="italic">Defining graph view</em> recipes) because the resulting context determines the field(s) to be grouped using the <code>group_by</code> key. We’ll look into the details of grouping in the appropriate recipes, but the context has other uses, too. For example, you can write a function field that returns different values depending on the context, and then you can change the values by activating a filter.</p>
			<p>The search view itself also responds to context keys. In a very similar way to default values when creating records, you can pass default values for a search view through the context. If we had set a context of <code>{'search_default_room_rating': 1}</code> in our previous action, the <code>room_rating</code> filter would have been pre-selected in the search view. This works only if the filter has a name, though, which is why you should always set it. To set defaults for fields in the search view, use <code>search_default_$fieldname</code>.</p>
			<p>Furthermore, the <code>field</code> and <code>filter</code> elements can have a <code>groups</code> property with the same semantics as in the form views in order to make the element only visible to certain groups.</p>
			<h2 id="_idParaDest-413"><a id="_idTextAnchor487"/>See also</h2>
			<ul>
				<li>For further details about manipulating the context, see the <em class="italic">Passing parameters to forms and actions – </em><em class="italic">Context</em> recipe.</li>
				<li>Users who speak languages with heavy use of diacritical marks will probably want to have Odoo search for <code>e</code>, <code>è</code>, <code>é</code>, and <code>ê</code> when filling in the <code>e</code> character. This<a id="_idIndexMarker617"/> is a configuration of the <strong class="bold">PostgreSQL server</strong> called <strong class="bold">unaccent</strong>, which Odoo has special support for, but this is outside the scope of this book. Refer to <a href="https://www.postgresql.org/docs/10/unaccent.html">https://www.postgresql.org/docs/10/unaccent.html</a> for more information<a id="_idIndexMarker618"/> about unaccent.</li>
			</ul>
			<h1 id="_idParaDest-414"><a id="_idTextAnchor488"/>Adding a search filter side panel</h1>
			<p>Odoo provides one more way<a id="_idIndexMarker619"/> to display search filters, which is a <strong class="bold">search filter side panel</strong>. This panel shows a list of filters on the side of the view. A search panel is very useful when search filters are used frequently by the end user.</p>
			<h2 id="_idParaDest-415"><a id="_idTextAnchor489"/>Getting ready</h2>
			<p>The search panel is part of the search view. So, for this recipe, we will continue using the <code>my_module</code> add-on from the previous recipe. We will add our search panel to the previously designed search view.</p>
			<h2 id="_idParaDest-416"><a id="_idTextAnchor490"/>How to do it...</h2>
			<p>Add <code>&lt;searchpanel&gt;</code> in the search<a id="_idIndexMarker620"/> view, as shown here:</p>
			<pre class="source-code">
&lt;record id="hostel_room_view_search" model="ir.ui.view"&gt;
    &lt;field name="model"&gt;hostel.room&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;search&gt;
            &lt;field name="name"/&gt;
            &lt;field name="room_no"/&gt;
            &lt;field name="state"/&gt;
            &lt;searchpanel&gt;
                &lt;field name="state" expand="1" select="multi" icon="fa-check-square-o" enable_counters="1"/&gt;
            &lt;/searchpanel&gt;
        &lt;/search&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre>			<p>Update the module to apply the modification. After the update, you will see the search panel on the left side of the view.</p>
			<h2 id="_idParaDest-417"><a id="_idTextAnchor491"/>How it works...</h2>
			<p>To add the search panel, you will need to use the <code>&lt;searchpanel&gt;</code> tag in the search view. To add your filter, you will need to add a field in the search panel.</p>
			<p>In our example, first, we added a <code>state</code> field. You also need to add an <code>icon</code> attribute to the field. This icon will be displayed before the title of the filter. Once you add the field to the search panel, it will display the title with an icon, and, below that, a list of all the users. Upon clicking on a user, the records in the list view will be filtered, and you will only see the contacts of the selected user. In this filter, only one item can be active, meaning once you click on another user’s filter, the previous user’s filter will be removed. If you want to activate multi-user filters, you can use the <code>select="multi"</code> attribute. If you use that attribute, you will find the checkbox for each filter option, and you will be able to activate multiple filters at a time. We have used the <code>select="multi"</code> attribute on the <code>state</code> filter. This will allow us to select and filter by multiple categories<a id="_idIndexMarker621"/> at once.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Be careful when you are using the side panel filter on <code>many2one</code> or <code>many2many</code>. If the relation model has too many records, only the <strong class="bold">top 200 records</strong> will be displayed to avoid performance issues.</p>
			<h2 id="_idParaDest-418"><a id="_idTextAnchor492"/>There’s more...</h2>
			<p>If you want to display search panel items in groups, you can use the <code>groupby</code> attribute on a field. For example, if you want to group a category based on its parent hierarchy, you can add the <code>groupby</code> attribute with the <code>parent_id</code> field, as can be seen here:</p>
			<pre class="source-code">
&lt;field name="state"
    icon="fa-check-square-o"
    select="multi"
    groupby="parent_id"/&gt;</pre>			<p>This will show the category filters grouped according to the parent category of the record.</p>
			<h1 id="_idParaDest-419"><a id="_idTextAnchor493"/>Changing existing views – view inheritance</h1>
			<p>So far, we have<a id="_idIndexMarker622"/> ignored the existing<a id="_idIndexMarker623"/> views and declared completely new ones. While this is didactically sensible, you’ll rarely be in situations where you’ll want to define a new view for an existing model. Instead, you’ll want to slightly modify the existing views, be it to simply have them show a field that you added to the model in your add-on or to customize them according to your needs or your customers’ needs.</p>
			<p>In this recipe, we’ll change the default partner form to show the record’s last modification date and make the <code>mobile</code> field searchable by modifying the search view. Then, we’ll change<a id="_idIndexMarker624"/> the position <a id="_idIndexMarker625"/>of one column in the partners’ list view.</p>
			<h2 id="_idParaDest-420"><a id="_idTextAnchor494"/>How to do it...</h2>
			<ol>
				<li>Inject the field into the default form view:<pre class="source-code">
<strong class="bold">&lt;record id="hostel_room_view_form_inherit" model="ir.ui.view"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;Hostel Room Form Inherit&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="inherit_id" ref="my_hostel.hostel_room_view_form" /&gt;</strong>
<strong class="bold">    &lt;field name="arch" type="xml"&gt;</strong>
<strong class="bold">        &lt;xpath expr="//group[@name='my_content']/group" position="inside"&gt;</strong>
<strong class="bold">            &lt;field name="room_no"/&gt;</strong>
<strong class="bold">        &lt;/xpath&gt;</strong>
<strong class="bold">        &lt;xpath expr="//group[@name='my_content']/group" position="after"&gt;</strong>
<strong class="bold">            &lt;group&gt;</strong>
<strong class="bold">                </strong><strong class="bold">&lt;field name="description"/&gt;</strong>
<strong class="bold">                &lt;field name="room_rating"/&gt;</strong>
<strong class="bold">            &lt;/group&gt;</strong>
<strong class="bold">        &lt;/xpath&gt;</strong>
<strong class="bold">    &lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Add the field to the default search view:<pre class="source-code">
<strong class="bold">&lt;record id="hostel_room_view_search_inherit" model="ir.ui.view"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;Hostel Room Search inherit&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="inherit_id" ref="my_hostel.hostel_room_view_search" /&gt;</strong>
<strong class="bold">    &lt;field name="arch" type="xml"&gt;</strong>
<strong class="bold">        </strong><strong class="bold">&lt;xpath expr="." position="inside"&gt;</strong>
<strong class="bold">            &lt;field name="room_rating"&gt;&lt;/field&gt;</strong>
<strong class="bold">        &lt;/xpath&gt;</strong>
<strong class="bold">    &lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Add the field<a id="_idIndexMarker626"/> to the default<a id="_idIndexMarker627"/> list view:<pre class="source-code">
<strong class="bold">&lt;record id="hostel_room_view_tree_inherit" model="ir.ui.view"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;Hostel Room List Inherit&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="inherit_id" ref="my_hostel.hostel_room_view_tree" /&gt;</strong>
<strong class="bold">    &lt;field name="arch" type="xml"&gt;</strong>
<strong class="bold">        &lt;xpath expr="//field[@name='name']" position="after"&gt;</strong>
<strong class="bold">            </strong><strong class="bold">&lt;field name="room_no"/&gt;</strong>
<strong class="bold">        &lt;/xpath&gt;</strong>
<strong class="bold">    &lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>			</ol>
			<p>After updating your module, you should see the <strong class="bold">Last updated on</strong> field beneath the website field on the partner form. When you type something into the search box, it should suggest that you search for the partners on the mobile field, and in the partner’s list view, you will see that the order of the phone number and email has changed.</p>
			<h2 id="_idParaDest-421"><a id="_idTextAnchor495"/>How it works...</h2>
			<p>In <em class="italic">step 1</em>, we added<a id="_idIndexMarker628"/> a basic structure<a id="_idIndexMarker629"/> for form inheritance. The crucial field here is, as you’ve probably guessed, <code>inherit_id</code>. You need to pass the XML ID of the view you want to modify (inherit from) to it. The <code>arch</code> field contains instructions on how to modify the existing XML nodes within the view you’re inheriting from. You should actually think of the whole process as simple XML processing because all the semantic parts only come a lot later.</p>
			<p>The most canonical instruction within the <code>arch</code> field of an inherited view is the <code>field</code> element, which has the required attributes: <code>name</code> and <code>position</code>. As you can only have every field appear once in a form, the name already uniquely identifies a field. With the <code>position</code> attribute, we can place whatever we put within the field element, either <code>before</code>, <code>inside</code>, or <code>after</code> regarding the field we named. The default is <code>inside</code>, but for readability, you should always name the position you require. Remember that we’re not talking semantics here; this is about the position in the XML tree relative to the field we have named. How this will be rendered afterward is a completely different matter.</p>
			<p><em class="italic">Step 2</em> demonstrates a different approach. The <code>xpath</code> element selects the first element that matches the XPath expression named in the <code>expr</code> attribute. Here, the <code>position</code> attribute tells the processor where to put the contents of the <code>xpath</code> element.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">If you want to create an XPath expression based on a CSS class, Odoo provides a special function called <code>hasclass</code>. For example, if you want to select a <code>&lt;div&gt;</code> element with the <code>test_class</code> CSS class, then the expression will be <code>expr="//div[hasclass('test_class')]"</code>.</p>
			<p><em class="italic">Step 3</em> shows how you can change the position of an element. This option was introduced in <code>phone</code> field so that it came after the <code>email</code> field using the <code>position=move</code> option.</p>
			<p>XPath might look somewhat scary, but it is a very efficient means of selecting the node you need to work on. Take the time to look through some simple expressions; it’s worth it. You’ll likely stumble upon the term <strong class="bold">context node</strong>, to which some expressions are relative. In Odoo’s view inheritance system, this is always the root element of the view you’re inheriting from.</p>
			<p>For all the other elements found in the <code>arch</code> field of an inheriting view, the processor looks for the first element with the same node name and matching attributes (with the attribute position excluded, as this is part of the instruction). Use this only in cases where it is very unlikely that this combination<a id="_idIndexMarker630"/> is not unique, such as a group element<a id="_idIndexMarker631"/> combined with a <code>name</code> attribute.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Note that you can have as many instruction elements within the <code>arch</code> field as you need. We only used one per inherited view because there’s nothing else we want to change currently.</p>
			<h2 id="_idParaDest-422"><a id="_idTextAnchor496"/>There’s more...</h2>
			<p>The <code>position</code> attribute has two other possible values: <code>replace</code> and <code>attributes</code>. Using <code>replace</code> causes the selected element to be replaced with the content of the instruction element. Consequently, if you don’t have any content, the selected element can simply be removed. The preceding list or form view would cause the <code>state</code> field to be removed:</p>
			<pre class="source-code">
&lt;field name="state" position="replace" /&gt;</pre>			<p class="callout-heading">Important note</p>
			<p class="callout">Removing fields<a id="_idIndexMarker632"/> can cause other inheriting views to break and several other undesirable side effects, so avoid that if possible. If you really need to remove fields, do so in a view that comes late in the order of evaluation (refer to the next section, <em class="italic">Order of evaluation in view inheritance</em>, for more information).</p>
			<p><code>attributes</code> has very different semantics from the preceding examples. The processor expects the element to contain the <code>attribute</code> elements with a <code>name</code> attribute. These elements will then be used to set attributes for the selected element. If you want to heed the earlier warning, you should set the <code>invisible</code> attribute to <code>1</code> for the <code>state</code> field:</p>
			<pre class="source-code">
&lt;field name="state" position="attributes"&gt;
    &lt;attribute name="invisible"&gt;1&lt;/attribute&gt;
&lt;/field&gt;</pre>			<p>An <code>attribute</code> node can have <code>add</code> and <code>remove</code> attributes, which, in turn, should contain the value to be removed from or added to the space-separated list. This is very useful for the <code>class</code> attribute, where you’d add a class (instead of overwriting the whole attribute) by using the following:</p>
			<pre class="source-code">
&lt;field name="description" position="attributes"&gt;
    &lt;attribute name="class" add="oe_inline" separator=" "/&gt;
&lt;/field&gt;</pre>			<p>This code adds the <code>oe_inline</code> class to the <code>description</code> field. If the field already has a class attribute present, Odoo will join the value with the value of the <code>separator</code> attribute.</p>
			<h3>Order of evaluation in view inheritance</h3>
			<p>As we currently have only one parent<a id="_idIndexMarker633"/> view and one inheriting view, we don’t run<a id="_idIndexMarker634"/> into any problems with conflicting view overrides. When you have installed a couple of modules, you’ll find a lot of overrides for the partner form. This is fine as long as they change different things in a view, but there are occasions where it is important to understand how overriding works in order to avoid conflicts.</p>
			<p>The direct descendants of a view are evaluated in ascending order of their <code>priority</code> field, so views with a lower priority are applied first. Every step of inheritance is applied to the result of the first, so if a view with priority <code>3</code> changes a field and another one with priority <code>5</code> removes it, this is fine. This does not work, however, if the priorities are reversed.</p>
			<p>You can also inherit an inheriting view itself from a view. In this case, the second-level inheriting view is applied to the result of the view it inherits from. So, if you have four views, <code>A</code>, <code>B</code>, <code>C</code>, and <code>D</code>, where <code>A</code> is a standalone form, <code>B</code> and <code>C</code> inherit from <code>A</code>, and <code>D</code> inherits from <code>B</code>, the order of evaluation is <code>A</code>, <code>B</code>, <code>D</code>, and <code>C</code>. Use this to enforce an order without having to rely on priorities; this is safer in general. If an inheriting view adds a field and you need to apply changes<a id="_idIndexMarker635"/> to this field, inherit from the inheriting<a id="_idIndexMarker636"/> view and not from the standalone one.</p>
			<p class="callout-heading">Important  note</p>
			<p class="callout">This kind of inheritance always works on the complete XML tree from the original view, with modifications from the previous inheriting views applied.</p>
			<p>The following points provide information on some advanced tricks that are used to tweak the behavior of view inheritance:</p>
			<ul>
				<li>For inheriting views, a very useful and not very well-known field is <code>groups_id</code>. This field causes inheritance to take place only if the user requesting the parent view is a member of one of the groups mentioned there. This can save you a lot of work when adapting the user interface for different levels of access because, with inheritance, you can have more complex operations than just showing or not showing the elements based on group membership, as is possible with the <code>groups</code> attribute for form elements.</li>
				<li>You can, for example, remove elements if the user is a member of a group (which is the inverse of what the <code>groups</code> attribute does). You can also carry out some elaborate tricks, such as adding attributes based on group membership. Think about simple things, such as making a field read-only for certain groups, or more interesting concepts, such as using different widgets for different groups.</li>
				<li>What was described in this recipe relates to the <code>mode</code> field of the original view being set to primary, while the inheriting views have the mode extension, which is the default. We will investigate the case in which the mode of an inheriting view is set to <code>primary</code> later, where<a id="_idIndexMarker637"/> the rules are<a id="_idIndexMarker638"/> slightly different.</li>
			</ul>
			<h1 id="_idParaDest-423"><a id="_idTextAnchor497"/>Defining document-style forms</h1>
			<p>In this recipe, we’ll review some design <a id="_idIndexMarker639"/>guidelines in order to present a uniform user experience.</p>
			<h2 id="_idParaDest-424"><a id="_idTextAnchor498"/>How to do it...</h2>
			<ol>
				<li>Start your form with a <code>header</code> element:<pre class="source-code">
<strong class="bold">&lt;header&gt;</strong>
<strong class="bold">    &lt;button name="make_available" string="Make Available" type="object"/&gt;</strong>
<strong class="bold">    &lt;button name="make_closed"  string="Make Closed" type="object"/&gt;</strong>
<strong class="bold">    &lt;button type="action" name="%(my_hostel.hostel_room_category_action)d"        string="Open Hotel Room Category" /&gt;</strong>
<strong class="bold">    &lt;field name="state" widget="statusbar"/&gt;</strong>
<code>sheet</code> element for content:<pre class="source-code">
<code>stat</code> button, which will be used to show total <code>Hostel Room</code> and will redirect to hostel room:<pre class="source-code">
<strong class="bold">&lt;div class="oe_button_box" name="button_box"&gt;</strong>
<strong class="bold">    &lt;button type="object" class="oe_stat_button" icon="fa-pencil-square-o" name="action_open_related_hostel_room"&gt;</strong>
<strong class="bold">        &lt;div class="o_form_field o_stat_info"&gt;</strong>
<strong class="bold">            &lt;span class="o_stat_value"&gt;</strong>
<strong class="bold">                 &lt;field name="related_hostel_room"/&gt;</strong>
<strong class="bold">            &lt;/span&gt;</strong>
<strong class="bold">            &lt;span class="o_stat_text"&gt;Hostel Room&lt;/span&gt;</strong>
<strong class="bold">        &lt;/div&gt;</strong>
<strong class="bold">    &lt;/button&gt;</strong>
<strong class="bold">&lt;/div&gt;</strong></pre></li>				<li>Add some prominent<a id="_idIndexMarker640"/> field(s):<pre class="source-code">
<strong class="bold">&lt;div class="oe_title"&gt;</strong>
<strong class="bold">    &lt;h1&gt;</strong>
<strong class="bold">        &lt;field name="name"/&gt;</strong>
<strong class="bold">    &lt;/h1&gt;</strong>
<strong class="bold">&lt;/div&gt;</strong></pre></li>				<li>Add your content; you can use a notebook if there are a lot of fields:<pre class="source-code">
<strong class="bold">&lt;group&gt;</strong>
<strong class="bold">    &lt;field name="child_ids"/&gt;</strong>
<strong class="bold">    &lt;field name="hoste_room_ids" widget="many2many_tags"/&gt;</strong>
<code>chatter</code> widget (if applicable):<pre class="source-code">
<strong class="bold">&lt;/sheet&gt;</strong>
<strong class="bold">    &lt;div class="oe_chatter"&gt;</strong>
<strong class="bold">         &lt;field name="message_follower_ids" widget="mail_followers"/&gt;</strong>
<strong class="bold">         &lt;field name="message_ids" widget="mail_thread"/&gt;</strong>
<strong class="bold">         &lt;field name="activity_ids" widget="mail_activity"/&gt;</strong>
<strong class="bold">    &lt;/div&gt;</strong></pre></li>			</ol>
			<p>Let’s have a look at how this recipe works.</p>
			<h2 id="_idParaDest-425"><a id="_idTextAnchor499"/>How it works...</h2>
			<p>The header should contain<a id="_idIndexMarker641"/> buttons that execute actions on the object that the user currently sees. Use the <code>btn-primary</code> class to make buttons visually stand out (in purple at the time of writing), which is a good way to guide the user regarding which is the most logical action to execute at the moment. Try to have all the highlighted buttons to the left of the non-highlighted buttons and hide the buttons that are not relevant in the current state (if applicable). If the model has a state, show it in the header using the <code>statusbar</code> widget. This will be rendered as right-aligned in the header.</p>
			<p>The <code>sheet</code> element is rendered as a stylized sheet, and the most important fields should be the first thing the user sees when looking at it. Use the <code>oe_title</code> classes to have them rendered in a prominent place (floating left with slightly adjusted font sizes at the time of writing).</p>
			<p>If there are other records of interest concerning the record the user currently sees (such as the partner’s invoices on a partner form), put them in an element with the <code>oe_right</code> and <code>oe_button_box</code> classes; this aligns the buttons in it to the right. On the buttons themselves, use the <code>oe_stat_button</code> class to enforce a uniform rendering of the buttons. It’s also customary to assign an icon class from the <code>icon</code> attribute. You can learn more<a id="_idIndexMarker642"/> about Font Awesome at <a href="https://fontawesome.com/v4.7.0/icons/">https://fontawesome.com/v4.7.0/icons/</a>.</p>
			<p>You can use the <code>oe_chatter</code> class and <code>mail.thread</code> mixin. We will see this in detail<a id="_idIndexMarker643"/> in <a href="B20997_23.xhtml#_idTextAnchor1210"><em class="italic">Chapter 23</em></a>, <em class="italic">Managing Emails </em><em class="italic">in Odoo</em>.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Even if you do not like this layout, stick to the element and class names described here and adjust what you need with CSS and possibly JavaScript. This will make the user interface more compatible with existing add-ons and allow you to integrate better with core add-ons.</p>
			<h2 id="_idParaDest-426"><a id="_idTextAnchor500"/>See also</h2>
			<ul>
				<li>To find out more <a id="_idIndexMarker644"/>about Font Awesome, go to <a href="https://fontawesome.com/v4.7.0/icons/">https://fontawesome.com/v4.7.0/icons/</a>.</li>
				<li>For more details on the <code>mail.thread</code> mixin, refer to <a href="B20997_23.xhtml#_idTextAnchor1210"><em class="italic">Chapter 23</em></a>, <em class="italic">Managing Emails </em><em class="italic">in Odoo</em>.</li>
			</ul>
			<h1 id="_idParaDest-427"><a id="_idTextAnchor501"/>Dynamic form elements using attributes</h1>
			<p>So far, we have only <a id="_idIndexMarker645"/>looked into changing<a id="_idIndexMarker646"/> forms depending on the user’s groups (the <code>groups</code> attribute for elements and the <code>groups_id</code> field for inherited views) and nothing more. This recipe will show you how to modify the form view based on the value of the fields in it.</p>
			<h2 id="_idParaDest-428"><a id="_idTextAnchor502"/>How to do it...</h2>
			<ol>
				<li>Define an attribute called <code>attributes</code> on a form element:<pre class="source-code">
<strong class="bold">&lt;field name="child_ids"</strong>
<strong class="bold">    invisible="not parent_id"</strong>
<strong class="bold">    required="parent_id"/&gt;</strong></pre></li>				<li>Ensure that all the fields you refer to are available in your form:<pre class="source-code">
<strong class="bold">&lt;field name="parent_id"/&gt;</strong></pre></li>			</ol>
			<p>This will make the <code>child_ids</code> field invisible if the <code>parent_id</code> is not <code>hostel room category</code>, and it will be required if it’s a hostel room category.</p>
			<h2 id="_idParaDest-429"><a id="_idTextAnchor503"/>How it works...</h2>
			<p><code>invisible</code>, <code>required</code>, and <code>readonly</code> keys (all of which are optional). The values are domains that may refer to the fields that exist on the form (and really only those, so there are no dotted paths), and the whole dictionary is evaluated according to the rules for client-side Python, as described earlier in the <em class="italic">Passing parameters to forms and actions – Context</em> recipe of this chapter. So, for example, you can access<a id="_idIndexMarker647"/> the context in the right-hand<a id="_idIndexMarker648"/> operand.</p>
			<h2 id="_idParaDest-430"><a id="_idTextAnchor504"/>There’s more...</h2>
			<p>While this mechanism is quite straightforward for scalar fields, it’s less obvious how to handle the <code>one2many</code> and <code>many2many</code> fields. In fact, in standard Odoo, you can’t do much with those fields within <code>[[6, False, []]]</code> as your right-hand operand.</p>
			<h1 id="_idParaDest-431"><a id="_idTextAnchor505"/>Defining embedded views</h1>
			<p>When you show a <code>one2many</code> or a <code>many2many</code> field on<a id="_idIndexMarker649"/> a form, you don’t have much control over how it is rendered if you haven’t used one of the specialized widgets. Additionally, in the case of the <code>many2one</code> fields, it is sometimes desirable to be able to influence the way the linked record is opened. In this recipe, we’ll look at how to define private views for those fields.</p>
			<h2 id="_idParaDest-432"><a id="_idTextAnchor506"/>How to do it...</h2>
			<ol>
				<li>Define your field as usual, but don’t close the tag:<pre class="source-code">
<strong class="bold">&lt;field name="hostel_room_ids"&gt;</strong></pre></li>				<li>Write the view definition(s) into the tag:<pre class="source-code">
<strong class="bold">&lt;tree&gt;</strong>
<strong class="bold">    &lt;field name="name"/&gt;</strong>
<strong class="bold">    &lt;field name="room_no"/&gt;</strong>
<strong class="bold">&lt;/tree&gt;</strong>
<strong class="bold">&lt;form&gt;</strong>
<strong class="bold">    &lt;sheet&gt;</strong>
<strong class="bold">        &lt;group&gt;</strong>
<strong class="bold">            &lt;field name="name"/&gt;</strong>
<strong class="bold">            &lt;field name="room_no"/&gt;</strong>
<strong class="bold">        </strong><strong class="bold">&lt;/group&gt;</strong>
<strong class="bold">    &lt;/sheet&gt;</strong>
<strong class="bold">&lt;/form&gt;</strong></pre></li>				<li>Close the tag:<pre class="source-code">
<strong class="bold">&lt;/field&gt;</strong></pre></li>			</ol>
			<h2 id="_idParaDest-433"><a id="_idTextAnchor507"/>How it works...</h2>
			<p>When Odoo loads a form<a id="_idIndexMarker650"/> view, it first checks whether the <code>relational</code> type fields have embedded views in the field, as outlined previously. Those embedded views can have the exact same elements as the views we defined before. Only if Odoo doesn’t find an embedded view of some type does it use the model’s default view of this type.</p>
			<h2 id="_idParaDest-434"><a id="_idTextAnchor508"/>There’s more...</h2>
			<p>While embedded views might seem like a great feature, they complicate view inheritance a lot. For example, as soon as embedded views are involved, the field names are not guaranteed to be unique, and you’ll usually have to use some elaborate XPaths to select elements within an embedded view.</p>
			<p>So, in general, you should better define standalone views and use the <code>form_view_ref</code> and <code>tree_view_ref</code> keys, as described earlier in the <em class="italic">Having an action open a specific view</em> recipe of this chapter.</p>
			<h1 id="_idParaDest-435"><a id="_idTextAnchor509"/>Displaying attachments on the side of the form view</h1>
			<p>In some applications, such <a id="_idIndexMarker651"/>as invoicing, you need<a id="_idIndexMarker652"/> to fill in data based on a document. To ease the data-filling process, a new feature was added to Odoo version 12 to display the document on the side of the form view.</p>
			<p>In this recipe, we will learn how to display the form view and the document side by side:</p>
			<div><div><img src="img/B20997_09_3.jpg" alt="Figure 9.3 – Cascading attachments and the form view"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.3 – Cascading attachments and the form view</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">This feature is only meant for large displays (<code>&gt;1534px</code>), so if you have a small viewport, this feature will be hidden. Internally, this feature uses some responsive <a id="_idIndexMarker653"/>utilities, so this feature only works in the <strong class="bold">Enterprise</strong> edition. However, you can still use this code in your module. Odoo will automatically handle this, so if the module is installed in the Enterprise edition, it will show the document, while in the Community edition, it will hide everything without any side effects.</p>
			<h2 id="_idParaDest-436"><a id="_idTextAnchor510"/>How to do it...</h2>
			<p>We will enable<a id="_idIndexMarker654"/> this feature<a id="_idIndexMarker655"/> to modify a form view for the <code>hostel.room.category</code> model, as follows:</p>
			<pre class="source-code">
&lt;record id="hostel_room_category_view_form" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Form&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;form&gt;
            &lt;sheet&gt;
                &lt;div class="oe_button_box" name="button_box"&gt;
                    &lt;button type="object" class="oe_stat_button" icon="fa-pencil-square-o" name="action_open_related_hostel_room"&gt;
                        &lt;div class="o_form_field o_stat_info"&gt;
                            &lt;span class="o_stat_value"&gt;
                                &lt;field name="related_hostel_room"/&gt;
                            &lt;/span&gt;
                            &lt;span class="o_stat_text"&gt;Hostel Room&lt;/span&gt;
                        &lt;/div&gt;
                    &lt;/button&gt;
                &lt;/div&gt;
                &lt;div class="oe_title"&gt;
                   &lt;h1&gt;
                        &lt;field name="name"/&gt;
                    &lt;/h1&gt;
                &lt;/div&gt;
                &lt;group&gt;
                    &lt;group&gt;
                        &lt;field name="description"/&gt;
                    &lt;/group&gt;
                    &lt;group&gt;
                        &lt;field name="parent_id"/&gt;
                    &lt;/group&gt;
                &lt;/group&gt;
                &lt;group&gt;
                    &lt;field name="child_ids"
                           invisible="not parent_id"
                           required="parent_id"/&gt;
                    &lt;field name="hoste_room_ids"&gt;
                        &lt;tree&gt;
                            &lt;field name="name"/&gt;
                            &lt;field name="room_no"/&gt;
                        &lt;/tree&gt;
                        &lt;form&gt;
                            &lt;sheet&gt;
                                &lt;group&gt;
                                    &lt;field name="name" /&gt;
                                    &lt;field name="room_no"/&gt;
                                &lt;/group&gt;
                            &lt;/sheet&gt;
                        &lt;/form&gt;
                    &lt;/field&gt;
                &lt;/group&gt;
            &lt;/sheet&gt;
            &lt;div class="o_attachment_preview" options="{'types': ['image', 'pdf'], 'order': 'desc'}"/&gt;
            &lt;div class="oe_chatter"&gt;
                &lt;field name="message_follower_ids" widget="mail_followers"/&gt;
                &lt;field name="message_ids" widget="mail_thread"/&gt;
                &lt;field name="activity_ids" widget="mail_activity"/&gt;
            &lt;/div&gt;
        &lt;/form&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre>			<p>Update the module<a id="_idIndexMarker656"/> to apply<a id="_idIndexMarker657"/> the changes. You need to upload a PDF or image via the record chatter. When you upload it, Odoo will display the attachment on the side.</p>
			<h2 id="_idParaDest-437"><a id="_idTextAnchor511"/>How it works...</h2>
			<p>This feature only works if your model has inherited the <code>mail.thread</code> model. To show the document on the side of any form view, you will need to add an empty <code>&lt;div&gt;</code> with the <code>o_attachment_preview</code> class before the chatter elements. That’s it; the documents attached in the chatter will be displayed on the side of the form view.</p>
			<p>By default, the <code>pdf</code> and <code>image</code> documents will be displayed in ascending order by date. You can change this behavior by providing extra options, which include the following:</p>
			<ul>
				<li><code>type</code>: You need to pass the list of document types you want to allow. Only two values are possible: <code>pdf</code> and <code>image</code>. For example, if you want to display only <code>pdf</code>-type images, you can pass <code>{'</code><code>type': ['pdf']}</code>.</li>
				<li><code>order</code>: The possible values are <code>asc</code> and <code>desc</code>. These allow you to show documents in ascending<a id="_idIndexMarker658"/> order or descending order<a id="_idIndexMarker659"/> of the document creation date.</li>
			</ul>
			<h2 id="_idParaDest-438"><a id="_idTextAnchor512"/>There’s more...</h2>
			<p>In most cases, you want to display documents on the side of the initial state of any record. If you want to hide the attachment preview based on domain, you can use <code>attributes</code> on the <code>&lt;div&gt;</code> tag to hide the preview.</p>
			<p>Take a look at the following example: it will hide the PDF preview if the value of the <code>state</code> field is not <code>draft</code>:</p>
			<pre class="source-code">
&lt;div class="o_attachment_preview"
    invisible="state != 'draft'"/&gt;</pre>			<p>This is how you can hide attachments when they are not needed. Usually, this feature is used to fill data from PDFs and is only activated in draft mode.</p>
			<h1 id="_idParaDest-439"><a id="_idTextAnchor513"/>Defining kanban views</h1>
			<p>So far, we have presented<a id="_idIndexMarker660"/> you with a list of records that can be opened to show a form. While those lists are efficient when presenting a lot of information, they tend to be slightly boring, given the lack of design possibilities. In this recipe, we’ll take a look at <strong class="bold">kanban views</strong>, which allow us to present<a id="_idIndexMarker661"/> lists of records in a more appealing way.</p>
			<h2 id="_idParaDest-440"><a id="_idTextAnchor514"/>How to do it...</h2>
			<ol>
				<li>Define a view of the <code>kanban</code> type:<pre class="source-code">
&lt;record id="hostel_room_category_view_kanban" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories kanban&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;kanban class="o_kanban_mobile" sample="1"&gt;</pre></li>				<li>List the fields you’ll use in your view:<pre class="source-code">
    &lt;field name="name"/&gt;
    &lt;field name="description"/&gt;
    &lt;field name="parent_id"/&gt;</pre></li>				<li>Implement a design:<pre class="source-code">
&lt;templates&gt;
    &lt;t t-name="kanban-box"&gt;
        &lt;div t-attf-class="oe_kanban_global_click"&gt;
             &lt;div class="row mb4"&gt;
                 &lt;div class="col-6 o_kanban_record_headings"&gt;
                     &lt;strong&gt;
                         &lt;span&gt;
                             &lt;field name="name"/&gt;
                         &lt;/span&gt;
                     &lt;/strong&gt;
                  &lt;/div&gt;
                  &lt;div class="col-6 text-end"&gt;
                      &lt;strong&gt;&lt;i role="img" title="description"/&gt;
                          &lt;t t-esc="record.description.value"/&gt;&lt;/strong&gt;
                     &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="row"&gt;
                     &lt;div class="col-12"&gt;
                          &lt;span&gt;&lt;field name="parent_id"/&gt;&lt;/span&gt;
                     &lt;/div&gt;
                &lt;/div&gt;
           &lt;/div&gt;
     &lt;/t&gt;
&lt;/templates&gt;</pre></li>				<li>Close all<a id="_idIndexMarker662"/> the tags:<pre class="source-code">
        &lt;/kanban&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Add this view to one of your actions. This is left as an exercise for the reader. You will find a full working example in the GitHub example files: <a href="https://github.com/PacktPublishing/Odoo-13-Development-Cookbook-Fourth-Edition/tree/master/Chapter09/15_kanban_view/my_module">https://github.com/PacktPublishing/Odoo-13-Development-Cookbook-Fourth-Edition/tree/master/Chapter09/15_kanban_view/my_module</a>.</li>
			</ol>
			<h2 id="_idParaDest-441"><a id="_idTextAnchor515"/>How it works...</h2>
			<p>We need to give a list of fields<a id="_idIndexMarker663"/> to load in <em class="italic">step 2</em> in order to be able to access them later. The content of the <code>templates</code> element must be a single <code>t</code> element with the <code>t-name</code> attribute set to <code>kanban-box</code>.</p>
			<p>What you write inside this element will be repeated for each record, with special semantics for <code>t</code> elements and <code>t-*</code> attributes. For details about this, refer to the <em class="italic">Using client-side QWeb templates</em> recipe from <a href="B20997_15.xhtml#_idTextAnchor861"><em class="italic">Chapter 15</em></a>, <em class="italic">Web Client Development</em> because, technically speaking, kanban views are just an application of QWeb templates.</p>
			<p>There are a few modifications that are particular to kanban views. You have access to the <code>read_only_mode</code>, <code>record</code>, and <code>widget</code> variables during evaluation. Fields can be accessed using <code>record.fieldname</code>, which is an object with the <code>value</code> and <code>raw_value</code> properties, where <code>value</code> is the field’s value that has been formatted in a way that is presentable to the user, and <code>raw_value</code> is the field’s value, as it comes from the database.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout"><code>many2many</code> fields make an exception here. You’ll only get an ID list through the <code>record</code> variable. For a user-readable representation, you must use the <code>field</code> element.</p>
			<p>Note the <code>type</code> attribute of the link at the top of the template. This attribute makes Odoo generate a link that opens the record in view mode (<code>type</code> attribute can also be <code>object</code> or <code>action</code>, which will render the links that call a function from the model or an action. In both cases, you need to supplement the attributes for buttons in form views, as outlined in the <em class="italic">Adding buttons to forms</em> recipe of this chapter. Instead of the <code>a</code> element, you can also use the <code>button</code> element; the <code>type</code> attribute<a id="_idIndexMarker664"/> has the same semantics here.</p>
			<h2 id="_idParaDest-442"><a id="_idTextAnchor516"/>There’s more...</h2>
			<p>There are a few more helper functions worth mentioning. If you need to generate a pseudo-random color for an element, use the <code>kanban_color(some_variable)</code> function, which will return a CSS class that sets the <code>background</code> and <code>color</code> properties. This is usually used in the <code>t-att-class</code> elements.</p>
			<p>If you want to display an image stored in a binary field, use <code>kanban_image(modelname, fieldname, record.id.raw_value)</code>, which returns a data URI if you included the field in your fields list; the field is set, is a placeholder if the field is not set, or is a URL that makes Odoo stream the field’s contents if you didn’t include the field in your fields list. Do not include the field in the fields list if you need to display a lot of records simultaneously or if you expect very big images. Usually, you’d use this in a <code>t-att-src</code> attribute of an <code>img</code> element.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Doing design in kanban views can be a bit trying. What often works better is generating HTML using a function field of the HTML type and generating this HTML from a Qweb view. In this way, you’re still doing QWeb but doing so on the server side, which is a lot more convenient when you need to work on a lot of data.</p>
			<h2 id="_idParaDest-443"><a id="_idTextAnchor517"/>See also</h2>
			<ul>
				<li>To know more about template elements, refer to the <em class="italic">Using client-side QWeb templates</em> recipe from <a href="B20997_15.xhtml#_idTextAnchor861"><em class="italic">Chapter 15</em></a>, <em class="italic">Web </em><em class="italic">Client Development</em>.</li>
			</ul>
			<h1 id="_idParaDest-444"><a id="_idTextAnchor518"/>Showing kanban cards in columns according to their state</h1>
			<p>This recipe shows<a id="_idIndexMarker665"/> you how to set<a id="_idIndexMarker666"/> up a kanban view where the user can drag and drop a record from one column to the other, thereby pushing the record in question into another state.</p>
			<h2 id="_idParaDest-445"><a id="_idTextAnchor519"/>Getting ready</h2>
			<p>From now on, we’ll make<a id="_idIndexMarker667"/> use of the hostel module<a id="_idIndexMarker668"/> here, as this defines models that lend themselves better to date- and state-based views than those defined in the base module. So, before proceeding, add <code>base</code> to the dependencies list of your add-on.</p>
			<h2 id="_idParaDest-446"><a id="_idTextAnchor520"/>How to do it...</h2>
			<ol>
				<li>Define a kanban view for the hostel room category:<pre class="source-code">
&lt;record id="hostel_room_category_view_kanban" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories kanban&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;kanban class="o_kanban_mobile" sample="1" default_group_by="parent_id"&gt;
            &lt;field name="name"/&gt;
            &lt;field name="description"/&gt;
            &lt;templates&gt;
                &lt;t t-name="kanban-box"&gt;
                    &lt;div t-attf-class="oe_kanban_global_click"&gt;
                        &lt;div class="row mb4"&gt;
                            &lt;div class="col-6 o_kanban_record_headings"&gt;
                                &lt;strong&gt;
                                    &lt;span&gt;
                                        &lt;field name="name"/&gt;
                                    &lt;/span&gt;
                               &lt;/strong&gt;
                           &lt;/div&gt;
                           &lt;div class="col-6 text-end"&gt;
                               &lt;strong&gt;&lt;i role="img" title="description"/&gt; &lt;t t-esc="record.description.value"/&gt;&lt;/strong&gt;
                           &lt;/div&gt;
                       &lt;/div&gt;
                       &lt;div class="row"&gt;
                           &lt;div class="col-12"&gt;
                               &lt;span&gt;&lt;field name="parent_id"/&gt;&lt;/span&gt;
                           &lt;/div&gt;
                       &lt;/div&gt;
                   &lt;/div&gt;
               &lt;/t&gt;
           &lt;/templates&gt;
       &lt;/kanban&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Add a menu and<a id="_idIndexMarker669"/> an action<a id="_idIndexMarker670"/> using this view. This is left as an exercise for the reader.</li>
			</ol>
			<h2 id="_idParaDest-447"><a id="_idTextAnchor521"/>How it works...</h2>
			<p>Kanban views support<a id="_idIndexMarker671"/> grouping, which allows<a id="_idIndexMarker672"/> you to display records that have a group field in common in the same column. This is commonly used for a <code>parent hotel room category</code> or <code>parent_id</code> field because it allows the user to change this field’s value for a record by simply dragging it into another column. Set the <code>default_group_by</code> attribute on the <code>kanban</code> element to the name of the field you want to group by in order to make use of this functionality.</p>
			<p>To control the behavior of kanban grouping, there are a few options available in Odoo:</p>
			<ul>
				<li><code>group_create</code>: This option is used to hide or show the <code>true</code>.</li>
				<li><code>group_delete</code>: This option enables or disables the <code>true</code>.</li>
				<li><code>group_edit</code>: This option enables or disables the <code>true</code>.</li>
				<li><code>archivable</code>: This option enables or disables the option to archive and restore the records from the kanban group context menu. This only works if the <code>active</code> Boolean field is present in your model.</li>
				<li><code>quick_create</code>: With this option, you can create records directly from the kanban view.</li>
				<li><code>quick_create_view</code>: By default, the <code>quick_create</code> option displays only the name field in kanban. However, with the <code>quick_create_view</code> option, you can give the reference to the minimal form view so as to display it in kanban.</li>
				<li><code>on_create</code>: If you don’t want to use <code>quick_create</code> when creating a new record and you don’t want to redirect the user to the form view either, you can give the reference of the wizard<a id="_idIndexMarker673"/> so that it will open<a id="_idIndexMarker674"/> the wizard when clicking the <strong class="bold">Create</strong> button.</li>
			</ul>
			<h2 id="_idParaDest-448"><a id="_idTextAnchor522"/>There’s more...</h2>
			<p>If not defined in the dedicated attribute, any search filter can add grouping by setting a context key named <code>group_by</code> to the field name(s) to group by.</p>
			<h1 id="_idParaDest-449"><a id="_idTextAnchor523"/>Defining calendar views</h1>
			<p>This recipe walks<a id="_idIndexMarker675"/> you through how to display and edit information about dates and duration in your records in a visual way.</p>
			<h2 id="_idParaDest-450"><a id="_idTextAnchor524"/>How to do it...</h2>
			<p>Follow these steps to add a <code>calendar</code> view for the <code>hostel.room.category</code> model:</p>
			<ol>
				<li>Define a <code>calendar</code> view:<pre class="source-code">
&lt;record id="hostel_room_category_view_calendar" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Calendar&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;calendar date_start="date_assign" date_stop="date_end" color="parent_id"&gt;
            &lt;field name="name" /&gt;
            &lt;field name="parent_id" /&gt;
        &lt;/calendar&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Add menus and actions using this view. This is left as an exercise for the reader.</li>
			</ol>
			<h2 id="_idParaDest-451"><a id="_idTextAnchor525"/>How it works...</h2>
			<p>The <code>calendar</code> view needs to pass<a id="_idIndexMarker676"/> the field names in the <code>date_start</code> and <code>date_stop</code> attributes to indicate which fields to look at when building the visual representation. Only use fields with the <code>Datetime</code> or <code>Date</code> type; other types of fields will not work and will instead generate an error. While <code>date_start</code> is required, you can leave out <code>date_stop</code> and set the <code>date_delay</code> attribute instead, which is expected to be a <code>Float</code> field that represents the duration in hours.</p>
			<p>The <code>calendar</code> view allows you to give records that have the same value in a field the same (arbitrarily assigned) color. To use this functionality, set the <code>color</code> attribute to the name of the field you need. In our example, we can see at a glance which hostel room category belongs to the same hostel room category because we assigned <code>parent_id</code> as the field to determine the color groups.</p>
			<p>The fields you name in the <code>calendar</code> element’s body are shown within the block that represents the time interval <a id="_idIndexMarker677"/>covered, separated by commas.</p>
			<h2 id="_idParaDest-452"><a id="_idTextAnchor526"/>There’s more...</h2>
			<p>The <code>calendar</code> view has some other helpful attributes. If you want to open calendar entries in a popup instead of the standard form view, set <code>event_open_popup</code> to <code>1</code>. By default, you create a new entry by just filling in some text, which internally calls the model’s <code>name_create</code> function to actually create the record. If you want to disable this behavior, set <code>quick_add</code> to <code>0</code>.</p>
			<p>If your model covers a whole day, set <code>all_day</code> to a field’s name that is <code>true</code> if the record covers the whole day and <code>false</code> otherwise.</p>
			<h1 id="_idParaDest-453"><a id="_idTextAnchor527"/>Defining graph view and pivot view</h1>
			<p>In this recipe, we’ll take<a id="_idIndexMarker678"/> a look<a id="_idIndexMarker679"/> at Odoo’s business intelligence views. These are read-only views that are meant to present data.</p>
			<h2 id="_idParaDest-454"><a id="_idTextAnchor528"/>Getting ready</h2>
			<p>We’re still making use<a id="_idIndexMarker680"/> of the <code>hostel</code> module<a id="_idIndexMarker681"/> here. You can configure a graph and pivot views to get different statistics. For our example, we will focus on the assigned user. We will generate a graph and pivot view to see the users of the hostel room category. By the way, the end user can generate statistics of their choice by modifying the view options.</p>
			<h2 id="_idParaDest-455"><a id="_idTextAnchor529"/>How to do it...</h2>
			<ol>
				<li>Define a graph view using bars:<pre class="source-code">
&lt;record id="hostel_room_category_view_graph" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Graph&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;graph type="bar"&gt;
            &lt;field name="parent_id"/&gt;
            &lt;field name="child_ids"/&gt;
        &lt;/graph&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Define a pivot view:<pre class="source-code">
&lt;record id="hostel_room_category_view_pivot" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Pivot&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;pivot&gt;
            &lt;field name="parent_id" type="row"/&gt;
            &lt;field name="name" type="col"/&gt;
        &lt;/pivot&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Add menus and actions using this view. This is left as an exercise for the reader.</li>
			</ol>
			<p>If everything went well, you <a id="_idIndexMarker682"/>should see graphs<a id="_idIndexMarker683"/> that show how many parent hostel room categories are assigned to which hostel room categories and the state of those hostel room categories.</p>
			<h2 id="_idParaDest-456"><a id="_idTextAnchor530"/>How it works...</h2>
			<p>The graph view is declared with a root element, <code>graph</code>. The <code>type</code> attribute on a <code>graph</code> element determines the initial mode of a graph view. The possible values are <code>bar</code>, <code>line</code>, and <code>chart</code>, but <code>bar</code> is the default. The graph view is highly interactive, so the user can switch between the different modes and also add and remove fields. If you use <code>type="bar",</code>, you can also use <code>stacked="1"</code> to show a stacked bar chart during grouping.</p>
			<p>The <code>field</code> elements tell Odoo what to display on which axis. For all graph modes, you need at least one field with the <code>row</code> type and one with the <code>measure</code> type to see anything useful. Fields of the <code>row</code> type determine the grouping, while those of the <code>measure</code> type stand for the value(s) to be shown. Line graphs only support one field of each type, while charts and bars handle two group fields with one measure nicely.</p>
			<p>Pivot views have their own root element, <code>pivot</code>. The pivot view supports an arbitrary amount of group and measure fields. Nothing will break if you switch to a mode that doesn’t support the number of groups and measures you defined; some fields will just be ignored, and the result might<a id="_idIndexMarker684"/> not be as interesting<a id="_idIndexMarker685"/> as it could be.</p>
			<h2 id="_idParaDest-457"><a id="_idTextAnchor531"/>There’s more...</h2>
			<p>For all graph types, <code>Datetime</code> fields are tricky to group because you’ll rarely encounter the same field value here. So, if you have a <code>Datetime</code> field of the <code>row</code> type, also specify the <code>interval</code> attribute with one of the following values: <code>day</code>, <code>week</code>, <code>month</code>, <code>quarter</code>, or <code>year</code>. This will cause the grouping to take place in the given interval.</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Grouping, like sorting, relies heavily on PostgreSQL. So, the rule applies here also that a field must live in the database and in the current table in order to be usable.</p>
			<p class="callout">It is a common practice to define database views that collect all the data you need and define a model on top of this view in order to have all the necessary fields available.</p>
			<p class="callout">Depending on the complexity of your view and the grouping, building the graph can be quite an expensive exercise. Consider setting the <code>auto_search</code> attribute to <code>False</code> in these cases so that the user can first adjust all the parameters and only then trigger a search.</p>
			<p>The pivot table also supports grouping in columns. Use the <code>col</code> type for the fields you want to have there.</p>
			<h1 id="_idParaDest-458"><a id="_idTextAnchor532"/>Defining the cohort view</h1>
			<p>For the cohort <a id="_idIndexMarker686"/>analysis of records, the new cohort view was added in Odoo version 12. The cohort view is used to find out the life cycle of a record over a particular time span. With the cohort view, you can see the churn and retention rate of any object for a particular time.</p>
			<h2 id="_idParaDest-459"><a id="_idTextAnchor533"/>Getting ready</h2>
			<p>The <code>cohort</code> view is part of the <code>web_cohort</code> in the manifest file of your module. For our example, we will create a view to see the cohort analysis for hostel room category.</p>
			<h2 id="_idParaDest-460"><a id="_idTextAnchor534"/>How to do it...</h2>
			<p>Follow these steps<a id="_idIndexMarker687"/> to add the <code>cohort</code> view for the <code>hostel.room.category</code> model:</p>
			<ol>
				<li>Define a <code>cohort</code> view:<pre class="source-code">
&lt;record id="hostel_room_category_view_cohort" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Cohort&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;cohort date_start="date_assign" date_stop="date_end" interval="month" string="Categories Cohort" /&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Add menus and actions using this view. This is left as an exercise for the reader.</li>
			</ol>
			<h2 id="_idParaDest-461"><a id="_idTextAnchor535"/>How it works...</h2>
			<p>To create a cohort view, you need to provide <code>date_start</code> and <code>date_stop</code>. These will be used in the view to determine the time span of any record. For example, if you are managing a subscription of a service, the start date of the subscription will be <code>date_start</code> and the date when the subscription is going to expire will be <code>date_stop</code>.</p>
			<p>By default, the <code>cohort</code> view will be <a id="_idIndexMarker688"/>displayed in the <code>retention</code> mode at intervals of a month. You can use the given options to obtain different behaviors in the <code>cohort</code> view:</p>
			<ul>
				<li><code>mode</code>: You can use cohort with two modes: <code>retention (default)</code> or <code>churn</code>. The <code>retention</code> mode starts at 100% and decreases with time, while the <code>churn</code> mode starts at 0% and increases with time.</li>
				<li><code>timeline</code>: This option accepts two values: <code>forward (default)</code> or <code>backward</code>. In most cases, you need to use the forward timeline. However, if <code>date_start</code> is in the future, you will need to use the backward timeline. An example of when we would use the backward timeline would be for the registration of an event attendee where the event date is in the future, and the registration date is in the past.</li>
				<li><code>interval</code>: By default, the cohort is grouped by month, but you can change this in the interval options. Other than months, the cohort also supports day, week, and year intervals.</li>
				<li><code>measure</code>: Just like graph and pivot, measure is used to display the aggregated value of a given field. If no option<a id="_idIndexMarker689"/> is given, the cohort will display the count of records.</li>
			</ul>
			<h1 id="_idParaDest-462"><a id="_idTextAnchor536"/>Defining the gantt view</h1>
			<p>Odoo version 13 added a new <code>gantt</code> view<a id="_idIndexMarker690"/> with new options. The <code>gantt</code> view is useful for seeing overall progress and scheduling business processes. In this recipe, we will create a new <code>gantt</code> view and look at its options.</p>
			<h2 id="_idParaDest-463"><a id="_idTextAnchor537"/>Getting ready</h2>
			<p>The <code>gantt</code> view is part of the Odoo Enterprise edition, so you can’t use it with the Community edition. If you are using the Enterprise edition, you need to add the <code>web_gantt</code> dependency in the manifest file of your module.</p>
			<p>In our example, we will continue using the <code>my_hostel</code> module from the previous recipe. We will create a new <code>gantt</code> view for the hostel room category.</p>
			<h2 id="_idParaDest-464"><a id="_idTextAnchor538"/>How to do it...</h2>
			<ol>
				<li>Define a <code>gantt</code> view for the hostel room category model as follows:<pre class="source-code">
&lt;record id="hostel_room_category_view_gantt" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Gantt&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;gantt date_start="date_assign" date_stop="date_end" string="Hostel Room Category" default_group_by="parent_id" color="parent_id"&gt;
            &lt;field name="name"/&gt;
            &lt;field name="parent_id"/&gt;
            &lt;templates&gt;
                &lt;div t-name="gantt-popover" &gt;
                    &lt;ul class="pl-1 mb-0 list-unstyled"&gt;
                        &lt;li&gt;
                            &lt;strong&gt;Name: &lt;/strong&gt;
                            &lt;t t-esc="name"/&gt;
                       &lt;/li&gt;
                       &lt;li&gt;
                            &lt;strong&gt;Parent Category: &lt;/strong&gt;
                            &lt;t t-esc="parent_id[1]"/&gt;
                       &lt;/li&gt;
                   &lt;/ul&gt;
               &lt;/div&gt;
           &lt;/templates&gt;
       &lt;/gantt&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Add menus and actions using this view. This is left as an exercise for the reader.</li>
			</ol>
			<p>Install and update the module<a id="_idIndexMarker691"/> to apply the changes; after the update, you will see the <code>gantt</code> view on the hostel room category.</p>
			<h2 id="_idParaDest-465"><a id="_idTextAnchor539"/>How it works...</h2>
			<p>With the <code>gantt</code> view, you can display an overall schedule on one screen. In our example, we have created a <code>gantt</code> view for the hostel room category grouped by parent. Typically, you need two attributes to create a <code>gantt</code> view, <code>start_date</code>, and <code>stop_date</code>, but there are some other attributes that extend the functionality of the <code>gantt</code> view. Let’s see all the options:</p>
			<ul>
				<li><code>start_date</code>: Defines the starting time of the <code>gantt</code> item. It must be a date or date-time field.</li>
				<li><code>default_group_by</code>: Use this attribute if you want to group the <code>gantt</code> items based on field.</li>
				<li><code>color</code>: This attribute is used to decide the color of a <code>gantt</code> item.</li>
				<li><code>progress</code>: This attribute is used to indicate the progress of a <code>gantt</code> item.</li>
				<li><code>decoration-*</code>: Decoration attributes are used to decide the color of a gantt item based on conditions. It can be used like this: <code>decoration-danger="state == 'lost'"</code>. Its other values are <code>decoration-success</code>, <code>decoration-info</code>, <code>decoration-warning</code>, and <code>decoration-secondary</code>.</li>
				<li><code>scales</code>: Use the <code>scales</code> attribute if you want to enable the <code>gantt</code> view only for a few scales. For example, if you only want day and week scales, you can use <code>scales="day,week"</code>.</li>
				<li>By default, <code>gantt</code> view items are resizable and draggable, but if you want to disable that, you can use<a id="_idIndexMarker692"/> the <code>edit="0"</code> attribute.</li>
			</ul>
			<h2 id="_idParaDest-466"><a id="_idTextAnchor540"/>There’s more...</h2>
			<p>When you hover over a <code>gantt</code> view item, you will see the name and date for the item. If you want to customize<a id="_idIndexMarker693"/> that popup, you can define a <code>gantt</code> view definition like this:</p>
			<pre class="source-code">
&lt;gantt date_start="date_assign" date_stop="date_end" string="Hostel Room Category" default_group_by="parent_id" color="parent_id"&gt;
    &lt;field name="name"/&gt;
    &lt;field name="parent_id"/&gt;
    &lt;templates&gt;
        &lt;div t-name="gantt-popover" &gt;
             &lt;ul class="pl-1 mb-0 list-unstyled"&gt;
                  &lt;li&gt;
                      &lt;strong&gt;Name: &lt;/strong&gt;
                          &lt;t t-esc="name"/&gt;
                       &lt;/li&gt;
                       &lt;li&gt;
                           &lt;strong&gt;Parent Category: &lt;/strong&gt;
                           &lt;t t-esc="parent_id[1]"/&gt;
                       &lt;/li&gt;
                   &lt;/ul&gt;
               &lt;/div&gt;
           &lt;/templates&gt;
       &lt;/gantt&gt;</pre>			<p>Note that you will need to add<a id="_idIndexMarker694"/> the fields that you want to use in the template via the <code>&lt;</code><code>field&gt;</code> tag.</p>
			<h1 id="_idParaDest-467"><a id="_idTextAnchor541"/>Defining the activity view</h1>
			<p>Activities are an important<a id="_idIndexMarker695"/> part of Odoo apps. They are used to schedule to-do actions for different business objects. The <code>activity</code> view helps you to see the statuses and schedules of all activities on the model.</p>
			<h2 id="_idParaDest-468"><a id="_idTextAnchor542"/>Getting ready</h2>
			<p>In our example, we will continue using the <code>my_hostel</code> module from the previous recipe. We will create a new <code>activity</code> view for the hostel room category.</p>
			<h2 id="_idParaDest-469"><a id="_idTextAnchor543"/>How to do it...</h2>
			<ol>
				<li>Define a <code>activity</code> view<a id="_idIndexMarker696"/> for the <code>hostel room category</code> model as follows:<pre class="source-code">
&lt;record id="hostel_room_category_view_activity" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Activity&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;activity string="Hostel Room Category"&gt;
            &lt;templates&gt;
                &lt;div t-name="activity-box"&gt;
                    &lt;div&gt;
                        &lt;field name="name" display="full"/&gt;
                        &lt;field name="parent_id" muted="1" display="full"/&gt;
                   &lt;/div&gt;
               &lt;/div&gt;
           &lt;/templates&gt;
       &lt;/activity&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Add menus and actions using this view. This is left as an exercise for the reader.</li>
			</ol>
			<h2 id="_idParaDest-470"><a id="_idTextAnchor544"/>How it works...</h2>
			<p>The <code>activity</code> view is simplistic; most of the things are managed automatically. You just have the option to customize the first column. To display your data in the first column, you need to create a QWeb template with the name <code>activity-box</code>, and that’s it; Odoo will manage the rest.</p>
			<p>The <code>activity</code> view will display<a id="_idIndexMarker697"/> your template in the first column, and other columns will show the scheduled activities grouped by activity type.</p>
			<h1 id="_idParaDest-471"><a id="_idTextAnchor545"/>Defining the map view</h1>
			<p>Odoo version 13 adds<a id="_idIndexMarker698"/> a new view called a <code>map</code> view. As its name suggests, it is used to show a map with a marker. They are very useful for on-site services.</p>
			<h2 id="_idParaDest-472"><a id="_idTextAnchor546"/>Getting ready</h2>
			<p>In our example, we will continue using the <code>my_hostel</code> module from the previous recipe. We will create the new <code>map</code> view for the hostel room category. The <code>map</code> view is part of the <code>web_map</code> dependency in the manifest file of your module.</p>
			<p>Odoo uses the API from <a href="https://www.mapbox.com/">https://www.mapbox.com/</a> to display maps<a id="_idIndexMarker699"/> in the view. In order to see the map in Odoo, you will need to generate the access token from the <strong class="bold">mapbox</strong>. Make sure you have generated an access token and set it in the Odoo configuration.</p>
			<h2 id="_idParaDest-473"><a id="_idTextAnchor547"/>How to do it…</h2>
			<ol>
				<li>Define a <code>map</code> view for the hostel<a id="_idIndexMarker700"/> room category model as follows:<pre class="source-code">
&lt;record id="hostel_room_category_view_map" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Map&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;map&gt;
            &lt;field name="name" string="Title "/&gt;
            &lt;field name="parent_id" string="Hostel Room Category "/&gt;
        &lt;/map&gt;
    &lt;/field&gt;
ss&lt;/record&gt;</pre></li>				<li>Add menus and actions using this view. This is left as an exercise for the reader.</li>
			</ol>
			<h2 id="_idParaDest-474"><a id="_idTextAnchor548"/>How it works...</h2>
			<p>Creating a map view is pretty simple; you just need a <code>many2one</code> field that refers to the <code>hostel.room.category</code> model. The <code>hostel.room.category</code> model has <code>address</code> fields, which are used by the map view to display the marker for the address. You will need to use the <code>res_partner</code> attribute to map the address for the <code>map</code> view. In our case, we have used the <code>parent_id</code> field as the hostel room category parent record<a id="_idIndexMarker701"/> set in the <code>parent_id</code> field.</p>
		</div>
	</body></html>