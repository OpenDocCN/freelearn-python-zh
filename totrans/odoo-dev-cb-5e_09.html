<html><head></head><body>
		<div id="_idContainer067">
			<h1 id="_idParaDest-372" class="chapter-number"><a id="_idTextAnchor446"/>9</h1>
			<h1 id="_idParaDest-373"><a id="_idTextAnchor447"/>Backend Views</h1>
			<p>In all previous chapters, you have seen the server and database side of Odoo. In this chapter, you will see the UI side of Odoo. You will learn how to create different types of views. Aside from the views, this chapter also covers other components, such as action buttons, menus, and widgets, which will help you make your application more user-friendly. After completing this chapter, you will be able to design the UI of an Odoo backend. Note that this chapter does not cover the website part of Odoo; we have a separate chapter (<em class="italic">14</em>) <span class="No-Break">for that.</span></p>
			<p>In this chapter, we will cover the <span class="No-Break">following recipes:</span></p>
			<ul>
				<li>Adding a menu item and <span class="No-Break">window actions</span></li>
				<li>Having an action open a <span class="No-Break">specific view</span></li>
				<li>Adding content and widgets to a <span class="No-Break">form view</span></li>
				<li>Adding buttons <span class="No-Break">to forms</span></li>
				<li>Passing parameters to forms and actions – <span class="No-Break">Context</span></li>
				<li>Defining filters on record lists – <span class="No-Break">Domain</span></li>
				<li>Defining <span class="No-Break">list views</span></li>
				<li>Defining <span class="No-Break">search views</span></li>
				<li>Adding a search filter <span class="No-Break">side panel</span></li>
				<li>Changing existing views – <span class="No-Break">View inheritance</span></li>
				<li>Defining <span class="No-Break">document-style forms</span></li>
				<li>Dynamic form elements <span class="No-Break">using attributes</span></li>
				<li>Defining <span class="No-Break">embedded views</span></li>
				<li>Displaying attachments on the side of the <span class="No-Break">form view</span></li>
				<li>Defining <span class="No-Break">kanban views</span></li>
				<li>Showing kanban cards in columns according to <span class="No-Break">their state</span></li>
				<li>Defining <span class="No-Break">calendar views</span></li>
				<li>Defining graph view and <span class="No-Break">pivot view</span></li>
				<li>Defining the <span class="No-Break">cohort view</span></li>
				<li>Defining the <span class="No-Break">gantt view</span></li>
				<li>Defining the <span class="No-Break">activity view</span></li>
				<li>Defining the <span class="No-Break">map view</span></li>
			</ul>
			<h1 id="_idParaDest-374"><a id="_idTextAnchor448"/>Technical requirements</h1>
			<p>Throughout this chapter, we will assume that you have a database with the base add-on installed and an empty Odoo add-on module where you can add XML code from the recipes to a data file referenced in the add-on’s manifest. Refer to <a href="B20997_03.xhtml#_idTextAnchor083"><span class="No-Break"><em class="italic">Chapter 3</em></span></a>, <em class="italic">Creating Odoo Add-On Modules</em>, for more information on how to activate changes in <span class="No-Break">your add-on.</span></p>
			<p>The technical requirements for this chapter include an online <span class="No-Break">Odoo platform.</span></p>
			<p>All of the code used in this chapter can be downloaded from the GitHub repository <span class="No-Break">at </span><a href="https://github.com/PacktPublishing/Odoo-17-Development-Cookbook-Fifth-Edition/tree/main/Chapter09"><span class="No-Break">https://github.com/PacktPublishing/Odoo-17-Development-Cookbook-Fifth-Edition/tree/main/Chapter09</span></a><span class="No-Break">.</span></p>
			<h1 id="_idParaDest-375"><a id="_idTextAnchor449"/>Adding a menu item and window actions</h1>
			<p>The most obvious way<a id="_idIndexMarker533"/> to make<a id="_idIndexMarker534"/> a new feature available to users is by adding a menu item. When you click on a <strong class="bold">Menu</strong> item, something happens. This recipe walks you through how to define <span class="No-Break">that something.</span></p>
			<p>We will create a top-level menu and its sub-menu, which will open a list of all <span class="No-Break">hostel rooms.</span></p>
			<p>This can also be done using the <strong class="bold">web user interface</strong> through the <strong class="bold">Settings</strong> menu, but we prefer to use XML data files since this is what we’ll have to use when creating our <span class="No-Break">add-on modules.</span></p>
			<h2 id="_idParaDest-376"><a id="_idTextAnchor450"/>Getting ready</h2>
			<p>In this recipe, we will<a id="_idIndexMarker535"/> need a module<a id="_idIndexMarker536"/> with a dependency on the <strong class="source-inline">base</strong> module, as the <strong class="source-inline">my_hostel</strong> module adds new models to the <strong class="source-inline">hostel.room</strong>. So, if you are using an existing module, please add the <strong class="source-inline">base</strong> dependency in the manifest. Alternatively, you can grab the initial module <span class="No-Break">from </span><a href="https://github.com/PacktPublishing/Odoo-17-Development-Cookbook-Fifth-Edition/tree/main/Chapter09/00_initial_module"><span class="No-Break">https://github.com/PacktPublishing/Odoo-17-Development-Cookbook-Fifth-Edition/tree/main/Chapter09/00_initial_module</span></a><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-377"><a id="_idTextAnchor451"/>How to do it...</h2>
			<p>In an XML data file of our add-on module, perform the <span class="No-Break">following steps:</span></p>
			<ol>
				<li>Define an action to <span class="No-Break">be executed:</span><pre class="source-code">
&lt;record id="action_hostel_room" model="ir.actions.act_window"&gt;
    &lt;field name="name"&gt;All Hostel Room&lt;/field&gt;
    &lt;field name="res_model"&gt;hostel.room&lt;/field&gt;
    &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Create the top-level menu, which will be <span class="No-Break">as follows:</span><pre class="source-code">
    &lt;menuitem id="menu_custom_hostel_room"
    name="Hostel Room" web_icon="my_hostel,static/description/icon.png"/&gt;</pre></li>				<li>Refer to our action in <span class="No-Break">the menu:</span><pre class="source-code">
&lt;menuitem id="menu_all_hostel_room"
    parent="menu_custom_hostel_room" action="action_hostel_room"       sequence="10" groups="" /&gt;</pre></li>			</ol>
			<p>If we now upgrade the module, we will see a top-level menu with the label <strong class="bold">Hostel Room</strong> that opens a sub-menu called <strong class="bold">All Hostel Room</strong>. Clicking on that menu item will open a list of all <span class="No-Break">hostel rooms.</span></p>
			<h2 id="_idParaDest-378"><a id="_idTextAnchor452"/>How it works...</h2>
			<p>The first XML<a id="_idIndexMarker537"/> element, <strong class="source-inline">record model="ir.actions.act_window"</strong>, declares a window<a id="_idIndexMarker538"/> action to display a list view with all the hostel rooms. We used the most <span class="No-Break">important attributes:</span></p>
			<ul>
				<li><strong class="source-inline">name</strong>: To be used as the title for the views opened by <span class="No-Break">the action.</span></li>
				<li><strong class="source-inline">res_model</strong>: This is the model to be used. We are using <strong class="source-inline">hostel.room</strong>, where Odoo stores all <span class="No-Break"><strong class="source-inline">hostel room</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">view_mode</strong>: This lists the view types to make available. It is a comma-separated values file of the views type. The default value is <strong class="source-inline">tree, form</strong>, which makes a list and form view available. If you just want to show the calendar and form views, then the value of <strong class="source-inline">view_mode</strong> should be <strong class="source-inline">calendar, form</strong>. Other possible view choices are <strong class="source-inline">kanban</strong>, <strong class="source-inline">graph</strong>, <strong class="source-inline">pivot</strong>, <strong class="source-inline">calendar</strong>, and <strong class="source-inline">cohort</strong>. You will learn more about these views in <span class="No-Break">forthcoming recipes.</span></li>
				<li><strong class="source-inline">domain</strong>: This is optional and allows you to set a filter on the records to be made available in the views. We will see all of these views in more detail in the <em class="italic">Defining filters on record lists – Domain</em> recipe of <span class="No-Break">this chapter.</span></li>
				<li><strong class="source-inline">context</strong>: This can set values made available to the opened views, affecting their behavior. In our example, on new records, we want the room rank’s default value to be <strong class="source-inline">1</strong>. This will be covered in more depth in the <em class="italic">Passing parameters to forms and actions – Context</em> recipe of <span class="No-Break">this chapter.</span></li>
				<li><strong class="source-inline">limit</strong>: This sets the default amount of records that can be seen on list views. In our example, we have given a limit of <strong class="source-inline">20</strong>, but if you don’t give a <strong class="source-inline">limit</strong> value, Odoo will use the default value <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">80</strong></span><span class="No-Break">.</span></li>
			</ul>
			<p>Next, we create the menu<a id="_idIndexMarker539"/> item hierarchy <a id="_idIndexMarker540"/>from the top-level menu to the clickable end menu item. The most important attributes of the <strong class="source-inline">menuitem</strong> element are <span class="No-Break">as follows:</span></p>
			<ul>
				<li><strong class="source-inline">name</strong>: This is used as the text that the menu items display. If your menu item links to an action, you can leave this out because the action’s name will be used in <span class="No-Break">that case.</span></li>
				<li><strong class="source-inline">parent</strong> (<strong class="source-inline">parent_id</strong> if using the <strong class="source-inline">record</strong> element): This is the XML ID that references the parent menu item. Items with no parents are <span class="No-Break">top-level menus.</span></li>
				<li><strong class="source-inline">action</strong>: This is the XML ID that references the action to <span class="No-Break">be called.</span></li>
				<li><strong class="source-inline">sequence</strong>: This is used to order the sibling <span class="No-Break">menu items.</span></li>
				<li><strong class="source-inline">groups</strong> (<strong class="source-inline">groups_id</strong> with the <strong class="source-inline">record</strong> tag): This is an optional list of user groups that can access the menu item. If empty, it will be available to <span class="No-Break">all users.</span></li>
				<li><strong class="source-inline">web_icon</strong>: This option only works on the top-level menu. It will display an icon of your application in the <span class="No-Break">Enterprise edition.</span></li>
			</ul>
			<p>Window actions automatically determine the view to be used by looking up views for the target model with the intended type (<strong class="source-inline">form</strong>, <strong class="source-inline">tree</strong>, and so on) and picking the one with the lowest sequence number. <strong class="source-inline">ir.actions.act_window</strong> and <strong class="source-inline">menuitem</strong> are convenient shortcut XML tags that hide what you’re actually doing. If you don’t want to use the shortcut XML tags, then you can create a record of the <strong class="source-inline">ir.actions.act_window</strong> and <strong class="source-inline">ir.ui.menu</strong> models via the <strong class="source-inline">&lt;record&gt;</strong> tag. For example, if you want to load <strong class="source-inline">act_window</strong> with <strong class="source-inline">&lt;record&gt;</strong>, you can do so <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
&lt;record id="action_hostel_room" model="ir.actions.act_window"&gt;
    &lt;field name="name"&gt;All Hostel Room&lt;/field&gt;
    &lt;field name="res_model"&gt;hostel.room&lt;/field&gt;
    &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;
    &lt;field name="context"&gt;{'default_room_rating': 1.0}&lt;/field&gt;
    &lt;field name="domain"&gt;[('state', '=', 'draft')]&lt;/field&gt;
&lt;/record&gt;</pre>			<p>In the same way, you can create a <strong class="source-inline">menuitem</strong> instance <span class="No-Break">through </span><span class="No-Break"><strong class="source-inline">&lt;record&gt;</strong></span><span class="No-Break">.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Be aware that names used with the <strong class="source-inline">menuitem</strong> shortcut may not map to the field names that are used when using a <strong class="source-inline">record</strong> element; <strong class="source-inline">parent</strong> should be <strong class="source-inline">parent_id</strong> and <strong class="source-inline">groups</strong> should <span class="No-Break">be </span><span class="No-Break"><strong class="source-inline">groups_id</strong></span><span class="No-Break">.</span></p>
			<p>To build the menu, the web client<a id="_idIndexMarker541"/> reads all the<a id="_idIndexMarker542"/> records from <strong class="source-inline">ir.ui.menu</strong> and infers their hierarchy from the <strong class="source-inline">parent_id</strong> field. The menus are also filtered based on user permissions to models and groups assigned to menus and actions. When a user clicks on a menu item, its <strong class="source-inline">action</strong> <span class="No-Break">is executed.</span></p>
			<h2 id="_idParaDest-379"><a id="_idTextAnchor453"/>There’s more…</h2>
			<p>Window actions also support a <strong class="source-inline">target</strong> attribute to specify how the view is to be presented. The possible choices are <span class="No-Break">as follows:</span></p>
			<ul>
				<li><strong class="bold">current</strong>: This is the default and opens the view in the web client’s main <span class="No-Break">content area.</span></li>
				<li><strong class="bold">new</strong>: This opens the view in <span class="No-Break">a popup.</span></li>
				<li><strong class="bold">inline</strong>: This is like <strong class="bold">current,</strong> but it opens a form in edit mode and disables the <span class="No-Break"><strong class="bold">Action</strong></span><span class="No-Break"> menu.</span></li>
				<li><strong class="bold">Fullscreen</strong>: The action will cover the whole browser window, so this will overlay <a id="_idIndexMarker543"/>the menus, too. Sometimes, this is called <span class="No-Break"><strong class="bold">tablet mode</strong></span><span class="No-Break">.</span></li>
				<li><strong class="bold">main</strong>: This is like <strong class="bold">current</strong>, but it also clears out <span class="No-Break">the breadcrumbs.</span></li>
			</ul>
			<p>There are also some additional attributes available for window actions that are not supported by the <strong class="source-inline">ir.actions.act_window</strong> shortcut tag. To use them, we must use the <strong class="source-inline">record</strong> element with the <span class="No-Break">following fields:</span></p>
			<ul>
				<li><strong class="source-inline">res_id</strong>: If opening a form, you can use it to open a specific record by setting its ID here. This can be useful for multi-step wizards or in cases when you have to view or edit a specific <span class="No-Break">record frequently.</span></li>
				<li><strong class="source-inline">search_view_id</strong>: This specifies a specific search view to use for tree and <span class="No-Break">graph views.</span></li>
			</ul>
			<p>Keep in mind that the menu in the top left (or the apps icon in the Enterprise version) and the menu in the bar at the top are both made up of menu items. The only difference is that the items in the menu in the top left don’t have any parent menus, while the ones on the top bar have the respective menu items from the top bar as a parent. In the left bar, the hierarchical structure is <span class="No-Break">more obvious.</span></p>
			<p>Additionally, bear in mind that for design reasons, the first-level menus will open the dropdown menu if your second-level menu has child menus. In any case, Odoo will open the first menu item’s action based on the sequence of child <span class="No-Break">menu items.</span></p>
			<p>Refer to the following to learn more<a id="_idIndexMarker544"/> about menus<a id="_idIndexMarker545"/> <span class="No-Break">and views:</span></p>
			<ul>
				<li>The <strong class="source-inline">ir.actions.act_window</strong> action type is the most common action type, but a menu can refer to any type of action. Technically, it is the same if you link to a client action, a server action, or any other model defined in the <strong class="source-inline">ir.actions.*</strong> namespace. It just differs in what the backend makes of <span class="No-Break">the action.</span></li>
				<li>If you need just a tiny bit more flexibility in the concrete action to be called, look into server actions that return a window action. If you need complete flexibility, take a look at the client actions (<strong class="source-inline">ir.actions.client</strong>), which allow you to have a completely custom user interface. However, only do this as a last resort as you lose a lot of Odoo’s convenient helpers when <span class="No-Break">using them.</span></li>
			</ul>
			<h2 id="_idParaDest-380"><a id="_idTextAnchor454"/>See also</h2>
			<ul>
				<li>For a detailed explanation of filters in all of the views, have a look at the <em class="italic">Defining filters on record lists – Domain</em> recipe in <span class="No-Break">this chapter.</span></li>
			</ul>
			<h1 id="_idParaDest-381"><a id="_idTextAnchor455"/>Having an action open a specific view</h1>
			<p>Window actions automatically determine<a id="_idIndexMarker546"/> the view to be used if none is given, but sometimes, we want an action to open a <span class="No-Break">specific view.</span></p>
			<p>We will create a basic form view for the <strong class="source-inline">hostel.room</strong> model, and then we will create a new window action specifically to open that <span class="No-Break">form view.</span></p>
			<h2 id="_idParaDest-382"><a id="_idTextAnchor456"/>How to do it...</h2>
			<ol>
				<li>Define the <strong class="source-inline">hostel room</strong> minimal tree and <span class="No-Break">form view:</span><pre class="source-code">
<strong class="bold">&lt;record id="hostel_room_view_tree" model="ir.ui.view"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;Hostel Room List&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    </strong><strong class="bold">&lt;field name="arch" type="xml"&gt;</strong>
<strong class="bold">        &lt;tree&gt;</strong>
<strong class="bold">        &lt;field name="name"/&gt;</strong>
<strong class="bold">            &lt;field name="room_no"/&gt;</strong>
<strong class="bold">            &lt;field name="state"/&gt;</strong>
<strong class="bold">        &lt;/tree&gt;</strong>
<strong class="bold">    &lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong>
<strong class="bold">&lt;record id="hostel_room_view_form" model="ir.ui.view"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;Hostel Room Form&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    </strong><strong class="bold">&lt;field name="arch" type="xml"&gt;</strong>
<strong class="bold">        &lt;form&gt;</strong>
<strong class="bold">            &lt;header&gt;</strong>
<strong class="bold">                &lt;button name="make_available" string="Make Available" type="object"/&gt;</strong>
<strong class="bold">                &lt;button name="make_closed"  string="Make Closed" type="object"/&gt;</strong>
<strong class="bold">                &lt;field name="state" widget="statusbar"/&gt;</strong>
<strong class="bold">            &lt;/header&gt;</strong>
<strong class="bold">            &lt;group&gt;</strong>
<strong class="bold">                &lt;group&gt;</strong>
<strong class="bold">                    </strong><strong class="bold">&lt;field name="name"/&gt;</strong>
<strong class="bold">                    &lt;field name="room_no"/&gt;</strong>
<strong class="bold">                &lt;/group&gt;</strong>
<strong class="bold">                &lt;group&gt;</strong>
<strong class="bold">                    &lt;field name="description"/&gt;</strong>
<strong class="bold">                &lt;/group&gt;</strong>
<strong class="bold">            &lt;/group&gt;</strong>
<strong class="bold">        &lt;/form&gt;</strong>
<strong class="bold">    &lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Update the action<a id="_idIndexMarker547"/> from the <em class="italic">Adding a menu item and window action</em> recipe to use a new <span class="No-Break">form view:</span><pre class="source-code">
<strong class="bold">&lt;record id="action_hostel_room_tree" model="ir.actions.act_window.view"&gt;</strong>
<strong class="bold">    &lt;field name="act_window_id" ref="action_hostel_room" /&gt;</strong>
<strong class="bold">    &lt;field name="view_id" ref="hostel_room_view_tree" /&gt;</strong>
<strong class="bold">    &lt;field name="view_mode"&gt;tree&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="sequence" eval="1"/&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong>
<strong class="bold">&lt;record id="action_hostel_room_form" model="ir.actions.act_window.view"&gt;</strong>
<strong class="bold">    &lt;field name="act_window_id" ref="action_hostel_room" /&gt;</strong>
<strong class="bold">    &lt;field name="view_id" ref="hostel_room_view_form" /&gt;</strong>
<strong class="bold">    &lt;field name="view_mode"&gt;form&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="sequence" eval="2"/&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>			</ol>
			<p>Now, if you open your menu<a id="_idIndexMarker548"/> and click on a <strong class="bold">partner</strong> in the list, you should see the very minimal form and tree that we <span class="No-Break">just defined.</span></p>
			<h2 id="_idParaDest-383"><a id="_idTextAnchor457"/>How it works...</h2>
			<p>This time, we used the generic XML code for any type of record, that is, the <strong class="source-inline">record</strong> element with the required <strong class="source-inline">id</strong> and <strong class="source-inline">model</strong> attributes. The <strong class="source-inline">id</strong> attribute on the <strong class="source-inline">record</strong> element is an arbitrary string that must be unique for your add-on. The <strong class="source-inline">model</strong> attribute refers to the name of the model you want to create. Given that we want to create a view, we need to create a record of the <strong class="source-inline">ir.ui.view</strong> model. Within this element, you set fields as defined in the model you chose through the <strong class="source-inline">model</strong> attribute. For <strong class="source-inline">ir.ui.view</strong>, the crucial fields are <strong class="source-inline">model</strong> and <strong class="source-inline">arch</strong>. The <strong class="source-inline">model</strong> field contains the model for which you want to define a view, while the <strong class="source-inline">arch</strong> field contains the definition of the view itself. We’ll come to its contents in a <span class="No-Break">short while.</span></p>
			<p>The <strong class="source-inline">name</strong> field, while not strictly necessary, is helpful when debugging problems with views. So, set it to a string that tells you what this view is intended to do. This field’s content is not shown to the user, so you can fill in any technical hints that you deem sensible. If you set nothing<a id="_idIndexMarker549"/> here, you’ll get a default name that contains the model name and <span class="No-Break">view type.</span></p>
			<h3>ir.actions.act_window.view</h3>
			<p>The second record<a id="_idIndexMarker550"/> we defined works in tandem with <strong class="source-inline">act_window</strong>, which we defined earlier in the <em class="italic">Adding a menu item and window action</em> recipe. We already know that by setting the <strong class="source-inline">view_id</strong> field there, we can select which view is used for the first view mode. However, given that we set the <strong class="source-inline">view_mode</strong> field to the <strong class="source-inline">tree, form</strong> view, <strong class="source-inline">view_id</strong> would have to pick a tree view, but we want to set the form view, which comes <span class="No-Break">second here.</span></p>
			<p>If you find yourself in a situation like this, use the <strong class="source-inline">ir.actions.act_window.view</strong> model, which gives you fine-grained control over which views to load for which view type. The first two fields defined here are examples of the generic way to refer to other objects; you keep the element’s body empty but add an attribute called <strong class="source-inline">ref</strong>, which contains the XML ID of the object you want to reference. So, what happens here is we refer to our action from the previous recipe in the <strong class="source-inline">act_window_id</strong> field and refer to the view we just created in the <strong class="source-inline">view_id</strong> field. Then, though not strictly necessary, we add a sequence number to position this view assignment relative to the other view assignments for the same action. This is only relevant if you assign views for different view modes by creating multiple <span class="No-Break"><strong class="source-inline">ir.actions.act_window.view</strong></span><span class="No-Break"> records.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Once you define the <strong class="source-inline">ir.actions.act_window.view</strong> records, they take precedence over what you filled in the action’s <strong class="source-inline">view_mode</strong> field. So, with the preceding records, you won’t see a list at all, but only a form. You should add another <strong class="source-inline">ir.actions.act_window.view</strong> record that points to a list view for the <span class="No-Break"><strong class="source-inline">hostel.room</strong></span><span class="No-Break"> model.</span></p>
			<h2 id="_idParaDest-384"><a id="_idTextAnchor458"/>There’s more...</h2>
			<p>As we saw in the <em class="italic">Adding a menu item and window action</em> recipe, we can replace <strong class="source-inline">act_window</strong> with <strong class="source-inline">&lt;record&gt;</strong>. If you want to use a custom view, you can follow the <span class="No-Break">given syntax:</span></p>
			<pre class="source-code">
&lt;record id="action_hostel_room" model="ir.actions.act_window"&gt;
    &lt;field name="name"&gt;All Hostel Room&lt;/field&gt;
    &lt;field name="res_model"&gt;hostel.room&lt;/field&gt;
    &lt;field name="view_id" ref="hostel_room_view_tree"/&gt;
    &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;
&lt;/record&gt;</pre>			<p>This example is just an alternative to <strong class="source-inline">act_window</strong>. In the code base of Odoo, you will find both types <span class="No-Break">of action.</span></p>
			<h1 id="_idParaDest-385"><a id="_idTextAnchor459"/>Adding content and widgets to a form view</h1>
			<p>The preceding recipe<a id="_idIndexMarker551"/> showed how to pick<a id="_idIndexMarker552"/> a specific view<a id="_idIndexMarker553"/> for an<a id="_idIndexMarker554"/> action. Now, we’ll demonstrate how to make the form view more useful. In this recipe, we will use the <strong class="bold">form view</strong> that we defined earlier in the <em class="italic">Having an action open a specific view</em> recipe. In the form view, we will add the widgets <span class="No-Break">and content.</span></p>
			<h2 id="_idParaDest-386"><a id="_idTextAnchor460"/>How to do it...</h2>
			<ol>
				<li>Define the basic structure of the <span class="No-Break">form view:</span><pre class="source-code">
&lt;record id="hostel_room_view_form" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Form&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
    &lt;form&gt;
        &lt;!--form content goes here --&gt;
    &lt;/form&gt;
&lt;/record&gt;</pre></li>				<li>To add a head<a id="_idIndexMarker555"/> bar, which is usually <a id="_idIndexMarker556"/>used for action<a id="_idIndexMarker557"/> buttons<a id="_idIndexMarker558"/> and stage pipelines, add this inside <span class="No-Break">the form:</span><pre class="source-code">
&lt;header&gt;
    &lt;button name="make_available" string="Make Available" type="object"/&gt;
    &lt;button name="make_closed"  string="Make Closed" type="object"/&gt;
    &lt;field name="state" widget="statusbar"/&gt;
&lt;/header&gt;</pre></li>				<li>Add fields to the form, using <strong class="source-inline">group</strong> tags to organize <span class="No-Break">them visually:</span><pre class="source-code">
&lt;group string="Content" name="my_content"&gt;
    &lt;field name="name"/&gt;
    &lt;field name="room_no"/&gt;
&lt;/group&gt;
&lt;group&gt;
    &lt;field name="description"/&gt;
&lt;/group&gt;
&lt;notebook&gt;
    &lt;page string="Other Information" name="other_information"&gt;
        &lt;field name="other_info" widget="html"/&gt;
    &lt;/page&gt;
&lt;/notebook&gt;</pre></li>			</ol>
			<p>Now, the form should display a top bar with a button and two vertically aligned fields, as shown in the <span class="No-Break">following screenshot:</span></p>
			<div>
				<div id="_idContainer063" class="IMG---Figure">
					<img src="image/B20997_09_1.jpg" alt="Figure 9.1 – Screenshot of the form view"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.1 – Screenshot of the form view</p>
			<h2 id="_idParaDest-387"><a id="_idTextAnchor461"/>How it works...</h2>
			<p>We’ll look at<a id="_idIndexMarker559"/> the <strong class="source-inline">arch</strong> field<a id="_idIndexMarker560"/> of the <strong class="source-inline">ir.ui.view</strong> model<a id="_idIndexMarker561"/> first. First, note<a id="_idIndexMarker562"/> that views are defined in XML, so you need to pass the <strong class="source-inline">type="xml"</strong> attribute for the <strong class="source-inline">arch</strong> field; otherwise, the parser will be confused. It is also mandatory that your view definition contains well-formed XML; otherwise, you’ll get an error such as “Element odoo has extra content” when you upgrade/install <span class="No-Break">the module.</span></p>
			<p>We’ll now walk through the tags that we used previously and summarize the others that <span class="No-Break">are available.</span></p>
			<h3>form</h3>
			<p>When you define a form<a id="_idIndexMarker563"/> view, it is mandatory that the first element within the <strong class="source-inline">arch</strong> field is a <strong class="source-inline">form</strong> element. This is used internally to derive the record’s <span class="No-Break"><strong class="source-inline">type</strong></span><span class="No-Break"> field.</span></p>
			<p>In addition to the following elements, you can use arbitrary HTML within the form tag. The algorithm has it that every element unknown to Odoo is considered plain HTML and is simply passed through to the browser. Be careful with that, as the HTML you fill in can interact with the HTML code the Odoo <a id="_idIndexMarker564"/>elements generate, which might distort <span class="No-Break">the rendering.</span></p>
			<h3>header</h3>
			<p>This element is a container for elements <a id="_idIndexMarker565"/>that should be shown in a form’s header, which is rendered as a white bar. Usually, as in this example, you place action buttons here. Alternatively, if your model has a <strong class="source-inline">state</strong> field, you could opt for a <span class="No-Break"><strong class="bold">status bar</strong></span><span class="No-Break">.</span></p>
			<h3>button</h3>
			<p>The <strong class="source-inline">button</strong> element is used to allow<a id="_idIndexMarker566"/> the user to trigger an action. Refer to the <em class="italic">Adding buttons to forms</em> recipe <span class="No-Break">for details.</span></p>
			<h3>&lt;group&gt;</h3>
			<p>The <strong class="source-inline">&lt;group&gt;</strong> element is Odoo’s main element <a id="_idIndexMarker567"/>and is used for organizing content. Fields placed within a <strong class="source-inline">&lt;group&gt;</strong> element are rendered with their title, and all fields within the same group are aligned so that there’s also a visual indicator that they belong together. You can also nest <strong class="source-inline">&lt;group&gt;</strong> elements; this causes Odoo to render the contained fields in <span class="No-Break">adjacent columns.</span></p>
			<p>In general, you should use the <strong class="source-inline">&lt;group&gt;</strong> mechanism to display all of your fields in the form view and only revert to the other elements, such as <strong class="source-inline">&lt;notebook&gt;</strong>, <strong class="source-inline">&lt;label&gt;</strong>, <strong class="source-inline">&lt;newline&gt;</strong>, and more, <span class="No-Break">when necessary.</span></p>
			<p>If you assign the <strong class="source-inline">string</strong> attribute to a group, its content will be rendered as a heading for <span class="No-Break">the group.</span></p>
			<p>You should develop the habit of assigning a name to every logical group of fields, too. This name is not visible to the user but is very helpful when we override views in the following recipes. Keep the name unique within the form definition to avoid confusion about which group you refer to. Don’t use the <strong class="source-inline">string</strong> attribute for this because the value of the string will eventually change because <span class="No-Break">of translations.</span></p>
			<h3>field</h3>
			<p>In order to actually show and manipulate<a id="_idIndexMarker568"/> data, your form view should contain some <strong class="source-inline">field</strong> elements. Here is <span class="No-Break">an example:</span></p>
			<pre class="source-code">
&lt;field name="other_info" widget="html"/&gt;</pre>			<p>These have one mandatory attribute, called <strong class="source-inline">name</strong>, which refers to the field’s name in the model. Earlier, we offered the user the ability to edit the partner’s categories. If we only want to disable the editing feature on a field, we can set the <strong class="source-inline">readonly</strong> attribute to <strong class="source-inline">1</strong> or <strong class="source-inline">True</strong>. This attribute may actually contain a small subset of Python code, so <strong class="source-inline">readonly="2&gt;1"</strong> will make the field read-only too. This also applies to the <strong class="source-inline">invisible</strong> attribute, for which you used to obtain a value that is read from the database but is not shown to the user. Later, we’ll take a look at which situations this can be <span class="No-Break">used in.</span></p>
			<p>You must have noticed the <strong class="source-inline">widget</strong> attribute in the <strong class="source-inline">categories</strong> field. This defines how the data in the field are supposed to be presented to the user. Every type of field has a standard widget, so you don’t have to explicitly choose a widget. However, several types provide multiple ways of representation, so you might opt for something other than the default. As a complete list of available widgets would exceed the scope of this recipe, consult <strong class="bold">Odoo’s source code</strong> to try them out. Take a look at <a href="B20997_14.xhtml#_idTextAnchor734"><span class="No-Break"><em class="italic">Chapter 14</em></span></a>, <em class="italic">CMS Website Development</em>, for details on how to make <span class="No-Break">your own.</span></p>
			<h3>&lt;notebook&gt; and &lt;page&gt;</h3>
			<p>If your model<a id="_idIndexMarker569"/> has too many<a id="_idIndexMarker570"/> fields, then you can use the <strong class="source-inline">&lt;notebook&gt;</strong> and <strong class="source-inline">&lt;page&gt;</strong> tags to create tabs. Each <strong class="source-inline">&lt;page&gt;</strong> in the <strong class="source-inline">&lt;notebook&gt;</strong> tag will create a new tab, and the content inside the page will be the tab content. The following example will create two tabs with three fields in <span class="No-Break">each tab:</span></p>
			<pre class="source-code">
&lt;notebook&gt;
    &lt;page string="Tab 1"&gt;
        &lt;field name="field1"/&gt;
        &lt;field name="field2"/&gt;
        &lt;field name="field3"/&gt;
    &lt;/page&gt;
    &lt;page string="Tab 2"&gt;
        &lt;field name="field4"/&gt;
        &lt;field name="field5"/&gt;
        &lt;field name="field6"/&gt;
    &lt;/page&gt;
&lt;/notebook&gt;</pre>			<p>The <strong class="source-inline">string</strong> attribute in the <strong class="source-inline">&lt;page&gt;</strong> tag will be the name of the tab. You can only use <strong class="source-inline">&lt;page&gt;</strong> tags in the <strong class="source-inline">&lt;notebook&gt;</strong> tag, but in the <strong class="source-inline">&lt;page&gt;</strong> tag, you <a id="_idIndexMarker571"/>can use any <span class="No-Break">other</span><span class="No-Break"><a id="_idIndexMarker572"/></span><span class="No-Break"> elements.</span></p>
			<h3>General attributes</h3>
			<p>On most elements (this includes <strong class="source-inline">group</strong>, <strong class="source-inline">field</strong>, and <strong class="source-inline">button</strong>), you <a id="_idIndexMarker573"/>can set the <strong class="source-inline">attributes</strong> and <strong class="source-inline">groups</strong> attributes. Here is a <span class="No-Break">small example:</span></p>
			<pre class="source-code">
&lt;field name="other_info"
    readonly="state == 'available'"
    groups="base.group_no_one"/&gt;</pre>			<p>While <strong class="source-inline">attributes</strong> are discussed in the <em class="italic">Dynamic form elements using attributes</em> recipe, the <strong class="source-inline">groups</strong> attribute gives you the possibility to show some elements only to members of certain groups. Simply put, the group’s full XML ID (separated by commas for multiple groups) is the attribute, and the element will be hidden for everyone who is not a member of at least one of the <span class="No-Break">groups mentioned.</span></p>
			<h3>Other tags</h3>
			<p>There are situations<a id="_idIndexMarker574"/> in which you might want to deviate from the strict layout groups prescribed. For example, if you want the <strong class="source-inline">name</strong> field of a record to be rendered as a heading, the field’s label will interfere with the appearance. In this case, don’t put your field into a <strong class="source-inline">group</strong> element but, instead, put it into a plain HTML <strong class="source-inline">h1</strong> element. Then, before the <strong class="source-inline">h1</strong> element, put a <strong class="source-inline">label</strong> element with the <strong class="source-inline">for</strong> attribute set to your <span class="No-Break"><strong class="source-inline">field name</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
&lt;label for="name" /&gt;
&lt;h1&gt;&lt;field name="name" /&gt;&lt;/h1&gt;</pre>			<p>This will be rendered with the field’s content as a big heading, but the field’s name will be written in a smaller type above the big heading. This is basically what the standard partner <span class="No-Break">form does.</span></p>
			<p>If you need a line break within a group, use the <strong class="source-inline">newline</strong> element. It’s <span class="No-Break">always empty:</span></p>
			<pre class="source-code">
&lt;newline /&gt;</pre>			<p>Another useful element is <strong class="source-inline">footer</strong>. When you open a form as a popup, this is a good place to put the action buttons. It will be rendered as a separate bar too, analogous to the <span class="No-Break"><strong class="source-inline">header</strong></span><span class="No-Break"> element.</span></p>
			<p>The form view also has special widgets, such as <strong class="source-inline">web_ribbon</strong>. You can use it with the <strong class="source-inline">&lt;widget&gt;</strong> tag <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
&lt;widget name="web_ribbon" title="Archived" bg_color="bg-danger"
invisible="active"/&gt;</pre>			<p>You can use <strong class="source-inline">attributes</strong> to hide and show the ribbon based on a condition. Don’t worry if you are not aware of <strong class="source-inline">attributes</strong>. It will be covered in the <em class="italic">Dynamic form elements using attributes</em> recipe<a id="_idIndexMarker575"/> of <span class="No-Break">this chapter.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Don’t address <strong class="bold">XML nodes</strong> using their <strong class="source-inline">string</strong> attribute (or any other translated attribute, for that matter), as your view overrides will break for other languages because views are translated before inheritance <span class="No-Break">is applied.</span></p>
			<h2 id="_idParaDest-388"><a id="_idTextAnchor462"/>There’s more…</h2>
			<p>Since form views are basically HTML with some extensions, Odoo also makes extensive use of CSS classes. Two very useful ones are <strong class="source-inline">oe_read_only</strong> and <strong class="source-inline">oe_edit_only</strong>. Elements with<a id="_idIndexMarker576"/> these classes<a id="_idIndexMarker577"/> will be visible only in <strong class="bold">read-only mode</strong> or <strong class="bold">edit mode</strong>, respectively. For example, to have the label visible only in edit mode, use <span class="No-Break">the following:</span></p>
			<pre class="source-code">
&lt;label f"r="n"me" cla"s="oe_edit_o"ly" /&gt;</pre>			<p>Another very useful class is <strong class="source-inline">oe_inline</strong>, which you can use on fields to make them render as an inline element to avoid causing unwanted line breaks. Use this class when you embed a field into text or other <span class="No-Break">markup tags.</span></p>
			<p>Furthermore, the <strong class="source-inline">form</strong> element can have the <strong class="source-inline">create</strong>, <strong class="source-inline">edit</strong>, and <strong class="source-inline">delete</strong> attributes. If you set one of these to <strong class="source-inline">false</strong>, the corresponding action ’on’t be available for this form. Without this being explicitly set, the availability of the action is inferred from the u’er’s permissions. Note that this is purely for straightening up the UI; ’on’t use this <span class="No-Break">for security.</span></p>
			<h2 id="_idParaDest-389"><a id="_idTextAnchor463"/>See also</h2>
			<p>The widgets and views already offer a lot of functionality, but sooner or later, you will have requirements that cannot be fulfilled with the existing widgets and views. Refer to the following recipes to create your own views <span class="No-Break">and widgets:</span></p>
			<ul>
				<li>Refer to the <em class="italic">Adding buttons to forms</em> recipe in this chapter for more details about using the <strong class="source-inline">button</strong> element to trigger <span class="No-Break">an action.</span></li>
				<li>To define your own widgets, refer to the <em class="italic">Creating custom widgets</em> recipe of <a href="B20997_15.xhtml#_idTextAnchor861"><span class="No-Break"><em class="italic">Chapter 15</em></span></a>, <em class="italic">Web </em><span class="No-Break"><em class="italic">Client Development</em></span><span class="No-Break">.</span></li>
				<li>Refer to the <em class="italic">Creating a new view</em> recipe of <a href="B20997_15.xhtml#_idTextAnchor861"><span class="No-Break"><em class="italic">Chapter 15</em></span></a>, <em class="italic">Web Client Development</em>, to create your <span class="No-Break">own view.</span></li>
			</ul>
			<h1 id="_idParaDest-390"><a id="_idTextAnchor464"/>Adding buttons to forms</h1>
			<p><strong class="bold">Buttons</strong> are used<a id="_idIndexMarker578"/> in the form view<a id="_idIndexMarker579"/> to handle user actions. We added a button in the form view in the previous recipe, but there are quite a few different types of buttons that we can use. This recipe will add another button that will help the user to open another view. It will also put the following code in the recipe’s <span class="No-Break"><strong class="source-inline">header</strong></span><span class="No-Break"> element.</span></p>
			<h2 id="_idParaDest-391"><a id="_idTextAnchor465"/>How to do it...</h2>
			<p>Add a button that refers to <span class="No-Break">an action:</span></p>
			<pre class="source-code">
&lt;button type="action" name="%(my_hostel.hostel_room_category_action)d" string="Open Hotel Room Category" /&gt;</pre>			<h2 id="_idParaDest-392"><a id="_idTextAnchor466"/>How it works...</h2>
			<p>The button’s <strong class="source-inline">type</strong> attribute determines<a id="_idIndexMarker580"/> the semantics<a id="_idIndexMarker581"/> of the other fields, so we’ll first take a look at the <span class="No-Break">possible values:</span></p>
			<ul>
				<li><strong class="source-inline">action</strong>: This makes the button call an action, as defined in the <strong class="source-inline">ir.actions.*</strong> namespace. The <strong class="source-inline">name</strong> attribute needs to contain the action’s database ID, which you can conveniently have Odoo look up with a Python-format string that contains the XML ID of the action <span class="No-Break">in question.</span></li>
				<li><strong class="source-inline">object</strong>: This calls a method from the current model. The <strong class="source-inline">name</strong> attribute contains the <span class="No-Break">function’s name.</span></li>
				<li><strong class="source-inline">string</strong>: The <strong class="source-inline">string</strong> attribute is used to assign the text the <span class="No-Break">user sees.</span></li>
			</ul>
			<h2 id="_idParaDest-393"><a id="_idTextAnchor467"/>There’s more...</h2>
			<p>Use the <strong class="source-inline">btn-primary</strong> CSS classes to render highlighted button and <strong class="source-inline">btn-default</strong> to render a normal button. This is commonly used for cancel buttons in wizards or to offer secondary actions in a visually unobtrusive way. Setting the <strong class="source-inline">oe_link</strong> class causes the button to look like a link. You can also use other bootstrap button classes to get different <span class="No-Break">button colors.</span></p>
			<p>A call with a button of the <strong class="bold">object</strong> type can return a dictionary that describes an action, which will then be executed on the client side. This way, you can implement multiscreen wizards or just open <span class="No-Break">another record.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Note that clicking on a button always causes the client to issue a <strong class="source-inline">write</strong> or <strong class="source-inline">create</strong> call before running <span class="No-Break">the method.</span></p>
			<p>You can also add content within the <strong class="source-inline">button</strong> tag by replacing the <strong class="source-inline">string</strong> attribute. This is commonly used in button boxes, as described in the <em class="italic">Document style </em><span class="No-Break"><em class="italic">forms</em></span><span class="No-Break"> recipe.</span></p>
			<h1 id="_idParaDest-394"><a id="_idTextAnchor468"/>Passing parameters to forms and actions – context</h1>
			<p>Internally, every method<a id="_idIndexMarker582"/> in Odoo has<a id="_idIndexMarker583"/> access to a dictionary<a id="_idIndexMarker584"/> called <strong class="bold">context</strong>, which <a id="_idIndexMarker585"/>is propagated<a id="_idIndexMarker586"/> from every action to the methods involved in delivering that action. The UI also has access to it, and it can be modified in various ways by setting values in the context. In this recipe, we’ll explore some of the applications of this mechanism by toying with the language, default values, and <span class="No-Break">implicit filters.</span></p>
			<h2 id="_idParaDest-395"><a id="_idTextAnchor469"/>Getting ready</h2>
			<p>While not strictly necessary, this recipe will be more fun if you install the French language if you haven’t got this already. Consult <a href="B20997_11.xhtml#_idTextAnchor595"><span class="No-Break"><em class="italic">Chapter 11</em></span></a>, <em class="italic">Internationalization</em>, for how to do this. If you have a French database, change <strong class="source-inline">fr_FR</strong> to some other language, e.g., <strong class="source-inline">en_US</strong> will do for English. Additionally, click on the <strong class="bold">Active</strong> button (changing to <strong class="bold">Archive</strong> when you hover over it) for one of the hostel rooms in order to archive it and verify that this partner doesn’t show up in the <span class="No-Break">list anymore.</span></p>
			<h2 id="_idParaDest-396"><a id="_idTextAnchor470"/>How to do it...</h2>
			<ol>
				<li>Create a new action, very similar to the one from the <em class="italic">Adding a menu item and window </em><span class="No-Break"><em class="italic">action</em></span><span class="No-Break"> recipe:</span><pre class="source-code">
<strong class="bold">&lt;record id="action_hostel_room" model="ir.actions.act_window"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;All Hostel Room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="res_model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    </strong><strong class="bold">&lt;field name="view_id" ref="hostel_room_view_tree"/&gt;</strong>
<strong class="bold">    &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="context"&gt;{'lang': 'fr_FR','default_lang': 'fr_FR', 'active_test': False, 'default_room_rating': 1.0}&lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Add a menu that calls this action. This is left as an exercise for <span class="No-Break">the reader.</span></li>
			</ol>
			<p>When you open this<a id="_idIndexMarker587"/> menu, the views<a id="_idIndexMarker588"/> will show<a id="_idIndexMarker589"/> up in<a id="_idIndexMarker590"/> French, and if you create a new partner, they will have French as their pre-selected language. A less obvious difference is that you will also see <strong class="bold">deactivated (archived) </strong><span class="No-Break"><strong class="bold">partner records</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-397"><a id="_idTextAnchor471"/>How it works...</h2>
			<p>The context dictionary is populated from several sources. First, some values from the current user’s record (<strong class="source-inline">lang</strong> and <strong class="source-inline">tz</strong> for the user’s language and the user’s time zone, respectively) are read. Then, we have some add-ons that add keys for their own purposes. Furthermore, the UI adds keys about which model and which record we’re busy using at the moment (<strong class="source-inline">active_id</strong>, <strong class="source-inline">active_ids</strong>, <strong class="source-inline">active_model</strong>). Moreover, as seen in the <em class="italic">Having an action open a specific view</em> recipe, we can add our own keys in actions. These are merged together and passed to the underlying server functions and the <span class="No-Break">client-side UI.</span></p>
			<p>So, by setting the <strong class="source-inline">lang</strong> context key, we force the display language to be <strong class="bold">French</strong>. You will note that this doesn’t change the whole UI language; this is because only the list view that we open lies within the scope of this context. The rest of the UI was loaded already with another context that contained the user’s original language. However, if you open a record in this list view, it will be presented in French, too, and if you open a linked record on the form or press a button that executes an action, the language will be <span class="No-Break">propagated, too.</span></p>
			<p>By setting <strong class="source-inline">default_lang</strong>, we set a default value for every record created within the scope of this context. The general pattern is <strong class="source-inline">default_$fieldname: my_default_value</strong>, which enables you to set default values for newly created partners in this case. Given that our menu is about hostel rooms, we have added <strong class="source-inline">default_room_rating: 1</strong> as the value for the <strong class="source-inline">Hostel Average Rating</strong> field by default. However, this is a model-wide default for <strong class="source-inline">hostel.room</strong>, so this wouldn’t have changed anything. For scalar fields, the syntax for this is the same as what you would write in Python code: <strong class="source-inline">string</strong> fields go in quotes, <strong class="source-inline">number</strong> fields stay as they are, and <strong class="source-inline">Boolean</strong> fields are either <strong class="source-inline">True</strong> or <strong class="source-inline">False</strong>. For relational fields, the syntax is slightly more complicated; refer to <a href="B20997_06.xhtml#_idTextAnchor319"><span class="No-Break"><em class="italic">Chapter 6</em></span></a>, <em class="italic">Managing Module Data</em>, to learn how to <span class="No-Break">write them.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Note that the default values set in the context override the default values set in the model definition, so you can have different default values in <span class="No-Break">different situations.</span></p>
			<p>The last key is <strong class="source-inline">active_test</strong>, which has very special semantics. For every model that has a field called <strong class="source-inline">active</strong>, Odoo automatically filters out records where this field is <strong class="source-inline">False</strong>. This is why the partner from where<a id="_idIndexMarker591"/> you unchecked this field disappeared<a id="_idIndexMarker592"/> from the list. By setting<a id="_idIndexMarker593"/> this key, we can suppress<a id="_idIndexMarker594"/> <span class="No-Break">this behavior.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">This is useful for the UI in its own right but even more useful in your Python code when you need to ensure that an operation is applied to all the records, not just the <span class="No-Break">active ones.</span></p>
			<h2 id="_idParaDest-398"><a id="_idTextAnchor472"/>There’s more...</h2>
			<p>When defining a context, you have access to some variables, with the most important one being <strong class="source-inline">uid</strong>, which evaluates the current user’s ID. You’ll need this to set default filters (refer to the next recipe, <em class="italic">Defining filters on record lists – Domain</em>). Furthermore, you have access to the <strong class="source-inline">context_today</strong> function and the <strong class="source-inline">current_date</strong> variable, where the first is a <strong class="source-inline">date</strong> object that represents the current date, as seen from the user’s time zone, and the latter is the current date, as seen in UTC, formatted as <strong class="source-inline">YYYY-MM-DD</strong>. To set a default value for a <strong class="source-inline">date</strong> field to the current date, use <strong class="source-inline">current_date</strong>, and for default filters, <span class="No-Break">use </span><span class="No-Break"><strong class="source-inline">context_today()</strong></span><span class="No-Break">.</span></p>
			<p>Furthermore, you can do some date calculations with a subset of Python’s <strong class="source-inline">datetime</strong>, <strong class="source-inline">time</strong>, and <span class="No-Break"><strong class="source-inline">relativedelta</strong></span><span class="No-Break"> classes.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Most of the domains are evaluated on the client side. The server-side domain evaluation is restricted for security reasons. When client-side evaluation<a id="_idIndexMarker595"/> was introduced, the best option in order to not break the whole system was to implement a part of Python in JavaScript. There is a small JavaScript Python interpreter built into Odoo that works well for simple expressions, and that is <span class="No-Break">usually enough.</span></p>
			<p class="callout">Beware of the use of the <strong class="source-inline">context</strong> variable in the <strong class="source-inline">&lt;record id="action_name" model="ir.actions.act_window.view"&gt;</strong> shortcut. These are evaluated at installation time, which is nearly never what you want. If you need variables in your context, use the <strong class="source-inline">&lt;record /&gt;</strong> <span class="No-Break">syntax.</span></p>
			<p>We can also add different contexts for the buttons. It works the same way as how we added context keys to our action. This causes the function or action that the button calls to be run in the <span class="No-Break">context given.</span></p>
			<p>Most form element attributes that are evaluated as Python also have access to the context dictionary. The <strong class="source-inline">invisible</strong> and <strong class="source-inline">readonly</strong> attributes are examples<a id="_idIndexMarker596"/> of these. So, in cases where you want an element to show up in a form sometimes but not at other<a id="_idIndexMarker597"/> times, set the <strong class="source-inline">invisible</strong> attribute to <strong class="source-inline">context.get('my_key')</strong>. For actions that lead to a case in which the field is supposed to be invisible, set the context key to <strong class="source-inline">my_key: True</strong>. This strategy enables you to adapt your form without having to rewrite it for <span class="No-Break">different occasions.</span></p>
			<p>You can also set a context for relational fields, which influences how the field is loaded. By setting the <strong class="source-inline">form_view_ref</strong> or <strong class="source-inline">tree_view_ref</strong> keys to the full XML ID of a view, you can select a specific view for this field. This is necessary when you have multiple views of the same type for the same object. Without this key, you get the view with the lowest sequence number, which might not always <span class="No-Break">be desirable.</span></p>
			<h2 id="_idParaDest-399"><a id="_idTextAnchor473"/>See also</h2>
			<ul>
				<li>The context is also used to set a default search filter. You can learn more about the default search filter in the <em class="italic">Defining search views</em> recipe of <span class="No-Break">this chapter.</span></li>
				<li>For more details on setting default recipes, refer to the next recipe, <em class="italic">Defining filters on record lists – </em><span class="No-Break"><em class="italic">Domain</em></span><span class="No-Break">.</span></li>
				<li>To learn how to install the French language, consult <a href="B20997_11.xhtml#_idTextAnchor595"><span class="No-Break"><em class="italic">Chapter </em></span><span class="No-Break"><em class="italic">11</em></span></a><span class="No-Break">,</span><span class="No-Break"><em class="italic"> Internationalization</em></span><span class="No-Break">.</span></li>
				<li>You can refer to <a href="B20997_06.xhtml#_idTextAnchor319"><span class="No-Break"><em class="italic">Chapter 6</em></span></a>, <em class="italic">Managing Module Data</em> to learn how to write the syntax for <span class="No-Break">relational fields.</span></li>
			</ul>
			<h1 id="_idParaDest-400"><a id="_idTextAnchor474"/>Defining filters on record lists – domain</h1>
			<p>We’ve already seen <a id="_idIndexMarker598"/>an example<a id="_idIndexMarker599"/> of a domain in the first recipe of this chapter, which was <strong class="source-inline">[('state', '=', 'draft')]</strong>. Often, you need to display a subset of all available records from an action or allow only a subset of possible records to be the target of a <strong class="source-inline">many2one</strong> relation. The way to describe these filters in Odoo is by using domains. This recipe illustrates how to use a domain to display a selection <span class="No-Break">of partners.</span></p>
			<h2 id="_idParaDest-401"><a id="_idTextAnchor475"/>How to do it...</h2>
			<p>To display a subset of partners from your action, you need to perform the <span class="No-Break">following steps:</span></p>
			<ol>
				<li>Create an action for when “state” is set <span class="No-Break">to “draft:”</span><pre class="source-code">
<strong class="bold">&lt;record id="action_hostel_room" model="ir.actions.act_window"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;All Hostel Room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="res_model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    </strong><strong class="bold">&lt;field name="view_id" ref="hostel_room_view_tree"/&gt;</strong>
<strong class="bold">    &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="context"&gt;{'lang': 'fr_FR','default_lang': 'fr_FR', 'active_test': False, 'default_room_rating': 1.0}&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="domain"&gt;[('state', '=', 'draft'), ('room_rating', '&amp;gt;', '0.0')]&lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Add menus that call these actions. This is left as an exercise for <span class="No-Break">the reader.</span></li>
			</ol>
			<h2 id="_idParaDest-402"><a id="_idTextAnchor476"/>How it works...</h2>
			<p>The simplest form<a id="_idIndexMarker600"/> of a domain<a id="_idIndexMarker601"/> is a list of three tuples that contain a field name (of the model in question) as <strong class="source-inline">string</strong> in the first element, an operator as <strong class="source-inline">string</strong> in the second element, and the value that the field is to be checked against as the third element. This is what we did before, and this is interpreted as, “<em class="italic">All those conditions have to apply to the records we’re interested in</em>.” This is actually a shortcut because the domains know the two prefix operators—<strong class="source-inline">&amp;</strong> and <strong class="source-inline">|</strong>—where <strong class="source-inline">&amp;</strong> is the default. So, in normalized form, the first domain will be written <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
['&amp;',('state', '=', 'draft'), ('room_rating', '&amp;gt;', '0.0')]</pre>			<p>While these can be a bit hard to read for bigger expressions, the advantage of prefix operators is that their scope is rigidly defined, which saves you from having to worry about operator precedence and brackets. It’s always two expressions: the first <strong class="source-inline">&amp;</strong> applies to <strong class="source-inline">'&amp;',('state', '=', 'draft')</strong>, with <strong class="source-inline">('room_rating', '&amp;gt;', '0.0')</strong> as the first operand and <strong class="source-inline">('room_rating', '&amp;gt;', '0.0')</strong>  as the second. Then, we have the first operand and <strong class="source-inline">('room_rating', '&amp;gt;', '0.0')</strong> as <span class="No-Break">the second.</span></p>
			<p>In the second step, we have to write out the full form because we need the <strong class="source-inline">|</strong> <span class="No-Break">operator.</span></p>
			<p>For example, say we have a complex domain such as this: <strong class="source-inline">['|',</strong> <strong class="source-inline">('user_id',</strong> <strong class="source-inline">'=', uid), '&amp;', ('lang', '!=', 'fr_FR'), '|', ('phone', '=', False), ('email', '=', False)]</strong>. See the following figure to learn about how this domain <span class="No-Break">is evaluated:</span></p>
			<div>
				<div id="_idContainer064" class="IMG---Figure">
					<img src="image/B20997_09_2.jpg" alt="Figure 9.2 – The evaluation of a domain"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.2 – The evaluation of a domain</p>
			<p>There is also a <strong class="source-inline">!</strong> operator for negation, but given logical equivalences and negated comparison operators such as <strong class="source-inline">!=</strong> and <strong class="source-inline">not in</strong>, it is not <span class="No-Break">really necessary.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Note that this is a unary prefix operator, so it only applies to the following expression in the domain and not to everything <span class="No-Break">that follows.</span></p>
			<p>Note that the right operand<a id="_idIndexMarker602"/> doesn’t need<a id="_idIndexMarker603"/> to be a fixed value when you write a domain for a window action or other client-side domains. You can use the same minimal Python as is used in the <em class="italic">Passing parameters to forms and actions – Context</em> recipe, so you can write filters such as <strong class="bold">changed last week</strong> or <span class="No-Break"><strong class="bold">my partners</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-403"><a id="_idTextAnchor477"/>There’s more...</h2>
			<p>The preceding domains work only for the fields of the model itself, while we often need to filter based on the properties of linked records. To do this, you can use the notation that’s also used in <strong class="source-inline">@api.depends</strong> definitions or related fields: create a dotted path from the current model to the model you want to filter for. To search partners that have a salesperson who is a member of a group starting with the letter <strong class="source-inline">G</strong>, you would use the <strong class="source-inline">[('user_id.groups_id.name', '=like', 'G%')]</strong> domain. The path can be long, so you only have to be sure that there are relation fields between the current model and the model you want to <span class="No-Break">filter for.</span></p>
			<h3>Operators</h3>
			<p>The following table<a id="_idIndexMarker604"/> lists the available operators and <span class="No-Break">their semantics:</span></p>
			<div>
				<div id="_idContainer065" class="IMG---Figure">
					<img src="image/Table_011.jpg" alt="Table 9.1 – Operators and their semantics"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 9.1 – Operators and their semantics</p>
			<p>Note that some of the operators work only with certain fields and values. For example, the domain <strong class="source-inline">[('category_id', 'in', 1)]</strong> is invalid and will generate an error, while the domain <strong class="source-inline">[('category_id', 'in', [1])]</strong> <span class="No-Break">is valid.</span></p>
			<h3>Pitfalls of searching using domains</h3>
			<p>This all works fine <a id="_idIndexMarker605"/>for traditional fields, but a notorious problem is searching for the value of a non-stored function field. People often omit the search function. This is simple enough to fix by providing the search function in your own code, as described in <a href="B20997_04.xhtml#_idTextAnchor118"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, <span class="No-Break"><em class="italic">Application Models</em></span><span class="No-Break">.</span></p>
			<p>Another issue that might baffle developers is Odoo’s behavior when searching through <strong class="source-inline">one2many</strong> or <strong class="source-inline">many2many</strong> fields with a negative operator. Imagine that you have a partner with the <strong class="source-inline">A</strong> tag, and you search for <strong class="source-inline">[('category_id.name', '!=', 'B')]</strong>. Your partner shows up in the result, and this is what you expected, but if you add the <strong class="source-inline">B</strong> tag to this partner, it still shows up in your results because, for the search algorithm, it is enough that there is one linked record (<strong class="source-inline">A</strong> in this case) that does not fulfill the criterion. Now, if you remove the <strong class="source-inline">A</strong> tag so that <strong class="source-inline">B</strong> is the only tag, the partner will be filtered out. If you also remove the <strong class="source-inline">B</strong> tag so that the partner has no tags, it is still filtered out because the conditions of the linked records presuppose the existence of this record. In other situations, though, this is the behavior you want, so it is not really an option to change the standard behavior. If you need a different behavior here, provide a search function that interprets the negation the way <span class="No-Break">you need.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">People often forget that they are writing XML files when it comes to domains. You need to escape the less-than operator. Searching for records that have been created before the current day will have to be written as <strong class="source-inline">[('create_date', '&amp;lt;', current_date)]</strong> <span class="No-Break">in XML.</span></p>
			<p>Domains are used widely in Odoo. You will find them everywhere in Odoo; they are used for searching, filtering, security rules, search views, user actions, <span class="No-Break">and more.</span></p>
			<p>If you ever need to manipulate a domain that you didn’t create programmatically, use the utility functions provided in <strong class="source-inline">odoo.osv.expression</strong>. The <strong class="source-inline">is_leaf</strong>, <strong class="source-inline">normalize_domain</strong>, <strong class="source-inline">AND</strong>, and <strong class="source-inline">OR</strong> functions will allow you to combine domains exactly the way that Odoo does. Don’t do this yourself because there are many corner cases<a id="_idIndexMarker606"/> that you have to take into account, and it is likely that you’ll <span class="No-Break">overlook one.</span></p>
			<h2 id="_idParaDest-404"><a id="_idTextAnchor478"/>See also</h2>
			<ul>
				<li>For the standard application of domains, see the <em class="italic">Defining search </em><span class="No-Break"><em class="italic">views</em></span><span class="No-Break"> recipe.</span></li>
			</ul>
			<h1 id="_idParaDest-405"><a id="_idTextAnchor479"/>Defining list views</h1>
			<p>After having spent quite some time<a id="_idIndexMarker607"/> on the form view, we’ll now take a quick look at how to define list views. Internally, these are called tree views in some places and list views in others, but given that there is another construction within the Odoo view framework called <strong class="bold">tree</strong>, we’ll stick to <span class="No-Break"><strong class="bold">list</strong></span><span class="No-Break"> here.</span></p>
			<h2 id="_idParaDest-406"><a id="_idTextAnchor480"/>How to do it...</h2>
			<ol>
				<li>Define your <span class="No-Break">list view:</span><pre class="source-code">
<strong class="bold">&lt;record id="hostel_room_view_tree" model="ir.ui.view"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;Hostel Room List&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="arch" type="xml"&gt;</strong>
<strong class="bold">        &lt;tree&gt;</strong>
<strong class="bold">            &lt;field name="name"/&gt;</strong>
<strong class="bold">            </strong><strong class="bold">&lt;field name="room_no"/&gt;</strong>
<strong class="bold">            &lt;field name="state"/&gt;</strong>
<strong class="bold">        &lt;/tree&gt;</strong>
<strong class="bold">    &lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Register a tree view in the action that we created in the <em class="italic">Adding a menu item and window action</em> recipe of <span class="No-Break">this chapter:</span><pre class="source-code">
<strong class="bold">&lt;record id="action_hostel_room" model="ir.actions.act_window"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;All Hostel Room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="res_model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="view_id" ref="hostel_room_view_tree"/&gt;</strong>
<strong class="bold">    &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;</strong>
<strong class="bold">    </strong><strong class="bold">&lt;field name="context"&gt;{'tree_view_ref': 'my_hostel.hostel_room_view_tree', 'lang': 'fr_FR','default_lang': 'fr_FR', 'active_test': False, 'default_room_rating': 1.0}&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="domain"&gt;[('state', '=', 'draft')]&lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Add menus that call these actions. This is left as an exercise for <span class="No-Break">the reader.</span></li>
			</ol>
			<p><strong class="bold">Install</strong>/<strong class="bold">Upgrade</strong> the module. After that, you will see <a id="_idIndexMarker608"/>our tree view for the hostel room, and if you check it, it will show different row styles based on <span class="No-Break">our conditions.</span></p>
			<h2 id="_idParaDest-407"><a id="_idTextAnchor481"/>How it works...</h2>
			<p>You already know most of what happens here. We define a view, using the <strong class="source-inline">tree</strong> type this time, and attach it to our action with an <strong class="source-inline">ir.actions.act_window.view</strong> element. So, the only thing left to discuss is the <strong class="source-inline">tree</strong> element and its semantics. With a list, you don’t have many design choices, so the only valid children of this element are the <strong class="source-inline">field</strong> and <strong class="source-inline">button</strong> elements. You can also use some widgets in the list view; in our example, we have used the <strong class="source-inline">many2one_avatar_user</strong> widget. The tree view has the support of a special widget called <strong class="source-inline">handle</strong>. This is specific to list views. It is meant for integer fields and renders a drag handle that the user can use to drag a row to a different position in the list, thereby updating the field’s value. This is useful for sequence or <span class="No-Break">priority fields.</span></p>
			<p>By using the <strong class="source-inline">optional</strong> attribute, you can show fields optionally. Adding the <strong class="source-inline">optional</strong> attribute to a field will allow the user to hide and show the column at any time from the UI. In our example, we have used it for the <strong class="source-inline">country</strong> and <span class="No-Break"><strong class="source-inline">state</strong></span><span class="No-Break"> fields.</span></p>
			<p>What is new here are the <strong class="source-inline">decoration</strong> attributes in the <strong class="source-inline">tree</strong> element. This contains rules as to which font and/or color is chosen for the row, given in the form of <strong class="source-inline">decoration-$name="Python code"</strong>. We made these invisible because we only need the data and don’t want to bother our users with the two extra columns. The possible classes are <strong class="source-inline">decoration-bf</strong> (bold) and <strong class="source-inline">decoration-it</strong> (italic), and the semantic bootstrap classes<a id="_idIndexMarker609"/> are <strong class="source-inline">decoration-danger</strong>, <strong class="source-inline">decoration-info</strong>, <strong class="source-inline">decoration-muted</strong>, <strong class="source-inline">decoration-primary</strong>, <strong class="source-inline">decoration-success</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">decoration-warning</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-408"><a id="_idTextAnchor482"/>There’s more...</h2>
			<p>For numeric fields, you can add a <strong class="source-inline">sum</strong> attribute that causes this column to be summed up with the text you set in the attribute as a tooltip. Less common are the <strong class="source-inline">avg</strong>, <strong class="source-inline">min</strong>, and <strong class="source-inline">max</strong> attributes, which display the average, minimum, and maximum, respectively. Note that these four only work on the records that are currently visible, so you might want to adjust the action’s <strong class="source-inline">limit</strong> (covered earlier in the <em class="italic">Adding a menu item and window action</em> recipe) in order for the user to see all the <span class="No-Break">records immediately.</span></p>
			<p>A very interesting attribute for the <strong class="source-inline">tree</strong> element is <strong class="source-inline">editable</strong>. If you set this to top or bottom, the list behaves entirely differently. Without it, clicking on a row opens a form view for the row. With it, clicking on a row makes it editable inline, with the visible fields rendered as form fields. This is particularly useful in embedded list views, which are discussed later in the <em class="italic">Defining embedded views</em> recipe of this chapter. The choice of top or bottom relates to whether new lines will be added to the top or bottom of <span class="No-Break">the list.</span></p>
			<p>By default, records are ordered according to the <strong class="source-inline">_order</strong> property of the displayed model. The user can change the ordering by clicking on a column header, but you can also set a different initial order by setting the <strong class="source-inline">default_order</strong> property in the <strong class="source-inline">tree</strong> element. The syntax is the same as <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">_order</strong></span><span class="No-Break">.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Ordering is often <a id="_idIndexMarker610"/>a source of frustration for new developers. As Odoo lets PostgreSQL do the work here, you can only order according to the fields that PostgreSQL knows about and only the fields that live in the same database table. So, if you want to order according to a function or a related field, ensure that you set <strong class="source-inline">store=True</strong>. If you need to order according to a field inherited from another model, declare a stored <span class="No-Break">related field.</span></p>
			<p>The <strong class="source-inline">create</strong>, <strong class="source-inline">edit</strong>, and <strong class="source-inline">delete</strong> attributes of the <strong class="source-inline">tree</strong> element work the same as for the <strong class="source-inline">form</strong> element we described earlier in the <em class="italic">Adding content and widgets to a form view</em> recipe of this chapter. They also determine the available controls if the <strong class="source-inline">editable</strong> attribute <span class="No-Break">is set.</span></p>
			<h1 id="_idParaDest-409"><a id="_idTextAnchor483"/>Defining search views</h1>
			<p>When opening your<a id="_idIndexMarker611"/> list view, you’ll notice the search field in the upper right. If you type something there, you will receive suggestions about what to search for, and there is also a set of predefined filters to choose from. This recipe will walk you through how to define these suggestions <span class="No-Break">and options.</span></p>
			<h2 id="_idParaDest-410"><a id="_idTextAnchor484"/>How to do it...</h2>
			<ol>
				<li>Define your <span class="No-Break">search view:</span><pre class="source-code">
<strong class="bold">&lt;record id="hostel_room_view_search" model="ir.ui.view"&gt;</strong>
<strong class="bold">    &lt;field name="model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="arch" type="xml"&gt;</strong>
<strong class="bold">        &lt;search&gt;</strong>
<strong class="bold">            &lt;field name="name"/&gt;</strong>
<strong class="bold">            &lt;field name="room_no"/&gt;</strong>
<strong class="bold">            &lt;group expand="0" string="Group By"&gt;</strong>
<strong class="bold">                &lt;filter string="State" name="state" context="{'group_by':'state'}"/&gt;</strong>
<strong class="bold">           &lt;/group&gt;</strong>
<strong class="bold">        &lt;/search&gt;</strong>
<strong class="bold">    &lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Tell your action to <span class="No-Break">use it:</span><pre class="source-code">
<strong class="bold">&lt;record id="action_hostel_room" model="ir.actions.act_window"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;All Hostel Room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="res_model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="search_view_id" ref="hostel_room_view_search" /&gt;</strong>
<strong class="bold">    &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="context"&gt;{'tree_view_ref': 'my_hostel.hostel_room_view_tree', 'lang': 'fr_FR','default_lang': 'fr_FR', 'active_test': False, 'default_room_rating': 1.0}&lt;/field&gt;</strong>
<strong class="bold">    </strong><strong class="bold">&lt;field name="domain"&gt;[('state', '=', 'draft')]&lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>			</ol>
			<p>When you type something into the search bar now, you’ll be offered the ability to search for this term in the <strong class="source-inline">name</strong>, <strong class="source-inline">room no</strong>, and <strong class="source-inline">state</strong> fields. If your term happens to be a substring of a bank <a id="_idIndexMarker612"/>account number in your system, you’ll even be offered the option to search exactly for this <span class="No-Break">bank account.</span></p>
			<h2 id="_idParaDest-411"><a id="_idTextAnchor485"/>How it works...</h2>
			<p>In the case of <strong class="source-inline">name</strong>, we simply listed the field as the one to be offered to the user to search for. We left the semantics as the default, which is a substring search for <span class="No-Break">character fields.</span></p>
			<p>For categories, we do something more interesting. By default, your search term is applied to a <strong class="source-inline">many2many</strong> field trigger called <strong class="source-inline">name_search</strong>, which would be a substring search in the category names in this case. However, depending on your category structure, it can be very convenient to search for partners who have the category you’re interested<a id="_idIndexMarker613"/> in or a child of it. Think of a main category, <strong class="bold">newsletter subscribers</strong>, with the subcategories <strong class="bold">weekly newsletter</strong>, <strong class="bold">monthly newsletter</strong>, and a couple of other newsletter types. Searching for <strong class="bold">newsletter subscribers</strong> with the preceding search view definition will give you everyone who is subscribed to any of those newsletters in one go, which is a lot more convenient than searching for every single type and combining <span class="No-Break">the results.</span></p>
			<p>The <strong class="source-inline">filter_domain</strong> attribute can contain an arbitrary domain, so you’re not restricted to searching for the same field you named in the <strong class="source-inline">name</strong> attribute nor to using only one term. The <strong class="source-inline">self</strong> variable is what the user filled in and is also the only variable that you can <span class="No-Break">use here.</span></p>
			<p>Here’s a more elaborate example from the default search view for <span class="No-Break">hostel room:</span></p>
			<pre class="source-code">
&lt;field name="name"
    filter_domain="[
        '|',
        ('display_name', 'ilike', self),
        ('room_no', '=', self)]"/&gt;</pre>			<p>This means that the user doesn’t have to think about what to search for. All they need to do is type in some letters, press <em class="italic">Enter</em>, and, with a bit of luck, one of the fields mentioned contains the string we’re <span class="No-Break">looking for.</span></p>
			<p>For the <strong class="source-inline">child_ids</strong> field, we used another trick. The type of field not only decides the default way of searching for the user’s input but also defines the way in which Odoo presents the suggestions. Additionally, given that <strong class="source-inline">many2one</strong> fields are the only ones that offer auto-completion, we force Odoo to do that, even though <strong class="source-inline">child_ids</strong> is a <strong class="source-inline">one2many</strong> field, by setting the <strong class="source-inline">widget</strong> attribute. Without this, we will have to search in this field without suggestions for completion. The same applies to <span class="No-Break"><strong class="source-inline">many2many</strong></span><span class="No-Break"> fields.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Note that every field with a <strong class="source-inline">many2one</strong> widget set will trigger a search on its model for every one of the user’s keystrokes; don’t use too many <span class="No-Break">of them.</span></p>
			<p>You should also put the most-used fields<a id="_idIndexMarker614"/> on the top because the first field is what is searched for if the user just types something and presses <em class="italic">Enter</em>. The search bar can also be used with the keyboard; select a suggestion by pressing the down arrow and open the completion suggestion of <strong class="source-inline">many2one</strong> by pressing the right arrow. If you educate your users on this and pay attention to the sensible ordering of fields in the search view, this will be much more efficient than typing something first, grabbing the mouse, and selecting <span class="No-Break">an option.</span></p>
			<p>The <strong class="source-inline">filter</strong> element creates a button that adds the content of the filter’s <strong class="source-inline">domain</strong> attribute to the search domain. You should add a logical internal <strong class="source-inline">name</strong> and a <strong class="source-inline">string</strong> attribute to describe the filter to <span class="No-Break">your users.</span></p>
			<p>The <strong class="source-inline">&lt;group&gt;</strong> tag is used to provide a grouping option under the <strong class="bold">Group by</strong> button. In this recipe, we have added an option<a id="_idIndexMarker615"/> to group records based on the <span class="No-Break"><strong class="source-inline">country_id</strong></span><span class="No-Break"> field.</span></p>
			<h2 id="_idParaDest-412"><a id="_idTextAnchor486"/>There’s more...</h2>
			<p>You can group filters using the <strong class="source-inline">group</strong> tag, which causes them to be<a id="_idIndexMarker616"/> rendered slightly closer together than the other filters, but this has semantic implications, too. If you put multiple filters in the same group and activate more than one of them, their domains will be combined with the <strong class="source-inline">|</strong> operator, while the filters and fields not in the same group are combined with the <strong class="source-inline">&amp;</strong> operator. Sometimes, you might want disjunction for your filters, which is where they filter for mutually exclusive sets, in which case, selecting both of them will always lead to an empty result set. Within the same group, you can achieve the same effect with the <span class="No-Break"><strong class="source-inline">separator</strong></span><span class="No-Break"> element.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Note that if the user fills in multiple queries for the same field, they will be combined with <strong class="source-inline">|</strong>, too, so you don’t need to worry <span class="No-Break">about that.</span></p>
			<p>Apart from the <strong class="source-inline">field</strong> attribute, the <strong class="source-inline">filter</strong> element can have a <strong class="source-inline">context</strong> attribute, whose content will be merged with the current context and eventually other context attributes in the search view. This is essential for views that support grouping (refer to the <em class="italic">Defining kanban view</em> and <em class="italic">Defining graph view</em> recipes) because the resulting context determines the field(s) to be grouped using the <strong class="source-inline">group_by</strong> key. We’ll look into the details of grouping in the appropriate recipes, but the context has other uses, too. For example, you can write a function field that returns different values depending on the context, and then you can change the values by activating <span class="No-Break">a filter.</span></p>
			<p>The search view itself also responds to context keys. In a very similar way to default values when creating records, you can pass default values for a search view through the context. If we had set a context of <strong class="source-inline">{'search_default_room_rating': 1}</strong> in our previous action, the <strong class="source-inline">room_rating</strong> filter would have been pre-selected in the search view. This works only if the filter has a name, though, which is why you should always set it. To set defaults for fields in the search view, <span class="No-Break">use </span><span class="No-Break"><strong class="source-inline">search_default_$fieldname</strong></span><span class="No-Break">.</span></p>
			<p>Furthermore, the <strong class="source-inline">field</strong> and <strong class="source-inline">filter</strong> elements can have a <strong class="source-inline">groups</strong> property with the same semantics as in the form views in order to make the element only visible to <span class="No-Break">certain groups.</span></p>
			<h2 id="_idParaDest-413"><a id="_idTextAnchor487"/>See also</h2>
			<ul>
				<li>For further details about manipulating the context, see the <em class="italic">Passing parameters to forms and actions – </em><span class="No-Break"><em class="italic">Context</em></span><span class="No-Break"> recipe.</span></li>
				<li>Users who speak languages with heavy use of diacritical marks will probably want to have Odoo search for <strong class="source-inline">e</strong>, <strong class="source-inline">è</strong>, <strong class="source-inline">é</strong>, and <strong class="source-inline">ê</strong> when filling in the <strong class="source-inline">e</strong> character. This<a id="_idIndexMarker617"/> is a configuration of the <strong class="bold">PostgreSQL server</strong> called <strong class="bold">unaccent</strong>, which Odoo has special support for, but this is outside the scope of this book. Refer to <a href="https://www.postgresql.org/docs/10/unaccent.html">https://www.postgresql.org/docs/10/unaccent.html</a> for more information<a id="_idIndexMarker618"/> <span class="No-Break">about unaccent.</span></li>
			</ul>
			<h1 id="_idParaDest-414"><a id="_idTextAnchor488"/>Adding a search filter side panel</h1>
			<p>Odoo provides one more way<a id="_idIndexMarker619"/> to display search filters, which is a <strong class="bold">search filter side panel</strong>. This panel shows a list of filters on the side of the view. A search panel is very useful when search filters are used frequently by the <span class="No-Break">end user.</span></p>
			<h2 id="_idParaDest-415"><a id="_idTextAnchor489"/>Getting ready</h2>
			<p>The search panel is part of the search view. So, for this recipe, we will continue using the <strong class="source-inline">my_module</strong> add-on from the previous recipe. We will add our search panel to the previously designed <span class="No-Break">search view.</span></p>
			<h2 id="_idParaDest-416"><a id="_idTextAnchor490"/>How to do it...</h2>
			<p>Add <strong class="source-inline">&lt;searchpanel&gt;</strong> in the search<a id="_idIndexMarker620"/> view, as <span class="No-Break">shown here:</span></p>
			<pre class="source-code">
&lt;record id="hostel_room_view_search" model="ir.ui.view"&gt;
    &lt;field name="model"&gt;hostel.room&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;search&gt;
            &lt;field name="name"/&gt;
            &lt;field name="room_no"/&gt;
            &lt;field name="state"/&gt;
            &lt;searchpanel&gt;
                &lt;field name="state" expand="1" select="multi" icon="fa-check-square-o" enable_counters="1"/&gt;
            &lt;/searchpanel&gt;
        &lt;/search&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre>			<p>Update the module to apply the modification. After the update, you will see the search panel on the left side of <span class="No-Break">the view.</span></p>
			<h2 id="_idParaDest-417"><a id="_idTextAnchor491"/>How it works...</h2>
			<p>To add the search panel, you will need to use the <strong class="source-inline">&lt;searchpanel&gt;</strong> tag in the search view. To add your filter, you will need to add a field in the <span class="No-Break">search panel.</span></p>
			<p>In our example, first, we added a <strong class="source-inline">state</strong> field. You also need to add an <strong class="source-inline">icon</strong> attribute to the field. This icon will be displayed before the title of the filter. Once you add the field to the search panel, it will display the title with an icon, and, below that, a list of all the users. Upon clicking on a user, the records in the list view will be filtered, and you will only see the contacts of the selected user. In this filter, only one item can be active, meaning once you click on another user’s filter, the previous user’s filter will be removed. If you want to activate multi-user filters, you can use the <strong class="source-inline">select="multi"</strong> attribute. If you use that attribute, you will find the checkbox for each filter option, and you will be able to activate multiple filters at a time. We have used the <strong class="source-inline">select="multi"</strong> attribute on the <strong class="source-inline">state</strong> filter. This will allow us to select and filter by multiple categories<a id="_idIndexMarker621"/> <span class="No-Break">at once.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Be careful when you are using the side panel filter on <strong class="source-inline">many2one</strong> or <strong class="source-inline">many2many</strong>. If the relation model has too many records, only the <strong class="bold">top 200 records</strong> will be displayed to avoid <span class="No-Break">performance issues.</span></p>
			<h2 id="_idParaDest-418"><a id="_idTextAnchor492"/>There’s more...</h2>
			<p>If you want to display search panel items in groups, you can use the <strong class="source-inline">groupby</strong> attribute on a field. For example, if you want to group a category based on its parent hierarchy, you can add the <strong class="source-inline">groupby</strong> attribute with the <strong class="source-inline">parent_id</strong> field, as can be <span class="No-Break">seen here:</span></p>
			<pre class="source-code">
&lt;field name="state"
    icon="fa-check-square-o"
    select="multi"
    groupby="parent_id"/&gt;</pre>			<p>This will show the category filters grouped according to the parent category of <span class="No-Break">the record.</span></p>
			<h1 id="_idParaDest-419"><a id="_idTextAnchor493"/>Changing existing views – view inheritance</h1>
			<p>So far, we have<a id="_idIndexMarker622"/> ignored the existing<a id="_idIndexMarker623"/> views and declared completely new ones. While this is didactically sensible, you’ll rarely be in situations where you’ll want to define a new view for an existing model. Instead, you’ll want to slightly modify the existing views, be it to simply have them show a field that you added to the model in your add-on or to customize them according to your needs or your <span class="No-Break">customers’ needs.</span></p>
			<p>In this recipe, we’ll change the default partner form to show the record’s last modification date and make the <strong class="source-inline">mobile</strong> field searchable by modifying the search view. Then, we’ll change<a id="_idIndexMarker624"/> the position <a id="_idIndexMarker625"/>of one column in the partners’ <span class="No-Break">list view.</span></p>
			<h2 id="_idParaDest-420"><a id="_idTextAnchor494"/>How to do it...</h2>
			<ol>
				<li>Inject the field into the default <span class="No-Break">form view:</span><pre class="source-code">
<strong class="bold">&lt;record id="hostel_room_view_form_inherit" model="ir.ui.view"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;Hostel Room Form Inherit&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="inherit_id" ref="my_hostel.hostel_room_view_form" /&gt;</strong>
<strong class="bold">    &lt;field name="arch" type="xml"&gt;</strong>
<strong class="bold">        &lt;xpath expr="//group[@name='my_content']/group" position="inside"&gt;</strong>
<strong class="bold">            &lt;field name="room_no"/&gt;</strong>
<strong class="bold">        &lt;/xpath&gt;</strong>
<strong class="bold">        &lt;xpath expr="//group[@name='my_content']/group" position="after"&gt;</strong>
<strong class="bold">            &lt;group&gt;</strong>
<strong class="bold">                </strong><strong class="bold">&lt;field name="description"/&gt;</strong>
<strong class="bold">                &lt;field name="room_rating"/&gt;</strong>
<strong class="bold">            &lt;/group&gt;</strong>
<strong class="bold">        &lt;/xpath&gt;</strong>
<strong class="bold">    &lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Add the field to the default <span class="No-Break">search view:</span><pre class="source-code">
<strong class="bold">&lt;record id="hostel_room_view_search_inherit" model="ir.ui.view"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;Hostel Room Search inherit&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="inherit_id" ref="my_hostel.hostel_room_view_search" /&gt;</strong>
<strong class="bold">    &lt;field name="arch" type="xml"&gt;</strong>
<strong class="bold">        </strong><strong class="bold">&lt;xpath expr="." position="inside"&gt;</strong>
<strong class="bold">            &lt;field name="room_rating"&gt;&lt;/field&gt;</strong>
<strong class="bold">        &lt;/xpath&gt;</strong>
<strong class="bold">    &lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>				<li>Add the field<a id="_idIndexMarker626"/> to the default<a id="_idIndexMarker627"/> <span class="No-Break">list view:</span><pre class="source-code">
<strong class="bold">&lt;record id="hostel_room_view_tree_inherit" model="ir.ui.view"&gt;</strong>
<strong class="bold">    &lt;field name="name"&gt;Hostel Room List Inherit&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="model"&gt;hostel.room&lt;/field&gt;</strong>
<strong class="bold">    &lt;field name="inherit_id" ref="my_hostel.hostel_room_view_tree" /&gt;</strong>
<strong class="bold">    &lt;field name="arch" type="xml"&gt;</strong>
<strong class="bold">        &lt;xpath expr="//field[@name='name']" position="after"&gt;</strong>
<strong class="bold">            </strong><strong class="bold">&lt;field name="room_no"/&gt;</strong>
<strong class="bold">        &lt;/xpath&gt;</strong>
<strong class="bold">    &lt;/field&gt;</strong>
<strong class="bold">&lt;/record&gt;</strong></pre></li>			</ol>
			<p>After updating your module, you should see the <strong class="bold">Last updated on</strong> field beneath the website field on the partner form. When you type something into the search box, it should suggest that you search for the partners on the mobile field, and in the partner’s list view, you will see that the order of the phone number and email <span class="No-Break">has changed.</span></p>
			<h2 id="_idParaDest-421"><a id="_idTextAnchor495"/>How it works...</h2>
			<p>In <em class="italic">step 1</em>, we added<a id="_idIndexMarker628"/> a basic structure<a id="_idIndexMarker629"/> for form inheritance. The crucial field here is, as you’ve probably guessed, <strong class="source-inline">inherit_id</strong>. You need to pass the XML ID of the view you want to modify (inherit from) to it. The <strong class="source-inline">arch</strong> field contains instructions on how to modify the existing XML nodes within the view you’re inheriting from. You should actually think of the whole process as simple XML processing because all the semantic parts only come a <span class="No-Break">lot later.</span></p>
			<p>The most canonical instruction within the <strong class="source-inline">arch</strong> field of an inherited view is the <strong class="source-inline">field</strong> element, which has the required attributes: <strong class="source-inline">name</strong> and <strong class="source-inline">position</strong>. As you can only have every field appear once in a form, the name already uniquely identifies a field. With the <strong class="source-inline">position</strong> attribute, we can place whatever we put within the field element, either <strong class="source-inline">before</strong>, <strong class="source-inline">inside</strong>, or <strong class="source-inline">after</strong> regarding the field we named. The default is <strong class="source-inline">inside</strong>, but for readability, you should always name the position you require. Remember that we’re not talking semantics here; this is about the position in the XML tree relative to the field we have named. How this will be rendered afterward is a completely <span class="No-Break">different matter.</span></p>
			<p><em class="italic">Step 2</em> demonstrates a different approach. The <strong class="source-inline">xpath</strong> element selects the first element that matches the XPath expression named in the <strong class="source-inline">expr</strong> attribute. Here, the <strong class="source-inline">position</strong> attribute tells the processor where to put the contents of the <span class="No-Break"><strong class="source-inline">xpath</strong></span><span class="No-Break"> element.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">If you want to create an XPath expression based on a CSS class, Odoo provides a special function called <strong class="source-inline">hasclass</strong>. For example, if you want to select a <strong class="source-inline">&lt;div&gt;</strong> element with the <strong class="source-inline">test_class</strong> CSS class, then the expression will <span class="No-Break">be </span><span class="No-Break"><strong class="source-inline">expr="//div[hasclass('test_class')]"</strong></span><span class="No-Break">.</span></p>
			<p><em class="italic">Step 3</em> shows how you can change the position of an element. This option was introduced in <strong class="bold">version 12</strong>, and it is rarely used. In our example, we moved the <strong class="source-inline">phone</strong> field so that it came after the <strong class="source-inline">email</strong> field using the <span class="No-Break"><strong class="source-inline">position=move</strong></span><span class="No-Break"> option.</span></p>
			<p>XPath might look somewhat scary, but it is a very efficient means of selecting the node you need to work on. Take the time to look through some simple expressions; it’s worth it. You’ll likely stumble upon the term <strong class="bold">context node</strong>, to which some expressions are relative. In Odoo’s view inheritance system, this is always the root element of the view you’re <span class="No-Break">inheriting from.</span></p>
			<p>For all the other elements found in the <strong class="source-inline">arch</strong> field of an inheriting view, the processor looks for the first element with the same node name and matching attributes (with the attribute position excluded, as this is part of the instruction). Use this only in cases where it is very unlikely that this combination<a id="_idIndexMarker630"/> is not unique, such as a group element<a id="_idIndexMarker631"/> combined with a <span class="No-Break"><strong class="source-inline">name</strong></span><span class="No-Break"> attribute.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Note that you can have as many instruction elements within the <strong class="source-inline">arch</strong> field as you need. We only used one per inherited view because there’s nothing else we want to <span class="No-Break">change currently.</span></p>
			<h2 id="_idParaDest-422"><a id="_idTextAnchor496"/>There’s more...</h2>
			<p>The <strong class="source-inline">position</strong> attribute has two other possible values: <strong class="source-inline">replace</strong> and <strong class="source-inline">attributes</strong>. Using <strong class="source-inline">replace</strong> causes the selected element to be replaced with the content of the instruction element. Consequently, if you don’t have any content, the selected element can simply be removed. The preceding list or form view would cause the <strong class="source-inline">state</strong> field to <span class="No-Break">be removed:</span></p>
			<pre class="source-code">
&lt;field name="state" position="replace" /&gt;</pre>			<p class="callout-heading">Important note</p>
			<p class="callout">Removing fields<a id="_idIndexMarker632"/> can cause other inheriting views to break and several other undesirable side effects, so avoid that if possible. If you really need to remove fields, do so in a view that comes late in the order of evaluation (refer to the next section, <em class="italic">Order of evaluation in view inheritance</em>, for <span class="No-Break">more information).</span></p>
			<p><strong class="source-inline">attributes</strong> has very different semantics from the preceding examples. The processor expects the element to contain the <strong class="source-inline">attribute</strong> elements with a <strong class="source-inline">name</strong> attribute. These elements will then be used to set attributes for the selected element. If you want to heed the earlier warning, you should set the <strong class="source-inline">invisible</strong> attribute to <strong class="source-inline">1</strong> for the <span class="No-Break"><strong class="source-inline">state</strong></span><span class="No-Break"> field:</span></p>
			<pre class="source-code">
&lt;field name="state" position="attributes"&gt;
    &lt;attribute name="invisible"&gt;1&lt;/attribute&gt;
&lt;/field&gt;</pre>			<p>An <strong class="source-inline">attribute</strong> node can have <strong class="source-inline">add</strong> and <strong class="source-inline">remove</strong> attributes, which, in turn, should contain the value to be removed from or added to the space-separated list. This is very useful for the <strong class="source-inline">class</strong> attribute, where you’d add a class (instead of overwriting the whole attribute) by using <span class="No-Break">the following:</span></p>
			<pre class="source-code">
&lt;field name="description" position="attributes"&gt;
    &lt;attribute name="class" add="oe_inline" separator=" "/&gt;
&lt;/field&gt;</pre>			<p>This code adds the <strong class="source-inline">oe_inline</strong> class to the <strong class="source-inline">description</strong> field. If the field already has a class attribute present, Odoo will join the value with the value of the <span class="No-Break"><strong class="source-inline">separator</strong></span><span class="No-Break"> attribute.</span></p>
			<h3>Order of evaluation in view inheritance</h3>
			<p>As we currently have only one parent<a id="_idIndexMarker633"/> view and one inheriting view, we don’t run<a id="_idIndexMarker634"/> into any problems with conflicting view overrides. When you have installed a couple of modules, you’ll find a lot of overrides for the partner form. This is fine as long as they change different things in a view, but there are occasions where it is important to understand how overriding works in order to <span class="No-Break">avoid conflicts.</span></p>
			<p>The direct descendants of a view are evaluated in ascending order of their <strong class="source-inline">priority</strong> field, so views with a lower priority are applied first. Every step of inheritance is applied to the result of the first, so if a view with priority <strong class="source-inline">3</strong> changes a field and another one with priority <strong class="source-inline">5</strong> removes it, this is fine. This does not work, however, if the priorities <span class="No-Break">are reversed.</span></p>
			<p>You can also inherit an inheriting view itself from a view. In this case, the second-level inheriting view is applied to the result of the view it inherits from. So, if you have four views, <strong class="source-inline">A</strong>, <strong class="source-inline">B</strong>, <strong class="source-inline">C</strong>, and <strong class="source-inline">D</strong>, where <strong class="source-inline">A</strong> is a standalone form, <strong class="source-inline">B</strong> and <strong class="source-inline">C</strong> inherit from <strong class="source-inline">A</strong>, and <strong class="source-inline">D</strong> inherits from <strong class="source-inline">B</strong>, the order of evaluation is <strong class="source-inline">A</strong>, <strong class="source-inline">B</strong>, <strong class="source-inline">D</strong>, and <strong class="source-inline">C</strong>. Use this to enforce an order without having to rely on priorities; this is safer in general. If an inheriting view adds a field and you need to apply changes<a id="_idIndexMarker635"/> to this field, inherit from the inheriting<a id="_idIndexMarker636"/> view and not from the <span class="No-Break">standalone one.</span></p>
			<p class="callout-heading">Important  note</p>
			<p class="callout">This kind of inheritance always works on the complete XML tree from the original view, with modifications from the previous inheriting <span class="No-Break">views applied.</span></p>
			<p>The following points provide information on some advanced tricks that are used to tweak the behavior of <span class="No-Break">view inheritance:</span></p>
			<ul>
				<li>For inheriting views, a very useful and not very well-known field is <strong class="source-inline">groups_id</strong>. This field causes inheritance to take place only if the user requesting the parent view is a member of one of the groups mentioned there. This can save you a lot of work when adapting the user interface for different levels of access because, with inheritance, you can have more complex operations than just showing or not showing the elements based on group membership, as is possible with the <strong class="source-inline">groups</strong> attribute for <span class="No-Break">form elements.</span></li>
				<li>You can, for example, remove elements if the user is a member of a group (which is the inverse of what the <strong class="source-inline">groups</strong> attribute does). You can also carry out some elaborate tricks, such as adding attributes based on group membership. Think about simple things, such as making a field read-only for certain groups, or more interesting concepts, such as using different widgets for <span class="No-Break">different groups.</span></li>
				<li>What was described in this recipe relates to the <strong class="source-inline">mode</strong> field of the original view being set to primary, while the inheriting views have the mode extension, which is the default. We will investigate the case in which the mode of an inheriting view is set to <strong class="source-inline">primary</strong> later, where<a id="_idIndexMarker637"/> the rules are<a id="_idIndexMarker638"/> <span class="No-Break">slightly different.</span></li>
			</ul>
			<h1 id="_idParaDest-423"><a id="_idTextAnchor497"/>Defining document-style forms</h1>
			<p>In this recipe, we’ll review some design <a id="_idIndexMarker639"/>guidelines in order to present a uniform <span class="No-Break">user experience.</span></p>
			<h2 id="_idParaDest-424"><a id="_idTextAnchor498"/>How to do it...</h2>
			<ol>
				<li>Start your form with a <span class="No-Break"><strong class="source-inline">header</strong></span><span class="No-Break"> element:</span><pre class="source-code">
<strong class="bold">&lt;header&gt;</strong>
<strong class="bold">    &lt;button name="make_available" string="Make Available" type="object"/&gt;</strong>
<strong class="bold">    &lt;button name="make_closed"  string="Make Closed" type="object"/&gt;</strong>
<strong class="bold">    &lt;button type="action" name="%(my_hostel.hostel_room_category_action)d"        string="Open Hotel Room Category" /&gt;</strong>
<strong class="bold">    &lt;field name="state" widget="statusbar"/&gt;</strong>
<strong class="bold">&lt;/header&gt;</strong></pre></li>				<li>Add a <strong class="source-inline">sheet</strong> element <span class="No-Break">for content:</span><pre class="source-code">
<strong class="bold">&lt;sheet&gt;</strong></pre></li>				<li>Put in the <strong class="source-inline">stat</strong> button, which will be used to show total <strong class="source-inline">Hostel Room</strong> and will redirect to <span class="No-Break">hostel room:</span><pre class="source-code">
<strong class="bold">&lt;div class="oe_button_box" name="button_box"&gt;</strong>
<strong class="bold">    &lt;button type="object" class="oe_stat_button" icon="fa-pencil-square-o" name="action_open_related_hostel_room"&gt;</strong>
<strong class="bold">        &lt;div class="o_form_field o_stat_info"&gt;</strong>
<strong class="bold">            &lt;span class="o_stat_value"&gt;</strong>
<strong class="bold">                 &lt;field name="related_hostel_room"/&gt;</strong>
<strong class="bold">            &lt;/span&gt;</strong>
<strong class="bold">            &lt;span class="o_stat_text"&gt;Hostel Room&lt;/span&gt;</strong>
<strong class="bold">        &lt;/div&gt;</strong>
<strong class="bold">    &lt;/button&gt;</strong>
<strong class="bold">&lt;/div&gt;</strong></pre></li>				<li>Add some <span class="No-Break">prominent</span><span class="No-Break"><a id="_idIndexMarker640"/></span><span class="No-Break"> field(s):</span><pre class="source-code">
<strong class="bold">&lt;div class="oe_title"&gt;</strong>
<strong class="bold">    &lt;h1&gt;</strong>
<strong class="bold">        &lt;field name="name"/&gt;</strong>
<strong class="bold">    &lt;/h1&gt;</strong>
<strong class="bold">&lt;/div&gt;</strong></pre></li>				<li>Add your content; you can use a notebook if there are a lot <span class="No-Break">of fields:</span><pre class="source-code">
<strong class="bold">&lt;group&gt;</strong>
<strong class="bold">    &lt;field name="child_ids"/&gt;</strong>
<strong class="bold">    &lt;field name="hoste_room_ids" widget="many2many_tags"/&gt;</strong>
<strong class="bold">&lt;/group&gt;</strong></pre></li>				<li>After the sheet, add the <strong class="source-inline">chatter</strong> widget (<span class="No-Break">if applicable):</span><pre class="source-code">
<strong class="bold">&lt;/sheet&gt;</strong>
<strong class="bold">    &lt;div class="oe_chatter"&gt;</strong>
<strong class="bold">         &lt;field name="message_follower_ids" widget="mail_followers"/&gt;</strong>
<strong class="bold">         &lt;field name="message_ids" widget="mail_thread"/&gt;</strong>
<strong class="bold">         &lt;field name="activity_ids" widget="mail_activity"/&gt;</strong>
<strong class="bold">    &lt;/div&gt;</strong></pre></li>			</ol>
			<p>Let’s have a look at how this <span class="No-Break">recipe works.</span></p>
			<h2 id="_idParaDest-425"><a id="_idTextAnchor499"/>How it works...</h2>
			<p>The header should contain<a id="_idIndexMarker641"/> buttons that execute actions on the object that the user currently sees. Use the <strong class="source-inline">btn-primary</strong> class to make buttons visually stand out (in purple at the time of writing), which is a good way to guide the user regarding which is the most logical action to execute at the moment. Try to have all the highlighted buttons to the left of the non-highlighted buttons and hide the buttons that are not relevant in the current state (if applicable). If the model has a state, show it in the header using the <strong class="source-inline">statusbar</strong> widget. This will be rendered as right-aligned in <span class="No-Break">the header.</span></p>
			<p>The <strong class="source-inline">sheet</strong> element is rendered as a stylized sheet, and the most important fields should be the first thing the user sees when looking at it. Use the <strong class="source-inline">oe_title</strong> classes to have them rendered in a prominent place (floating left with slightly adjusted font sizes at the time <span class="No-Break">of writing).</span></p>
			<p>If there are other records of interest concerning the record the user currently sees (such as the partner’s invoices on a partner form), put them in an element with the <strong class="source-inline">oe_right</strong> and <strong class="source-inline">oe_button_box</strong> classes; this aligns the buttons in it to the right. On the buttons themselves, use the <strong class="source-inline">oe_stat_button</strong> class to enforce a uniform rendering of the buttons. It’s also customary to assign an icon class from the <strong class="bold">Font Awesome</strong> icons for the <strong class="source-inline">icon</strong> attribute. You can learn more<a id="_idIndexMarker642"/> about Font Awesome <span class="No-Break">at </span><a href="https://fontawesome.com/v4.7.0/icons/"><span class="No-Break">https://fontawesome.com/v4.7.0/icons/</span></a><span class="No-Break">.</span></p>
			<p>You can use the <strong class="source-inline">oe_chatter</strong> class and <strong class="bold">Chatter widgets</strong> to get the default chatter at the bottom of the form view. For this, you need to use the <strong class="source-inline">mail.thread</strong> mixin. We will see this in detail<a id="_idIndexMarker643"/> in <a href="B20997_23.xhtml#_idTextAnchor1210"><span class="No-Break"><em class="italic">Chapter 23</em></span></a>, <em class="italic">Managing Emails </em><span class="No-Break"><em class="italic">in Odoo</em></span><span class="No-Break">.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Even if you do not like this layout, stick to the element and class names described here and adjust what you need with CSS and possibly JavaScript. This will make the user interface more compatible with existing add-ons and allow you to integrate better with <span class="No-Break">core add-ons.</span></p>
			<h2 id="_idParaDest-426"><a id="_idTextAnchor500"/>See also</h2>
			<ul>
				<li>To find out more <a id="_idIndexMarker644"/>about Font Awesome, go <span class="No-Break">to </span><a href="https://fontawesome.com/v4.7.0/icons/"><span class="No-Break">https://fontawesome.com/v4.7.0/icons/</span></a><span class="No-Break">.</span></li>
				<li>For more details on the <strong class="source-inline">mail.thread</strong> mixin, refer to <a href="B20997_23.xhtml#_idTextAnchor1210"><span class="No-Break"><em class="italic">Chapter 23</em></span></a>, <em class="italic">Managing Emails </em><span class="No-Break"><em class="italic">in Odoo</em></span><span class="No-Break">.</span></li>
			</ul>
			<h1 id="_idParaDest-427"><a id="_idTextAnchor501"/>Dynamic form elements using attributes</h1>
			<p>So far, we have only <a id="_idIndexMarker645"/>looked into changing<a id="_idIndexMarker646"/> forms depending on the user’s groups (the <strong class="source-inline">groups</strong> attribute for elements and the <strong class="source-inline">groups_id</strong> field for inherited views) and nothing more. This recipe will show you how to modify the form view based on the value of the fields <span class="No-Break">in it.</span></p>
			<h2 id="_idParaDest-428"><a id="_idTextAnchor502"/>How to do it...</h2>
			<ol>
				<li>Define an attribute called <strong class="source-inline">attributes</strong> on a <span class="No-Break">form element:</span><pre class="source-code">
<strong class="bold">&lt;field name="child_ids"</strong>
<strong class="bold">    invisible="not parent_id"</strong>
<strong class="bold">    required="parent_id"/&gt;</strong></pre></li>				<li>Ensure that all the fields you refer to are available in <span class="No-Break">your form:</span><pre class="source-code">
<strong class="bold">&lt;field name="parent_id"/&gt;</strong></pre></li>			</ol>
			<p>This will make the <strong class="source-inline">child_ids</strong> field invisible if the <strong class="source-inline">parent_id</strong> is not <strong class="source-inline">hostel room category</strong>, and it will be required if it’s a hostel <span class="No-Break">room category.</span></p>
			<h2 id="_idParaDest-429"><a id="_idTextAnchor503"/>How it works...</h2>
			<p><strong class="bold">attributes</strong> contains a dictionary with <strong class="source-inline">invisible</strong>, <strong class="source-inline">required</strong>, and <strong class="source-inline">readonly</strong> keys (all of which are optional). The values are domains that may refer to the fields that exist on the form (and really only those, so there are no dotted paths), and the whole dictionary is evaluated according to the rules for client-side Python, as described earlier in the <em class="italic">Passing parameters to forms and actions – Context</em> recipe of this chapter. So, for example, you can access<a id="_idIndexMarker647"/> the context in the <span class="No-Break">right-hand</span><span class="No-Break"><a id="_idIndexMarker648"/></span><span class="No-Break"> operand.</span></p>
			<h2 id="_idParaDest-430"><a id="_idTextAnchor504"/>There’s more...</h2>
			<p>While this mechanism is quite straightforward for scalar fields, it’s less obvious how to handle the <strong class="source-inline">one2many</strong> and <strong class="source-inline">many2many</strong> fields. In fact, in standard Odoo, you can’t do much with those fields within <strong class="bold">attributes</strong>. However, if you only need to check whether such a field is empty, use <strong class="source-inline">[[6, False, []]]</strong> as your <span class="No-Break">right-hand operand.</span></p>
			<h1 id="_idParaDest-431"><a id="_idTextAnchor505"/>Defining embedded views</h1>
			<p>When you show a <strong class="source-inline">one2many</strong> or a <strong class="source-inline">many2many</strong> field on<a id="_idIndexMarker649"/> a form, you don’t have much control over how it is rendered if you haven’t used one of the specialized widgets. Additionally, in the case of the <strong class="source-inline">many2one</strong> fields, it is sometimes desirable to be able to influence the way the linked record is opened. In this recipe, we’ll look at how to define private views for <span class="No-Break">those fields.</span></p>
			<h2 id="_idParaDest-432"><a id="_idTextAnchor506"/>How to do it...</h2>
			<ol>
				<li>Define your field as usual, but don’t close <span class="No-Break">the tag:</span><pre class="source-code">
<strong class="bold">&lt;field name="hostel_room_ids"&gt;</strong></pre></li>				<li>Write the view definition(s) into <span class="No-Break">the tag:</span><pre class="source-code">
<strong class="bold">&lt;tree&gt;</strong>
<strong class="bold">    &lt;field name="name"/&gt;</strong>
<strong class="bold">    &lt;field name="room_no"/&gt;</strong>
<strong class="bold">&lt;/tree&gt;</strong>
<strong class="bold">&lt;form&gt;</strong>
<strong class="bold">    &lt;sheet&gt;</strong>
<strong class="bold">        &lt;group&gt;</strong>
<strong class="bold">            &lt;field name="name"/&gt;</strong>
<strong class="bold">            &lt;field name="room_no"/&gt;</strong>
<strong class="bold">        </strong><strong class="bold">&lt;/group&gt;</strong>
<strong class="bold">    &lt;/sheet&gt;</strong>
<strong class="bold">&lt;/form&gt;</strong></pre></li>				<li>Close <span class="No-Break">the tag:</span><pre class="source-code">
<strong class="bold">&lt;/field&gt;</strong></pre></li>			</ol>
			<h2 id="_idParaDest-433"><a id="_idTextAnchor507"/>How it works...</h2>
			<p>When Odoo loads a form<a id="_idIndexMarker650"/> view, it first checks whether the <strong class="source-inline">relational</strong> type fields have embedded views in the field, as outlined previously. Those embedded views can have the exact same elements as the views we defined before. Only if Odoo doesn’t find an embedded view of some type does it use the model’s default view of <span class="No-Break">this type.</span></p>
			<h2 id="_idParaDest-434"><a id="_idTextAnchor508"/>There’s more...</h2>
			<p>While embedded views might seem like a great feature, they complicate view inheritance a lot. For example, as soon as embedded views are involved, the field names are not guaranteed to be unique, and you’ll usually have to use some elaborate XPaths to select elements within an <span class="No-Break">embedded view.</span></p>
			<p>So, in general, you should better define standalone views and use the <strong class="source-inline">form_view_ref</strong> and <strong class="source-inline">tree_view_ref</strong> keys, as described earlier in the <em class="italic">Having an action open a specific view</em> recipe of <span class="No-Break">this chapter.</span></p>
			<h1 id="_idParaDest-435"><a id="_idTextAnchor509"/>Displaying attachments on the side of the form view</h1>
			<p>In some applications, such <a id="_idIndexMarker651"/>as invoicing, you need<a id="_idIndexMarker652"/> to fill in data based on a document. To ease the data-filling process, a new feature was added to Odoo version 12 to display the document on the side of the <span class="No-Break">form view.</span></p>
			<p>In this recipe, we will learn how to display the form view and the document side <span class="No-Break">by side:</span></p>
			<div>
				<div id="_idContainer066" class="IMG---Figure">
					<img src="image/B20997_09_3.jpg" alt="Figure 9.3 – Cascading attachments and the form view"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.3 – Cascading attachments and the form view</p>
			<p class="callout-heading">Important note</p>
			<p class="callout">This feature is only meant for large displays (<strong class="source-inline">&gt;1534px</strong>), so if you have a small viewport, this feature will be hidden. Internally, this feature uses some responsive <a id="_idIndexMarker653"/>utilities, so this feature only works in the <strong class="bold">Enterprise</strong> edition. However, you can still use this code in your module. Odoo will automatically handle this, so if the module is installed in the Enterprise edition, it will show the document, while in the Community edition, it will hide everything without any <span class="No-Break">side effects.</span></p>
			<h2 id="_idParaDest-436"><a id="_idTextAnchor510"/>How to do it...</h2>
			<p>We will enable<a id="_idIndexMarker654"/> this feature<a id="_idIndexMarker655"/> to modify a form view for the <strong class="source-inline">hostel.room.category</strong> model, <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
&lt;record id="hostel_room_category_view_form" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Form&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;form&gt;
            &lt;sheet&gt;
                &lt;div class="oe_button_box" name="button_box"&gt;
                    &lt;button type="object" class="oe_stat_button" icon="fa-pencil-square-o" name="action_open_related_hostel_room"&gt;
                        &lt;div class="o_form_field o_stat_info"&gt;
                            &lt;span class="o_stat_value"&gt;
                                &lt;field name="related_hostel_room"/&gt;
                            &lt;/span&gt;
                            &lt;span class="o_stat_text"&gt;Hostel Room&lt;/span&gt;
                        &lt;/div&gt;
                    &lt;/button&gt;
                &lt;/div&gt;
                &lt;div class="oe_title"&gt;
                   &lt;h1&gt;
                        &lt;field name="name"/&gt;
                    &lt;/h1&gt;
                &lt;/div&gt;
                &lt;group&gt;
                    &lt;group&gt;
                        &lt;field name="description"/&gt;
                    &lt;/group&gt;
                    &lt;group&gt;
                        &lt;field name="parent_id"/&gt;
                    &lt;/group&gt;
                &lt;/group&gt;
                &lt;group&gt;
                    &lt;field name="child_ids"
                           invisible="not parent_id"
                           required="parent_id"/&gt;
                    &lt;field name="hoste_room_ids"&gt;
                        &lt;tree&gt;
                            &lt;field name="name"/&gt;
                            &lt;field name="room_no"/&gt;
                        &lt;/tree&gt;
                        &lt;form&gt;
                            &lt;sheet&gt;
                                &lt;group&gt;
                                    &lt;field name="name" /&gt;
                                    &lt;field name="room_no"/&gt;
                                &lt;/group&gt;
                            &lt;/sheet&gt;
                        &lt;/form&gt;
                    &lt;/field&gt;
                &lt;/group&gt;
            &lt;/sheet&gt;
            &lt;div class="o_attachment_preview" options="{'types': ['image', 'pdf'], 'order': 'desc'}"/&gt;
            &lt;div class="oe_chatter"&gt;
                &lt;field name="message_follower_ids" widget="mail_followers"/&gt;
                &lt;field name="message_ids" widget="mail_thread"/&gt;
                &lt;field name="activity_ids" widget="mail_activity"/&gt;
            &lt;/div&gt;
        &lt;/form&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre>			<p>Update the module<a id="_idIndexMarker656"/> to apply<a id="_idIndexMarker657"/> the changes. You need to upload a PDF or image via the record chatter. When you upload it, Odoo will display the attachment on <span class="No-Break">the side.</span></p>
			<h2 id="_idParaDest-437"><a id="_idTextAnchor511"/>How it works...</h2>
			<p>This feature only works if your model has inherited the <strong class="source-inline">mail.thread</strong> model. To show the document on the side of any form view, you will need to add an empty <strong class="source-inline">&lt;div&gt;</strong> with the <strong class="source-inline">o_attachment_preview</strong> class before the chatter elements. That’s it; the documents attached in the chatter will be displayed on the side of the <span class="No-Break">form view.</span></p>
			<p>By default, the <strong class="source-inline">pdf</strong> and <strong class="source-inline">image</strong> documents will be displayed in ascending order by date. You can change this behavior by providing extra options, which include <span class="No-Break">the following:</span></p>
			<ul>
				<li><strong class="source-inline">type</strong>: You need to pass the list of document types you want to allow. Only two values are possible: <strong class="source-inline">pdf</strong> and <strong class="source-inline">image</strong>. For example, if you want to display only <strong class="source-inline">pdf</strong>-type images, you can pass <strong class="source-inline">{'</strong><span class="No-Break"><strong class="source-inline">type': ['pdf']}</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">order</strong>: The possible values are <strong class="source-inline">asc</strong> and <strong class="source-inline">desc</strong>. These allow you to show documents in ascending<a id="_idIndexMarker658"/> order or descending order<a id="_idIndexMarker659"/> of the document <span class="No-Break">creation date.</span></li>
			</ul>
			<h2 id="_idParaDest-438"><a id="_idTextAnchor512"/>There’s more...</h2>
			<p>In most cases, you want to display documents on the side of the initial state of any record. If you want to hide the attachment preview based on domain, you can use <strong class="source-inline">attributes</strong> on the <strong class="source-inline">&lt;div&gt;</strong> tag to hide <span class="No-Break">the preview.</span></p>
			<p>Take a look at the following example: it will hide the PDF preview if the value of the <strong class="source-inline">state</strong> field is <span class="No-Break">not </span><span class="No-Break"><strong class="source-inline">draft</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
&lt;div class="o_attachment_preview"
    invisible="state != 'draft'"/&gt;</pre>			<p>This is how you can hide attachments when they are not needed. Usually, this feature is used to fill data from PDFs and is only activated in <span class="No-Break">draft mode.</span></p>
			<h1 id="_idParaDest-439"><a id="_idTextAnchor513"/>Defining kanban views</h1>
			<p>So far, we have presented<a id="_idIndexMarker660"/> you with a list of records that can be opened to show a form. While those lists are efficient when presenting a lot of information, they tend to be slightly boring, given the lack of design possibilities. In this recipe, we’ll take a look at <strong class="bold">kanban views</strong>, which allow us to present<a id="_idIndexMarker661"/> lists of records in a more <span class="No-Break">appealing way.</span></p>
			<h2 id="_idParaDest-440"><a id="_idTextAnchor514"/>How to do it...</h2>
			<ol>
				<li>Define a view of the <span class="No-Break"><strong class="source-inline">kanban</strong></span><span class="No-Break"> type:</span><pre class="source-code">
&lt;record id="hostel_room_category_view_kanban" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories kanban&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;kanban class="o_kanban_mobile" sample="1"&gt;</pre></li>				<li>List the fields you’ll use in <span class="No-Break">your view:</span><pre class="source-code">
    &lt;field name="name"/&gt;
    &lt;field name="description"/&gt;
    &lt;field name="parent_id"/&gt;</pre></li>				<li>Implement <span class="No-Break">a design:</span><pre class="source-code">
&lt;templates&gt;
    &lt;t t-name="kanban-box"&gt;
        &lt;div t-attf-class="oe_kanban_global_click"&gt;
             &lt;div class="row mb4"&gt;
                 &lt;div class="col-6 o_kanban_record_headings"&gt;
                     &lt;strong&gt;
                         &lt;span&gt;
                             &lt;field name="name"/&gt;
                         &lt;/span&gt;
                     &lt;/strong&gt;
                  &lt;/div&gt;
                  &lt;div class="col-6 text-end"&gt;
                      &lt;strong&gt;&lt;i role="img" title="description"/&gt;
                          &lt;t t-esc="record.description.value"/&gt;&lt;/strong&gt;
                     &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="row"&gt;
                     &lt;div class="col-12"&gt;
                          &lt;span&gt;&lt;field name="parent_id"/&gt;&lt;/span&gt;
                     &lt;/div&gt;
                &lt;/div&gt;
           &lt;/div&gt;
     &lt;/t&gt;
&lt;/templates&gt;</pre></li>				<li>Close all<a id="_idIndexMarker662"/> <span class="No-Break">the tags:</span><pre class="source-code">
        &lt;/kanban&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Add this view to one of your actions. This is left as an exercise for the reader. You will find a full working example in the GitHub example <span class="No-Break">files</span><span class="No-Break"><span class="P---URL">: </span></span><a href="https://github.com/PacktPublishing/Odoo-13-Development-Cookbook-Fourth-Edition/tree/master/Chapter09/15_kanban_view/my_module"><span class="No-Break">https://github.com/PacktPublishing/Odoo-13-Development-Cookbook-Fourth-Edition/tree/master/Chapter09/15_kanban_view/my_module</span></a><span class="No-Break">.</span></li>
			</ol>
			<h2 id="_idParaDest-441"><a id="_idTextAnchor515"/>How it works...</h2>
			<p>We need to give a list of fields<a id="_idIndexMarker663"/> to load in <em class="italic">step 2</em> in order to be able to access them later. The content of the <strong class="source-inline">templates</strong> element must be a single <strong class="source-inline">t</strong> element with the <strong class="source-inline">t-name</strong> attribute set <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">kanban-box</strong></span><span class="No-Break">.</span></p>
			<p>What you write inside this element will be repeated for each record, with special semantics for <strong class="source-inline">t</strong> elements and <strong class="source-inline">t-*</strong> attributes. For details about this, refer to the <em class="italic">Using client-side QWeb templates</em> recipe from <a href="B20997_15.xhtml#_idTextAnchor861"><span class="No-Break"><em class="italic">Chapter 15</em></span></a>, <em class="italic">Web Client Development</em> because, technically speaking, kanban views are just an application of <span class="No-Break">QWeb templates.</span></p>
			<p>There are a few modifications that are particular to kanban views. You have access to the <strong class="source-inline">read_only_mode</strong>, <strong class="source-inline">record</strong>, and <strong class="source-inline">widget</strong> variables during evaluation. Fields can be accessed using <strong class="source-inline">record.fieldname</strong>, which is an object with the <strong class="source-inline">value</strong> and <strong class="source-inline">raw_value</strong> properties, where <strong class="source-inline">value</strong> is the field’s value that has been formatted in a way that is presentable to the user, and <strong class="source-inline">raw_value</strong> is the field’s value, as it comes from <span class="No-Break">the database.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout"><strong class="source-inline">many2many</strong> fields make an exception here. You’ll only get an ID list through the <strong class="source-inline">record</strong> variable. For a user-readable representation, you must use the <span class="No-Break"><strong class="source-inline">field</strong></span><span class="No-Break"> element.</span></p>
			<p>Note the <strong class="source-inline">type</strong> attribute of the link at the top of the template. This attribute makes Odoo generate a link that opens the record in view mode (<strong class="bold">open</strong>) or edit mode (<strong class="bold">edit</strong>), or it deletes the record (<strong class="bold">delete</strong>). The <strong class="source-inline">type</strong> attribute can also be <strong class="source-inline">object</strong> or <strong class="source-inline">action</strong>, which will render the links that call a function from the model or an action. In both cases, you need to supplement the attributes for buttons in form views, as outlined in the <em class="italic">Adding buttons to forms</em> recipe of this chapter. Instead of the <strong class="source-inline">a</strong> element, you can also use the <strong class="source-inline">button</strong> element; the <strong class="source-inline">type</strong> attribute<a id="_idIndexMarker664"/> has the same <span class="No-Break">semantics here.</span></p>
			<h2 id="_idParaDest-442"><a id="_idTextAnchor516"/>There’s more...</h2>
			<p>There are a few more helper functions worth mentioning. If you need to generate a pseudo-random color for an element, use the <strong class="source-inline">kanban_color(some_variable)</strong> function, which will return a CSS class that sets the <strong class="source-inline">background</strong> and <strong class="source-inline">color</strong> properties. This is usually used in the <span class="No-Break"><strong class="source-inline">t-att-class</strong></span><span class="No-Break"> elements.</span></p>
			<p>If you want to display an image stored in a binary field, use <strong class="source-inline">kanban_image(modelname, fieldname, record.id.raw_value)</strong>, which returns a data URI if you included the field in your fields list; the field is set, is a placeholder if the field is not set, or is a URL that makes Odoo stream the field’s contents if you didn’t include the field in your fields list. Do not include the field in the fields list if you need to display a lot of records simultaneously or if you expect very big images. Usually, you’d use this in a <strong class="source-inline">t-att-src</strong> attribute of an <span class="No-Break"><strong class="source-inline">img</strong></span><span class="No-Break"> element.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Doing design in kanban views can be a bit trying. What often works better is generating HTML using a function field of the HTML type and generating this HTML from a Qweb view. In this way, you’re still doing QWeb but doing so on the server side, which is a lot more convenient when you need to work on a lot <span class="No-Break">of data.</span></p>
			<h2 id="_idParaDest-443"><a id="_idTextAnchor517"/>See also</h2>
			<ul>
				<li>To know more about template elements, refer to the <em class="italic">Using client-side QWeb templates</em> recipe from <a href="B20997_15.xhtml#_idTextAnchor861"><span class="No-Break"><em class="italic">Chapter 15</em></span></a>, <em class="italic">Web </em><span class="No-Break"><em class="italic">Client Development</em></span><span class="No-Break">.</span></li>
			</ul>
			<h1 id="_idParaDest-444"><a id="_idTextAnchor518"/>Showing kanban cards in columns according to their state</h1>
			<p>This recipe shows<a id="_idIndexMarker665"/> you how to set<a id="_idIndexMarker666"/> up a kanban view where the user can drag and drop a record from one column to the other, thereby pushing the record in question into <span class="No-Break">another state.</span></p>
			<h2 id="_idParaDest-445"><a id="_idTextAnchor519"/>Getting ready</h2>
			<p>From now on, we’ll make<a id="_idIndexMarker667"/> use of the hostel module<a id="_idIndexMarker668"/> here, as this defines models that lend themselves better to date- and state-based views than those defined in the base module. So, before proceeding, add <strong class="source-inline">base</strong> to the dependencies list of <span class="No-Break">your add-on.</span></p>
			<h2 id="_idParaDest-446"><a id="_idTextAnchor520"/>How to do it...</h2>
			<ol>
				<li>Define a kanban view for the hostel <span class="No-Break">room category:</span><pre class="source-code">
&lt;record id="hostel_room_category_view_kanban" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories kanban&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;kanban class="o_kanban_mobile" sample="1" default_group_by="parent_id"&gt;
            &lt;field name="name"/&gt;
            &lt;field name="description"/&gt;
            &lt;templates&gt;
                &lt;t t-name="kanban-box"&gt;
                    &lt;div t-attf-class="oe_kanban_global_click"&gt;
                        &lt;div class="row mb4"&gt;
                            &lt;div class="col-6 o_kanban_record_headings"&gt;
                                &lt;strong&gt;
                                    &lt;span&gt;
                                        &lt;field name="name"/&gt;
                                    &lt;/span&gt;
                               &lt;/strong&gt;
                           &lt;/div&gt;
                           &lt;div class="col-6 text-end"&gt;
                               &lt;strong&gt;&lt;i role="img" title="description"/&gt; &lt;t t-esc="record.description.value"/&gt;&lt;/strong&gt;
                           &lt;/div&gt;
                       &lt;/div&gt;
                       &lt;div class="row"&gt;
                           &lt;div class="col-12"&gt;
                               &lt;span&gt;&lt;field name="parent_id"/&gt;&lt;/span&gt;
                           &lt;/div&gt;
                       &lt;/div&gt;
                   &lt;/div&gt;
               &lt;/t&gt;
           &lt;/templates&gt;
       &lt;/kanban&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Add a menu and<a id="_idIndexMarker669"/> an action<a id="_idIndexMarker670"/> using this view. This is left as an exercise for <span class="No-Break">the reader.</span></li>
			</ol>
			<h2 id="_idParaDest-447"><a id="_idTextAnchor521"/>How it works...</h2>
			<p>Kanban views support<a id="_idIndexMarker671"/> grouping, which allows<a id="_idIndexMarker672"/> you to display records that have a group field in common in the same column. This is commonly used for a <strong class="source-inline">parent hotel room category</strong> or <strong class="source-inline">parent_id</strong> field because it allows the user to change this field’s value for a record by simply dragging it into another column. Set the <strong class="source-inline">default_group_by</strong> attribute on the <strong class="source-inline">kanban</strong> element to the name of the field you want to group by in order to make use of <span class="No-Break">this functionality.</span></p>
			<p>To control the behavior of kanban grouping, there are a few options available <span class="No-Break">in Odoo:</span></p>
			<ul>
				<li><strong class="source-inline">group_create</strong>: This option is used to hide or show the <strong class="bold">Add a new column</strong> option in grouped kanban. The default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">true</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">group_delete</strong>: This option enables or disables the <strong class="bold">Column delete</strong> option in the kanban group context menu. The default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">true</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">group_edit</strong>: This option enables or disables the <strong class="bold">Column edit</strong> option in the kanban group context menu. The default value <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">true</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">archivable</strong>: This option enables or disables the option to archive and restore the records from the kanban group context menu. This only works if the <strong class="source-inline">active</strong> Boolean field is present in <span class="No-Break">your model.</span></li>
				<li><strong class="source-inline">quick_create</strong>: With this option, you can create records directly from the <span class="No-Break">kanban view.</span></li>
				<li><strong class="source-inline">quick_create_view</strong>: By default, the <strong class="source-inline">quick_create</strong> option displays only the name field in kanban. However, with the <strong class="source-inline">quick_create_view</strong> option, you can give the reference to the minimal form view so as to display it <span class="No-Break">in kanban.</span></li>
				<li><strong class="source-inline">on_create</strong>: If you don’t want to use <strong class="source-inline">quick_create</strong> when creating a new record and you don’t want to redirect the user to the form view either, you can give the reference of the wizard<a id="_idIndexMarker673"/> so that it will open<a id="_idIndexMarker674"/> the wizard when clicking the <span class="No-Break"><strong class="bold">Create</strong></span><span class="No-Break"> button.</span></li>
			</ul>
			<h2 id="_idParaDest-448"><a id="_idTextAnchor522"/>There’s more...</h2>
			<p>If not defined in the dedicated attribute, any search filter can add grouping by setting a context key named <strong class="source-inline">group_by</strong> to the field name(s) to <span class="No-Break">group by.</span></p>
			<h1 id="_idParaDest-449"><a id="_idTextAnchor523"/>Defining calendar views</h1>
			<p>This recipe walks<a id="_idIndexMarker675"/> you through how to display and edit information about dates and duration in your records in a <span class="No-Break">visual way.</span></p>
			<h2 id="_idParaDest-450"><a id="_idTextAnchor524"/>How to do it...</h2>
			<p>Follow these steps to add a <strong class="source-inline">calendar</strong> view for the <span class="No-Break"><strong class="source-inline">hostel.room.category</strong></span><span class="No-Break"> model:</span></p>
			<ol>
				<li>Define a <span class="No-Break"><strong class="source-inline">calendar</strong></span><span class="No-Break"> view:</span><pre class="source-code">
&lt;record id="hostel_room_category_view_calendar" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Calendar&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;calendar date_start="date_assign" date_stop="date_end" color="parent_id"&gt;
            &lt;field name="name" /&gt;
            &lt;field name="parent_id" /&gt;
        &lt;/calendar&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Add menus and actions using this view. This is left as an exercise for <span class="No-Break">the reader.</span></li>
			</ol>
			<h2 id="_idParaDest-451"><a id="_idTextAnchor525"/>How it works...</h2>
			<p>The <strong class="source-inline">calendar</strong> view needs to pass<a id="_idIndexMarker676"/> the field names in the <strong class="source-inline">date_start</strong> and <strong class="source-inline">date_stop</strong> attributes to indicate which fields to look at when building the visual representation. Only use fields with the <strong class="source-inline">Datetime</strong> or <strong class="source-inline">Date</strong> type; other types of fields will not work and will instead generate an error. While <strong class="source-inline">date_start</strong> is required, you can leave out <strong class="source-inline">date_stop</strong> and set the <strong class="source-inline">date_delay</strong> attribute instead, which is expected to be a <strong class="source-inline">Float</strong> field that represents the duration <span class="No-Break">in hours.</span></p>
			<p>The <strong class="source-inline">calendar</strong> view allows you to give records that have the same value in a field the same (arbitrarily assigned) color. To use this functionality, set the <strong class="source-inline">color</strong> attribute to the name of the field you need. In our example, we can see at a glance which hostel room category belongs to the same hostel room category because we assigned <strong class="source-inline">parent_id</strong> as the field to determine the <span class="No-Break">color groups.</span></p>
			<p>The fields you name in the <strong class="source-inline">calendar</strong> element’s body are shown within the block that represents the time interval <a id="_idIndexMarker677"/>covered, separated <span class="No-Break">by commas.</span></p>
			<h2 id="_idParaDest-452"><a id="_idTextAnchor526"/>There’s more...</h2>
			<p>The <strong class="source-inline">calendar</strong> view has some other helpful attributes. If you want to open calendar entries in a popup instead of the standard form view, set <strong class="source-inline">event_open_popup</strong> to <strong class="source-inline">1</strong>. By default, you create a new entry by just filling in some text, which internally calls the model’s <strong class="source-inline">name_create</strong> function to actually create the record. If you want to disable this behavior, set <strong class="source-inline">quick_add</strong> <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">0</strong></span><span class="No-Break">.</span></p>
			<p>If your model covers a whole day, set <strong class="source-inline">all_day</strong> to a field’s name that is <strong class="source-inline">true</strong> if the record covers the whole day and <span class="No-Break"><strong class="source-inline">false</strong></span><span class="No-Break"> otherwise.</span></p>
			<h1 id="_idParaDest-453"><a id="_idTextAnchor527"/>Defining graph view and pivot view</h1>
			<p>In this recipe, we’ll take<a id="_idIndexMarker678"/> a look<a id="_idIndexMarker679"/> at Odoo’s business intelligence views. These are read-only views that are meant to <span class="No-Break">present data.</span></p>
			<h2 id="_idParaDest-454"><a id="_idTextAnchor528"/>Getting ready</h2>
			<p>We’re still making use<a id="_idIndexMarker680"/> of the <strong class="source-inline">hostel</strong> module<a id="_idIndexMarker681"/> here. You can configure a graph and pivot views to get different statistics. For our example, we will focus on the assigned user. We will generate a graph and pivot view to see the users of the hostel room category. By the way, the end user can generate statistics of their choice by modifying the <span class="No-Break">view options.</span></p>
			<h2 id="_idParaDest-455"><a id="_idTextAnchor529"/>How to do it...</h2>
			<ol>
				<li>Define a graph view <span class="No-Break">using bars:</span><pre class="source-code">
&lt;record id="hostel_room_category_view_graph" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Graph&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;graph type="bar"&gt;
            &lt;field name="parent_id"/&gt;
            &lt;field name="child_ids"/&gt;
        &lt;/graph&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Define a <span class="No-Break">pivot view:</span><pre class="source-code">
&lt;record id="hostel_room_category_view_pivot" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Pivot&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;pivot&gt;
            &lt;field name="parent_id" type="row"/&gt;
            &lt;field name="name" type="col"/&gt;
        &lt;/pivot&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Add menus and actions using this view. This is left as an exercise for <span class="No-Break">the reader.</span></li>
			</ol>
			<p>If everything went well, you <a id="_idIndexMarker682"/>should see graphs<a id="_idIndexMarker683"/> that show how many parent hostel room categories are assigned to which hostel room categories and the state of those hostel <span class="No-Break">room categories.</span></p>
			<h2 id="_idParaDest-456"><a id="_idTextAnchor530"/>How it works...</h2>
			<p>The graph view is declared with a root element, <strong class="source-inline">graph</strong>. The <strong class="source-inline">type</strong> attribute on a <strong class="source-inline">graph</strong> element determines the initial mode of a graph view. The possible values are <strong class="source-inline">bar</strong>, <strong class="source-inline">line</strong>, and <strong class="source-inline">chart</strong>, but <strong class="source-inline">bar</strong> is the default. The graph view is highly interactive, so the user can switch between the different modes and also add and remove fields. If you use <strong class="source-inline">type="bar",</strong>, you can also use <strong class="source-inline">stacked="1"</strong> to show a stacked bar chart <span class="No-Break">during grouping.</span></p>
			<p>The <strong class="source-inline">field</strong> elements tell Odoo what to display on which axis. For all graph modes, you need at least one field with the <strong class="source-inline">row</strong> type and one with the <strong class="source-inline">measure</strong> type to see anything useful. Fields of the <strong class="source-inline">row</strong> type determine the grouping, while those of the <strong class="source-inline">measure</strong> type stand for the value(s) to be shown. Line graphs only support one field of each type, while charts and bars handle two group fields with one <span class="No-Break">measure nicely.</span></p>
			<p>Pivot views have their own root element, <strong class="source-inline">pivot</strong>. The pivot view supports an arbitrary amount of group and measure fields. Nothing will break if you switch to a mode that doesn’t support the number of groups and measures you defined; some fields will just be ignored, and the result might<a id="_idIndexMarker684"/> not be as interesting<a id="_idIndexMarker685"/> as it <span class="No-Break">could be.</span></p>
			<h2 id="_idParaDest-457"><a id="_idTextAnchor531"/>There’s more...</h2>
			<p>For all graph types, <strong class="source-inline">Datetime</strong> fields are tricky to group because you’ll rarely encounter the same field value here. So, if you have a <strong class="source-inline">Datetime</strong> field of the <strong class="source-inline">row</strong> type, also specify the <strong class="source-inline">interval</strong> attribute with one of the following values: <strong class="source-inline">day</strong>, <strong class="source-inline">week</strong>, <strong class="source-inline">month</strong>, <strong class="source-inline">quarter</strong>, or <strong class="source-inline">year</strong>. This will cause the grouping to take place in the <span class="No-Break">given interval.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Grouping, like sorting, relies heavily on PostgreSQL. So, the rule applies here also that a field must live in the database and in the current table in order to <span class="No-Break">be usable.</span></p>
			<p class="callout">It is a common practice to define database views that collect all the data you need and define a model on top of this view in order to have all the necessary <span class="No-Break">fields available.</span></p>
			<p class="callout">Depending on the complexity of your view and the grouping, building the graph can be quite an expensive exercise. Consider setting the <strong class="source-inline">auto_search</strong> attribute to <strong class="source-inline">False</strong> in these cases so that the user can first adjust all the parameters and only then trigger <span class="No-Break">a search.</span></p>
			<p>The pivot table also supports grouping in columns. Use the <strong class="source-inline">col</strong> type for the fields you want to <span class="No-Break">have there.</span></p>
			<h1 id="_idParaDest-458"><a id="_idTextAnchor532"/>Defining the cohort view</h1>
			<p>For the cohort <a id="_idIndexMarker686"/>analysis of records, the new cohort view was added in Odoo version 12. The cohort view is used to find out the life cycle of a record over a particular time span. With the cohort view, you can see the churn and retention rate of any object for a <span class="No-Break">particular time.</span></p>
			<h2 id="_idParaDest-459"><a id="_idTextAnchor533"/>Getting ready</h2>
			<p>The <strong class="source-inline">cohort</strong> view is part of the <strong class="bold">Odoo Enterprise edition</strong>, so you cannot use it with only the Community edition. If you are using the Enterprise edition, you need to add <strong class="source-inline">web_cohort</strong> in the manifest file of your module. For our example, we will create a view to see the cohort analysis for hostel <span class="No-Break">room category.</span></p>
			<h2 id="_idParaDest-460"><a id="_idTextAnchor534"/>How to do it...</h2>
			<p>Follow these steps<a id="_idIndexMarker687"/> to add the <strong class="source-inline">cohort</strong> view for the <span class="No-Break"><strong class="source-inline">hostel.room.category</strong></span><span class="No-Break"> model:</span></p>
			<ol>
				<li>Define a <span class="No-Break"><strong class="source-inline">cohort</strong></span><span class="No-Break"> view:</span><pre class="source-code">
&lt;record id="hostel_room_category_view_cohort" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Cohort&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;cohort date_start="date_assign" date_stop="date_end" interval="month" string="Categories Cohort" /&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Add menus and actions using this view. This is left as an exercise for <span class="No-Break">the reader.</span></li>
			</ol>
			<h2 id="_idParaDest-461"><a id="_idTextAnchor535"/>How it works...</h2>
			<p>To create a cohort view, you need to provide <strong class="source-inline">date_start</strong> and <strong class="source-inline">date_stop</strong>. These will be used in the view to determine the time span of any record. For example, if you are managing a subscription of a service, the start date of the subscription will be <strong class="source-inline">date_start</strong> and the date when the subscription is going to expire will <span class="No-Break">be </span><span class="No-Break"><strong class="source-inline">date_stop</strong></span><span class="No-Break">.</span></p>
			<p>By default, the <strong class="source-inline">cohort</strong> view will be <a id="_idIndexMarker688"/>displayed in the <strong class="source-inline">retention</strong> mode at intervals of a month. You can use the given options to obtain different behaviors in the <span class="No-Break"><strong class="source-inline">cohort</strong></span><span class="No-Break"> view:</span></p>
			<ul>
				<li><strong class="source-inline">mode</strong>: You can use cohort with two modes: <strong class="source-inline">retention (default)</strong> or <strong class="source-inline">churn</strong>. The <strong class="source-inline">retention</strong> mode starts at 100% and decreases with time, while the <strong class="source-inline">churn</strong> mode starts at 0% and increases <span class="No-Break">with time.</span></li>
				<li><strong class="source-inline">timeline</strong>: This option accepts two values: <strong class="source-inline">forward (default)</strong> or <strong class="source-inline">backward</strong>. In most cases, you need to use the forward timeline. However, if <strong class="source-inline">date_start</strong> is in the future, you will need to use the backward timeline. An example of when we would use the backward timeline would be for the registration of an event attendee where the event date is in the future, and the registration date is in <span class="No-Break">the past.</span></li>
				<li><strong class="source-inline">interval</strong>: By default, the cohort is grouped by month, but you can change this in the interval options. Other than months, the cohort also supports day, week, and <span class="No-Break">year intervals.</span></li>
				<li><strong class="source-inline">measure</strong>: Just like graph and pivot, measure is used to display the aggregated value of a given field. If no option<a id="_idIndexMarker689"/> is given, the cohort will display the count <span class="No-Break">of records.</span></li>
			</ul>
			<h1 id="_idParaDest-462"><a id="_idTextAnchor536"/>Defining the gantt view</h1>
			<p>Odoo version 13 added a new <strong class="source-inline">gantt</strong> view<a id="_idIndexMarker690"/> with new options. The <strong class="source-inline">gantt</strong> view is useful for seeing overall progress and scheduling business processes. In this recipe, we will create a new <strong class="source-inline">gantt</strong> view and look at <span class="No-Break">its options.</span></p>
			<h2 id="_idParaDest-463"><a id="_idTextAnchor537"/>Getting ready</h2>
			<p>The <strong class="source-inline">gantt</strong> view is part of the Odoo Enterprise edition, so you can’t use it with the Community edition. If you are using the Enterprise edition, you need to add the <strong class="source-inline">web_gantt</strong> dependency in the manifest file of <span class="No-Break">your module.</span></p>
			<p>In our example, we will continue using the <strong class="source-inline">my_hostel</strong> module from the previous recipe. We will create a new <strong class="source-inline">gantt</strong> view for the hostel <span class="No-Break">room category.</span></p>
			<h2 id="_idParaDest-464"><a id="_idTextAnchor538"/>How to do it...</h2>
			<ol>
				<li>Define a <strong class="source-inline">gantt</strong> view for the hostel room category model <span class="No-Break">as follows:</span><pre class="source-code">
&lt;record id="hostel_room_category_view_gantt" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Gantt&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;gantt date_start="date_assign" date_stop="date_end" string="Hostel Room Category" default_group_by="parent_id" color="parent_id"&gt;
            &lt;field name="name"/&gt;
            &lt;field name="parent_id"/&gt;
            &lt;templates&gt;
                &lt;div t-name="gantt-popover" &gt;
                    &lt;ul class="pl-1 mb-0 list-unstyled"&gt;
                        &lt;li&gt;
                            &lt;strong&gt;Name: &lt;/strong&gt;
                            &lt;t t-esc="name"/&gt;
                       &lt;/li&gt;
                       &lt;li&gt;
                            &lt;strong&gt;Parent Category: &lt;/strong&gt;
                            &lt;t t-esc="parent_id[1]"/&gt;
                       &lt;/li&gt;
                   &lt;/ul&gt;
               &lt;/div&gt;
           &lt;/templates&gt;
       &lt;/gantt&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Add menus and actions using this view. This is left as an exercise for <span class="No-Break">the reader.</span></li>
			</ol>
			<p>Install and update the module<a id="_idIndexMarker691"/> to apply the changes; after the update, you will see the <strong class="source-inline">gantt</strong> view on the hostel <span class="No-Break">room category.</span></p>
			<h2 id="_idParaDest-465"><a id="_idTextAnchor539"/>How it works...</h2>
			<p>With the <strong class="source-inline">gantt</strong> view, you can display an overall schedule on one screen. In our example, we have created a <strong class="source-inline">gantt</strong> view for the hostel room category grouped by parent. Typically, you need two attributes to create a <strong class="source-inline">gantt</strong> view, <strong class="source-inline">start_date</strong>, and <strong class="source-inline">stop_date</strong>, but there are some other attributes that extend the functionality of the <strong class="source-inline">gantt</strong> view. Let’s see all <span class="No-Break">the options:</span></p>
			<ul>
				<li><strong class="source-inline">start_date</strong>: Defines the starting time of the <strong class="source-inline">gantt</strong> item. It must be a date or <span class="No-Break">date-time field.</span></li>
				<li><strong class="source-inline">default_group_by</strong>: Use this attribute if you want to group the <strong class="source-inline">gantt</strong> items based <span class="No-Break">on field.</span></li>
				<li><strong class="source-inline">color</strong>: This attribute is used to decide the color of a <span class="No-Break"><strong class="source-inline">gantt</strong></span><span class="No-Break"> item.</span></li>
				<li><strong class="source-inline">progress</strong>: This attribute is used to indicate the progress of a <span class="No-Break"><strong class="source-inline">gantt</strong></span><span class="No-Break"> item.</span></li>
				<li><strong class="source-inline">decoration-*</strong>: Decoration attributes are used to decide the color of a gantt item based on conditions. It can be used like this: <strong class="source-inline">decoration-danger="state == 'lost'"</strong>. Its other values are <strong class="source-inline">decoration-success</strong>, <strong class="source-inline">decoration-info</strong>, <strong class="source-inline">decoration-warning</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">decoration-secondary</strong></span><span class="No-Break">.</span></li>
				<li><strong class="source-inline">scales</strong>: Use the <strong class="source-inline">scales</strong> attribute if you want to enable the <strong class="source-inline">gantt</strong> view only for a few scales. For example, if you only want day and week scales, you can <span class="No-Break">use </span><span class="No-Break"><strong class="source-inline">scales="day,week"</strong></span><span class="No-Break">.</span></li>
				<li>By default, <strong class="source-inline">gantt</strong> view items are resizable and draggable, but if you want to disable that, you can use<a id="_idIndexMarker692"/> the <span class="No-Break"><strong class="source-inline">edit="0"</strong></span><span class="No-Break"> attribute.</span></li>
			</ul>
			<h2 id="_idParaDest-466"><a id="_idTextAnchor540"/>There’s more...</h2>
			<p>When you hover over a <strong class="source-inline">gantt</strong> view item, you will see the name and date for the item. If you want to customize<a id="_idIndexMarker693"/> that popup, you can define a <strong class="bold">QWeb template</strong> in the <strong class="source-inline">gantt</strong> view definition <span class="No-Break">like this:</span></p>
			<pre class="source-code">
&lt;gantt date_start="date_assign" date_stop="date_end" string="Hostel Room Category" default_group_by="parent_id" color="parent_id"&gt;
    &lt;field name="name"/&gt;
    &lt;field name="parent_id"/&gt;
    &lt;templates&gt;
        &lt;div t-name="gantt-popover" &gt;
             &lt;ul class="pl-1 mb-0 list-unstyled"&gt;
                  &lt;li&gt;
                      &lt;strong&gt;Name: &lt;/strong&gt;
                          &lt;t t-esc="name"/&gt;
                       &lt;/li&gt;
                       &lt;li&gt;
                           &lt;strong&gt;Parent Category: &lt;/strong&gt;
                           &lt;t t-esc="parent_id[1]"/&gt;
                       &lt;/li&gt;
                   &lt;/ul&gt;
               &lt;/div&gt;
           &lt;/templates&gt;
       &lt;/gantt&gt;</pre>			<p>Note that you will need to add<a id="_idIndexMarker694"/> the fields that you want to use in the template via the <strong class="source-inline">&lt;</strong><span class="No-Break"><strong class="source-inline">field&gt;</strong></span><span class="No-Break"> tag.</span></p>
			<h1 id="_idParaDest-467"><a id="_idTextAnchor541"/>Defining the activity view</h1>
			<p>Activities are an important<a id="_idIndexMarker695"/> part of Odoo apps. They are used to schedule to-do actions for different business objects. The <strong class="source-inline">activity</strong> view helps you to see the statuses and schedules of all activities on <span class="No-Break">the model.</span></p>
			<h2 id="_idParaDest-468"><a id="_idTextAnchor542"/>Getting ready</h2>
			<p>In our example, we will continue using the <strong class="source-inline">my_hostel</strong> module from the previous recipe. We will create a new <strong class="source-inline">activity</strong> view for the hostel <span class="No-Break">room category.</span></p>
			<h2 id="_idParaDest-469"><a id="_idTextAnchor543"/>How to do it...</h2>
			<ol>
				<li>Define a <strong class="source-inline">activity</strong> view<a id="_idIndexMarker696"/> for the <strong class="source-inline">hostel room category</strong> model <span class="No-Break">as follows:</span><pre class="source-code">
&lt;record id="hostel_room_category_view_activity" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Activity&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;activity string="Hostel Room Category"&gt;
            &lt;templates&gt;
                &lt;div t-name="activity-box"&gt;
                    &lt;div&gt;
                        &lt;field name="name" display="full"/&gt;
                        &lt;field name="parent_id" muted="1" display="full"/&gt;
                   &lt;/div&gt;
               &lt;/div&gt;
           &lt;/templates&gt;
       &lt;/activity&gt;
    &lt;/field&gt;
&lt;/record&gt;</pre></li>				<li>Add menus and actions using this view. This is left as an exercise for <span class="No-Break">the reader.</span></li>
			</ol>
			<h2 id="_idParaDest-470"><a id="_idTextAnchor544"/>How it works...</h2>
			<p>The <strong class="source-inline">activity</strong> view is simplistic; most of the things are managed automatically. You just have the option to customize the first column. To display your data in the first column, you need to create a QWeb template with the name <strong class="source-inline">activity-box</strong>, and that’s it; Odoo will manage <span class="No-Break">the rest.</span></p>
			<p>The <strong class="source-inline">activity</strong> view will display<a id="_idIndexMarker697"/> your template in the first column, and other columns will show the scheduled activities grouped by <span class="No-Break">activity type.</span></p>
			<h1 id="_idParaDest-471"><a id="_idTextAnchor545"/>Defining the map view</h1>
			<p>Odoo version 13 adds<a id="_idIndexMarker698"/> a new view called a <strong class="source-inline">map</strong> view. As its name suggests, it is used to show a map with a marker. They are very useful for <span class="No-Break">on-site services.</span></p>
			<h2 id="_idParaDest-472"><a id="_idTextAnchor546"/>Getting ready</h2>
			<p>In our example, we will continue using the <strong class="source-inline">my_hostel</strong> module from the previous recipe. We will create the new <strong class="source-inline">map</strong> view for the hostel room category. The <strong class="source-inline">map</strong> view is part of the <strong class="bold">Odoo Enterprise edition</strong>, so you can’t use it with the Community edition. If you are using the Enterprise edition, you need to add the <strong class="source-inline">web_map</strong> dependency in the manifest file of <span class="No-Break">your module.</span></p>
			<p>Odoo uses the API from <a href="https://www.mapbox.com/">https://www.mapbox.com/</a> to display maps<a id="_idIndexMarker699"/> in the view. In order to see the map in Odoo, you will need to generate the access token from the <strong class="bold">mapbox</strong>. Make sure you have generated an access token and set it in the <span class="No-Break">Odoo configuration.</span></p>
			<h2 id="_idParaDest-473"><a id="_idTextAnchor547"/>How to do it…</h2>
			<ol>
				<li>Define a <strong class="source-inline">map</strong> view for the hostel<a id="_idIndexMarker700"/> room category model <span class="No-Break">as follows:</span><pre class="source-code">
&lt;record id="hostel_room_category_view_map" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Hostel Room Categories Map&lt;/field&gt;
    &lt;field name="model"&gt;hostel.room.category&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
        &lt;map&gt;
            &lt;field name="name" string="Title "/&gt;
            &lt;field name="parent_id" string="Hostel Room Category "/&gt;
        &lt;/map&gt;
    &lt;/field&gt;
ss&lt;/record&gt;</pre></li>				<li>Add menus and actions using this view. This is left as an exercise for <span class="No-Break">the reader.</span></li>
			</ol>
			<h2 id="_idParaDest-474"><a id="_idTextAnchor548"/>How it works...</h2>
			<p>Creating a map view is pretty simple; you just need a <strong class="source-inline">many2one</strong> field that refers to the <strong class="source-inline">hostel.room.category</strong> model. The <strong class="source-inline">hostel.room.category</strong> model has <strong class="source-inline">address</strong> fields, which are used by the map view to display the marker for the address. You will need to use the <strong class="source-inline">res_partner</strong> attribute to map the address for the <strong class="source-inline">map</strong> view. In our case, we have used the <strong class="source-inline">parent_id</strong> field as the hostel room category parent record<a id="_idIndexMarker701"/> set in the <span class="No-Break"><strong class="source-inline">parent_id</strong></span><span class="No-Break"> field.</span></p>
		</div>
	</body></html>