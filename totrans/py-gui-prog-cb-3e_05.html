<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Matplotlib Charts</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will create beautiful charts that visually represent data. Depending on the format of the data source, we can plot one or more columns of data in the same chart.</p>
<p>We will be using the Python <kbd>Matplotlib</kbd> module to create our charts.</p>
<p>In a company I worked for, we had an existing program that collected data for analysis. It was a manual process to load the data into Excel and then generate charts within Excel.</p>
<p>I automated the entire process using Python and <span><kbd>Matplotlib</kbd>. With only one click of the mouse, the data got backed up to a network drive and, with another click, the charts got automatically created.</span></p>
<p>In order to create these graphical charts, we need to download additional Python modules, and there are several ways to install them.</p>
<p>This chapter will explain how to download the <kbd>Matplotlib</kbd> Python module along with all the other requisite Python modules and the ways in which to do this. After we install the required modules, we will then create our own Pythonic charts.</p>
<p>Visually representing data makes our GUI very useful and great looking and greatly enhances your coding skills. It is also very useful for your management team to represent data visually.</p>
<p>Here is an overview of the Python modules for this chapter:</p>
<div class="CDPAlignCenter CDPAlign"><img class="image-border" src="Images/4d8ad072-47b8-4b60-b14a-0f730fd2fbb6.png" style="width:26.67em;height:20.08em;" width="339" height="254"/></div>
<p class="mce-root">In this chapter, we will create beautiful charts using Python 3.7 and above with the <kbd>Matplotlib</kbd> module.</p>
<div class="packt_tip"><span>The following URL,</span> <a href="http://matplotlib.org/users/screenshots.html">http://matplotlib.org/users/screenshots.html</a><span>, is a great place to begin exploring the world of</span> <kbd>Matplotlib</kbd><span>, and it teaches us how to create many charts that are not presented in this chapter.</span></div>
<p class="mce-root">We will cover the following recipes:</p>
<ul>
<li>Installing Matplotlib using pip with the .whl <span>extension</span></li>
<li>Creating our first chart</li>
<li>Placing labels on charts</li>
<li>How to give the chart a legend</li>
<li>Scaling charts</li>
<li>Adjusting the scale of charts dynamically</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Installing Matplotlib using pip with the .whl extension</h1>
                </header>
            
            <article>
                
<p>The usual way to download additional Python modules is by using <kbd>pip</kbd>. The <kbd>pip</kbd> module comes pre-installed with the latest version of Python (3.7 and above).</p>
<div class="packt_infobox">If you are using an older version of Python, you may have to download both <kbd>pip</kbd> and <kbd>setuptools</kbd> by yourself.</div>
<p>This recipe will show how to successfully install <kbd>Matplotlib</kbd> using <kbd>pip</kbd>. We will be using the <kbd>.whl</kbd> extension for this installation, so this recipe will also show you how to install the <kbd>wheel</kbd> module.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>First, let's find out whether you have the <kbd>wheel</kbd> module already installed. The <kbd>wheel</kbd> module is necessary to download and install Python packages that have the <kbd>.whl</kbd> extension.</p>
<p>We can find out what modules we have currently installed using <kbd>pip</kbd>.</p>
<p>From the Windows Command Prompt, run the <kbd>pip list</kbd> command:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/8eb31279-9941-480b-b6f8-9a00087e4fa0.png" style="width:32.67em;height:14.17em;" width="452" height="197"/></p>
<p class="CDPAlignLeft CDPAlign">If you get an error running this command, you might want to check whether Python is on your environmental path. If it currently isn't, add it to <span class="packt_screen">System variables</span> | <span class="packt_screen">Path</span> (bottom-left) by clicking the <span class="packt_screen">Edit...</span> button. Then, click the <span class="packt_screen">New</span> button (top-right) and type in the path to your Python installation. Also, add the <kbd>C:\Python37\Scripts</kbd> directory, as the <kbd>pip.exe</kbd> file is located there:</p>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full image-border" src="Images/6120db72-3fad-4835-866b-88e7b0bf6aeb.png" width="1141" height="575"/></div>
<p class="CDPAlignLeft CDPAlign">If you have more than one version of Python installed, it is a good idea to move Python 3.7 to the top of the list. When we type <kbd>pip install &lt;module&gt;</kbd>, the first version found in <em><span class="packt_screen">System variables</span></em> <span>|</span> <strong><span class="packt_screen">Path</span></strong> might be used and you might get some unexpected errors if an older version of Python is located above Python 3.7.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="CDPAlignLeft CDPAlign">Let's run <kbd>pip install wheel</kbd> and then verify whether it has been installed successfully using <kbd>pip list</kbd>:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/163c5d66-8a7f-4dad-baa7-99007b896036.png" style="width:29.67em;height:18.42em;" width="469" height="292"/></p>
<p>If running <kbd>pip list</kbd> does not show <kbd>wheel</kbd>, try to simply type <kbd>wheel</kbd> at Command Prompt. This assumes that you have set up your Python path correctly:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/dfe1f45d-3b26-4da7-ad36-375570e911ea.png" style="width:29.58em;height:17.42em;" width="477" height="281"/></p>
<div class="packt_tip">If you are really very used to Python 2.7 and insist on running the code in Python 2.7, you can try this trick. After everything is working with Python 3.7, you can rename the 3.7 <kbd>python.exe</kbd> to <kbd>python3.exe</kbd> and then have fun using both 2.7 and 3.7 by typing <kbd>python.exe</kbd> or <kbd>python3.exe</kbd> in a command window to run the different Python executables. It is a hack.<br/>
If you really wish to go on this road, you are on your own, but it can work.</div>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>With the <kbd>wheel</kbd> module installed, we can now proceed with downloading and installing <kbd>Matplotlib</kbd> from <a href="http://www.lfd.uci.edu/~gohlke/pythonlibs/">http://www.lfd.uci.edu/~gohlke/pythonlibs/</a>.</p>
<ol>
<li>Download the matching <kbd><span>Matplotlib</span></kbd> wheel to your hard drive:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img class="aligncenter size-full image-border" src="Images/7b2c4d90-4e51-4238-a326-46e00a7c5891.png" width="387" height="476"/></div>
<ol start="2">
<li>Open C<span>ommand Prompt and run</span> <kbd>pip install &lt;matplotlib wheel&gt;</kbd> as shown:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/5cbe9be6-80b7-48e5-9815-18eb2e71c0da.png" style="width:86.17em;height:45.83em;" width="980" height="522"/></div>
<ol start="3">
<li>If you run into the preceding error, download Microsoft Visual C++ Build Tools and install them from <a href="https://visualstudio.microsoft.com/visual-cpp-build-tools/">https://visualstudio.microsoft.com/visual-cpp-build-tools/</a><span>:</span></li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class="aligncenter size-full image-border" src="Images/74119fb3-5c2c-4c19-a019-b1944f695208.png" style="width:35.83em;height:19.33em;" width="1130" height="610"/></div>
<p style="padding-left: 60px" class="packt_figure">Starting the installation of <span>Microsoft</span> Visual C++ Build Tools appears as follows:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/1be50d1a-40bb-408e-9fd2-02a255f87ae5.png" style="width:24.58em;height:21.25em;" width="455" height="393"/></div>
<ol start="4">
<li>If you ran into the preceding error, rerun the <kbd>Matplotlib</kbd> installation using <kbd>pip install</kbd>:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign">
<p><img src="Images/d60c3915-f840-4017-ab62-bab9c3335abf.png" width="1226" height="336"/></p>
</div>
<ol start="5">
<li>Verify successful installation by looking into the <kbd>site-packages</kbd> folder:</li>
</ol>
<div class="packt_figure CDPAlignCenter CDPAlign"><img class="aligncenter size-full image-border" src="Images/cf04f852-0cce-4b0a-a4f6-b444507a5279.png" width="265" height="97"/></div>
<p class="mce-root"/>
<p class="packt_figure CDPAlignLeft CDPAlign"><span>Let's now go behind the scenes to understand the installation better.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p><span>After downloading the wheel installer, we can now use</span> <kbd>pip</kbd> <span>to install the <kbd>Matplotlib</kbd> wheel.</span></p>
<p>In <em>Step 1</em>, make sure you download and install the <kbd>Matplotlib</kbd> version that matches the Python version you are using. For example, download and install <kbd>matplotlib-3.1.0-cp37-cp37m-win_amd64.whl</kbd> if you have Python 3.7 installed on a 64-bit OS, such as Microsoft Windows 10.</p>
<div class="packt_infobox"><kbd>amd64</kbd> in the middle of the executable name means you are installing the 64-bit version. If you are using a 32-bit x86 system, then installing <kbd>amd64</kbd> will not work. Similar problems can occur if you have installed a 32-bit version of Python and download 64-bit Python modules.</div>
<p class="packt_figure">Depending upon what you have already installed on your system, running the <kbd>pip install matplotlib-3.1.0-cp37-cp37m-win_amd64.whl</kbd> <span>command</span> might start fine, but then it might not run to completion. Refer to the preceding screenshot during <em>Step 2</em> of what might happen during the installation. <span>The installation ran into an error. The way to resolve this is to download and install</span> <strong>Microsoft Visual C++ Build Tools</strong><span>, and we do this in <em>Step 3</em> from the website that is mentioned in the error for <em>Step 2</em> (</span><a href="https://visualstudio.microsoft.com/visual-cpp-build-tools/">https://visualstudio.microsoft.com/visual-cpp-build-tools/</a><span>).</span></p>
<div class="packt_tip"><span>If you run into any issues installing Microsoft Visual C++ Build Tools, here is a helpful answer from Stack Overflow:</span> <a href="https://stackoverflow.com/a/54136652">https://stackoverflow.com/a/54136652</a><span>. And here is a link to MS:</span> <a href="https://devblogs.microsoft.com/cppblog/announcing-visual-c-build-tools-2015-standalone-c-tools-for-build-environments/">https://devblogs.microsoft.com/cppblog/announcing-visual-c-build-tools-2015-standalone-c-tools-for-build-environments/</a>.</div>
<p><span>After we have successfully installed the build tools, we can now rerun our</span> <kbd>Matplotlib</kbd> <span>installation to completion in <em>Step 4</em>. Just type in the same</span> <kbd>pip install</kbd> <span>command we have used previously in <em>Step 2</em>.</span></p>
<p><span>We can verify that we have successfully installed</span> <kbd>Matplotlib</kbd> <span>by looking at our Python installation directory, which we do in <em>Step 5</em>. After successful installation, the</span> <kbd>Matplotlib</kbd> <span>folder is added to</span> <kbd>site-packages</kbd><span>. Depending upon where we installed Python, the full path to the <kbd>site-packages</kbd> folder on Windows can be</span> <kbd><span>..\Python37\Lib\site-packages</span></kbd><span>.</span></p>
<p class="mce-root"/>
<p><span>If you see the</span> <kbd>matplotlib</kbd> <span>folder added to the</span> <kbd>site-packages</kbd> <span>folder in your Python installation, then you have successfully installed</span> <kbd>Matplotlib</kbd><span>.</span></p>
<div class="packt_tip">Installing Python modules using <kbd>pip</kbd> is usually very easy, although you might run into some unexpected troubles. Follow the preceding steps and your installation will succeed.</div>
<p><span>Let's move on to the next recipe.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Creating our first chart</h1>
                </header>
            
            <article>
                
<p>Now that we have all the required Python modules installed, we can create our own charts using <kbd>Matplotlib</kbd>.</p>
<p>We can create charts with only a few lines of Python code.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>Successfully installing <kbd>Matplotlib</kbd>, as shown in the previous recipe, is a requirement for this recipe.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>Using the minimum amount of code, we can create our first <kbd><span>Matplotlib</span></kbd> chart.</p>
<p>For the first chart, the steps are as follows:</p>
<ol>
<li>Create a new Python module and save it as <kbd>Matplotlib_our_first_chart.py</kbd><span>.</span></li>
<li>Type the following code into the module:</li>
</ol>
<pre style="padding-left: 60px">import matplotlib.pyplot as plt<br/>from pylab import show<br/><br/>x_values = [1,2,3,4] <br/>y_values = [5,7,6,8] <br/>plt.plot(x_values, y_values)<br/>show()</pre>
<ol start="3">
<li>Run the code to see the following chart:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/58189be7-be8e-4607-9da4-0d39f0f08481.png" style="width:33.42em;height:28.42em;" width="638" height="543"/></div>
<p class="packt_figure CDPAlignLeft CDPAlign"><span>Let's now go behind the scenes to understand the code better.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p><span>First, we are importing <kbd>matplotlib.pyplot</kbd> and we alias it as <kbd>plt</kbd>. We then create two lists for our <em>x</em> and <em>y</em> values. We then pass the two lists into the <kbd>plt</kbd> or <kbd>plot</kbd> function.</span></p>
<p>We also import <kbd>show</kbd> from <kbd>pylab</kbd> and call it to display our chart.</p>
<p>Notice how this automatically creates a GUI for us that even comes with a number of buttons.</p>
<div class="packt_tip">Play around with the buttons in the bottom-left corner because they are fully functional.</div>
<p>Also notice how the <em>x</em> and <em>y</em> axes scale automatically to display the data range of our <em>x</em> and <em>y</em> values.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">There's more…</h1>
                </header>
            
            <article>
                
<p>The Python <kbd>Matplotlib</kbd> module, combined with add-ons such as <kbd>numpy</kbd>, creates a very rich programming environment that enables us to perform mathematical computations and plot them in visual charts with ease.</p>
<p><span>Now, let's move on to the next recipe.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Placing labels on charts</h1>
                </header>
            
            <article>
                
<p>So far, we have used the default <kbd>Matplotlib</kbd> GUI. Now, we will create some <kbd>tkinter</kbd> GUIs from which we will be using <kbd>Matplotlib</kbd>.</p>
<p>This will require a few more lines of Python code and the importing of some more libraries, and it is well worth the effort, because we are gaining control of our paintings using canvases.</p>
<p>We will position labels onto both the horizontal and the vertical axes, that is, <em>x</em> and <em>y</em>. We will do this by creating a <kbd>Matplotlib</kbd> figure that we will draw on.</p>
<p>You will also learn how to use subplots, which will enable you to draw more than one graph in the same GUI window.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>With the necessary Python modules installed and knowing where to find the official online documentation and tutorials, we can now carry on with our creation of <kbd>Matplotlib</kbd> charts.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it...</h1>
                </header>
            
            <article>
                
<p>While <kbd>plot</kbd> is the easiest way to create a <kbd>Matplotlib</kbd> chart, using <kbd>Figure</kbd> in combination with <kbd>Canvas</kbd> creates a more custom-made graph, which looks much better and also enables us to add buttons and other widgets to it:</p>
<ol>
<li><span>Create a new Python module and save it as</span> <kbd>Matplotlib_labels.py</kbd>.</li>
<li>Type the following code into the module:</li>
</ol>
<pre style="padding-left: 60px">from matplotlib.figure import Figure <br/>from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg <br/>import tkinter as tk <br/>#-------------------------------------------------------------- <br/>fig = Figure(figsize=(12, 8), facecolor='white') <br/>#-------------------------------------------------------------- <br/># axis = fig.add_subplot(111) # 1 row, 1 column, only graph   #&lt;-- uncomment<br/>axis = fig.add_subplot(211) # 2 rows, 1 column, Top graph <br/>#-------------------------------------------------------------- </pre>
<ol start="3">
<li>Add the following code under the preceding code:</li>
</ol>
<pre style="padding-left: 60px">xValues = [1,2,3,4] <br/>yValues = [5,7,6,8] <br/>axis.plot(xValues, yValues) <br/>axis.set_xlabel('Horizontal Label') <br/>axis.set_ylabel('Vertical Label') <br/># axis.grid()                                 # default line style<br/>axis.grid(linestyle='-')                      # solid grid lines </pre>
<ol start="4">
<li>Next, add the following code under the preceding code:</li>
</ol>
<pre style="padding-left: 60px">#-------------------------------------------------------------- <br/>def _destroyWindow(): <br/>    root.quit() <br/>    root.destroy() <br/>#-------------------------------------------------------------- <br/>root = tk.Tk() <br/>root.protocol('WM_DELETE_WINDOW', _destroyWindow) <br/>#-------------------------------------------------------------- </pre>
<ol start="5">
<li>Now, add the following code under the preceding code:</li>
</ol>
<pre style="padding-left: 60px">canvas = FigureCanvasTkAgg(fig, master=root) <br/>canvas._tkcanvas.pack(side=tk.TOP, fill=tk.BOTH, expand=1) <br/>#-------------------------------------------------------------- <br/>root.mainloop()</pre>
<ol start="6">
<li>Running the preceding code results in the following chart:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/dd630210-d864-4899-bb09-5b6cbe13c628.png" width="921" height="233"/></div>
<p>Now, let's deal with a new module:</p>
<ol>
<li>Create a new module and save it as <kbd>Matplotlib_labels_four.py</kbd><span>.</span></li>
<li>Type the following new code into the module:</li>
</ol>
<pre style="padding-left: 60px"># imports and figure are the same as in the previous code<br/>#-------------------------------------------------------------- <br/>axis1 = fig.add_subplot(221)<br/>axis2 = fig.add_subplot(222, sharex=axis1, sharey=axis1)<br/>axis3 = fig.add_subplot(223, sharex=axis1, sharey=axis1)<br/>axis4 = fig.add_subplot(224, sharex=axis1, sharey=axis1)<br/>#-------------------------------------------------------------- <br/>axis1.plot(xValues, yValues) <br/>axis1.set_xlabel('Horizontal Label 1') <br/>axis1.set_ylabel('Vertical Label 1') <br/>axis1.grid(linestyle='-') # solid grid lines <br/>#-------------------------------------------------------------- <br/>axis2.plot(xValues, yValues) <br/>axis2.set_xlabel('Horizontal Label 2') <br/>axis2.set_ylabel('Vertical Label 2') <br/>axis2.grid(linestyle='-') # solid grid lines <br/>#-------------------------------------------------------------- <br/>axis3.plot(xValues, yValues) <br/>axis3.set_xlabel('Horizontal Label3') <br/>axis3.set_ylabel('Vertical Label 3') <br/>axis3.grid(linestyle='-') # solid grid lines <br/>#-------------------------------------------------------------- <br/>axis4.plot(xValues, yValues) <br/>axis4.set_xlabel('Horizontal Label 4') <br/>axis4.set_ylabel('Vertical Label 4') <br/>axis4.grid(linestyle='-') # solid grid lines <br/>#-------------------------------------------------------------- <br/># root and canvas are the same as in the previous code</pre>
<ol start="3">
<li>Running the code results in the following chart being created:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/ef5965cf-9ea4-4534-9d9d-00d9661cfce9.png" style="width:58.33em;height:39.75em;" width="813" height="555"/></div>
<p>We can add more subplots by assigning them to the second position using <kbd>add_subplot(212)</kbd>:</p>
<ol>
<li>Create a new module and save it as <kbd><span>Matplotlib_labels_two_charts.py</span></kbd>.</li>
<li>Type the following code into the module:</li>
</ol>
<pre style="padding-left: 60px"># imports and figure are the same as in the previous code<br/>#--------------------------------------------------------------<br/>    #-------------------------------------------------------------- <br/>    axis = fig.add_subplot(211) # 2 rows, 1 column, Top graph <br/>    #-------------------------------------------------------------- <br/>    xValues = [1,2,3,4] <br/>    yValues = [5,7,6,8] <br/>    axis.plot(xValues, yValues) <br/>    axis.set_xlabel('Horizontal Label') <br/>    axis.set_ylabel('Vertical Label') <br/>    axis.grid(linestyle='-')     # solid grid lines <br/>    #-------------------------------------------------------------- <br/>    axis1 = fig.add_subplot(212) # 2 rows, 1 column, Bottom graph <br/>    #-------------------------------------------------------------- <br/>    xValues1 = [1,2,3,4] <br/>    yValues1 = [7,5,8,6] <br/>    axis1.plot(xValues1, yValues1) <br/>    axis1.grid()                 # default line style  <br/>    #-------------------------------------------------------------- <br/>#-------------------------------------------------------------- <br/># root and canvas are the same as in the previous code</pre>
<ol start="3">
<li class="CDPAlignLeft CDPAlign">Run the code to see the following chart:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/856d6f6a-1406-4cb7-bf67-4ef317088f08.png" width="842" height="492"/></div>
<p class="CDPAlignLeft CDPAlign"><span>Let's now go behind the scenes to understand the code better.</span></p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p>In the first line of code in <kbd><span>Matplotlib_labels.py</span></kbd>, <span>in <em>Step 2</em>,</span> after the import statements, we create an instance of a <kbd>Figure</kbd> object.</p>
<div class="packt_tip">Here is a link to the official documentation: <a href="https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure.add_subplot">https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure.add_subplot</a>.</div>
<p>Next, we add subplots to this figure by calling <kbd>add_subplot(211)</kbd>.</p>
<div class="packt_infobox">The first number in <kbd>211</kbd> tells the figure <em>how many plots</em> to add, the second number determines <em>the number of columns</em>, and the third tells the figure <em>the order in which to display</em> the plots.</div>
<p>In <em>Step 3</em>, we create values, plot them, and w<span>e also add a grid and change its default line style.</span></p>
<p><span>Even though we only display one plot in the chart, by choosing</span> <kbd>2</kbd> <span>for the number of subplots, we are moving the plot up, which results in extra white space at the bottom of the chart. This first plot now only occupies 50% of the screen, which affects how large the grid lines of this plot are when being displayed.</span></p>
<div class="packt_tip"><span>Experiment with the code by uncommenting the code for</span> <kbd>axis =</kbd> <span>and</span> <kbd>axis.grid()</kbd> <span>to see the different effects. You also have to comment out the original line below each of them.</span></div>
<p>In <em>Step 4</em>, we create a callback function that correctly exits the <kbd>tkinter</kbd> GUI when the red <span class="packt_screen">X</span> button gets clicked. We create an instance of <kbd>tkinter</kbd> and assign the callback to the <kbd>root</kbd> variable.</p>
<p>In <em>Step 5</em>, we create a canvas and use the <kbd>pack</kbd> geometry manager and, after that, we start the main windows GUI event loop.</p>
<p>Running the entire code in S<em>tep 6</em> then creates the chart.</p>
<p>We can place more than one chart onto the same canvas. In <span><kbd>Matplotlib_labels_four.py</kbd>, most of the code is the same as in <kbd>Matplotlib_labels.py</kbd>. We are creating four axes and positioning them in two rows.</span></p>
<div class="packt_infobox"><span>The important thing to observe is that we create one axis, which is then used as the shared</span> <em>x</em> <span>and</span> <em>y</em> <span>axes for the other graphs within the chart. In this way, we can achieve a database-like layout of the chart.</span></div>
<p>In <span><kbd>Matplotlib_labels_two_charts.py</kbd>, running the code now adds <kbd>axis1</kbd> to the chart. For the grid of the bottom plot, we left the line style at its default. The main difference compared with the previous charts is that we assigned the second chart to the second position using <kbd>add_subplot(212).</kbd></span></p>
<p>This means: 2 rows, 1 column, position 2 for this chart, which places it in the second row as there is only one column.</p>
<p><span>Now, let's move on to the next recipe.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to give the chart a legend</h1>
                </header>
            
            <article>
                
<p>Once we start plotting more than one line of data points, things might become a little bit unclear. By adding a legend to our graphs, we can identify data, and tell what it actually means.</p>
<div class="packt_infobox">We do not have to choose different colors to represent the different data. <kbd>Matplotlib</kbd> automatically assigns a different color to each line of the data points.</div>
<p>All we have to do is create the chart and add a legend to it.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will enhance the chart from the previous recipe, <em>Placing labels on charts</em>. We will only plot one chart.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>First, we will plot more lines of data on the same chart, and then we will add a legend to the chart.</p>
<ol>
<li>Create a new module and save it as <kbd><span>Matplotlib_chart_with_legend.py</span></kbd><span>.</span></li>
<li>Type the following code into the module:</li>
</ol>
<pre style="padding-left: 60px">from matplotlib.figure import Figure <br/>from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg <br/>import tkinter as tk <br/>#-------------------------------------------------------------- <br/>fig = Figure(figsize=(12, 5), facecolor='white') <br/>#-------------------------------------------------------------- </pre>
<ol start="3">
<li class="CDPAlignLeft CDPAlign">Add the following code under the preceding code:</li>
</ol>
<pre style="padding-left: 60px">axis = fig.add_subplot(111) # 1 row, 1 column  <br/><br/>xValues = [1,2,3,4] <br/>yValues0 = [6,7.5,8,7.5] <br/>yValues1 = [5.5,6.5,8,6] <br/>yValues2 = [6.5,7,8,7] <br/><br/>t0, = axis.plot(xValues, yValues0) <br/>t1, = axis.plot(xValues, yValues1) <br/>t2, = axis.plot(xValues, yValues2) <br/><br/>axis.set_ylabel('Vertical Label') <br/>axis.set_xlabel('Horizontal Label') <br/>axis.grid() <br/><br/>fig.legend((t0, t1, t2), ('First line', 'Second line', 'Third <br/> line'), 'upper right') <br/>#-------------------------------------------------------------- </pre>
<ol start="4">
<li>Next, add the following code under the preceding code:</li>
</ol>
<pre style="padding-left: 60px">def _destroyWindow(): <br/>    root.quit() <br/>    root.destroy() <br/>#-------------------------------------------------------------- <br/>root = tk.Tk() <br/>root.protocol('WM_DELETE_WINDOW', _destroyWindow) <br/>#-------------------------------------------------------------- <br/>canvas = FigureCanvasTkAgg(fig, master=root) <br/>canvas._tkcanvas.pack(side=tk.TOP, fill=tk.BOTH, expand=1) <br/>#-------------------------------------------------------------- <br/>root.mainloop()</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<ol start="5">
<li class="CDPAlignLeft CDPAlign">Running the code creates the following chart, which has a legend in the upper-right corner:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/af0808b8-0a4f-49ce-8650-be346694ba03.png" width="931" height="429"/></div>
<p>Next, we change the default colors of the lines in the legend.</p>
<ol>
<li>Open <kbd>Matplotlib_chart_with_legend.py</kbd> and save it as <kbd>Matplotlib_chart_with_legend_colors.py</kbd>.</li>
<li>Add the following colors to each plot:</li>
</ol>
<pre style="padding-left: 60px">t0, = axis.plot(xValues, yValues0, color = 'purple') <br/>t1, = axis.plot(xValues, yValues1, color = 'red') <br/>t2, = axis.plot(xValues, yValues2, color = 'blue')</pre>
<ol start="3">
<li>Run the modified code and observe the different colors:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/5e1e7a77-b045-4f1d-834f-af33e7352622.png" width="1188" height="527"/></p>
<p class="mce-root"/>
<p>Now, let's have a closer look at the correct syntax when assigning the plots to variables.</p>
<ol>
<li>Open <kbd>Matplotlib_chart_with_legend.py</kbd> and save it as <kbd>Matplotlib_chart_with_legend_missing_comma.py</kbd>.</li>
<li>Remove the comma after <kbd>t0</kbd>.</li>
<li>Run the code.</li>
<li>Notice how <kbd>First line</kbd> no longer appears in the top-right legend:</li>
</ol>
<div class="packt_figure CDPAlignCenter"><img class="aligncenter size-full image-border" src="Images/e0228643-47c9-444e-a23b-d394c6468a2b.png" style="width:42.42em;height:21.33em;" width="885" height="446"/></div>
<p><span>Let's now go behind the scenes to understand the code better.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p>In <span><kbd>Matplotlib_chart_with_legend.py</kbd>, w</span>e are only plotting one graph in this recipe.</p>
<p><span>For <em>Step 2</em>, refer to the explanation from the previous recipe,</span> <em>Placing labels on charts,</em> as the code is the same except that we are <span>slightly modifying the size of the figure via the</span> <kbd>figsize</kbd> <span>attribute</span>.</p>
<p><span>In <em>Step 3</em>, we change</span> <kbd>fig.add_subplot(111)</kbd> <span>to use <kbd>111</kbd>.</span> Next, we create three Python lists that contain the values to be plotted. When we plot the data, we save the references to the plots in local variables.</p>
<p>We create the legend by passing it in a tuple with the references to the three plots, and then pass it in another tuple that contains the strings that are then displayed in the legend, and, in the third argument, we position the legend within the chart.</p>
<p><span>For <em>Step</em></span> <span><em>4</em>, refer to the explanation from the previous recipe,</span> <em>Placing labels on charts,</em> <span>as the code is th</span><span>e same</span><em>.</em></p>
<div class="packt_tip">You can find the official documentation for the <kbd>tkinter</kbd> protocol at this link: <a href="https://www.tcl.tk/man/tcl8.4/TkCmd/wm.htm#M39">https://www.tcl.tk/man/tcl8.4/TkCmd/wm.htm#M39</a>.</div>
<p>In <em>Step 5</em>, when running the code, we can see that our chart now has a legend for each of the three lines of data.</p>
<p>The default settings of <kbd>Matplotlib</kbd> assign a color scheme to the lines being plotted. In <span><kbd>Matplotlib_chart_with_legend_colors.py</kbd>, w</span><span>e can easily change this default setting of colors to the colors we prefer by setting an</span> <span>attribute</span> <span>when we plot each axis.</span></p>
<p>We do this in <em>Step 2</em> by using the <kbd>color</kbd> attribute and assigning it an available color value. Running the code in <em>Step 3</em> now shows different colors than the default colors.</p>
<p>In <span><kbd>Matplotlib_chart_with_legend_missing_comma.py</kbd>, we intentionally remove the comma after <kbd>t0</kbd> to see what effect this has.</span></p>
<div class="packt_infobox">Note that the comma after the variable assignments of <kbd>t0</kbd>, <kbd>t1</kbd>, and <kbd>t2</kbd> is not a mistake. It is required in order to create the legend.</div>
<p>The comma after each variable <strong>unpacks</strong> the list value into the variable. This value is a <kbd>Line2D</kbd> object of <kbd><span>Matplotlib</span></kbd>. If we leave the comma out, our legend will not be displayed because the <kbd>Line2D</kbd> object is embedded in a list and we have to unpack it out of the list.</p>
<div class="packt_infobox">When we remove the comma after the <kbd>t0</kbd> assignment, we get an error, and the first line no longer appears in the figure. The chart and legend still get created, but without the first line appearing in the legend.</div>
<p>Let's move on to the next recipe.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Scaling charts</h1>
                </header>
            
            <article>
                
<p>In the previous recipes, while creating our first charts and enhancing them, we hardcoded the scaling of how those values are visually represented.</p>
<p>While this served us well for the values we were using, we might have to plot charts from large databases.</p>
<p>Depending on the range of that data, our hardcoded values for the vertical <em>y</em>-dimension might not always be the best solution, and may make it hard to see the lines in our charts.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>We will improve our code from the previous recipe, <em>How to give the chart a legend</em>. If you have not typed in all of the code from the previous recipes, just download the code for this chapter from the Packt website, and it will get you started (and then you can have a lot of fun creating GUIs, charts, and so on using Python).</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>We will modify the <kbd>yValues1</kbd> line of code from the previous recipe to use <kbd>50</kbd> as the third value:</p>
<ol>
<li>Open <kbd>Matplotlib_chart_with_legend.py</kbd> and save it as <kbd><span>Matplotlib_labels_two_charts_not_scaled.py</span></kbd>.</li>
</ol>
<ol start="2">
<li>Change the third value in the list of <kbd>yValues1</kbd> to <kbd>50</kbd>:</li>
</ol>
<pre style="padding-left: 60px">axis  = fig.add_subplot(111)        # 1 row, 1 column <br/>xValues  = [1,2,3,4] <br/>yValues0 = [6,7.5,8,7.5] <br/>yValues1 = [5.5,6.5,50,6]           # one very high value (50)<br/>yValues2 = [6.5,7,8,7]</pre>
<ol start="3">
<li>Run the code to see the following chart:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/6e69cde2-2fad-4bc4-81d6-18ff14e04dc6.png" width="912" height="401"/></div>
<ol>
<li>Open <kbd><span>Matplotlib_labels_two_charts_not_scaled.py</span></kbd> and save it as <kbd>Matplotlib_labels_two_charts_scaled.py</kbd><span>.</span></li>
<li>Add <span><kbd>axis.set_ylim(5, 8)</kbd> under the value code:</span></li>
</ol>
<pre style="padding-left: 60px">yValues0 = [6,7.5,8,7.5] <br/>yValues1 = [5.5,6.5,50,6]           # one very high value (50) <br/>yValues2 = [6.5,7,8,7] <br/><br/>axis.set_ylim(5, 8)                 # limit the vertical display</pre>
<ol start="3">
<li>After running the code, the following chart appears:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/f32d6e68-8f4b-4aed-802d-6f37c6329d73.png" style="width:40.33em;height:18.50em;" width="884" height="405"/></div>
<p><span>Let's now go behind the scenes to understand the code better.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p>In <span><kbd>Matplotlib_labels_two_charts_not_scaled.py</kbd>, t</span>he only difference to the code that created the chart in the previous recipe is a single data value.</p>
<p>By changing one value that is not close to the average range of all the other values for all plotted lines, the visual representation of the data has dramatically changed. We lost a lot of detail regarding the overall data, and we now mainly see one high spike.</p>
<p>So far, our charts have adjusted themselves according to the data they visually represent.</p>
<p>While this is a practical feature of <kbd>Matplotlib</kbd>, this is not always what we want. We can restrict the scale of the chart being represented by limiting the vertical <em>y</em>-dimension.</p>
<p>In <span><kbd>Matplotlib_labels_two_charts_scaled.py</kbd>, t</span>he <kbd>axis.set_ylim(5, 8)</kbd> line of code now limits the start value to <kbd>5</kbd> and the end value of the vertical display to <kbd>8</kbd>.</p>
<p>Now, when we create our chart, the high value peak no longer has the impact it had before.</p>
<p>We increased one value in the data, which resulted in a dramatic effect. By setting limits to the vertical and horizontal displays of the chart, we can see the data we are most interested in.</p>
<p>Spikes, like the ones just shown, can be of great interest too. It all depends on what we are looking for. The visual representation of the data is of great value.</p>
<div class="packt_infobox">A picture is worth a thousand words.</div>
<p><span>Now, let's move on to the next recipe.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Adjusting the scale of charts dynamically</h1>
                </header>
            
            <article>
                
<p>In the previous recipe, we learned how we can limit the scaling of our charts. In this recipe, we will go one step further by dynamically adjusting the scaling by both setting a limit and analyzing our data before we represent it.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>We will enhance the code from the previous recipe, <em>Scaling charts</em>, by reading in the data we are plotting dynamically, averaging it, and then adjusting our chart.</p>
<p>While we would typically read in the data from an external source, in this recipe, we'll create the data we are plotting using Python lists, as can be seen in the code in the following section.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>We are creating our own data in our Python module by assigning lists with data to the <kbd>xValues</kbd> and <kbd>yValues</kbd> variables. Let's now modify the code to set limits on both the <em>x</em> and <em>y</em> dimensions.</p>
<ol>
<li>Open <kbd><span>Matplotlib_labels_two_charts_scaled.py</span></kbd> and save it as <kbd><span>Matplotlib_labels_two_charts_scaled_dynamic_spike.py</span></kbd>.</li>
<li>Add/adjust the <kbd>set_ylim</kbd> and <kbd>set_xlim</kbd> code as follows:</li>
</ol>
<pre style="padding-left: 60px">xValues  = [1,2,3,4] <br/><br/>yValues0 = [6,7.5,8,7.5] <br/>yValues1 = [5.5,6.5,50,6]           # one very high value (50) <br/>yValues2 = [6.5,7,8,7]               <br/><br/>axis.set_ylim(0, 8)                 # lower limit (0) <br/>axis.set_xlim(0, 8)                 # use same limits for x</pre>
<ol start="3">
<li>When we run the modified code, we get the following result:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/ab29f9a2-dc7e-4407-b769-d942dfbe5a2f.png" style="width:42.42em;height:19.75em;" width="853" height="398"/></div>
<p>Modify the code as follows:</p>
<ol>
<li>Open <kbd><span>Matplotlib_labels_two_charts_scaled_dynamic_spike.py</span></kbd> and save it as <kbd>Matplotlib_labels_two_charts_scaled_dynamic.py</kbd>.</li>
<li>Insert the following new code starting with <kbd>yAll</kbd>:</li>
</ol>
<pre style="padding-left: 60px">xValues  = [1,2,3,4] <br/><br/>yValues0 = [6,7.5,8,7.5] <br/>yValues1 = [5.5,6.5,50,6]              # one very high value (50) <br/>yValues2 = [6.5,7,8,7]               <br/>yAll = [yValues0, yValues1, yValues2]  # list of lists <br/><br/># flatten list of lists retrieving minimum value <br/>minY = min([y for yValues in yAll for y in yValues]) <br/><br/>yUpperLimit = 20 <br/># flatten list of lists retrieving max value within defined limit <br/>maxY = max([y for yValues in yAll for y in yValues if y &lt; <br/>yUpperLimit]) <br/><br/># dynamic limits <br/>axis.set_ylim(minY, maxY)                  <br/>axis.set_xlim(min(xValues), max(xValues))                 <br/><br/>t0, = axis.plot(xValues, yValues0) <br/>t1, = axis.plot(xValues, yValues1) <br/>t2, = axis.plot(xValues, yValues2)</pre>
<ol start="3">
<li>Running the code results in the following chart:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/a866a99a-8574-4a85-983b-7ba1da5f6a9e.png" width="910" height="422"/></div>
<p><span>Let's now go behind the scenes to understand the code better.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p><span>In many graphs, the beginning of the</span> <em>x</em> <span>and</span> <em>y</em> <span>coordinate system starts at (0, 0). This is usually a good idea, so we adjusted our chart coordinate code accordingly. In <kbd>Matplotlib_labels_two_charts_scaled_dynamic_spike.py</kbd>, we have set the same limits for <em>x</em> and <em>y</em>, hoping that our chart might look more balanced. Looking at the result, this is not the case.</span></p>
<div class="packt_tip">Maybe starting at (0, 0) was not such a great idea after all.</div>
<p>What we really want to do is to adjust our chart dynamically according to the range of the data, while, at the same time, restricting the values that are too high or too low.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>We can do this by parsing all the data to be represented in the chart while, at the same time, setting some explicit limits. In <span><kbd>Matplotlib_labels_two_charts_scaled_dynamic.py</kbd>, w</span><span>e adjusted both its</span> <em>x</em> <span>and</span> <em>y</em> <span>dimensions dynamically. Note how the</span> <em>y</em><span>-dimension starts at</span> <span class="packt_screen">5.5</span><span>. The chart also no longer starts at <strong>(0, 0)</strong>, giving us more valuable information about our data.</span></p>
<p>We are creating a list of lists for the <em>y</em>-dimension data and then using a list comprehension wrapped into a call to Python's <kbd>min()</kbd> and <kbd>max()</kbd> functions.</p>
<div class="packt_tip">If list comprehensions seem to be a little bit advanced, what they basically are is a very compressed loop. They are also designed to be faster than a regular programming loop.</div>
<p>In the Python code, we created three lists that hold the <em>y</em>-dimensional data to be plotted. We then created another list that holds those three lists, which creates a list of lists, as follows:</p>
<pre>yValues0 = [6,7.5,8,7.5] <br/>yValues1 = [5.5,6.5,50,6]              # one very high value (50) <br/>yValues2 = [6.5,7,8,7]               <br/>yAll = [yValues0, yValues1, yValues2]  # list of lists</pre>
<p>We are interested in getting both the minimum value of all of the <em>y</em>-dimensional data as well as the maximum value contained within these three lists.</p>
<p>We can do this via a Python list comprehension:</p>
<pre># flatten list of lists retrieving minimum value <br/>minY = min([y for yValues in yAll for y in yValues])</pre>
<p>After running the list comprehension, <kbd>minY</kbd> is <kbd>5.5</kbd>.</p>
<p>The preceding line of code is the list comprehension that runs through all the values of all the data contained within the three lists and finds the minimum value using the Python <kbd>min</kbd> keyword.</p>
<p>In the very same pattern, we find the maximum value contained in the data we wish to plot. This time, we'll also set a limit within our list comprehension, which ignores all the values that exceed the limit we specified, as follows:</p>
<pre>yUpperLimit = 20 <br/># flatten list of lists retrieving max value within defined limit <br/>maxY = max([y for yValues in yAll for y in yValues if y &lt; <br/>yUpperLimit])</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p>After running the preceding code with our chosen restriction, <kbd>maxY</kbd> has the value of <kbd>8</kbd> (not 50).</p>
<p>We applied a restriction to the max value, according to a predefined condition, choosing <kbd>20</kbd> as the maximum value to be displayed in the chart.</p>
<p>For the <em>x</em>-dimension, we simply called <kbd>min()</kbd> and <kbd>max()</kbd> in the <kbd>Matplotlib</kbd> method to scale the limits of the chart dynamically.</p>
<p>In this recipe, we have created several <kbd>Matplotlib</kbd> charts and adjusted some of the many available attributes. We also used core Python to control the scaling of the charts dynamically.</p>


            </article>

            
        </section>
    </div>



  </body></html>