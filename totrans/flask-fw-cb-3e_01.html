<html><head></head><body>
<div id="_idContainer008">
<h1 class="chapter-number" id="_idParaDest-17"><a id="_idTextAnchor016"/><a id="_idTextAnchor017"/><span class="koboSpan" id="kobo.1.1">1</span></h1>
<h1 id="_idParaDest-18"><a id="_idTextAnchor018"/><span class="koboSpan" id="kobo.2.1">Flask Configurations</span></h1>
<p><span class="koboSpan" id="kobo.3.1">This introductory chapter will help us understand the different ways </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">Flask</span></strong><span class="koboSpan" id="kobo.5.1"> can be configured to suit the various needs of a project. </span><span class="koboSpan" id="kobo.5.2">Flask is “</span><em class="italic"><span class="koboSpan" id="kobo.6.1">The Python micro framework for building web applications</span></em><span class="koboSpan" id="kobo.7.1">” (</span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">pallets/Flask, </span></span><a href="https://github.com/pallets/flask"><span class="No-Break"><span class="koboSpan" id="kobo.9.1">https://github.com/pallets/flask</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.10.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.11.1">So, why is Flask called a </span><strong class="bold"><span class="koboSpan" id="kobo.12.1">microframework</span></strong><span class="koboSpan" id="kobo.13.1">? </span><span class="koboSpan" id="kobo.13.2">Does this mean Flask lacks functionality, or that it’s mandatory for the </span><a id="_idIndexMarker000"/><span class="koboSpan" id="kobo.14.1">complete code of your web application to be contained in a single file? </span><span class="koboSpan" id="kobo.14.2">Not really! </span><span class="koboSpan" id="kobo.14.3">The term microframework simply refers to the fact that Flask aims to keep the core of its framework small but highly extensible. </span><span class="koboSpan" id="kobo.14.4">This makes writing applications or extensions both easy and flexible and gives developers the power to choose the configurations they want for their application without imposing any restrictions on the choice of database, templating engine, admin interface, and so on. </span><span class="koboSpan" id="kobo.14.5">In this chapter, you will learn several ways to set up and </span><span class="No-Break"><span class="koboSpan" id="kobo.15.1">configure Flask.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.16.1">Important information</span></p>
<p class="callout"><span class="koboSpan" id="kobo.17.1">This whole book uses </span><em class="italic"><span class="koboSpan" id="kobo.18.1">Python 3</span></em><span class="koboSpan" id="kobo.19.1"> as the default version of Python. </span><span class="koboSpan" id="kobo.19.2">Python 2 lost its support on December 31, 2019, and is therefore not supported in this book. </span><span class="koboSpan" id="kobo.19.3">It is recommended that you use Python 3 while learning from this book, as many of the recipes might not work on </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">Python 2.</span></span></p>
<p class="callout"><span class="koboSpan" id="kobo.21.1">Likewise, while writing this book, Flask 2.2.x was the latest version. </span><span class="koboSpan" id="kobo.21.2">Although a lot of code in this book can work on earlier versions of Flask, it is recommended that you use versions 2.2.x </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">and above.</span></span></p>
<p><span class="koboSpan" id="kobo.23.1">Getting started with Flask takes just a couple of minutes. </span><span class="koboSpan" id="kobo.23.2">Setting up a simple </span><em class="italic"><span class="koboSpan" id="kobo.24.1">Hello World</span></em><span class="koboSpan" id="kobo.25.1"> application is as easy as pie. </span><span class="koboSpan" id="kobo.25.2">Simply create a file, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.26.1">app.py,</span></strong><span class="koboSpan" id="kobo.27.1"> in any location on your computer that can access </span><strong class="source-inline"><span class="koboSpan" id="kobo.28.1">python</span></strong><span class="koboSpan" id="kobo.29.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.30.1">python3</span></strong><span class="koboSpan" id="kobo.31.1"> that contains the </span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">following script:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.33.1">
from flask import Flask
app = Flask(__name__)
@app.route('/')
def hello_world():
    return 'Hello to the World of Flask!'
</span><span class="koboSpan" id="kobo.33.2">if __name__ == '__main__':
    app.run()</span></pre>
<p><span class="koboSpan" id="kobo.34.1">Now, Flask needs to be installed; this can be done via </span><strong class="source-inline"><span class="koboSpan" id="kobo.35.1">pip</span></strong><span class="koboSpan" id="kobo.36.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.37.1">pip3</span></strong><span class="koboSpan" id="kobo.38.1">. </span><span class="koboSpan" id="kobo.38.2">You may have to use </span><strong class="source-inline"><span class="koboSpan" id="kobo.39.1">sudo</span></strong><span class="koboSpan" id="kobo.40.1"> on a Unix-based machine if you run into </span><span class="No-Break"><span class="koboSpan" id="kobo.41.1">access issues:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.42.1">
$ pip3 install Flask</span></pre>
<p class="callout-heading"><span class="koboSpan" id="kobo.43.1">Important</span></p>
<p class="callout"><span class="koboSpan" id="kobo.44.1">The code and Flask installation example here is just intended to demonstrate the ease with which Flask can be used. </span><span class="koboSpan" id="kobo.44.2">To set up a proper development environment, follow the recipes in </span><span class="No-Break"><span class="koboSpan" id="kobo.45.1">this chapter.</span></span></p>
<p><span class="koboSpan" id="kobo.46.1">The preceding snippet is a complete Flask-based web application. </span><span class="koboSpan" id="kobo.46.2">Here, an instance of the </span><a id="_idIndexMarker001"/><span class="koboSpan" id="kobo.47.1">imported </span><strong class="source-inline"><span class="koboSpan" id="kobo.48.1">Flask</span></strong><span class="koboSpan" id="kobo.49.1"> class is a </span><strong class="bold"><span class="koboSpan" id="kobo.50.1">Web Server Gateway Interface</span></strong><span class="koboSpan" id="kobo.51.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.52.1">WSGI</span></strong><span class="koboSpan" id="kobo.53.1">) (</span><a href="http://legacy.python.org/dev/peps/pep-0333/"><span class="koboSpan" id="kobo.54.1">http://legacy.python.org/dev/peps/pep-0333/</span></a><span class="koboSpan" id="kobo.55.1">) application. </span><span class="koboSpan" id="kobo.55.2">So, </span><strong class="source-inline"><span class="koboSpan" id="kobo.56.1">app</span></strong><span class="koboSpan" id="kobo.57.1"> in this code becomes our WSGI application, and as this is a standalone module, we set the </span><strong class="source-inline"><span class="koboSpan" id="kobo.58.1">__name__</span></strong><span class="koboSpan" id="kobo.59.1"> string to </span><strong class="source-inline"><span class="koboSpan" id="kobo.60.1">'__main__'</span></strong><span class="koboSpan" id="kobo.61.1">. </span><span class="koboSpan" id="kobo.61.2">If we save this in a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.62.1">app.py</span></strong><span class="koboSpan" id="kobo.63.1">, then the application can simply be run using the </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">following command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.65.1">
$ python3 app.py
* Running on http://127.0.0.1:5000 (Press CTRL+C to quit)</span></pre>
<p><span class="koboSpan" id="kobo.66.1">Now, if we head over to our browser and type </span><strong class="source-inline"><span class="koboSpan" id="kobo.67.1">http://127.0.0.1:5000/</span></strong><span class="koboSpan" id="kobo.68.1">, we can see our </span><span class="No-Break"><span class="koboSpan" id="kobo.69.1">application running.</span></span></p>
<p><span class="koboSpan" id="kobo.70.1">Alternatively, the application can be run by using </span><strong class="source-inline"><span class="koboSpan" id="kobo.71.1">flask run</span></strong><span class="koboSpan" id="kobo.72.1"> or Python’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.73.1">-m</span></strong><span class="koboSpan" id="kobo.74.1"> switch with Flask. </span><span class="koboSpan" id="kobo.74.2">While following this approach, the last two lines of </span><strong class="source-inline"><span class="koboSpan" id="kobo.75.1">app.py</span></strong><span class="koboSpan" id="kobo.76.1"> can be skipped. </span><span class="koboSpan" id="kobo.76.2">Note that the following commands work only if there is a file named </span><strong class="source-inline"><span class="koboSpan" id="kobo.77.1">app.py</span></strong><span class="koboSpan" id="kobo.78.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.79.1">wsgi.py</span></strong><span class="koboSpan" id="kobo.80.1"> in the current directory. </span><span class="koboSpan" id="kobo.80.2">If not, then the file containing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.81.1">app</span></strong><span class="koboSpan" id="kobo.82.1"> object should be exported as an environment variable, namely </span><strong class="source-inline"><span class="koboSpan" id="kobo.83.1">FLASK_APP</span></strong><span class="koboSpan" id="kobo.84.1">. </span><span class="koboSpan" id="kobo.84.2">As a best practice, this should be done in </span><span class="No-Break"><span class="koboSpan" id="kobo.85.1">either case:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.86.1">
$ export FLASK_APP=app.py
$ flask run
* Running on http://127.0.0.1:5000/</span></pre>
<p><span class="koboSpan" id="kobo.87.1">Alternatively, if you decide to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.88.1">-m</span></strong><span class="koboSpan" id="kobo.89.1"> switch, it will look </span><span class="No-Break"><span class="koboSpan" id="kobo.90.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.91.1">
$ export FLASK_APP=app.py
$ python3 -m flask run
* Running on http://127.0.0.1:5000/</span></pre>
<p class="callout-heading"><span class="koboSpan" id="kobo.92.1">Tip</span></p>
<p class="callout"><span class="koboSpan" id="kobo.93.1">Never save your application file as </span><strong class="source-inline"><span class="koboSpan" id="kobo.94.1">flask.py</span></strong><span class="koboSpan" id="kobo.95.1">; if you do, it will conflict with Flask itself </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">while importing.</span></span></p>
<p><span class="koboSpan" id="kobo.97.1">In this chapter, we will cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">following recipes:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.99.1">Setting up our environment </span><span class="No-Break"><span class="koboSpan" id="kobo.100.1">with </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.101.1">virtualenv</span></strong></span></li>
<li><span class="koboSpan" id="kobo.102.1">Handling </span><span class="No-Break"><span class="koboSpan" id="kobo.103.1">basic configurations</span></span></li>
<li><span class="koboSpan" id="kobo.104.1">Configuring </span><span class="No-Break"><span class="koboSpan" id="kobo.105.1">class-based settings</span></span></li>
<li><span class="koboSpan" id="kobo.106.1">Organizing </span><span class="No-Break"><span class="koboSpan" id="kobo.107.1">static files</span></span></li>
<li><span class="koboSpan" id="kobo.108.1">Being deployment-specific with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.109.1">instance</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.110.1"> folder</span></span></li>
<li><span class="koboSpan" id="kobo.111.1">Compositions of views </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">and models</span></span></li>
<li><span class="koboSpan" id="kobo.113.1">Creating a modular web app </span><span class="No-Break"><span class="koboSpan" id="kobo.114.1">with blueprints</span></span></li>
<li><span class="koboSpan" id="kobo.115.1">Making a Flask app installable </span><span class="No-Break"><span class="koboSpan" id="kobo.116.1">using </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.117.1">setuptool</span><a id="_idTextAnchor019"/><span class="koboSpan" id="kobo.118.1">s</span></strong></span></li>
</ul>
<h1 id="_idParaDest-19"><a id="_idTextAnchor020"/><span class="koboSpan" id="kobo.119.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.120.1">Working with Flask and </span><strong class="bold"><span class="koboSpan" id="kobo.121.1">Python</span></strong><span class="koboSpan" id="kobo.122.1"> in general is pretty easy and does not require a lot of dependencies and configurations. </span><span class="koboSpan" id="kobo.122.2">For most of the chapters in this book, all the required packages shall be mentioned in the relevant recipes. </span><span class="koboSpan" id="kobo.122.3">I will mention more specific requirements in relevant chapters. </span><span class="koboSpan" id="kobo.122.4">In general, you will need </span><span class="No-Break"><span class="koboSpan" id="kobo.123.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.124.1">A decent computer, preferably with a </span><em class="italic"><span class="koboSpan" id="kobo.125.1">UNIX</span></em><span class="koboSpan" id="kobo.126.1">-based OS such as </span><em class="italic"><span class="koboSpan" id="kobo.127.1">Linux</span></em><span class="koboSpan" id="kobo.128.1"> or </span><em class="italic"><span class="koboSpan" id="kobo.129.1">macOS</span></em><span class="koboSpan" id="kobo.130.1">. </span><span class="koboSpan" id="kobo.130.2">You can also use Windows, which would require some additional setup, but that is out of the scope of </span><span class="No-Break"><span class="koboSpan" id="kobo.131.1">this book.</span></span></li>
<li><span class="koboSpan" id="kobo.132.1">A code editor of choice as the IDE. </span><span class="koboSpan" id="kobo.132.2">I use </span><em class="italic"><span class="koboSpan" id="kobo.133.1">Vim</span></em><span class="koboSpan" id="kobo.134.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.135.1">Visual Studio Code</span></em><span class="koboSpan" id="kobo.136.1"> but anything will work, so long as it </span><span class="No-Break"><span class="koboSpan" id="kobo.137.1">supports </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.138.1">Python</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.139.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.140.1">A good internet connection as you will be downloading the packages and </span><span class="No-Break"><span class="koboSpan" id="kobo.141.1">their dependencies.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.142.1">All the code is freely available on GitHub at </span><a href="https://github.com/PacktPublishing/Flask-Framework-Cookbook-Third-Edition"><span class="koboSpan" id="kobo.143.1">https://github.com/PacktPublishing/Flask-Framework-Cookbook-Third-Edition</span></a><span class="koboSpan" id="kobo.144.1">. </span><span class="koboSpan" id="kobo.144.2">This repository on GitHub contains the code for all the chapters in this book, segregated into </span><span class="No-Break"><span class="koboSpan" id="kobo.145.1">corresponding folders</span><a id="_idTextAnchor021"/><span class="koboSpan" id="kobo.146.1">.</span></span></p>
<h1 id="_idParaDest-20"><a id="_idTextAnchor022"/><span class="koboSpan" id="kobo.147.1">Setting up a virtual environment</span></h1>
<p><span class="koboSpan" id="kobo.148.1">Flask can be simply installed using </span><strong class="source-inline"><span class="koboSpan" id="kobo.149.1">pip</span></strong><span class="koboSpan" id="kobo.150.1">/</span><strong class="source-inline"><span class="koboSpan" id="kobo.151.1">pip3</span></strong><span class="koboSpan" id="kobo.152.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.153.1">easy_install</span></strong><span class="koboSpan" id="kobo.154.1"> globally, but it’s preferable to set up an </span><a id="_idIndexMarker002"/><span class="koboSpan" id="kobo.155.1">application environment using </span><strong class="bold"><span class="koboSpan" id="kobo.156.1">venv</span></strong><span class="koboSpan" id="kobo.157.1">. </span><span class="koboSpan" id="kobo.157.2">This prevents the global Python installation from </span><a id="_idIndexMarker003"/><span class="koboSpan" id="kobo.158.1">being affected by a custom installation as it creates a separate environment for the application. </span><span class="koboSpan" id="kobo.158.2">This separate environment is helpful as it allows you to have multiple versions of the same library for multiple applications; some packages might also have different versions of the same libraries as dependencies. </span><strong class="source-inline"><span class="koboSpan" id="kobo.159.1">venv</span></strong><span class="koboSpan" id="kobo.160.1"> manages this in separate environments and does not let the incorrect version of any library affect any application. </span><span class="koboSpan" id="kobo.160.2">In this recipe, we will learn how to create and manage </span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">these environmen</span><a id="_idTextAnchor023"/><span class="koboSpan" id="kobo.162.1">ts.</span></span></p>
<h2 id="_idParaDest-21"><a id="_idTextAnchor024"/><span class="koboSpan" id="kobo.163.1">How to do it...</span></h2>
<p><strong class="bold"><span class="koboSpan" id="kobo.164.1">Python3</span></strong><span class="koboSpan" id="kobo.165.1"> comes bundled with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.166.1">venv</span></strong><span class="koboSpan" id="kobo.167.1"> module to create virtual environments. </span><span class="koboSpan" id="kobo.167.2">So, simply create a new environment called </span><strong class="source-inline"><span class="koboSpan" id="kobo.168.1">my_flask_env</span></strong><span class="koboSpan" id="kobo.169.1"> (or any other name of your choice) inside the folder of your choice where you want your development environment to live. </span><span class="koboSpan" id="kobo.169.2">This will create a new folder with the same name, </span><span class="No-Break"><span class="koboSpan" id="kobo.170.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.171.1">
$ python3 -m venv my_flask_env</span></pre>
<p><span class="koboSpan" id="kobo.172.1">Run the following commands from inside the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.173.1">my_flask_env</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.174.1"> folder:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.175.1">
$ source my_flask_env/bin/activate
$ pip3 install flask</span></pre>
<p><span class="koboSpan" id="kobo.176.1">This will activate our environment and install </span><strong class="source-inline"><span class="koboSpan" id="kobo.177.1">flask</span></strong><span class="koboSpan" id="kobo.178.1"> inside it. </span><span class="koboSpan" id="kobo.178.2">Now, we can do anything with our application within this environment, without affecting any other </span><span class="No-Break"><span class="koboSpan" id="kobo.179.1">Python environme</span><a id="_idTextAnchor025"/><span class="koboSpan" id="kobo.180.1">nt.</span></span></p>
<h2 id="_idParaDest-22"><a id="_idTextAnchor026"/><span class="koboSpan" id="kobo.181.1">How it works...</span></h2>
<p><span class="koboSpan" id="kobo.182.1">So far, we have used </span><strong class="source-inline"><span class="koboSpan" id="kobo.183.1">pip3 install flask</span></strong><span class="koboSpan" id="kobo.184.1"> multiple times. </span><span class="koboSpan" id="kobo.184.2">As its name suggests, the command refers to </span><a id="_idIndexMarker004"/><span class="koboSpan" id="kobo.185.1">the installation of Flask, just like any Python package. </span><span class="koboSpan" id="kobo.185.2">If we look a bit deeper into the process of installing Flask via </span><strong class="source-inline"><span class="koboSpan" id="kobo.186.1">pip3</span></strong><span class="koboSpan" id="kobo.187.1">, we will see that several packages are installed. </span><span class="koboSpan" id="kobo.187.2">The following is an outline of the package installation process </span><span class="No-Break"><span class="koboSpan" id="kobo.188.1">of Flask:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.189.1">
$ pip3 install flask
Collecting Flask
...........
</span><span class="koboSpan" id="kobo.189.2">...........
</span><span class="koboSpan" id="kobo.189.3">Many more lines.........
</span><span class="koboSpan" id="kobo.189.4">...........
</span><span class="koboSpan" id="kobo.189.5">Installing collected packages: zipp, Werkzeug, MarkupSafe, itsdangerous, click, Jinja2, importlib-metadata, Flask
Successfully installed Flask-2.1.2 Jinja2-3.1.2 MarkupSafe-2.1.1 Werkzeug-2.1.2 click-8.1.3 importlib-metadata-4.11.4 itsdangerous-2.1.2 zipp-3.8.0</span></pre>
<p><span class="koboSpan" id="kobo.190.1">If we look carefully at the </span><a id="_idIndexMarker005"/><span class="koboSpan" id="kobo.191.1">preceding snippet, we will see that multiple packages have been installed. </span><span class="koboSpan" id="kobo.191.2">Of these, five packages, namely, </span><strong class="source-inline"><span class="koboSpan" id="kobo.192.1">Werkzeug</span></strong><span class="koboSpan" id="kobo.193.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.194.1">Jinja2</span></strong><span class="koboSpan" id="kobo.195.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.196.1">click</span></strong><span class="koboSpan" id="kobo.197.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.198.1">itsdangerous</span></strong><span class="koboSpan" id="kobo.199.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.200.1">markupsafe</span></strong><span class="koboSpan" id="kobo.201.1">, are the packages on which Flask depends, and it will not work if any of them are missing. </span><span class="koboSpan" id="kobo.201.2">Others are sub-dependencies that are needed for the dependencies of Flask </span><span class="No-Break"><span class="koboSpan" id="kobo.202.1">to </span><a id="_idTextAnchor027"/><span class="koboSpan" id="kobo.203.1">work.</span></span></p>
<h2 id="_idParaDest-23"><a id="_idTextAnchor028"/><span class="koboSpan" id="kobo.204.1">There’s more...</span></h2>
<p><span class="koboSpan" id="kobo.205.1">Before </span><strong class="source-inline"><span class="koboSpan" id="kobo.206.1">venv</span></strong><span class="koboSpan" id="kobo.207.1"> was introduced in </span><em class="italic"><span class="koboSpan" id="kobo.208.1">Python 3.3</span></em><span class="koboSpan" id="kobo.209.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.210.1">virtualenv</span></strong><span class="koboSpan" id="kobo.211.1"> was the standard library used to create and </span><a id="_idIndexMarker006"/><span class="koboSpan" id="kobo.212.1">manage virtual environments. </span><strong class="source-inline"><span class="koboSpan" id="kobo.213.1">venv</span></strong><span class="koboSpan" id="kobo.214.1"> is a subset of </span><strong class="source-inline"><span class="koboSpan" id="kobo.215.1">virtualenv</span></strong><span class="koboSpan" id="kobo.216.1"> and misses out on the advanced features that </span><strong class="source-inline"><span class="koboSpan" id="kobo.217.1">virtualenv</span></strong><span class="koboSpan" id="kobo.218.1"> provides. </span><span class="koboSpan" id="kobo.218.2">For the sake of simplicity and to stay in the context of this book, I will use </span><strong class="source-inline"><span class="koboSpan" id="kobo.219.1">venv</span></strong><span class="koboSpan" id="kobo.220.1">, but you are free to explore </span><strong class="source-inline"><span class="koboSpan" id="kobo.221.1">virtualenv</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.222.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.223.1">virtualenvwr</span><a id="_idTextAnchor029"/><span class="koboSpan" id="kobo.224.1">apper</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.225.1">.</span></span></p>
<h2 id="_idParaDest-24"><a id="_idTextAnchor030"/><span class="koboSpan" id="kobo.226.1">See also</span></h2>
<p><span class="koboSpan" id="kobo.227.1">The references relating to this section are </span><span class="No-Break"><span class="koboSpan" id="kobo.228.1">as follows:</span></span></p>
<ul>
<li><a href="https://pypi.python.org/pypi/Flask"><span class="No-Break"><span class="koboSpan" id="kobo.229.1">https://pypi.python.org/pypi/Flask</span></span></a></li>
<li><a href="https://pypi.python.org/pypi/Werkzeug"><span class="No-Break"><span class="koboSpan" id="kobo.230.1">https://pypi.python.org/pypi/Werkzeug</span></span></a></li>
<li><a href="https://pypi.python.org/pypi/Jinja2"><span class="No-Break"><span class="koboSpan" id="kobo.231.1">https://pypi.python.org/pypi/Jinja2</span></span></a></li>
<li><a href="https://pypi.python.org/pypi/itsdangerous"><span class="No-Break"><span class="koboSpan" id="kobo.232.1">https://pypi.python.org/pypi/itsdangerous</span></span></a></li>
<li><a href="https://pypi.python.org/pypi/MarkupSafe"><span class="No-Break"><span class="koboSpan" id="kobo.233.1">https://pypi.python.org/pypi/MarkupSafe</span></span></a></li>
<li><a href="https://pypi.python.org/pypi/click"><span class="No-Break"><span class="koboSpan" id="kobo.234.1">https://pypi.python.org/pypi/click</span></span></a></li>
</ul>
<p><span class="koboSpan" id="kobo.235.1">Read more about </span><strong class="source-inline"><span class="koboSpan" id="kobo.236.1">virtualenv</span></strong><span class="koboSpan" id="kobo.237.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.238.1">virtualenvwrapper</span></strong><span class="koboSpan" id="kobo.239.1"> at </span><a href="https://virtualenv.pypa.io/en/latest/"><span class="koboSpan" id="kobo.240.1">https://virtualenv.pypa.io/en/latest/</span></a> <span class="No-Break"><span class="koboSpan" id="kobo.241.1">and </span></span><a href="https://pypi.org/project/virtualenvwrapper/"><span class="No-Break"><span class="koboSpan" id="kobo.242.1">https://pypi.org/project/virtualenvwra</span><span id="_idTextAnchor031"/><span class="koboSpan" id="kobo.243.1">pper/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.244.1">.</span></span></p>
<h1 id="_idParaDest-25"><a id="_idTextAnchor032"/><span class="koboSpan" id="kobo.245.1">Handling basic configurations</span></h1>
<p><span class="koboSpan" id="kobo.246.1">One of the beauties of Flask is that it is very easy to configure a Flask application according to the </span><a id="_idIndexMarker007"/><span class="koboSpan" id="kobo.247.1">needs of the project. </span><span class="koboSpan" id="kobo.247.2">In this recipe, we will try to understand the different ways in which a Flask application can be configured, including how to load a configuration from environment variables, Python files, or even a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.248.1">config</span></strong></span><span class="No-Break"> <a id="_idTextAnchor033"/><span class="koboSpan" id="kobo.249.1">object.</span></span></p>
<h2 id="_idParaDest-26"><a id="_idTextAnchor034"/><span class="koboSpan" id="kobo.250.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.251.1">In Flask, configuration variables are stored on a dictionary-like attribute named </span><strong class="source-inline"><span class="koboSpan" id="kobo.252.1">config</span></strong><span class="koboSpan" id="kobo.253.1"> of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.254.1">Flask</span></strong><span class="koboSpan" id="kobo.255.1"> object. </span><span class="koboSpan" id="kobo.255.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.256.1">config</span></strong><span class="koboSpan" id="kobo.257.1"> attribute is a subclass of the Python dictionary, and we can modify it just like </span><span class="No-Break"><span class="koboSpan" id="kobo.258.1">any dict</span><a id="_idTextAnchor035"/><span class="koboSpan" id="kobo.259.1">ionary.</span></span></p>
<h2 id="_idParaDest-27"><a id="_idTextAnchor036"/><span class="koboSpan" id="kobo.260.1">How to do it...</span></h2>
<p><span class="koboSpan" id="kobo.261.1">To run our application in debug mode, for instance, we can write </span><span class="No-Break"><span class="koboSpan" id="kobo.262.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.263.1">
app = Flask(__name__)
app.config['DEBUG'] = True</span></pre>
<p class="callout-heading"><span class="koboSpan" id="kobo.264.1">Tip</span></p>
<p class="callout"><span class="koboSpan" id="kobo.265.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.266.1">debug</span></strong><span class="koboSpan" id="kobo.267.1"> Boolean can also be set at the Flask </span><strong class="source-inline"><span class="koboSpan" id="kobo.268.1">object</span></strong><span class="koboSpan" id="kobo.269.1"> level rather than at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.270.1">config</span></strong><span class="koboSpan" id="kobo.271.1"> level, </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">as follows:</span></span></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.273.1">app.debug = </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.274.1">True</span></strong></span></p>
<p class="callout"><span class="koboSpan" id="kobo.275.1">Alternatively, we can pass </span><strong class="source-inline"><span class="koboSpan" id="kobo.276.1">debug</span></strong><span class="koboSpan" id="kobo.277.1"> as a named argument to </span><strong class="source-inline"><span class="koboSpan" id="kobo.278.1">app.run</span></strong><span class="koboSpan" id="kobo.279.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.280.1">as follows:</span></span></p>
<p class="callout"><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.281.1">app.run(debug=True)</span></strong></span></p>
<p class="callout"><span class="koboSpan" id="kobo.282.1">In new versions of Flask, the debug mode can also be set on an environment variable, </span><strong class="source-inline"><span class="koboSpan" id="kobo.283.1">FLASK_DEBUG=1</span></strong><span class="koboSpan" id="kobo.284.1">. </span><span class="koboSpan" id="kobo.284.2">Then, we can run the app using </span><strong class="source-inline"><span class="koboSpan" id="kobo.285.1">flask run </span></strong><span class="koboSpan" id="kobo.286.1">or Python’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.287.1">-</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.288.1">m</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.289.1"> switch:</span></span></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.290.1">$ </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.291.1">export FLASK_DEBUG=1</span></strong></span></p>
<p class="callout"><span class="koboSpan" id="kobo.292.1">Enabling debug mode will make the server reload itself in the event of any code changes, and it also provides the very helpful </span><em class="italic"><span class="koboSpan" id="kobo.293.1">Werkzeug</span></em><span class="koboSpan" id="kobo.294.1"> debugger when something </span><span class="No-Break"><span class="koboSpan" id="kobo.295.1">goes wrong.</span></span></p>
<p><span class="koboSpan" id="kobo.296.1">There are a bunch of configuration values provided by Flask. </span><span class="koboSpan" id="kobo.296.2">We will come across them in relevant recipes throughout </span><span class="No-Break"><span class="koboSpan" id="kobo.297.1">this chapter.</span></span></p>
<p><span class="koboSpan" id="kobo.298.1">As an application becomes larger, there is a need to manage the application’s configuration in a </span><a id="_idIndexMarker008"/><span class="koboSpan" id="kobo.299.1">separate file, as shown in the following example. </span><span class="koboSpan" id="kobo.299.2">In most operating systems and development environments that you use, it is unlikely that this file will be a part of the version control system. </span><span class="koboSpan" id="kobo.299.3">Thus, Flask provides us with multiple ways to fetch configurations. </span><span class="koboSpan" id="kobo.299.4">The most frequently used methods are </span><span class="No-Break"><span class="koboSpan" id="kobo.300.1">as follows:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.301.1">From a Python configuration file (</span><strong class="source-inline"><span class="koboSpan" id="kobo.302.1">*.cfg</span></strong><span class="koboSpan" id="kobo.303.1">), where the configuration can be fetched using the </span><span class="No-Break"><span class="koboSpan" id="kobo.304.1">following statement:</span></span><pre class="console"><span class="koboSpan" id="kobo.305.1">
app.config.from_pyfile('myconfig.cfg')</span></pre></li>
<li><span class="koboSpan" id="kobo.306.1">From an object, where the configuration can be fetched using the </span><span class="No-Break"><span class="koboSpan" id="kobo.307.1">following statement:</span></span><pre class="console"><span class="koboSpan" id="kobo.308.1">
app.config.from_object('myapplication.default_settings')</span></pre></li>
<li><span class="koboSpan" id="kobo.309.1">Alternatively, to load from the same file from which this command is run, we can use the </span><span class="No-Break"><span class="koboSpan" id="kobo.310.1">following statement:</span></span><pre class="console"><span class="koboSpan" id="kobo.311.1">
app.config.from_object(__name__)</span></pre></li>
<li><span class="koboSpan" id="kobo.312.1">From an environment variable, the configuration can be fetched using the </span><span class="No-Break"><span class="koboSpan" id="kobo.313.1">following statement:</span></span><pre class="console"><span class="koboSpan" id="kobo.314.1">
app.config.from_envvar('PATH_TO_CONFIG_FILE')</span></pre></li>
<li><span class="koboSpan" id="kobo.315.1">New in Flask version </span><em class="italic"><span class="koboSpan" id="kobo.316.1">2.0</span></em><span class="koboSpan" id="kobo.317.1"> is a capability to load from generic configuration file formats such as </span><strong class="bold"><span class="koboSpan" id="kobo.318.1">JSON</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.319.1">or </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.320.1">TOML</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.321.1">:</span></span><pre class="console"><span class="koboSpan" id="kobo.322.1">
app.config.from_file('config.json', load=json.load)</span></pre></li>
</ul>
<pre><span class="koboSpan" id="kobo.323.1">Alternatively, we can do the following:
app.config.from_file('config.toml', load=to</span><a id="_idTextAnchor037"/><span class="koboSpan" id="kobo.324.1">ml.load)</span></pre>
<h2 id="_idParaDest-28"><a id="_idTextAnchor038"/><span class="koboSpan" id="kobo.325.1">How it works...</span></h2>
<p><span class="koboSpan" id="kobo.326.1">Flask is designed to only pick up configuration variables that are written in uppercase. </span><span class="koboSpan" id="kobo.326.2">This allows us to define any local variables in our configuration files and objects and leave the rest </span><span class="No-Break"><span class="koboSpan" id="kobo.327.1">to Flask.</span></span></p>
<p><span class="koboSpan" id="kobo.328.1">The best practice when </span><a id="_idIndexMarker009"/><span class="koboSpan" id="kobo.329.1">using configurations is to have a bunch of default settings in </span><strong class="source-inline"><span class="koboSpan" id="kobo.330.1">app.py</span></strong><span class="koboSpan" id="kobo.331.1">, or via any object in the application itself, and then override the same by loading it from the configuration file. </span><span class="koboSpan" id="kobo.331.2">So, the code will look </span><span class="No-Break"><span class="koboSpan" id="kobo.332.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.333.1">
app = Flask(__name__)
DEBUG = True
TESTING = True
app.config.from_object(__name__)
app.config.from_pyfile('/path/to/conf</span><a id="_idTextAnchor039"/><span class="koboSpan" id="kobo.334.1">ig/file')</span></pre>
<h1 id="_idParaDest-29"><a id="_idTextAnchor040"/><span class="koboSpan" id="kobo.335.1">Configuring using class-based settings</span></h1>
<p><span class="koboSpan" id="kobo.336.1">An effective way of laying out configurations for different deployment modes, such as production, testing, staging, </span><a id="_idIndexMarker010"/><span class="koboSpan" id="kobo.337.1">and so on, can be cleanly done using the inheritance pattern of classes. </span><span class="koboSpan" id="kobo.337.2">As your project gets bigger, you can have different deployment modes, and each mode can have several different configuration settings or some settings that will remain the same. </span><span class="koboSpan" id="kobo.337.3">In this recipe, we will learn how to use class-based settings to achieve such </span><a id="_idTextAnchor041"/><span class="No-Break"><span class="koboSpan" id="kobo.338.1">a pattern.</span></span></p>
<h2 id="_idParaDest-30"><a id="_idTextAnchor042"/><span class="koboSpan" id="kobo.339.1">How to do it...</span></h2>
<p><span class="koboSpan" id="kobo.340.1">We can have a base class with default settings; then, other classes can simply inherit from the base class and override or add deployment-specific configuration variables to it, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.341.1">following example:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.342.1">
class BaseConfig(object):
    'Base config class'
    SECRET_KEY = 'A random secret key'
    DEBUG = True
    TESTING = False
    NEW_CONFIG_VARIABLE = 'my value'
class ProductionConfig(BaseConfig):
    'Production specific config'
    DEBUG = False
    SECRET_KEY = open('/path/to/secret/file').read()
class StagingConfig(BaseConfig):
    'Staging specific config'
    DEBUG = True
class DevelopmentConfig(BaseConfig):
    'Development environment specific config'
    DEBUG = True
    TESTING = True
    SECRET_KEY = 'Another random secret key'</span></pre>
<p class="callout-heading"><span class="koboSpan" id="kobo.343.1">Important information</span></p>
<p class="callout"><span class="koboSpan" id="kobo.344.1">In a production configuration, the secret key is generally stored in a separate file because, for security reasons, it should not be a part of your version control system. </span><span class="koboSpan" id="kobo.344.2">This should be kept in the local filesystem on the machine itself, whether it is your machine or</span><a id="_idTextAnchor043"/> <span class="No-Break"><span class="koboSpan" id="kobo.345.1">a server.</span></span></p>
<h2 id="_idParaDest-31"><a id="_idTextAnchor044"/><span class="koboSpan" id="kobo.346.1">How it works...</span></h2>
<p><span class="koboSpan" id="kobo.347.1">Now, we can </span><a id="_idIndexMarker011"/><span class="koboSpan" id="kobo.348.1">use any of the preceding classes while loading the application’s configuration via </span><strong class="source-inline"><span class="koboSpan" id="kobo.349.1">from_object()</span></strong><span class="koboSpan" id="kobo.350.1">. </span><span class="koboSpan" id="kobo.350.2">Let’s say that we save the preceding class-based configuration in a file named </span><strong class="source-inline"><span class="koboSpan" id="kobo.351.1">configuration.py</span></strong><span class="koboSpan" id="kobo.352.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.353.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.354.1">
app.config.from_object('configuration.DevelopmentConfig')</span></pre>
<p><span class="koboSpan" id="kobo.355.1">Overall, this makes managing configurations for different deployment environments more flexible </span><a id="_idTextAnchor045"/><span class="No-Break"><span class="koboSpan" id="kobo.356.1">and easier.</span></span></p>
<h1 id="_idParaDest-32"><a id="_idTextAnchor046"/><span class="koboSpan" id="kobo.357.1">Organizing static files</span></h1>
<p><span class="koboSpan" id="kobo.358.1">Organizing static files </span><a id="_idIndexMarker012"/><span class="koboSpan" id="kobo.359.1">such as JavaScript, stylesheets, images, and so on efficiently is always a matter of concern for all web frameworks. </span><span class="koboSpan" id="kobo.359.2">In this recipe, we’ll learn how to achieve th</span><a id="_idTextAnchor047"/><span class="koboSpan" id="kobo.360.1">is </span><span class="No-Break"><span class="koboSpan" id="kobo.361.1">in Flask.</span></span></p>
<h2 id="_idParaDest-33"><a id="_idTextAnchor048"/><span class="koboSpan" id="kobo.362.1">How to do it...</span></h2>
<p><span class="koboSpan" id="kobo.363.1">Flask recommends a specific way of organizing static files in an application, </span><span class="No-Break"><span class="koboSpan" id="kobo.364.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.365.1">
my_app/
    app.py
    config.py
    __init__.py
    static/
        css/
        js/
        images/
            logo.png</span></pre>
<p><span class="koboSpan" id="kobo.366.1">While rendering this in templates (say, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.367.1">logo.png</span></strong><span class="koboSpan" id="kobo.368.1"> file), we can refer to the static files using the </span><span class="No-Break"><span class="koboSpan" id="kobo.369.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.370.1">
&lt;img src='/static/image</span><a id="_idTextAnchor049"/><span class="koboSpan" id="kobo.371.1">s/logo.png'&gt;</span></pre>
<h2 id="_idParaDest-34"><a id="_idTextAnchor050"/><span class="koboSpan" id="kobo.372.1">How it works...</span></h2>
<p><span class="koboSpan" id="kobo.373.1">If a folder named </span><strong class="source-inline"><span class="koboSpan" id="kobo.374.1">static</span></strong><span class="koboSpan" id="kobo.375.1"> exists </span><a id="_idIndexMarker013"/><span class="koboSpan" id="kobo.376.1">at the application’s root level – that is, at the same level as </span><strong class="source-inline"><span class="koboSpan" id="kobo.377.1">app.py</span></strong><span class="koboSpan" id="kobo.378.1"> – then Flask will automatically read the contents of the folder without any </span><span class="No-Break"><span class="koboSpan" id="kobo.379.1">extra c</span><a id="_idTextAnchor051"/><span class="koboSpan" id="kobo.380.1">onfiguration.</span></span></p>
<h2 id="_idParaDest-35"><a id="_idTextAnchor052"/><span class="koboSpan" id="kobo.381.1">There’s more...</span></h2>
<p><span class="koboSpan" id="kobo.382.1">Alternatively, we can provide a parameter named </span><strong class="source-inline"><span class="koboSpan" id="kobo.383.1">static_folder</span></strong><span class="koboSpan" id="kobo.384.1"> to the application object while defining the application in </span><strong class="source-inline"><span class="koboSpan" id="kobo.385.1">app.py</span></strong><span class="koboSpan" id="kobo.386.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.387.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.388.1">
app = Flask(__name__,
    static_folder='/path/to/static/folder')</span></pre>
<p><span class="koboSpan" id="kobo.389.1">In the preceding </span><a id="_idIndexMarker014"/><span class="koboSpan" id="kobo.390.1">line of code, </span><strong class="source-inline"><span class="koboSpan" id="kobo.391.1">static</span></strong><span class="koboSpan" id="kobo.392.1"> refers to the value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.393.1">static_folder</span></strong><span class="koboSpan" id="kobo.394.1"> on the application object. </span><span class="koboSpan" id="kobo.394.2">This can be modified as follows by providing a URL prefix by </span><span class="No-Break"><span class="koboSpan" id="kobo.395.1">supplying </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.396.1">static_url_path</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.397.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.398.1">
app = Flask(
    _name_, static_url_path='/differentstatic',
    static_folder='/path/to/static/folder'
)</span></pre>
<p><span class="koboSpan" id="kobo.399.1">Now, to render the static file, we can use the </span><span class="No-Break"><span class="koboSpan" id="kobo.400.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.401.1">
&lt;img src='/differentstatic/logo.png'&gt;</span></pre>
<p><span class="koboSpan" id="kobo.402.1">It is always a good practice to use </span><strong class="source-inline"><span class="koboSpan" id="kobo.403.1">url_for</span></strong><span class="koboSpan" id="kobo.404.1"> to create URLs for static files rather than explicitly defining them, </span><span class="No-Break"><span class="koboSpan" id="kobo.405.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.406.1">
&lt;img src="{{ url_for('static', filename='l</span><a id="_idTextAnchor053"/><span class="koboSpan" id="kobo.407.1">ogo.png') }}"&gt;</span></pre>
<h1 id="_idParaDest-36"><a id="_idTextAnchor054"/><span class="koboSpan" id="kobo.408.1">Being deployment-specific with the instance folder</span></h1>
<p><span class="koboSpan" id="kobo.409.1">Flask provides yet </span><a id="_idIndexMarker015"/><span class="koboSpan" id="kobo.410.1">another method for configuration, where we can efficiently manage deployment-specific parts. </span><span class="koboSpan" id="kobo.410.2">Instance folders allow us to segregate deployment-specific files from our version-controlled application. </span><span class="koboSpan" id="kobo.410.3">We know that configuration files can be separate for different deployment environments, such as development and production, but there are also many more files, such as database files, session files, cache files, and other runtime files. </span><span class="koboSpan" id="kobo.410.4">In this recipe, we will create an instance folder that will act like a holder container for such kinds of files. </span><span class="koboSpan" id="kobo.410.5">By design, the instance folder will not be a part of the version </span><a id="_idTextAnchor055"/><span class="No-Break"><span class="koboSpan" id="kobo.411.1">control system.</span></span></p>
<h2 id="_idParaDest-37"><a id="_idTextAnchor056"/><span class="koboSpan" id="kobo.412.1">How to do it...</span></h2>
<p><span class="koboSpan" id="kobo.413.1">By default, the instance folder is picked up from the application automatically if we have a folder named </span><strong class="source-inline"><span class="koboSpan" id="kobo.414.1">instance</span></strong><span class="koboSpan" id="kobo.415.1"> in our application at the application level, </span><span class="No-Break"><span class="koboSpan" id="kobo.416.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.417.1">
my_app/
    app.py
    instance/
        config.cfg</span></pre>
<p><span class="koboSpan" id="kobo.418.1">We can also explicitly define the absolute path of the instance folder by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.419.1">instance_path</span></strong><span class="koboSpan" id="kobo.420.1"> parameter on our application object, </span><span class="No-Break"><span class="koboSpan" id="kobo.421.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.422.1">
app = Flask(
    __name__,
    instance_path='/absolute/path/to/instance/folder')</span></pre>
<p><span class="koboSpan" id="kobo.423.1">To load the configuration file from the instance folder, we can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.424.1">instance_relative_config</span></strong><span class="koboSpan" id="kobo.425.1"> parameter on the application object, </span><span class="No-Break"><span class="koboSpan" id="kobo.426.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.427.1">
app = Flask(__name__, instance_relative_config=True)</span></pre>
<p><span class="koboSpan" id="kobo.428.1">This tells the application to load the configuration file from the instance folder. </span><span class="koboSpan" id="kobo.428.2">The following example shows how to </span><span class="No-Break"><span class="koboSpan" id="kobo.429.1">configure this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.430.1">
app = Flask(
    __name__, instance_path='path/to/instance/folder',
    instance_relative_config=True
)
app.config.from_pyfile('config.cfg</span><a id="_idTextAnchor057"/><span class="koboSpan" id="kobo.431.1">', silent=True)</span></pre>
<h2 id="_idParaDest-38"><a id="_idTextAnchor058"/><span class="koboSpan" id="kobo.432.1">How it works...</span></h2>
<p><span class="koboSpan" id="kobo.433.1">In the preceding code, first, the instance folder is loaded from the given path; then, the configuration file is loaded from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.434.1">config.cfg</span></strong><span class="koboSpan" id="kobo.435.1"> file in the given instance folder. </span><span class="koboSpan" id="kobo.435.2">Here, </span><strong class="source-inline"><span class="koboSpan" id="kobo.436.1">silent=True</span></strong><span class="koboSpan" id="kobo.437.1"> is optional and is used to suppress the error if </span><strong class="source-inline"><span class="koboSpan" id="kobo.438.1">config.cfg</span></strong><span class="koboSpan" id="kobo.439.1"> is not found </span><a id="_idIndexMarker016"/><span class="koboSpan" id="kobo.440.1">in the instance folder. </span><span class="koboSpan" id="kobo.440.2">If </span><strong class="source-inline"><span class="koboSpan" id="kobo.441.1">silent=True</span></strong><span class="koboSpan" id="kobo.442.1"> is not given and the file is not found, then the application will fail, giving the </span><span class="No-Break"><span class="koboSpan" id="kobo.443.1">following error:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.444.1">
IOError: [Errno 2] Unable to load configuration file (No such file or directory): '/absolute/path/to/config/file'</span></pre>
<p class="callout-heading"><span class="koboSpan" id="kobo.445.1">Information</span></p>
<p class="callout"><span class="koboSpan" id="kobo.446.1">It might seem that loading the configuration from the instance folder using </span><strong class="source-inline"><span class="koboSpan" id="kobo.447.1">instance_relative_config</span></strong><span class="koboSpan" id="kobo.448.1"> is redundant work and could be moved to one of the configuration methods itself. </span><span class="koboSpan" id="kobo.448.2">However, the beauty of this process lies in the fact that the instance folder concept is completely independent of configuration, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.449.1">instance_relative_config</span></strong><span class="koboSpan" id="kobo.450.1"> just complements the </span><span class="No-Break"><span class="koboSpan" id="kobo.451.1">confi</span><a id="_idTextAnchor059"/><span class="koboSpan" id="kobo.452.1">guration object.</span></span></p>
<h1 id="_idParaDest-39"><a id="_idTextAnchor060"/><span class="koboSpan" id="kobo.453.1">Composition of views and models</span></h1>
<p><span class="koboSpan" id="kobo.454.1">As our application </span><a id="_idIndexMarker017"/><span class="koboSpan" id="kobo.455.1">becomes bigger, we might want to structure it in a modular manner. </span><span class="koboSpan" id="kobo.455.2">In this recipe, we will do this by restructuring our </span><em class="italic"><span class="koboSpan" id="kobo.456.1">Hello </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.457.1">W</span><a id="_idTextAnchor061"/><span class="koboSpan" id="kobo.458.1">orld</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.459.1"> application.</span></span></p>
<h2 id="_idParaDest-40"><a id="_idTextAnchor062"/><span class="koboSpan" id="kobo.460.1">How to do it...</span></h2>
<p><span class="koboSpan" id="kobo.461.1">First, create a new folder in the application and move all the files inside this new folder. </span><span class="koboSpan" id="kobo.461.2">Then, create </span><strong class="source-inline"><span class="koboSpan" id="kobo.462.1">__init__.py</span></strong><span class="koboSpan" id="kobo.463.1"> in the folders, which are to be used </span><span class="No-Break"><span class="koboSpan" id="kobo.464.1">as modules.</span></span></p>
<p><span class="koboSpan" id="kobo.465.1">After that, create a new file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.466.1">run.py</span></strong><span class="koboSpan" id="kobo.467.1"> in the topmost folder. </span><span class="koboSpan" id="kobo.467.2">As its name implies, this file will be used to run </span><span class="No-Break"><span class="koboSpan" id="kobo.468.1">the application.</span></span></p>
<p><span class="koboSpan" id="kobo.469.1">Finally, create separate folders to act </span><span class="No-Break"><span class="koboSpan" id="kobo.470.1">as modules.</span></span></p>
<p><span class="koboSpan" id="kobo.471.1">Refer to the following file structure to get a </span><span class="No-Break"><span class="koboSpan" id="kobo.472.1">better understanding:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.473.1">
flask_app/
    run.py
    my_app/
        __init__.py
        hello/
            __init__.py
            models.py
            views.py</span></pre>
<p><span class="koboSpan" id="kobo.474.1">Let’s see how each </span><a id="_idIndexMarker018"/><span class="koboSpan" id="kobo.475.1">of the preceding files </span><span class="No-Break"><span class="koboSpan" id="kobo.476.1">will look.</span></span></p>
<p><span class="koboSpan" id="kobo.477.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.478.1">flask_app/run.py</span></strong><span class="koboSpan" id="kobo.479.1"> file will look something like the following lines </span><span class="No-Break"><span class="koboSpan" id="kobo.480.1">of code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.481.1">
from my_app import app
app.run(debug=True)</span></pre>
<p><span class="koboSpan" id="kobo.482.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.483.1">flask_app/my_app/__init__.py</span></strong><span class="koboSpan" id="kobo.484.1"> file will look something like the following lines </span><span class="No-Break"><span class="koboSpan" id="kobo.485.1">of code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.486.1">
from flask import Flask
app = Flask(__name__)
import my_app.hello.views</span></pre>
<p><span class="koboSpan" id="kobo.487.1">Next, we have an empty file just to make the enclosing folder a Python </span><span class="No-Break"><span class="koboSpan" id="kobo.488.1">package, </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.489.1">flask_app/my_app/hello/__init__.py</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.490.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.491.1">
# No content.
</span><span class="koboSpan" id="kobo.491.2"># We need this file just to make this folder a python module.</span></pre>
<p><span class="koboSpan" id="kobo.492.1">The models file, </span><strong class="source-inline"><span class="koboSpan" id="kobo.493.1">flask_app/my_app/hello/models.py</span></strong><span class="koboSpan" id="kobo.494.1">, has a non-persistent key-value store, </span><span class="No-Break"><span class="koboSpan" id="kobo.495.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.496.1">
MESSAGES = {
    'default': 'Hello to the World of Flask!',
}</span></pre>
<p><span class="koboSpan" id="kobo.497.1">Finally, the following </span><a id="_idIndexMarker019"/><span class="koboSpan" id="kobo.498.1">is the views file, </span><strong class="source-inline"><span class="koboSpan" id="kobo.499.1">flask_app/my_app/hello/views.py</span></strong><span class="koboSpan" id="kobo.500.1">. </span><span class="koboSpan" id="kobo.500.2">Here, we fetch the message corresponding to the requested key and can also create or update </span><span class="No-Break"><span class="koboSpan" id="kobo.501.1">a message:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.502.1">
from my_app import app
from my_app.hello.models import MESSAGES
@app.route('/')
@app.route('/hello')
def hello_world():
    return MESSAGES['default']
@app.route('/show/&lt;key&gt;')
def get_message(key):
    return MESSAGES.get(key) or "%s not found!" </span><span class="koboSpan" id="kobo.502.2">% key
@app.route('/add/&lt;key&gt;/&lt;message&gt;')
def add_or_update_message(key, message):
    MESSAGES[key] = message
    return "%s A</span><a id="_idTextAnchor063"/><span class="koboSpan" id="kobo.503.1">dded/Updated" % key</span></pre>
<h2 id="_idParaDest-41"><a id="_idTextAnchor064"/><span class="koboSpan" id="kobo.504.1">How it works...</span></h2>
<p><span class="koboSpan" id="kobo.505.1">In this recipe, we have a circular import between </span><strong class="source-inline"><span class="koboSpan" id="kobo.506.1">my_app/__init__.py</span></strong><span class="koboSpan" id="kobo.507.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.508.1">my_app/hello/views.py</span></strong><span class="koboSpan" id="kobo.509.1">, where, in the former, we import </span><strong class="source-inline"><span class="koboSpan" id="kobo.510.1">views</span></strong><span class="koboSpan" id="kobo.511.1"> from the latter, and in the latter, we import </span><strong class="source-inline"><span class="koboSpan" id="kobo.512.1">app</span></strong><span class="koboSpan" id="kobo.513.1"> from the former. </span><span class="koboSpan" id="kobo.513.2">Although this makes the two modules dependent on each other, there is no issue, as we won’t be using views in </span><strong class="source-inline"><span class="koboSpan" id="kobo.514.1">my_app/__init__.py</span></strong><span class="koboSpan" id="kobo.515.1">. </span><span class="koboSpan" id="kobo.515.2">Note that it is best to import the views at the bottom of the file so that they are not </span><a id="_idIndexMarker020"/><span class="koboSpan" id="kobo.516.1">used in this file. </span><span class="koboSpan" id="kobo.516.2">This ensures that when you refer to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.517.1">app</span></strong><span class="koboSpan" id="kobo.518.1"> object inside the view, it does not lead to </span><span class="No-Break"><span class="koboSpan" id="kobo.519.1">null-pointer exceptions.</span></span></p>
<p><span class="koboSpan" id="kobo.520.1">In this recipe, we used a very simple non-persistent in-memory key-value store to demonstrate the model’s layout structure. </span><span class="koboSpan" id="kobo.520.2">We could have written the dictionary for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.521.1">MESSAGES</span></strong><span class="koboSpan" id="kobo.522.1"> hash map in </span><strong class="source-inline"><span class="koboSpan" id="kobo.523.1">views.py</span></strong><span class="koboSpan" id="kobo.524.1"> itself, but it is best practice to keep the model and view </span><span class="No-Break"><span class="koboSpan" id="kobo.525.1">layers separate.</span></span></p>
<p><span class="koboSpan" id="kobo.526.1">So, we can run this app using just </span><strong class="source-inline"><span class="koboSpan" id="kobo.527.1">run.py</span></strong><span class="koboSpan" id="kobo.528.1">, </span><span class="No-Break"><span class="koboSpan" id="kobo.529.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.530.1">
$ python run.py
Serving Flask app "my_app" (lazy loading)
Environment: production
WARNING: Do not use the development server in a production environment.
</span><span class="koboSpan" id="kobo.530.2">Use a production WSGI server instead.
</span><span class="koboSpan" id="kobo.530.3">Debug mode: on
Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
Restarting with stat
Debugger is active!
</span><span class="koboSpan" id="kobo.530.4">* Debugger PIN: 111-111-111</span></pre>
<p class="callout-heading"><span class="koboSpan" id="kobo.531.1">Tip</span></p>
<p class="callout"><span class="koboSpan" id="kobo.532.1">Note the preceding </span><strong class="source-inline"><span class="koboSpan" id="kobo.533.1">WARNING</span></strong><span class="koboSpan" id="kobo.534.1"> in the block. </span><span class="koboSpan" id="kobo.534.2">This warning occurs because we did not specify the application environment, and by default, </span><strong class="source-inline"><span class="koboSpan" id="kobo.535.1">production</span></strong><span class="koboSpan" id="kobo.536.1"> is assumed. </span><span class="koboSpan" id="kobo.536.2">To run the application in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.537.1">development</span></strong><span class="koboSpan" id="kobo.538.1"> environment, modify the </span><strong class="source-inline"><span class="koboSpan" id="kobo.539.1">run.py</span></strong><span class="koboSpan" id="kobo.540.1"> file with </span><span class="No-Break"><span class="koboSpan" id="kobo.541.1">the following:</span></span></p>
<p class="callout"><strong class="source-inline"><span class="koboSpan" id="kobo.542.1">from my_app </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.543.1">import app</span></strong></span></p>
<p class="callout"><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.544.1">app.env="development"</span></strong></span></p>
<p class="callout"><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.545.1">app.run(debug=True)</span></strong></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.546.1">Information</span></p>
<p class="callout"><span class="koboSpan" id="kobo.547.1">The reloader indicates that the application is being run in debug mode and that the application will reload whenever a change is made in </span><span class="No-Break"><span class="koboSpan" id="kobo.548.1">the code.</span></span></p>
<p><span class="koboSpan" id="kobo.549.1">As we can see, we </span><a id="_idIndexMarker021"/><span class="koboSpan" id="kobo.550.1">have already defined a default message in </span><strong class="source-inline"><span class="koboSpan" id="kobo.551.1">MESSAGES</span></strong><span class="koboSpan" id="kobo.552.1">. </span><span class="koboSpan" id="kobo.552.2">We can view that by opening </span><strong class="source-inline"><span class="koboSpan" id="kobo.553.1">http://127.0.0.1:5000/show/default</span></strong><span class="koboSpan" id="kobo.554.1">. </span><span class="koboSpan" id="kobo.554.2">To add a new message, we can type </span><strong class="source-inline"><span class="koboSpan" id="kobo.555.1">http://127.0.0.1:5000/add/great/Flask%20is%20greatgreat!!</span></strong><span class="koboSpan" id="kobo.556.1">. </span><span class="koboSpan" id="kobo.556.2">This will update the </span><strong class="source-inline"><span class="koboSpan" id="kobo.557.1">MESSAGES</span></strong><span class="koboSpan" id="kobo.558.1"> key-value store so that it looks </span><span class="No-Break"><span class="koboSpan" id="kobo.559.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.560.1">
MESSAGES = {
    'default': 'Hello to the World of Flask!',
    'great': 'Flask is great!!',
}</span></pre>
<p><span class="koboSpan" id="kobo.561.1">Now, if we open </span><strong class="source-inline"><span class="koboSpan" id="kobo.562.1">http://127.0.0.1:5000/show/great</span></strong><span class="koboSpan" id="kobo.563.1"> in a browser, we will see our message, which would have otherwise appeared as</span><a id="_idTextAnchor065"/><span class="koboSpan" id="kobo.564.1"> a not </span><span class="No-Break"><span class="koboSpan" id="kobo.565.1">found message.</span></span></p>
<h2 id="_idParaDest-42"><a id="_idTextAnchor066"/><span class="koboSpan" id="kobo.566.1">See also</span></h2>
<p><span class="koboSpan" id="kobo.567.1">The next recipe, </span><em class="italic"><span class="koboSpan" id="kobo.568.1">Creating a modular web app with blueprints</span></em><span class="koboSpan" id="kobo.569.1">, provides a much better way of organizing your Flask applications and is a ready-made solution </span><a id="_idTextAnchor067"/><span class="koboSpan" id="kobo.570.1">for </span><span class="No-Break"><span class="koboSpan" id="kobo.571.1">circular imports.</span></span></p>
<h1 id="_idParaDest-43"><a id="_idTextAnchor068"/><span class="koboSpan" id="kobo.572.1">Creating a modular web app with blueprints</span></h1>
<p><span class="koboSpan" id="kobo.573.1">A </span><strong class="bold"><span class="koboSpan" id="kobo.574.1">blueprint</span></strong><span class="koboSpan" id="kobo.575.1"> is a feature in Flask that helps make large applications modular. </span><span class="koboSpan" id="kobo.575.2">This keeps application dispatching </span><a id="_idIndexMarker022"/><span class="koboSpan" id="kobo.576.1">simple by providing a central place to register all components </span><a id="_idIndexMarker023"/><span class="koboSpan" id="kobo.577.1">in an application. </span><span class="koboSpan" id="kobo.577.2">A blueprint looks </span><a id="_idIndexMarker024"/><span class="koboSpan" id="kobo.578.1">like an application object but is not an application. </span><span class="koboSpan" id="kobo.578.2">It also looks like a pluggable app or a smaller part of a bigger app, but it is not. </span><span class="koboSpan" id="kobo.578.3">A blueprint is a set of operations that can be registered on an application and represents how to construct or build an application. </span><span class="koboSpan" id="kobo.578.4">Another benefit is that it allows us to create reusable components betwee</span><a id="_idTextAnchor069"/><span class="koboSpan" id="kobo.579.1">n </span><span class="No-Break"><span class="koboSpan" id="kobo.580.1">multiple applications.</span></span></p>
<h2 id="_idParaDest-44"><a id="_idTextAnchor070"/><span class="koboSpan" id="kobo.581.1">Getting ready</span></h2>
<p><span class="koboSpan" id="kobo.582.1">In this recipe, we’ll take the application from the previous recipe, </span><em class="italic"><span class="koboSpan" id="kobo.583.1">Composition of views and models</span></em><span class="koboSpan" id="kobo.584.1">, as a reference and modify it so that it</span><a id="_idTextAnchor071"/><span class="koboSpan" id="kobo.585.1"> works </span><span class="No-Break"><span class="koboSpan" id="kobo.586.1">using blueprints.</span></span></p>
<h2 id="_idParaDest-45"><a id="_idTextAnchor072"/><span class="koboSpan" id="kobo.587.1">How to do it...</span></h2>
<p><span class="koboSpan" id="kobo.588.1">The following is an example of a simple </span><em class="italic"><span class="koboSpan" id="kobo.589.1">Hello World</span></em><span class="koboSpan" id="kobo.590.1"> application using </span><strong class="source-inline"><span class="koboSpan" id="kobo.591.1">Blueprint</span></strong><span class="koboSpan" id="kobo.592.1">. </span><span class="koboSpan" id="kobo.592.2">It will work like it did in the previous recipe but will be much more modular </span><span class="No-Break"><span class="koboSpan" id="kobo.593.1">and extensible.</span></span></p>
<p><span class="koboSpan" id="kobo.594.1">First, we will start with the following </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.595.1">flask_app/my_app/__init__.py</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.596.1"> file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.597.1">
from flask import Flask
from my_app.hello.views import hello
app = Flask(__name__)
app.register_blueprint(hello)</span></pre>
<p><span class="koboSpan" id="kobo.598.1">Next, we will add some code to the views file, </span><strong class="source-inline"><span class="koboSpan" id="kobo.599.1">my_app/hello/views.py</span></strong><span class="koboSpan" id="kobo.600.1">, which should look </span><span class="No-Break"><span class="koboSpan" id="kobo.601.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.602.1">
from flask import Blueprint
from my_app.hello.models import MESSAGES
hello = Blueprint('hello', __name__)
@hello.route('/')
@hello.route('/hello')
def hello_world():
    return MESSAGES['default']
@hello.route('/show/&lt;key&gt;')
def get_message(key):
    return MESSAGES.get(key) or "%s not found!" </span><span class="koboSpan" id="kobo.602.2">% key
@hello.route('/add/&lt;key&gt;/&lt;message&gt;')
def add_or_update_message(key, message):
    MESSAGES[key] = message
    return "%s Added/Updated" % key</span></pre>
<p><span class="koboSpan" id="kobo.603.1">We have </span><a id="_idIndexMarker025"/><span class="koboSpan" id="kobo.604.1">now defined a blueprint in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.605.1">flask_app/my_app/hello/views.py</span></strong><span class="koboSpan" id="kobo.606.1"> file. </span><span class="koboSpan" id="kobo.606.2">We no longer need the application </span><a id="_idIndexMarker026"/><span class="koboSpan" id="kobo.607.1">object in this file, and our complete routing is defined on a blueprint named </span><strong class="source-inline"><span class="koboSpan" id="kobo.608.1">hello</span></strong><span class="koboSpan" id="kobo.609.1">. </span><span class="koboSpan" id="kobo.609.2">Instead of </span><strong class="source-inline"><span class="koboSpan" id="kobo.610.1">@app.route</span></strong><span class="koboSpan" id="kobo.611.1">, we use </span><strong class="source-inline"><span class="koboSpan" id="kobo.612.1">@hello.route</span></strong><span class="koboSpan" id="kobo.613.1">. </span><span class="koboSpan" id="kobo.613.2">The same blueprint is imported into </span><strong class="source-inline"><span class="koboSpan" id="kobo.614.1">flask_app/my_app/__init__.py</span></strong><span class="koboSpan" id="kobo.615.1"> and registered on the </span><span class="No-Break"><span class="koboSpan" id="kobo.616.1">application object.</span></span></p>
<p><span class="koboSpan" id="kobo.617.1">We can create any number of blueprints in our application and complete most of the activities that we would usually do, such as providing different template paths or different static paths. </span><span class="koboSpan" id="kobo.617.2">We can even have different URL prefixes or subd</span><a id="_idTextAnchor073"/><span class="koboSpan" id="kobo.618.1">omains for </span><span class="No-Break"><span class="koboSpan" id="kobo.619.1">our blueprints.</span></span></p>
<h2 id="_idParaDest-46"><a id="_idTextAnchor074"/><span class="koboSpan" id="kobo.620.1">How it works...</span></h2>
<p><span class="koboSpan" id="kobo.621.1">This application </span><a id="_idIndexMarker027"/><span class="koboSpan" id="kobo.622.1">will work in just the same way as the </span><a id="_idIndexMarker028"/><span class="koboSpan" id="kobo.623.1">last application. </span><span class="koboSpan" id="kobo.623.2">The only difference is in th</span><a id="_idTextAnchor075"/><span class="koboSpan" id="kobo.624.1">e way the code </span><span class="No-Break"><span class="koboSpan" id="kobo.625.1">is organized.</span></span></p>
<h1 id="_idParaDest-47"><a id="_idTextAnchor076"/><span class="koboSpan" id="kobo.626.1">Making a Flask app installable using setuptools</span></h1>
<p><span class="koboSpan" id="kobo.627.1">We now have a Flask app, but how do we install it like any </span><strong class="bold"><span class="koboSpan" id="kobo.628.1">Python package</span></strong><span class="koboSpan" id="kobo.629.1">? </span><span class="koboSpan" id="kobo.629.2">It is possible that </span><a id="_idIndexMarker029"/><span class="koboSpan" id="kobo.630.1">another application might depend </span><a id="_idIndexMarker030"/><span class="koboSpan" id="kobo.631.1">on our application, or that our application is an extension of Flask and would need to be installed in a Python environment so it can be used by other applications. </span><span class="koboSpan" id="kobo.631.2">In this recipe, we will see how </span><strong class="source-inline"><span class="koboSpan" id="kobo.632.1">setuptools</span></strong><span class="koboSpan" id="kobo.633.1"> can be used to create an installable </span><span class="No-Break"><span class="koboSpan" id="kobo.634.1">Python package.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.635.1">What is a Python package?</span></p>
<p class="callout"><span class="koboSpan" id="kobo.636.1">A Python package can simply be thought </span><a id="_idIndexMarker031"/><span class="koboSpan" id="kobo.637.1">of as a program that can be imported using Python’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.638.1">import</span></strong><span class="koboSpan" id="kobo.639.1"> statement in a virtual environment or globally b</span><a id="_idTextAnchor077"/><span class="koboSpan" id="kobo.640.1">ased on its </span><span class="No-Break"><span class="koboSpan" id="kobo.641.1">installation scope.</span></span></p>
<h2 id="_idParaDest-48"><a id="_idTextAnchor078"/><span class="koboSpan" id="kobo.642.1">How to do it...</span></h2>
<p><span class="koboSpan" id="kobo.643.1">Installing a Flask app can be easily achieved using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.644.1">setuptools</span></strong><span class="koboSpan" id="kobo.645.1"> Python library. </span><span class="koboSpan" id="kobo.645.2">To achieve this, create a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.646.1">setup.py</span></strong><span class="koboSpan" id="kobo.647.1"> in your application’s folder and configure it to run a setup script for the application. </span><span class="koboSpan" id="kobo.647.2">This will take care of any dependencies, descriptions, loading test packages, and </span><span class="No-Break"><span class="koboSpan" id="kobo.648.1">so on.</span></span></p>
<p><span class="koboSpan" id="kobo.649.1">The following is an example of a </span><a id="_idIndexMarker032"/><span class="koboSpan" id="kobo.650.1">simple </span><strong class="source-inline"><span class="koboSpan" id="kobo.651.1">setup.py</span></strong><span class="koboSpan" id="kobo.652.1"> script for the </span><em class="italic"><span class="koboSpan" id="kobo.653.1">Hello World</span></em><span class="koboSpan" id="kobo.654.1"> application </span><a id="_idIndexMarker033"/><span class="koboSpan" id="kobo.655.1">from the </span><span class="No-Break"><span class="koboSpan" id="kobo.656.1">previous recipe:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.657.1">
#!/usr/bin/env python
# -*- coding: UTF-8 -*-
import os
from setuptools import setup
setup(
    name = 'my_app',
    version='1.0',
    license='GNU General Public License v3',
    author='Shalabh Aggarwal',
    author_email='contact@shalabhaggarwal.com',
    description='Hello world application for Flask',
    packages=['my_app'],
    platforms='any',
    install_requires=[
        'Flask',
    ],
    classifiers=[
        'Development Status :: 4 - Beta',
        'Environment :: Web Environment',
        'Intended Audience :: Developers',
        'License :: OSI Approved :: GNU General Public
          License v3',
        'Operating System :: OS Independent',
        'Programming Language :: Python',
        'Topic :: Internet :: WWW/HTTP :: Dynamic Content',
        'Topic :: Software Development :: Libraries </span><a id="_idTextAnchor079"/><span class="koboSpan" id="kobo.658.1">::
          Python Modules'
],
)</span></pre>
<h2 id="_idParaDest-49"><a id="_idTextAnchor080"/><span class="koboSpan" id="kobo.659.1">How it works...</span></h2>
<p><span class="koboSpan" id="kobo.660.1">In the preceding script, most of the configuration is self-explanatory. </span><span class="koboSpan" id="kobo.660.2">The classifiers are used when the application is made available on </span><strong class="bold"><span class="koboSpan" id="kobo.661.1">PyPI</span></strong><span class="koboSpan" id="kobo.662.1">. </span><span class="koboSpan" id="kobo.662.2">These will help other users search the application using the </span><span class="No-Break"><span class="koboSpan" id="kobo.663.1">relevant classifiers.</span></span></p>
<p><span class="koboSpan" id="kobo.664.1">Now, we can run this file with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.665.1">install</span></strong><span class="koboSpan" id="kobo.666.1"> keyword, </span><span class="No-Break"><span class="koboSpan" id="kobo.667.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.668.1">
$ python setup.py install</span></pre>
<p><span class="koboSpan" id="kobo.669.1">The preceding </span><a id="_idIndexMarker034"/><span class="koboSpan" id="kobo.670.1">command will install the application </span><a id="_idIndexMarker035"/><span class="koboSpan" id="kobo.671.1">along with all the dependencies mentioned in </span><strong class="source-inline"><span class="koboSpan" id="kobo.672.1">install_requires</span></strong><span class="koboSpan" id="kobo.673.1"> – that is, Flask and all of Flask’s dependencies. </span><span class="koboSpan" id="kobo.673.2">Now, the app can be used just like any Python package in a </span><span class="No-Break"><span class="koboSpan" id="kobo.674.1">Python environment.</span></span></p>
<p><span class="koboSpan" id="kobo.675.1">To verify the successful installation of your package, import it inside a </span><span class="No-Break"><span class="koboSpan" id="kobo.676.1">Python environment:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.677.1">
$ python
Python 3.8.13 (default, May  8 20</span><a id="_idTextAnchor081"/><span class="koboSpan" id="kobo.678.1">22, 17:52:27)
&gt;&gt;&gt; import my_app
&gt;&gt;&gt;</span></pre>
<h2 id="_idParaDest-50"><a id="_idTextAnchor082"/><span class="koboSpan" id="kobo.679.1">See also</span></h2>
<p><span class="koboSpan" id="kobo.680.1">The list of valid trove classifiers can be found </span><span class="No-Break"><span class="koboSpan" id="kobo.681.1">at </span></span><a href="https://pypi.python.org/pypi?%3Aaction=list_classifiers"><span class="No-Break"><span class="koboSpan" id="kobo.682.1">https://pypi.python.org/pypi?%3Aaction=list_classifiers</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.683.1">.</span></span></p>
</div>
</body></html>