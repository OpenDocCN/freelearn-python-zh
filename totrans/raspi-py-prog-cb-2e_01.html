<html><head></head><body><div class="chapter" title="Chapter&#xA0;1.&#xA0;Getting Started with a Raspberry Pi Computer"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Getting Started with a Raspberry Pi Computer</h1></div></div></div><p>In this chapter, we will cover the following recipes:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Connecting the Raspberry Pi</li><li class="listitem" style="list-style-type: disc">Using NOOBS to set up your Raspberry Pi SD card</li><li class="listitem" style="list-style-type: disc">Networking and connecting your Raspberry Pi to the Internet via the LAN connector</li><li class="listitem" style="list-style-type: disc">Using built-in Wi-Fi and Bluetooth on the Raspberry Pi</li><li class="listitem" style="list-style-type: disc">Configuring your network manually</li><li class="listitem" style="list-style-type: disc">Networking directly to a laptop or computer</li><li class="listitem" style="list-style-type: disc">Networking and connecting your Raspberry Pi to the Internet via a USB Wi-Fi dongle</li><li class="listitem" style="list-style-type: disc">Connecting to the Internet through a proxy server</li><li class="listitem" style="list-style-type: disc">Connecting remotely to the Raspberry Pi over the network using VNC</li><li class="listitem" style="list-style-type: disc">Connecting remotely to the Raspberry Pi over the network using SSH (and X11 Forwarding)</li><li class="listitem" style="list-style-type: disc">Sharing the home folder of the Raspberry Pi with SMB</li><li class="listitem" style="list-style-type: disc">Keeping the Raspberry Pi up to date</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Introduction</h1></div></div></div><p>This chapter introduces the Raspberry Pi and the process to set it up for the first time. We will connect the Raspberry Pi to a suitable display, power, and peripherals. We will install an operating system on an SD card. This is required for the system to boot. Next, we will ensure that we can connect successfully to the Internet through a local network.</p><p>Finally, we will make use of the network to provide ways to remotely connect to and/or control the Raspberry Pi from other computers and devices, as well as to ensure that the system is kept up to date.</p><p>Once you have completed the steps within this chapter, your Raspberry Pi will be ready for you to use for programming. If you already have your Raspberry Pi set up and running, ensure that you take a look through the following sections as there are many helpful tips.</p><div class="section" title="Introducing the Raspberry Pi"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl3sec01"/>Introducing the Raspberry Pi</h2></div></div></div><p>The<a class="indexterm" id="id0"/> Raspberry Pi is a single-board computer created by the <a class="indexterm" id="id1"/>
<span class="strong"><strong>Raspberry Pi Foundation</strong></span>, a charity formed with the primary purpose of reintroducing low-level computer skills to children in the UK. The aim was to rekindle the microcomputer revolution of the 1980s, which produced a whole generation of skilled programmers.</p><p>Even before the computer was released at the end of February 2012, it was clear that the Raspberry Pi had gained a huge following worldwide and, at the time of writing this book, has sold over 10 million units. The following image shows several different Raspberry Pi Models:</p><div class="mediaobject"><img alt="Introducing the Raspberry Pi" src="graphics/6623OT_01_001.jpg"/><div class="caption"><p>Raspberry Pi Model 3B, Model A+, and Pi Zero</p></div></div></div><div class="section" title="What is with the name?"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl3sec02"/>What is with the name?</h2></div></div></div><p>The name, Raspberry Pi, was the <a class="indexterm" id="id2"/>combination of the desire to create an alternative fruit-based computer (such as Apple, BlackBerry, and Apricot) and a nod to the original concept of a simple computer that can be programmed using <span class="strong"><strong>Python</strong></span> (shortened to <span class="strong"><strong>Pi</strong></span>).</p><p>In this book, we will take this little computer, find out how to set it up, and then explore its capabilities chapter by chapter using the Python programming language.</p></div><div class="section" title="Why Python?"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl3sec03"/>Why Python?</h2></div></div></div><p>It is often asked, "Why has <a class="indexterm" id="id3"/>Python been selected as the language to use on the Raspberry Pi?" The fact is that Python is just one of the many programming languages that can be used on the Raspberry Pi.</p><p>There are many programming languages that you can choose, from high-level graphical block programming, such as <span class="strong"><strong>Scratch</strong></span>, to<a class="indexterm" id="id4"/> traditional <span class="strong"><strong>C</strong></span>, right down to <a class="indexterm" id="id5"/>
<span class="strong"><strong>BASIC</strong></span>, and even raw <a class="indexterm" id="id6"/>
<span class="strong"><strong>Machine Code Assembler</strong></span>. A good programmer often has to be code multilingual to be able to play to the strengths and weaknesses of each language in order to best meet the needs of their desired application. It is useful to understand how different languages (and programming techniques) try to overcome the challenge of converting "what you want" into "what you get" as this is what you are trying to do as well while you program.</p><p>Python <a class="indexterm" id="id7"/>has been selected as a good place to start when learning about programming, by providing a rich set of coding tools while still allowing simple programs to be written without fuss. This allows beginners to gradually be introduced to the concepts and methods on which modern programming languages are based without requiring them to know it all from the start. It is very modular with lots of additional libraries that can be imported to quickly extend the functionality. You will find that over time, this encourages you to do the same, and you will want to create your own modules that you can plug into your own programs, thus taking your first steps into structured programming.</p><p>Like all programming languages, Python isn't perfect; things such as adding a space at the start of a line will often break your code (indents matter a lot in Python; they define how blocks of code are grouped together). Generally, Python is slow; since it is interpreted, it takes time to create a module while it is running the program. This can be a problem if you need to respond to time critical events. However, you can precompile Python or use modules written in other languages to overcome this. It hides the details; this is both an advantage and disadvantage. It is excellent for beginners but can be difficult when you have to second-guess aspects such as data-types. However, this in turn forces you to consider all the possibilities, which can be a good thing.</p></div><div class="section" title="Python 2 and Python 3"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl3sec04"/>Python 2 and Python 3</h2></div></div></div><p>A massive source <a class="indexterm" id="id8"/>of confusion for beginners is that there are two versions of Python on the Raspberry Pi (<span class="strong"><strong>Version 2.7</strong></span> and <span class="strong"><strong>Version 3.4</strong></span>), which are not compatible with one another, so code written for Python 2.7 may not run with Python 3.4 (and vice versa).</p><p>The <span class="strong"><strong>Python Software Foundation</strong></span>
<a class="indexterm" id="id9"/> is continuously working to improve and move forward with the language, which sometimes means they have to sacrifice backward compatibility in order to embrace new improvements (and importantly, remove redundant and legacy ways of doing things).</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note02"/>Note</h3><p>
<span class="strong"><strong>Supporting both Python 2 or Python 3</strong></span>
</p><p>There are <a class="indexterm" id="id10"/>many tools that will ease the transition from Python 2 to Python 3, including converters such as <code class="literal">2to3</code>, which will parse and update your code to use Python 3 methods. This process is not perfect, and in some cases, you'll need to manually rewrite sections and fully retest everything. You can write the code and libraries that will support both. The <code class="literal">import __future__</code> statement allows you to import the friendly methods of Python 3 and run them using Python 2.7.</p></div></div></div><div class="section" title="Which version of Python should you use?"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl3sec05"/>Which version of Python should you use?</h2></div></div></div><p>Essentially, the selection of <a class="indexterm" id="id11"/>which version to use will depend on what you intend to do. For instance, you may require Python 2.7 libraries, which are not yet available for Python 3.4. Python 3 has been available since 2008, so these tend to be older or larger libraries that have not been translated. In many cases, there are new alternatives to legacy libraries; however, their support can vary.</p><p>In this book, we have used Python 3.4, which is also compatible with Python 3.3 and 3.2.</p></div><div class="section" title="The Raspberry Pi family – a brief history of Pi"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl3sec06"/>The Raspberry Pi family – a brief history of Pi</h2></div></div></div><p>Since its release, the<a class="indexterm" id="id12"/> Raspberry Pi has come in various iterations, featuring both small and large updates and improvements to the original Raspberry Pi Model B unit. Although it can be confusing at first, there are three basic types of Raspberry Pi available (and one special model).</p><p>The main flagship model is called <span class="strong"><strong>Model B</strong></span>
<a class="indexterm" id="id13"/>. This has all the connections and features, as well as the maximum RAM and the latest processor. Over the years, there have been several versions, most notably Model B (which had 256 MB and then 512 MB RAM) and then Model B+ (which increased the 26-pin GPIO to 40 pins, switched to using a micro SD card slot, and had four USB ports instead of two). These original models all used the Broadcom BCM2835 SOC (short for System On Chip), consisting of a single core 700 MHz ARM11 and VideoCore IV GPU (short for Graphical Processing Unit).</p><p>The release of the<a class="indexterm" id="id14"/> Raspberry Pi 2 Model B (also referred to as 2B) in 2015 introduced a new Broadcom BCM2836 SOC, providing a quad-core 32-bit ARM Cortex A7 1.2 GHz processor and GPU, with 1 GB of RAM. The improved SOC added support for Ubuntu and Windows 10 IoT. Finally we had the latest Raspberry Pi 3 Model B, using another new Broadcom BCM2837 SOC, which provides a quad-core 64-bit ARM Cortex-A53 and GPU, alongside adding on-board Wi-Fi and Bluetooth.</p><p>
<span class="strong"><strong>Model A</strong></span>
<a class="indexterm" id="id15"/> has always been targeted as a cut-down version. While having the same SOC as Model B, there are limited connections consisting of a single USB port and no wired network (LAN). Model A+ again added more GPIO pins and a micro SD slot. However, the RAM was later upgraded to 512 MB of RAM and again only a single USB port/no LAN. The Broadcom BCM2835 SOC on Model A has not been updated so far (so is still a single core ARM11); however, a Model 3A (most likely using the BCM2837) is expected 2016/2017.</p><p>The <span class="strong"><strong>Pi Zero</strong></span> is an <a class="indexterm" id="id16"/>ultra-compact version of the Raspberry Pi intended for embedded applications where cost and space are a premium. It has the same 40-pin GPIO and micro SD card slot as the other models, but lacks the on-board display (CSI and DSI) connection. It does still have HDMI (via a mini-HDMI) and a single micro USB OTG (on-the-go) connection. Although not present in the first revision of the Pi Zero, the most recent model also includes a CSI connection for the on-board camera.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>The Pi Zero was famously released in 2015 by being given away with the Raspberry Pi foundations magazine The MagPi, giving the magazine the kudos of being the first magazine to give away a computer on its cover! This did make me rather proud since (as you may have read in my biography at the start of this book) I was one of the founders of the magazine.</p></div></div><p>The special model is known as the <a class="indexterm" id="id17"/>
<span class="strong"><strong>compute module</strong></span>. This takes the form of a 200-pin SO-DIMM card. It is intended for industrial use or within commercial products, where all the external interfaces would be provided by a host/motherboard, into which the module would be inserted. Example products include the Slice media player (<a class="ulink" href="http://fiveninjas.com">http://fiveninjas.com</a>) and the Otto camera. The current module uses the BCM2835, although an updated compute module (CM3) is expected in 2016.</p><p>The Raspberry Pi Wikipedia page<a class="indexterm" id="id18"/> provides a full list of the all different variants and their specifications:</p><p>
<a class="ulink" href="https://en.wikipedia.org/wiki/Raspberry_Pi#Specifications">https://en.wikipedia.org/wiki/Raspberry_Pi#Specifications</a>
</p></div><div class="section" title="Which Pi to choose?"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl3sec07"/>Which Pi to choose?</h2></div></div></div><p>All sections of this book are <a class="indexterm" id="id19"/>compatible will all current versions of the Raspberry Pi, but Model 3B is recommended as the best model to start with. This offers the best performance (particularly useful for the GPU examples in <a class="link" href="ch05.html" title="Chapter 5. Creating 3D Graphics">Chapter 5</a>, <span class="emphasis"><em>Creating 3D Graphics</em></span>, and the OpenCV examples used in Chapter 8, Creating Projects with the Raspberry Pi Camera Module), lots of connections, and built-in Wi-Fi, which can be very convenient.</p><p>The Pi Zero<a class="indexterm" id="id20"/> is recommended for projects where you want low power usage or reduced weight/size but do not need the full processing power of Model 3B. However, due to its ultra-low cost, the Pi Zero is ideal for deploying a completed project after you have developed it.</p></div></div></div>
<div class="section" title="Connecting the Raspberry Pi"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Connecting the Raspberry Pi</h1></div></div></div><p>There are many ways to wire up the <a class="indexterm" id="id21"/>Raspberry Pi and use the various interfaces to view and control content. For typical use, most users will require power, display (with audio), and a method of input such as keyboard and mouse. To access the Internet, refer to the <span class="emphasis"><em>Networking and connecting your Raspberry Pi to the Internet via the LAN connector</em></span> or <span class="emphasis"><em>Using built-in Wi-Fi and Bluetooth on the Raspberry Pi </em></span>recipes.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec12"/>Getting ready</h2></div></div></div><p>Before you can use your Raspberry Pi, you will need an SD card with an operating system installed or with the <span class="strong"><strong>New Out Of Box System</strong></span> (<span class="strong"><strong>NOOBS</strong></span>)<a class="indexterm" id="id22"/> on it, as discussed in the <span class="emphasis"><em>Using NOOBS to set up your Raspberry Pi SD card</em></span> recipe.</p><p>The following section will detail the types of devices you can connect to the Raspberry Pi and, importantly, how and where to plug them in.</p><p>As you will discover later, once you have your Raspberry Pi set up, you may decide to connect remotely and use it through a network link, in which case you only need power and a network connection. Refer to the following sections: <span class="emphasis"><em>Connecting remotely to the Raspberry Pi over the network using VNC</em></span> and <span class="emphasis"><em>Connecting remotely to the Raspberry Pi over the network using SSH (and X11 Forwarding)</em></span>.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec13"/>How to do it…</h2></div></div></div><p>The layout of the Raspberry Pi <a class="indexterm" id="id23"/>is shown in the following figure:</p><div class="mediaobject"><img alt="How to do it…" src="graphics/6623OT_01_002.jpg"/><div class="caption"><p>The Raspberry Pi connection layout (Model 3 B, Model A+, and Pi Zero)</p></div></div><p>The description of the<a class="indexterm" id="id24"/> preceding figure is as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Display</strong></span>: The Raspberry Pi<a class="indexterm" id="id25"/> supports the following three main display connections; if both HDMI and Composite video are connected, it will default to HDMI only.<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>HDMI</strong></span><p>For best results, <a class="indexterm" id="id26"/>use a TV or monitor that has an HDMI connection, thus allowing the best resolution display (1080p) and also digital audio output. If your display has a DVI connection, you may be able to use an adapter to connect through the HDMI. There are several types of DVI connections; some support analogue (DVI-A), some digital (DVI-D), and some both (DVI-I). The Raspberry Pi is only able to provide a digital signal through the HDMI, so an HDMI-to-DVI-D adapter is recommended (shown with a tick mark in the following screenshot). This<a class="indexterm" id="id27"/> lacks the four extra analogue pins (shown with a cross mark in the following screenshot), thus allowing it to fit <a class="indexterm" id="id28"/>into both DVI-D and DVI-I type sockets:</p><div class="mediaobject"><img alt="How to do it…" src="graphics/6623OT_01_003.jpg"/><div class="caption"><p>HDMI-to-DVI connection (DVI-D adaptor)</p></div></div><p>If you wish to use an older monitor (with a VGA connection), an additional HDMI-to-VGA converter is required. The Raspberry Pi also supports a rudimentary VGA adaptor (VGA Gert666 Adaptor), which is driven directly off of the GPIO pins. However, this does use up all but 4 pins of the 40-pin header (older 26-pin models will not support the VGA output).</p></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Analogue</strong></span><p>An alternative display<a class="indexterm" id="id29"/> method is to use the analogue composite video connection (via the phono socket); this can also be attached to an S-Video or European SCART adapter. However, the analogue video output has a maximum resolution of 640 x 480 pixels, so it is not ideal for general use.</p><div class="mediaobject"><img alt="How to do it…" src="graphics/6623OT_01_004.jpg"/><div class="caption"><p>3.5mm phono analogue connections</p></div></div></li><li class="listitem" style="list-style-type: disc">When using the <a class="indexterm" id="id30"/>RCA connection or a DVI input, audio has to be provided separately by the analogue audio connection. To <a class="indexterm" id="id31"/>simplify the manufacturing process (by avoiding through-hole components), the Pi Zero does not have analogue audio or an RCA socket for analogue video (although they can be added with some modifications).<p>
<span class="strong"><strong>Direct Display DSI</strong></span>
</p><p>A touch display <a class="indexterm" id="id32"/>produced by the Raspberry Pi Foundation will connect directly into the DSI socket. This can be connected and used at the same time as the HDMI or analogue video output to create a dual display setup.</p></li></ul></div></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Stereo Analogue Audio (all except Pi Zero)</strong></span>: This provides an analogue audio output for headphones or amplified<a class="indexterm" id="id33"/> speakers. The audio can be switched via the Raspberry Pi configuration tool on the desktop between analog (Stereo Socket) and digital (HDMI), or via the command line using <code class="literal">amixer</code> or <code class="literal">alsamixer</code>.<div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note04"/>Note</h3><p>To find out more information about a particular command in the terminal, you can use the following <code class="literal">man</code> command before the terminal reads the manual (most commands should have one):</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>man amixer</strong></span>
</pre></div><p>Some commands also support the <code class="literal">--help</code> option for more concise help, shown as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>amixer --help</strong></span>
</pre></div></div></div></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Network (excluding models A and Pi Zero)</strong></span>: The network connection is discussed in the <span class="emphasis"><em>Networking and connecting your Raspberry Pi to the Internet via the LAN connector</em></span> <a class="indexterm" id="id34"/>recipe<a class="indexterm" id="id35"/> later in this chapter. If we use the Model A Raspberry Pi, it is possible to add a USB network adapter to add wired or even wireless networking (refer to the <span class="emphasis"><em>Networking and connecting your Raspberry Pi to the Internet via a USB Wi-Fi dongle</em></span> recipe).</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Onboard Wi-Fi and Bluetooth (Model 3 B only):</strong></span></li><li class="listitem" style="list-style-type: disc">The Model 3 B has built-in 802.11n<a class="indexterm" id="id36"/> Wi-Fi and Bluetooth 4.1; see the <span class="emphasis"><em>Using the built-in Wi-Fi and Bluetooth on the Raspberry Pi</em></span> recipe.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>USB (x1 Model A/Zero, x2 Model 1 B, x4 Model 2 B and 3 B)—using a keyboard and mouse:</strong></span><p>The Raspberry Pi should <a class="indexterm" id="id37"/>work with most USB keyboards and mice available. You can also use wireless mice and keyboards, which use RF Dongles. However, additional configuration is required for items that use the Bluetooth dongles.</p><p>If there is a lack of power supplied by your power supply or the devices are drawing too much current, you may experience the keyboard keys appearing to stick, and in severe cases, corruption of the SD card.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note06"/>Note</h3><p>USB power can be more of an issue with the early Model B revision 1 boards that were available prior to October 2012. They included additional <span class="strong"><strong>Polyfuses</strong></span>
<a class="indexterm" id="id38"/> on the USB output and tripped if an excess of 140 mA was drawn. The Polyfuses can take several hours or days to recover completely, thus causing unpredictable behavior to remain even when the power is improved.</p><p>You can identify a revision 1 board as it lacks the four mounting holes that are present the later models.</p></div></div><p>Debian Linux (upon which Raspbian is based) supports many common USB devices, such as flash storage drives, hard disk drives (external power may be required), cameras, printers, Bluetooth, and Wi-Fi adapters. Some devices will be detected automatically while others will require drivers to be installed.</p></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Micro USB Power</strong></span>: The<a class="indexterm" id="id39"/> Raspberry Pi requires a 5V power supply that can comfortably supply at least 1000 mA (1,500 mA or more is recommended, <a class="indexterm" id="id40"/>particularly with the more power-hungry Model 2 and 3) with a micro USB connection. It is possible to power the unit using portable battery packs, such as the ones suitable for powering or recharging tablets. Again, ensure that they can supply 5V at 1000 mA or over.</li></ul></div><p>You should aim to make all other connections to the Raspberry Pi before connecting the power. However, USB devices, audio, and network may be connected and removed while it is running without problems.</p></div><div class="section" title="There's more…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec14"/>There's more…</h2></div></div></div><p>In addition to the standard primary connections you would expect to see on a computer, the Raspberry Pi also has a number of other connections.</p><div class="section" title="Secondary hardware connections"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec08"/>Secondary hardware connections</h3></div></div></div><p>Each of the following <a class="indexterm" id="id41"/>connections provides additional interfaces for the Raspberry Pi:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>20 x 2 GPIO pin header (Model A+, B+, 2 B, 3 B, and Pi Zero)</strong></span>: This is the main 40-pin GPIO header<a class="indexterm" id="id42"/> of the Raspberry <a class="indexterm" id="id43"/>Pi used for interfacing directly with hardware components. We use this connection in Chapters 6, 7, 9, and 10. The recipes in this book are also compatible with older models of the Raspberry Pi that have a 13 x 2 GPIO pin header.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>P5 8 x 2 GPIO pin header (Model 1 B revision 2.0 only)</strong></span>: We do<a class="indexterm" id="id44"/> not use this in the book.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Reset connection</strong></span>: This is <a class="indexterm" id="id45"/>present on later models (no pins fitted). A reset is triggered when Pin 1 (reset) and Pin 2 (GND) are connected together. We use this in the <span class="emphasis"><em>A controlled shutdown button</em></span> recipe in <a class="link" href="ch06.html" title="Chapter 6. Using Python to Drive Hardware">Chapter 6</a>, <span class="emphasis"><em>Using Python to Drive Hardware</em></span>.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>GPU/LAN JTAG</strong></span>: The<a class="indexterm" id="id46"/> <span class="strong"><strong>Joint Test Action Group</strong></span> (<span class="strong"><strong>JTAG</strong></span>) is a programming and debugging interface <a class="indexterm" id="id47"/>used to configure and test processors. These are present on newer models as surface pads. A specialist JTAG device is required to use this interface. We do not use this in the book.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Direct camera CSI</strong></span>: This <a class="indexterm" id="id48"/>connection supports the Raspberry Pi Camera module (as used in <a class="link" href="ch08.html" title="Chapter 8. Creating Projects with the Raspberry Pi Camera Module">Chapter 8</a>, <span class="emphasis"><em>Creating Projects with the Raspberry Pi Camera Module</em></span>). Note that the Pi Zero has a smaller CSI connector than the other models, so it requires a different ribbon connector.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Direct display DSI</strong></span>: This <a class="indexterm" id="id49"/>connection supports a directly connected display, a 7-inch 800 x 600 capacitive touch screen.</li></ul></div></div></div></div>
<div class="section" title="Using NOOBS to set up your Raspberry Pi SD card"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Using NOOBS to set up your Raspberry Pi SD card</h1></div></div></div><p>The Raspberry Pi<a class="indexterm" id="id50"/> requires the operating system to be <a class="indexterm" id="id51"/>loaded onto an SD card before it starts up. The easiest way to set up the SD card is to use <span class="strong"><strong>NOOBS</strong></span>; you may find that you can buy an SD card with NOOBS already loaded on it.</p><p>NOOBS provides an initial start menu that provides options to install several of the available operating systems onto your SD card.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec15"/>Getting ready</h2></div></div></div><p>Since NOOBS creates a <span class="strong"><strong>RECOVERY</strong></span> partition<a class="indexterm" id="id52"/> to keep the original installation images, an 8-GB SD card or larger is recommended. You will also need an SD card reader (experience has shown that some built-in card readers can cause issues, so an external USB type reader is recommended).</p><p>If you are using an SD card that you have used previously, you may need to reformat it to remove any previous partitions and data. NOOBS expects the SD card to consist of a single FAT32 partition. If using Windows or Mac OS X, you can use the SD association's formatter, as shown in the following<a class="indexterm" id="id53"/> screenshot (available at <a class="ulink" href="https://www.sdcard.org/downloads/formatter_4/">https://www.sdcard.org/downloads/formatter_4/</a>):</p><div class="mediaobject"><img alt="Getting ready" src="graphics/6623OT_01_005.jpg"/><div class="caption"><p>Get rid of any partitions on the SD card using SD formatter</p></div></div><p>From the <a class="indexterm" id="id54"/>
<span class="strong"><strong>Option Setting</strong></span> dialog box, set <a class="indexterm" id="id55"/>
<span class="strong"><strong>Format Size Adjustment</strong></span>. This will remove all the SD card partitions that were created previously.</p><p>If using Linux, you can use <code class="literal">gparted</code> to clear any previous partitions and reformat it as a FAT32 partition.</p><p>The full NOOBS package (typically just over 1 GB) contains the Raspbian, the most popular Raspberry Pi operating system image built in. A lite version of NOOBS is also available that has no preloaded operating systems (although a smaller initial download of 20 MB and a network connection on the Raspberry Pi are required to directly download the operating system you intend to use).</p><p>NOOBS<a class="indexterm" id="id56"/> is available at <a class="ulink" href="http://www.raspberrypi.org/downloads">http://www.raspberrypi.org/downloads</a>, with the documentation available at <a class="ulink" href="https://github.com/raspberrypi/noobs">https://github.com/raspberrypi/noobs</a>.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec16"/>How to do it…</h2></div></div></div><p>By performing the following steps, we will prepare the SD card to run NOOBS. This will then allow us to select and install the operating system we want to use:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Get your SD card ready.</li><li class="listitem">On a freshly formatted or new SD card, copy the contents of the <code class="literal">NOOBS_vX.zip</code> file. When it has finished copying, you should end up with something like the following screenshot of the SD card:<div class="mediaobject"><img alt="How to do it…" src="graphics/6623OT_01_006.jpg"/><div class="caption"><p>NOOBS files extracted onto the SD card</p></div></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note07"/>Note</h3><p>The files may vary slightly with different versions of NOOBS, and the icons displayed may be different on your computer.</p></div></div></li><li class="listitem">You can<a class="indexterm" id="id57"/> now put the card into <a class="indexterm" id="id58"/>your Raspberry Pi, connect it to a keyboard and display, and turn the power on. Refer to the <span class="emphasis"><em>Connecting up the Raspberry Pi</em></span> recipe for details on what you need and how to do this.</li></ol></div><p>By default, NOOBS will display via the HDMI connection. If you have another type of screen (or you don't see anything), you will need to manually select the output type by pressing <span class="emphasis"><em>1</em></span>, <span class="emphasis"><em>2</em></span>, <span class="emphasis"><em>3</em></span>, or <span class="emphasis"><em>4</em></span> according to the following functions:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Key 1 stands for the <span class="strong"><strong>Standard HDMI</strong></span> mode (the default mode)</li><li class="listitem" style="list-style-type: disc">Key 2 stands for the <span class="strong"><strong>Safe HDMI</strong></span> mode (alternative HDMI settings if the output has not been detected)</li><li class="listitem" style="list-style-type: disc">Key 3 stands for <span class="strong"><strong>Composite PAL</strong></span> (for connections made via the RCA analogue video connection)</li><li class="listitem" style="list-style-type: disc">Key 4 stands for <span class="strong"><strong>Composite NTSC</strong></span> (again, for connections via the RCA connector)</li></ul></div><p>This display setting will also be set for the installed operating system.</p><p>After a short while, you will see the NOOBS selection screen that lists the available distributions (the offline version only includes Raspbian). There are many more distributions that are available, but only the selected ones are available directly through the NOOBS system. Click on <span class="strong"><strong>Raspbian</strong></span> as this is the operating system being used in this book.</p><p>Press <span class="emphasis"><em>Enter</em></span> or click on <span class="strong"><strong>Install OS</strong></span>, and confirm that you wish to overwrite all the data on the card. This will overwrite any distributions previously installed using NOOBS but will not remove the NOOBS system; you can return to it at any time by pressing <span class="emphasis"><em>Shift</em></span> when you turn the power on.</p><p>It will take around 20 to 40 minutes to write the data to the card depending on its speed. When it completes and the <span class="strong"><strong>Image Applied Successfully</strong></span> message appears, click on <span class="strong"><strong>OK</strong></span> and the Raspberry Pi will start to boot into <code class="literal">the Raspberry Pi Desktop</code>.</p></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec17"/>How it works…</h2></div></div></div><p>The purpose of writing the image file to the SD card in this manner is to ensure that the SD card is formatted with the expected filesystem partitions and files required to correctly boot the operating system.</p><p>When the Raspberry Pi powers up, it loads<a class="indexterm" id="id59"/> some special code contained within the GPU's internal memory (commonly referred to as <span class="strong"><strong>binary blob</strong></span>
<a class="indexterm" id="id60"/> by the Raspberry Pi Foundation). The binary blob provides the instructions required to read the <span class="strong"><strong>BOOT Partition</strong></span>
<a class="indexterm" id="id61"/> on the SD card, which (in the case of a NOOBS install) will load NOOBS from the <code class="literal">RECOVERY</code> partition. If at this point <span class="emphasis"><em>Shift</em></span> is pressed, NOOBS will load the recovery and installation menu. Otherwise, NOOBS will begin loading the OS as specified by the preferences stored in the <a class="indexterm" id="id62"/>
<span class="strong"><strong>SETTINGS Partition</strong></span>.</p><p>When loading the operating system, it <a class="indexterm" id="id63"/>will boot via the <code class="literal">BOOT</code> partition using the settings defined in <code class="literal">config.txt</code> and options in <code class="literal">cmdline.txt</code> to finally load to the desktop on the <span class="strong"><strong>root Partition</strong></span>. Refer to the following diagram:</p><div class="mediaobject"><img alt="How it works…" src="graphics/6623OT_01_007.jpg"/><div class="caption"><p>NOOBS creates several partitions on the SD card to allow installation of multiple operating systems and provide recovery</p></div></div><p>NOOBS allows the user to<a class="indexterm" id="id64"/> optionally install multiple <a class="indexterm" id="id65"/>operating systems on the same card and provides a boot menu to select between them (with an option to set a default value in the event of a time-out period).</p><p>If you later add, remove, or reinstall an operating system, ensure first that you make a copy of any files, including system settings you wish to keep, as NOOBS may overwrite everything on the SD card.</p></div><div class="section" title="There's more…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec18"/>There's more…</h2></div></div></div><p>When you power up the Raspberry Pi for the first time, it will start directly with the desktop. You can now configure the system settings using the <span class="strong"><strong>Raspberry Pi Configuration</strong></span> program (under the Preferences menu on the Desktop or via the <code class="literal">sudo raspi-config</code> command), which will allow you to perform changes to your SD card and set up your general preferences.</p><div class="mediaobject"><img alt="There's more…" src="graphics/6623OT_01_008.jpg"/><div class="caption"><p>Raspberry Pi Configuration program</p></div></div><div class="section" title="Changing the default user password"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec09"/>Changing the default user password</h3></div></div></div><p>Ensure that you change the <a class="indexterm" id="id66"/>default password for the <code class="literal">pi</code> user account once you have logged in, as the default password is well known. This is particularly important if you connect to public networks. You can do this with the <code class="literal">passwd</code> command, as shown in the following screenshot:</p><div class="mediaobject"><img alt="Changing the default user password" src="graphics/6623OT_01_009.jpg"/><div class="caption"><p>Setting a new password for the pi user</p></div></div><p>This gives greater confidence<a class="indexterm" id="id67"/> because if you later connect to another network, only you will be able to access your files and take control of your Raspberry Pi.</p></div><div class="section" title="Ensuring that you shut down safely"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec10"/>Ensuring that you shut down safely</h3></div></div></div><p>To avoid any data corruption, you must ensure that you correctly shut down the Raspberry Pi<a class="indexterm" id="id68"/> by issuing a <code class="literal">shutdown</code> command, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo shutdown –h now</strong></span>
</pre></div><p>Or use this one:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo halt</strong></span>
</pre></div><p>You must wait until this command completes before you remove power from the Raspberry Pi (wait for at least 10 seconds after the SD card access light has stopped flashing).</p><p>You can also restart the system with the <code class="literal">reboot</code> command, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo reboot</strong></span>
</pre></div></div><div class="section" title="Preparing an SD card manually"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec11"/>Preparing an SD card manually</h3></div></div></div><p>An alternative to using <a class="indexterm" id="id69"/>NOOBS is to manually write the operating system image to the SD card. While this was originally the only way to install the operating system, some users still prefer it. It allows the SD cards to be prepared before they are used in the Raspberry Pi. It can also provide easier access to startup and configuration files, and it leaves more space available for the user (unlike NOOBS, a <code class="literal">RECOVERY</code> partition isn't included).</p><p>The default Raspbian image actually consists of two partitions, <code class="literal">BOOT</code> and <code class="literal">SYSTEM</code>, which will fit into a 2 GB SD card (4 GB or more is recommended).</p><p>You need a computer running Windows/Mac OS X/Linux (although it is possible to use another Raspberry Pi to write your card, be prepared for a very long wait).</p><p>Download the latest version of the operating system you wish to use. For the purpose of this book, it is assumed you are using the latest version of Raspbian<a class="indexterm" id="id70"/> available at <a class="ulink" href="http://www.raspberrypi.org/downloads">http://www.raspberrypi.org/downloads</a>.</p><p>Perform the following steps depending on the type of computer you plan to use to write to the SD card (the <code class="literal">.img</code> file you need is sometimes compressed, so before you start, you will need to extract the file).</p><p>The following steps are for Windows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Ensure that you have downloaded the Raspbian image, as previously detailed, and extracted it to a <a class="indexterm" id="id71"/>convenient folder to obtain an <code class="literal">.img</code> file.</li><li class="listitem">Obtain the <code class="literal">Win32DiskImager.exe</code> file available at <a class="ulink" href="http://www.sourceforge.net/projects/win32diskimager">http://www.sourceforge.net/projects/win32diskimager</a>.</li><li class="listitem">Run <code class="literal">Win32DiskImager.exe</code> from your downloaded location.</li><li class="listitem">Click on the folder icon and navigate to the location of the <code class="literal">.img</code> file and click on <span class="strong"><strong>Save</strong></span>.</li><li class="listitem">If you haven't already done so, insert your SD card into your card reader and plug it into your computer.</li><li class="listitem">Select the <span class="strong"><strong>Device</strong></span> drive letter that corresponds to your SD card from the small drop-down box. Double-check that this is the correct device (as the program will overwrite whatever is on the device when you write the image).<div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note08"/>Note</h3><p>The drive letter may not be listed until you select a source image file.</p></div></div></li><li class="listitem">Finally, click on the <span class="strong"><strong>Write</strong></span> button and wait for the program to write the image to the SD card, as shown in the following screenshot:<div class="mediaobject"><img alt="Preparing an SD card manually" src="graphics/6623OT_01_010.jpg"/><div class="caption"><p>Manually write operating system images to the SD card using Disk Imager</p></div></div></li></ol></div><p>Once completed, you can <a class="indexterm" id="id72"/>exit the program. Your SD card is ready!</p><p>The following steps should work for the most common Linux distributions, such as Ubuntu and Debian:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Using your preferred web browser, download the Raspbian image and save it in a suitable place.</li><li class="listitem">Extract the file from the file manager or locate the folder in the terminal and unzip the <code class="literal">.img</code> file with the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>unzip filename.zip</strong></span>
</pre></div></li><li class="listitem">If you haven't already done so, insert your SD card into your card reader and plug it into your computer.</li><li class="listitem">Use the <code class="literal">df –h</code> command and identify the <span class="strong"><strong>sdX</strong></span> identifier for the SD card. Each partition will be displayed as <span class="strong"><strong>sdX1</strong></span>, <span class="strong"><strong>sdX2</strong></span>, and so on, where <span class="strong"><strong>X</strong></span> will be <code class="literal">a</code>, <code class="literal">b</code>, <code class="literal">c</code>, <code class="literal">d</code>, and so on for the device ID.</li><li class="listitem">Ensure that all the partitions on the SD card are unmounted using the <code class="literal">umount /dev/sdXn</code> command for each partition, where <code class="literal">sdXn</code> is the partition being unmounted.</li><li class="listitem">Write the image file to the SD card with the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo dd if=filename.img of=/dev/sdX bs=4M</strong></span>
</pre></div></li><li class="listitem">The process will take some time to write to the SD card, returning to the terminal prompt when complete.</li><li class="listitem">Unmount the SD card before removing it from the computer using the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>umount /dev/sdX1</strong></span>
</pre></div></li></ol></div><p>The following steps should <a class="indexterm" id="id73"/>work for most of the versions of OS X:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Using your preferred web browser, download the Raspbian image and save it somewhere suitable.</li><li class="listitem">Extract the file from the file manager or locate the folder in the terminal and unzip the <code class="literal">.img</code> file with the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>unzip filename.zip</strong></span>
</pre></div></li><li class="listitem">If you haven't already done so, insert your SD card into your card reader and plug it into your computer.</li><li class="listitem">Use the <code class="literal">diskutil list</code> command and identify the <span class="strong"><strong>disk#</strong></span> identifier for the SD card. Each partition will be displayed as <span class="strong"><strong>disk#s1</strong></span>, <span class="strong"><strong>disk#s2</strong></span>, and so on, where <span class="strong"><strong>#</strong></span> will be <code class="literal">1</code>, <code class="literal">2</code>, <code class="literal">3</code>, <code class="literal">4</code>, and so on for the device ID.<div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note09"/>Note</h3><p>If <span class="strong"><strong>rdisk#</strong></span> is listed, use this for faster writing (this uses a raw path and skips data buffering).</p></div></div></li><li class="listitem">Ensure that the SD card is unmounted using the <code class="literal">unmountdisk /dev/diskX</code> command, where <code class="literal">diskX</code> is the device being unmounted.</li><li class="listitem">Write the image file to the SD card with following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo dd if=filename.img of=/dev/diskX bs=1M</strong></span>
</pre></div></li><li class="listitem">The process will take some time to write to the SD card, returning to the terminal prompt when complete.</li><li class="listitem">Unmount the SD card before removing it from the computer using the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>unmountdisk /dev/diskX</strong></span>
</pre></div><p>Refer to the following<a class="indexterm" id="id74"/> image:</p><div class="mediaobject"><img alt="Preparing an SD card manually" src="graphics/6623OT_01_011.jpg"/><div class="caption"><p>The boot process of a manually installed OS image</p></div></div></li></ol></div></div><div class="section" title="Expanding the system to fit in your SD card"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec12"/>Expanding the system to fit in your SD card</h3></div></div></div><p>A manually written<a class="indexterm" id="id75"/> image will be of a fixed size (usually made to fit the smallest-sized SD card possible). To make full use of the SD card, you will need to expand the system partition to fill the remainder of the SD card. This can be achieved using the Raspberry Pi Configuration tool.</p><p>Select <code class="literal">Expand Filesystem,</code> as shown in the following screenshot:</p><div class="mediaobject"><img alt="Expanding the system to fit in your SD card" src="graphics/6623OT_01_012.jpg"/><div class="caption"><p>The Raspberry Pi Configuration tool</p></div></div></div><div class="section" title="Accessing the RECOVERY/BOOT partition"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec13"/>Accessing the RECOVERY/BOOT partition</h3></div></div></div><p>Windows and Mac OS X do<a class="indexterm" id="id76"/> not support the <code class="literal">ext4</code> format, so when you read the SD card, only the <span class="strong"><strong>File Allocation Table</strong></span> (<span class="strong"><strong>FAT</strong></span>)<a class="indexterm" id="id77"/> partitions will be accessible. In addition, Windows only supports the first partition on an SD card, so if you've installed NOOBS, only the <code class="literal">RECOVERY</code> partition will be visible. If you've written your card manually, you will be able to access the <code class="literal">BOOT</code> partition.</p><p>The <code class="literal">data</code> partition (if you installed one via NOOBS) and the <code class="literal">root</code> partition are in <code class="literal">ext4</code> format and won't usually be visible on non-Linux systems.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note10"/>Note</h3><p>If you do need to read files from the SD card using Windows, a freeware program, <span class="strong"><strong>Linux Reader</strong></span>
<a class="indexterm" id="id78"/> (available at <a class="ulink" href="http://www.diskinternals.com/linux-reader">www.diskinternals.com/linux-reader</a>) can provide read-only access to all of the partitions on the SD card.</p></div></div><p>Access the partitions from the <a class="indexterm" id="id79"/>Raspberry Pi. To view the currently mounted partitions, use <code class="literal">df</code>, as shown in the following screenshot:</p><div class="mediaobject"><img alt="Accessing the RECOVERY/BOOT partition" src="graphics/6623OT_01_013.jpg"/><div class="caption"><p>The result of the df command</p></div></div><p>To access the <code class="literal">BOOT</code> partition from within Raspbian, use the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>cd /boot/</strong></span>
</pre></div><p>To access the <code class="literal">RECOVERY</code> or <code class="literal">data</code> partition, we have to mount it by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Determine the name of the partition as the system refers to it by listing all the partitions, even the unmounted ones. The <code class="literal">sudo fdisk -l</code> command lists the partitions, as shown in the following screenshot:<div class="mediaobject"><img alt="Accessing the RECOVERY/BOOT partition" src="graphics/6623OT_01_014.jpg"/><div class="caption"><p>The partition table of a NOOBS install of Raspbian and data partition</p></div></div><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">mmcblk0p1</code>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">(vfat) RECOVERY</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">mmcblk0p2</code>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">(Extended partition) contains (root, data, BOOT)</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">mmcblk0p5</code>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">(ext4) root</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">mmcblk0p6</code>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">(vfat) BOOT</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">mmcblk0p7</code>
</p>
</td><td style="text-align: left" valign="top">
<p>
<code class="literal">(ext4) SETTINGS</code>
</p>
</td></tr></tbody></table></div><p>If you have <a class="indexterm" id="id80"/>installed additional operating systems on the same card, the partition identifiers shown in the preceding table will be different.</p></li><li class="listitem">Create a folder and set it as the mount point for the partition, as follows:<div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">For the <code class="literal">RECOVERY</code> partition, use the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>mkdir ~/recovery</strong></span>
<span class="strong"><strong>sudo mount –t vfat /dev/mmcblk0p1 ~/recovery</strong></span>
</pre></div></li></ul></div></li></ol></div><p>To ensure that they are mounted each time the system is started, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Add the sudo mount commands to <code class="literal">/etc/rc.local</code> before <code class="literal">exit 0</code>. If you have a different username, you will need to change <code class="literal">pi</code> to match:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo nano /etc/rc.local</strong></span>
<span class="strong"><strong>sudo mount -t vfat /dev/mmcblk0p1 /home/pi/recovery</strong></span>
</pre></div></li><li class="listitem">Save and exit by pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>X</em></span>, <span class="emphasis"><em>Y</em></span>, and <span class="emphasis"><em>Enter</em></span>.</li></ol></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note11"/>Note</h3><p>Commands added to <code class="literal">/etc/rc.local</code> will be run for any user who logs on to the Raspberry Pi. If you only want the drive to be mounted for the current user, the commands can be added to <code class="literal">.bash_profile</code> instead.</p></div></div><p>If you have to install<a class="indexterm" id="id81"/> additional operating systems on the same card, the partition identifiers shown here will be different.</p></div><div class="section" title="Using the tools to back up your SD card in case of failure"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec14"/>Using the tools to back up your SD card in case of failure</h3></div></div></div><p>You can use <span class="strong"><strong>Win32 Disk Imager</strong></span>
<a class="indexterm" id="id82"/> to make a full backup image of your SD card by inserting your SD card into your reader, starting the program, and creating a filename to <a class="indexterm" id="id83"/>store the image in. Simply click on the <span class="strong"><strong>Read</strong></span> <a class="indexterm" id="id84"/>button instead to read the image from the SD card and write it to a new image file.</p><p>To make a backup of your system, or to clone to another SD card using the Raspberry Pi, use the SD Card Copier (available from the desktop menu via the <span class="strong"><strong>Accessories</strong></span> | <span class="strong"><strong>SD Card Copier</strong></span>).</p><p>Insert an SD card into a card reader into a spare USB port of the Raspberry Pi and select the new storage device, as shown in the following screenshot:</p><div class="mediaobject"><img alt="Using the tools to back up your SD card in case of failure" src="graphics/6623OT_01_015.jpg"/><div class="caption"><p>SD Card Copier program</p></div></div><p>Before continuing, the SD Card Copier will confirm that you wish to format and overwrite the target device and, if there is sufficient space, make a clone of your system.</p><p>The <code class="literal">dd</code> command can<a class="indexterm" id="id85"/> similarly be used to back up the card, as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">For Linux, replacing <code class="literal">sdX</code> with<a class="indexterm" id="id86"/> your device ID, use this command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo dd if=/dev/sdX of=image.img.gz bs=1M</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">For OS X, replacing <code class="literal">diskX</code> with your device ID, use the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo dd if=/dev/diskX of=image.img.gz bs=1M</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">You can also use <code class="literal">gzip</code> and split to compress the contents of the card and split them into multiple files if required for easy archiving, as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo dd if=/dev/sdX bs=1M | gzip –c | split –d –b 2000m – image.img.gz</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc">To restore the split image, use the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo cat image.img.gz* | gzip –dc | dd of=/dev/sdX bs=1M</strong></span>
</pre></div></li></ul></div></div></div></div>
<div class="section" title="Networking and connecting your Raspberry Pi to the Internet via the LAN connector"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Networking and connecting your Raspberry Pi to the Internet via the LAN connector</h1></div></div></div><p>The simplest way to <a class="indexterm" id="id87"/>connect the Raspberry Pi to the Internet is by using the built-in LAN connection on the Model B. If you are using a Model A Raspberry Pi, a USB-to-LAN adapter can be used (refer to the <span class="emphasis"><em>There's more…</em></span> section of the <span class="emphasis"><em>Networking and connecting your Raspberry Pi to the Internet via a USB Wi-Fi dongle</em></span> recipe for details on how to configure this).</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec19"/>Getting ready</h2></div></div></div><p>You will need access to a suitable wired network, which will be connected to the Internet, and a standard network cable (with an <span class="strong"><strong>RJ45</strong></span> type connector<a class="indexterm" id="id88"/> for connecting to the Raspberry Pi).</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec20"/>How to do it…</h2></div></div></div><p>Many networks connect<a class="indexterm" id="id89"/> and configure themselves automatically using <span class="strong"><strong>Dynamic Host Configuration Protocol</strong></span> (<span class="strong"><strong>DHCP</strong></span>), which is controlled by the router or switch. If this is the case, simply plug the network cable into a spare network port on your router or network switch (or wall network socket if applicable).</p><p>Alternatively, if a<a class="indexterm" id="id90"/> DHCP server is not available, you shall have to configure the settings manually (refer to the <span class="emphasis"><em>There's more…</em></span> section for details).</p><p>You can confirm this is functioning successfully with the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Ensure that the two LEDs on either side of the Raspberry Pi light up (the left orange LED indicates a connection and the green LED on the right shows activity by flashing). This will indicate that there is a physical connection to the router and the equipment is powered and functioning.</li><li class="listitem">Test the link to your local network using the <code class="literal">ping</code> command. First, find out the IP address of another computer on the network (or the address of your router perhaps, often <code class="literal">192.168.0.1</code> or <code class="literal">192.168.1.254</code>). Now, on the Raspberry Pi terminal, use the <code class="literal">ping</code> command (the <code class="literal">-c 4</code> parameter is used to send just four messages; otherwise, press <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>C</em></span> to stop) to ping the IP address as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo ping 192.168.1.254 -c 4</strong></span>
</pre></div></li><li class="listitem">Test the link to the Internet (this will fail if you usually connect to the Internet through a proxy server) as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo ping www.raspberrypi.org -c 4</strong></span>
</pre></div></li><li class="listitem">Finally, you can test the link back to the Raspberry Pi by discovering the IP address using <code class="literal">hostname -I</code> on the Raspberry Pi. You can then use the ping command on another computer on the network to ensure it is accessible (using the Raspberry Pi's IP address in place of <a class="ulink" href="http://www.raspberrypi.org">www.raspberrypi.org</a>). The Windows version of the <code class="literal">ping</code> command will perform five pings and stop automatically, and will not need the <code class="literal">-c 4</code> option.</li></ol></div><p>If the aforementioned tests fail, you will need to check your connections and then confirm the correct configuration for your network.</p></div><div class="section" title="There's more…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec21"/>There's more…</h2></div></div></div><p>If you find yourself using your Raspberry Pi regularly on the network, you won't want to have to look up the IP address each time you want to connect to it.</p><p>On some networks, you may be able to use the Raspberry Pi's hostname instead of its IP address (the default is <code class="literal">raspberrypi</code>). To assist with this, you may need some additional software such as <span class="strong"><strong>Bonjour</strong></span>
<a class="indexterm" id="id91"/> to ensure hostnames on the network are correctly registered. If you have an OS X Mac, you will have Bonjour running already. On Windows, you can either install iTunes (if you haven't got it) which also includes the service, or you can install it separately (via the Apple Bonjour Installer available from <a class="ulink" href="https://support.apple.com/kb/DL999">https://support.apple.com/kb/DL999</a>). Then you can use the hostname, <code class="literal">raspberrypi</code> or <code class="literal">raspberrypi.local</code>, to connect to the Raspberry Pi over the network. If you need to change the hostname, then you can do so in the Raspberry Pi configuration tool, shown previously.</p><p>Alternatively, you may find it helpful to fix the IP address to a known value by manually setting the IP address. However, remember to switch it back to use DHCP when connecting on another network.</p><p>Some routers will also have an option to set a<a class="indexterm" id="id92"/> <span class="strong"><strong>Static IP DHCP address</strong></span>, so the same address is always given to the Raspberry Pi (how this is set will vary on the router itself).</p><p>Knowing your Raspberry Pi's IP address or using the hostname is particularly useful if you intend to use one of the remote access solutions described later on, which avoids the need for a display.</p></div></div>
<div class="section" title="Using built-in Wi-Fi and Bluetooth on the Raspberry Pi"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec14"/>Using built-in Wi-Fi and Bluetooth on the Raspberry Pi</h1></div></div></div><p>Many home networks provide a <a class="indexterm" id="id93"/>wireless network over Wi-Fi; if you have a <a class="indexterm" id="id94"/>Raspberry Pi 3, then you can make<a class="indexterm" id="id95"/> use of the on-board Broadcom Wi-Fi <a class="indexterm" id="id96"/>to connect to it. The Raspberry Pi 3 also supports Bluetooth, so you can connect most standard Bluetooth devices and use them like you would on any other computer.</p><p>This method should also work for any supported USB Wi-Fi and Bluetooth devices, see the <span class="emphasis"><em>Networking and connecting your Raspberry Pi to the Internet via a USB Wi-Fi dongle</em></span> recipe for extra help on identifying device and installing firmware (if required).</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec22"/>Getting ready</h2></div></div></div><p>The latest version of Raspbian includes helpful utilities to quickly and easily configure your Wi-Fi and Bluetooth through the graphical interface.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note12"/>Note</h3><p>
<span class="strong"><strong>Note</strong></span>: If you need to configure the Wi-Fi via the command line, then see the <span class="emphasis"><em>Networking and connecting your Raspberry Pi to the Internet via a USB Wi-Fi dongle</em></span> recipe for details.</p></div></div><div class="mediaobject"><img alt="Getting ready" src="graphics/6623OT_01_016.jpg"/><div class="caption"><p>Wi-Fi and Bluetooth configuration applications</p></div></div><p>You can use the built-in <a class="indexterm" id="id97"/>Bluetooth to connect a wireless keyboard, a<a class="indexterm" id="id98"/> mouse or even wireless speakers. This <a class="indexterm" id="id99"/>can be exceptionally helpful for projects <a class="indexterm" id="id100"/>where additional cables and wires are an issue, such as robotic projects, or when the Raspberry Pi is installed in hard-to-reach locations (acting as a server or security camera).</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec23"/>How to do it…</h2></div></div></div><div class="section" title="Connecting to your Wi-Fi network"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec15"/>Connecting to your Wi-Fi network</h3></div></div></div><p>To configure your <a class="indexterm" id="id101"/>Wi-Fi connection, click on the networking symbol to <a class="indexterm" id="id102"/>list the local available Wi-Fi networks:</p><div class="mediaobject"><img alt="Connecting to your Wi-Fi network" src="graphics/6623OT_01_017.jpg"/><div class="caption"><p>Wi-Fi listing of the available access points in the area</p></div></div><p>Select the required network (for example, <code class="literal">Demo</code>) and if required enter your password (also known as <code class="literal">Pre Shared Key</code>):</p><div class="mediaobject"><img alt="Connecting to your Wi-Fi network" src="graphics/6623OT_01_018.jpg"/><div class="caption"><p>Providing the password for the access point</p></div></div><p>After a short while, you should see that you have connected to the network and the icon will change to a Wi-Fi<a class="indexterm" id="id103"/> symbol. If you encounter problems, ensure you have <a class="indexterm" id="id104"/>the correct password/key.</p><div class="mediaobject"><img alt="Connecting to your Wi-Fi network" src="graphics/6623OT_01_019.jpg"/><div class="caption"><p>Successful connection to an access point</p></div></div><p>That is it, as easy as that!</p><p>You can now test your connection and ensure it is working by using the web browser to navigate to a website or by using the following command in the terminal:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo ping www.raspberrypi.com</strong></span>
</pre></div></div><div class="section" title="Connecting to Bluetooth devices"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec16"/>Connecting to Bluetooth devices</h3></div></div></div><p>To start, we need to put<a class="indexterm" id="id105"/> the Bluetooth device into discoverable mode, by clicking on the Bluetooth icon and selecting <span class="strong"><strong>Make Discoverable</strong></span>. You will also need to make the device you want to connect to discoverable and ready to pair; this may vary from device to device (such as pressing a pairing button).</p><div class="mediaobject"><img alt="Connecting to Bluetooth devices" src="graphics/6623OT_01_020.jpg"/><div class="caption"><p>Set the Bluetooth as discoverable</p></div></div><p>Next, select <span class="strong"><strong>Add Device...</strong></span> and select the target device and <span class="strong"><strong>Pair</strong></span>:</p><div class="mediaobject"><img alt="Connecting to Bluetooth devices" src="graphics/6623OT_01_021.jpg"/><div class="caption"><p>Select and pair the required device</p></div></div><p>The pairing process will <a class="indexterm" id="id106"/>then start; for example, the <span class="strong"><strong>BTKB-71DB</strong></span> keyboard will need the pairing code <code class="literal">467572</code> to be entered onto the keyboard for the pairing to complete. Other devices may use default pairing codes, often set to 0000, 1111, 1234, or similar.</p><div class="mediaobject"><img alt="Connecting to Bluetooth devices" src="graphics/6623OT_01_022.jpg"/><div class="caption"><p>Follow the instructions to pair the device with the required pairing code</p></div></div><p>Once the process has completed, the device will be listed and will connect automatically each time the devices are present and booted.</p></div></div></div>
<div class="section" title="Configuring your network manually"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec15"/>Configuring your network manually</h1></div></div></div><p>If your network does not include a<a class="indexterm" id="id107"/> DHCP server or it is disabled (typically, these are built into most modern ADSL/cable modems or routers), you may need to configure your network settings manually.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec24"/>Getting ready</h2></div></div></div><p>Before you start, you will need to determine the network settings for your network.</p><p>You will need to find out the following information from your router's settings or another computer connected to the network:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>IPv4 address</strong></span>: This <a class="indexterm" id="id108"/>address will need to be selected to be similar to other computers on the network (typically, the first three numbers should match, that is, <code class="literal">192.168.1.X</code> if <code class="literal">netmask</code> is <code class="literal">255.255.255.0</code>), but it should not already be used by another computer. However, avoid <code class="literal">x.x.x.255</code> as the last address since this is reserved as a broadcast address.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Subnet mask</strong></span>: This <a class="indexterm" id="id109"/>number determines the range of addresses the computer will respond to (for a home network, it is typically <code class="literal">255.255.255.0</code>, which allows up to 254 addresses). This is also sometimes referred to as the <a class="indexterm" id="id110"/><span class="strong"><strong>netmask</strong></span>.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Default gateway address</strong></span>: This <a class="indexterm" id="id111"/>address is usually your router's IP address, through which the computers connect to the Internet.</li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>DNS servers</strong></span>: The <a class="indexterm" id="id112"/><span class="strong"><strong>DNS</strong></span> server (<span class="strong"><strong>Domain Name Service</strong></span>) converts<a class="indexterm" id="id113"/> names into IP addresses by looking them up. Usually, they will already be configured on your router, in which case you can use your router's address. Alternatively, your <span class="strong"><strong>Internet Service Provider</strong></span> (<span class="strong"><strong>ISP</strong></span>)<a class="indexterm" id="id114"/> may provide some addresses, or you can use Google's public DNS servers at the addresses <code class="literal">8.8.8.8</code> and <code class="literal">8.8.4.4</code>. These are also called <span class="strong"><strong>nameservers</strong></span><a class="indexterm" id="id115"/> in some systems.</li></ul></div><p>For Windows, you can obtain this information by connecting to the Internet and running the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>ipconfig /all</strong></span>
</pre></div><p>Locate the active connection (usually called <span class="strong"><strong>Local Area Connection 1</strong></span> or similar if you are using a wired connection, or if you are using Wi-Fi, it is called wireless network connection) and find the information required, as follows:</p><div class="mediaobject"><img alt="Getting ready" src="graphics/6623OT_01_023.jpg"/><div class="caption"><p>The ipconfig/all command shows useful information about your network settings</p></div></div><p>For Linux and Mac OS X, you <a class="indexterm" id="id116"/>can obtain the required information with the following command (note that it is <code class="literal">ifconfig</code> rather than <code class="literal">ipconfig</code>):</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>ifconfig</strong></span>
</pre></div><p>The DNS servers are called nameservers and are usually listed in the <code class="literal">resolv.conf</code> file. You can use the <code class="literal">less</code> command as follows to view its contents (press <span class="emphasis"><em>Q</em></span> to quit when you have finished viewing it):</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>less /etc/resolv.conf</strong></span>
</pre></div></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec25"/>How to do it…</h2></div></div></div><p>To set the network interface settings, edit <code class="literal">/etc/network/interfaces</code> using the following code:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo nano /etc/network/interfaces</strong></span>
</pre></div><p>Now, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">We can add the details for our particular network, the IP <code class="literal">address</code> number we want to allocate to it, the <code class="literal">netmask</code> address of the network, and the <code class="literal">gateway</code> address, as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>iface eth0 inet static</strong></span>
<span class="strong"><strong>  address 192.168.1.10</strong></span>
<span class="strong"><strong>  netmask 255.255.255.0</strong></span>
<span class="strong"><strong>  gateway 192.168.1.254</strong></span>
</pre></div></li><li class="listitem">Save and exit by <a class="indexterm" id="id117"/>pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>X</em></span>, <span class="emphasis"><em>Y</em></span>, and <span class="emphasis"><em>Enter</em></span>.</li><li class="listitem">To set the nameservers for DNS, edit <code class="literal">/etc/resolv.conf</code> using the following code:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo nano /etc/resolv.conf</strong></span>
</pre></div></li><li class="listitem">Add the addresses for your DNS servers as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>nameserver 8.8.8.8</strong></span>
<span class="strong"><strong>nameserver 8.8.4.4</strong></span>
</pre></div></li><li class="listitem">Save and exit by pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>X</em></span>, <span class="emphasis"><em>Y</em></span>, and <span class="emphasis"><em>Enter</em></span>.</li></ol></div></div><div class="section" title="There's more…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec26"/>There's more…</h2></div></div></div><p>You can configure the network settings by editing <code class="literal">cmdline.txt</code> in the <code class="literal">BOOT</code> partition and adding settings to the startup command line with <code class="literal">ip</code>.</p><p>The ip option takes the following form:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>ip=client-ip:nfsserver-ip:gw-ip:netmask:hostname:device:autoconf</strong></span>
</pre></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The <code class="literal">client-ip</code> option<a class="indexterm" id="id118"/> is the IP address you want to allocate to the Raspberry Pi</li><li class="listitem" style="list-style-type: disc">The <code class="literal">gw-ip</code> option<a class="indexterm" id="id119"/> will set the gateway server address if you need to set it manually</li><li class="listitem" style="list-style-type: disc">The <code class="literal">netmask</code> option<a class="indexterm" id="id120"/> will directly set the netmask of the network</li><li class="listitem" style="list-style-type: disc">The <code class="literal">hostname</code> option<a class="indexterm" id="id121"/> will allow you to change the default <code class="literal">raspberrypi</code> hostname</li><li class="listitem" style="list-style-type: disc">The <code class="literal">device</code> option<a class="indexterm" id="id122"/> allows you to specify a default network device if more than one network device is present</li><li class="listitem" style="list-style-type: disc">The <code class="literal">autoconf</code> option<a class="indexterm" id="id123"/> allows the automatic configuration to be switched on or off</li></ul></div></div></div>
<div class="section" title="Networking directly to a laptop or computer"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec16"/>Networking directly to a laptop or computer</h1></div></div></div><p>It is possible to connect the <a class="indexterm" id="id124"/>Raspberry Pi LAN port directly to a laptop or computer using a single network cable. This will create a local network link between the computers, allowing all the things you can do if connected to a normal network without the need for a hub or router, including connection to the Internet, if <span class="strong"><strong>Internet Connection Sharing</strong></span> (<span class="strong"><strong>ICS</strong></span>)<a class="indexterm" id="id125"/> is used as follows:</p><div class="mediaobject"><img alt="Networking directly to a laptop or computer" src="graphics/6623OT_01_024.jpg"/><div class="caption"><p>Make use of the Raspberry Pi with just a network cable, a standard imaged SD card, and power</p></div></div><p>ICS allows the Raspberry Pi to connect to the Internet through another computer. However, some additional configuration is required for the computers in order to communicate across the link, as the Raspberry Pi does not automatically allocate its own IP address.</p><p>We will use the ICS to share a connection from another network link, such as a built-in Wi-Fi on a laptop. Alternatively, we can use a direct network link (refer to the <span class="emphasis"><em>Direct network link</em></span> section under the <span class="emphasis"><em>There's more…</em></span> section) if the Internet is not required or if the computer has only a single network adapter.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note13"/>Note</h3><p>Although this setup should work for most of the computers, some setups are more difficult than the others. For additional information, see <a class="ulink" href="http://www.pihardware.com/guides/direct-network-connection">www.pihardware.com/guides/direct-network-connection</a>.</p></div></div><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec27"/>Getting ready</h2></div></div></div><p>You will need the <a class="indexterm" id="id126"/>Raspberry Pi with power and a standard network cable.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note14"/>Note</h3><p>The Raspberry Pi Model B LAN chip includes <span class="strong"><strong>Auto-MDIX</strong></span> (<span class="strong"><strong>Automatic Medium-Dependent Interface Crossover</strong></span>). Removing the need to use a special crossover<a class="indexterm" id="id127"/> cable (a special network cable wired so that the transmit lines connect to receive lines for direct network links), the chip will decide and change the setup as required automatically.</p></div></div><p>It may also be helpful to have a keyboard and monitor available to perform additional testing, particularly if this is the first time you have tried this.</p><p>To ensure that you can restore your network settings to their original values, you should check whether it has a fixed IP address or the network is configured automatically.</p><p>To check the network settings on Windows 10, perform these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <span class="strong"><strong>Settings </strong></span>from the start menu, then select <span class="strong"><strong>Network &amp; Internet</strong></span>, then <span class="strong"><strong>Ethernet, </strong></span>and click on <span class="strong"><strong>Change adapter options</strong></span> from the list of <span class="strong"><strong>Related Settings</strong></span>.</li></ol></div><p>To check the network settings on Windows 7 and Vista, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <span class="strong"><strong>Network and Sharing Center</strong></span> from the <span class="strong"><strong>Control Panel</strong></span> and click on <span class="strong"><strong>Change adapter settings</strong></span> on the left-hand side.</li><li class="listitem">To check the network settings on Windows XP, open <span class="strong"><strong>Network Connections</strong></span> from the <span class="strong"><strong>Control Panel</strong></span>.</li><li class="listitem">Find the item <a class="indexterm" id="id128"/>that relates to your wired network adapter (by default, this is usually called <span class="strong"><strong>Ethernet</strong></span> or <span class="strong"><strong>Local Area Connection</strong></span>, as shown in the following screenshot):<div class="mediaobject"><img alt="Getting ready" src="graphics/6623OT_01_025.jpg"/><div class="caption"><p>Locating your wired network connection</p></div></div></li><li class="listitem">Right-click on its icon and click on <span class="strong"><strong>Properties</strong></span>. A dialog box will appear, as shown in this screenshot:<div class="mediaobject"><img alt="Getting ready" src="graphics/6623OT_01_026.jpg"/><div class="caption"><p>Selecting the TCP/IP properties and checking the settings</p></div></div></li><li class="listitem">Select the<a class="indexterm" id="id129"/> item called <span class="strong"><strong>Internet Protocol (TCP/IP)</strong></span> or <span class="strong"><strong>Internet Protocol Version 4 (TCP/IPv4)</strong></span> if there are two versions (the other is Version 6), and click on the <span class="strong"><strong>Properties</strong></span> button.</li><li class="listitem">You can confirm that your network is set by using automatic settings or a specific IP address (if so, take note of this address and the remaining details as you may want to revert the settings at a later point).</li></ol></div><p>To check the network settings on Linux, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open up the <span class="strong"><strong>Network Settings</strong></span> dialog box and select <span class="strong"><strong>Configure Interface</strong></span>. Refer to the following screenshot:<div class="mediaobject"><img alt="Getting ready" src="graphics/6623OT_01_027.jpg"/><div class="caption"><p>Linux Network Settings dialog box</p></div></div></li><li class="listitem">Ensure <a class="indexterm" id="id130"/>that if any settings are manually set, you take note of them so that you can restore them later if you want.</li></ol></div><p>To check the network settings on Mac OS X, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Open <span class="strong"><strong>System Preferences</strong></span> and click on <span class="strong"><strong>Networks</strong></span>. You can then confirm whether the IP address is allocated automatically (using DHCP) or not.</li><li class="listitem">Ensure that if any settings are manually set you take note of them so you can restore them later if you want to. Refer to the following screenshot:<div class="mediaobject"><img alt="Getting ready" src="graphics/6623OT_01_028.jpg"/><div class="caption"><p>OS X Network Settings dialog box</p></div></div></li></ol></div><p>If you just need to <a class="indexterm" id="id131"/>access or control the Raspberry Pi without an Internet connection, refer to the <span class="emphasis"><em>Direct network link</em></span> section in the <span class="emphasis"><em>There's more…</em></span>section.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec28"/>How to do it…</h2></div></div></div><p>First, we need to enable ICS on our network devices. In this case, we will be sharing the Internet, which is available on <span class="strong"><strong>Wireless Network Connection</strong></span> through the <span class="strong"><strong>Ethernet </strong></span>connection to the Raspberry Pi.</p><p>For Windows, perform these steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Return to the list of network adapters, right-click on the connection that links to the Internet (in this case, the <span class="strong"><strong>WiFi </strong></span>or <span class="strong"><strong>Wireless Network Connection</strong></span> device), and click on <span class="strong"><strong>Properties</strong></span>.<div class="mediaobject"><img alt="How to do it…" src="graphics/6623OT_01_029.jpg"/><div class="caption"><p>Right-click on your wireless device and select Properties</p></div></div></li><li class="listitem">At the top of the<a class="indexterm" id="id132"/> window, select the second tab (in Windows XP, it is called <span class="strong"><strong>Advanced</strong></span>; in Windows 7 and Windows 10, it is called <span class="strong"><strong>Sharing</strong></span>), as shown in the following screenshot:<div class="mediaobject"><img alt="How to do it…" src="graphics/6623OT_01_030.jpg"/><div class="caption"><p>Selecting the TCP/IP properties and noting the allocated IP address</p></div></div></li><li class="listitem">In the <span class="strong"><strong>Internet Connection Sharing</strong></span> section, check the box for <span class="strong"><strong>Allow other network users to connect through this computer's Internet connection</strong></span> (if present, use the drop-down box to select the <span class="strong"><strong>Home networking connection:</strong></span> option as <span class="strong"><strong>Ethernet </strong></span><a class="indexterm" id="id133"/>or<span class="strong"><strong> Local Area Connection</strong></span>). Click on <span class="strong"><strong>OK</strong></span> and confirm whether you previously had a fixed IP address set for <span class="strong"><strong>Local Area Connection</strong></span>.</li></ol></div><p>For Mac OS X, to enable the ICS, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Click on <span class="strong"><strong>System Preferences</strong></span> and then click on <span class="strong"><strong>Sharing</strong></span>.</li><li class="listitem">Click on <span class="strong"><strong>Internet Sharing</strong></span> and select the connection from which we want to share the Internet (in this case, it will be the Wi-Fi <span class="strong"><strong>AirPort</strong></span>). Then select the connection that we will connect the Raspberry Pi to (in this case, <span class="strong"><strong>Ethernet</strong></span>).</li></ol></div><p>For Linux to enable the ICS, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">From the <span class="strong"><strong>System</strong></span> menu, click on <span class="strong"><strong>Preferences</strong></span> and then on <span class="strong"><strong>Network Connections</strong></span>. Select the connection you want to share (in this case, <span class="strong"><strong>Wireless</strong></span>) and click on <span class="strong"><strong>Edit</strong></span> or <span class="strong"><strong>Configure</strong></span>. In the <span class="strong"><strong>IPv4 Settings</strong></span> tab, change the <span class="strong"><strong>Method</strong></span> option to <span class="strong"><strong>Shared to other computers</strong></span>.</li></ol></div><p>The IP address of the <a class="indexterm" id="id134"/>network adapter will be the <span class="strong"><strong>Gateway IP</strong></span> address to be used on the Raspberry Pi, and be assigned an IP address within the same range (matching except the last number). For instance, if the computer's wired connection now has <code class="literal">192.168.137.1</code>, the Gateway IP of the Raspberry Pi will be <code class="literal">192.168.137.1</code> and its own IP address might be set to <code class="literal">192.168.137.10</code>.</p><p>Fortunately, thanks to updates in the operating system, Raspbian will now automatically allocate a suitable IP address to join the network and set the gateway appropriately. However, unless we have a screen attached to the Raspberry Pi or scan for devices on our network, we do not know what IP address the Raspberry PI has given itself.</p><p>Fortunately (as mentioned in the <span class="emphasis"><em>Networking and connecting your Raspberry Pi to the Internet via the LAN connector</em></span> recipe in the <span class="emphasis"><em>There's more… </em></span>section), Apple's <span class="strong"><strong>Bonjour</strong></span> software will automatically ensure hostnames on the network are correctly registered. As stated previously, if you have an OSX Mac you will have Bonjour running already. On Windows you can either install iTunes, or you can install it separately (available from <a class="ulink" href="https://support.apple.com/kb/DL999">https://support.apple.com/kb/DL999</a>). By default, the hostname <span class="strong"><strong>raspberrypi</strong></span> can be used.</p><p>We are now ready to test the new connection, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Connect the network cable to the Raspberry Pi and the computer's network port, and then power up the Raspberry Pi, ensuring that you have reinserted the SD card if you previously removed it. To reboot the Raspberry Pi if you edited the file there, use <code class="literal">sudo reboot</code> to restart it.</li><li class="listitem">Allow a minute or two for the Raspberry Pi to fully power up. We can now test the connection.</li><li class="listitem">From the connected laptop or computer, test the connection by pinging with the hostname of the Raspberry Pi, as shown in the following command (on Linux or OS X, add <code class="literal">-c 4</code> to limit to four messages or press <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>C</em></span> to exit):<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>ping raspberrypi</strong></span>
</pre></div></li></ol></div><p>Hopefully, you will find you have a working connection and receive replies from theRaspberry Pi.</p><p>If you have a keyboard and screen connected to the Raspberry Pi, you can perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">You can ping the computer in return (for example, <code class="literal">192.168.137.1</code>) from the Raspberry Pi terminal as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo ping 192.168.137.1 -c 4</strong></span>
</pre></div></li><li class="listitem">You can test the link to the Internet by using <code class="literal">ping</code> to connect to a well-known website as follows, assuming you do not access the Internet through a proxy server:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo ping www.raspberrypi.org -c 4</strong></span>
</pre></div></li></ol></div><p>If all goes well, you<a class="indexterm" id="id135"/> will have full Internet available through your computer to the Raspberry Pi, allowing you to browse the web as well as update and install new software.</p><p>If the connection fails, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Repeat the process, ensuring that the first three sets of numbers match with the Raspberry Pi and the network adapter IP addresses.</li><li class="listitem">You can also check that when the Raspberry Pi powers up, the correct IP address is being set using the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>hostname -I</strong></span>
</pre></div></li><li class="listitem">Check your firewall settings to ensure it is not blocking internal network connections.</li></ol></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec29"/>How it works…</h2></div></div></div><p>When we enable ICS on the primary computer, the operating system will automatically allocate a new IP address to the computer. Once connected and powered up, the Raspberry Pi will set itself to a compatible IP address and use the primary computer IP address as an Internet Gateway.</p><p>By using Apple Bonjour, we are able to use the <code class="literal">raspberrypi</code> hostname to connect to the Raspberry Pi from the connected computer.</p><p>Finally, we check whether the computer can communicate over the direct network link to the Raspberry Pi, back the <a class="indexterm" id="id136"/>other way, and also through to the Internet.</p></div><div class="section" title="There's more…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec30"/>There's more…</h2></div></div></div><p>If you do not require the Internet on the Raspberry Pi, or your computer only has a single network adapter, we can still connect the computers together through a direct network link. Refer to the following diagram:</p><div class="mediaobject"><img alt="There's more…" src="graphics/6623OT_01_031.jpg"/><div class="caption"><p>Connecting and using the Raspberry Pi with just a network cable, a standard imaged SD card, and power</p></div></div><div class="section" title="Direct network link"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec17"/>Direct network link</h3></div></div></div><p>For a network link to work <a class="indexterm" id="id137"/>between two computers, they need to be using the same address range. The allowable address range is determined by the subnet mask (for example, <code class="literal">255.255.0.0</code> or <code class="literal">255.255.255.0</code> would mean all IP addresses should be the same except for the last two or just the last number in the IP address; otherwise, they will be filtered).</p><p>To use a direct link without enabling ICS, check the IP settings of the adapter you are going to connect to and determine whether it is automatically allocated or fixed to a specific IP address.</p><p>Most PCs connected<a class="indexterm" id="id138"/> directly to another computer will allocate an IP address in the range <code class="literal">169.254.X.X</code> (with a subnet mask of <code class="literal">255.255.0.0</code>). However, we must ensure that the network adaptor is set to <span class="strong"><strong>Obtain an IP address automatically</strong></span>.</p><p>For the Raspberry Pi to be able to communicate through the direct link, it needs to have an IP address in the same address range, <code class="literal">169.254.X.X</code>. As mentioned before, the Raspberry Pi will automatically give itself a suitable IP address and connect to the network.</p><p>Therefore, assuming we have <span class="strong"><strong>Apple Bonjour</strong></span> (see previously for details), we only need to know the hostname given to the Raspberry Pi (<code class="literal">raspberrypi</code>).</p></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec31"/>See also</h2></div></div></div><p>If you don't have a keyboard or screen connected to the Raspberry Pi, you can use this network link to remotely access the Raspberry Pi just as you would on a normal network (just use the new IP address you have set for the connection). Refer to the <span class="emphasis"><em>Connecting remotely to the Raspberry Pi over the network using VNC</em></span> and <span class="emphasis"><em>Connecting remotely to the Raspberry Pi over the network using SSH (and X11 Forwarding)</em></span> recipes.</p><p>There is lots of additional information available on my website, <a class="ulink" href="https://pihw.wordpress.com/guides/direct-network-connection">https://pihw.wordpress.com/guides/direct-network-connection</a>, including additional troubleshooting tips and several other ways to connect to your Raspberry Pi without needing a dedicated screen and keyboard.</p></div></div>
<div class="section" title="Networking and connecting your Raspberry Pi to the Internet via a USB Wi-Fi dongle"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec17"/>Networking and connecting your Raspberry Pi to the Internet via a USB Wi-Fi dongle</h1></div></div></div><p>By adding a <span class="strong"><strong>USB Wi-Fi dongle</strong></span> to the Raspberry Pi's USB port, even models without built-in Wi-Fi can <a class="indexterm" id="id139"/>connect to and use the Wi-Fi network.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec32"/>Getting ready</h2></div></div></div><p>You will need to obtain a suitable USB Wi-Fi dongle; and in some cases, you may require a powered USB hub (this will depend on the hardware version of the Raspberry Pi you have and the quality of your power supply). General suitability of USB Wi-Fi dongles will vary depending on the chipset that is used inside and the level of Linux support available. You may find that some USB Wi-Fi dongles will work without installing additional drivers (in which case you can jump to configuring it for the wireless network).</p><p>A list of supported Wi-Fi adapters is available at <a class="ulink" href="http://elinux.org/RPi_USB_Wi-Fi_Adapters">http://elinux.org/RPi_USB_Wi-Fi_Adapters</a>.</p><p>You will need to<a class="indexterm" id="id140"/> ensure that your Wi-Fi adapter is also compatible with your intended network; for example, it supports the same types of signals <span class="strong"><strong>802.11bgn</strong></span> and the encryptions <span class="strong"><strong>WEP</strong></span>, <span class="strong"><strong>WPA</strong></span>, and <span class="strong"><strong>WPA2</strong></span> (although most networks are backward compatible).</p><p>You will also need the following details of your network:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Service set identifier (SSID)</strong></span>: This is the name of your Wi-Fi network and should be visible if you use the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo iwlist scan | grep SSID</strong></span>
</pre></div></li><li class="listitem" style="list-style-type: disc"><span class="strong"><strong>Encryption type and key</strong></span>: This value will be <span class="strong"><strong>None</strong></span>, <span class="strong"><strong>WEP</strong></span>, <span class="strong"><strong>WPA</strong></span>, or <span class="strong"><strong>WPA2</strong></span>, and the key will be the code you normally enter when you connect your phone or laptop to the wireless network (sometimes, it is printed on the router).</li></ul></div><p>You will require a working internet connection (that is, wired Ethernet) in order to download the required drivers. Otherwise, you may be able to locate the required firmware files (they will be the <code class="literal">.deb</code> files), and copy them to the Raspberry Pi (that is, via a USB flash drive; the drive should be automatically mounted if you are running in desktop mode). Copy the file to a suitable location and install it with the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get install firmware_file.deb</strong></span>
</pre></div></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec33"/>How to do it…</h2></div></div></div><p>This task has two stages; first, we identify and install firmware for the Wi-Fi adapter, and then we need to configure it for the wireless network.</p><p>We will try to identify the chipset of your Wi-Fi adapter (the part that handles the connection); this may not match the actual manufacturer of the device.</p><p>An approximate list of supported firmware can be found with this command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-cache search wireless firmware</strong></span>
</pre></div><p>This will produce results similar to the following output (disregarding any results without <code class="literal">firmware</code> in the package title):</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>atmel-firmware - Firmware for Atmel at76c50x wireless networking chips.</strong></span>
<span class="strong"><strong>firmware-atheros - Binary firmware for Atheros wireless cards</strong></span>
<span class="strong"><strong>firmware-brcm80211 - Binary firmware for Broadcom 802.11 wireless cards</strong></span>
<span class="strong"><strong>firmware-ipw2x00 - Binary firmware for Intel Pro Wireless 2100, 2200 and 2915</strong></span>
<span class="strong"><strong>firmware-iwlwifi - Binary firmware for Intel PRO/Wireless 3945 and 802.11n cards</strong></span>
<span class="strong"><strong>firmware-libertas - Binary firmware for Marvell Libertas 8xxx wireless cards</strong></span>
<span class="strong"><strong>firmware-ralink - Binary firmware for Ralink wireless cards</strong></span>
<span class="strong"><strong>firmware-realtek - Binary firmware for Realtek wired and wireless network adapters</strong></span>
<span class="strong"><strong>libertas-firmware - Firmware for Marvell's libertas wireless chip series (dummy package)</strong></span>
<span class="strong"><strong>zd1211-firmware - Firmware images for the zd1211rw wireless driver</strong></span>
</pre></div><p>To find out the chipset <a class="indexterm" id="id141"/>of your wireless adapter, plug the Wi-Fi-adapter into Raspberry Pi, and from the terminal, run the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>dmesg | grep 'Product:\|Manufacturer:'</strong></span>
</pre></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note15"/>Note</h3><p>This command stitches together two commands into one. First, <code class="literal">dmesg</code> displays the message buffer of the kernel (this is an internal record of system events that have occurred since power on, such as detected USB devices). You can try the command on its own to observe the complete output.</p><p>The <code class="literal">|</code> (pipe) sends the output to the <code class="literal">grep</code> command, <code class="literal">grep 'Product:\|Manuf'</code> checks it and only returns lines that contain <code class="literal">Product</code> or <code class="literal">Manuf</code> (so we should get a summary of any items that are listed as <code class="literal">Product</code> and <code class="literal">Manufacturer</code>). If you don't find anything or want to see all your USB devices, try <code class="literal">grep 'usb'</code> instead.</p></div></div><p>This should return something similar to the following output (in this case, I've got a <a class="indexterm" id="id142"/>
<span class="strong"><strong>ZyXEL</strong></span> device, which has a <span class="strong"><strong>ZyDAS</strong></span> chipset<a class="indexterm" id="id143"/> (a quick Google search reveals that <code class="literal">zd1211-firmware</code> is for ZyDAS devices):</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>[    1.893367] usb usb1: Product: DWC OTG Controller</strong></span>
<span class="strong"><strong>[    1.900217] usb usb1: Manufacturer: Linux 3.6.11+ dwc_otg_hcd</strong></span>
<span class="strong"><strong>[    3.348259] usb 1-1.2: Product: ZyXEL G-202</strong></span>
<span class="strong"><strong>[    3.355062] usb 1-1.2: Manufacturer: ZyDAS</strong></span>
</pre></div><p>Once you have identified your device and the correct firmware, you can install it, as you would for any other package available through <code class="literal">apt-get</code> (where <code class="literal">zd1211-firmware</code> can be replaced with your required firmware). This is shown in the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get install zd1211-firmware</strong></span>
</pre></div><p>Remove and reinsert the USB Wi-Fi dongle to allow it to be detected and the drivers loaded. We can now test if the new adapter is correctly installed with <code class="literal">ifconfig</code>. The output is shown as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>wlan0     IEEE 802.11bg  ESSID:off/any</strong></span>
<span class="strong"><strong>          Mode:Managed  Access Point: Not-Associated   Tx-Power=20 dBm</strong></span>
<span class="strong"><strong>          Retry  long limit:7   RTS thr:off   Fragment thr:off</strong></span>
<span class="strong"><strong>          Power Management:off</strong></span>
</pre></div><p>The command will <a class="indexterm" id="id144"/>show the network adapters present on the system. For Wi-Fi, this is usually as <code class="literal">wlan0</code>, or <code class="literal">wlan1</code>, or so on if you have installed more than one. If not, double-check the selected firmware, and perhaps try an alternative or check on the site for troubleshooting tips.</p><p>Once we have the firmware installed for the Wi-Fi adapter, we will need to configure it for the network we wish to connect. We can use the GUI as shown in the previous recipe, or we can manually configure it through the terminal as shown in the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">We will need to add the wireless adapter to the list of network interfaces, which is set in <code class="literal">/etc/network/interfaces</code>, as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo nano -c /etc/network/interfaces </strong></span>
</pre></div><p>Using the previous <code class="literal">wlan#</code> value in place of <code class="literal">wlan0</code> if required, add the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>allow-hotplug wlan0</strong></span>
<span class="strong"><strong>iface wlan0 inet manual</strong></span>
<span class="strong"><strong>wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf</strong></span>
</pre></div><p>When the changes have been made, save and exit by pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>X</em></span>, <span class="emphasis"><em>Y</em></span>, and <span class="emphasis"><em>Enter</em></span>.</p></li><li class="listitem">We will now store the Wi-Fi network settings of our network in the <code class="literal">wpa_supplicant.conf</code> file (don't worry if your network doesn't use the <code class="literal">wpa</code> encryption; it is just the default name for the file):<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo nano -c /etc/wpa_supplicant/wpa_supplicant.conf</strong></span>
</pre></div><p>It should <a class="indexterm" id="id145"/>include the following:</p><div class="informalexample"><pre class="programlisting">ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
country=GB</pre></div><p>The network settings can be written within this file as follows (that is, if the SSID is set as <code class="literal">theSSID</code>):</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">If no encryption is used, use this code:<div class="informalexample"><pre class="programlisting">network={
  ssid="theSSID"
  key_mgmt=NONE
}</pre></div></li><li class="listitem" style="list-style-type: disc">With the <code class="literal">WEP</code> encryption (that is, if the <code class="literal">WEP</code> key is set as <code class="literal">theWEPkey</code>), use the following code:<div class="informalexample"><pre class="programlisting">network={
  ssid="theSSID"
  key_mgmt=NONE
  wep_key0="theWEPkey"
}</pre></div></li><li class="listitem" style="list-style-type: disc">For the <code class="literal">WPA</code> or <code class="literal">WPA2</code> encryption (that is, if the <code class="literal">WPA</code> key is set as <code class="literal">theWPAkey</code>), use the following code:<div class="informalexample"><pre class="programlisting">network={
  ssid="theSSID"
  key_mgmt=WPA-PSK
  psk="theWPAkey"	
}</pre></div></li></ul></div></li><li class="listitem">You can enable the adapter with the following command (again, replace <code class="literal">wlan0</code> if required):<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo ifup wlan0</strong></span>
</pre></div><p>Use the following command to list the wireless network connections:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>iwconfig</strong></span>
</pre></div><p>You should see your wireless network connected with your SSID listed as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>wlan0     IEEE 802.11bg  ESSID:"theSSID"</strong></span>
<span class="strong"><strong>          Mode:Managed  Frequency:2.442 GHz  Access Point: 00:24:BB:FF:FF:FF</strong></span>
<span class="strong"><strong>          Bit Rate=48 Mb/s   Tx-Power=20 dBm</strong></span>
<span class="strong"><strong>          Retry  long limit:7   RTS thr:off   Fragment thr:off</strong></span>
<span class="strong"><strong>          Power Management:off</strong></span>
<span class="strong"><strong>          Link Quality=32/100  Signal level=32/100</strong></span>
<span class="strong"><strong>          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0</strong></span>
<span class="strong"><strong>          Tx excessive retries:0  Invalid misc:15   Missed beacon:0</strong></span>
</pre></div><p>If not, adjust your settings and use <code class="literal">sudo ifdown wlan0</code> to switch off the network interface, and then <code class="literal">sudo ifup wlan0</code> to switch it back on.</p><p>This will confirm that you have successfully connected to your Wi-Fi network.</p></li><li class="listitem">Finally, we will<a class="indexterm" id="id146"/> need to check whether we have access to the Internet. Here, we have assumed that the network is automatically configured with DHCP and no proxy server is used. If not, refer to the <span class="emphasis"><em>Connecting to the Internet through a proxy server</em></span> recipe.<p>Unplug the wired network cable, if still connected, and see if you can ping the Raspberry Pi website, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo ping www.raspberrypi.org</strong></span>
</pre></div></li></ol></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="tip02"/>Tip</h3><p>If you want to quickly know the IP address currently in use by the Raspberry Pi, you can use <code class="literal">hostname -I</code>. Or to find out which adapter is connected to which IP address, use <code class="literal">ifconfig</code>.</p></div></div></div><div class="section" title="There's more…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec34"/>There's more…</h2></div></div></div><p>The Model A version of the Raspberry Pi does not have a built-in network port; so in order to get a network connection, a USB network adapter will have to be added (either a Wi-Fi dongle, as explained in<a class="indexterm" id="id147"/> the preceding section, or a LAN-to-USB adapter, as described in the following section).</p><div class="section" title="Using USB wired network adapters"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec18"/>Using USB wired network adapters</h3></div></div></div><p>Just like USB Wi-Fi, the adapter<a class="indexterm" id="id148"/> support will depend on the chipset used and the drivers available. Unless the device comes with Linux drivers, you may have to search the Internet to obtain the suitable Debian Linux drivers.</p><p>If you find a suitable <code class="literal">.deb</code> file, you can install it with the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get install firmware_file.deb</strong></span>
</pre></div><p>Also check using <code class="literal">ifconfig</code>, as some devices will be supported automatically, appear as <code class="literal">eth1</code> (or <code class="literal">eth0</code> on Model A), and be ready for use immediately.</p></div></div></div>
<div class="section" title="Connecting to the Internet through a proxy server"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec18"/>Connecting to the Internet through a proxy server</h1></div></div></div><p>Some networks, such as <a class="indexterm" id="id149"/>workplaces or schools, often require you to connect to the Internet through a proxy server.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec35"/>Getting ready</h2></div></div></div><p>You will need the address of the proxy server you are trying to connect to, including the username and password if one is required.</p><p>You should confirm that the Raspberry Pi is already connected to the network and that you can access the proxy server.</p><p>Use the <code class="literal">ping</code> command to check this as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>ping proxy.address.com -c 4</strong></span>
</pre></div><p>If this fails (you get no responses), you will need to ensure your network settings are correct before continuing.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec36"/>How to do it…</h2></div></div></div><p>Create a new file using <code class="literal">nano</code> as follows (if there is already some content in the file, you can add the code at the end):</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo nano -c ~/.bash_profile</strong></span>
</pre></div><p>To allow basic web browsing through<a class="indexterm" id="id150"/> programs such as <span class="strong"><strong>midori</strong></span>
<a class="indexterm" id="id151"/> while using a proxy server, you can use the following script:</p><div class="informalexample"><pre class="programlisting">function proxyenable {
# Define proxy settings
PROXY_ADDR="proxy.address.com:port"
# Login name (leave blank if not required):
LOGIN_USER="login_name"
# Login Password (leave blank to prompt):
LOGIN_PWD=
#If login specified - check for password
if [[ -z $LOGIN_USER ]]; then
  #No login for proxy
  PROXY_FULL=$PROXY_ADDR
else
  #Login needed for proxy Prompt for password -s option hides input
  if [[ -z $LOGIN_PWD ]]; then
    read -s -p "Provide proxy password (then Enter):" LOGIN_PWD
    echo
  fi
  PROXY_FULL=$LOGIN_USER:$LOGIN_PWD@$PROXY_ADDR
fi
#Web Proxy Enable: http_proxy or HTTP_PROXY environment variables
export http_proxy="http://$PROXY_FULL/"
export HTTP_PROXY=$http_proxy
export https_proxy="https://$PROXY_FULL/"
export HTTPS_PROXY=$https_proxy
export ftp_proxy="ftp://$PROXY_FULL/"
export FTP_PROXY=$ftp_proxy
#Set proxy for apt-get
sudo cat &lt;&lt;EOF | sudo tee /etc/apt/apt.conf.d/80proxy &gt; /dev/null
Acquire::http::proxy "http://$PROXY_FULL/";
Acquire::ftp::proxy "ftp://$PROXY_FULL/";
Acquire::https::proxy "https://$PROXY_FULL/";
EOF
#Remove info no longer needed from environment
unset LOGIN_USER LOGIN_PWD PROXY_ADDR PROXY_FULL
echo Proxy Enabled
}

function proxydisable {
#Disable proxy values, apt-get and git settings
unset http_proxy HTTP_PROXY https_proxy HTTPS_PROXY
unset ftp_proxy FTP_PROXY
sudo rm /etc/apt/apt.conf.d/80proxy
echo Proxy Disabled
}</pre></div><p>Once done, save and<a class="indexterm" id="id152"/> exit by pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>X</em></span>, <span class="emphasis"><em>Y</em></span>, and <span class="emphasis"><em>Enter</em></span>.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note16"/>Note</h3><p>The script is added to the user's own <code class="literal">.bash_profile</code> file, which is run when that particular user logs in. This will ensure that the proxy settings are kept separately for each user. If you want all users to use the same settings, you can add the code to <code class="literal">/etc/rc.local</code> instead (this file must have <code class="literal">exit 0</code> at the end).</p></div></div></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec37"/>How it works…</h2></div></div></div><p>Many programs that make use of the Internet will check for the <code class="literal">http_proxy</code> or <code class="literal">HTTP_PROXY</code> environment variables before connecting. If they are present, they will use the proxy settings to connect through. Some programs may also use the <code class="literal">HTTPS</code> and <code class="literal">FTP</code> protocols, so we can set the proxy setting for them here too.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note17"/>Note</h3><p>If a username is required for the proxy server, a password will be prompted for. It is generally not recommended to store your passwords inside scripts unless you are confident that no one else will have access to your device (either physically or through the Internet).</p></div></div><p>The last part allows any programs that execute using the <code class="literal">sudo</code> command to use the proxy environment variables while acting as the super user (most programs will try accessing the network using normal privileges first, even if running as a super user, so it isn't always needed).</p></div><div class="section" title="There's more…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec38"/>There's more…</h2></div></div></div><p>We also need to allow the proxy <a class="indexterm" id="id153"/>settings to be used by some programs, which use super user permissions while accessing the network (this will depend on the program; most don't need this). We need to add the commands into a file stored in <code class="literal">/etc/sudoers.d/</code> by performing the following steps:</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note18"/>Note</h3><p>It is important to use <code class="literal">visudo</code> here, as it ensures the permissions of the file are created correctly for the <code class="literal">sudoers</code> directory (read only by the <code class="literal">root</code> user).</p></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Use the following command to open a new <code class="literal">sudoer</code> file:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo visudo -f /etc/sudoers.d/proxy</strong></span>
</pre></div></li><li class="listitem">Enter the following text in the file (on a single line):<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Defaults env_keep += "http_proxy HTTP_PROXY https_proxy HTTPS_PROXY ftp_proxy FTP_PROXY"</strong></span>
</pre></div></li><li class="listitem">Once done, save and exit by pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>X</em></span>, <span class="emphasis"><em>Y</em></span>, and <span class="emphasis"><em>Enter</em></span>; don't change the <code class="literal">proxy.tmp</code> filename (this is normal for <code class="literal">visudo</code>; it will change it to proxy when finished).</li><li class="listitem">If prompted <code class="literal">What now?</code>, there is an error in the command. Press <span class="emphasis"><em>X</em></span> to exit without saving and retype the command!</li><li class="listitem">After a reboot (using <code class="literal">sudo reboot</code>), you will be able to use the following commands to enable and <a class="indexterm" id="id154"/>disable the proxy respectively:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>proxyenable</strong></span>
<span class="strong"><strong>proxydisable</strong></span>
</pre></div></li></ol></div></div></div>
<div class="section" title="Connecting remotely to the Raspberry Pi over the network using VNC"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec19"/>Connecting remotely to the Raspberry Pi over the network using VNC</h1></div></div></div><p>Often, it is preferable to <a class="indexterm" id="id155"/>remotely <a class="indexterm" id="id156"/>connect to and control the Raspberry Pi across the network, for instance, using a laptop or desktop computer as a screen and keyboard, or while the Raspberry Pi is connected elsewhere, perhaps even connected to some hardware it needs to be close to.</p><p>VNC is just one way in which you can remotely connect to the Raspberry Pi. It will create a new desktop session that will be controlled and accessed remotely. The VNC session here is separate from the one that may be active on the Raspberry Pi's display.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec39"/>Getting ready</h2></div></div></div><p>Ensure that your Raspberry Pi is powered up and connected to the Internet. We will use the Internet connection to install a program using <code class="literal">apt-get</code>. This is a program that allows us to find and install applications directly from the official repositories.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec40"/>How to do it…</h2></div></div></div><p>First, we need to install the <span class="strong"><strong>TightVNC</strong></span> server<a class="indexterm" id="id157"/> on the Raspberry Pi with the following commands. It is advisable to run an <code class="literal">update</code> command first to get the latest version of the package you want to install as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get update</strong></span>
<span class="strong"><strong>sudo apt-get install tightvncserver</strong></span>
</pre></div><p>Accept the prompt to install and wait until it completes. To start a session, use the following command to start a session:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>vncserver :1</strong></span>
</pre></div><p>The first time you run this, it will ask you to enter a password (of no more than eight characters) to access the desktop (you will use this when you connect from your computer).</p><p>The following message should confirm that a new desktop session has been started:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>New 'X' desktop is raspberrypi:1</strong></span>
</pre></div><p>If you do not already know the IP address of the Raspberry Pi, use <code class="literal">hostname –I</code> and take note of it.</p><p>Next, we need to run a VNC client, <span class="strong"><strong>VNC Viewer</strong></span>
<a class="indexterm" id="id158"/> is suitable program, which is available at <a class="ulink" href="http://www.realvnc.com/">http://www.realvnc.com/</a> and should work on Windows, Linux, and OS X.</p><p>When you run VNC Viewer, you will be prompted for the <span class="strong"><strong>Server</strong></span> address and <span class="strong"><strong>Encryption</strong></span> type. Use the IP address of your Raspberry Pi with <code class="literal">:1</code>. That is, for the IP address <span class="strong"><strong>192.168.1.69</strong></span>, use the <code class="literal">192.168.1.69:1</code> address.</p><p>You can leave the Encryption type as <span class="strong"><strong>Off</strong></span> or <span class="strong"><strong>Automatic</strong></span>.</p><p>Depending on your network, you may be able to use the hostname; the default is <span class="strong"><strong>raspberrypi</strong></span>, that is <code class="literal">raspberrypi:1</code>.</p><p>You may have a <a class="indexterm" id="id159"/>warning about not having<a class="indexterm" id="id160"/> connected to the computer before or having no encryption. You should enable encryption if you are using a public network or if you are performing connections over the Internet (to stop others from being able to intercept your data).</p></div><div class="section" title="There's more…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec41"/>There's more…</h2></div></div></div><p>You can add options to the command line to specify the resolution and also the color depth of the display. The higher the resolution and color depth (can be adjusted to use 8 to 32 bits per pixel to provide low or high color detail), the more data has to be transferred through the network link. If you find the refresh rate a little slow, try reducing these numbers as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>vncserver :1 –geometry 1280x780 –depth 24</strong></span>
</pre></div><p>To allow the VNC server to start automatically when you switch on, you can add the <code class="literal">vncserver</code> command to <code class="literal">.bash_profile</code> (this is executed each time the Raspberry Pi starts).</p><p>Use the <code class="literal">nano</code> editor as follows (the <code class="literal">-c</code> option allows the line numbers to be displayed):</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo nano -c ~/.bash_profile</strong></span>
</pre></div><p>Add the following line to the end of the file:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>vncserver :1</strong></span>
</pre></div><p>The next time you power up, you should be able to remotely connect using VNC from another computer.</p></div></div>
<div class="section" title="Connecting remotely to the Raspberry Pi over the network using SSH (and X11 Forwarding)"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec20"/>Connecting remotely to the Raspberry Pi over the network using SSH (and X11 Forwarding)</h1></div></div></div><p>An <span class="strong"><strong>SSH</strong></span> (<span class="strong"><strong>Secure SHell</strong></span>)<a class="indexterm" id="id161"/> is often<a class="indexterm" id="id162"/> the preferred method for making remote connections, as it allows only the terminal <a class="indexterm" id="id163"/>connections and typically requires fewer resources.</p><p>An extra feature of SSH is the ability to transfer the <span class="strong"><strong>X11</strong></span> data to an <span class="strong"><strong>X Windows</strong></span> server running on your machine. This allows you to start programs that would normally run on the Raspberry Pi desktop, and they will appear in their own Windows on the local computer, as follows:</p><div class="mediaobject"><img alt="Connecting remotely to the Raspberry Pi over the network using SSH (and X11 Forwarding)" src="graphics/6623OT_01_032.jpg"/><div class="caption"><p>X11 Forwarding on a local display</p></div></div><p>X Forwarding can be<a class="indexterm" id="id164"/> used to display applications, which<a class="indexterm" id="id165"/> are running on the Raspberry Pi, on a Windows computer.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec42"/>Getting ready</h2></div></div></div><p>If you are running the latest version of Raspbian, SSH and X11 Forwarding will be enabled by default (otherwise, double-check the settings explained in the <span class="emphasis"><em>How it works…</em></span> section).</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec43"/>How to do it…</h2></div></div></div><p>Linux and OS X have built-in support for X11 Forwarding; but if you are using Windows, you will need to install and run the X Windows server on your computer.</p><p>Download and run <code class="literal">xming</code> from the <span class="strong"><strong>Xming</strong></span>
<a class="indexterm" id="id166"/> site (<a class="ulink" href="http://sourceforge.net/projects/xming/">http://sourceforge.net/projects/xming/</a>).</p><p>Install <code class="literal">xming</code>, following the installation steps, including the installation of <span class="strong"><strong>PuTTY</strong></span> if you don't have it already. You can also download PuTTY separately from <a class="ulink" href="http://www.putty.org/">http://www.putty.org/</a>.</p><p>Next, we need to ensure that the SSH program we use has X11 enabled when we connect.</p><p>For Windows, we shall use PuTTY to connect to the Raspberry Pi.</p><p>In the <span class="strong"><strong>PuTTY Configuration</strong></span> dialog<a class="indexterm" id="id167"/> box, navigate to <span class="strong"><strong>Connection</strong></span> | <span class="strong"><strong>SSH</strong></span> | <span class="strong"><strong>X11</strong></span> and tick the checkbox for <span class="strong"><strong>X11 Forwarding</strong></span>. If you leave the <span class="strong"><strong>X display location</strong></span> option blank, it will assume the default <code class="literal">Server 0:0</code> as follows (you can <a class="indexterm" id="id168"/>confirm the server number by moving your mouse over the Xming icon in the system tray when it is running):</p><div class="mediaobject"><img alt="How to do it…" src="graphics/6623OT_01_033.jpg"/><div class="caption"><p>Enabling X11 Forwarding within the PuTTY configuration</p></div></div><p>Enter the IP address of the<a class="indexterm" id="id169"/> Raspberry Pi in the <span class="strong"><strong>Session</strong></span> settings (you may also find that you can use the Raspberry Pi's hostname here <a class="indexterm" id="id170"/>instead; the default hostname is <code class="literal">raspberrypi</code>).</p><p>Save the setting using a suitable name, <code class="literal">RaspberryPi</code>, and click on <span class="strong"><strong>Open</strong></span> to connect to your Raspberry Pi.</p><p>You are likely to see a warning message pop up stating you haven't connected to the computer before (this allows you to check whether you have everything right before continuing).</p><div class="mediaobject"><img alt="How to do it…" src="graphics/6623OT_01_034.jpg"/><div class="caption"><p>Opening an SSH connection to the Raspberry Pi using PuTTY</p></div></div><p>For OS X or Linux, click<a class="indexterm" id="id171"/> on <span class="strong"><strong>Terminal</strong></span> to open a connection <a class="indexterm" id="id172"/>to the Raspberry Pi.</p><p>To connect with the default <code class="literal">pi</code> username, with an IP address of <code class="literal">192.168.1.69</code>, use the following command; the <code class="literal">-X</code> option enables X11 Forwarding:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>ssh -X pi@192.168.1.69</strong></span>
</pre></div><p>All being well, you should be greeted with a prompt for your password (remember the default value for the <code class="literal">pi</code> user is <code class="literal">raspberry</code>).</p><p>Ensure that you have Xming running by starting the Xming program from your computer's Start menu. Then, in the terminal window, type a program that normally runs within the Raspberry Pi desktop, such as <code class="literal">leafpad</code> or <code class="literal">scratch</code>. Wait a little while and the program should appear on your computer's desktop (if you get an error, you have probably forgotten to start Xming, so run it and try again).</p></div><div class="section" title="How it works…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec44"/>How it works…</h2></div></div></div><p>X Windows and X11 is what provides the method by which the Raspberry Pi (and many other Linux-based computers) can display and control graphical Windows as part of a desktop.</p><p>For X11 Forwarding to <a class="indexterm" id="id173"/>work over a network connection, we <a class="indexterm" id="id174"/>need both SSH and X11 Forwarding enabled on the Raspberry Pi. Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">To switch on (or off) SSH, you can access the <span class="strong"><strong>Raspberry Pi Configuration</strong></span> program under the <span class="strong"><strong>Preferences</strong></span> menu on the <span class="strong"><strong>Desktop</strong></span> and click on <span class="strong"><strong>SSH</strong></span> within the <span class="strong"><strong>Interfaces</strong></span> tab, as shown in the following screenshot (SSH is often enabled by default for most distributions to help allow remote connections without needing a monitor to configure it):<div class="mediaobject"><img alt="How it works…" src="graphics/6623OT_01_035.jpg"/><div class="caption"><p>The Interfaces tab in the Raspberry Pi Configuration tool</p></div></div></li><li class="listitem">Ensure that X11 Forwarding is enabled on the Raspberry Pi (again most distributions now have this enabled by default).</li><li class="listitem">Use <code class="literal">nano</code> with the following command:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo nano /etc/ssh/sshd_config</strong></span>
</pre></div></li><li class="listitem">Look for a line in the <code class="literal">/etc/ssh/sshd_config</code> file that controls X11 Forwarding and ensure that it says <code class="literal">yes</code> (with no <code class="literal">#</code> sign before it), as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>X11Forwarding yes</strong></span>
</pre></div></li><li class="listitem">Save if required<a class="indexterm" id="id175"/> by pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>X</em></span>, <span class="emphasis"><em>Y</em></span>, and <span class="emphasis"><em>Enter</em></span> and <a class="indexterm" id="id176"/>reboot (if you need to change it) as follows:<div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo reboot</strong></span>
</pre></div></li></ol></div></div><div class="section" title="There's more…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec45"/>There's more…</h2></div></div></div><p>SSH and X 11 Forwarding is a convenient way to control the Raspberry Pi remotely; we will explore some additional tips on how to use it effectively in the following sections.</p><div class="section" title="Running multiple programs with X11 Forwarding"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec19"/>Running multiple programs with X11 Forwarding</h3></div></div></div><p>If you<a class="indexterm" id="id177"/> want to run an <span class="strong"><strong>X program</strong></span>, but still be able to use the<a class="indexterm" id="id178"/> same terminal console for other stuff, you can run the command in the background with <code class="literal">&amp;</code> as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>leafpad &amp;</strong></span>
</pre></div><p>Just remember that the more programs you run, the slower everything will get. You can switch to the background program by typing <code class="literal">fg</code> and check for background tasks with <code class="literal">bg</code>.</p></div><div class="section" title="Running as a desktop with X11 Forwarding"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec20"/>Running as a desktop with X11 Forwarding</h3></div></div></div><p>You can even <a class="indexterm" id="id179"/>run a complete desktop session through X11, although <a class="indexterm" id="id180"/>it isn't particularly user-friendly and VNC will produce better results. To achieve this, you have to use <code class="literal">lxsession</code> instead of <code class="literal">startx</code> (in the way you would normally start the desktop from the terminal).</p><p>An alternative is to use <code class="literal">lxpanel</code>, which provides the program menu bar from which you can start and run programs from the menu as you would on the desktop.</p></div><div class="section" title="Running PyGame and Tkinter with X11 Forwarding"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec21"/>Running PyGame and Tkinter with X11 Forwarding</h3></div></div></div><p>You can <a class="indexterm" id="id181"/>get the <a class="indexterm" id="id182"/>following error (or similar)<a class="indexterm" id="id183"/> when running<a class="indexterm" id="id184"/> the <span class="strong"><strong>PyGame</strong></span> or <span class="strong"><strong>Tkinter</strong></span> scripts:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>_tkinter.TclError: couldn't connect to display "localhost:10.0"</strong></span>
</pre></div><p>In this case, use the following command to fix the error:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo cp ~/.Xauthority ~root/</strong></span>
</pre></div></div></div></div>
<div class="section" title="Sharing the home folder of the Raspberry Pi with SMB"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec21"/>Sharing the home folder of the Raspberry Pi with SMB</h1></div></div></div><p>When you have the <a class="indexterm" id="id185"/>Raspberry Pi connected to your <a class="indexterm" id="id186"/>network, you can access the home folder by setting up file sharing; this makes it much easier to transfer files and provides a quick and easy way to back up your data. <span class="strong"><strong>Server Message Block</strong></span> (<span class="strong"><strong>SMB</strong></span>) is <a class="indexterm" id="id187"/>a protocol that is compatible with Windows file sharing, OS X, and Linux.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec46"/>Getting ready</h2></div></div></div><p>Ensure that you have the Raspberry Pi powered and running with a working connection to the Internet.</p><p>You will also need another computer on the same local network to test the new share.</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec47"/>How to do it…</h2></div></div></div><p>First, we need to install <code class="literal">samba</code>, a piece of software that handles folder sharing in a format that is compatible with Windows sharing methods.</p><p>Ensure that you use <code class="literal">update</code> as follows to obtain the latest list of available packages:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get update</strong></span>
<span class="strong"><strong>sudo apt-get install samba</strong></span>
</pre></div><p>The install will require around 20 MB of space and take a few minutes.</p><p>Once the install has completed, we can make a copy of the configuration file as follows to allow us to restore to defaults if needed:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.backup</strong></span>
<span class="strong"><strong>sudo nano /etc/samba/smb.conf</strong></span>
</pre></div><p>Scroll down and find the section named <code class="literal">Authentication</code>; change the <code class="literal">#   security = user</code> line to <code class="literal">security = user</code>.</p><p>As described in the file, this setting ensures that you have to enter your username and password for the Raspberry Pi in order to access the files (this is important for shared networks).</p><p>Find the section called <code class="literal">Share Definitions</code> and <code class="literal">[homes]</code>, and change the <code class="literal">read only = yes</code> line to <code class="literal">read only = no</code>.</p><p>This will allow us to view and also write files to the shared home folder. Once done, save and exit by pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>X</em></span>, <span class="emphasis"><em>Y</em></span>, and <span class="emphasis"><em>Enter</em></span>.</p><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note19"/>Note</h3><p>If you have changed the default user from <code class="literal">pi</code> to something else, substitute it in the following instructions.</p></div></div><p>Now, we can <a class="indexterm" id="id188"/>add <code class="literal">pi</code> (the default user) to <a class="indexterm" id="id189"/>use <code class="literal">samba</code>:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo pdbedit -a -u pi</strong></span>
</pre></div><p>Now, enter a password (you can use the same password as your login or select a different one, but avoid using the default Raspberry password, which would be very easy for someone to guess). Restart <code class="literal">samba</code> to use the new configuration file, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo /etc/init.d/samba restart</strong></span>
<span class="strong"><strong>[ ok ] Stopping Samba daemons: nmbd smbd.</strong></span>
<span class="strong"><strong>[ ok ] Starting Samba daemons: nmbd smbd.</strong></span>
</pre></div><p>In order to test, you will need to know either the Raspberry Pi's hostname (the default hostname is <code class="literal">raspberrypi</code>) or its IP address. You can find both of these with the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>hostname</strong></span>
</pre></div><p>For the IP address, add <code class="literal">-I</code>:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>hostname –I</strong></span>
</pre></div><p>On another computer on the<a class="indexterm" id="id190"/> network, enter <a class="indexterm" id="id191"/>the <code class="literal">\\raspberrypi\pi</code> address in the explorer path.</p><p>Depending on your network, the computer should locate the Raspberry Pi on the network and prompt for a username and password. If it can't find the share using the hostname, you can use the IP address directly, where <code class="literal">192.168.1.69</code> should be changed to match the IP address <code class="literal">\\192.168.1.69\pi</code>.</p></div></div>
<div class="section" title="Keeping the Raspberry Pi up to date"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec22"/>Keeping the Raspberry Pi up to date</h1></div></div></div><p>The Linux image used by the<a class="indexterm" id="id192"/> Raspberry Pi is often updated to include enhancements, fixes, and improvements to the system, as well as adding support for new hardware or changes made to the latest board. Many of the packages that you install can be updated too.</p><p>This is particularly important if you plan on using the same system image on another Raspberry Pi board (particularly a newer one) as older images will lack support for any wiring changes or alternative RAM chips. New firmware should work on older Raspberry Pi boards, but older firmware may not be compatible with the latest hardware.</p><p>Fortunately, you need not reflash your SD card every time there is a new release, since you can update it instead.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec48"/>Getting ready</h2></div></div></div><p>You will need to be connected to the Internet in order to update your system. It is always advisable to make a backup of your image first (and at a minimum, take a copy of your important files).</p><p>You can check your current version of firmware with the <code class="literal">uname -a</code> command, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>Linux raspberrypi 4.4.9-v7+ #884 SMP Fri May 6 17:28:59 BST 2016 armv7l GNU/Linux</strong></span>
</pre></div><p>The GPU firmware can be checked using the <code class="literal">/opt/vc/bin/vcgencmd version</code> command, as follows:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>   May  6 2016 13:53:23</strong></span>
<span class="strong"><strong>Copyright (c) 2012 Broadcom</strong></span>
<span class="strong"><strong>version 0cc642d53eab041e67c8c373d989fef5847448f8 (clean) (release) </strong></span>
This is important if you are using an older version of firmware (pre-November 2012) on a newer board since the original Model B board was only 254 MB RAM. Upgrading allows the firmware to make use of the extra memory if available.</pre></div><p>The <code class="literal">free -h</code> command will detail the RAM available to the main processor (the total RAM is split between the GPU and ARM cores) and will give the following output:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>             total       used       free     shared    buffers     cached</strong></span>
<span class="strong"><strong>Mem:          925M       224M       701M       7.1M        14M       123M</strong></span>
<span class="strong"><strong>-/+ buffers/cache:        86M       839M</strong></span>
<span class="strong"><strong>Swap:          99M         0B        99M</strong></span>
</pre></div><p>You can then recheck the preceding output following a reboot to confirm that they have been updated (although they may have already been the latest).</p></div><div class="section" title="How to do it…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec49"/>How to do it…</h2></div></div></div><p>Before running any <a class="indexterm" id="id193"/>upgrades or installing any packages, it is worth ensuring you have the latest list of packages in the repository. The <code class="literal">update</code> command gets the latest list of available software and versions:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get update</strong></span>
</pre></div><p>If you just want to obtain an upgrade of your current packages, <code class="literal">upgrade</code> will bring them all up to date:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get upgrade</strong></span>
</pre></div><p>To ensure that you are running the latest release of Raspbian, you can run <code class="literal">dist-upgrade</code> (be warned; this can take an hour or so depending on the amount that needs to be upgraded). This will perform all the updates that <code class="literal">upgrade</code> will perform but will also remove redundant packages and clean up:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>sudo apt-get dist-upgrade</strong></span>
</pre></div><p>Both methods will upgrade the software, including the firmware used at boot and startup (<code class="literal">bootcode.bin</code> and <code class="literal">start.elf</code>).</p></div><div class="section" title="There's more…"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec50"/>There's more…</h2></div></div></div><p>You will often find that you will want to perform a clean installation of your setup; however, this will mean you will have to install everything from scratch. To avoid this, I developed the <a class="indexterm" id="id194"/>Pi-Kitchen project (<a class="ulink" href="https://github.com/PiHw/Pi-Kitchen">https://github.com/PiHw/Pi-Kitchen</a>), based on the groundwork of Kevin Hill. This aims to provide a flexible platform for creating customized setups that can be automatically deployed to an SD card.</p><div class="mediaobject"><img alt="There's more…" src="graphics/6623OT_01_036.jpg"/><div class="caption"><p>Pi Kitchen allows the Raspberry Pi be configured before powering up</p></div></div><p>The Pi-Kitchen<a class="indexterm" id="id195"/> allows a range of flavors to be configured, which can be selected from the NOOBS menu. Each flavor consists of a list of recipes, each providing a specific function or feature to the final operating system. Recipes can range from setting up custom drivers for Wi-Fi devices, to mapping shared drives on your network, to providing a fully functional web server out of the box, all combining to make your required setup.</p><p>This project is in beta, developed as a proof of concept, but once you have everything configured, it can be incredibly useful to deploy fully working setups directly onto an SD card. Ultimately, the project could be combined with Kevin Hill's advanced version of NOOBS, called PINN (short for PINN Is Not NOOBS), which aims to allow extra features for advanced users, such as allowing operating systems and configurations to be stored on your network or on an external USB memory stick.</p></div></div></body></html>