<html><head></head><body>
<section data-number="0.9" id="chapter-6-user-inputs-and-outputs">
<h2 class="likechapterhead" data-number="0.9"><span><span class="kobospan" id="kobo.1.1">6</span></span><br class="tipbox1"/> <span id="x1-3300006"/><span class="kobospan" id="kobo.2.1">User Inputs and Outputs</span></h2>
<p class="normal"><span class="kobospan" id="kobo.3.1">The key purpose of software is to produce useful output. </span><span class="kobospan" id="kobo.3.2">Of the many possible outputs, one simple type of output is text displaying a useful result. </span><span class="kobospan" id="kobo.3.3">Python supports this with the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.4.1">print()</span></span></span></span><span class="kobospan" id="kobo.5.1"> function.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.6.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.7.1">input()</span></span></span></span><span class="kobospan" id="kobo.8.1"> function has a parallel with the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.9.1">print()</span></span></span></span><span class="kobospan" id="kobo.10.1"> function. </span><span class="kobospan" id="kobo.10.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.11.1">input()</span></span></span></span><span class="kobospan" id="kobo.12.1"> function reads text from a console, allowing us to provide data to our programs. </span><span class="kobospan" id="kobo.12.2">The use of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.13.1">print()</span></span></span></span><span class="kobospan" id="kobo.14.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.15.1">input()</span></span></span></span><span class="kobospan" id="kobo.16.1"> creates an elegant symmetry between input and output from an application.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.17.1">There are a number of other common ways to provide input to a program. </span><span class="kobospan" id="kobo.17.2">Parsing the command line is helpful for many applications. </span><span class="kobospan" id="kobo.17.3">We sometimes need to use configuration files to provide useful input. </span><span class="kobospan" id="kobo.17.4">Data files and network connections are yet more ways to provide input. </span><span class="kobospan" id="kobo.17.5">Each of these methods is distinct and needs to be looked at separately. </span><span class="kobospan" id="kobo.17.6">In this chapter, we’ll focus on the fundamentals of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.18.1">input()</span></span></span></span><span class="kobospan" id="kobo.19.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.20.1">print()</span></span></span></span><span class="kobospan" id="kobo.21.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.22.1">In this chapter, we’ll look at the following recipes:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><a href="ch010.xhtml#x1-3310001" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.23.1">Using the features of the print() function</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch010.xhtml#x1-3370002" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.24.1">Using input() and getpass() for user input</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch010.xhtml#x1-3430003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.25.1">Debugging with f”</span></span><span><span class="kobospan" id="kobo.26.1">{</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.27.1">value=</span></span><span><span class="kobospan" id="kobo.28.1">}</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.29.1">” strings</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch010.xhtml#x1-3490004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.30.1">Using argparse to get command-line input</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch010.xhtml#x1-3550005" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.31.1">Using invoke to get command-line input</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch010.xhtml#x1-3610006" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.32.1">Using cmd to create command-line applications</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch010.xhtml#x1-3670007" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.33.1">Using the OS environment settings</span></span></a></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.34.1">It seems best to start with the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.35.1">print()</span></span></span></span><span class="kobospan" id="kobo.36.1"> function and show several of the things it can do. </span><span class="kobospan" id="kobo.36.2">After all, it’s often the output from an application that is most useful. </span><span id="x1-330001r659"/></p>
<section data-number="0.9.1" id="using-the-features-of-the-print-function">
<h1 class="unnumbered" data-number="0.9.1"><span><span class="kobospan" id="kobo.37.1">6.1 </span></span> <span id="x1-3310001"/><span class="kobospan" id="kobo.38.1">Using the features of the print() function</span></h1>
<p class="normal"><span class="kobospan" id="kobo.39.1">In many cases, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.40.1">print()</span></span></span></span><span class="kobospan" id="kobo.41.1"> function</span><span id="dx1-331001"/><span class="kobospan" id="kobo.42.1"> is the first function we learn about. </span><span class="kobospan" id="kobo.42.2">The first script is often a variation on the following:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.43.1">
 
 
&gt;&gt;&gt; print("Hello, world.") 
 
Hello, world.</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.44.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.45.1">print()</span></span></span></span><span class="kobospan" id="kobo.46.1"> function can display multiple values, with helpful spaces between items.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.47.1">When we write this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.48.1">
 
 
&gt;&gt;&gt; count = 9973 
 
&gt;&gt;&gt; print("Final count", count) 
 
Final count 9973</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.49.1">We can see that a space separator is included for us. </span><span class="kobospan" id="kobo.49.2">Additionally, a line break, usually represented by the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.50.1">\n</span></span></span></span><span class="kobospan" id="kobo.51.1"> character, is printed after the values provided in the function.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.52.1">Can we control this formatting? </span><span class="kobospan" id="kobo.52.2">Can we change the extra characters that are supplied? </span><span id="x1-331009r657"/></p>
<section data-number="0.9.1.1" id="getting-ready-45">
<h2 class="likechapterhead" data-number="0.9.1.1"><span><span class="kobospan" id="kobo.53.1">6.1.1 </span></span> <span id="x1-3320001"/><span class="kobospan" id="kobo.54.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.55.1">Consider this spreadsheet, used to record fuel consumption on a large sailboat. </span><span class="kobospan" id="kobo.55.2">The CSV file has rows that look like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.56.1">
 
 
date,engine on,fuel height on,engine off,fuel height off 
 
10/25/13,08:24:00,29,13:15:00,27 
 
10/26/13,09:12:00,27,18:25:00,22 
 
10/28/13,13:21:00,22,06:25:00,14</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.57.1">For more information</span><span id="dx1-332006"/><span class="kobospan" id="kobo.58.1"> on this data, refer to the </span><a href="ch008_split_001.xhtml#x1-2750008" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.59.1">Shrinking sets – remove(), pop(),</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.60.1">and difference</span></span></a><span class="kobospan" id="kobo.61.1"> and </span><a href="ch008_split_000.xhtml#x1-2400003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.62.1">Slicing and dicing a list</span></span></a><span class="kobospan" id="kobo.63.1"> recipes in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.64.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.65.1"> </span></span><a href="ch008_split_000.xhtml#x1-2240004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.66.1">4</span></span></a><span class="kobospan" id="kobo.67.1">. </span><span class="kobospan" id="kobo.67.2">Instead of a sensor inside the tank, the depth of fuel is observed through a glass panel on the side of the tank. </span><span class="kobospan" id="kobo.67.3">Knowing the tank is approximately rectangular, with a full depth of about 31 inches and a volume of about 72 gallons, it’s possible to convert depth to volume.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.68.1">Here’s an example of using this CSV data. </span><span class="kobospan" id="kobo.68.2">This function reads the file and returns a list of fields built from each row:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.69.1">
 
 
from pathlib import Path 
 
import csv 
 
 
 
def get_fuel_use(source_path: Path) -&gt; list[dict[str, str]]: 
 
    with source_path.open() as source_file: 
 
        rdr = csv.DictReader(source_file) 
 
        return list(rdr)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.70.1">Here’s an example of reading and printing rows from the CSV file:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.71.1">
                                                                     

                                                                     
 
 
&gt;&gt;&gt; source_path = Path("data/fuel2.csv") 
 
&gt;&gt;&gt; fuel_use = get_fuel_use(source_path) 
 
&gt;&gt;&gt; for row in fuel_use: 
 
... </span><span class="kobospan" id="kobo.71.2">    print(row) 
 
{’date’: ’10/25/13’, ’engine on’: ’08:24:00’, ’fuel height on’: ’29’, ’engine off’: ’13:15:00’, ’fuel height off’: ’27’} 
 
{’date’: ’10/26/13’, ’engine on’: ’09:12:00’, ’fuel height on’: ’27’, ’engine off’: ’18:25:00’, ’fuel height off’: ’22’} 
 
{’date’: ’10/28/13’, ’engine on’: ’13:21:00’, ’fuel height on’: ’22’, ’engine off’: ’06:25:00’, ’fuel height off’: ’14’}</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.72.1">The output from the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.73.1">print()</span></span></span></span><span class="kobospan" id="kobo.74.1"> function, shown here in long lines, is challenging to use. </span><span class="kobospan" id="kobo.74.2">Let’s look at how we can improve this output using additional features of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.75.1">print()</span></span></span></span><span class="kobospan" id="kobo.76.1"> function. </span><span id="x1-332023r665"/></p>
</section>
<section data-number="0.9.1.2" id="how-to-do-it...-45">
<h2 class="likechapterhead" data-number="0.9.1.2"><span><span class="kobospan" id="kobo.77.1">6.1.2 </span></span> <span id="x1-3330002"/><span class="kobospan" id="kobo.78.1">How to do it...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.79.1">We have two ways</span><span id="dx1-333001"/><span class="kobospan" id="kobo.80.1"> to control the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.81.1">print()</span></span></span></span><span class="kobospan" id="kobo.82.1"> function output format:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.83.1">Set the inter-field separator string, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.84.1">sep</span></span></span></span><span class="kobospan" id="kobo.85.1">. </span><span class="kobospan" id="kobo.85.2">The default value is a single-space character.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.86.1">Set the end-of-line string, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.87.1">end</span></span></span></span><span class="kobospan" id="kobo.88.1">. </span><span class="kobospan" id="kobo.88.2">The default value is the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.89.1">\n</span></span></span></span><span class="kobospan" id="kobo.90.1"> character.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.91.1">This recipe will show several variations:</span></p>
<ol class="calibre4">
<li class="calibre7"><div id="x1-333003x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.92.1">Read the data:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.93.1">
                                                                     

                                                                     
&gt;&gt;&gt; fuel_use = get_fuel_use(Path("data/fuel2.csv"))</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-333007x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.94.1">For each item in the data, make any useful data conversions:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.95.1">
&gt;&gt;&gt; for leg in fuel_use: 
 
... </span><span class="kobospan" id="kobo.95.2">    start = float(leg["fuel height on"]) 
 
... </span><span class="kobospan" id="kobo.95.3">    finish = float(leg["fuel height off"])</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-333013x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.96.1">The following alternatives show different ways to include separators:</span></p>
<ul class="calibre17">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.97.1">Print labels and fields using the default values of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.98.1">sep</span></span></span></span><span class="kobospan" id="kobo.99.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.100.1">end</span></span></span></span><span class="kobospan" id="kobo.101.1">:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.102.1">
           
 
... </span><span class="kobospan" id="kobo.102.2">    print("On", leg["date"], "from", leg["engine on"], 
 
... </span><span class="kobospan" id="kobo.102.3">        "to", leg["engine off"], 
 
... </span><span class="kobospan" id="kobo.102.4">        "change", start-finish, "in.") 
 
On 10/25/13 from 08:24:00 to 13:15:00 change 2.0 in. 
 
On 10/26/13 from 09:12:00 to 18:25:00 change 5.0 in. 
 
On 10/28/13 from 13:21:00 to 06:25:00 change 8.0 in.
          
          </span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.103.1">When we look at the output, we can see where a space was inserted between each item.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.104.1">When preparing data, we might want to use a format that’s similar to CSV, perhaps using a column separator that’s not a simple comma. </span><span class="kobospan" id="kobo.104.2">We can print labels and fields using a string value of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.105.1">"</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.106.1"> |</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.107.1"> "</span></span></span></span><span class="kobospan" id="kobo.108.1"> for the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.109.1">sep</span></span></span></span><span class="kobospan" id="kobo.110.1"> parameter:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.111.1">
           
 
... </span><span class="kobospan" id="kobo.111.2">    print(leg["date"], leg["engine on"], 
 
... </span><span class="kobospan" id="kobo.111.3">        leg["engine off"], start-finish, sep=" | ") 
 
10/25/13 | 08:24:00 | 13:15:00 | 2.0 
 
10/26/13 | 09:12:00 | 18:25:00 | 5.0 
 
10/28/13 | 13:21:00 | 06:25:00 | 8.0
          
          </span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.112.1">In this case, we can see that each column has the given separator string. </span><span class="kobospan" id="kobo.112.2">Since there were no changes to the end setting, each </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.113.1">print()</span></span></span></span><span class="kobospan" id="kobo.114.1"> function produces a distinct line of output.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.115.1">Here’s how we might change</span><span id="dx1-333027"/><span class="kobospan" id="kobo.116.1"> the default punctuation to emphasize the field name and value. </span><span class="kobospan" id="kobo.116.2">We can print labels and fields using a string value of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.117.1">"="</span></span></span></span><span class="kobospan" id="kobo.118.1"> for the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.119.1">sep</span></span></span></span><span class="kobospan" id="kobo.120.1"> parameter and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.121.1">",</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.122.1"> "</span></span></span></span><span class="kobospan" id="kobo.123.1"> for the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.124.1">end</span></span></span></span><span class="kobospan" id="kobo.125.1"> parameter:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.126.1">
           
 
... </span><span class="kobospan" id="kobo.126.2">    print("date", leg["date"], sep="=", end=", ") 
 
... </span><span class="kobospan" id="kobo.126.3">    print("on", leg["engine on"], sep="=", end=", ") 
 
... </span><span class="kobospan" id="kobo.126.4">    print("off", leg["engine off"], sep="=", end=", ") 
 
... </span><span class="kobospan" id="kobo.126.5">    print("change", start-finish, sep="=") 
 
date=10/25/13, on=08:24:00, off=13:15:00, change=2.0 
 
date=10/26/13, on=09:12:00, off=18:25:00, change=5.0 
 
date=10/28/13, on=13:21:00, off=06:25:00, change=8.0
          
          </span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.127.1">Since the string used at the end of the line was changed to </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.128.1">",</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.129.1"> "</span></span></span></span><span class="kobospan" id="kobo.130.1">, each use of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.131.1">print()</span></span></span></span><span class="kobospan" id="kobo.132.1"> function no longer produces separate lines. </span><span class="kobospan" id="kobo.132.2">In order to see a proper end of line, the final </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.133.1">print()</span></span></span></span><span class="kobospan" id="kobo.134.1"> function has a default value for </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.135.1">end</span></span></span></span><span class="kobospan" id="kobo.136.1">. </span><span class="kobospan" id="kobo.136.2">We could also have used an argument value of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.137.1">end="\n"</span></span></span></span><span class="kobospan" id="kobo.138.1"> to make the presence of the newline character explicit.</span></p></li>
</ul>
</div></li>
</ol>
<p class="normal1"><span id="x1-333036r669"/></p>
</section>
<section data-number="0.9.1.3" id="how-it-works...-45">
<h2 class="likechapterhead" data-number="0.9.1.3"><span><span class="kobospan" id="kobo.139.1">6.1.3 </span></span> <span id="x1-3340003"/><span class="kobospan" id="kobo.140.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.141.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.142.1">print()</span></span></span></span><span class="kobospan" id="kobo.143.1"> function has a definition that includes several parameters that must be provided as keywords. </span><span class="kobospan" id="kobo.143.2">Two of these are the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.144.1">sep</span></span></span></span><span class="kobospan" id="kobo.145.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.146.1">end</span></span></span></span><span class="kobospan" id="kobo.147.1"> keyword parameters, with default values of space and newline, respectively.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.148.1">Using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.149.1">print()</span></span></span></span><span class="kobospan" id="kobo.150.1"> function’s </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.151.1">sep</span></span></span></span><span class="kobospan" id="kobo.152.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.153.1">end</span></span></span></span><span class="kobospan" id="kobo.154.1"> parameters can get quite complex for anything more sophisticated than these simple examples. </span><span class="kobospan" id="kobo.154.2">Rather than working with a complex sequence of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.155.1">print()</span></span></span></span><span class="kobospan" id="kobo.156.1"> function</span><span id="dx1-334001"/><span class="kobospan" id="kobo.157.1"> requests, we can use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.158.1">format()</span></span></span></span><span class="kobospan" id="kobo.159.1"> method of a string, or use an f-string. </span><span id="x1-334002r675"/></p>
</section>
<section data-number="0.9.1.4" id="theres-more...-37">
<h2 class="likechapterhead" data-number="0.9.1.4"><span><span class="kobospan" id="kobo.160.1">6.1.4 </span></span> <span id="x1-3350004"/><span class="kobospan" id="kobo.161.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.162.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.163.1">sys</span></span></span></span><span class="kobospan" id="kobo.164.1"> module defines the two standard</span><span id="dx1-335001"/><span class="kobospan" id="kobo.165.1"> output files that are always available: </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.166.1">sys.stdout</span></span></span></span><span class="kobospan" id="kobo.167.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.168.1">sys.stderr</span></span></span></span><span class="kobospan" id="kobo.169.1">. </span><span class="kobospan" id="kobo.169.2">Generally, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.170.1">print()</span></span></span></span><span class="kobospan" id="kobo.171.1"> function can be thought of as a handy wrapper around </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.172.1">sys.stdout.write()</span></span></span></span><span class="kobospan" id="kobo.173.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.174.1">We can use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.175.1">file=</span></span></span></span><span class="kobospan" id="kobo.176.1"> keyword argument to write to the standard error file instead of writing to the standard output file:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.177.1">
 
 
&gt;&gt;&gt; import sys 
 
 
 
&gt;&gt;&gt; print("Red Alert!", file=sys.stderr)
                                                                     

                                                                     </span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.178.1">We’ve imported the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.179.1">sys</span></span></span></span><span class="kobospan" id="kobo.180.1"> module so that we have access to the standard error file. </span><span class="kobospan" id="kobo.180.2">We used this to write a message that will not be part of the standard output stream.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.181.1">Because these two files are always available, using OS file redirection techniques often works out nicely. </span><span class="kobospan" id="kobo.181.2">When our program’s primary output is written to </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.182.1">sys.stdout</span></span></span></span><span class="kobospan" id="kobo.183.1">, it can be redirected at the OS level. </span><span class="kobospan" id="kobo.183.2">A user might enter a shell command line like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.184.1">
 
 
% python myapp.py &lt; input.dat &gt; output.dat</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.185.1">This will provide the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.186.1">input.dat</span></span></span></span><span class="kobospan" id="kobo.187.1"> file as the input to </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.188.1">sys.stdin</span></span></span></span><span class="kobospan" id="kobo.189.1">. </span><span class="kobospan" id="kobo.189.2">When this Python program writes to </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.190.1">sys.stdout</span></span></span></span><span class="kobospan" id="kobo.191.1">, the output will be redirected by the OS to the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.192.1">output.dat</span></span></span></span><span class="kobospan" id="kobo.193.1"> file.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.194.1">In some cases, we need to open additional files. </span><span class="kobospan" id="kobo.194.2">In that case, we might see programming like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.195.1">
 
 
&gt;&gt;&gt; from pathlib import Path 
 
&gt;&gt;&gt; target_path = Path("data")/"extra_detail.log" 
 
&gt;&gt;&gt; with target_path.open(’w’) as target_file: 
 
... </span><span class="kobospan" id="kobo.195.2">    print("Some detailed output", file=target_file) 
 
... </span><span class="kobospan" id="kobo.195.3">    print("Ordinary log") 
 
Ordinary log</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.196.1">In this example, we’ve opened a specific path for the output and assigned the open file to </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.197.1">target_file</span></span></span></span><span class="kobospan" id="kobo.198.1">, using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.199.1">with</span></span></span></span><span class="kobospan" id="kobo.200.1"> statement. </span><span class="kobospan" id="kobo.200.2">We can then use this as the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.201.1">file=</span></span></span></span><span class="kobospan" id="kobo.202.1"> value in a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.203.1">print()</span></span></span></span><span class="kobospan" id="kobo.204.1"> function to write to this file. </span><span class="kobospan" id="kobo.204.2">Because a file is a context manager, leaving the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.205.1">with</span></span></span></span><span class="kobospan" id="kobo.206.1"> statement means that the file will be closed properly; all of the OS resources will be released from the application. </span><span class="kobospan" id="kobo.206.2">All file operations should be wrapped in a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.207.1">with</span></span></span></span><span class="kobospan" id="kobo.208.1"> statement context to ensure that the resources are properly released. </span><span id="x1-335015r676"/></p>
</section>
<section data-number="0.9.1.5" id="see-also-44">
<h2 class="likechapterhead" data-number="0.9.1.5"><span><span class="kobospan" id="kobo.209.1">6.1.5 </span></span> <span id="x1-3360005"/><span class="kobospan" id="kobo.210.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.211.1">For more formatting options, see the </span><a href="ch010.xhtml#x1-3430003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.212.1">Debugging with f”</span></span><span><span class="kobospan" id="kobo.213.1">{</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.214.1">value=</span></span><span><span class="kobospan" id="kobo.215.1">}</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.216.1">”</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.217.1">strings</span></span></a><span class="kobospan" id="kobo.218.1"> recipe.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.219.1">For more information on the input data in this example, refer to the </span><a href="ch008_split_001.xhtml#x1-2750008" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.220.1">Shrinking sets – remove(), pop(), and difference</span></span></a><span class="kobospan" id="kobo.221.1"> and </span><a href="ch008_split_000.xhtml#x1-2400003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.222.1">Slicing and dicing</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.223.1">a list</span></span></a><span class="kobospan" id="kobo.224.1"> recipes in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.225.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.226.1"> </span></span><a href="ch008_split_000.xhtml#x1-2240004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.227.1">4</span></span></a><span class="kobospan" id="kobo.228.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.229.1">For more information on file operations in general, refer to </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.230.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.231.1"> </span></span><a href="ch012.xhtml#x1-4520008" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.232.1">8</span></span></a></p></li>
</ul>
<p class="normal1"><span id="x1-336001r662"/></p>
</section>
</section>
<section data-number="0.9.2" id="using-input-and-getpass-for-user-input">
<h1 class="unnumbered" data-number="0.9.2"><span><span class="kobospan" id="kobo.233.1">6.2 </span></span> <span id="x1-3370002"/><span class="kobospan" id="kobo.234.1">Using input() and getpass() for user input</span></h1>
<p class="normal"><span class="kobospan" id="kobo.235.1">Some Python scripts</span><span id="dx1-337001"/><span class="kobospan" id="kobo.236.1"> depend on gathering input</span><span id="dx1-337002"/><span class="kobospan" id="kobo.237.1"> from a user. </span><span class="kobospan" id="kobo.237.2">There</span><span id="dx1-337003"/><span class="kobospan" id="kobo.238.1"> are several ways</span><span id="dx1-337004"/><span class="kobospan" id="kobo.239.1"> to do this. </span><span class="kobospan" id="kobo.239.2">One popular technique is to use the console to prompt a user for input interactively.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.240.1">There are two relatively common situations:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.241.1">Ordinary input</span></span><span class="kobospan" id="kobo.242.1">: This will provide a helpful</span><span id="dx1-337005"/><span class="kobospan" id="kobo.243.1"> echo of the characters being entered.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.244.1">Secure, no echo input</span></span><span class="kobospan" id="kobo.245.1">: This is often used</span><span id="dx1-337006"/><span class="kobospan" id="kobo.246.1"> for passwords. </span><span class="kobospan" id="kobo.246.2">The characters entered aren’t displayed, providing a degree of privacy. </span><span class="kobospan" id="kobo.246.3">We use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.247.1">getpass()</span></span></span></span><span class="kobospan" id="kobo.248.1"> function in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.249.1">getpass</span></span></span></span><span class="kobospan" id="kobo.250.1"> module for this.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.251.1">As an alternative to interactive input, we’ll look at some other approaches in the </span><a href="ch010.xhtml#x1-3490004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.252.1">Using argparse to get command-line input</span></span></a><span class="kobospan" id="kobo.253.1"> recipe later in this chapter.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.254.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.255.1">input()</span></span></span></span><span class="kobospan" id="kobo.256.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.257.1">getpass()</span></span></span></span><span class="kobospan" id="kobo.258.1"> functions are just two implementation choices to read from the console. </span><span class="kobospan" id="kobo.258.2">It turns out that getting the string of characters is only the first step in gathering useful data. </span><span class="kobospan" id="kobo.258.3">The input also needs to be validated. </span><span id="x1-337007r680"/></p>
<section data-number="0.9.2.1" id="getting-ready-46">
<h2 class="likechapterhead" data-number="0.9.2.1"><span><span class="kobospan" id="kobo.259.1">6.2.1 </span></span> <span id="x1-3380001"/><span class="kobospan" id="kobo.260.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.261.1">We’ll look at a technique</span><span id="dx1-338001"/><span class="kobospan" id="kobo.262.1"> to read a complex</span><span id="dx1-338002"/><span class="kobospan" id="kobo.263.1"> structure</span><span id="dx1-338003"/><span class="kobospan" id="kobo.264.1"> from a person. </span><span class="kobospan" id="kobo.264.2">In this</span><span id="dx1-338004"/><span class="kobospan" id="kobo.265.1"> case, we’ll use year, month, and day as separate items. </span><span class="kobospan" id="kobo.265.2">These items are then combined to create a complete date.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.266.1">Here’s a quick example of user input that omits all of the validation considerations. </span><span class="kobospan" id="kobo.266.2">This is poor design:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.267.1">
 
 
from datetime import date 
 
 
 
def get_date1() -&gt; date: 
 
    year = int(input("year: ")) 
 
    month = int(input("month [1-12]: ")) 
 
    day = int(input("day [1-31]: ")) 
 
    result = date(year, month, day) 
 
    return result</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.268.1">While it is very easy to use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.269.1">input()</span></span></span></span><span class="kobospan" id="kobo.270.1"> function, it lacks a number of helpful features. </span><span class="kobospan" id="kobo.270.2">When the user enters an invalid date, this will raise a potentially confusing exception.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.271.1">We often need to wrap the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.272.1">input()</span></span></span></span><span class="kobospan" id="kobo.273.1"> function with data validation processing to make it more useful. </span><span class="kobospan" id="kobo.273.2">The calendar is complex, and we’d hate to accept February 31 without warning the user that it is not a proper date. </span><span id="x1-338014r682"/></p>
</section>
<section data-number="0.9.2.2" id="how-to-do-it...-46">
<h2 class="likechapterhead" data-number="0.9.2.2"><span><span class="kobospan" id="kobo.274.1">6.2.2 </span></span> <span id="x1-3390002"/><span class="kobospan" id="kobo.275.1">How to do it...</span></h2>
<ol class="calibre2">
<li class="calibre7"><div id="x1-339002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.276.1">If the input is a password or something equally subject to redaction, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.277.1">input()</span></span></span></span><span class="kobospan" id="kobo.278.1"> function isn’t the best choice. </span><span class="kobospan" id="kobo.278.2">If passwords or other secrets are involved, then use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.279.1">getpass.getpass()</span></span></span></span><span class="kobospan" id="kobo.280.1"> function. </span><span class="kobospan" id="kobo.280.2">This means we need the following import when secrets are involved:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.281.1">
from getpass import getpass</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.282.1">Otherwise, when secret input is not required, we’ll use the built-in </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.283.1">input()</span></span></span></span><span class="kobospan" id="kobo.284.1"> function, and no additional import is required.</span></p>
</div></li>
<li class="calibre7"><div id="x1-339006x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.285.1">Determine which prompt</span><span id="dx1-339007"/><span class="kobospan" id="kobo.286.1"> will be used. </span><span class="kobospan" id="kobo.286.2">In our example, we provided</span><span id="dx1-339008"/><span class="kobospan" id="kobo.287.1"> a field name and a hint about the type of data expected</span><span id="dx1-339009"/><span class="kobospan" id="kobo.288.1"> as the prompt</span><span id="dx1-339010"/><span class="kobospan" id="kobo.289.1"> string argument to the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.290.1">input()</span></span></span></span><span class="kobospan" id="kobo.291.1"> or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.292.1">getpass()</span></span></span></span><span class="kobospan" id="kobo.293.1"> functions. </span><span class="kobospan" id="kobo.293.2">It can help to separate the input from the text-to-integer conversion. </span><span class="kobospan" id="kobo.293.3">This recipe doesn’t follow the snippet shown previously; it breaks the operation into two separate steps. </span><span class="kobospan" id="kobo.293.4">First, get the text value:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.294.1">
    year_text = input("year: ")</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-339014x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.295.1">Determine how to validate each item in isolation. </span><span class="kobospan" id="kobo.295.2">The simplest case is a single value with a single rule that covers everything. </span><span class="kobospan" id="kobo.295.3">In more complex cases – like this one – each individual element is a number with a range constraint. </span><span class="kobospan" id="kobo.295.4">In a later step, we’ll look at validating the composite item:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.296.1">
    year = int(year_text)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.297.1">Wrap the input and validation into a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.298.1">while-try</span></span></span></span><span class="kobospan" id="kobo.299.1"> block that looks like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.300.1">
    year = None 
 
    while year is None: 
 
        year_text = input("year: ") 
 
        try: 
 
            year = int(year_text) 
 
        except ValueError as ex: 
 
            print(ex)</span></code></pre>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.301.1">This applies a single validation rule, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.302.1">int(year_txt)</span></span></span></span><span class="kobospan" id="kobo.303.1"> expression, to ensure that the input is an integer. </span><span class="kobospan" id="kobo.303.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.304.1">while</span></span></span></span><span class="kobospan" id="kobo.305.1"> statement leads to a repeat of the input and conversion sequence of steps until the value of the year variable is not </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.306.1">None</span></span></span></span><span class="kobospan" id="kobo.307.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.308.1">Raising an exception for faulty input allows us some flexibility. </span><span class="kobospan" id="kobo.308.2">We can extend this with additional exception classes for other conditions the input must meet.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.309.1">This processing only covers the year field. </span><span class="kobospan" id="kobo.309.2">We still need to get values for the month and day fields. </span><span class="kobospan" id="kobo.309.3">This means we’ll need three nearly identical loops for each of these three fields of a complex date object. </span><span class="kobospan" id="kobo.309.4">Rather than copying and pasting nearly identical code, we need to restructure this processing.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.310.1">We’ll define a new</span><span id="dx1-339025"/><span class="kobospan" id="kobo.311.1"> function, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.312.1">get_integer()</span></span></span></span><span class="kobospan" id="kobo.313.1">, for general-purpose input</span><span id="dx1-339026"/><span class="kobospan" id="kobo.314.1"> of a numeric</span><span id="dx1-339027"/><span class="kobospan" id="kobo.315.1"> value. </span><span class="kobospan" id="kobo.315.2">Here’s the complete</span><span id="dx1-339028"/><span class="kobospan" id="kobo.316.1"> function definition:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.317.1">
 
 
def get_integer(prompt: str) -&gt; int: 
 
    while True: 
 
        value_text = input(prompt) 
 
        try: 
 
            value = int(value_text) 
 
            return value 
 
        except ValueError as ex: 
 
            print(ex)
                                                                     

                                                                     </span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.318.1">We can combine this into an overall process to get the three integers of a date. </span><span class="kobospan" id="kobo.318.2">This will involve a similar </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.319.1">while-try </span></span><span class="kobospan" id="kobo.320.1">design pattern but applied to the composite object. </span><span class="kobospan" id="kobo.320.2">It will look like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.321.1">
 
 
def get_date2() -&gt; date: 
 
    while True: 
 
        year = get_integer("year: ") 
 
        month = get_integer("month [1-12]: ") 
 
        day = get_integer("day [1-31]: ") 
 
        try: 
 
            result = date(year, month, day) 
 
            return result 
 
        except ValueError as ex: 
 
            print(f"invalid, {ex}")</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.322.1">This uses individual </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.323.1">while-try </span></span><span class="kobospan" id="kobo.324.1">processing sequences around the sequence of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.325.1">get_integer()</span></span></span></span><span class="kobospan" id="kobo.326.1"> functions to get the individual values that make up a date. </span><span class="kobospan" id="kobo.326.2">Then, it uses the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.327.1">date()</span></span></span></span><span class="kobospan" id="kobo.328.1"> constructor to create a date object from the individual fields. </span><span class="kobospan" id="kobo.328.2">If the date object – as a whole – can’t be built because the pieces are invalid, then the year, month, and day must be reentered to create a valid date. </span><span id="x1-339049r684"/></p>
</section>
<section data-number="0.9.2.3" id="how-it-works...-46">
<h2 class="likechapterhead" data-number="0.9.2.3"><span><span class="kobospan" id="kobo.329.1">6.2.3 </span></span> <span id="x1-3400003"/><span class="kobospan" id="kobo.330.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.331.1">We need to decompose</span><span id="dx1-340001"/><span class="kobospan" id="kobo.332.1"> the input problem</span><span id="dx1-340002"/><span class="kobospan" id="kobo.333.1"> into several separate</span><span id="dx1-340003"/><span class="kobospan" id="kobo.334.1"> but closely related</span><span id="dx1-340004"/><span class="kobospan" id="kobo.335.1"> problems. </span><span class="kobospan" id="kobo.335.2">To do this, imagine a tower of conversion steps. </span><span class="kobospan" id="kobo.335.3">At the bottom layer is the initial interaction with the user. </span><span class="kobospan" id="kobo.335.4">We identified two of the common ways to handle this:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.336.1">input()</span></span></span></span><span class="kobospan" id="kobo.337.1">: This prompts and reads from a user</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.338.1">getpass.getpass()</span></span></span></span><span class="kobospan" id="kobo.339.1">: This prompts and reads input (like passwords) without a visible echo</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.340.1">These two functions provide the essential console interaction. </span><span class="kobospan" id="kobo.340.2">There are other libraries that can provide more sophisticated interactions, if that’s required. </span><span class="kobospan" id="kobo.340.3">For example, the Click project has some helpful prompting</span><span id="dx1-340005"/><span class="kobospan" id="kobo.341.1"> capabilities. </span><span class="kobospan" id="kobo.341.2">See </span><a class="url" href="https://click.palletsprojects.com/en/7.x/"><span class="url1"><span class="kobospan" id="kobo.342.1">https://click.palletsprojects.com/en/7.x/</span></span></a><span class="kobospan" id="kobo.343.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.344.1">The Rich project has extremely</span><span id="dx1-340006"/><span class="kobospan" id="kobo.345.1"> sophisticated terminal interaction. </span><span class="kobospan" id="kobo.345.2">See </span><a class="url" href="https://rich.readthedocs.io/en/latest/"><span class="url1"><span class="kobospan" id="kobo.346.1">https://rich.readthedocs.io/en/latest/</span></span></a><span class="kobospan" id="kobo.347.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.348.1">On top of the foundation, we’ve built several tiers of validation processing. </span><span class="kobospan" id="kobo.348.2">The tiers are as follows:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.349.1">A </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.350.1">data type </span></span><span class="kobospan" id="kobo.351.1">validation: This uses built-in conversion</span><span id="dx1-340007"/><span class="kobospan" id="kobo.352.1"> functions such as </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.353.1">int()</span></span></span></span><span class="kobospan" id="kobo.354.1"> or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.355.1">float()</span></span></span></span><span class="kobospan" id="kobo.356.1">. </span><span class="kobospan" id="kobo.356.2">These raise a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.357.1">ValueError</span></span></span></span><span class="kobospan" id="kobo.358.1"> exception for invalid text.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.359.1">A </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.360.1">domain </span></span><span class="kobospan" id="kobo.361.1">validation: This uses an </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.362.1">if</span></span></span></span><span class="kobospan" id="kobo.363.1"> statement</span><span id="dx1-340008"/><span class="kobospan" id="kobo.364.1"> to determine whether values fit any application-specific constraints. </span><span class="kobospan" id="kobo.364.2">For consistency, this should also raise a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.365.1">ValueError</span></span></span></span><span class="kobospan" id="kobo.366.1"> exception if the data is invalid.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.367.1">Composite object </span></span><span class="kobospan" id="kobo.368.1">validation: This is application-specific checking. </span><span class="kobospan" id="kobo.368.2">For our</span><span id="dx1-340009"/><span class="kobospan" id="kobo.369.1"> example, the composite object was an instance of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.370.1">datetime.date</span></span></span></span><span class="kobospan" id="kobo.371.1">. </span><span class="kobospan" id="kobo.371.2">This also tends to raise </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.372.1">ValueError</span></span></span></span><span class="kobospan" id="kobo.373.1"> exceptions for dates that are invalid.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.374.1">There are a lot of potential kinds of constraints that might be imposed on values. </span><span class="kobospan" id="kobo.374.2">We’ve used the valid date constraint because it’s particularly complicated. </span><span id="x1-340010r691"/></p>
</section>
<section data-number="0.9.2.4" id="theres-more...-38">
<h2 class="likechapterhead" data-number="0.9.2.4"><span><span class="kobospan" id="kobo.375.1">6.2.4 </span></span> <span id="x1-3410004"/><span class="kobospan" id="kobo.376.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.377.1">We have several alternatives for user input that involve slightly different approaches. </span><span class="kobospan" id="kobo.377.2">We’ll look at these two topics in detail:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.378.1">Complex text</span></span><span class="kobospan" id="kobo.379.1">: This will involve the simple</span><span id="dx1-341001"/><span class="kobospan" id="kobo.380.1"> use of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.381.1">input()</span></span></span></span><span class="kobospan" id="kobo.382.1"> with more sophisticated parsing of the source text. </span><span class="kobospan" id="kobo.382.2">Instead of prompting for individual fields, it might be better to accept a string in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.383.1">yyyy-mm-dd</span></span></span></span><span class="kobospan" id="kobo.384.1"> format and use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.385.1">strptime()</span></span></span></span><span class="kobospan" id="kobo.386.1"> parser to extract a date. </span><span class="kobospan" id="kobo.386.2">This doesn’t change the design pattern; it replaces an </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.387.1">int()</span></span></span></span><span class="kobospan" id="kobo.388.1"> or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.389.1">float()</span></span></span></span><span class="kobospan" id="kobo.390.1"> with something a bit more complicated.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.391.1">Interaction via the </span></span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.392.1">cmd</span></span></span></span> <span class="cmbx-10x-x"><span class="kobospan" id="kobo.393.1">module</span></span><span class="kobospan" id="kobo.394.1">: This involves a more complex</span><span id="dx1-341002"/><span class="kobospan" id="kobo.395.1"> class to control interaction. </span><span class="kobospan" id="kobo.395.2">We’ll look at this closely in the </span><a href="ch010.xhtml#x1-3610006" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.396.1">Using cmd to</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.397.1">create command-line applications</span></span></a><span class="kobospan" id="kobo.398.1"> recipe.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.399.1">A list of potential input validation rules can be extracted from JSON schema definitions. </span><span class="kobospan" id="kobo.399.2">This list of types includes Boolean, integer, float, and string. </span><span class="kobospan" id="kobo.399.3">A number of common string formats defined in JSON schema include date-time, time, date, email, hostname, IP addresses in the version 4 and version 6 formats, and URIs.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.400.1">Another source of user input validation rules can be found in the definition of the HTML5 </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.401.1">&lt;input&gt;</span></span></span></span><span class="kobospan" id="kobo.402.1"> tag. </span><span class="kobospan" id="kobo.402.2">This list includes color, date, datetime-local, email, file, month, number, password, telephone numbers, time, URL, and week-year. </span><span id="x1-341003r692"/></p>
</section>
<section data-number="0.9.2.5" id="see-also-45">
<h2 class="likechapterhead" data-number="0.9.2.5"><span><span class="kobospan" id="kobo.403.1">6.2.5 </span></span> <span id="x1-3420005"/><span class="kobospan" id="kobo.404.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.405.1">See the </span><a href="ch010.xhtml#x1-3610006" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.406.1">Using cmd to create command-line applications</span></span></a><span class="kobospan" id="kobo.407.1"> recipe in this chapter for complex interaction.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.408.1">See the </span><a href="ch010.xhtml#x1-3490004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.409.1">Using argparse to get command-line input</span></span></a><span class="kobospan" id="kobo.410.1"> recipe to gather user input from the command line.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.411.1">In the reference material for the SunOS operating system, which is now owned by Oracle, there is a collection of commands that prompt for different kinds</span><span id="dx1-342001"/><span class="kobospan" id="kobo.412.1"> of user inputs: </span><a class="url" href="https://docs.oracle.com/cd/E19683-01/816-0210/6m6nb7m5d/index.html"><span class="url1"><span class="kobospan" id="kobo.413.1">https://docs.oracle.com/cd/E19683-01/816-0210/6m6nb7m5d/index.html</span></span></a></p></li>
</ul>
<p class="normal1"><span id="x1-342002r681"/></p>
</section>
</section>
<section data-number="0.9.3" id="debugging-with-fvalue-strings">
<h1 class="unnumbered" data-number="0.9.3"><span><span class="kobospan" id="kobo.414.1">6.3 </span></span> <span id="x1-3430003"/><span class="kobospan" id="kobo.415.1">Debugging with f”</span><span><span class="kobospan" id="kobo.416.1">{</span></span><span class="kobospan" id="kobo.417.1">value=</span><span><span class="kobospan" id="kobo.418.1">}</span></span><span class="kobospan" id="kobo.419.1">” strings</span></h1>
<p class="normal"><span class="kobospan" id="kobo.420.1">One of the most important</span><span id="dx1-343001"/><span class="kobospan" id="kobo.421.1"> debugging and design tools available in Python is the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.422.1">print()</span></span></span></span><span class="kobospan" id="kobo.423.1"> function. </span><span class="kobospan" id="kobo.423.2">The two formatting options shown in the </span><a href="ch010.xhtml#x1-3310001" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.424.1">Using the features of</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.425.1">the print() function</span></span></a><span class="kobospan" id="kobo.426.1"> recipe don’t offer a lot of flexibility. </span><span class="kobospan" id="kobo.426.2">We have more flexibility with </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.427.1">f"string"</span></span></span></span><span class="kobospan" id="kobo.428.1"> formatting. </span><span class="kobospan" id="kobo.428.2">We’ll build on some of the recipes shown in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.429.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.430.1"> </span></span><a href="ch005_split_000.xhtml#x1-170001" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.431.1">1</span></span></a><span class="kobospan" id="kobo.432.1">, </span><a href="ch005_split_000.xhtml#x1-170001" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.433.1">Numbers, Strings, and Tuples</span></span></a><span class="kobospan" id="kobo.434.1">. </span><span id="x1-343002r693"/></p>
<section data-number="0.9.3.1" id="getting-ready-47">
<h2 class="likechapterhead" data-number="0.9.3.1"><span><span class="kobospan" id="kobo.435.1">6.3.1 </span></span> <span id="x1-3440001"/><span class="kobospan" id="kobo.436.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.437.1">Let’s look at a multi-step process that involves some moderately complex calculations. </span><span class="kobospan" id="kobo.437.2">We’ll compute the mean and standard deviation of some sample data. </span><span class="kobospan" id="kobo.437.3">Given these values, we’ll locate all items that are more than one standard deviation above the mean:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.438.1">
 
 
&gt;&gt;&gt; import statistics 
 
&gt;&gt;&gt; size = [2353, 2889, 2195, 3094, 
 
... </span><span class="kobospan" id="kobo.438.2">    725, 1099, 690, 1207, 926, 
 
... </span><span class="kobospan" id="kobo.438.3">    758, 615, 521, 1320] 
 
&gt;&gt;&gt; mean_size = statistics.mean(size) 
 
&gt;&gt;&gt; std_size = statistics.stdev(size) 
 
&gt;&gt;&gt; sig1 = round(mean_size + std_size, 1) 
 
&gt;&gt;&gt; [x for x in size if x &gt; sig1] 
 
[2353, 2889, 3094]</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.439.1">This calculation has several working variables. </span><span class="kobospan" id="kobo.439.2">The final list comprehension involves three other variables, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.440.1">mean_size</span></span></span></span><span class="kobospan" id="kobo.441.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.442.1">std_size</span></span></span></span><span class="kobospan" id="kobo.443.1">, and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.444.1">sig1</span></span></span></span><span class="kobospan" id="kobo.445.1">. </span><span class="kobospan" id="kobo.445.2">With so many values used to filter the size list, it’s difficult to visualize what’s going on. </span><span class="kobospan" id="kobo.445.3">It’s often helpful to know the steps in the calculation; showing the values of the intermediate variables can be very helpful. </span><span id="x1-344011r695"/></p>
</section>
<section data-number="0.9.3.2" id="how-to-do-it...-47">
<h2 class="likechapterhead" data-number="0.9.3.2"><span><span class="kobospan" id="kobo.446.1">6.3.2 </span></span> <span id="x1-3450002"/><span class="kobospan" id="kobo.447.1">How to do it...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.448.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.449.1">f"{name=}"</span></span></span></span><span class="kobospan" id="kobo.450.1"> string will have both the literal string </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.451.1">name=</span></span></span></span><span class="kobospan" id="kobo.452.1"> and the value for the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.453.1">name</span></span></span></span><span class="kobospan" id="kobo.454.1"> expression. </span><span class="kobospan" id="kobo.454.2">This is often a variable, but any expression can be used. </span><span class="kobospan" id="kobo.454.3">Using this with a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.455.1">print()</span></span></span></span><span class="kobospan" id="kobo.456.1"> function looks as follows:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.457.1">
 
 
&gt;&gt;&gt; print( 
 
... </span><span class="kobospan" id="kobo.457.2">    f"{mean_size=:.2f}, {std_size=:.2f}" 
 
... </span><span class="kobospan" id="kobo.457.3">) 
 
mean_size=1414.77, std_size=901.10</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.458.1">We can use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.459.1">{name=}</span></span></span></span><span class="kobospan" id="kobo.460.1"> to put any variable into the f-string and see the value. </span><span class="kobospan" id="kobo.460.2">These examples in the code above include a suffix of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.461.1">:.2f</span></span></span></span><span class="kobospan" id="kobo.462.1"> as the format specification to show the values rounded to two decimal places. </span><span class="kobospan" id="kobo.462.2">Another common suffix is </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.463.1">!r</span></span></span></span><span class="kobospan" id="kobo.464.1"> to show the internal representation of the object; we might use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.465.1">f"{name=!r}"</span></span></span></span><span class="kobospan" id="kobo.466.1">. </span><span id="x1-345006r697"/></p>
</section>
<section data-number="0.9.3.3" id="how-it-works...-47">
<h2 class="likechapterhead" data-number="0.9.3.3"><span><span class="kobospan" id="kobo.467.1">6.3.3 </span></span> <span id="x1-3460003"/><span class="kobospan" id="kobo.468.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.469.1">For more background on the formatting</span><span id="dx1-346001"/><span class="kobospan" id="kobo.470.1"> options, refer to the </span><a href="ch005_split_000.xhtml#x1-410004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.471.1">Building complicated</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.472.1">strings with f-strings</span></span></a><span class="kobospan" id="kobo.473.1"> recipe in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.474.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.475.1"> </span></span><a href="ch005_split_000.xhtml#x1-170001" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.476.1">1</span></span></a><span class="kobospan" id="kobo.477.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.478.1">There is a very handy extension to this capability. </span><span class="kobospan" id="kobo.478.2">We can use any expression on the left of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.479.1">=</span></span></span></span><span class="kobospan" id="kobo.480.1"> in the f-string. </span><span class="kobospan" id="kobo.480.2">This will show the expression and the value computed by the expression, providing us with even more debugging information. </span><span id="x1-346002r699"/></p>
</section>
<section data-number="0.9.3.4" id="theres-more...-39">
<h2 class="likechapterhead" data-number="0.9.3.4"><span><span class="kobospan" id="kobo.481.1">6.3.4 </span></span> <span id="x1-3470004"/><span class="kobospan" id="kobo.482.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.483.1">We can use the extended expression capability of f-strings to include additional calculations that aren’t simply the values’ local variables:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.484.1">
 
 
&gt;&gt;&gt; print( 
 
... </span><span class="kobospan" id="kobo.484.2">    f"{mean_size=:.2f}, {std_size=:.2f}," 
 
... </span><span class="kobospan" id="kobo.484.3">    f" {mean_size + 2 * std_size=:.2f}" 
 
... </span><span class="kobospan" id="kobo.484.4">) 
 
mean_size=1414.77, std_size=901.10, mean_size + 2 * std_size=3216.97</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.485.1">We’ve computed a new value, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.486.1">mean_size+2*std_size</span></span></span></span><span class="kobospan" id="kobo.487.1">, that appears only inside the formatted output. </span><span class="kobospan" id="kobo.487.2">This lets us display intermediate computed results without having to create an extra variable. </span><span id="x1-347007r700"/></p>
</section>
<section data-number="0.9.3.5" id="see-also-46">
<h2 class="likechapterhead" data-number="0.9.3.5"><span><span class="kobospan" id="kobo.488.1">6.3.5 </span></span> <span id="x1-3480005"/><span class="kobospan" id="kobo.489.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.490.1">Refer to the </span><a href="ch005_split_000.xhtml#x1-410004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.491.1">Building complicated strings with f-strings</span></span></a><span class="kobospan" id="kobo.492.1"> recipe in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.493.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.494.1"> </span></span><a href="ch005_split_000.xhtml#x1-170001" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.495.1">1</span></span></a><span class="kobospan" id="kobo.496.1">, for more of the things that can be done with f-strings and the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.497.1">format()</span></span></span></span><span class="kobospan" id="kobo.498.1"> method of a string.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.499.1">Refer to the </span><a href="ch010.xhtml#x1-3310001" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.500.1">Using the features of the print() function</span></span></a><span class="kobospan" id="kobo.501.1"> recipe earlier in this chapter for other formatting options.</span></p></li>
</ul>
<p class="normal1"><span id="x1-348001r694"/></p>
</section>
</section>
<section data-number="0.9.4" id="using-argparse-to-get-command-line-input">
<h1 class="unnumbered" data-number="0.9.4"><span><span class="kobospan" id="kobo.502.1">6.4 </span></span> <span id="x1-3490004"/><span class="kobospan" id="kobo.503.1">Using argparse to get command-line input</span></h1>
<p class="normal"><span class="kobospan" id="kobo.504.1">For some applications, it can be better</span><span id="dx1-349001"/><span class="kobospan" id="kobo.505.1"> to get the user input</span><span id="dx1-349002"/><span class="kobospan" id="kobo.506.1"> from the OS command line without a lot of human interaction. </span><span class="kobospan" id="kobo.506.2">We’d prefer to parse the command-line argument values and either perform the processing or report an error.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.507.1">For example, at the OS level, we might want to run a program like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.508.1">
 
 
% python ch06/distance_app.py -u KM 36.12,-86.67 33.94,-118.40 
 
From 36.12,-86.67 to 33.94,-118.4 in KM = 2886.90</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.509.1">At the OS prompt of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.510.1">%</span></span></span></span><span class="kobospan" id="kobo.511.1">, we entered a command, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.512.1">python</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.513.1"> ch06/distance_app.py</span></span></span></span><span class="kobospan" id="kobo.514.1">. </span><span class="kobospan" id="kobo.514.2">This command had an optional argument, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.515.1">-u</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.516.1"> KM</span></span></span></span><span class="kobospan" id="kobo.517.1">, and two positional arguments of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.518.1">36.12,-86.67</span></span></span></span><span class="kobospan" id="kobo.519.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.520.1">33.94,-118.40</span></span></span></span><span class="kobospan" id="kobo.521.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.522.1">If the user enters something incorrect, the interaction might look like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.523.1">
 
 
% python ch06/distance_app.py -u KM 36.12,-86.67 33.94,-118asd 
 
usage: distance_app.py [-h] [-u {NM,MI,KM}] p1 p2 
 
distance_app.py: error: argument p2: could not convert string to float: ’-118asd’</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.524.1">An invalid argument value of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.525.1">-118asd</span></span></span></span><span class="kobospan" id="kobo.526.1"> leads to an error message. </span><span class="kobospan" id="kobo.526.2">A user can hit the up-arrow key to get the previous command line back, make a change, and run the program again. </span><span class="kobospan" id="kobo.526.3">The interactive user experience is delegated to OS command-line processing. </span><span id="x1-349010r702"/></p>
<section data-number="0.9.4.1" id="getting-ready-48">
<h2 class="likechapterhead" data-number="0.9.4.1"><span><span class="kobospan" id="kobo.527.1">6.4.1 </span></span> <span id="x1-3500001"/><span class="kobospan" id="kobo.528.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.529.1">The first thing we need to do is to refactor our code to create three separate functions:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.530.1">A function to get the arguments from the command line.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.531.1">A function that does the real work. </span><span class="kobospan" id="kobo.531.2">The intent is to define a function that can be reused in a variety of contexts, one of which is with parameters from the command line.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.532.1">A main function that gathers arguments and invokes the </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.533.1">real work</span></span><span class="kobospan" id="kobo.534.1"> function with the appropriate argument values.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.535.1">Here’s our </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.536.1">real work </span></span><span class="kobospan" id="kobo.537.1">function, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.538.1">display()</span></span></span></span><span class="kobospan" id="kobo.539.1">:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.540.1">
                                                                     

                                                                     
 
 
from ch06.distance_computation import haversine, MI, NM, KM 
 
 
 
 
 
def display( 
 
        lat1: float, lon1: float, lat2: float, lon2: float, r: str 
 
) -&gt; None: 
 
    r_float = {"NM": NM, "KM": KM, "MI": MI}[r] 
 
    d = haversine(lat1, lon1, lat2, lon2, R=r_float) 
 
    print(f"From {lat1},{lon1} to {lat2},{lon2} in {r} = {d:.2f}")</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.541.1">We’ve imported</span><span id="dx1-350011"/><span class="kobospan" id="kobo.542.1"> the core</span><span id="dx1-350012"/><span class="kobospan" id="kobo.543.1"> calculation, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.544.1">haversine()</span></span></span></span><span class="kobospan" id="kobo.545.1">, from the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.546.1">ch06.distance_computation</span></span></span></span><span class="kobospan" id="kobo.547.1"> module. </span><span class="kobospan" id="kobo.547.2">We’ve based this on the calculations shown in the examples in the </span><a href="ch007_split_001.xhtml#x1-1940006" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.548.1">Picking an order for parameters based on partial</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.549.1">functions</span></span></a><span class="kobospan" id="kobo.550.1"> recipe in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.551.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.552.1"> </span></span><a href="ch007_split_000.xhtml#x1-1610003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.553.1">3</span></span></a><span class="kobospan" id="kobo.554.1">:</span></p>
<p class="normal1"><span class="kobospan" id="kobo.555.1">Here’s how the function looks when it’s used inside Python:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.556.1">
 
 
&gt;&gt;&gt; display(36.12, -86.67, 33.94, -118.4, ’NM’) 
 
From 36.12,-86.67 to 33.94,-118.4 in NM = 1558.53</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.557.1">This function has two important design features. </span><span class="kobospan" id="kobo.557.2">The first feature is that it avoids references to features of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.558.1">argparse.Namespace</span></span></span></span><span class="kobospan" id="kobo.559.1"> object that’s created by argument parsing. </span><span class="kobospan" id="kobo.559.2">Our goal is to have a function that we can reuse in a number of alternative contexts. </span><span class="kobospan" id="kobo.559.3">We need to keep the input and output elements of the user interface separate.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.560.1">The second design feature is that this function displays a value computed by another function. </span><span class="kobospan" id="kobo.560.2">This is a decomposition of a larger problem into two smaller problems. </span><span class="kobospan" id="kobo.560.3">We’ve separated the user experience of printed output from the essential calculation. </span><span class="kobospan" id="kobo.560.4">(Both aspects are quite small, but the principle of separating these two aspects is important.) </span><span id="x1-350016r706"/></p>
</section>
<section data-number="0.9.4.2" id="how-to-do-it...-48">
<h2 class="likechapterhead" data-number="0.9.4.2"><span><span class="kobospan" id="kobo.561.1">6.4.2 </span></span> <span id="x1-3510002"/><span class="kobospan" id="kobo.562.1">How to do it...</span></h2>
<ol class="calibre2">
<li class="calibre7"><div id="x1-351002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.563.1">Define the</span><span id="dx1-351003"/><span class="kobospan" id="kobo.564.1"> overall argument</span><span id="dx1-351004"/><span class="kobospan" id="kobo.565.1"> parsing function:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.566.1">
def get_options(argv: list[str]) -&gt; argparse.Namespace:</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-351008x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.567.1">Create the parser object:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.568.1">
    parser = argparse.ArgumentParser()</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-351012x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.569.1">Add the various types of arguments to the parser object. </span><span class="kobospan" id="kobo.569.2">Sometimes, this is difficult because we’re still refining the user experience. </span><span class="kobospan" id="kobo.569.3">It’s difficult to imagine all the ways in which people will use a program and all of the questions they might have. </span><span class="kobospan" id="kobo.569.4">For our example, we have two mandatory, positional arguments and an optional argument:</span></p>
<ul class="calibre17">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.570.1">Point 1 latitude and longitude</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.571.1">Point 2 latitude and longitude</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.572.1">Optional units of distance; we’ll provide nautical miles as the default:</span></p></li>
</ul>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.573.1">
    parser.add_argument("-u", "--units", 
 
        action="store", choices=("NM", "MI", "KM"), default="NM") 
 
    parser.add_argument("p1", action="store", type=point_type) 
 
    parser.add_argument("p2", action="store", type=point_type)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.574.1">We’ve added a mix of optional and mandatory arguments. </span><span class="kobospan" id="kobo.574.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.575.1">-u</span></span></span></span><span class="kobospan" id="kobo.576.1"> argument starts with a dash to mark it as optional. </span><span class="kobospan" id="kobo.576.2">A longer double dash version, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.577.1">--units</span></span></span></span><span class="kobospan" id="kobo.578.1">, is supported as an alternative.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.579.1">The mandatory, positional arguments are named without a prefix.</span></p>
</div></li>
<li class="calibre7"><div id="x1-351019x4" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.580.1">Evaluate the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.581.1">parse_args()</span></span></span></span><span class="kobospan" id="kobo.582.1"> method of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.583.1">parser</span></span></span></span><span class="kobospan" id="kobo.584.1"> object created in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.585.1">step 2</span></span><span class="kobospan" id="kobo.586.1">:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.587.1">
    options = parser.parse_args(argv)                                                                

                                                                     
     </span></code></pre>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.588.1">By default, the parser uses the values</span><span id="dx1-351022"/><span class="kobospan" id="kobo.589.1"> from </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.590.1">sys.argv</span></span></span></span><span class="kobospan" id="kobo.591.1">, which are the command-line argument values entered by the user. </span><span class="kobospan" id="kobo.591.2">Testing is much easier when we can provide an explicit argument value.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.592.1">Here’s the final function:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.593.1">
 
 
def get_options(argv: list[str]) -&gt; argparse.Namespace: 
 
    parser = argparse.ArgumentParser() 
 
    parser.add_argument("-u", "--units", 
 
        action="store", choices=("NM", "MI", "KM"), default="NM") 
 
    parser.add_argument("p1", action="store", type=point_type) 
 
    parser.add_argument("p2", action="store", type=point_type) 
 
    options = parser.parse_args(argv) 
 
    return options</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.594.1">This relies on a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.595.1">point_type()</span></span></span></span><span class="kobospan" id="kobo.596.1"> function</span><span id="dx1-351032"/><span class="kobospan" id="kobo.597.1"> to both validate the strings and convert the string to a (latitude, longitude) two-tuple. </span><span class="kobospan" id="kobo.597.2">Here’s the definition of this function:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.598.1">
 
 
def point_type(text: str) -&gt; tuple[float, float]: 
 
    try: 
 
        lat_str, lon_str = text.split(",") 
 
        lat = float(lat_str) 
 
        lon = float(lon_str) 
 
        return lat, lon 
 
    except ValueError as ex: 
 
        raise argparse.ArgumentTypeError(ex)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.599.1">If anything goes wrong, an exception will be raised. </span><span class="kobospan" id="kobo.599.2">From this exception, we’ll raise an </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.600.1">ArgumentTypeError</span></span></span></span><span class="kobospan" id="kobo.601.1"> exception. </span><span class="kobospan" id="kobo.601.2">This is caught by the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.602.1">argparse</span></span></span></span><span class="kobospan" id="kobo.603.1"> module and causes it to report the error to the user.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.604.1">Here’s the main script that combines the option parser and the output display functions:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.605.1">
 
 
def main(argv: list[str] = sys.argv[1:]) -&gt; None: 
 
    options = get_options(argv) 
 
    lat_1, lon_1 = options.p1 
 
    lat_2, lon_2 = options.p2 
 
    display(lat_1, lon_1, lat_2, lon_2, r=options.r) 
 
 
 
if __name__ == "__main__": 
 
    main()</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.606.1">This main script connects</span><span id="dx1-351051"/><span class="kobospan" id="kobo.607.1"> the user inputs</span><span id="dx1-351052"/><span class="kobospan" id="kobo.608.1"> to the displayed output. </span><span class="kobospan" id="kobo.608.2">The details of error messages and help processing are delegated to the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.609.1">argparse</span></span></span></span><span class="kobospan" id="kobo.610.1"> module. </span><span id="x1-351053r709"/></p>
</section>
<section data-number="0.9.4.3" id="how-it-works...-48">
<h2 class="likechapterhead" data-number="0.9.4.3"><span><span class="kobospan" id="kobo.611.1">6.4.3 </span></span> <span id="x1-3520003"/><span class="kobospan" id="kobo.612.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.613.1">The argument parser works in three stages:</span></p>
<ol class="calibre4">
<li class="calibre7"><div id="x1-352002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.614.1">Define the overall context by creating a parser object as an instance of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.615.1">ArgumentParser</span></span></span></span><span class="kobospan" id="kobo.616.1"> class.</span></p>
</div></li>
<li class="calibre7"><div id="x1-352004x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.617.1">Add individual arguments with the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.618.1">add_argument()</span></span></span></span><span class="kobospan" id="kobo.619.1"> method. </span><span class="kobospan" id="kobo.619.2">These can include optional arguments as well as required arguments.</span></p>
</div></li>
<li class="calibre7"><div id="x1-352006x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.620.1">Parse the actual command-line inputs, often based on </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.621.1">sys.argv</span></span></span></span><span class="kobospan" id="kobo.622.1">.</span></p>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.623.1">Some simple programs will have a few optional arguments. </span><span class="kobospan" id="kobo.623.2">A more complex program may have many optional arguments.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.624.1">It’s common to have a filename as a positional argument. </span><span class="kobospan" id="kobo.624.2">When a program reads one or more files, the filenames can be provided in the command line, as follows:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.625.1">
 
 
% python some_program.py *.rst</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.626.1">We’ve used the Linux shell’s </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.627.1">globbing </span></span><span class="kobospan" id="kobo.628.1">feature: the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.629.1">*.rst</span></span></span></span><span class="kobospan" id="kobo.630.1"> string is expanded</span><span id="dx1-352009"/><span class="kobospan" id="kobo.631.1"> into a list of all files that match the naming rule. </span><span class="kobospan" id="kobo.631.2">This is a feature of the Linux shell, and it happens before the Python interpreter starts. </span><span class="kobospan" id="kobo.631.3">This list of files can be processed using an argument, defined as follows:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.632.1">
 
 
    parser.add_argument(’file’, type=Path, nargs=’*’)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.633.1">All of the arguments on the command</span><span id="dx1-352012"/><span class="kobospan" id="kobo.634.1"> line that</span><span id="dx1-352013"/><span class="kobospan" id="kobo.635.1"> do </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.636.1">not </span></span><span class="kobospan" id="kobo.637.1">start with the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.638.1">-</span></span></span></span><span class="kobospan" id="kobo.639.1"> character are positional arguments, and they are collected into the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.640.1">file</span></span></span></span><span class="kobospan" id="kobo.641.1"> value in the object built by the parser.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.642.1">We can then use the following to process each of the given files:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.643.1">
 
 
    for filename in options.file: 
 
        process(filename)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.644.1">For Windows programs, the shell doesn’t glob filenames from wildcard patterns. </span><span class="kobospan" id="kobo.644.2">This means the application must deal with filenames that contain wildcard characters like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.645.1">"*"</span></span></span></span><span class="kobospan" id="kobo.646.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.647.1">"?"</span></span></span></span><span class="kobospan" id="kobo.648.1"> in them. </span><span class="kobospan" id="kobo.648.2">The Python </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.649.1">glob</span></span></span></span><span class="kobospan" id="kobo.650.1"> module can help with this. </span><span class="kobospan" id="kobo.650.2">Also, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.651.1">pathlib</span></span></span></span><span class="kobospan" id="kobo.652.1"> module can create </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.653.1">Path</span></span></span></span><span class="kobospan" id="kobo.654.1"> objects, which include globbing features to locate matching filenames in a directory. </span><span id="x1-352017r717"/></p>
</section>
<section data-number="0.9.4.4" id="theres-more...-40">
<h2 class="likechapterhead" data-number="0.9.4.4"><span><span class="kobospan" id="kobo.655.1">6.4.4 </span></span> <span id="x1-3530004"/><span class="kobospan" id="kobo.656.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.657.1">What kinds of arguments</span><span id="dx1-353001"/><span class="kobospan" id="kobo.658.1"> can we process? </span><span class="kobospan" id="kobo.658.2">There are a lot of argument styles in common use. </span><span class="kobospan" id="kobo.658.3">All of these variations are defined using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.659.1">add_argument()</span></span></span></span><span class="kobospan" id="kobo.660.1"> method of a parser:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.661.1">Simple options</span></span><span class="kobospan" id="kobo.662.1">: Arguments of the form </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.663.1">-o</span></span></span></span><span class="kobospan" id="kobo.664.1"> or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.665.1">--option</span></span></span></span><span class="kobospan" id="kobo.666.1"> often define optional features. </span><span class="kobospan" id="kobo.666.2">These use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.667.1">’store_true’</span></span></span></span><span class="kobospan" id="kobo.668.1"> or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.669.1">’store_false’</span></span></span></span><span class="kobospan" id="kobo.670.1"> actions.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.671.1">Options with values</span></span><span class="kobospan" id="kobo.672.1">: We showed </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.673.1">-r</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.674.1"> unit</span></span></span></span><span class="kobospan" id="kobo.675.1"> as an option with a value. </span><span class="kobospan" id="kobo.675.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.676.1">’store’</span></span></span></span><span class="kobospan" id="kobo.677.1"> action is how the value is saved.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.678.1">Options that increment a counter</span></span><span class="kobospan" id="kobo.679.1">: The action </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.680.1">’count’</span></span></span></span><span class="kobospan" id="kobo.681.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.682.1">default=0</span></span></span></span><span class="kobospan" id="kobo.683.1"> permit an option that can be repeated. </span><span class="kobospan" id="kobo.683.2">The verbose and very verbose logging options, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.684.1">-v</span></span></span></span><span class="kobospan" id="kobo.685.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.686.1">-vv</span></span></span></span><span class="kobospan" id="kobo.687.1">, respectively, are an example.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.688.1">Options that accumulate a list</span></span><span class="kobospan" id="kobo.689.1">: The action </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.690.1">’append’</span></span></span></span><span class="kobospan" id="kobo.691.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.692.1">default=[]</span></span></span></span><span class="kobospan" id="kobo.693.1"> can accumulate multiple option values.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.694.1">Show the version number</span></span><span class="kobospan" id="kobo.695.1">: A special action of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.696.1">’version’</span></span></span></span><span class="kobospan" id="kobo.697.1"> can be used to create an argument that will show the version number and exit.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.698.1">Positional arguments do not have a leading </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.699.1">’-’</span></span></span></span><span class="kobospan" id="kobo.700.1"> in their name. </span><span class="kobospan" id="kobo.700.2">They must be defined in the order they will be used.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.701.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.702.1">argparse</span></span></span></span><span class="kobospan" id="kobo.703.1"> module uses </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.704.1">-h</span></span></span></span><span class="kobospan" id="kobo.705.1">, and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.706.1">--help</span></span></span></span><span class="kobospan" id="kobo.707.1"> will display a help message and exit. </span><span class="kobospan" id="kobo.707.2">These options are available unless changed by an argument that uses the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.708.1">’help’</span></span></span></span><span class="kobospan" id="kobo.709.1"> action.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.710.1">This covers most of the common cases</span><span id="dx1-353002"/><span class="kobospan" id="kobo.711.1"> for command-line argument processing. </span><span class="kobospan" id="kobo.711.2">Generally, we’ll try to leverage these common styles of arguments when we write our own applications. </span><span class="kobospan" id="kobo.711.3">If we strive to follow the widely used argument styles, our users are more likely to understand how our application works. </span><span id="x1-353003r721"/></p>
</section>
<section data-number="0.9.4.5" id="see-also-47">
<h2 class="likechapterhead" data-number="0.9.4.5"><span><span class="kobospan" id="kobo.712.1">6.4.5 </span></span> <span id="x1-3540005"/><span class="kobospan" id="kobo.713.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.714.1">We looked at how to get interactive user input in the </span><a href="ch010.xhtml#x1-3370002" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.715.1">Using input()</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.716.1">and getpass() for user input</span></span></a><span class="kobospan" id="kobo.717.1"> recipe.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.718.1">We’ll look at a way to add even more flexibility to this in the </span><a href="ch010.xhtml#x1-3670007" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.719.1">Using</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.720.1">the OS environment settings</span></span></a><span class="kobospan" id="kobo.721.1"> recipe.</span></p></li>
</ul>
<p class="normal1"><span id="x1-354001r703"/></p>
</section>
</section>
<section data-number="0.9.5" id="using-invoke-to-get-command-line-input">
<h1 class="unnumbered" data-number="0.9.5"><span><span class="kobospan" id="kobo.722.1">6.5 </span></span> <span id="x1-3550005"/><span class="kobospan" id="kobo.723.1">Using invoke to get command-line input</span></h1>
<p class="normal"><span class="kobospan" id="kobo.724.1">The </span><a href="https://www.pyinvoke.org" class="url"><span class="kobospan" id="kobo.725.1">invoke</span></a><span class="kobospan" id="kobo.726.1"> package</span><span id="dx1-355001"/><span class="kobospan" id="kobo.727.1"> is not part of the standard</span><span id="dx1-355002"/><span class="kobospan" id="kobo.728.1"> library. </span><span class="kobospan" id="kobo.728.2">It needs to be installed separately. </span><span class="kobospan" id="kobo.728.3">Generally, this is done with the following terminal command:</span></p>
<pre class="programlisting" id="listing-36"><code class="calibre13"><span class="kobospan" id="kobo.729.1">(cookbook3) % python -m pip install invoke</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.730.1">Using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.731.1">python</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.732.1"> -m</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.733.1"> pip</span></span></span></span><span class="kobospan" id="kobo.734.1"> command ensures that we will use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.735.1">pip</span></span></span></span><span class="kobospan" id="kobo.736.1"> command that goes with the currently active virtual environment, shown as </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.737.1">cookbook3</span></span></span></span><span class="kobospan" id="kobo.738.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.739.1">See the </span><a href="ch010.xhtml#x1-3490004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.740.1">Using argparse to get command-line input</span></span></a><span class="kobospan" id="kobo.741.1"> recipe in this chapter. </span><span class="kobospan" id="kobo.741.2">It describes a command-line application that works something like the following:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.742.1">
 
 
% RECIPE=7  # invoke</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.743.1">The command will always</span><span id="dx1-355008"/><span class="kobospan" id="kobo.744.1"> be </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.745.1">invoke</span></span></span></span><span class="kobospan" id="kobo.746.1">. </span><span class="kobospan" id="kobo.746.2">The Python path</span><span id="dx1-355009"/><span class="kobospan" id="kobo.747.1"> information is used to locate a module file named </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.748.1">tasks.py</span></span></span></span><span class="kobospan" id="kobo.749.1"> to provide the definitions of the commands that can be invoked. </span><span class="kobospan" id="kobo.749.2">The remaining command-line values are provided to a function defined in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.750.1">tasks</span></span></span></span><span class="kobospan" id="kobo.751.1"> module. </span><span id="x1-355010r722"/></p>
<section data-number="0.9.5.1" id="getting-ready-49">
<h2 class="likechapterhead" data-number="0.9.5.1"><span><span class="kobospan" id="kobo.752.1">6.5.1 </span></span> <span id="x1-3560001"/><span class="kobospan" id="kobo.753.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.754.1">Often, we’ll create a two-tiered design when using </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.755.1">invoke</span></span><span class="kobospan" id="kobo.756.1">. </span><span class="kobospan" id="kobo.756.2">These two tiers are:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.757.1">A function to get the arguments from the command line, do any validation or conversion required, and invoke the function to perform the real work. </span><span class="kobospan" id="kobo.757.2">This function will be decorated with </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.758.1">@task</span></span></span></span><span class="kobospan" id="kobo.759.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.760.1">A function that does the real work. </span><span class="kobospan" id="kobo.760.2">It helps if this function is designed so that it makes no reference to the command-line options in any direct way. </span><span class="kobospan" id="kobo.760.3">The intent is to define a function to be reused in a variety of contexts, one of which is with parameters from the command line.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.761.1">In some cases, these two functions can be merged into one. </span><span class="kobospan" id="kobo.761.2">This often happens when Python is used as a wrapper to provide a simple interface for an underlying application that is bewilderingly complicated. </span><span class="kobospan" id="kobo.761.3">In this kind of application, the Python wrapper may do very little processing, with no useful distinction between validating parameter values and doing the “real work” of the application.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.762.1">In the </span><a href="ch010.xhtml#x1-3490004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.763.1">Using argparse to get command-line input</span></span></a><span class="kobospan" id="kobo.764.1"> recipe in this chapter, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.765.1">display()</span></span></span></span><span class="kobospan" id="kobo.766.1"> function is defined. </span><span class="kobospan" id="kobo.766.2">This function does the “real work” of the application. </span><span class="kobospan" id="kobo.766.3">When working with </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.767.1">invoke</span></span><span class="kobospan" id="kobo.768.1">, this design will continue to be used. </span><span id="x1-356001r725"/></p>
</section>
<section data-number="0.9.5.2" id="how-to-do-it...-49">
<h2 class="likechapterhead" data-number="0.9.5.2"><span><span class="kobospan" id="kobo.769.1">6.5.2 </span></span> <span id="x1-3570002"/><span class="kobospan" id="kobo.770.1">How to do it...</span></h2>
<ol class="calibre2">
<li class="calibre7"><div id="x1-357002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.771.1">Define a function that describes a task that can be invoked. </span><span class="kobospan" id="kobo.771.2">It’s often essential to provide some help for the various parameters, which is done by providing a dictionary of parameter names and help text to the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.772.1">@task</span></span></span></span><span class="kobospan" id="kobo.773.1"> decorator:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.774.1">
import sys 
 
from invoke.tasks import task 
 
from invoke.context import Context</span></code></pre>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.775.1">
@task( 
 
    help={ 
 
        ’p1’: ’Lat,Lon’, 
 
        ’p2’: ’Lat,Lon’, 
 
        ’u’: ’Unit: KM, MI, NM’}) 
 
def distance( 
 
        context: Context, p1: str, p2: str, u: str = "KM" 
 
) -&gt; None: 
 
    """Compute distance between two points. 
 
    """</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.776.1">The docstring for the function</span><span id="dx1-357018"/><span class="kobospan" id="kobo.777.1"> becomes the help text</span><span id="dx1-357019"/><span class="kobospan" id="kobo.778.1"> provided by the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.779.1">invoke</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.780.1"> distance</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.781.1"> --help</span></span></span></span><span class="kobospan" id="kobo.782.1"> command. </span><span class="kobospan" id="kobo.782.2">It’s very important to provide something that will help the user understand what the various commands will do and how to use them.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.783.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.784.1">Context</span></span></span></span><span class="kobospan" id="kobo.785.1"> parameter is required, but it won’t be used in this example. </span><span class="kobospan" id="kobo.785.2">This object provides a consistent context when invoking multiple separate tasks. </span><span class="kobospan" id="kobo.785.3">It also provides methods to run external applications.</span></p>
</div></li>
<li class="calibre7"><div id="x1-357021x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.786.1">Perform any needed conversions on the various parameter values. </span><span class="kobospan" id="kobo.786.2">Evaluate the “real-work” function with cleaned values:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.787.1">
    try: 
 
        lat_1, lon_1 = point_type(p1) 
 
        lat_2, lon_2 = point_type(p2) 
 
        display(lat_1, lon_1, lat_2, lon_2, r=u) 
 
    except (ValueError, KeyError) as ex: 
 
        sys.exit(f"{ex}\nFor help use invoke --help distance")                                                                

                                                                     
     </span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.788.1">We’ve used </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.789.1">sys.exit()</span></span></span></span><span class="kobospan" id="kobo.790.1"> to produce a failure message. </span><span class="kobospan" id="kobo.790.2">It’s also possible to raise an exception, but this will show long traceback displays that may not be helpful.</span></p>
</div></li>
</ol>
<p class="normal1"><span id="x1-357029r726"/></p>
</section>
<section data-number="0.9.5.3" id="how-it-works...-49">
<h2 class="likechapterhead" data-number="0.9.5.3"><span><span class="kobospan" id="kobo.791.1">6.5.3 </span></span> <span id="x1-3580003"/><span class="kobospan" id="kobo.792.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.793.1">The </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.794.1">invoke </span></span><span class="kobospan" id="kobo.795.1">package examines the parameters</span><span id="dx1-358001"/><span class="kobospan" id="kobo.796.1"> for a given Python</span><span id="dx1-358002"/><span class="kobospan" id="kobo.797.1"> function and builds the necessary command-line parsing options. </span><span class="kobospan" id="kobo.797.2">The parameter names become the names for options. </span><span class="kobospan" id="kobo.797.3">In the example </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.798.1">distance()</span></span></span></span><span class="kobospan" id="kobo.799.1"> function, the parameters of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.800.1">p1</span></span></span></span><span class="kobospan" id="kobo.801.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.802.1">p2</span></span></span></span><span class="kobospan" id="kobo.803.1">, and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.804.1">u</span></span></span></span><span class="kobospan" id="kobo.805.1"> become the command-line options of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.806.1">--p1</span></span></span></span><span class="kobospan" id="kobo.807.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.808.1">--p2</span></span></span></span><span class="kobospan" id="kobo.809.1">, and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.810.1">-u</span></span></span></span><span class="kobospan" id="kobo.811.1">, respectively. </span><span class="kobospan" id="kobo.811.2">This lets us provide the parameters flexibly when running the application. </span><span class="kobospan" id="kobo.811.3">The values can be provided positionally, or by using the option flags. </span><span id="x1-358003r730"/></p>
</section>
<section data-number="0.9.5.4" id="theres-more...-41">
<h2 class="likechapterhead" data-number="0.9.5.4"><span><span class="kobospan" id="kobo.812.1">6.5.4 </span></span> <span id="x1-3590004"/><span class="kobospan" id="kobo.813.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.814.1">The most important feature of </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.815.1">invoke </span></span><span class="kobospan" id="kobo.816.1">is its ability to act as a wrapper for other binary applications. </span><span class="kobospan" id="kobo.816.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.817.1">Context</span></span></span></span><span class="kobospan" id="kobo.818.1"> object that’s provided to each task provides ways to change the current working directory and run an arbitrary OS command. </span><span class="kobospan" id="kobo.818.2">This includes options to update the environment of the subprocess, capture the output and error streams, provide an input stream, and many other features.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.819.1">We can use </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.820.1">invoke </span></span><span class="kobospan" id="kobo.821.1">to combine multiple applications under a single wrapper. </span><span class="kobospan" id="kobo.821.2">This can help to simplify complicated collections of applications by providing a uniform interface via a single module of task definitions.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.822.1">We can, for example, combine an application that computes distance between two points, and a separate application that processes a CSV file with an entire route of a connected series of points.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.823.1">The overall design might look like this:</span></p>
<pre class="programlisting" id="listing-37"><code class="calibre13"><span class="kobospan" id="kobo.824.1">@task 
 
def distance(context: Context, p1: str, p2: str, u: str) -&gt; None: 
 
    ... </span><span class="kobospan" id="kobo.824.2"> # Shown earlier 
 
 
 
@task 
 
def route(context: Context, filename: str) -&gt; None: 
 
    if not path(filename).exists(): 
 
        sys.exit(f"File not found {filename}") 
 
    context.run("python some_app.py {filename}", env={"APP_UNITS": "NM"})</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.825.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.826.1">context.run()</span></span></span></span><span class="kobospan" id="kobo.827.1"> method will invoke an arbitrary OS-level command. </span><span class="kobospan" id="kobo.827.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.828.1">env</span></span></span></span><span class="kobospan" id="kobo.829.1"> parameter value provides updated environment variables to the command that’s executed. </span><span id="x1-359010r731"/></p>
</section>
<section data-number="0.9.5.5" id="see-also-48">
<h2 class="likechapterhead" data-number="0.9.5.5"><span><span class="kobospan" id="kobo.830.1">6.5.5 </span></span> <span id="x1-3600005"/><span class="kobospan" id="kobo.831.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.832.1">Additional recipes for application integration are shown in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.833.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.834.1"> </span></span><a href="ch018.xhtml#x1-75800014" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.835.1">14</span></span></a><span class="kobospan" id="kobo.836.1">, </span><a href="ch018.xhtml#x1-75800014" class="url"><span class="kobospan" id="kobo.837.1">Application Integration: Combination</span></a><span class="kobospan" id="kobo.838.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.839.1">The</span><span id="dx1-360001"/> <a class="url" href="https://www.pyinvoke.org"><span class="url1"><span class="kobospan" id="kobo.840.1">https://www.pyinvoke.org</span></span></a><span class="kobospan" id="kobo.841.1"> web page contains all of the documentation on </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.842.1">invoke</span></span></span></span><span class="kobospan" id="kobo.843.1">.</span></p></li>
</ul>
<p class="normal1"><span id="x1-360002r723"/></p>
</section>
</section>
<section data-number="0.9.6" id="using-cmd-to-create-command-line-applications">
<h1 class="unnumbered" data-number="0.9.6"><span><span class="kobospan" id="kobo.844.1">6.6 </span></span> <span id="x1-3610006"/><span class="kobospan" id="kobo.845.1">Using cmd to create command-line applications</span></h1>
<p class="normal"><span class="kobospan" id="kobo.846.1">There are several ways</span><span id="dx1-361001"/><span class="kobospan" id="kobo.847.1"> to create interactive</span><span id="dx1-361002"/><span class="kobospan" id="kobo.848.1"> applications. </span><span class="kobospan" id="kobo.848.2">The </span><a href="ch010.xhtml#x1-3370002" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.849.1">Using input() and</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.850.1">getpass() for user input</span></span></a><span class="kobospan" id="kobo.851.1"> recipe looked at functions such as </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.852.1">input()</span></span></span></span><span class="kobospan" id="kobo.853.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.854.1">getpass.getpass()</span></span></span></span><span class="kobospan" id="kobo.855.1">. </span><span class="kobospan" id="kobo.855.2">The </span><a href="ch010.xhtml#x1-3490004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.856.1">Using argparse to get command-line input</span></span></a><span class="kobospan" id="kobo.857.1"> recipe showed us how to use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.858.1">argparse</span></span></span></span><span class="kobospan" id="kobo.859.1"> module to create applications with which a user can interact from the OS command line.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.860.1">We have another way to create interactive applications: using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.861.1">cmd</span></span></span></span><span class="kobospan" id="kobo.862.1"> module. </span><span class="kobospan" id="kobo.862.2">This module will prompt the user for input and then invoke a specific method of the class we provide.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.863.1">Here’s an example of the interaction:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.864.1">
 
 
] dice 5 
 
Rolling 5 dice 
 
] roll 
 
[5, 6, 6, 1, 5] 
 
]</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.865.1">We entered the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.866.1">dice</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.867.1"> 5</span></span></span></span><span class="kobospan" id="kobo.868.1"> command to set the number of dice. </span><span class="kobospan" id="kobo.868.2">After that, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.869.1">roll</span></span></span></span><span class="kobospan" id="kobo.870.1"> command showed the results of rolling five dice. </span><span class="kobospan" id="kobo.870.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.871.1">help</span></span></span></span><span class="kobospan" id="kobo.872.1"> command will show the available commands. </span><span id="x1-361009r732"/></p>
<section data-number="0.9.6.1" id="getting-ready-50">
<h2 class="likechapterhead" data-number="0.9.6.1"><span><span class="kobospan" id="kobo.873.1">6.6.1 </span></span> <span id="x1-3620001"/><span class="kobospan" id="kobo.874.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.875.1">The core feature of a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.876.1">cmd.Cmd</span></span></span></span><span class="kobospan" id="kobo.877.1"> application</span><span id="dx1-362001"/><span class="kobospan" id="kobo.878.1"> is a </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.879.1">read-evaluate-print loop</span></span><span class="kobospan" id="kobo.880.1"> (</span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.881.1">REPL</span></span><span class="kobospan" id="kobo.882.1">). </span><span class="kobospan" id="kobo.882.2">This kind of application works well when there are a number of individual state changes and a number of closely related commands to make those state changes.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.883.1">We’ll make use of a simple, stateful dice game. </span><span class="kobospan" id="kobo.883.2">The idea is to have a handful of dice, some of which can be rolled and some of which are frozen. </span><span class="kobospan" id="kobo.883.3">This means our </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.884.1">Cmd</span></span></span></span><span class="kobospan" id="kobo.885.1"> class definition must have some attributes that describe the current state of a handful of dice.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.886.1">Commands will include the following:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.887.1">dice </span></span><span class="kobospan" id="kobo.888.1">to set the number of dice</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.889.1">roll </span></span><span class="kobospan" id="kobo.890.1">to roll the dice</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.891.1">reroll </span></span><span class="kobospan" id="kobo.892.1">to re-roll selected dice, leaving the others untouched</span></p></li>
</ul>
<p class="normal1"><span id="x1-362002r735"/></p>
</section>
<section data-number="0.9.6.2" id="how-to-do-it...-50">
<h2 class="likechapterhead" data-number="0.9.6.2"><span><span class="kobospan" id="kobo.893.1">6.6.2 </span></span> <span id="x1-3630002"/><span class="kobospan" id="kobo.894.1">How to do it...</span></h2>
<ol class="calibre2">
<li class="calibre7"><div id="x1-363002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.895.1">Import the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.896.1">cmd</span></span></span></span><span class="kobospan" id="kobo.897.1"> module</span><span id="dx1-363003"/><span class="kobospan" id="kobo.898.1"> to make the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.899.1">cmd.Cmd</span></span></span></span><span class="kobospan" id="kobo.900.1"> class definition</span><span id="dx1-363004"/><span class="kobospan" id="kobo.901.1"> available. </span><span class="kobospan" id="kobo.901.2">Since this is a game, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.902.1">random</span></span></span></span><span class="kobospan" id="kobo.903.1"> module will also be needed:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.904.1">
import cmd 
 
import random</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-363009x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.905.1">Define an extension to </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.906.1">cmd.Cmd</span></span></span></span><span class="kobospan" id="kobo.907.1">:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.908.1">
class DiceCLI(cmd.Cmd):</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-363013x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.909.1">Define any initialization required in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.910.1">preloop()</span></span></span></span><span class="kobospan" id="kobo.911.1"> method:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.912.1">
    def preloop(self) -&gt; None: 
 
        self.n_dice = 6 
 
        self.dice: list[int] | None = None  # no roll has been made. 
 
        self.reroll_count = 0</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.913.1">This method is evaluated once when the processing starts.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.914.1">Initialization can also be done in an </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.915.1">__init__()</span></span></span></span><span class="kobospan" id="kobo.916.1"> method. </span><span class="kobospan" id="kobo.916.2">However, doing this is a bit more complicated because it must collaborate with the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.917.1">Cmd</span></span></span></span><span class="kobospan" id="kobo.918.1"> class initialization.</span></p>
</div></li>
<li class="calibre7"><div id="x1-363020x4" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.919.1">For each command, create a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.920.1">do_command()</span></span></span></span><span class="kobospan" id="kobo.921.1"> method. </span><span class="kobospan" id="kobo.921.2">The name of the method will be the command, prefixed by the characters </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.922.1">do_</span></span></span></span><span class="kobospan" id="kobo.923.1">. </span><span class="kobospan" id="kobo.923.2">Any user input text after the command will be provided as an argument value to the method. </span><span class="kobospan" id="kobo.923.3">The docstring comment in the method definition is the help text for the command. </span><span class="kobospan" id="kobo.923.4">Here is the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.924.1">roll</span></span></span></span><span class="kobospan" id="kobo.925.1"> command, defined by the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.926.1">do_roll()</span></span></span></span><span class="kobospan" id="kobo.927.1"> method:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.928.1">                                                                     

                                                                     

    def do_roll(self, arg: str) -&gt; bool: 
 
        """Roll the dice. </span><span class="kobospan" id="kobo.928.2">Use the dice command to set the number of dice.""" 
 
        self.dice = [random.randint(1, 6) for _ in range(self.n_dice)] 
 
        print(f"{self.dice}") 
 
        return False</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-363028x5" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.929.1">Parse and validate the arguments</span><span id="dx1-363029"/><span class="kobospan" id="kobo.930.1"> to the commands</span><span id="dx1-363030"/><span class="kobospan" id="kobo.931.1"> that use them. </span><span class="kobospan" id="kobo.931.2">The user’s input after the command will be provided as the value of the first positional argument to the method. </span><span class="kobospan" id="kobo.931.3">Here is the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.932.1">dice</span></span></span></span><span class="kobospan" id="kobo.933.1"> command, defined by the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.934.1">do_dice()</span></span></span></span><span class="kobospan" id="kobo.935.1"> method:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.936.1">
    def do_dice(self, arg: str) -&gt; bool: 
 
        """Sets the number of dice to roll.""" 
 
        try: 
 
            self.n_dice = int(arg) 
 
        except ValueError: 
 
            print(f"{arg!r} is invalid") 
 
            return False 
 
        self.dice = None 
 
        print(f"Rolling {self.n_dice} dice") 
 
        return False</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-363043x6" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.937.1">Write the main script. </span><span class="kobospan" id="kobo.937.2">This will create an instance of this class and execute the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.938.1">cmdloop()</span></span></span></span><span class="kobospan" id="kobo.939.1"> method:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.940.1">
if __name__ == "__main__": 
 
    game = DiceCLI() 
 
    game.cmdloop()</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.941.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.942.1">cmdloop()</span></span></span></span><span class="kobospan" id="kobo.943.1"> method handles the details of prompting, collecting input, and executing the proper method.</span></p>
</div></li>
</ol>
<p class="normal1"><span id="x1-363048r736"/></p>
</section>
<section data-number="0.9.6.3" id="how-it-works...-50">
<h2 class="likechapterhead" data-number="0.9.6.3"><span><span class="kobospan" id="kobo.944.1">6.6.3 </span></span> <span id="x1-3640003"/><span class="kobospan" id="kobo.945.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.946.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.947.1">Cmd</span></span></span></span><span class="kobospan" id="kobo.948.1"> class contains a large</span><span id="dx1-364001"/><span class="kobospan" id="kobo.949.1"> number of built-in features</span><span id="dx1-364002"/><span class="kobospan" id="kobo.950.1"> to display a prompt, read input from a user, and then locate the proper method based on the user’s input.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.951.1">For example, when we enter a command like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.952.1">dice</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.953.1"> 5</span></span></span></span><span class="kobospan" id="kobo.954.1">, the built-in methods of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.955.1">Cmd</span></span></span></span><span class="kobospan" id="kobo.956.1"> superclass will strip the first word from the input, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.957.1">dice</span></span></span></span><span class="kobospan" id="kobo.958.1">, and prefix this with </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.959.1">do_</span></span></span></span><span class="kobospan" id="kobo.960.1">. </span><span class="kobospan" id="kobo.960.2">It will then try to evaluate the method with the argument value of the rest of the line, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.961.1">5</span></span></span></span><span class="kobospan" id="kobo.962.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.963.1">If we enter a command for which there’s no matching </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.964.1">do_*()</span></span></span></span><span class="kobospan" id="kobo.965.1"> method, the command processor writes an error message. </span><span class="kobospan" id="kobo.965.2">This is done automatically; we don’t need to write any code to handle invalid command input.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.966.1">Some methods, such as </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.967.1">do_help()</span></span></span></span><span class="kobospan" id="kobo.968.1">, are already part of the application. </span><span class="kobospan" id="kobo.968.2">These methods will summarize the other </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.969.1">do_*</span></span></span></span><span class="kobospan" id="kobo.970.1"> methods. </span><span class="kobospan" id="kobo.970.2">When one of our methods has a docstring, this will be displayed by the built-in help feature.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.971.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.972.1">Cmd</span></span></span></span><span class="kobospan" id="kobo.973.1"> class relies on Python’s facilities for introspection. </span><span class="kobospan" id="kobo.973.2">An instance of the class can examine the method names to locate all of the methods that start with </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.974.1">do_</span></span></span></span><span class="kobospan" id="kobo.975.1">. </span><span class="kobospan" id="kobo.975.2">Introspection is an advanced topic, one that will be touched on in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.976.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.977.1"> </span></span><a href="ch012.xhtml#x1-4520008" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.978.1">8</span></span></a><span class="kobospan" id="kobo.979.1">. </span><span id="x1-364003r743"/></p>
</section>
<section data-number="0.9.6.4" id="theres-more...-42">
<h2 class="likechapterhead" data-number="0.9.6.4"><span><span class="kobospan" id="kobo.980.1">6.6.4 </span></span> <span id="x1-3650004"/><span class="kobospan" id="kobo.981.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.982.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.983.1">Cmd</span></span></span></span><span class="kobospan" id="kobo.984.1"> class has a number of additional places where we can add interactive features:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.985.1">We can define specific </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.986.1">help_*()</span></span></span></span><span class="kobospan" id="kobo.987.1"> methods that become part of the help topics.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.988.1">When any of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.989.1">do_*()</span></span></span></span><span class="kobospan" id="kobo.990.1"> methods return a non-</span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.991.1">False</span></span></span></span><span class="kobospan" id="kobo.992.1"> value, the loop will end. </span><span class="kobospan" id="kobo.992.2">We might want to add a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.993.1">do_quit()</span></span></span></span><span class="kobospan" id="kobo.994.1"> method to return </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.995.1">True</span></span></span></span><span class="kobospan" id="kobo.996.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.997.1">If the input stream is closed, an </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.998.1">EOF</span></span></span></span><span class="kobospan" id="kobo.999.1"> command will be provided. </span><span class="kobospan" id="kobo.999.2">In Linux, using </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1000.1">ctrl-d</span></span></span></span><span class="kobospan" id="kobo.1001.1"> will close the input file. </span><span class="kobospan" id="kobo.1001.2">This leads to the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1002.1">do_EOF()</span></span></span></span><span class="kobospan" id="kobo.1003.1"> method, which should use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1004.1">return</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1005.1"> True</span></span></span></span><span class="kobospan" id="kobo.1006.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1007.1">We might provide a method named </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1008.1">emptyline()</span></span></span></span><span class="kobospan" id="kobo.1009.1"> to respond to blank lines.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1010.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1011.1">default()</span></span></span></span><span class="kobospan" id="kobo.1012.1"> method is evaluated when the user’s input does not match any of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1013.1">do_*()</span></span></span></span><span class="kobospan" id="kobo.1014.1"> methods.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1015.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1016.1">postloop()</span></span></span></span><span class="kobospan" id="kobo.1017.1"> method can be used to do some processing just after the loop finishes. </span><span class="kobospan" id="kobo.1017.2">This would be a good place to write a summary.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.1018.1">Also, there are a number of attributes we can set. </span><span class="kobospan" id="kobo.1018.2">These are class-level variables that would be peers of the method definitions:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.1019.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1020.1">prompt</span></span></span></span><span class="kobospan" id="kobo.1021.1"> attribute is the prompt string to write. </span><span class="kobospan" id="kobo.1021.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1022.1">intro</span></span></span></span><span class="kobospan" id="kobo.1023.1"> attribute is the introductory text to write before the first prompt. </span><span class="kobospan" id="kobo.1023.2">For our example, we can do the following:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1024.1">
class DiceCLI2(cmd.Cmd): 
 
    prompt = "] " 
 
    intro = "A dice rolling tool. </span><span class="kobospan" id="kobo.1024.2">? </span><span class="kobospan" id="kobo.1024.3">for help."</span></code></pre></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1025.1">We can tailor the help output by setting </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1026.1">doc_header</span></span></span></span><span class="kobospan" id="kobo.1027.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1028.1">undoc_header</span></span></span></span><span class="kobospan" id="kobo.1029.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1030.1">misc_header</span></span></span></span><span class="kobospan" id="kobo.1031.1">, and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1032.1">ruler</span></span></span></span><span class="kobospan" id="kobo.1033.1"> attributes.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.1034.1">The goal is to be able to create a tidy class that handles user interaction as directly as possible. </span><span id="x1-365005r744"/></p>
</section>
<section data-number="0.9.6.5" id="see-also-49">
<h2 class="likechapterhead" data-number="0.9.6.5"><span><span class="kobospan" id="kobo.1035.1">6.6.5 </span></span> <span id="x1-3660005"/><span class="kobospan" id="kobo.1036.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.1037.1">We’ll look at class definitions in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1038.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1039.1"> </span></span><a href="ch011_split_000.xhtml#x1-3760007" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1040.1">7</span></span></a><span class="kobospan" id="kobo.1041.1"> and </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1042.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1043.1"> </span></span><a href="ch012.xhtml#x1-4520008" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1044.1">8</span></span></a><span class="kobospan" id="kobo.1045.1">.</span></p></li>
</ul>
<p class="normal1"><span id="x1-366001r733"/></p>
</section>
</section>
<section data-number="0.9.7" id="using-the-os-environment-settings">
<h1 class="unnumbered" data-number="0.9.7"><span><span class="kobospan" id="kobo.1046.1">6.7 </span></span> <span id="x1-3670007"/><span class="kobospan" id="kobo.1047.1">Using the OS environment settings</span></h1>
<p class="normal"><span class="kobospan" id="kobo.1048.1">There are several ways</span><span id="dx1-367001"/><span class="kobospan" id="kobo.1049.1"> to look at inputs provided by the users of our software:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.1050.1">Interactive input</span></span><span class="kobospan" id="kobo.1051.1">: This is provided by the user</span><span id="dx1-367002"/><span class="kobospan" id="kobo.1052.1"> as required by the application. </span><span class="kobospan" id="kobo.1052.2">See the </span><a href="ch010.xhtml#x1-3370002" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1053.1">Using input() and getpass() for user input</span></span></a><span class="kobospan" id="kobo.1054.1"> recipe.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.1055.1">Command-line arguments</span></span><span class="kobospan" id="kobo.1056.1">: These are provided once, when the program</span><span id="dx1-367003"/><span class="kobospan" id="kobo.1057.1"> is started. </span><span class="kobospan" id="kobo.1057.2">See the </span><a href="ch010.xhtml#x1-3490004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1058.1">Using argparse to get command-line input</span></span></a><span class="kobospan" id="kobo.1059.1"> and </span><a href="ch010.xhtml#x1-3550005" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1060.1">Using invoke to get command-line input</span></span></a><span class="kobospan" id="kobo.1061.1"> recipes.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.1062.1">Environment variables</span></span><span class="kobospan" id="kobo.1063.1">: These are OS-level settings. </span><span class="kobospan" id="kobo.1063.2">There are several</span><span id="dx1-367004"/><span class="kobospan" id="kobo.1064.1"> ways these can be set:</span></p>
<ul class="calibre25">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.1065.1">At the command line, when running the application.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1066.1">Set in a configuration file for the user’s selected shell. </span><span class="kobospan" id="kobo.1066.2">For example, if</span><span id="dx1-367005"/><span class="kobospan" id="kobo.1067.1"> using </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.1068.1">zsh</span></span><span class="kobospan" id="kobo.1069.1">, these files are the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1070.1">~/.zshrc</span></span></span></span><span class="kobospan" id="kobo.1071.1"> file and the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1072.1">~/.profile</span></span></span></span><span class="kobospan" id="kobo.1073.1"> file. </span><span class="kobospan" id="kobo.1073.2">There can also be system-wide files, like the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1074.1">/etc/zshrc</span></span></span></span><span class="kobospan" id="kobo.1075.1"> file.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1076.1">In Windows, there’s the Advanced Settings option for environment variables.</span></p></li>
</ul></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.1077.1">Configuration files</span></span><span class="kobospan" id="kobo.1078.1">: These are unique</span><span id="dx1-367006"/><span class="kobospan" id="kobo.1079.1"> to an application. </span><span class="kobospan" id="kobo.1079.2">They are the subject of </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1080.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1081.1"> </span></span><a href="ch017.xhtml#x1-71500013" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1082.1">13</span></span></a><span class="kobospan" id="kobo.1083.1">.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.1084.1">The environment variables are available through the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1085.1">os</span></span></span></span><span class="kobospan" id="kobo.1086.1"> module. </span><span id="x1-367007r746"/></p>
<section data-number="0.9.7.1" id="getting-ready-51">
<h2 class="likechapterhead" data-number="0.9.7.1"><span><span class="kobospan" id="kobo.1087.1">6.7.1 </span></span> <span id="x1-3680001"/><span class="kobospan" id="kobo.1088.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1089.1">In the </span><a href="ch010.xhtml#x1-3490004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1090.1">Using argparse to get command-line input</span></span></a><span class="kobospan" id="kobo.1091.1"> recipe, we wrapped</span><span id="dx1-368001"/><span class="kobospan" id="kobo.1092.1"> the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1093.1">haversine()</span></span></span></span><span class="kobospan" id="kobo.1094.1"> function in a simple application that parsed command-line arguments. </span><span class="kobospan" id="kobo.1094.2">We created a program that worked like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1095.1">
 
 
% python ch06/distance_app.py -u KM 36.12,-86.67 33.94,-118.40 
 
From 36.12,-86.67 to 33.94,-118.4 in KM = 2886.90 
 
"""</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1096.1">After using this version of the application for a while, we may find that we’re often using nautical miles to compute distances from where our boat is anchored. </span><span class="kobospan" id="kobo.1096.2">We’d really like to have default values for one of the input points as well as the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1097.1">-r</span></span></span></span><span class="kobospan" id="kobo.1098.1"> argument.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1099.1">Since a boat can be anchored in a variety of places, we need to change the default without having to tweak the actual code. </span><span class="kobospan" id="kobo.1099.2">The idea of a ”slowly changing” argument value fits well with the OS environment variables. </span><span class="kobospan" id="kobo.1099.3">They can be persistent but are also relatively easy to change.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1100.1">We’ll use two OS environment variables:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1101.1">UNITS</span></span></span></span><span class="kobospan" id="kobo.1102.1"> will have the default distance units.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1103.1">HOME_PORT</span></span></span></span><span class="kobospan" id="kobo.1104.1"> can have an anchor point.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.1105.1">We want to be able to do the following:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1106.1">
 
 
% UNITS=NM 
 
% HOME_PORT=36.842952,-76.300171 
 
% python ch06/distance_app.py 36.12,-86.67 
 
 
 
From 36.12,-86.67 to 36.842952,-76.300171 in NM = 502.23</span></code></pre>
<p class="normal1"><span id="x1-368012r748"/></p>
</section>
<section data-number="0.9.7.2" id="how-to-do-it...-51">
<h2 class="likechapterhead" data-number="0.9.7.2"><span><span class="kobospan" id="kobo.1107.1">6.7.2 </span></span> <span id="x1-3690002"/><span class="kobospan" id="kobo.1108.1">How to do it...</span></h2>
<ol class="calibre2">
<li class="calibre7"><div id="x1-369002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1109.1">Import the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1110.1">os</span></span></span></span><span class="kobospan" id="kobo.1111.1"> module. </span><span class="kobospan" id="kobo.1111.2">The default</span><span id="dx1-369003"/><span class="kobospan" id="kobo.1112.1"> set of command-line arguments to parse comes from </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1113.1">sys.argv</span></span></span></span><span class="kobospan" id="kobo.1114.1">, so it’s important to also import the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1115.1">sys</span></span></span></span><span class="kobospan" id="kobo.1116.1"> module. </span><span class="kobospan" id="kobo.1116.2">The application will also depend on the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1117.1">argparse</span></span></span></span><span class="kobospan" id="kobo.1118.1"> module:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1119.1">
import os 
 
import sys 
 
import argparse</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-369009x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1120.1">Import any other classes or objects needed for the application:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1121.1">
from ch03.recipe_11 import haversine, MI, NM, KM 
 
from ch06.recipe_04 import point_type, display</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-369014x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1122.1">Define a function that will use the environment values as defaults for optional command-line arguments:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1123.1">
def get_options(argv: list[str] = sys.argv[1:]) -&gt; argparse.Namespace:</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-369018x4" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1124.1">Gather default values from the OS environment settings. </span><span class="kobospan" id="kobo.1124.2">This includes any validation required:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1125.1">
    default_units = os.environ.get("UNITS", "KM") 
 
    if default_units not in ("KM", "NM", "MI"): 
 
        sys.exit(f"Invalid UNITS, {default_units!r} not KM, NM, or MI") 
 
    default_home_port = os.environ.get("HOME_PORT")</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1126.1">Note that using </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1127.1">os.environ.get()</span></span></span></span><span class="kobospan" id="kobo.1128.1"> permits the application to include a default value for cases where the environment variable is not set.</span></p>
</div></li>
<li class="calibre7"><div id="x1-369025x5" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1129.1">Create the parser object. </span><span class="kobospan" id="kobo.1129.2">Provide the default values for the relevant arguments extracted from the environment variables:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1130.1">
    parser = argparse.ArgumentParser() 
 
    parser.add_argument("-u", "--units", 
 
        action="store", choices=("NM", "MI", "KM"), 
 
        default=default_units 
 
    ) 
 
    parser.add_argument("p1", action="store", type=point_type) 
 
    parser.add_argument( 
 
        "p2", nargs="?", action="store", type=point_type, 
 
        default=default_home_port 
 
    )</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-369038x6" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1131.1">Do any additional validation to ensure</span><span id="dx1-369039"/><span class="kobospan" id="kobo.1132.1"> that arguments are set properly. </span><span class="kobospan" id="kobo.1132.2">In this example, it’s possible to have no value for </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1133.1">HOME_PORT</span></span></span></span><span class="kobospan" id="kobo.1134.1"> and no value provided for the second command-line argument.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1135.1">This requires an if statement and a call to </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1136.1">sys.exit()</span></span></span></span><span class="kobospan" id="kobo.1137.1">:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1138.1">
                                                                     

                                                                     
    options = parser.parse_args(argv) 
 
    if options.p2 is None: 
 
        sys.exit("Neither HOME_PORT nor p2 argument provided.")</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-369045x7" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1139.1">Return the final </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1140.1">options</span></span></span></span><span class="kobospan" id="kobo.1141.1"> object with the set of valid arguments:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1142.1">
    return options</span></code></pre>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.1143.1">This will allow the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1144.1">-u</span></span></span></span><span class="kobospan" id="kobo.1145.1"> argument and the second point to be optional. </span><span class="kobospan" id="kobo.1145.2">The argument parser will use the configuration information to supply default values if these are omitted from the command line.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1146.1">There is a nuanced distinction in the error code provided by </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1147.1">sys.exit()</span></span></span></span><span class="kobospan" id="kobo.1148.1">. </span><span class="kobospan" id="kobo.1148.2">When applications fail because of command-line problems, it’s common to return a status code of 2, but </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1149.1">sys.exit()</span></span></span></span><span class="kobospan" id="kobo.1150.1"> will set the value to 1. </span><span class="kobospan" id="kobo.1150.2">A slightly better approach is to use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1151.1">parser.error()</span></span></span></span><span class="kobospan" id="kobo.1152.1"> method. </span><span class="kobospan" id="kobo.1152.2">Doing this requires refactoring to create the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1153.1">ArgumentParser</span></span></span></span><span class="kobospan" id="kobo.1154.1"> instance </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1155.1">before </span></span><span class="kobospan" id="kobo.1156.1">acquiring and validating values from environment variables. </span><span id="x1-369048r751"/></p>
</section>
<section data-number="0.9.7.3" id="how-it-works...-51">
<h2 class="likechapterhead" data-number="0.9.7.3"><span><span class="kobospan" id="kobo.1157.1">6.7.3 </span></span> <span id="x1-3700003"/><span class="kobospan" id="kobo.1158.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1159.1">We’ve used the OS environment variables</span><span id="dx1-370001"/><span class="kobospan" id="kobo.1160.1"> to create default values that can be overridden by command-line arguments. </span><span class="kobospan" id="kobo.1160.2">If the environment variable is set, that string is provided as the default to the argument definition. </span><span class="kobospan" id="kobo.1160.3">If the environment variable is not set, then an application-level default value will used. </span><span class="kobospan" id="kobo.1160.4">In the case of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1161.1">UNITS</span></span></span></span><span class="kobospan" id="kobo.1162.1"> variable, in this example, the application uses kilometers as the default if the OS environment variable is not set.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1163.1">We’ve used the OS environment to set default values that can be overridden by the command-line argument values. </span><span class="kobospan" id="kobo.1163.2">This supports the idea of the environment providing a general context that might be shared by a number of commands. </span><span id="x1-370002r759"/></p>
</section>
<section data-number="0.9.7.4" id="theres-more...-43">
<h2 class="likechapterhead" data-number="0.9.7.4"><span><span class="kobospan" id="kobo.1164.1">6.7.4 </span></span> <span id="x1-3710004"/><span class="kobospan" id="kobo.1165.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1166.1">The </span><a href="ch010.xhtml#x1-3490004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1167.1">Using argparse to get command-line input</span></span></a><span class="kobospan" id="kobo.1168.1"> recipe shows a slightly different way to handle the default command-line arguments available from </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1169.1">sys.argv</span></span></span></span><span class="kobospan" id="kobo.1170.1">. </span><span class="kobospan" id="kobo.1170.2">The first of the arguments is the name of the Python application being executed and is not often relevant to argument parsing.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1171.1">The value of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1172.1">sys.argv</span></span></span></span><span class="kobospan" id="kobo.1173.1"> will be a list of strings:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1174.1">
 
 
[’ch06/distance_app.py’, ’-u’, ’NM’, ’36.12,-86.67’]</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1175.1">We have to skip the initial value in </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1176.1">sys.argv[0]</span></span></span></span><span class="kobospan" id="kobo.1177.1"> at some point in the processing. </span><span class="kobospan" id="kobo.1177.2">Generally, the application needs to provide </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1178.1">sys.argv[1:]</span></span></span></span><span class="kobospan" id="kobo.1179.1"> to the parser. </span><span class="kobospan" id="kobo.1179.2">This can be done inside the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1180.1">get_options()</span></span></span></span><span class="kobospan" id="kobo.1181.1"> function. </span><span class="kobospan" id="kobo.1181.2">It can be done when the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1182.1">main()</span></span></span></span><span class="kobospan" id="kobo.1183.1"> function evaluates the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1184.1">get_options()</span></span></span></span><span class="kobospan" id="kobo.1185.1"> function. </span><span class="kobospan" id="kobo.1185.2">As shown in this example, it can be done when creating the default argument values for the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1186.1">get_options()</span></span></span></span><span class="kobospan" id="kobo.1187.1"> function.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1188.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1189.1">argparse</span></span></span></span><span class="kobospan" id="kobo.1190.1"> module allows us to provide type information for an argument definition. </span><span class="kobospan" id="kobo.1190.2">Providing type information can be used to validate argument values. </span><span class="kobospan" id="kobo.1190.3">In many cases, there may be a finite list of choices for a value, and this set of allowed choices can be provided as part of the argument definition. </span><span class="kobospan" id="kobo.1190.4">Doing this creates better error and help messages, improving the user experience when running the application. </span><span id="x1-371003r760"/></p>
</section>
<section data-number="0.9.7.5" id="see-also-50">
<h2 class="likechapterhead" data-number="0.9.7.5"><span><span class="kobospan" id="kobo.1191.1">6.7.5 </span></span> <span id="x1-3720005"/><span class="kobospan" id="kobo.1192.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.1193.1">We’ll look at numerous ways to handle configuration files in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1194.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1195.1"> </span></span><a href="ch017.xhtml#x1-71500013" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1196.1">13</span></span></a><span class="kobospan" id="kobo.1197.1">.</span></p></li>
</ul>
<p class="normal1"><span id="x1-372001r747"/></p>
</section>
</section>
<section data-number="0.9.10" id="join-our-community-discord-space-6">
<h1 class="unnumbered" data-number="0.9.10"><span id="x1-3750009"/><span class="kobospan" id="kobo.1198.1">Join our community Discord space</span></h1>
<p class="normal"><span class="kobospan" id="kobo.1199.1">Join our Python Discord workspace to discuss and find out more about the book: </span><a class="url" href="https://packt.link/dHrHU"><span class="url1"><span class="kobospan" id="kobo.1200.1">https://packt.link/dHrHU</span></span></a></p>
<p class="normal1"><span class="kobospan" id="kobo.1201.1"><img alt="PIC" src="../media/file1.png" class="calibre9"/></span></p>
<p class="normal1"><span id="x1-375001r661"/></p>
</section>
</section>
</body></html>