<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Getting Started with Maya</h1></div></div></div><p>This chapter will cover everything you need to get the most out of the rest of the book, as well as give you a feel for the differences between MEL and Python, as follows:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Using the script editor to investigate functionality</li><li class="listitem" style="list-style-type: disc">Running code from the script editor</li><li class="listitem" style="list-style-type: disc">Importing Maya's built-in Python functionality</li><li class="listitem" style="list-style-type: disc">Accessing documentation for a specific command</li><li class="listitem" style="list-style-type: disc">Understanding Create, Query, and Edit flags</li><li class="listitem" style="list-style-type: disc">Adding custom folders to your script path</li><li class="listitem" style="list-style-type: disc">Writing and running an external script</li><li class="listitem" style="list-style-type: disc">Calling a MEL script with Python</li></ul></div><div><div><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Introduction</h1></div></div></div><p>In this chapter, we'll cover the basics of scripting with Maya and Python. If you've been scripting for Maya for a while, a lot of what's covered will likely be familiar. If you're new to Maya scripting, this chapter will get you set up with everything you'll need to know to get the most out of the rest of the book.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Using the script editor to investigate functionality</h1></div></div></div><p>The <a id="id0" class="indexterm"/>script editor is your primary tool in order to learn about Maya's script-based functionality, as well as a great place to test small snippets of code outside a full script. One of the most useful aspects of the script editor is that it will show you the commands that correspond to the actions that you take within Maya's interface.</p><p>This is <a id="id1" class="indexterm"/>one of the best ways to learn about the commands involved in your day-to-day Maya tasks. For example, let's use it to find out how to make a polygonal cube with <a id="id2" class="indexterm"/>
<strong>Maya Embedded Language</strong> (<strong>MEL</strong>):</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec12"/>How to do it...</h2></div></div></div><div><ol class="orderedlist arabic"><li class="listitem">Open the script editor by going to <strong>Windows</strong> | <strong>General Editors</strong> | <strong>Script Editor</strong>.</li><li class="listitem">You'll likely note that there is a lot of text already displayed, even if you've only recently opened Maya. To make things easier to see, go to <strong>Edit</strong> | <strong>Clear History</strong> from within the <strong>Script Editor</strong> window's menu.</li><li class="listitem">Now<a id="id3" class="indexterm"/> try making a polygon cube by holding down space to bring up the hotbox and going to <strong>Create</strong> | <strong>Polygon Primitives</strong> | <strong>Cube</strong>.</li><li class="listitem">Use the interactive creation tool to specify the poly cube's dimensions.</li><li class="listitem">Observe the output in the top half of the script editor. You should see something like the following:<div><pre class="programlisting">setToolTo CreatePolyCubeCtx;
polyCube -ch on -o on -w 5.502056 -h 3.41434 -d 7.451427 -sw 5 -sd 5 -cuv 4 ;
// Result: pCube1 polyCube1 //</pre></div></li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec13"/>How it works...</h2></div></div></div><p>The output that Maya provides is presented as the MEL commands that correspond to the action that you've just taken. That can be a great way to find out which commands you'll need to use in your own scripts. In this case, it's the <code class="literal">polyCube</code> command, which will create a polygonal cube. Every command in Maya comes in two flavors—the MEL version and the corresponding Python command.</p><p>The script editor shows you commands in MEL syntax, which tends to take the form of:</p><div><pre class="programlisting">commandName -option1Name option1Value -option2Name option2Value;</pre></div><p>The MEL syntax borrows a lot from batch scripting wherein it relies on strings of option names (generally referred to as "flags") and corresponding values. The corresponding Python command generally has the following syntax:</p><div><pre class="programlisting">commandName(option1Name=option1Value, option1Name=option1Value)</pre></div><p>As you can see, the MEL and Python versions are fairly similar, but with some key differences:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">In the MEL version, flag names are indicated with a dash, and their values follow directly after, whereas in Python, options are given with the "optionName=value" syntax</li><li class="listitem" style="list-style-type: disc">Python encloses all the flags in parentheses, whereas MEL does not</li><li class="listitem" style="list-style-type: disc">MEL requires a semicolon (;) at the end of each line, whereas Python does not</li></ul></div><p>Another big difference between MEL and Python is how they treat whitespace characters (spaces, tabs, and newlines). MEL, like most languages, doesn't care about whitespace; statements are terminated with semicolons, and blocks of code are defined with matched sets of curly brackets.</p><p>Python, however, uses whitespace characters to control program flow. This is often one of the strangest<a id="id4" class="indexterm"/> things about Python to people who are new to the language, but not to programming. In Python, blocks of code are defined by indentation. You can use either tabs or spaces, but the key thing is that you're consistent. In Python, every time you increase the number of tabs (or spaces) at the start of a line, it's equivalent to adding an opening curly bracket, and every time you decrease that number, it's equivalent to a closing curly bracket. This can often be confusing, as the structure of your program is defined by characters that may not actually be visible. If you're new to Python and having trouble keeping track of your whitespace, you might want to change your editor settings to display whitespace characters. Most programmer-friendly text editors include such an option, and it can be a big help.</p><p>The specific list of options for each command can be found in the built-in Python documentation, accessible from within Maya by going to <strong>Help</strong> | <strong>Python Command Reference</strong>. For most commands, you'll find a long list of options.</p><p>To make things even more complicated, every option has both a short name and a long name. For example, the polyCube allows you to specify the number of subdivisions along the X axis. You can use either the long name, "subdivisionsX" or the short name, "sx" to set it.</p><p>For example, all of the following will result in the creation of a 1x1x1 polygonal cube with five subdivisions along the X-axis.</p><p>The MEL versions are:</p><div><pre class="programlisting">polyCube -sx 5;
polyCube -subdivisionsX 5; </pre></div><p>The Python versions are:</p><div><pre class="programlisting">maya.cmds.polyCube(sx=5)
maya.cmds.polyCube(subdivsionsX=5)</pre></div><p>Feel free to use either the short or long version for your arguments. You can also mix and match, using short names for some arguments and long names for others.</p><p>In practice, it's generally best to use short names for common arguments (ones that you're likely to remember) and long names for more obscure / more rarely used arguments. Remember that just because your code seems completely sensible to you right now, it may look confusing when you revisit it 6 months (or 6 years!) from now. Make it easy for your future self by using long names (and including comments) when necessary.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec14"/>There's more...</h2></div></div></div><p>You may be wondering why Maya offers two different methods for scripting, MEL and Python. That's a simple case of backwards compatibility. MEL came first and was available in Maya long before Python support was added. Back then, you had to use MEL for day-to-day tasks, and if that couldn't provide you with what you needed, you had to dive into the C++ API (which was quite involved and hard to work with on non-Windows systems). Python unites both approaches, but MEL is still supported to allow older scripts to work. It's also possible that you might get better performance with MEL than with Python, as the Python functionality is a wrapper around MEL. Python is a much nicer language to work with though, so it's generally a worthwhile trade-off.</p><p>Note that<a id="id5" class="indexterm"/> the script editor doesn't (by default) show you everything that you do. Under normal circumstances, Maya shows you a slightly filtered output based on what you are most likely to be interested in. This is usually a good thing, but there are times when you'll want to disable it. To show <em>all</em> the output, go to the script editor and select <strong>History</strong> | <strong>Echo all Commands</strong>. This will cause Maya to output <em>everything</em> to the script editor. This generally means much, much more output than you want, but can sometimes be helpful. In practice, you'll generally want to leave that option off except when you're trying to replicate a given piece of functionality in a script, and the default output isn't giving you any insight into what Maya is doing.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec15"/>See also</h2></div></div></div><p>If you have Maya setup to use interactive mode for the creation of primitive shapes, you must have seen the following in the output presented in the Script Editor:</p><div><pre class="programlisting">setToolTo CreatePolyCubeCtx;</pre></div><p>Contexts are an alternative way of getting input from the user, and we'll have more to say about them in <a class="link" href="ch10.html" title="Chapter 10. Advanced Topics">Chapter 10</a>, <em>Advanced Topics</em>.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Running code from the script editor</h1></div></div></div><p>Not only is <a id="id6" class="indexterm"/>the Script Editor a great way to see which <a id="id7" class="indexterm"/>commands correspond to the actions you take in Maya's UI, but it is also a convenient way to write small bits of code. While you will certainly want to use a text editor to write your scripts, it is still important to be comfortable using the script editor to run small sections of code, either to test it out before inclusion in a larger script or to get more information<a id="id8" class="indexterm"/> about the current scene.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec16"/>Getting ready</h2></div></div></div><p>Make<a id="id9" class="indexterm"/> sure that you have the script editor open and that you've switched to the Python tab in the input (bottom) section.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec17"/>How to do it...</h2></div></div></div><p>Type the following into the input section:</p><div><pre class="programlisting">import maya.cmds

maya.cmds.polyCube()</pre></div><p>Once you've done that, execute it by either pressing the Execute button at the top of the Script Editor or just by pressing <em>Control</em> + <em>Enter</em>.</p><p>Your code will disappear from the input section, a new polygon cube will be created, and the results will be pasted into the output ("History") section of the script editor.</p><p>To keep your code from disappearing automatically, highlight it first with Command-A (to select everything), then press <em>Command</em> + <em>Enter</em>. This will cause Maya to run just the selected code without clearing out the input section.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec18"/>How it works...</h2></div></div></div><p>Although the <code class="literal">polyCube</code> command does the actual work, we have to first import the Maya library for Python before we can use it. To do this, we have to first use <code class="literal">import maya.cmds</code>.</p><p>The script editor is a great way to try out small snippets of code, but the fact that successful code is deleted can get rather frustrating. For any real script development, you'll want to use a programmer-friendly text editor.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec19"/>There's more...</h2></div></div></div><p>One handy thing about the script editor is that you can save code from the editor to the shelf. To do this, enter some code into the input section, then go to <strong>File</strong> | <strong>Save Script to Shelf...</strong> from the <strong>Script Editor</strong> menu. Maya will ask you to provide a name for the script and then (after a bit of time), a new button will appear in the "Custom" shelf. Pressing that button will execute the corresponding code.</p><p>Although most of your scripting work will involve writing separate scripts, it can sometimes be useful to copy-paste commands from the history (top) section of the Script Editor to the<a id="id10" class="indexterm"/> input (bottom) section and save it all to the shelf. This is a bit like recording an action in Photoshop and can be a quick and dirty way to create a new shortcut for <a id="id11" class="indexterm"/>commonly used functionality.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec12"/>Importing Maya's built-in Python functionality</h1></div></div></div><p>Python is <a id="id12" class="indexterm"/>a really useful language, but it doesn't actually offer that much out of the box other than some basic commands for manipulating simple data. In order to do truly interesting things, you'll generally need to extend Python's built-in functionality with one or more libraries, including the one that provides access to Maya's functionality.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec20"/>How to do it...</h2></div></div></div><p>First, let's import the main Maya scripting library for Python, <code class="literal">maya.cmds</code>:</p><div><pre class="programlisting">import maya.cmds as cmds</pre></div><p>Once we've done that, we can use <code class="literal">cmds</code> instead of <code class="literal">maya.cmds</code>. For example, if we have this code:</p><div><pre class="programlisting">maya.cmds.polyCube()</pre></div><p>We can instead use the following:</p><div><pre class="programlisting">cmds.polyCube()</pre></div><p>That might seem like a minor change, but in the course of a full script, it can save you a great deal of typing. Less typing means fewer typos, so it's well worth doing.</p><p>Now that we've done this, let's see what cmds has to offer by listing its contents. Python offers a handy way to display the contents of any object via the <code class="literal">dir()</code> command. Let's use that to get a list of all the commands in <code class="literal">maya.cmds</code>:</p><div><pre class="programlisting">commandList = dir(cmds)
for command in commandList:
    print(command)</pre></div><p>Run the preceding code, and you'll see a long list of everything defined in the maya.cmds library. This will be an extensive list, indeed. Most of the commands you'll see are covered in the official docs, but it's good to know how to use dir to investigate a given library.</p><p>You can also use dir to investigate a specific command. For example, try the following code:</p><div><pre class="programlisting">props = dir(cmds.polyCube)
for prop in props:
    print(prop)</pre></div><p>Run the <a id="id13" class="indexterm"/>preceding code, and you'll see all of the properties for the polyCube command itself. However, the results will likely look a bit odd in that none of them have anything to do with generating a polygonal cube. That's because <code class="literal">maya.cmds.[commandName]</code> is a built-in function. So, if you use <code class="literal">dir()</code> to investigate it further, you'll just see the capabilities that are common to Python functions. For details on the specifics of a command, consult the built-in documentation for Maya's commands, which can be accessed by going to <strong>Help</strong> | <strong>Maya Scripting Reference</strong> | <strong>Python Command Reference</strong>.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec21"/>How it works...</h2></div></div></div><p>Like any other specific subdomain of Python functionality, the commands that expose Maya's toolset to Python are part of a library. In order to make use of them, you have to first import the library. Virtually, every script you write will require the "maya.cmds" library, and you will likely need to include additional libraries occasionally for additional capabilities, such as communicating with a webserver or reading in a particular file format.</p><p>Although you could just leave it at <code class="literal">import maya.cmds</code>, that would require a lot of additional typing. By using the <code class="literal">import [library] as [shortName]</code> syntax, you can tell Python to use a custom name as an alias for <code class="literal">maya.cmds</code>. You could use almost any name you want (<code class="literal">import maya.cmds as MyUncleFred</code> would work just fine), but in practice, you want to use something both short and descriptive. You'll also want to make sure that you don't overwrite any of Python's built-in libraries. For example, you <em>could</em> do the following:</p><div><pre class="programlisting">import maya.cmds as math</pre></div><p>This would rename <code class="literal">maya.cmds</code> as math and cause trouble if you wanted to use any of the functions defined in the math library. Don't do that.</p><p>For the sake of this book and consistency with Maya's documentation, we will be using "cmds" as the shorthand for "maya.cmds".</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec22"/>There's more...</h2></div></div></div><p>The maya.cmds library is only one of several libraries that can be used to interface Maya with Python. One of the great things about Python support in Maya is that the old way of doing things, where there was both MEL (for day-to-day tasks) and the C++ API (for larger scale plugins), is unified under the banner of Python. The <code class="literal">maya.cmds</code> library handles the MEL component, but for functions previously accessed through the C++ API, you'll want to use maya.OpenMaya instead.</p><p>It (maya.cmds) is a lightweight wrapper around the MEL commands that many Maya users have grown accustomed to, and it has the benefit of being officially supported by Autodesk. However, it is not the only way to access MEL commands. There is also a third-party <a id="id14" class="indexterm"/>library, PyMEL (accessed by importing <code class="literal">pymel.core</code>). PyMEL has the benefit of being more "Pythonic" and offering nicer syntax, but is not directly supported by Autodesk. It also introduces additional layers of abstraction on top of the built-in functionality, which can lead to poorer performance.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec13"/>Accessing documentation for a specific command</h1></div></div></div><p>Maya is<a id="id15" class="indexterm"/> a complex tool, and it offers a wide range of functionality, all of it with corresponding commands that can be invoked via scripts. Each command has its own set of arguments, ranging from easily understood to quite cryptic.</p><p>When writing scripts for Maya (and as with any other kind of programming), it is vital to be able to find the appropriate documentation and to understand how to make sense of it.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec23"/>How to do it...</h2></div></div></div><p>Let's say that we want more information on a specific command, say the command to create a polygonal cube.</p><p>One way to view the help for the command is to use Maya's web-based command help, available by going to <strong>Help</strong> | <strong>Python Command Reference</strong> from within Maya. From there, you can either click on the "Polygons" subsection or use the search box.</p><p>There are a couple of other ways to get to the documentation for a command, though. You can also go directly to the documentation for a command from the Script Editor window. First, execute the corresponding action using Maya's interface, such as invoking the hotbox and choosing <strong>Create</strong> | <strong>Polygon Primitives</strong> | <strong>Cube</strong>.</p><p>That will cause the corresponding MEL command to be displayed in the output section of the <strong>Script Editor</strong>, in this case, "polyCube". From within the script editor, highlight the relevant line, and go to <strong>Help</strong> | <strong>Help on Selected Command</strong>. This will bring up a browser window with the documentation for that command. Note that it will default to the MEL version of the command; for the Python version, click on the "Python" link in the top-right corner of the window.</p><p>Finally, you can retrieve information about a command via Python directly using the help command. Try running the following:</p><div><pre class="programlisting">print(cmds.help('polyCube'))</pre></div><p>This will result in a list of the flags available for the given command, as well as the type of value that Maya expects for each, such as:</p><div><pre class="programlisting">  -sx -subdivisionsX        Int</pre></div><p>This means that there is a flag named "sx" or "subdivisionsX" that expects an integer value.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec24"/>How it works...</h2></div></div></div><p>For the <a id="id16" class="indexterm"/>most part, you'll want just the Python command reference open in a browser window while you work on developing your scripts. Good reference documents are key to writing good software, and you should get used to just keeping the references close at hand.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec25"/>There's more...</h2></div></div></div><p>You can also use the help command to invoke the web-based documentation for a given command directly, such as:</p><div><pre class="programlisting">cmds.help('polyCube', doc=True, language='python')</pre></div><p>This would bring up the web page containing the documentation for the Python version of the polyCube command. That's definitely a clunky way to access the help, but might be useful if you wanted to give the users of your script an easy way to refer to relevant documentation directly from your script's user interface.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec14"/>Understanding Create, Query, and Edit flags</h1></div></div></div><p>One thing <a id="id17" class="indexterm"/>that is a bit strange about Maya scripting is that the same command can be used in up to three different ways—create, query, and edit modes—with the specifics varying<a id="id18" class="indexterm"/> for each of the command flags. This is a byproduct of the fact that the Python functionality is a wrapper around the older MEL-based <a id="id19" class="indexterm"/>scripting system, and it can seem a bit confusing when you're getting started. Nevertheless, it is important to understand the differences between the three modes and how to use them.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec26"/>Getting ready</h2></div></div></div><p>Open up the Python command reference by going to <strong>Help</strong> | <strong>Python Command Reference</strong> and navigate to the documentation for the polyCube command.</p><p>Also, be sure to have the script editor open in Maya and be in the Python tab. Alternatively, you can run the example commands Maya's command line; just make sure that you're running in Python mode rather than MEL (click on <strong>MEL</strong> to switch to Python and <strong>Python</strong> to switch back to MEL).</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec27"/>How to do it...</h2></div></div></div><p>First off, take <a id="id20" class="indexterm"/>a look at the Properties column. You'll see that every flag has some combination of "C", "E", "Q", and "M" listed. Those refer to the different ways in <a id="id21" class="indexterm"/>which a command can be run and have the following meanings:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>C</strong>: "Create" flag is only relevant when first running the command, such as when you initially create a polygonal primitive</li><li class="listitem" style="list-style-type: disc"><strong>Q</strong>: "Query" flag can be queried after the command has been run and can be used to retrieve information about something in the scene</li><li class="listitem" style="list-style-type: disc"><strong>E</strong>: "Edit" flag can be edited after the fact</li><li class="listitem" style="list-style-type: disc"><strong>M</strong>: "Multiple" flag can be used more than once in a single instance of the command (to create specify multiple points when creating a curve, for example)</li></ul></div><p>For many <a id="id22" class="indexterm"/>flags, you'll see a full complement of create, query, and edit, but there are generally at least a few flags that aren't accessible for one or more of the modes. </p><p>Let's see how create, edit, and query play out in the case of the polyCube command. </p><p>First off, let's make a new cube and store the result in a variable, so we can make use of it later:</p><div><pre class="programlisting">myCube = cmds.polyCube()</pre></div><p>Now, let's change something about the cube, post-creation by using the edit mode:</p><div><pre class="programlisting">cmds.polyCube(myCube, edit=True, subdivisionsX=5)</pre></div><p>This will cause the cube that we created with the first command to be altered from the default (no subdivisions in the <em>x</em> axis) to having five.</p><p>Now, let's use the query mode to store the new number of divisions to a variable:</p><div><pre class="programlisting">numberDivisions = cmds.polyCube(myCube, query=True, subdivisionsX=True)
print(numberDivisions)</pre></div><p>You should see "5.0" as the output. Note that even though the number of divisions of a polygonal cube must be an integer value, Maya is displaying it as "5.0". </p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec28"/>How it works...</h2></div></div></div><p>The important thing to note for the query and edit modes is that you run the command as you normally <a id="id23" class="indexterm"/>would (<code class="literal">cmds.polyCube</code>, for example), but with the following three key differences:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The inclusion of the name of the object as the first argument. This can either be the name directly as a string <code class="literal">("pCube1"</code>, for example), or a variable.</li><li class="listitem" style="list-style-type: disc">The inclusion of either <code class="literal">edit=True</code> or <code class="literal">query=True</code> as an argument.</li><li class="listitem" style="list-style-type: disc">Additional arguments, with the specifics based on whether you're running the command in the query or edit mode.</li></ul></div><p>For the <a id="id24" class="indexterm"/>edit mode, you'll want to specify the name of the property you want to change, along with the new value. For the query mode, you'll want to just include the <a id="id25" class="indexterm"/>name of the property and "=True". Think of this as saying that it is <code class="literal">True</code> that you want to know the value of the property. Note that you can only query a single flag at a time. If you need to query multiple values, run the command multiple times, changing the flag you pass in.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec29"/>There's more...</h2></div></div></div><p>Although many of the most-used properties can be used in all three modes, there are numerous examples of ones that cannot be, mainly because it wouldn't make sense to do so. For example, it's perfectly reasonable to set construction history on or off when creating a new object, and it's certainly reasonable to query that after the fact, but what would it mean to use the edit mode to enable construction history on an object that didn't already have it? That would require rebuilding the history of the object, which may have been manipulated in various ways since it was created. As a result, the "constructionHistory" (or "ch") flag only offers the Create and Query options.</p><p>You might think that this is all a bit clunky, and if all we wanted to do was set the number of subdivisions for a newly created cube, you would be correct. However, it's important to understand the different command modes, both to get information after the fact and because it's an important part of building user interface elements and getting information from them.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec30"/>See also</h2></div></div></div><p>We'll be making the extensive use of the Query mode to retrieve information from user interface elements throughout the rest of the book, starting in <a class="link" href="ch02.html" title="Chapter 2. Creating User Interfaces">Chapter 2</a>, <em>Creating User Interfaces</em>.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec15"/>Adding custom folders to your script path</h1></div></div></div><p>In order to write<a id="id26" class="indexterm"/> reusable scripts, you'll want to save your scripts to external files, and in order to do <em>that</em>, you'll need to make sure that Maya knows where they are.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec31"/>How to do it...</h2></div></div></div><p>Maya <a id="id27" class="indexterm"/>maintains a list of locations to search for scripts, used when you use the import (Python) or source (MEL) commands. If you want to see the full list, you can do so with the following code:</p><div><pre class="programlisting">import sys

pathList = sys.path
for path in pathList:
    print(path)</pre></div><p>This will provide you with a list of paths, including the following:</p><div><pre class="programlisting">/Users/[username]/Library/Preferences/Autodesk/maya/[maya version]/prefs/scripts
/Users/[username]/Library/Preferences/Autodesk/maya/[maya version]/scripts
/Users/[username]/Library/Preferences/Autodesk/maya/scripts</pre></div><p>Saving your scripts to any of those folders will allow Maya to find them. If you're fine with saving all of your scripts to one of those folders, that's totally fine. </p><p>However, you might want to add additional folders to the list. For example, you might want to save your scripts in a folder within the my <code class="literal">Documents</code> directory, maybe something like:</p><div><pre class="programlisting">/Users/adrian/Documents/MayaScripting/examples/</pre></div><p>Note that this is a typical example on Macintosh. On a Windows machine, it would look more like:</p><div><pre class="programlisting">\Documents and Settings\[username]\MyDocuments\MayaScripting\examples</pre></div><p>Either way, we'll need to tell Maya to look there to find scripts to execute. There are a few ways we could do it, but in keeping with the theme of the book, we'll do it using Python.</p><p>Run the following code in the script editor:</p><div><pre class="programlisting">import sys
sys.path.append('/Users/adrian/Documents/MayaScripting/examples')</pre></div><p>This is done by replacing <code class="literal">/Users/adrian/Documents/MayaScripting/examples</code> with whatever folder you want to use. </p><p>Once you've done this, you'll be able to import scripts stored in that directory as well. However, having to<a id="id28" class="indexterm"/> enter the preceding code every time you launch Maya would be quite frustrating. Luckily, Maya provides a way for us to execute custom Python code on a startup.</p><p>To make the<a id="id29" class="indexterm"/> code execute every time Maya opens, save it to a file named <code class="literal">userSetup.py</code> and save it to the following location for a Mac: </p><div><pre class="programlisting">~/Library/Preferences/Autodesk/maya/&lt;version&gt;/scripts</pre></div><p>Or for Windows, you can save it to:</p><div><pre class="programlisting">&lt;drive&gt;:\Documents and Settings\&lt;username&gt;\My Documents\maya\&lt;version&gt;\scripts</pre></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec32"/>How it works...</h2></div></div></div><p>All of the code contained in <code class="literal">userSetup.py</code> will be run every time Maya starts up.</p><p>While the base list of paths that Maya will search for scripts is not altered by the above, it will cause Maya to add your custom folder to the list every time it starts up, which in practice amounts to the same thing.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec33"/>There's more...</h2></div></div></div><p>You can also add to your paths by creating the Maya.env file and saving it to the following location (on a Mac machine):</p><div><pre class="programlisting">/Users/&lt;username&gt;/Library/Preferences/Autodesk/maya/version </pre></div><p>or</p><div><pre class="programlisting">/Users/&lt;username&gt;/Library/Preferences/Autodesk/maya</pre></div><p>On a Windows machine, save it to:</p><div><pre class="programlisting">drive:\Documents and Settings\username\My Documents\maya\version </pre></div><p>or</p><div><pre class="programlisting">drive:\Documents and Settings\username\My Documents\maya</pre></div><p>For the specifics of the <code class="literal">Maya.env</code> file syntax, consult Maya's documentation. However, editing <code class="literal">Maya.env</code> can lead to crashes and system instability if you're not careful, so I recommend relying on <code class="literal">userSetup.py</code> instead.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec16"/>Writing and running an external script</h1></div></div></div><p>In this recipe, we'll be <a id="id30" class="indexterm"/>writing and running our first actual script as an external Python file.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec34"/>Getting ready</h2></div></div></div><p>The Script Editor window is<a id="id31" class="indexterm"/> a bit of a misnomer. Although it's a great way to test out short snippets of code, it's awkward to use for any kind of real script development. For this, you'll want to have a programmer-friendly text editor setup. There are a ton of options out there, and if you're reading this book, you likely already have one that you like to use. Whatever it is, make sure that it's geared towards writing code, and it saves files in plain text.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec35"/>How to do it...</h2></div></div></div><p>First off, we'll need a script. Create a new file in your editor and add the following code:</p><div><pre class="programlisting">import maya.cmds as cmds

print("Imported the script!")
def makeObject():
    cmds.polyCube()
    print("Made a cube!")</pre></div><p>Now save the script as <code class="literal">myScript.py</code>. Once you've done that, switch back to Maya and run the following from either the script editor or the command line:</p><div><pre class="programlisting">import myScript</pre></div><p>This will cause Maya to read in the file, and you'll see the following in the script editor output:</p><div><pre class="programlisting">Imported the script!</pre></div><p>What you will not see, however, is a new cube. That's because the real functionality of our (simple) script is defined within a function named "makeObject".</p><p>Maya treats each Python file that you import as its own module, with the name of the file providing the name of the module. Once we've imported a file, we can invoke functions within it by calling [moduleName].[function name]. For the earlier-mentioned example, this would mean:</p><div><pre class="programlisting">myScript.makeObject()</pre></div><p>Run it, and you should see a newly minted cube show up, and "Made a cube!" in the output of the Script Editor.</p><p>Now, let's try changing our script. First, delete the cube we just made, then switch over to your text editor, and change the script to the following:</p><div><pre class="programlisting">import maya.cmds as cmds

def makeObject():
    cmds.polySphere()
    print("Made a sphere!")</pre></div><p>Switch back to Maya and run the script again with: </p><div><pre class="programlisting">myScript.makeObject()</pre></div><p>You'll see<a id="id32" class="indexterm"/> that rather than having a nice sphere, we still ended up with a cube. That's because when you ask Maya to execute a script that it has already executed, it will default to rerunning the same code that it ran previously. In order to ensure that we get the latest, greatest version of our script, we'll need to first run the following:</p><div><pre class="programlisting">reload(myScript)</pre></div><p>This will <a id="id33" class="indexterm"/>force Maya to reload the file. Note that the argument to reload isn't the file name itself (<code class="literal">myScript.py</code> in this case), but rather the name of the module that the file defines ("myScript").</p><p>Once you've done this, you can once again try:</p><div><pre class="programlisting">myScript.makeObject()</pre></div><p>This time, you'll see a proper polygonal sphere, just as we intended.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec36"/>How it works...</h2></div></div></div><p>It may seem like an unnecessary extra step to both import the script and call one of its functions, and you can indeed have the script automatically execute code (as demonstrated by the call to print("Imported Script!"). However, it's much better practice to wrap all of your functionality in functions, as it makes large scripts much easier to work with.</p><p>If you have functionality that you want to execute every time the script is run, it is best to define a function with a name like "main" and have the last line of your script invoke it. Take a look at the following example:</p><div><pre class="programlisting">import maya.cmds as cmds

def makeObject():
    cmds.polyCube()
    print("Made a cube!")

makeObject()</pre></div><p>This would define the <code class="literal">makeObject()</code> function, then (on the last line of the script) cause it to be executed.</p><p>When working on a script, it can get really tedious to reload, import, and run the script each time. An easy way to get around that is to enter the following into the script editor:</p><div><pre class="programlisting">import myScript
reload(myScript)
myScript.myCommand()</pre></div><p>Once<a id="id34" class="indexterm"/> you've done that, use <strong>File</strong> | <strong>Save Script to Shelf...</strong> to give yourself a button to easily rerun the latest version of your script. Note that the preceding code contains both import and reload. That's to make sure that the code will work both the first time you run it as well as successive times. The "import" command is there to ensure the module has been loaded at least once (necessary for a new script, or upon restarting Maya), and the "reload" command is there to ensure that what we're running is the latest version (necessary if we've made changes to the script with Maya still up).</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec37"/>There's more...</h2></div></div></div><p>If you have a script that defines a lot of functionality, and you don't want to constantly type out the module name, you can use the same trick we used with <code class="literal">maya.cmds</code> to shorten things a bit. Namely, you can use the "as" syntax to provide a shorter name. For example, I could have done the following:</p><div><pre class="programlisting">import myScript as ms
ms.makeObject()</pre></div><p>This would have exactly the same effect.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch01lvl1sec17"/>Calling a MEL script with Python</h1></div></div></div><p>Maya <a id="id35" class="indexterm"/>offers two different languages with which to create custom functionality via scripting—both Maya Embedded Language (MEL) scripts and Python. In practice, you'll only want to use one, and of the two, Python offers a much better and more flexible experience.</p><p>However, it is not uncommon to have legacy scripts that were written back before Maya added Python functionality. While the "right" solution would be to rewrite the scripts using Python, there's not always enough time to do so. In those cases, it can sometimes be helpful to be able to call out to legacy, MEL-based functionality from within your Python scripts.</p><div><div><div><div><h2 class="title"><a id="ch01lvl2sec38"/>Getting ready</h2></div></div></div><p>Although Python is definitely the better way to create new functionality, it may sometimes be the case that you have older scripts that were written in MEL that you would like to incorporate.</p><p>The best<a id="id36" class="indexterm"/> option is to rewrite the script in Python, but if the script is complex or you don't have time, it may be easier to just invoke the MEL functionality from within a Python script. This way, you can incorporate legacy functionality without completely reinventing the wheel.</p></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec39"/>How to do it...</h2></div></div></div><p>For this recipe, you'll need the MEL script. If you don't have one handy, open up a new file and enter the following:</p><div><pre class="programlisting">global proc myMELScript()
{
    polyCube;
    print("Hello from MEL!");
}</pre></div><p>Save this as <code class="literal">myMELScript.mel</code> in your <code class="literal">maya/scripts</code> directory. Although we won't be going into the details of MEL, do note that the file has the same name as the function that we're defining. Most MEL scripts will follow that convention. Also note the inclusion of semicolons after the end of each line. Although Python doesn't require them, MEL (and many other languages) does.</p><p>Once you have that, create a new file and name it <code class="literal">runMEL.py</code>. Enter the following: </p><div><pre class="programlisting">import maya.cmds as cmds
import maya.mel as mel

def runMEL():
    print("Running MEL from Python")
    mel.eval("source myMELScript;")
    mel.eval("myMELScript;")

runMEL()</pre></div><p>Save the script and run it with: </p><div><pre class="programlisting">import runMEL</pre></div><p>Because the last line of our script invokes the runMEL command, it will automatically take effect. You should see a new cube, as well as the following output in the Script Editor: </p><div><pre class="programlisting">Running MEL from Python
Hello from MEL!</pre></div></div><div><div><div><div><h2 class="title"><a id="ch01lvl2sec40"/>How it works...</h2></div></div></div><p>In this example, we<a id="id37" class="indexterm"/> imported both maya.cmds and maya.mel. The maya.mel library provides support to interface Python with MEL, with one of its most useful commands being the eval function, which takes an arbitrary string and attempts to run it as an MEL command. In the earlier example, we do that twice, with the first command being:</p><div><pre class="programlisting">source myMEL;</pre></div><p>The source command does the same thing as reload, in that it ensures that Maya will reread the entire source file, rather than rerunning a potentially outdated version. This shouldn't matter because it's only necessary if you're making changes to the MEL script (and hopefully you're not doing that, use Python instead!) but it's a good thing to include just in case.</p><p>Once we've done this, we actually run the MEL script with:</p><div><pre class="programlisting">myMEL;</pre></div></div></div></body></html>