<html><head></head><body>
<section data-number="0.20" id="chapter-17-documentation-and-style">
<h2 class="likechapterhead" data-number="0.20"><span><span class="kobospan" id="kobo.1.1">17</span></span><br class="tipbox1"/> <span id="x1-91400017"/><span class="kobospan" id="kobo.2.1">Documentation and Style</span></h2>
<p class="normal"><span class="kobospan" id="kobo.3.1">We’ve combined two topics into a single chapter. </span><span class="kobospan" id="kobo.3.2">They’re often looked at as ”extras” in a project’s life-cycle. </span><span class="kobospan" id="kobo.3.3">The deliverable code is often considered to be the most important thing.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.4.1">Some developers will try to argue that test cases and documentation aren’t the code with which the user interacts, and therefore, these additional pieces aren’t as important as the code.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.5.1">This is false.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.6.1">While it is true the users don’t interact </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.7.1">directly </span></span><span class="kobospan" id="kobo.8.1">with test cases, the presence of test cases is what gives people the confidence to use the code. </span><span class="kobospan" id="kobo.8.2">Without the test cases, there’s no evidence the code does anything useful at all.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.9.1">Documentation provides essential</span><span id="dx1-914001"/><span class="kobospan" id="kobo.10.1"> information that can – eventually – be extracted from the code. </span><span class="kobospan" id="kobo.10.2">A project with a prominent </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.11.1">docs</span></span></span></span><span class="kobospan" id="kobo.12.1"> folder is considerably more trustworthy than a project that lacks documentation.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.13.1">Code ”style” is a relatively minor point. </span><span class="kobospan" id="kobo.13.2">However, it’s also part of the static assessment of code, including type hint analysis, quality metrics, and more specific ”lint” checks. </span><span class="kobospan" id="kobo.13.3">There are many software implementation practices that can be confusing, or rely on poorly documented language or library features. </span><span class="kobospan" id="kobo.13.4">These are the ”fuzzy edges” of the software. </span><span class="kobospan" id="kobo.13.5">A lint tool acts like a lint trap in an electric clothes dryer, catching highly flammable lint so it doesn’t clog the vents, preventing a fire. </span><span class="kobospan" id="kobo.13.6">Removing software fuzz can prevent bugs. </span><span class="kobospan" id="kobo.13.7">In some cases, it may only reduce the possibility of problems.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.14.1">We’ll consider linting and formatting to be quality assurance steps as important as test cases and static type checking.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.15.1">In this chapter, we’ll look at the following recipes for creating useful documentation:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><a href="ch021.xhtml#x1-9150001" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.16.1">The bare minimum: a README.rst file</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch021.xhtml#x1-9210002" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.17.1">Installing Sphinx and creating documentation</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch021.xhtml#x1-9270003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.18.1">Using Sphinx autodoc to create the API reference</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch021.xhtml#x1-9330004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.19.1">Identifying other CI/CD tools in pyproject.toml</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch021.xhtml#x1-9390005" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.20.1">Using tox to run comprehensive quality checks</span></span></a></p></li>
</ul>
<p class="normal1"><span id="x1-914002r1890"/></p>
<section data-number="0.20.1" id="the-bare-minimum-a-readme.rst-file">
<h1 class="unnumbered" data-number="0.20.1"><span><span class="kobospan" id="kobo.21.1">17.1 </span></span> <span id="x1-9150001"/><span class="kobospan" id="kobo.22.1">The bare minimum: a README.rst file</span></h1>
<p class="normal"><span class="kobospan" id="kobo.23.1">In </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.24.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.25.1"> </span></span><a href="ch020_split_000.xhtml#x1-86400016" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.26.1">16</span></span></a><span class="kobospan" id="kobo.27.1">, the </span><a href="ch020_split_000.xhtml#x1-8790003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.28.1">Creating a pyproject.toml file</span></span></a><span class="kobospan" id="kobo.29.1"> recipe described</span><span id="dx1-915001"/><span class="kobospan" id="kobo.30.1"> how to create a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.31.1">pyproject.toml</span></span></span></span><span class="kobospan" id="kobo.32.1"> file with a reference to a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.33.1">README</span></span></span></span><span class="kobospan" id="kobo.34.1"> file.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.35.1">For the purposes of that recipe, we suggested the file is a summary of how to install and use the project.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.36.1">We also noted there are six essential questions: ”who?”, ”what?”, ”why?”, ”when?”, ”where?”, and ”how?” </span><span class="kobospan" id="kobo.36.2">that can help in writing a short lede paragraph to describe the project.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.37.1">There are two common challenges when</span><span id="dx1-915002"/><span class="kobospan" id="kobo.38.1"> writing a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.39.1">README</span></span></span></span><span class="kobospan" id="kobo.40.1"> file:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.41.1">Writing too much</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.42.1">Writing too little</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.43.1">A good package will include</span><span id="dx1-915003"/><span class="kobospan" id="kobo.44.1"> a separate </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.45.1">docs</span></span></span></span><span class="kobospan" id="kobo.46.1"> folder with detailed documentation. </span><span class="kobospan" id="kobo.46.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.47.1">README</span></span></span></span><span class="kobospan" id="kobo.48.1"> file is only an introduction and a roadmap through the project’s various files and folders. </span><span class="kobospan" id="kobo.48.2">In many cases, where concrete examples are called for, it’s important to very judiciously repeat information provided elsewhere in the documentation to avoid contradictions.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.49.1">A project without a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.50.1">README</span></span></span></span><span class="kobospan" id="kobo.51.1"> is visibly deficient. </span><span class="kobospan" id="kobo.51.2">Locating good examples can help provide guidance on what is needed. </span><span class="kobospan" id="kobo.51.3">Some developers feel the code should somehow speak for itself, and serve as documentation. </span><span class="kobospan" id="kobo.51.4">The code, unfortunately, only really answers the ”how?” </span><span class="kobospan" id="kobo.51.5">question effectively. </span><span class="kobospan" id="kobo.51.6">Questions about who the users are and how the software should be deployed require statements that must exist outside the software.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.52.1">In this recipe, we’ll dive into what makes a useful </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.53.1">README</span></span></span></span><span class="kobospan" id="kobo.54.1"> file. </span><span id="x1-915004r1888"/></p>
<section data-number="0.20.1.1" id="getting-ready-127">
<h2 class="likechapterhead" data-number="0.20.1.1"><span><span class="kobospan" id="kobo.55.1">17.1.1 </span></span> <span id="x1-9160001"/><span class="kobospan" id="kobo.56.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.57.1">A preliminary step is to choose the markup that will be used for the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.58.1">README</span></span></span></span><span class="kobospan" id="kobo.59.1"> file. </span><span class="kobospan" id="kobo.59.2">There are three common choices:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.60.1">Plain text</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.61.1">Markdown</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.62.1">ReStructured Text (RST)</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.63.1">The advantage of plain text</span><span id="dx1-916001"/><span class="kobospan" id="kobo.64.1"> is the simplicity of avoiding additional formatting elements. </span><span class="kobospan" id="kobo.64.2">The disadvantage is the lack of typographic hints like font changes to provide important context.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.65.1">The Markdown markup has</span><span id="dx1-916002"/><span class="kobospan" id="kobo.66.1"> the advantage of having a small set of elements. </span><span class="kobospan" id="kobo.66.2">These overlap with a number of common practices in writing natural-language text in a file. </span><span class="kobospan" id="kobo.66.3">Showing indented text in a distinct font for example, and treating a paragraph starting with a punctuation mark and a space as a bulleted list item.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.67.1">Using RST provides</span><span id="dx1-916003"/><span class="kobospan" id="kobo.68.1"> a comprehensive set of elements that covers a wide variety of typographic details. </span><span class="kobospan" id="kobo.68.2">This is the preferred markup language for Python’s internal documentation projects. </span><span class="kobospan" id="kobo.68.3">In some cases, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.69.1">docs</span></span></span></span><span class="kobospan" id="kobo.70.1"> folder may be built with RST, but the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.71.1">README</span></span></span></span><span class="kobospan" id="kobo.72.1"> file may be in plain text.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.73.1">The choice is free of long-term consequences, since this file</span><span id="dx1-916004"/><span class="kobospan" id="kobo.74.1"> is essentially isolated from the rest of the project’s documentation. </span><span class="kobospan" id="kobo.74.2">When in doubt, it can help to toss a three-sided coin to make the choice. </span><span class="kobospan" id="kobo.74.3">The file is not large, and making changes is relatively easy. </span><span id="x1-916005r1894"/></p>
</section>
<section data-number="0.20.1.2" id="how-to-do-it...-128">
<h2 class="likechapterhead" data-number="0.20.1.2"><span><span class="kobospan" id="kobo.75.1">17.1.2 </span></span> <span id="x1-9170002"/><span class="kobospan" id="kobo.76.1">How to do it...</span></h2>
<ol class="calibre2">
<li class="calibre7"><div id="x1-917002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.77.1">Write an </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.78.1">introduction</span></span><span class="kobospan" id="kobo.79.1">, or lede, with information about who would use this package, why they would use it, and what it does. </span><span class="kobospan" id="kobo.79.2">In some cases, it may be helpful to state when and where an application is used; this may be needed to clarify client-vs.-server hosting or admin-vs.-user roles. </span><span class="kobospan" id="kobo.79.3">Keep this short; details will follow. </span><span class="kobospan" id="kobo.79.4">This is sometimes called the ”elevator pitch” because you can state it during</span><span id="dx1-917003"/><span class="kobospan" id="kobo.80.1"> an elevator ride in an office building.</span></p>
</div></li>
<li class="calibre7"><div id="x1-917005x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.81.1">Summarize the important </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.82.1">features </span></span><span class="kobospan" id="kobo.83.1">of the software. </span><span class="kobospan" id="kobo.83.2">This is often a bulleted list. </span><span class="kobospan" id="kobo.83.3">It may include screen grabs to show a user interface, if that’s an important feature. </span><span class="kobospan" id="kobo.83.4">It’s important to summarize and not overwrite all the details here. </span><span class="kobospan" id="kobo.83.5">The details should be in the separate </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.84.1">docs</span></span></span></span><span class="kobospan" id="kobo.85.1"> folder.</span></p>
</div></li>
<li class="calibre7"><div id="x1-917007x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.86.1">Detail any </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.87.1">requirements </span></span><span class="kobospan" id="kobo.88.1">or dependencies. </span><span class="kobospan" id="kobo.88.2">This may include hardware and operating system if that’s important. </span><span class="kobospan" id="kobo.88.3">It must include any Python version constraints. </span><span class="kobospan" id="kobo.88.4">This may repeat the dependencies in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.89.1">pyproject.toml</span></span></span></span><span class="kobospan" id="kobo.90.1"> in the case where a library or package is a plug-in or extension to another package or module.</span></p>
</div></li>
<li class="calibre7"><div id="x1-917009x4" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.91.1">Provide </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.92.1">installation </span></span><span class="kobospan" id="kobo.93.1">instructions. </span><span class="kobospan" id="kobo.93.2">Often this is the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.94.1">python</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.95.1"> -m</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.96.1"> pip</span></span></span></span><span class="kobospan" id="kobo.97.1"> command required to download and install the package. </span><span class="kobospan" id="kobo.97.2">If there are optional features, these will be summarized here, also.</span></p>
</div></li>
<li class="calibre7"><div id="x1-917011x5" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.98.1">Provide an introduction to </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.99.1">usage </span></span><span class="kobospan" id="kobo.100.1">or </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.101.1">operation</span></span><span class="kobospan" id="kobo.102.1">. </span><span class="kobospan" id="kobo.102.2">This is not the user guide, but it is what most people will see first, and the usage section should provide a tidy, clear, working example.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.103.1">There are two distinct approaches to writing this, depending on what the software is:</span></p>
<ul class="calibre17">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.104.1">For modules and packages that will be imported, a doctest example is ideal. </span><span class="kobospan" id="kobo.104.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.105.1">README</span></span></span></span><span class="kobospan" id="kobo.106.1"> can then be tested to confirm the example really is correct and works as expected.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.107.1">For applications, the usage may include step-by-step instructions for a common use case, possibly with screen-grab images.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.108.1">For some simple applications, this may be the entire user guide. </span><span class="kobospan" id="kobo.108.2">Generally, it’s only going to show a single, simple use case.</span></p>
</div></li>
<li class="calibre7"><div id="x1-917013x6" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.109.1">Provide the type of </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.110.1">license </span></span><span class="kobospan" id="kobo.111.1">and a link.</span></p>
</div></li>
<li class="calibre7"><div id="x1-917015x7" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.112.1">Provide a section on </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.113.1">contributing </span></span><span class="kobospan" id="kobo.114.1">to the project. </span><span class="kobospan" id="kobo.114.2">This may</span><span id="dx1-917016"/><span class="kobospan" id="kobo.115.1"> be a link to a separate contributor guide document, or it may be a short description of how to make changes and submit a pull request.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.116.1">In some cases, information about the integration, testing, and deployment may be helpful here. </span><span class="kobospan" id="kobo.116.2">For complicated applications, the build process may involve steps that aren’t obvious.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.117.1">This should also include information about documenting issues and making feature requests.</span></p>
</div></li>
<li class="calibre7"><div id="x1-917018x8" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.118.1">It’s also polite to include </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.119.1">credits </span></span><span class="kobospan" id="kobo.120.1">or </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.121.1">acknowledgments </span></span><span class="kobospan" id="kobo.122.1">for the work of other contributors. </span><span class="kobospan" id="kobo.122.2">This may include information about backers and sponsors.</span></p>
</div></li>
</ol>
<p class="normal1"><span id="x1-917019r1895"/></p>
</section>
<section data-number="0.20.1.3" id="how-it-works...-128">
<h2 class="likechapterhead" data-number="0.20.1.3"><span><span class="kobospan" id="kobo.123.1">17.1.3 </span></span> <span id="x1-9180003"/><span class="kobospan" id="kobo.124.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.125.1">The key ingredient of a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.126.1">README</span></span></span></span><span class="kobospan" id="kobo.127.1"> file is concrete examples of commands and features that actually work. </span><span class="kobospan" id="kobo.127.2">It shows what the software is, how to install it, how to use it, and how to maintain it.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.128.1">Examining </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.129.1">README</span></span></span></span><span class="kobospan" id="kobo.130.1">s from popular repositories reveals some common features. </span><span class="kobospan" id="kobo.130.2">There’s a </span><a href="https://www.makeareadme.com" class="url"><span class="kobospan" id="kobo.131.1">Make a README</span></a><span class="kobospan" id="kobo.132.1"> web site that can help create a file in case additional guidance is required.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.133.1">While there will be additional documentation elsewhere, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.134.1">README</span></span></span></span><span class="kobospan" id="kobo.135.1"> is the first thing most people read. </span><span class="kobospan" id="kobo.135.2">In some cases, it’s also the last thing they read. </span><span class="kobospan" id="kobo.135.3">Therefore, it must be clear what the software</span><span id="dx1-918001"/><span class="kobospan" id="kobo.136.1"> is and how it will be used. </span><span id="x1-918002r1896"/></p>
</section>
<section data-number="0.20.1.4" id="theres-more...-119">
<h2 class="likechapterhead" data-number="0.20.1.4"><span><span class="kobospan" id="kobo.137.1">17.1.4 </span></span> <span id="x1-9190004"/><span class="kobospan" id="kobo.138.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.139.1">A common feature of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.140.1">README</span></span></span></span><span class="kobospan" id="kobo.141.1"> files is badges showing the general health of the project. </span><span class="kobospan" id="kobo.141.2">There are several sources for these graphical summaries.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.142.1">The </span><a class="url" href="https://shields.io"><span class="url1"><span class="kobospan" id="kobo.143.1">https://shields.io</span></span></a><span class="kobospan" id="kobo.144.1"> site provides</span><span id="dx1-919001"/><span class="kobospan" id="kobo.145.1"> a number of static and dynamic badges. </span><span class="kobospan" id="kobo.145.2">A dynamic badge can interrogate services like PyPI or GitHub to post the current status.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.146.1">In Markdown, something like the following might be used to build a badge.</span></p>
<pre class="programlisting" id="listing-152"><code class="calibre13"><span class="kobospan" id="kobo.147.1">![release](https://img.shields.io/pypi/v/&lt;project&gt;.png)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.148.1">This would show a small graphic badge with </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.149.1">pypi</span></span></span></span><span class="kobospan" id="kobo.150.1"> on the left, and the current PyPI release number on the right side.</span></p>
<div class="center">
<p class="normal1"><span class="kobospan" id="kobo.151.1"><img alt="PIC" src="../media/file85.png" class="calibre9"/></span> <span id="x1-919003r1"/> <span id="x1-919004"/></p>
<span><span class="kobospan" id="kobo.152.1">Figure 17.1: </span></span><span><span class="kobospan" id="kobo.153.1">Badge Example </span></span>
</div>
<p class="normal1"><span class="kobospan" id="kobo.154.1">The badge can also be a link, and can provide more detailed information.</span></p>
<pre class="programlisting" id="listing-153"><code class="calibre13"><span class="kobospan" id="kobo.155.1">[![release](https://img.shields.io/pypi/v/&lt;name&gt;.png)]  (https://pypi.org/project/&lt;name&gt;)</span></code></pre>
<p class="normal1"><span id="x1-919006r1897"/></p>
</section>
<section data-number="0.20.1.5" id="see-also-126">
<h2 class="likechapterhead" data-number="0.20.1.5"><span><span class="kobospan" id="kobo.156.1">17.1.5 </span></span> <span id="x1-9200005"/><span class="kobospan" id="kobo.157.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.158.1">The C4 model offers additional help on how to describe software. </span><span class="kobospan" id="kobo.158.2">See </span><a class="url" href="https://c4model.com"><span class="url1"><span class="kobospan" id="kobo.159.1">https://c4model.com</span></span></a><span class="kobospan" id="kobo.160.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.161.1">See the </span><a class="url" href="https://github.com/matiassingers/awesome-readme"><span class="url1"><span class="kobospan" id="kobo.162.1">https://github.com/matiassingers/awesome-readme</span></span></a><span class="kobospan" id="kobo.163.1"> project on GitHub for good examples.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.164.1">Cookie-cutter templates are available with a search for ”cookiecutter” repositories: </span><a href="https://github.com/search?q=cookiecutter&amp;%3Btype=Repositories&amp;type=repositories" class="url"><span class="kobospan" id="kobo.165.1">GitHub search</span></a><span class="kobospan" id="kobo.166.1">. </span><span class="kobospan" id="kobo.166.2">This is quite a large list with 1000’s of cookie-cutter templates: </span><a class="url" href="https://github.com/search?q=cookiecutter&amp;%3Btype=Repositories&amp;type=repositories"><span class="url1"><span class="kobospan" id="kobo.167.1">https://github.com/search?q=cookiecutter&amp;amp%3Btype=Repositories&amp;type=repositories</span></span></a><span class="kobospan" id="kobo.168.1">.</span></p></li>
</ul>
<p class="normal1"><span id="x1-920001r1893"/></p>
</section>
</section>
<section data-number="0.20.2" id="installing-sphinx-and-creating-documentation">
<h1 class="unnumbered" data-number="0.20.2"><span><span class="kobospan" id="kobo.169.1">17.2 </span></span> <span id="x1-9210002"/><span class="kobospan" id="kobo.170.1">Installing Sphinx and creating documentation</span></h1>
<p class="normal"><span class="kobospan" id="kobo.171.1">A </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.172.1">README</span></span></span></span><span class="kobospan" id="kobo.173.1"> file is a summary</span><span id="dx1-921001"/><span class="kobospan" id="kobo.174.1"> of the software touching</span><span id="dx1-921002"/><span class="kobospan" id="kobo.175.1"> on a few key points. </span><span class="kobospan" id="kobo.175.2">Proper documentation often parallels the important topics of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.176.1">README</span></span></span></span><span class="kobospan" id="kobo.177.1">, but in more depth.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.178.1">Important adjuncts to the essential ”how-to” guides include two important topics:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.179.1">What the software does. </span><span class="kobospan" id="kobo.179.2">This is often a detailed description of the observable features.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.180.1">How the software works, showing the implementation concepts.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.181.1">The </span><a href="https://c4model.com" class="url"><span class="kobospan" id="kobo.182.1">C4 model</span></a><span class="kobospan" id="kobo.183.1"> suggests four tiers of abstraction in the description:</span></p>
<ol class="calibre4">
<li class="calibre7"><div id="x1-921004x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.184.1">The context in which an application is used.</span></p>
</div></li>
<li class="calibre7"><div id="x1-921006x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.185.1">The containers in which the software runs.</span></p>
</div></li>
<li class="calibre7"><div id="x1-921008x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.186.1">Component diagrams showing the architecture of the software.</span></p>
</div></li>
<li class="calibre7"><div id="x1-921010x4" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.187.1">Code diagrams showing the implementation details.</span></p>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.188.1">This organization offers the necessary focus for documentation.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.189.1">We’ll write in RST or Markdown format. </span><span class="kobospan" id="kobo.189.2">Tools like Sphinx then build output documents in a variety of target formats.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.190.1">We often want to provide an API document with the implementation details, extracted from the docstrings present in our modules, classes, methods, and functions. </span><span class="kobospan" id="kobo.190.2">In </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.191.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.192.1"> </span></span><a href="ch006_split_000.xhtml#x1-840002" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.193.1">2</span></span></a><span class="kobospan" id="kobo.194.1">, the </span><a href="ch006_split_000.xhtml#x1-1010003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.195.1">Including descriptions and documentation</span></span></a><span class="kobospan" id="kobo.196.1"> recipe described how to add docstrings to various Python structures. </span><span class="kobospan" id="kobo.196.2">The Sphinx tool </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.197.1">autodoc</span></span></span></span><span class="kobospan" id="kobo.198.1"> extension extracts the docstrings to produce detailed API documentation.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.199.1">Further, the Sphinx tool makes it easy to decompose the documentation source into smaller files that are easier to edit and manage. </span><span id="x1-921011r1899"/></p>
<section data-number="0.20.2.1" id="getting-ready-128">
<h2 class="likechapterhead" data-number="0.20.2.1"><span><span class="kobospan" id="kobo.200.1">17.2.1 </span></span> <span id="x1-9220001"/><span class="kobospan" id="kobo.201.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.202.1">We’ll need to download and install the Sphinx tool. </span><span class="kobospan" id="kobo.202.2">Generally, this is done with the following terminal command:</span></p>
<pre class="programlisting" id="listing-154"><code class="calibre13"><span class="kobospan" id="kobo.203.1">(cookbook3) % python -m pip install sphinx</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.204.1">Using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.205.1">python</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.206.1"> -m</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.207.1"> pip</span></span></span></span><span class="kobospan" id="kobo.208.1"> command</span><span id="dx1-922002"/><span class="kobospan" id="kobo.209.1"> ensures that we will use</span><span id="dx1-922003"/><span class="kobospan" id="kobo.210.1"> the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.211.1">pip</span></span></span></span><span class="kobospan" id="kobo.212.1"> command that goes with the currently active virtual environment.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.213.1">There are several</span><span id="dx1-922004"/><span class="kobospan" id="kobo.214.1"> built-in themes, plus numerous third-party themes. </span><span class="kobospan" id="kobo.214.2">See </span><a class="url" href="https://sphinx-themes.org"><span class="url1"><span class="kobospan" id="kobo.215.1">https://sphinx-themes.org</span></span></a><span class="kobospan" id="kobo.216.1"> for dozens of additional themes. </span><span id="x1-922005r1901"/></p>
</section>
<section data-number="0.20.2.2" id="how-to-do-it...-129">
<h2 class="likechapterhead" data-number="0.20.2.2"><span><span class="kobospan" id="kobo.217.1">17.2.2 </span></span> <span id="x1-9230002"/><span class="kobospan" id="kobo.218.1">How to do it...</span></h2>
<ol class="calibre2">
<li class="calibre7"><div id="x1-923002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.219.1">Make sure the project directory has at least the following sub-directories:</span></p>
<ul class="calibre17">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.220.1">The source. </span><span class="kobospan" id="kobo.220.2">This may use the package’s name or it may be called </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.221.1">src</span></span></span></span><span class="kobospan" id="kobo.222.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.223.1">The tests, often called </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.224.1">tests</span></span></span></span><span class="kobospan" id="kobo.225.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.226.1">The documentation, often called </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.227.1">docs</span></span></span></span><span class="kobospan" id="kobo.228.1">.</span></p></li>
</ul>
</div></li>
<li class="calibre7"><div id="x1-923004x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.229.1">Change the working directory to the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.230.1">docs</span></span></span></span><span class="kobospan" id="kobo.231.1"> directory with a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.232.1">cd</span></span></span></span><span class="kobospan" id="kobo.233.1"> or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.234.1">chdir</span></span></span></span><span class="kobospan" id="kobo.235.1"> command. </span><span class="kobospan" id="kobo.235.2">From there, run the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.236.1">sphinx-quickstart</span></span></span></span><span class="kobospan" id="kobo.237.1"> command.</span></p>
<pre class="programlisting" id="listing-155"><code class="calibre13"><span class="kobospan" id="kobo.238.1">(cookbook3) recipe_02 % cd docs 
 
(cookbook3) docs % sphinx-quickstart 
 
Welcome to the Sphinx 7.2.6 quickstart utility. 
 
 
 
Please enter values for the following settings (just press Enter to 
 
accept a default value, if one is given in brackets).</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.239.1">This will embark on an interactive conversation to gather details about your project and seed your </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.240.1">docs</span></span></span></span><span class="kobospan" id="kobo.241.1"> folder with the files required to run Sphinx.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.242.1">The result will be several directories and files for the documentation:</span></p>
<ul class="calibre17">
<li class="calibre12"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.243.1">conf.py</span></span></span></span><span class="kobospan" id="kobo.244.1"> has the project configuration.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.245.1">index.rst</span></span></span></span><span class="kobospan" id="kobo.246.1"> is the root document.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.247.1">Makefile</span></span></span></span><span class="kobospan" id="kobo.248.1"> can be used in all other environments to build the documentation.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.249.1">A </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.250.1">make.bat</span></span></span></span><span class="kobospan" id="kobo.251.1"> for use in a Windows environment may also be present.</span></p></li>
</ul>
</div></li>
<li class="calibre7"><div id="x1-923012x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.252.1">Edit the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.253.1">index.rst</span></span></span></span><span class="kobospan" id="kobo.254.1"> file to write an initial summary. </span><span class="kobospan" id="kobo.254.2">This might be copied from the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.255.1">README</span></span></span></span><span class="kobospan" id="kobo.256.1"> file.</span></p>
</div></li>
<li class="calibre7"><div id="x1-923014x4" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.257.1">Run the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.258.1">make</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.259.1"> html</span></span></span></span><span class="kobospan" id="kobo.260.1"> command to build the initial documentation. </span><span class="kobospan" id="kobo.260.2">This is a shell command, run in the terminal window. </span><span class="kobospan" id="kobo.260.3">Make sure the current working directory is the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.261.1">docs</span></span></span></span><span class="kobospan" id="kobo.262.1"> directory.</span></p>
</div></li>
</ol>
<p class="normal1"><span id="x1-923015r1902"/></p>
</section>
<section data-number="0.20.2.3" id="how-it-works...-129">
<h2 class="likechapterhead" data-number="0.20.2.3"><span><span class="kobospan" id="kobo.263.1">17.2.3 </span></span> <span id="x1-9240003"/><span class="kobospan" id="kobo.264.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.265.1">The Sphinx tool starts processing</span><span id="dx1-924001"/><span class="kobospan" id="kobo.266.1"> by reading the root</span><span id="dx1-924002"/><span class="kobospan" id="kobo.267.1"> document. </span><span class="kobospan" id="kobo.267.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.268.1">root_doc</span></span></span></span><span class="kobospan" id="kobo.269.1"> configuration parameter names </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.270.1">index</span></span></span></span><span class="kobospan" id="kobo.271.1">. </span><span class="kobospan" id="kobo.271.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.272.1">source_suffix</span></span></span></span><span class="kobospan" id="kobo.273.1"> configuration parameter sets the suffix for this file to </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.274.1">.rst</span></span></span></span><span class="kobospan" id="kobo.275.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.276.1">Generally, this file will name the other files in the documentation. </span><span class="kobospan" id="kobo.276.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.277.1">..</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.278.1"> </span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.279.1"> toctree::</span></span></span></span><span class="kobospan" id="kobo.280.1"> directive is used to specify the other files in the documentation.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.281.1">Let’s say we need to write several sections for installation, usage, maintenance, design, and API reference. </span><span class="kobospan" id="kobo.281.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.282.1">index.rst</span></span></span></span><span class="kobospan" id="kobo.283.1"> will have this as the primary content.</span></p>
<pre class="programlisting" id="listing-156"><code class="calibre13"><span class="kobospan" id="kobo.284.1">The recipe_02 project 
 
===================== 
 
 
 
The **recipe_02** project is an example of Sphinx documentation. 
 
 
 
.. </span><span class="kobospan" id="kobo.284.2"> toctree:: 
 
    :maxdepth: 2 
 
    :caption: Contents: 
 
 
 
    installation 
 
    usage 
 
    maintenance 
 
    design 
 
    api</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.285.1">The file created by the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.286.1">sphinx-quickstart</span></span></span></span><span class="kobospan" id="kobo.287.1"> tool will create a preamble in front of the above example. </span><span class="kobospan" id="kobo.287.2">We’ve omitted them from this example, since there’s no good reason to change them.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.288.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.289.1">toctree</span></span></span></span><span class="kobospan" id="kobo.290.1"> directive has two parameters, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.291.1">:maxdepth:</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.292.1"> 2</span></span></span></span><span class="kobospan" id="kobo.293.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.294.1">:caption:</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.295.1"> Contents:</span></span></span></span><span class="kobospan" id="kobo.296.1">. </span><span class="kobospan" id="kobo.296.2">These tailor the behavior of the directive’s output.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.297.1">Note that content inside a directive must be indented consistently. </span><span class="kobospan" id="kobo.297.2">Often the initial file will have an indent of three spaces. </span><span class="kobospan" id="kobo.297.3">Some editors work with a default indent of four spaces, so some changes to settings can be helpful.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.298.1">Each of the names</span><span id="dx1-924017"/><span class="kobospan" id="kobo.299.1"> in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.300.1">toctree</span></span></span></span><span class="kobospan" id="kobo.301.1"> body refers</span><span id="dx1-924018"/><span class="kobospan" id="kobo.302.1"> to a file with the configured suffix, in our case, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.303.1">.rst</span></span></span></span><span class="kobospan" id="kobo.304.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.305.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.306.1">installation.rst</span></span></span></span><span class="kobospan" id="kobo.307.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.308.1">usage.rst</span></span></span></span><span class="kobospan" id="kobo.309.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.310.1">maintenance.rst</span></span></span></span><span class="kobospan" id="kobo.311.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.312.1">design.rst</span></span></span></span><span class="kobospan" id="kobo.313.1">, and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.314.1">api.rst</span></span></span></span><span class="kobospan" id="kobo.315.1"> documents must start with a proper RST title line. </span><span class="kobospan" id="kobo.315.2">The initial content can come from notes or the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.316.1">README</span></span></span></span><span class="kobospan" id="kobo.317.1">. </span><span class="kobospan" id="kobo.317.2">For more help on RST, see </span><a href="ch006_split_000.xhtml#x1-1090004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.318.1">Writing better</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.319.1">docstrings with RST markup</span></span></a><span class="kobospan" id="kobo.320.1"> in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.321.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.322.1"> </span></span><a href="ch006_split_000.xhtml#x1-840002" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.323.1">2</span></span></a><span class="kobospan" id="kobo.324.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.325.1">The content of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.326.1">api.rst</span></span></span></span><span class="kobospan" id="kobo.327.1"> document will make use of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.328.1">autodoc</span></span></span></span><span class="kobospan" id="kobo.329.1"> extension. </span><span class="kobospan" id="kobo.329.2">We’ll look at this in </span><a href="ch021.xhtml#x1-9270003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.330.1">Using Sphinx autodoc to create the API</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.331.1">reference</span></span></a><span class="kobospan" id="kobo.332.1">. </span><span id="x1-924019r1903"/></p>
</section>
<section data-number="0.20.2.4" id="theres-more...-120">
<h2 class="likechapterhead" data-number="0.20.2.4"><span><span class="kobospan" id="kobo.333.1">17.2.4 </span></span> <span id="x1-9250004"/><span class="kobospan" id="kobo.334.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.335.1">There are many useful extensions</span><span id="dx1-925001"/><span class="kobospan" id="kobo.336.1"> for Sphinx. </span><span class="kobospan" id="kobo.336.2">We’ll look at including a to-do list.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.337.1">Enable an extension by adding </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.338.1">sphinx.ext.todo</span></span></span></span><span class="kobospan" id="kobo.339.1"> to the list of extensions in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.340.1">conf.py</span></span></span></span><span class="kobospan" id="kobo.341.1"> configuration file:</span></p>
<pre class="programlisting" id="listing-157"><code class="calibre13"><span class="kobospan" id="kobo.342.1">extensions = [ 
 
    ’sphinx.ext.autodoc’, 
 
    ’sphinx.ext.todo’, 
 
]</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.343.1">This will introduce two new directives to the available markup:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.344.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.345.1">..</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.346.1"> </span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.347.1"> todo::</span></span></span></span><span class="kobospan" id="kobo.348.1"> directive creates a to-do item.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.349.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.350.1">..</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.351.1"> </span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.352.1"> todolist::</span></span></span></span><span class="kobospan" id="kobo.353.1"> directive will be replaced by the content of all the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.354.1">todo</span></span></span></span><span class="kobospan" id="kobo.355.1"> items.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.356.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.357.1">todo</span></span></span></span><span class="kobospan" id="kobo.358.1"> items produce no other output. </span><span class="kobospan" id="kobo.358.2">It’s easy to find them; some IDEs will automatically scan the files for the letters </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.359.1">todo</span></span></span></span><span class="kobospan" id="kobo.360.1"> and keep this as a list of things for a developer to address.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.361.1">Editing the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.362.1">conf.py</span></span></span></span><span class="kobospan" id="kobo.363.1"> configuration file to add the following line will enable the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.364.1">..</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.365.1"> todolist::</span></span></span></span><span class="kobospan" id="kobo.366.1"> directive to include the items in the documentation:</span></p>
<pre class="programlisting" id="listing-158"><code class="calibre13"><span class="kobospan" id="kobo.367.1">todo_include_todos = True</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.368.1">With this, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.369.1">todo</span></span></span></span><span class="kobospan" id="kobo.370.1"> items are elevated from personal notes to public items in the documentation.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.371.1">Sphinx comes with a number of themes that define the styles to use. </span><span class="kobospan" id="kobo.371.2">The default theme</span><span id="dx1-925007"/><span class="kobospan" id="kobo.372.1"> is called </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.373.1">alabaster</span></span></span></span><span class="kobospan" id="kobo.374.1">. </span><span class="kobospan" id="kobo.374.2">Changing to one of the other built-in themes can be done with the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.375.1">html_theme</span></span></span></span><span class="kobospan" id="kobo.376.1"> setting in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.377.1">conf.py</span></span></span></span><span class="kobospan" id="kobo.378.1"> configuration file.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.379.1">Change to the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.380.1">sphinxdoc</span></span></span></span><span class="kobospan" id="kobo.381.1"> theme with a setting like the following:</span></p>
<pre class="programlisting" id="listing-159"><code class="calibre13"><span class="kobospan" id="kobo.382.1">html_theme = ’sphinxdoc’</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.383.1">Many themes have further customizations possible. </span><span class="kobospan" id="kobo.383.2">Providing an </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.384.1">html_theme_options</span></span></span></span><span class="kobospan" id="kobo.385.1"> dictionary tailors the theme. </span><span id="x1-925009r1904"/></p>
</section>
<section data-number="0.20.2.5" id="see-also-127">
<h2 class="likechapterhead" data-number="0.20.2.5"><span><span class="kobospan" id="kobo.386.1">17.2.5 </span></span> <span id="x1-9260005"/><span class="kobospan" id="kobo.387.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.388.1">See </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.389.1">Sphinx</span></span></span></span> <a class="url" href="https://www.sphinx-doc.org/en/master/"><span class="url1"><span class="kobospan" id="kobo.390.1">https://www.sphinx-doc.org/en/master/</span></span></a><span class="kobospan" id="kobo.391.1"> for details on the Sphinx project.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.392.1">See </span><a class="url" href="https://sphinx-themes.org"><span class="url1"><span class="kobospan" id="kobo.393.1">https://sphinx-themes.org</span></span></a><span class="kobospan" id="kobo.394.1"> for some additional Sphinx themes.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.395.1">See </span><a href="ch021.xhtml#x1-9270003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.396.1">Using Sphinx autodoc to create the API reference</span></span></a><span class="kobospan" id="kobo.397.1"> to see how to build API documentation from code.</span></p></li>
</ul>
<p class="normal1"><span id="x1-926001r1900"/></p>
</section>
</section>
<section data-number="0.20.3" id="using-sphinx-autodoc-to-create-the-api-reference">
<h1 class="unnumbered" data-number="0.20.3"><span><span class="kobospan" id="kobo.398.1">17.3 </span></span> <span id="x1-9270003"/><span class="kobospan" id="kobo.399.1">Using Sphinx autodoc to create the API reference</span></h1>
<p class="normal"><span class="kobospan" id="kobo.400.1">One of the huge strengths of Sphinx</span><span id="dx1-927001"/><span class="kobospan" id="kobo.401.1"> is being able to generate</span><span id="dx1-927002"/><span class="kobospan" id="kobo.402.1"> the API documentation using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.403.1">autodoc</span></span></span></span><span class="kobospan" id="kobo.404.1"> extension. </span><span class="kobospan" id="kobo.404.2">A series of commands can extract the docstrings from modules, classes, functions, and methods. </span><span class="kobospan" id="kobo.404.3">Options are available to fine-tune exactly what members are included or excluded.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.405.1">We’ll refer back to </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.406.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.407.1"> </span></span><a href="ch011_split_000.xhtml#x1-3760007" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.408.1">7</span></span></a><span class="kobospan" id="kobo.409.1">, the </span><a href="ch011_split_001.xhtml#x1-4250009" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.410.1">Extending a built-in collection – a list that does</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.411.1">statistics</span></span></a><span class="kobospan" id="kobo.412.1"> recipe. </span><span class="kobospan" id="kobo.412.2">In there is this </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.413.1">Statslist</span></span></span></span><span class="kobospan" id="kobo.414.1"> class:</span></p>
<pre class="programlisting" id="listing-160"><code class="calibre13"><span class="kobospan" id="kobo.415.1">class StatsList(list[float]): 
 
    def sum(self) -&gt; float: 
 
        return sum(v for v in self) 
 
    def size(self) -&gt; float: 
 
        return sum(1 for v in self) 
 
    def mean(self) -&gt; float: 
 
        return self.sum() / self.size() 
 
    # etc...</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.416.1">Because this inherits methods</span><span id="dx1-927011"/><span class="kobospan" id="kobo.417.1"> from the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.418.1">list</span></span></span></span><span class="kobospan" id="kobo.419.1"> class, there</span><span id="dx1-927012"/><span class="kobospan" id="kobo.420.1"> are a large number of available methods. </span><span class="kobospan" id="kobo.420.2">By default, only those methods with docstrings, excluding private methods (those with a leading </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.421.1">_</span></span></span></span><span class="kobospan" id="kobo.422.1">), will be examined and included in the documentation. </span><span class="kobospan" id="kobo.422.2">We have a number of other choices of which methods to include in the documentation:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.423.1">We can name specific methods, and only those will be documented.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.424.1">We can ask to include methods without docstrings; the signature will be shown.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.425.1">We can ask for private members (those with a leading </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.426.1">_</span></span></span></span><span class="kobospan" id="kobo.427.1">).</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.428.1">We can ask for special members (those with double leading </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.429.1">__</span></span></span></span><span class="kobospan" id="kobo.430.1">).</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.431.1">We can ask for inherited members to see members from the superclasses.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.432.1">We’ll start by putting docstrings into this class definition. </span><span class="kobospan" id="kobo.432.2">Once that task is finished, we can include the necessary configuration and directives in the documentation directory. </span><span id="x1-927013r1905"/></p>
<section data-number="0.20.3.1" id="getting-ready-129">
<h2 class="likechapterhead" data-number="0.20.3.1"><span><span class="kobospan" id="kobo.433.1">17.3.1 </span></span> <span id="x1-9280001"/><span class="kobospan" id="kobo.434.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.435.1">The first step is to add docstrings to the module, the class, and the methods. </span><span class="kobospan" id="kobo.435.2">In some cases, partial docstrings are in place and the task is to expand them to be more complete.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.436.1">We might, for example, have already added the following kinds of comments:</span></p>
<pre class="programlisting" id="listing-161"><code class="calibre13"><span class="kobospan" id="kobo.437.1">class StatsList(list[float]): 
 
    """ 
 
    A list of float (or int) values that computes some essential statistics. 
 
 
 
    &gt;&gt;&gt; x = StatsList([1, 2, 3, 4]) 
 
    &gt;&gt;&gt; x.mean() 
 
    2.5 
 
    """ 
 
 
 
    def sum(self) -&gt; float: 
 
        """ 
 
        Sum of items in the list. 
 
        """ 
 
        return sum(v for v in self)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.438.1">This started to provide some useful</span><span id="dx1-928015"/><span class="kobospan" id="kobo.439.1"> documentation in an API reference. </span><span class="kobospan" id="kobo.439.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.440.1">class</span></span></span></span><span class="kobospan" id="kobo.441.1"> docstring has a doctest example to show how it works. </span><span class="kobospan" id="kobo.441.2">The method has a docstring with a summary of what it does.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.442.1">We need to extend this to add details on parameters</span><span id="dx1-928016"/><span class="kobospan" id="kobo.443.1">, return values, and exceptions raised. </span><span class="kobospan" id="kobo.443.2">This is done with additional</span><span id="dx1-928017"/><span class="kobospan" id="kobo.444.1"> syntax called a ”field list”.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.445.1">Each item in a field list has a name and a body. </span><span class="kobospan" id="kobo.445.2">The general syntax is this:</span></p>
<pre class="programlisting" id="listing-162"><code class="calibre13"><span class="kobospan" id="kobo.446.1">:name: body</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.447.1">The Sphinx tool defines a large number of field list names that are used to format documentation for a function or method. </span><span class="kobospan" id="kobo.447.2">Here are a few of the most useful ones:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.448.1">:param</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.449.1"> name:</span></span></span></span><span class="kobospan" id="kobo.450.1"> Description of a parameter</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.451.1">:key</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.452.1"> name:</span></span></span></span><span class="kobospan" id="kobo.453.1"> Description of a keyword parameter</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.454.1">:raises</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.455.1"> exception:</span></span></span></span><span class="kobospan" id="kobo.456.1"> Description of the reason for the exception</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.457.1">:var</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.458.1"> name:</span></span></span></span><span class="kobospan" id="kobo.459.1"> Details for internal variables of a class that are exposed</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.460.1">:returns:</span></span></span></span><span class="kobospan" id="kobo.461.1"> The return value from a method or function</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.462.1">These permit the writing of detailed descriptions of methods. </span><span id="x1-928019r1907"/></p>
</section>
<section data-number="0.20.3.2" id="how-to-do-it...-130">
<h2 class="likechapterhead" data-number="0.20.3.2"><span><span class="kobospan" id="kobo.463.1">17.3.2 </span></span> <span id="x1-9290002"/><span class="kobospan" id="kobo.464.1">How to do it...</span></h2>
<ol class="calibre2">
<li class="calibre7"><div id="x1-929002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.465.1">Edit the docstrings</span><span id="dx1-929003"/><span class="kobospan" id="kobo.466.1"> to include</span><span id="dx1-929004"/><span class="kobospan" id="kobo.467.1"> details.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.468.1">We might, for example, want to expand on the method definition as follows:</span></p>
<pre class="programlisting" id="listing-163"><code class="calibre13"><span class="kobospan" id="kobo.469.1">        def sum(self) -&gt; float: 
 
            """ 
 
            Computes the sum of items in the list. 
 
 
 
            :returns: sum of the items. 
 
            """ 
 
            return sum(v for v in self)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.470.1">For a function as simple as this, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.471.1">:returns:</span></span></span></span><span class="kobospan" id="kobo.472.1"> part of the field list seems redundant.</span></p>
</div></li>
<li class="calibre7"><div id="x1-929013x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.473.1">Edit the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.474.1">conf.py</span></span></span></span><span class="kobospan" id="kobo.475.1"> file to add the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.476.1">’sphinx.ext.autodoc’</span></span></span></span><span class="kobospan" id="kobo.477.1"> string to the list extensions:</span></p>
<pre class="programlisting" id="listing-164"><code class="calibre13"><span class="kobospan" id="kobo.478.1">extensions = [ 
 
    ’sphinx.ext.autodoc’ 
 
]</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-929018x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.479.1">Add the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.480.1">src</span></span></span></span><span class="kobospan" id="kobo.481.1"> directory to </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.482.1">sys.path</span></span></span></span><span class="kobospan" id="kobo.483.1"> in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.484.1">conf.py</span></span></span></span><span class="kobospan" id="kobo.485.1"> configuration file:</span></p>
<pre class="programlisting" id="listing-165"><code class="calibre13"><span class="kobospan" id="kobo.486.1">import sys 
 
sys.path.append(’../src’)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.487.1">This works because the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.488.1">conf.py</span></span></span></span><span class="kobospan" id="kobo.489.1"> file is a Python module, and can execute </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.490.1">any </span></span><span class="kobospan" id="kobo.491.1">Python statements. </span><span class="kobospan" id="kobo.491.2">Adding the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.492.1">src</span></span></span></span><span class="kobospan" id="kobo.493.1"> directory to the path means Sphinx can import the module.</span></p>
</div></li>
<li class="calibre7"><div id="x1-929022x4" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.494.1">Put the following directive in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.495.1">api.rst</span></span></span></span><span class="kobospan" id="kobo.496.1"> document.</span></p>
<pre class="programlisting" id="listing-166"><code class="calibre13"><span class="kobospan" id="kobo.497.1">.. </span><span class="kobospan" id="kobo.497.2"> automodule:: stats 
 
    :undoc-members:</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.498.1">This will import the module, extract the docstring, and then attempt to create documentation for all of the members, including those that do not – as yet – have docstrings.</span></p>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.499.1">The Sphinx quickstart created a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.500.1">Makefile</span></span></span></span><span class="kobospan" id="kobo.501.1"> to help build the final PDF or HTML file from the source material; see the </span><a href="ch021.xhtml#x1-9210002" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.502.1">Installing Sphinx and creating</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.503.1">documentation</span></span></a><span class="kobospan" id="kobo.504.1"> recipe for more information. </span><span class="kobospan" id="kobo.504.2">Run the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.505.1">make</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.506.1"> html</span></span></span></span><span class="kobospan" id="kobo.507.1"> shell command in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.508.1">docs</span></span></span></span><span class="kobospan" id="kobo.509.1"> directory, The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.510.1">build</span></span></span></span><span class="kobospan" id="kobo.511.1"> directory</span><span id="dx1-929025"/><span class="kobospan" id="kobo.512.1"> will have a static</span><span id="dx1-929026"/><span class="kobospan" id="kobo.513.1"> website with the project’s documentation. </span><span id="x1-929027r1908"/></p>
</section>
<section data-number="0.20.3.3" id="how-it-works...-130">
<h2 class="likechapterhead" data-number="0.20.3.3"><span><span class="kobospan" id="kobo.514.1">17.3.3 </span></span> <span id="x1-9300003"/><span class="kobospan" id="kobo.515.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.516.1">The examination of docstrings to extract the detailed documentation starts with an elegantly clever feature of the Python language: the documentation string. </span><span class="kobospan" id="kobo.516.2">The rules of RST markup continue a path toward elegant-looking documentation. </span><span class="kobospan" id="kobo.516.3">The resulting Sphinx page looks like this:</span></p>
<div class="center">
<p class="normal1"><span class="kobospan" id="kobo.517.1"><img alt="PIC" src="../media/file86.png" class="calibre28"/></span> <span id="x1-930001r2"/> <span id="x1-930002"/></p>
<span><span class="kobospan" id="kobo.518.1">Figure 17.2: </span></span><span><span class="kobospan" id="kobo.519.1">Sphinx Output Example </span></span>
</div>
<p class="normal1"><span class="kobospan" id="kobo.520.1">Note the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.521.1">variance()</span></span></span></span><span class="kobospan" id="kobo.522.1"> method includes a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.523.1">..</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.524.1"> </span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.525.1"> math::</span></span></span></span><span class="kobospan" id="kobo.526.1"> directive with details</span><span id="dx1-930003"/><span class="kobospan" id="kobo.527.1"> on how the computation is performed. </span><span class="kobospan" id="kobo.527.2">This requires some care</span><span id="dx1-930004"/><span class="kobospan" id="kobo.528.1"> because the LaTeXmath syntax involves a fair number of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.529.1">\</span></span></span></span><span class="kobospan" id="kobo.530.1"> characters.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.531.1">There are two ways to deal with LaTeXmath in docstrings:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.532.1">Use a ”raw” string literal and single </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.533.1">\</span></span></span></span><span class="kobospan" id="kobo.534.1">:</span></p>
<pre class="programlisting" id="listing-167"><code class="calibre13"><span class="kobospan" id="kobo.535.1">r""" 
 
A docstring with :math:‘\alpha \times \beta‘ 
 
"""</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.536.1">This means that no other escaped characters can be used. </span><span class="kobospan" id="kobo.536.2">This may prevent using Unicode characters, for example.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.537.1">Use a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.538.1">\</span></span></span></span><span class="kobospan" id="kobo.539.1"> to escape the special meaning of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.540.1">\</span></span></span></span><span class="kobospan" id="kobo.541.1">:</span></p>
<pre class="programlisting" id="listing-168"><code class="calibre13"><span class="kobospan" id="kobo.542.1">""" 
 
A docstring with :math:‘\\alpha \\times \\beta‘ 
 
"""</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.543.1">This permits including Unicode escape sequences like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.544.1">\N{Black</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.545.1"> Spade</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.546.1"> Suit}</span></span></span></span><span class="kobospan" id="kobo.547.1"> in the docstring.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.548.1">In both cases, note that RST</span><span id="dx1-930011"/><span class="kobospan" id="kobo.549.1"> uses back-ticks </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.550.1">‘</span></span></span></span><span class="kobospan" id="kobo.551.1"> around</span><span id="dx1-930012"/><span class="kobospan" id="kobo.552.1"> the content that has a role, like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.553.1">:math:</span></span></span></span><span class="kobospan" id="kobo.554.1">. </span><span id="x1-930013r1909"/></p>
</section>
<section data-number="0.20.3.4" id="theres-more...-121">
<h2 class="likechapterhead" data-number="0.20.3.4"><span><span class="kobospan" id="kobo.555.1">17.3.4 </span></span> <span id="x1-9310004"/><span class="kobospan" id="kobo.556.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.557.1">A cross-reference to another class, module, or method uses </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.558.1">:role:‘value‘</span></span></span></span><span class="kobospan" id="kobo.559.1"> syntax. </span><span class="kobospan" id="kobo.559.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.560.1">:role:</span></span></span></span><span class="kobospan" id="kobo.561.1"> portion is the specific kind of reference to help distinguish modules, classes, and functions. </span><span class="kobospan" id="kobo.561.2">The value is a name that has a definition directive somewhere in the documentation.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.562.1">A cross-reference will generate appropriately formatted text with a hypertext link to the the definition for the name.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.563.1">Here’s an example:</span></p>
<pre class="programlisting" id="listing-169"><code class="calibre13"><span class="kobospan" id="kobo.564.1">Uses the :py:class:‘~stats.StatsList‘ class in the :py:mod:‘stats‘ module.</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.565.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.566.1">:py:class:‘~stats.StatsList‘</span></span></span></span><span class="kobospan" id="kobo.567.1"> has the role of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.568.1">:py:class:</span></span></span></span><span class="kobospan" id="kobo.569.1"> to create a class reference to the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.570.1">StatsList</span></span></span></span><span class="kobospan" id="kobo.571.1"> class definition. </span><span class="kobospan" id="kobo.571.2">The use of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.572.1">~</span></span></span></span><span class="kobospan" id="kobo.573.1"> in the name means that only the last level of the name will be shown. </span><span class="kobospan" id="kobo.573.2">The full path is required to generate a correct reference to the class. </span><span class="kobospan" id="kobo.573.3">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.574.1">:py:mod:‘stats‘</span></span></span></span><span class="kobospan" id="kobo.575.1"> reference is a role of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.576.1">:py:mod:</span></span></span></span><span class="kobospan" id="kobo.577.1"> and names the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.578.1">stats</span></span></span></span><span class="kobospan" id="kobo.579.1"> module. </span><span id="x1-931002r1911"/></p>
</section>
<section data-number="0.20.3.5" id="see-also-128">
<h2 class="likechapterhead" data-number="0.20.3.5"><span><span class="kobospan" id="kobo.580.1">17.3.5 </span></span> <span id="x1-9320005"/><span class="kobospan" id="kobo.581.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.582.1">See </span><a href="ch021.xhtml#x1-9210002" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.583.1">Installing Sphinx and creating documentation</span></span></a><span class="kobospan" id="kobo.584.1"> for more information on Sphinx.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.585.1">See </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.586.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.587.1"> </span></span><a href="ch011_split_000.xhtml#x1-3760007" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.588.1">7</span></span></a><span class="kobospan" id="kobo.589.1">, the </span><a href="ch011_split_001.xhtml#x1-4250009" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.590.1">Extending a built-in collection – a list that does</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.591.1">statistics</span></span></a><span class="kobospan" id="kobo.592.1"> recipe for the example this is built around.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.593.1">See </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.594.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.595.1"> </span></span><a href="ch006_split_000.xhtml#x1-840002" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.596.1">2</span></span></a><span class="kobospan" id="kobo.597.1">, the </span><a href="ch006_split_000.xhtml#x1-1010003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.598.1">Including descriptions and documentation</span></span></a><span class="kobospan" id="kobo.599.1"> recipe for more information on docstrings.</span></p></li>
</ul>
<p class="normal1"><span id="x1-932001r1906"/></p>
</section>
</section>
<section data-number="0.20.4" id="identifying-other-cicd-tools-in-pyproject.toml">
<h1 class="unnumbered" data-number="0.20.4"><span><span class="kobospan" id="kobo.600.1">17.4 </span></span> <span id="x1-9330004"/><span class="kobospan" id="kobo.601.1">Identifying other CI/CD tools in pyproject.toml</span></h1>
<p class="normal"><span class="kobospan" id="kobo.602.1">The terms </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.603.1">Continuous Integration </span></span><span class="kobospan" id="kobo.604.1">(</span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.605.1">CI</span></span><span class="kobospan" id="kobo.606.1">) and </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.607.1">Continuous Deployment</span></span><span class="kobospan" id="kobo.608.1"> (</span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.609.1">CD</span></span><span class="kobospan" id="kobo.610.1">) are often used to describe the process</span><span id="dx1-933001"/><span class="kobospan" id="kobo.611.1"> of publishing a Python</span><span id="dx1-933002"/><span class="kobospan" id="kobo.612.1"> package for use by others. </span><span class="kobospan" id="kobo.612.2">The idea of doing a number of quality checks for integration and deployment is central to good software engineering. </span><span class="kobospan" id="kobo.612.3">Running a test suite is one of many ways to affirm that software is fit for the intended purpose.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.613.1">Additional tools might</span><span id="dx1-933003"/><span class="kobospan" id="kobo.614.1"> include </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.615.1">memray</span></span></span></span><span class="kobospan" id="kobo.616.1">, which is used to check the use of memory resources. </span><span class="kobospan" id="kobo.616.2">A tool like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.617.1">ruff</span></span></span></span><span class="kobospan" id="kobo.618.1"> is also an effective</span><span id="dx1-933004"/><span class="kobospan" id="kobo.619.1"> linter.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.620.1">In </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.621.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.622.1"> </span></span><a href="ch020_split_000.xhtml#x1-86400016" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.623.1">16</span></span></a><span class="kobospan" id="kobo.624.1">, the </span><a href="ch020_split_000.xhtml#x1-8790003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.625.1">Creating a pyproject.toml file</span></span></a><span class="kobospan" id="kobo.626.1"> recipe, and also In </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.627.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.628.1"> </span></span><a href="ch019_split_000.xhtml#x1-79400015" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.629.1">15</span></span></a><span class="kobospan" id="kobo.630.1">, the </span><a href="ch019_split_000.xhtml#x1-8250005" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.631.1">Combining unittest and doctest tests</span></span></a><span class="kobospan" id="kobo.632.1"> recipe, both talk about defining test tools in addition to the dependencies required to install the project.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.633.1">This suggests there are several layers</span><span id="dx1-933005"/><span class="kobospan" id="kobo.634.1"> of requirements (also called dependencies):</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.635.1">Requirements needed to install the application in the first place. </span><span class="kobospan" id="kobo.635.2">Within this book, this includes projects like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.636.1">pydantic</span></span></span></span><span class="kobospan" id="kobo.637.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.638.1">beautifulsoup4</span></span></span></span><span class="kobospan" id="kobo.639.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.640.1">jupyterlab</span></span></span></span><span class="kobospan" id="kobo.641.1">, and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.642.1">matplotlib</span></span></span></span><span class="kobospan" id="kobo.643.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.644.1">Optional requirements for special features, plug-ins, or extensions. </span><span class="kobospan" id="kobo.644.2">These aren’t required to install the project. </span><span class="kobospan" id="kobo.644.3">They are named in configuration files and applied when the software is used. </span><span class="kobospan" id="kobo.644.4">As an example, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.645.1">pydantic</span></span></span></span><span class="kobospan" id="kobo.646.1"> package has an optional validator for email addresses. </span><span class="kobospan" id="kobo.646.2">If your application requires this, it needs to be named as part of the dependency.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.647.1">Requirements to run the test suite. </span><span class="kobospan" id="kobo.647.2">For the most part, this has been </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.648.1">pytest</span></span></span></span><span class="kobospan" id="kobo.649.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.650.1">mypy</span></span></span></span><span class="kobospan" id="kobo.651.1">. </span><span class="kobospan" id="kobo.651.2">It hasn’t been emphasized, but the unit test cases for the examples in this book all use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.652.1">tox</span></span></span></span><span class="kobospan" id="kobo.653.1"> for test automation.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.654.1">Packages and tools needed for development. </span><span class="kobospan" id="kobo.654.2">This includes tools like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.655.1">memray</span></span></span></span><span class="kobospan" id="kobo.656.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.657.1">sphinx</span></span></span></span><span class="kobospan" id="kobo.658.1">. </span><span class="kobospan" id="kobo.658.2">A tool like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.659.1">ruff</span></span></span></span><span class="kobospan" id="kobo.660.1"> or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.661.1">black</span></span></span></span><span class="kobospan" id="kobo.662.1"> might be part of this set of requirements.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.663.1">The dependency information is used to install the software properly. </span><span class="kobospan" id="kobo.663.2">It’s also used to create development environments for collaboration. </span><span class="kobospan" id="kobo.663.3">The Python ecosystem of packages is in a constant state of flux.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.664.1">It’s imperative to record which versions</span><span id="dx1-933006"/><span class="kobospan" id="kobo.665.1"> a package was tested</span><span id="dx1-933007"/><span class="kobospan" id="kobo.666.1"> with. </span><span class="kobospan" id="kobo.666.2">This detail makes it possible for tools like </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.667.1">PIP </span></span><span class="kobospan" id="kobo.668.1">to download and install the required</span><span id="dx1-933008"/><span class="kobospan" id="kobo.669.1"> components in the virtual environment. </span><span id="x1-933009r1912"/></p>
<section data-number="0.20.4.1" id="getting-ready-130">
<h2 class="likechapterhead" data-number="0.20.4.1"><span><span class="kobospan" id="kobo.670.1">17.4.1 </span></span> <span id="x1-9340001"/><span class="kobospan" id="kobo.671.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.672.1">The first step is to create the base </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.673.1">pyproject.toml</span></span></span></span><span class="kobospan" id="kobo.674.1"> file. </span><span class="kobospan" id="kobo.674.2">See the </span><a href="ch020_split_000.xhtml#x1-8790003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.675.1">Creating a</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.676.1">pyproject.toml file</span></span></a><span class="kobospan" id="kobo.677.1"> recipe in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.678.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.679.1"> </span></span><a href="ch020_split_000.xhtml#x1-86400016" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.680.1">16</span></span></a><span class="kobospan" id="kobo.681.1"> for another recipe closely related to this. </span><span class="kobospan" id="kobo.681.2">This should have a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.682.1">dependencies</span></span></span></span><span class="kobospan" id="kobo.683.1"> item in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.684.1">[project]</span></span></span></span><span class="kobospan" id="kobo.685.1"> table. </span><span class="kobospan" id="kobo.685.2">It might look like this:</span></p>
<pre class="programlisting" id="listing-170"><code class="calibre13"><span class="kobospan" id="kobo.686.1">[project] 
 
    # details omitted 
 
dependencies = [ 
 
    "pydantic", 
 
    "beautifulsoup4", 
 
    "types-beautifulsoup4", 
 
    "jupyterlab", 
 
    "matplotlib" 
 
]</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.687.1">When using </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.688.1">Poetry</span></span><span class="kobospan" id="kobo.689.1">, this information is in a slightly</span><span id="dx1-934010"/><span class="kobospan" id="kobo.690.1"> different format. </span><span class="kobospan" id="kobo.690.2">The information goes in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.691.1">[tool.poetry.dependencies]</span></span></span></span><span class="kobospan" id="kobo.692.1"> table. </span><span class="kobospan" id="kobo.692.2">Often, we’ll build this by using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.693.1">poetry</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.694.1"> add</span></span></span></span><span class="kobospan" id="kobo.695.1"> command-line tool.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.696.1">Note that </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.697.1">Poetry </span></span><span class="kobospan" id="kobo.698.1">commands offer some additional syntax:</span></p>
<pre class="programlisting" id="listing-171"><code class="calibre13"><span class="kobospan" id="kobo.699.1">% poetry add pydantic@^2.6.0</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.700.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.701.1">^</span></span></span></span><span class="kobospan" id="kobo.702.1"> prefix is a sophisticated</span><span id="dx1-934012"/><span class="kobospan" id="kobo.703.1"> rule that permits</span><span id="dx1-934013"/><span class="kobospan" id="kobo.704.1"> a larger version number for the minor or patch level. </span><span class="kobospan" id="kobo.704.2">It does not permit any changes to the left-most, major version number, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.705.1">2</span></span></span></span><span class="kobospan" id="kobo.706.1">, in this case. </span><span class="kobospan" id="kobo.706.2">This means that any version of Pydantic at or after 2.6.0 will be considered. </span><span class="kobospan" id="kobo.706.3">Versions above 3.x will not be considered. </span><span id="x1-934014r1914"/></p>
</section>
<section data-number="0.20.4.2" id="how-to-do-it...-131">
<h2 class="likechapterhead" data-number="0.20.4.2"><span><span class="kobospan" id="kobo.707.1">17.4.2 </span></span> <span id="x1-9350002"/><span class="kobospan" id="kobo.708.1">How to do it...</span></h2>
<ol class="calibre2">
<li class="calibre7"><div id="x1-935002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.709.1">Add the test dependencies in a table named </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.710.1">[project.optional-dependencies]</span></span></span></span><span class="kobospan" id="kobo.711.1">. </span><span class="kobospan" id="kobo.711.2">This will be a list named </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.712.1">test</span></span></span></span><span class="kobospan" id="kobo.713.1">. </span><span class="kobospan" id="kobo.713.2">It looks like this:</span></p>
<pre class="programlisting" id="listing-172"><code class="calibre13"><span class="kobospan" id="kobo.714.1">[project.optional-dependencies] 
 
test = [ 
 
    "tox", 
 
    "pytest", 
 
    "mypy" 
 
]</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.715.1">This name of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.716.1">test</span></span></span></span><span class="kobospan" id="kobo.717.1"> can be used by </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.718.1">pip-compile</span></span></span></span><span class="kobospan" id="kobo.719.1"> to build a detailed </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.720.1">requirements-test.txt</span></span></span></span><span class="kobospan" id="kobo.721.1"> for the test tools.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.722.1">When using </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.723.1">Poetry</span></span><span class="kobospan" id="kobo.724.1">, this optional dependency group</span><span id="dx1-935009"/><span class="kobospan" id="kobo.725.1"> is in a different table. </span><span class="kobospan" id="kobo.725.2">We use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.726.1">--group</span></span></span></span><span class="kobospan" id="kobo.727.1"> option</span><span id="dx1-935010"/><span class="kobospan" id="kobo.728.1"> to specify the group.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.729.1">The command line would look like this:</span></p>
<pre class="programlisting" id="listing-173"><code class="calibre13"><span class="kobospan" id="kobo.730.1">% poetry add tox@^4.0 --group test</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-935013x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.731.1">Add the development dependencies</span><span id="dx1-935014"/><span class="kobospan" id="kobo.732.1"> in a table named </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.733.1">[project.optional-dependencies]</span></span></span></span><span class="kobospan" id="kobo.734.1"> Generally, the name </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.735.1">dev</span></span></span></span><span class="kobospan" id="kobo.736.1"> is used. </span><span class="kobospan" id="kobo.736.2">It looks like this:</span></p>
<pre class="programlisting" id="listing-174"><code class="calibre13"><span class="kobospan" id="kobo.737.1">[project.optional-dependencies] 
 
dev = [ 
 
    "ruff", 
 
    "pip-tools", 
 
    "memray" 
 
]</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.738.1">This name of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.739.1">dev</span></span></span></span><span class="kobospan" id="kobo.740.1"> can be used by </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.741.1">pip-compile</span></span></span></span><span class="kobospan" id="kobo.742.1"> to build a detailed </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.743.1">requirements-dev.txt</span></span></span></span><span class="kobospan" id="kobo.744.1"> for the entire suite of tools, plus the base dependencies.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.745.1">When using </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.746.1">Poetry</span></span><span class="kobospan" id="kobo.747.1">, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.748.1">--group</span></span></span></span><span class="kobospan" id="kobo.749.1"> option specifies the group. </span><span class="kobospan" id="kobo.749.2">An </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.750.1">add</span></span></span></span><span class="kobospan" id="kobo.751.1"> command might include </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.752.1">--group</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.753.1"> dev</span></span></span></span><span class="kobospan" id="kobo.754.1"> to add an item to the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.755.1">dev</span></span></span></span><span class="kobospan" id="kobo.756.1"> group.</span></p>
</div></li>
</ol>
<p class="normal1"><span id="x1-935021r1915"/></p>
</section>
<section data-number="0.20.4.3" id="how-it-works...-131">
<h2 class="likechapterhead" data-number="0.20.4.3"><span><span class="kobospan" id="kobo.757.1">17.4.3 </span></span> <span id="x1-9360003"/><span class="kobospan" id="kobo.758.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.759.1">The goal is to provide ranges</span><span id="dx1-936001"/><span class="kobospan" id="kobo.760.1"> and patterns</span><span id="dx1-936002"/><span class="kobospan" id="kobo.761.1"> in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.762.1">pyproject.toml</span></span></span></span><span class="kobospan" id="kobo.763.1"> file, offering flexibility in version identification. </span><span class="kobospan" id="kobo.763.2">Separate </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.764.1">requirements*.txt</span></span></span></span><span class="kobospan" id="kobo.765.1"> files record specific version numbers used for the current release. </span><span class="kobospan" id="kobo.765.2">This generic-specific distinction supports the integration and reuse of complex packages. </span><span id="x1-936003r1916"/></p>
</section>
<section data-number="0.20.4.4" id="theres-more...-122">
<h2 class="likechapterhead" data-number="0.20.4.4"><span><span class="kobospan" id="kobo.766.1">17.4.4 </span></span> <span id="x1-9370004"/><span class="kobospan" id="kobo.767.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.768.1">When working</span><span id="dx1-937001"/><span class="kobospan" id="kobo.769.1"> with tools like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.770.1">tox</span></span></span></span><span class="kobospan" id="kobo.771.1">, we can create multiple virtual environments to test our software with variants on the dependencies.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.772.1">Package installation often uses a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.773.1">requirements.txt</span></span></span></span><span class="kobospan" id="kobo.774.1"> file with specific version identification. </span><span class="kobospan" id="kobo.774.2">Development efforts, on the other hand, may involve a number of alternative virtual environments.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.775.1">We can use tools like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.776.1">pip-compile</span></span></span></span><span class="kobospan" id="kobo.777.1"> to create the mix of packages to permit testing in a number of alternative virtual environments. </span><span class="kobospan" id="kobo.777.2">See </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.778.1">Workflow for layered</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.779.1">requirements </span></span><span class="kobospan" id="kobo.780.1">at </span><a class="url" href="https://pip-tools.readthedocs.io/en/latest/"><span class="url1"><span class="kobospan" id="kobo.781.1">https://pip-tools.readthedocs.io/en/latest/</span></span></a><span class="kobospan" id="kobo.782.1"> for more information.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.783.1">We’ll often create a base </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.784.1">requirements.in</span></span></span></span><span class="kobospan" id="kobo.785.1"> file to define the common requirements across all virtual environments. </span><span class="kobospan" id="kobo.785.2">For more information on this, see </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.786.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.787.1"> </span></span><a href="ch020_split_000.xhtml#x1-86400016" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.788.1">16</span></span></a><span class="kobospan" id="kobo.789.1">, </span><a href="ch020_split_000.xhtml#x1-86400016" class="url"><span class="kobospan" id="kobo.790.1">Dependencies and Virtual Environments</span></a><span class="kobospan" id="kobo.791.1">. </span><span class="kobospan" id="kobo.791.2">This is often a simple list of the packages required:</span></p>
<pre class="programlisting" id="listing-175"><code class="calibre13"><span class="kobospan" id="kobo.792.1"># requirements.in 
 
this_package 
 
sphinx</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.793.1">This provides the baseline set of packages unique to the project.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.794.1">We can then create layered </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.795.1">requirements-dev_x.in</span></span></span></span><span class="kobospan" id="kobo.796.1"> files for various test environments. </span><span class="kobospan" id="kobo.796.2">Each of these files will include the base layer </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.797.1">requirements.txt</span></span></span></span><span class="kobospan" id="kobo.798.1"> and an additional set of constraints. </span><span class="kobospan" id="kobo.798.2">The file might look like this:</span></p>
<pre class="programlisting" id="listing-176"><code class="calibre13"><span class="kobospan" id="kobo.799.1"># requirements_dev_x.in 
 
# Anticipation of new release. </span><span class="kobospan" id="kobo.799.2">See ... </span><span class="kobospan" id="kobo.799.3">for details. 
 
-c requirements.txt 
 
some_package&gt;2.6.1</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.800.1">We’ve included a comment that provides information on why this distinct development virtual environment is required. </span><span class="kobospan" id="kobo.800.2">These reasons change frequently, and it’s helpful to leave reminders on why a particular environment is helpful.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.801.1">Within a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.802.1">tox.ini</span></span></span></span><span class="kobospan" id="kobo.803.1"> file, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.804.1">pip-sync</span></span></span></span><span class="kobospan" id="kobo.805.1"> command will build a distinct virtual environment for testing. </span><span class="kobospan" id="kobo.805.2">We’ll look at this in the </span><a href="ch021.xhtml#x1-9390005" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.806.1">Using tox to run comprehensive</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.807.1">quality checks</span></span></a><span class="kobospan" id="kobo.808.1"> recipe. </span><span id="x1-937009r1917"/></p>
</section>
<section data-number="0.20.4.5" id="see-also-129">
<h2 class="likechapterhead" data-number="0.20.4.5"><span><span class="kobospan" id="kobo.809.1">17.4.5 </span></span> <span id="x1-9380005"/><span class="kobospan" id="kobo.810.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.811.1">In </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.812.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.813.1"> </span></span><a href="ch020_split_000.xhtml#x1-86400016" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.814.1">16</span></span></a><span class="kobospan" id="kobo.815.1">, the </span><a href="ch020_split_000.xhtml#x1-8790003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.816.1">Creating a pyproject.toml file</span></span></a><span class="kobospan" id="kobo.817.1"> recipe shows a way to start a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.818.1">pyproject.toml</span></span></span></span><span class="kobospan" id="kobo.819.1"> file.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.820.1">See </span><a href="ch021.xhtml#x1-9390005" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.821.1">Using tox to run comprehensive quality checks</span></span></a><span class="kobospan" id="kobo.822.1"> for more information on using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.823.1">tox</span></span></span></span><span class="kobospan" id="kobo.824.1"> tool to run a test suite.</span></p></li>
</ul>
<p class="normal1"><span id="x1-938001r1913"/></p>
</section>
</section>
<section data-number="0.20.5" id="using-tox-to-run-comprehensive-quality-checks">
<h1 class="unnumbered" data-number="0.20.5"><span><span class="kobospan" id="kobo.825.1">17.5 </span></span> <span id="x1-9390005"/><span class="kobospan" id="kobo.826.1">Using tox to run comprehensive quality checks</span></h1>
<p class="normal"><span class="kobospan" id="kobo.827.1">When we start using multiple</span><span id="dx1-939001"/><span class="kobospan" id="kobo.828.1"> CI/CD tools, it’s essential</span><span id="dx1-939002"/><span class="kobospan" id="kobo.829.1"> to make sure all of the tools are used consistently. </span><span class="kobospan" id="kobo.829.2">The virtual environments must also be built consistently.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.830.1">Traditionally, a tool like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.831.1">make</span></span></span></span><span class="kobospan" id="kobo.832.1"> was used to rebuild target files when source files were modified. </span><span class="kobospan" id="kobo.832.2">This requires a great deal of care because Python doesn’t really fit the compiler-centric model of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.833.1">make</span></span></span></span><span class="kobospan" id="kobo.834.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.835.1">Tools like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.836.1">tox</span></span></span></span><span class="kobospan" id="kobo.837.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.838.1">nox</span></span></span></span><span class="kobospan" id="kobo.839.1"> are far more helpful for running</span><span id="dx1-939003"/><span class="kobospan" id="kobo.840.1"> comprehensive sequences of test and CI/CD tools on Python code. </span><span id="x1-939004r1918"/></p>
<section data-number="0.20.5.1" id="getting-ready-131">
<h2 class="likechapterhead" data-number="0.20.5.1"><span><span class="kobospan" id="kobo.841.1">17.5.1 </span></span> <span id="x1-9400001"/><span class="kobospan" id="kobo.842.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.843.1">For careful software development, a variety of tools can be useful:</span></p>
<p class="normal1"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.844.1">Unit testing</span></span><span class="kobospan" id="kobo.845.1">: We can use the built-in </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.846.1">doctest</span></span></span></span><span class="kobospan" id="kobo.847.1"> or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.848.1">unittest</span></span></span></span><span class="kobospan" id="kobo.849.1"> modules. </span><span class="kobospan" id="kobo.849.2">We can also</span><span id="dx1-940001"/><span class="kobospan" id="kobo.850.1"> use tools like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.851.1">pytest</span></span></span></span><span class="kobospan" id="kobo.852.1"> to find and run a test suite.</span></p>
<p class="normal1"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.853.1">Benchmarking</span></span><span class="kobospan" id="kobo.854.1">: Also called performance</span><span id="dx1-940002"/><span class="kobospan" id="kobo.855.1"> testing. </span><span class="kobospan" id="kobo.855.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.856.1">pytest-benchmark</span></span></span></span><span class="kobospan" id="kobo.857.1"> project</span><span id="dx1-940003"/><span class="kobospan" id="kobo.858.1"> offers a handy fixture for assuring performance meets expectations.</span></p>
<p class="normal1"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.859.1">Acceptance testing</span></span><span class="kobospan" id="kobo.860.1">: A tool like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.861.1">behave</span></span></span></span><span class="kobospan" id="kobo.862.1"> or the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.863.1">pytest-bdd</span></span></span></span><span class="kobospan" id="kobo.864.1"> plug-in can help by stating acceptance test cases in Gherkin to make them more readily understood by product owners.</span></p>
<p class="normal1"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.865.1">Type hint checking</span></span><span class="kobospan" id="kobo.866.1">: This is</span><span id="dx1-940004"/><span class="kobospan" id="kobo.867.1"> often</span><span id="dx1-940005"/><span class="kobospan" id="kobo.868.1"> handled</span><span id="dx1-940006"/><span class="kobospan" id="kobo.869.1"> by</span><span id="dx1-940007"/><span class="kobospan" id="kobo.870.1"> tools</span><span id="dx1-940008"/><span class="kobospan" id="kobo.871.1"> like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.872.1">mypy</span></span></span></span><span class="kobospan" id="kobo.873.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.874.1">pyre</span></span></span></span><span class="kobospan" id="kobo.875.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.876.1">pyright</span></span></span></span><span class="kobospan" id="kobo.877.1">, or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.878.1">pytype</span></span></span></span><span class="kobospan" id="kobo.879.1">.</span></p>
<p class="normal1"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.880.1">Linting</span></span><span class="kobospan" id="kobo.881.1">: While the term ”linting” is in common</span><span id="dx1-940009"/><span class="kobospan" id="kobo.882.1"> use, this is really better</span><span id="dx1-940010"/><span class="kobospan" id="kobo.883.1"> termed</span><span id="dx1-940011"/><span class="kobospan" id="kobo.884.1"> ”lint blocking”. </span><span class="kobospan" id="kobo.884.2">There</span><span id="dx1-940012"/><span class="kobospan" id="kobo.885.1"> are numerous</span><span id="dx1-940013"/><span class="kobospan" id="kobo.886.1"> tools, including </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.887.1">ruff</span></span></span></span><span class="kobospan" id="kobo.888.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.889.1">pylint</span></span></span></span><span class="kobospan" id="kobo.890.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.891.1">flake8</span></span></span></span><span class="kobospan" id="kobo.892.1">, and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.893.1">pylama</span></span></span></span><span class="kobospan" id="kobo.894.1">.</span></p>
<p class="normal1"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.895.1">Style and formatting</span></span><span class="kobospan" id="kobo.896.1">: Two popular tools</span><span id="dx1-940014"/><span class="kobospan" id="kobo.897.1"> for</span><span id="dx1-940015"/><span class="kobospan" id="kobo.898.1"> this</span><span id="dx1-940016"/><span class="kobospan" id="kobo.899.1"> are </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.900.1">ruff</span></span></span></span><span class="kobospan" id="kobo.901.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.902.1">black</span></span></span></span><span class="kobospan" id="kobo.903.1">.</span></p>
<p class="normal1"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.904.1">Documentation</span></span><span class="kobospan" id="kobo.905.1">: This is often</span><span id="dx1-940017"/><span class="kobospan" id="kobo.906.1"> built</span><span id="dx1-940018"/><span class="kobospan" id="kobo.907.1"> with </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.908.1">Sphinx</span></span></span></span><span class="kobospan" id="kobo.909.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.910.1">This means we’ll need to install the chosen suite of tools. </span><span class="kobospan" id="kobo.910.2">One more tool can be helpful to find them all and bind them into a usable form. </span><span class="kobospan" id="kobo.910.3">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.911.1">tox</span></span></span></span><span class="kobospan" id="kobo.912.1"> tool can create and run</span><span id="dx1-940019"/><span class="kobospan" id="kobo.913.1"> tests in multiple virtual environments.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.914.1">We’ll need to download and install the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.915.1">tox</span></span></span></span><span class="kobospan" id="kobo.916.1"> tool. </span><span class="kobospan" id="kobo.916.2">Generally, this is done with the following terminal command:</span></p>
<pre class="programlisting" id="listing-177"><code class="calibre13"><span class="kobospan" id="kobo.917.1">(cookbook3) % python -m pip install tox</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.918.1">Using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.919.1">python</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.920.1"> -m</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.921.1"> pip</span></span></span></span><span class="kobospan" id="kobo.922.1"> command ensures that we will use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.923.1">pip</span></span></span></span><span class="kobospan" id="kobo.924.1"> command that goes with the currently active virtual environment. </span><span id="x1-940021r1920"/></p>
</section>
<section data-number="0.20.5.2" id="how-to-do-it...-132">
<h2 class="likechapterhead" data-number="0.20.5.2"><span><span class="kobospan" id="kobo.925.1">17.5.2 </span></span> <span id="x1-9410002"/><span class="kobospan" id="kobo.926.1">How to do it...</span></h2>
<ol class="calibre2">
<li class="calibre7"><div id="x1-941002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.927.1">There are two ways to provide configuration</span><span id="dx1-941003"/><span class="kobospan" id="kobo.928.1"> files for </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.929.1">tox</span></span></span></span><span class="kobospan" id="kobo.930.1">. </span><span class="kobospan" id="kobo.930.2">We can embed</span><span id="dx1-941004"/><span class="kobospan" id="kobo.931.1"> the configuration in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.932.1">pyproject.toml</span></span></span></span><span class="kobospan" id="kobo.933.1">. </span><span class="kobospan" id="kobo.933.2">While this fits the philosophy of the file, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.934.1">tox</span></span></span></span><span class="kobospan" id="kobo.935.1"> tool doesn’t handle TOML options. </span><span class="kobospan" id="kobo.935.2">It relies on a string with INI-formatted options in the TOML file.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.936.1">A better alternative is to create a separate </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.937.1">tox.ini</span></span></span></span><span class="kobospan" id="kobo.938.1"> file. </span><span class="kobospan" id="kobo.938.2">In this file, create an initial </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.939.1">[tox]</span></span></span></span><span class="kobospan" id="kobo.940.1"> table with core configuration options. </span><span class="kobospan" id="kobo.940.2">The following are appropriate for many projects:</span></p>
<pre class="programlisting" id="listing-178"><code class="calibre13"><span class="kobospan" id="kobo.941.1">[tox] 
 
description = "Your project name goes here." 
 
min_version = 4.0</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-941009x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.942.1">For applications or scripts that don’t need to be installed, the following two lines are appropriate to avoid trying to prepare and install a package:</span></p>
<pre class="programlisting" id="listing-179"><code class="calibre13"><span class="kobospan" id="kobo.943.1">skip_sdist = true 
 
no_package = true</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.944.1">For packages that will be distributed and installed, add nothing.</span></p>
</div></li>
<li class="calibre7"><div id="x1-941013x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.945.1">Create a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.946.1">[testenv]</span></span></span></span><span class="kobospan" id="kobo.947.1"> table with general information about test environments. </span><span class="kobospan" id="kobo.947.2">In some cases, a single environment is sufficient. </span><span class="kobospan" id="kobo.947.3">When multiple, distinct environments are required, there will be multiple </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.948.1">[testenv]</span></span></span></span><span class="kobospan" id="kobo.949.1"> sections.</span></p>
<pre class="programlisting" id="listing-180"><code class="calibre13"><span class="kobospan" id="kobo.950.1">[testenv]</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-941016x4" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.951.1">Inside this </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.952.1">[testenv]</span></span></span></span><span class="kobospan" id="kobo.953.1"> table, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.954.1">deps=</span></span></span></span><span class="kobospan" id="kobo.955.1"> value lists the test tools that will be used. </span><span class="kobospan" id="kobo.955.2">It might look like this:</span></p>
<pre class="programlisting" id="listing-181"><code class="calibre13"><span class="kobospan" id="kobo.956.1">deps = 
 
    pytest&gt;=7 
 
    pip-tools 
 
    ruff&gt;=0.1.4 
 
    mypy&gt;=1.7</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.957.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.958.1">tox</span></span></span></span><span class="kobospan" id="kobo.959.1"> tool uses a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.960.1">pip</span></span></span></span><span class="kobospan" id="kobo.961.1"> command to build the items listed in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.962.1">deps</span></span></span></span><span class="kobospan" id="kobo.963.1"> section. </span><span class="kobospan" id="kobo.963.2">It can, of course, be used to install </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.964.1">all </span></span><span class="kobospan" id="kobo.965.1">of the requirements. </span><span class="kobospan" id="kobo.965.2">Using </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.966.1">-r</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.967.1"> requirements.txt</span></span></span></span><span class="kobospan" id="kobo.968.1"> will do this.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.969.1">It’s somewhat more efficient</span><span id="dx1-941022"/><span class="kobospan" id="kobo.970.1"> to use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.971.1">pip-sync</span></span></span></span><span class="kobospan" id="kobo.972.1"> tool because</span><span id="dx1-941023"/><span class="kobospan" id="kobo.973.1"> it can avoid reinstalling any dependencies that are already present in the environment. </span><span class="kobospan" id="kobo.973.2">When using </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.974.1">pip-sync</span></span></span></span><span class="kobospan" id="kobo.975.1">, we do not use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.976.1">-r</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.977.1"> requirements.txt</span></span></span></span><span class="kobospan" id="kobo.978.1"> in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.979.1">deps=</span></span></span></span><span class="kobospan" id="kobo.980.1"> list.</span></p>
</div></li>
<li class="calibre7"><div id="x1-941025x5" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.981.1">If </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.982.1">pip-sync</span></span></span></span><span class="kobospan" id="kobo.983.1"> is being used to install requirements, this is given as the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.984.1">commands_pre=</span></span></span></span><span class="kobospan" id="kobo.985.1"> value:</span></p>
<pre class="programlisting" id="listing-182"><code class="calibre13"><span class="kobospan" id="kobo.986.1">commands_pre = pip-sync requirements.txt</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-941028x6" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.987.1">If any unique environment variables are required, they’re set by the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.988.1">setenv=</span></span></span></span><span class="kobospan" id="kobo.989.1"> value:</span></p>
<pre class="programlisting" id="listing-183"><code class="calibre13"><span class="kobospan" id="kobo.990.1">setenv = 
 
    PYTHONPATH=src/ch03</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-941032x7" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.991.1">Finally, provide the sequence of commands to execute:</span></p>
<pre class="programlisting" id="listing-184"><code class="calibre13"><span class="kobospan" id="kobo.992.1">commands = 
 
    pytest --doctest-glob=’*.txt’ src 
 
    ruff format src 
 
    ruff check src 
 
    mypy --strict src</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-941039x8" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.993.1">After closing this file, use the following command to run the test suite:</span></p>
<pre class="programlisting" id="listing-185"><code class="calibre13"><span class="kobospan" id="kobo.994.1">(cookbook3) % tox</span></code></pre>
</div></li>
</ol>
<p class="normal1"><span id="x1-941041r1921"/></p>
</section>
<section data-number="0.20.5.3" id="how-it-works...-132">
<h2 class="likechapterhead" data-number="0.20.5.3"><span><span class="kobospan" id="kobo.995.1">17.5.3 </span></span> <span id="x1-9420003"/><span class="kobospan" id="kobo.996.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.997.1">A great many assumptions</span><span id="dx1-942001"/><span class="kobospan" id="kobo.998.1"> and defaults are built into tools</span><span id="dx1-942002"/><span class="kobospan" id="kobo.999.1"> like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1000.1">tox</span></span></span></span><span class="kobospan" id="kobo.1001.1">. </span><span class="kobospan" id="kobo.1001.2">This saves us from having to write clever shell scripts or tinker with the assumptions present in a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1002.1">makefile</span></span></span></span><span class="kobospan" id="kobo.1003.1">. </span><span class="kobospan" id="kobo.1003.2">Instead, we can provide a few lines of configuration and a sequence of commands.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1004.1">Ideally, using </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1005.1">tox</span></span></span></span><span class="kobospan" id="kobo.1006.1"> always looks like this:</span></p>
<pre class="programlisting" id="listing-186"><code class="calibre13"><span class="kobospan" id="kobo.1007.1">(cookbook3) % tox 
 
... </span><span class="kobospan" id="kobo.1007.2">details omitted 
 
 
 
  congratulations :) (4.09 seconds)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1008.1">The final </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.1009.1">congratulations </span></span><span class="kobospan" id="kobo.1010.1">is an apt summary. </span><span id="x1-942007r1922"/></p>
</section>
<section data-number="0.20.5.4" id="theres-more...-123">
<h2 class="likechapterhead" data-number="0.20.5.4"><span><span class="kobospan" id="kobo.1011.1">17.5.4 </span></span> <span id="x1-9430004"/><span class="kobospan" id="kobo.1012.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1013.1">In many cases, a project has multiple virtual environments. </span><span class="kobospan" id="kobo.1013.2">Virtual environments are distinguished using extended names. </span><span class="kobospan" id="kobo.1013.3">These will have the general pattern of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1014.1">[testenv:name]</span></span></span></span><span class="kobospan" id="kobo.1015.1"> where </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1016.1">name</span></span></span></span><span class="kobospan" id="kobo.1017.1"> is something descriptive.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1018.1">In the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1019.1">[tox]</span></span></span></span><span class="kobospan" id="kobo.1020.1"> section of the configuration, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1021.1">env_list</span></span></span></span><span class="kobospan" id="kobo.1022.1"> lists the environments to process automatically. </span><span class="kobospan" id="kobo.1022.2">Environments not listed can be executed manually by using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1023.1">-e</span></span></span></span><span class="kobospan" id="kobo.1024.1"> option on the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1025.1">tox</span></span></span></span><span class="kobospan" id="kobo.1026.1"> command.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1027.1">To test with another version of Python, we add the following to our </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1028.1">tox.ini</span></span></span></span><span class="kobospan" id="kobo.1029.1"> file:</span></p>
<pre class="programlisting" id="listing-187"><code class="calibre13"><span class="kobospan" id="kobo.1030.1">[testenv:py311] 
 
    base_python = py311</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1031.1">This will inherit the details of the master </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1032.1">testenv</span></span></span></span><span class="kobospan" id="kobo.1033.1"> settings. </span><span class="kobospan" id="kobo.1033.2">An override is applied to change the base Python version to 3.11.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1034.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1035.1">py311</span></span></span></span><span class="kobospan" id="kobo.1036.1"> name is a handy </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1037.1">tox</span></span></span></span><span class="kobospan" id="kobo.1038.1"> shorthand for a longer specification like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1039.1">python&gt;=3.11</span></span></span></span><span class="kobospan" id="kobo.1040.1">. </span><span class="kobospan" id="kobo.1040.2">The tool will search the system-wide </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1041.1">PATH</span></span></span></span><span class="kobospan" id="kobo.1042.1"> for candidate Python implementations. </span><span class="kobospan" id="kobo.1042.2">To test with multiple Python versions, they all need to be installed in directories named in the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1043.1">PATH</span></span></span></span><span class="kobospan" id="kobo.1044.1">. </span><span id="x1-943003r1923"/></p>
</section>
<section data-number="0.20.5.5" id="see-also-130">
<h2 class="likechapterhead" data-number="0.20.5.5"><span><span class="kobospan" id="kobo.1045.1">17.5.5 </span></span> <span id="x1-9440005"/><span class="kobospan" id="kobo.1046.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.1047.1">See </span><a href="ch021.xhtml#x1-9330004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1048.1">Identifying other CI/CD tools in pyproject.toml</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1049.1">See </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1050.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1051.1"> </span></span><a href="ch019_split_000.xhtml#x1-79400015" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1052.1">15</span></span></a><span class="kobospan" id="kobo.1053.1"> for more information on testing.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1054.1">See </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1055.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1056.1"> </span></span><a href="ch020_split_000.xhtml#x1-86400016" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1057.1">16</span></span></a><span class="kobospan" id="kobo.1058.1"> for recipes related to virtual environments.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1059.1">See </span><a class="url" href="https://tox.wiki/en/latest/"><span class="url1"><span class="kobospan" id="kobo.1060.1">https://tox.wiki/en/latest/</span></span></a><span class="kobospan" id="kobo.1061.1"> for more information on the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1062.1">tox</span></span></span></span><span class="kobospan" id="kobo.1063.1"> tool.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1064.1">See </span><a class="url" href="https://nox.thea.codes/en/stable/"><span class="url1"><span class="kobospan" id="kobo.1065.1">https://nox.thea.codes/en/stable/</span></span></a><span class="kobospan" id="kobo.1066.1"> for information on the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1067.1">nox</span></span></span></span><span class="kobospan" id="kobo.1068.1"> tool, which offers similar functionality.</span></p></li>
</ul>
<p class="normal1"><span id="x1-944001r1919"/></p>
</section>
</section>
<section data-number="0.20.8" id="join-our-community-discord-space-17">
<h1 class="unnumbered" data-number="0.20.8"><span id="x1-9470007"/><span class="kobospan" id="kobo.1069.1">Join our community Discord space</span></h1>
<p class="normal"><span class="kobospan" id="kobo.1070.1">Join our Python Discord workspace to discuss and find out more about the book: </span><a class="url" href="https://packt.link/dHrHU"><span class="url1"><span class="kobospan" id="kobo.1071.1">https://packt.link/dHrHU</span></span></a></p>
<p class="normal1"><span class="kobospan" id="kobo.1072.1"><img alt="PIC" src="../media/file1.png" class="calibre9"/></span></p>
<p class="normal1"><span class="kobospan" id="kobo.1073.1"><img alt="PIC" src="../media/file87.png" class="calibre31"/></span></p>
<p class="normal1"><a class="url" href="https://www.packt.com"><span class="url1"><span class="kobospan" id="kobo.1074.1">www.packt.com</span></span></a></p>
<p class="normal1"><span class="kobospan" id="kobo.1075.1">Subscribe to our online digital library for full access to over 7,000 books and videos, as well as industry leading tools to help you plan your personal development and advance your career. </span><span class="kobospan" id="kobo.1075.2">For more information, please visit our website.</span></p>
</section>
<section data-number="0.20.9" id="why-subscribe">
<h1 class="unnumbered" data-number="0.20.9"><span id="x1-94800017.7"/><span class="kobospan" id="kobo.1076.1">Why subscribe?</span></h1>
<p class="normal"><span class="kobospan" id="kobo.1077.1">[nosep]Spend less time learning and more time coding with practical eBooks and Videos from over 4,000 industry professionals Improve your learning with Skill Plans built especially for you Get a free eBook or video every month Fully searchable for easy access to vital information Copy and paste, print, and bookmark content</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1078.1">Did you know that Packt offers eBook versions of every book published, with PDF and ePub files available? </span><span class="kobospan" id="kobo.1078.2">You can upgrade to the eBook version at packt.com and as a print book customer, you are entitled to a discount on the eBook copy. </span><span class="kobospan" id="kobo.1078.3">Get in touch with us at </span><a href="mailto:customercare@packtpub.com" class="url"><span class="url1"><span class="kobospan" id="kobo.1079.1">customercare@packtpub.com</span></span></a><span class="kobospan" id="kobo.1080.1"> for more details.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1081.1">At </span><a class="url" href="https://www.packt.com"><span class="url1"><span class="kobospan" id="kobo.1082.1">www.packt.com</span></span></a><span class="kobospan" id="kobo.1083.1">, you can also read a collection of free technical articles, sign up for a range of free newsletters, and receive exclusive discounts and offers on Packt books and eBooks.</span></p>
</section>
</section>
</body></html>