<html><head></head><body>
		<div><h1 id="_idParaDest-176" class="chapter-number"><a id="_idTextAnchor182"/>9</h1>
			<h1 id="_idParaDest-177"><a id="_idTextAnchor183"/>Post Comments</h1>
			<p>An exciting part of every social media platform is the comment functionality. In the previous chapter, weâ€™ve added post creation, listing, update, and deletion functionality. This chapter will cover a commentâ€™s creation, listing, update, and deletion. We will create a page to display information about a post, add components to list comments, add a modal to display a form to create comments and add a dropdown to allow the user to delete or modify a comment. At the end of this chapter, you will learn how to navigate to a single page with URL parameters using React and React Router.</p>
			<p>In this chapter, we will cover the following topics:</p>
			<ul>
				<li>Listing comments on a post page</li>
				<li>Creating a comment using a form</li>
				<li>Editing and deleting a comment</li>
				<li>Updating a comment</li>
			</ul>
			<h1 id="_idParaDest-178">Technical <a id="_idTextAnchor184"/>requirements</h1>
			<p>Make sure to have VS Code and an updated browser installed and configured on your machine. You can find the code of this chapter at <a href="https://github.com/PacktPublishing/Full-stack-Django-and-React/tree/chap9">https://github.com/PacktPublishing/Full-stack-Django-and-React/tree/chap9</a>.</p>
			<h1 id="_idParaDest-179"><a id="_idTextAnchor185"/>Creating a UI</h1>
			<p>In the next paragraphs, we will modify the <code>Post</code> component for consistency when displaying a single post, add a <code>Post</code> components. Before listing the comments, we need to ensure that the user can create comments. This will require building a page called <code>SinglePost</code> that will show details about a post and the comments.</p>
			<p>Letâ€™s look at the UI of the page in the following figure:</p>
			<div><div><img src="img/Figure_9.01_B18221.jpg" alt="Figure 9.1 â€“ ï»¿Result of the SinglePost page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.1 â€“ <a id="_idTextAnchor186"/>Result of the SinglePost page</p>
			<p>The UI in the preceding figure <a id="_idIndexMarker551"/>gives us a good idea of the result. When the page is built and the user clicks on a comment, a modal will appear, and the user will be able to create a comment. Letâ€™s stick to this case first, and weâ€™ll explore the other CRUD operations later.</p>
			<p>Notice that we also have a back button in the top-left corner of the page â€“ something to add to the <code>Layout</code> component. We will start by making some tweaks to the <code>Post.jsx</code> component first. This is because we are going to reuse the <code>Post</code> component, but we will mask options such as comment count<a id="_idTextAnchor187"/> and the <strong class="bold">Comment</strong> icon. After modifying the component, we will create a page displaying one article and comments.</p>
			<h2 id="_idParaDest-180"><a id="_idTextAnchor188"/>Tweaking the Post component</h2>
			<p>The <code>Post</code> component will be simply reused<a id="_idIndexMarker552"/> to display more<a id="_idIndexMarker553"/> information about the post. Following the UI in <em class="italic">Figure 9</em><em class="italic">.1</em>, we will just mask the number of comments on the post and the <strong class="bold">Comment</strong> icon.</p>
			<p>Inside <code>Post.jsx</code>, we will add another prop called <code>isSinglePost</code>. When this prop is <code>true</code>, it means that we are showing the component on the <code>SinglePost</code> page:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/posts/Post.jsx</p>
			<pre class="source-code">
...
function Post(props) {
<strong class="bold"> const { post, refresh, isSinglePost } = props;</strong>
...
 return (
Â Â Â &lt;&gt;
Â Â Â Â ...
Â Â Â Â Â Â Â Â Â Â Â Â {!isSinglePost &amp;&amp; (
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;p className="ms-1 fs-6"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;small&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Link&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â {post.comments_count} comments
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/Link&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/small&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/p&gt;
Â Â Â Â Â Â Â Â Â Â Â )}
Â Â Â ...
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â {!isSinglePost &amp;&amp; (
Â Â Â Â Â Â Â Â Â Â Â &lt;div className="d-flex flex-row"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;CommentOutlined
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â style={{
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â width: "24px",
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â height: "24px",
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â padding: "2px",
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â fontSize: "20px",
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â color: "#C4C4C4",
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }}
Â Â Â Â Â Â Â Â Â Â Â Â Â /&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;p className="ms-1 mb-0"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;small&gt;Comment&lt;/small&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/p&gt;
Â Â Â Â Â Â Â Â Â Â Â &lt;/div&gt;
Â Â Â Â Â Â Â Â Â )}
...</pre>
			<p>With the modification<a id="_idIndexMarker554"/> done to the <code>Post</code> component, we can now add the back<a id="_idIndexMarker555"/> button to the <code>Layout</code> component.</p>
			<h2 id="_idParaDest-181"><a id="_idTextAnchor189"/>Adding a back button to the Layout component</h2>
			<p>The back button has the<a id="_idIndexMarker556"/> role of navigating the user to the preceding page if the action<a id="_idIndexMarker557"/> is initiated. An interesting idea about doing that is to add the actual path to the component where a go-back action can happen. However, itâ€™ll require a lot of code and will introduce some complexity.</p>
			<p>Thankfully, the <code>react-router</code> library provides a simple way to navigate to the preceding page in just one line:</p>
			<p><strong class="bold">navigate(-1)</strong></p>
			<p>Yes! Letâ€™s add this function to the <code>Layout.jsx</code> component:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/Layout.jsx</p>
			<pre class="source-code">
import { ArrowLeftOutlined } from "@ant-design/icons";
import { useNavigate } from "react-router-dom";
function Layout(props) {
 const { hasNavigationBack } = props;
 const navigate = useNavigate();
...
Â Â return (
Â Â Â Â Â &lt;div&gt;
Â Â Â Â Â Â Â &lt;Navigationbar /&gt;
Â Â Â Â Â Â Â {hasNavigationBack &amp;&amp; (
Â Â Â Â Â Â Â Â Â &lt;ArrowLeftOutlined
Â Â Â Â Â Â Â Â Â Â Â style={{
Â Â Â Â Â Â Â Â Â Â Â Â Â color: "#0D6EFD",
Â Â Â Â Â Â Â Â Â Â Â Â Â fontSize: "24px",
Â Â Â Â Â Â Â Â Â Â Â Â Â marginLeft: "5%",
Â Â Â Â Â Â Â Â Â Â Â Â Â marginTop: "1%",
Â Â Â Â Â Â Â Â Â Â Â }}
Â Â Â Â Â Â Â Â Â Â Â onClick={() =&gt; navigate(-1)}
Â Â Â Â Â Â Â Â Â /&gt;
Â Â Â Â Â Â Â )}
Â Â Â Â Â Â Â &lt;div className="container my-2"&gt;
Â Â Â Â Â Â Â Â Â Â Â {props.children}
Â Â Â Â Â Â Â &lt;/div&gt;
...</pre>
			<p>In the preceding code, we <a id="_idIndexMarker558"/>added a prop called <code>hasNavigationBack</code>. This prop will tell <a id="_idIndexMarker559"/>React whether it should render the icon to nagivate back to the precedent page. The rendering process is done in the JSX code, using conditional. If <code>hasNavigationBack</code> is <code>true</code>, we show the <strong class="bold">Back</strong> icon, and the user can navigate.</p>
			<p>With the option <a id="_idIndexMarker560"/>of going back <a id="_idIndexMarker561"/>added, we can now move to write the <code>SinglePost.jsx</code> page.</p>
			<h2 id="_idParaDest-182"><a id="_idTextAnchor190"/>Creating the SinglePost component</h2>
			<p>In the <code>src/pages</code> directory, create a new file called <code>SinglePost.jsx</code>. This file will contain the code to display <a id="_idIndexMarker562"/>information about a post and, most importantly, the comments. The <a id="_idIndexMarker563"/>following figure shows a simple wireframe of the page so we can have an idea about the layout of the components:</p>
			<div><div><img src="img/Figure_9.02_B18221.jpg" alt="Figure 9.2 â€“ Wireframe of the SinglePost page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.2 â€“ Wireframe of the SinglePost page</p>
			<p>Letâ€™s move the file and start coding. In the following snippet, we will create the <code>SinglePost</code> page, add the imports, and <a id="_idIndexMarker564"/>define the functions and states that will be <a id="_idIndexMarker565"/>used on the page:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/pages/SinglePost.jsx</p>
			<pre class="source-code">
import React from "react";
import Layout from "../components/Layout";
import { Row, Col } from "react-bootstrap";
import { useParams } from "react-router-dom";
import useSWR from "swr";
import { fetcher } from "../helpers/axios";
import { Post } from "../components/posts";
import CreateComment from "../components/comments/CreateComment";
import Comment from "../components/comments/Comment";
function SinglePost() {
 let { postId } = useParams();
 const post = useSWR(`/post/${postId}/`, fetcher);
 const comments = useSWR(`/post/${postId}/comment/`, fetcher);
 return (
Â Â Â &lt;Layout hasNavigationBack&gt;
Â Â Â Â Â {post.data ? (
Â Â Â Â Â Â Â &lt;Row className="justify-content-center"&gt;
Â Â Â Â Â Â Â Â Â &lt;Col sm={8}&gt;
Â Â Â Â Â Â Â Â Â Â Â &lt;Post post={post.data} refresh={post.mutate}              isSinglePost /&gt;
Â Â Â Â Â Â Â Â Â Â Â // Adding CreateComment form and list all comments               here
Â Â Â Â Â Â Â Â Â &lt;/Col&gt;
Â Â Â Â Â Â Â &lt;/Row&gt;
Â Â Â Â Â ) : (
Â Â Â Â Â Â Â &lt;div&gt;Loading...&lt;/div&gt;
Â Â Â Â Â )}
Â Â Â &lt;/Layout&gt;
 );
}
export default SinglePost;</pre>
			<p>We are using the <code>Row</code> and <code>Col</code> feature from <code>react-bootstrap</code> again. This structure will help us have one<a id="_idIndexMarker566"/> column taking 8/12 of the layout and having objects centered. Next, we need a form for comment creation.</p>
			<p>We are also using a new Hook, <code>useParams</code>. As stated in the official documentation, the <code>useParams</code> Hook <a id="_idIndexMarker567"/>returns an object of <code>&lt;Route path&gt;</code>. Child routes inherit all parameters from their parent routes.</p>
			<p>A little bit complicated to grasp, but letâ€™s register this page and load it in the browser. Inside the <code>App.jsx</code> file, add a new route:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/App.jsx</p>
			<pre class="source-code">
...
function App() {
 return (
Â Â Â &lt;Routes&gt;
Â Â Â Â Â &lt;Route
Â Â Â Â Â Â Â path="/"
Â Â Â Â Â Â Â element={
Â Â Â Â Â Â Â Â Â &lt;ProtectedRoute&gt;
Â Â Â Â Â Â Â Â Â Â Â &lt;Home /&gt;
Â Â Â Â Â Â Â Â Â &lt;/ProtectedRoute&gt;
Â Â Â Â Â Â Â }
Â Â Â Â Â /&gt;
Â Â Â Â Â <strong class="bold">&lt;Route</strong>
<strong class="bold">Â Â Â Â Â Â Â path="/post/:postId/"</strong>
<strong class="bold">Â Â Â Â Â Â Â element={</strong>
<strong class="bold">Â Â Â Â Â Â Â Â Â &lt;ProtectedRoute&gt;</strong>
<strong class="bold">Â Â Â Â Â Â Â Â Â Â Â &lt;SinglePost /&gt;</strong>
<strong class="bold">Â Â Â Â Â Â Â Â Â &lt;/ProtectedRoute&gt;</strong>
<strong class="bold">Â Â Â Â Â Â Â }</strong>
<strong class="bold">Â Â Â Â Â /&gt;</strong>
...</pre>
			<p>The path of the newly added<a id="_idIndexMarker568"/> route has an interesting pattern with the<a id="_idIndexMarker569"/> addition of <code>postId</code>. We can tell <code>react-router</code> to expect a parameter that will be passed, and this parameter will then be available in the <code>useParams</code> Hook.</p>
			<p>Letâ€™s add the redirection to the <code>SinglePost</code> page in the <code>Post</code> component:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/posts/CreatePost.jsx</p>
			<pre class="source-code">
return (
Â Â Â &lt;&gt;
Â Â Â Â ...
Â Â Â Â Â Â Â Â Â Â Â Â {!isSinglePost &amp;&amp; (
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;p className="ms-1 fs-6"&gt;
<strong class="bold">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;small&gt;</strong>
<strong class="bold">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Link to={`/post/${post.id}/`}&gt;</strong>
<strong class="bold">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â {post.comments_count} comments</strong>
<strong class="bold">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/Link&gt;</strong>
<strong class="bold">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/small&gt;</strong>
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/p&gt;
Â Â Â Â Â Â Â Â Â Â Â )}
Â Â Â Â ...</pre>
			<p>Inside<a id="_idIndexMarker570"/> the <code>SinglePost.jsx</code> file, add <a id="_idIndexMarker571"/>a <code>console</code> log of <code>useParams()</code>:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/pages/SinglePost.jsx</p>
			<pre class="source-code">
...
function SinglePost() {
<strong class="bold"> console.log(useParams())</strong>
<strong class="bold"> let { postId } = useParams();</strong>
...</pre>
			<p>Go into the browser and click on a post to access the <code>SinglePost</code> page. You will have a similar result:</p>
			<div><div><img src="img/Figure_9.03_B18221.jpg" alt="Figure 9.3 â€“ Post page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.3 â€“ Post page</p>
			<p>Check the browser console to see the content of <code>useParams()</code>:</p>
			<div><div><img src="img/Figure_9.04_B18221.jpg" alt="Figure 9.4 â€“ Content of useParams()"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.4 â€“ Content of useParams()</p>
			<p>We have an<a id="_idIndexMarker572"/> object containing the <code>postId</code> value. With <code>useParams()</code> explained, letâ€™s move <a id="_idIndexMarker573"/>on to add the <code>CreateComment</code> form.</p>
			<h2 id="_idParaDest-183"><a id="_idTextAnchor191"/>Creating a comment</h2>
			<p>Inside the <code>src/components</code> directory, create a<a id="_idIndexMarker574"/> new directory called <code>comments</code>. This <a id="_idIndexMarker575"/>directory will contain the code for the <code>comments</code> feature components. Inside the newly created directory, create a new file called <code>CreateComment.jsx</code>. This component represents the form that the user will use to add comments to a post.</p>
			<p>Once the file is created, add the required imports:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/comments/CreateComment.jsx</p>
			<pre class="source-code">
import React, { useState, useContext } from "react";
import { Button, Form, Image } from "react-bootstrap";
import axiosService from "../../helpers/axios";
import { getUser } from "../../hooks/user.actions";
import { randomAvatar } from "../../utils";
import { Context } from "../Layout";
function CreateComment(props) {
 const { postId, refresh } = props;
 return (
Â Â Â &lt;Form&gt;
Â Â Â &lt;/Form&gt;
 );
}
export default CreateComment;</pre>
			<p>On the <code>CreateComment</code> page, we are going to show toast notifications when a CRUD action is made. That means that we are going to use the <code>Context</code> method again.</p>
			<p>Letâ€™s start by defining the props<a id="_idIndexMarker576"/> and creating <code>handleSubmit</code>. This process will be pretty similar to what weâ€™ve done in the <code>CreatePost</code> component:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/comments/CreateComment</p>
			<pre class="source-code">
...
function CreateComment(props) {
 const { postId, refresh } = props;
 const [avatar, setAvatar] = useState(randomAvatar());
 const [validated, setValidated] = useState(false);
 const [form, setForm] = useState({});
 const { toaster, setToaster } = useContext(Context);
 const user = getUser();
 const handleSubmit = (event) =&gt; {
Â Â Â // Logic to handle form submission
 };
...</pre>
			<p>Letâ€™s now<a id="_idIndexMarker577"/> add the <code>Form</code> UI:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/component/comments/CreateComment.jsx</p>
			<pre class="source-code">
...
return (
Â Â Â &lt;Form
Â Â Â Â Â className="d-flex flex-row justify-content-between"
Â Â Â Â Â noValidate
Â Â Â Â Â validated={validated}
Â Â Â Â Â onSubmit={handleSubmit}
Â Â Â &gt;
Â Â Â Â Â &lt;Image
Â Â Â Â Â Â Â src={avatar}
Â Â Â Â Â Â Â roundedCircle
Â Â Â Â Â Â Â width={48}
Â Â Â Â Â Â Â height={48}
Â Â Â Â Â Â Â className="my-2"
Â Â Â Â Â /&gt;
Â Â Â Â Â &lt;Form.Group className="m-3 w-75"&gt;
Â Â Â Â Â Â Â &lt;Form.Control
Â Â Â Â Â Â Â Â Â className="py-2 rounded-pill border-primary"
Â Â Â Â Â Â Â Â Â type="text"
Â Â Â Â Â Â Â Â Â placeholder="Write a comment"
Â Â Â Â Â Â Â Â Â value={form.body}
Â Â Â Â Â Â Â Â Â name="body"
Â Â Â Â Â Â Â Â Â onChange={(e) =&gt; setForm({ ...form,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â body: e.target.value })}
Â Â Â Â Â Â Â /&gt;
Â Â Â Â Â &lt;/Form.Group&gt;
Â Â Â Â Â &lt;div className="m-auto"&gt;
Â Â Â Â Â Â Â &lt;Button
Â Â Â Â Â Â Â Â Â variant="primary"
Â Â Â Â Â Â Â Â Â onClick={handleSubmit}
Â Â Â Â Â Â Â Â Â disabled={form.body === undefined}
Â Â Â Â Â Â Â Â Â size="small"
Â Â Â Â Â Â Â &gt;
Â Â Â Â Â Â Â Â Â Comment
Â Â Â Â Â Â Â &lt;/Button&gt;
Â Â Â Â Â &lt;/div&gt;
Â Â Â &lt;/Form&gt;
 );
...</pre>
			<p>With the UI added, we<a id="_idIndexMarker578"/> can write the <code>handeSubmit</code> method:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/component/comments/CreateComment.jsx</p>
			<pre class="source-code">
...
 const handleSubmit = (event) =&gt; {
Â Â Â event.preventDefault();
Â Â Â const createCommentForm = event.currentTarget;
Â Â Â if (createCommentForm.checkValidity() === false) {
Â Â Â Â Â event.stopPropagation();
Â Â Â }
Â Â Â setValidated(true);
Â Â Â const data = {
Â Â Â Â Â author: user.id,
Â Â Â Â Â body: form.body,
Â Â Â Â Â post: postId,
Â Â Â };
Â Â Â axiosService
Â Â Â Â Â .post(`/post/${postId}/comment/`, data)
Â Â Â Â Â .then(() =&gt; {
Â Â Â Â Â Â Â setForm({ ...form, body: "" });
Â Â Â Â Â Â Â setToaster({
Â Â Â Â Â Â Â Â Â type: "success",
Â Â Â Â Â Â Â Â Â message: "Comment posted successfullyðŸš€",
Â Â Â Â Â Â Â Â Â show: true,
Â Â Â Â Â Â Â Â Â title: "Comment!",
Â Â Â Â Â Â Â });
Â Â Â Â Â Â Â refresh();
Â Â Â Â Â })
Â Â Â Â Â .catch(() =&gt; {
Â Â Â Â Â Â Â setToaster({
Â Â Â Â Â Â Â Â Â type: "danger",
Â Â Â Â Â Â Â Â Â message: "",
Â Â Â Â Â Â Â Â Â show: true,
Â Â Â Â Â Â Â Â Â title: "An error occurred.!",
Â Â Â Â Â Â Â });
Â Â Â Â Â });
 };
...</pre>
			<p>Similar to the <code>CreatePost</code> component, we are doing checks on the validity of the form but also sending a<a id="_idIndexMarker579"/> request to the <code>/post/${postId}/comment/</code> endpoint. Then, depending on the response, we show a toast and clean the form. Letâ€™s test the form and add the first comment using React:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/pages/SinglePost.jsx</p>
			<pre class="source-code">
...
 return (
Â Â Â &lt;Layout hasNavigationBack&gt;
Â Â Â Â Â {post.data ? (
Â Â Â Â Â Â Â &lt;Row className="justify-content-center"&gt;
Â Â Â Â Â Â Â Â Â &lt;Col sm={8}&gt;
Â Â Â Â Â Â Â Â Â Â Â &lt;Post post={post.data} refresh={post.mutate}
Â Â Â Â Â Â Â Â Â Â Â Â Â isSinglePost /&gt;
Â Â Â Â Â Â Â Â Â Â Â &lt;CreateComment postId={post.data.id}
Â Â Â Â Â Â Â Â Â Â Â Â Â refresh={comments.mutate} /&gt;
Â Â Â Â Â Â Â Â Â &lt;/Col&gt;
Â Â Â Â Â Â Â &lt;/Row&gt;
Â Â Â Â Â ) : (
Â Â Â Â Â Â Â &lt;div&gt;Loading...&lt;/div&gt;
Â Â Â Â Â )}
Â Â Â &lt;/Layout&gt;
 );
...</pre>
			<p>You should have a<a id="_idIndexMarker580"/> similar result:</p>
			<div><div><img src="img/Figure_9.05_B18221.jpg" alt="Figure 9.5 â€“ Creating a comment"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.5 â€“ Creating a comment</p>
			<p>In the preceding paragraphs, we have created a page to display information about a post, thus allowing us to <a id="_idIndexMarker581"/>add a modal displaying a form to create a new comment related to this post.</p>
			<p>Now, we need to display the created comments.</p>
			<h1 id="_idParaDest-184"><a id="_idTextAnchor192"/>Listing the comments</h1>
			<p>We can create <a id="_idIndexMarker582"/>comments, but we canâ€™t see them. In <code>src/components/comments</code>, create a new file called <code>CreateComment.jsx</code>. This will contain the code for the <code>Comment</code> component that will be used to show details about a comment. Hereâ€™s a wireframe of the <code>Comment</code> component:</p>
			<div><div><img src="img/Figure_9.06_B18221.jpg" alt="Figure 9.6 â€“ Wireframe of the Comment component"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.6 â€“ Wireframe of the Comment component</p>
			<p>Letâ€™s move on to writing the code. Letâ€™s start by adding the <code>CreateComment</code> function and the imports, and <a id="_idIndexMarker583"/>defining the state that we will use in this component:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US"> src/components/comments/CreateComment.jsx</p>
			<pre class="source-code">
import React, { useState, useContext } from "react";
import { format } from "timeago.js";
import { Image, Card, Dropdown } from "react-bootstrap";
import { randomAvatar } from "../../utils";
import axiosService from "../../helpers/axios";
import { getUser } from "../../hooks/user.actions";
import UpdateComment from "./UpdateComment";
import { Context } from "../Layout";
import MoreToggleIcon from "../MoreToggleIcon";
function Comment(props) {
 const { postId, comment, refresh } = props;
 const { toaster, setToaster } = useContext(Context);
 const user = getUser();
 const handleDelete = () =&gt; {
Â Â Â Â // Handle the deletion of a comment
 };
 return (
Â Â Â &lt;Card className="rounded-3 my-2"&gt;
Â Â Â Â // Code for the comment card
Â Â Â &lt;/Card&gt;
 );
}
export default Comment;</pre>
			<p>We have the necessary<a id="_idIndexMarker584"/> imports. Letâ€™s start with the <a id="_idTextAnchor193"/>UI first. Itâ€™s a little bit like the <code>Post</code> component in its structure:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/comments/CreateComment.jsx</p>
			<pre class="source-code">
...
 return (
Â Â Â &lt;Card className="rounded-3 my-2"&gt;
Â Â Â Â Â &lt;Card.Body&gt;
Â Â Â Â Â Â Â &lt;Card.Title className="d-flex flex-row
Â Â Â Â Â Â Â Â Â justify-content-between"&gt;
Â Â Â Â Â Â Â Â Â &lt;div className="d-flex flex-row"&gt;
Â Â Â Â Â Â Â Â Â Â Â &lt;Image
Â Â Â Â Â Â Â Â Â Â Â Â Â src={randomAvatar()}
Â Â Â Â Â Â Â Â Â Â Â Â Â roundedCircle
Â Â Â Â Â Â Â Â Â Â Â Â Â width={48}
Â Â Â Â Â Â Â Â Â Â Â Â Â height={48}
Â Â Â Â Â Â Â Â Â Â Â Â Â className="me-2 border border-primary
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â border-2"
Â Â Â Â Â Â Â Â Â Â Â /&gt;
Â Â Â Â Â Â Â Â Â Â Â &lt;div className="d-flex flex-column
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â justify-content-start
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â align-self-center mt-2"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;p className="fs-6 m-0"&gt;{comment.author.name}
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/p&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;p className="fs-6 fw-lighter"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;small&gt;{format(comment.created)}&lt;/small&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/p&gt;
Â Â Â Â Â Â Â Â Â Â Â &lt;/div&gt;
Â Â Â Â Â Â Â Â Â &lt;/div&gt;
Â Â Â Â Â Â Â Â Â {user.name === comment.author.name &amp;&amp; (
Â Â Â Â Â Â Â Â Â Â Â &lt;div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Dropdown&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Dropdown.Toggle
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â as={MoreToggleIcon}&gt;&lt;/Dropdown.Toggle&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Dropdown.Menu&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Dropdown.Item&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Modify
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/Dropdown.Item&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Dropdown.<a id="_idTextAnchor194"/>Item onClick={handleDelete}
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â className="text-danger"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Delete
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/Dropdown.Item&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/Dropdown.Menu&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/Dropdown&gt;
Â Â Â Â Â Â Â Â Â Â Â &lt;/div&gt;
Â Â Â Â Â Â Â Â Â )}
Â Â Â Â Â Â Â &lt;/Card.Title&gt;
Â Â Â Â Â Â Â &lt;Card.Text&gt;{comment.body}&lt;/Card.Text&gt;
Â Â Â Â Â &lt;/Card.Body&gt;
Â Â Â &lt;/Card&gt;
 );
...</pre>
			<p>The UI for the <code>Comment</code> component is<a id="_idIndexMarker585"/> ready. Letâ€™s see the result on a post page:</p>
			<div><div><img src="img/Figure_9.07_B18221.jpg" alt="Figure 9.7 â€“ List of comments on a post"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.7 â€“ List of comments on a post</p>
			<p>We also have the <strong class="bold">More</strong> dots in the top-right corner of each component, meaning that we need to implement features for the deletion and modification of a comment. Letâ€™s add the deletion feature.</p>
			<h1 id="_idParaDest-185"><a id="_idTextAnchor195"/>Deleting a comment</h1>
			<p>The <strong class="bold">More</strong> dots menu provides two options: deleting and modifying a comment. Letâ€™s start by adding code and <a id="_idIndexMarker586"/>actions to delete a comment. The function has already been declared; we just need to add the logic:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">Src/components/comments/CreateComment.jsx</p>
			<pre class="source-code">
...
 const handleDelete = () =&gt; {
Â Â Â axiosService
Â Â Â Â Â .delete(`/post/${postId}/comment/${comment.id}/`)
Â Â Â Â Â .then(() =&gt; {
Â Â Â Â Â Â Â setToaster({
Â Â Â Â Â Â Â Â Â type: "danger",
Â Â Â Â Â Â Â Â Â message: "Comment deleted ðŸš€",
Â Â Â Â Â Â Â Â Â show: true,
Â Â Â Â Â Â Â Â Â title: "Comment Deleted",
Â Â Â Â Â Â Â });
Â Â Â Â Â Â Â refresh();
Â Â Â Â Â })
Â Â Â Â Â .catch((err) =&gt; {
Â Â Â Â Â Â Â setToaster({
Â Â Â Â Â Â Â Â Â type: "warning",
Â Â Â Â Â Â Â Â Â message: "Comment deleted ðŸš€",
Â Â Â Â Â Â Â Â Â show: true,
Â Â Â Â Â Â Â Â Â title: "Comment Deleted",
Â Â Â Â Â Â Â });
Â Â Â Â Â });
 };
...</pre>
			<p>In the <code>handleDelete</code> function, we make a request using <code>axios</code> to <code>/post/${postId}/comment/${comment.id}/</code> to delete a comment. Depending on the result of the HTTP request, we show a toaster with the correct message. Once you are done adding<a id="_idIndexMarker587"/> the code, letâ€™s test the result:</p>
			<div><div><img src="img/Figure_9.08_B18221.jpg" alt="Figure 9.8 â€“ Deleting a comment"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.8 â€“ Deleting a comment</p>
			<p>The deletion of a comment in our React application is now possible. Letâ€™s move on to adding the feature for modifying comments.</p>
			<h1 id="_idParaDest-186"><a id="_idTextAnchor196"/>Updating a comment</h1>
			<p>Updating a comment<a id="_idIndexMarker588"/> will be similar to what was done in the <code>UpdatePost.jsx</code> file. However, Iâ€™ll assist you in writing this feature for the comments. We also have an exciting element to add to our comments: liking and unliking a comment, but as an exercise. Letâ€™s focus on the modification of a comment. For this purpose, we will have to create a modal.</p>
			<h2 id="_idParaDest-187"><a id="_idTextAnchor197"/>Adding the UpdateComment modal</h2>
			<p>Inside the <code>src/components/comments</code> directory, create a file called <code>UpdateComment.jsx</code>. This file will contain the <a id="_idIndexMarker589"/>modal and the form that will allow the user to update a comment:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/comments/UpdateComment.jsx</p>
			<pre class="source-code">
import React, { useState, useContext } from "react";
import { Button, Modal, Form, Dropdown } from "react-bootstrap";
import axiosService from "../../helpers/axios";
import { Context } from "../Layout";
function UpdateComment(props) {
 const { postId, comment, refresh } = props;
 const [show, setShow] = useState(false);
 const [validated, setValidated] = useState(false);
 const [form, setForm] = useState({
Â Â Â author: comment.author.id,
Â Â Â body: comment.body,
Â Â Â post: postId
 });
 const { toaster, setToaster } = useContext(Context);
 const handleSubmit = (event) =&gt; {
Â Â Â // handle the modification of a comment
 };
 return (
Â Â Â &lt;&gt;
Â Â Â Â Â &lt;Dropdown.Item
Â Â Â Â Â Â Â onClick={handleShow}&gt;Modify&lt;/Dropdown.Item&gt;
Â Â Â Â Â // Adding the Modal here
Â Â Â &lt;/&gt;
 );
}
export default UpdateComment;</pre>
			<p>We are doing the required imports and defining the states that will be used and updated when a modification is triggered. Note<a id="_idIndexMarker590"/> that we also pass <code>postId</code> and the <code>comment</code> object as <strong class="bold">props</strong>. The first is needed for the endpoint; the second is also for the endpoint, but most importantly, to have a default value, we need to show it in the form for the user to modify.</p>
			<p>Letâ€™s add the modal UI:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/comments/UpdateComment.jsx</p>
			<pre class="source-code">
â€¦
 return (
Â Â Â &lt;&gt;
Â Â Â Â Â &lt;Dropdown.Item onClick={handleShow}&gt;Modify
Â Â Â Â Â &lt;/Dropdown.Item&gt;
Â Â Â Â Â &lt;Modal show={show} onHide={handleClose}&gt;
Â Â Â Â Â Â Â &lt;Modal.Header closeButton className="border-0"&gt;
Â Â Â Â Â Â Â Â Â &lt;Modal.Title&gt;Update Post&lt;/Modal.Title&gt;
Â Â Â Â Â Â Â &lt;/Modal.Header&gt;
Â Â Â Â Â Â Â &lt;Modal.Body className="border-0"&gt;
Â Â Â Â Â Â Â Â Â &lt;Form noValidate validated={validated}
Â Â Â Â Â Â Â Â Â Â Â onSubmit={handleSubmit}&gt;
Â Â Â Â Â Â Â Â Â Â Â &lt;Form.Group className="mb-3"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Form.Control
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â name="body"
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â value={form.body}
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â onChange={(e) =&gt; setForm({ ...form,
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â body: e.target.value })}
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â as="textarea"
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â rows={3}
Â Â Â Â Â Â Â Â Â Â Â Â Â /&gt;
Â Â Â Â Â Â Â Â Â Â Â &lt;/Form.Group&gt;
Â Â Â Â Â Â Â Â Â &lt;/Form&gt;
Â Â Â Â Â Â Â &lt;/Modal.Body&gt;
Â Â Â Â Â Â Â &lt;Modal.Footer&gt;
Â Â Â Â Â Â Â Â Â &lt;Button variant="primary" onClick={handleSubmit}&gt;
Â Â Â Â Â Â Â Â Â Â Â Modify
Â Â Â Â Â Â Â Â Â &lt;/Button&gt;
Â Â Â Â Â Â Â &lt;/Modal.Footer&gt;
Â Â Â Â Â &lt;/Modal&gt;
Â Â Â &lt;/&gt;
 );
â€¦</pre>
			<p>With the UI ready, we<a id="_idIndexMarker591"/> can now write the <code>handleSubmit</code> function:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/comments/UpdateComment.jsx</p>
			<pre class="source-code">
â€¦
 const handleSubmit = (event) =&gt; {
Â Â Â event.preventDefault();
Â Â Â const updateCommentForm = event.currentTarget;
Â Â Â if (updateCommentForm.checkValidity() === false) {
Â Â Â Â Â event.stopPropagation();
Â Â Â }
Â Â Â setValidated(true);
Â Â Â const data = {
Â Â Â Â Â author: form.author,
Â Â Â Â Â body: form.body,
Â Â Â Â Â post: postId
Â Â Â };
Â Â Â axiosService
Â Â Â Â Â .put(`/post/${postId}/comment/${comment.id}/`, data)
Â Â Â Â Â .then(() =&gt; {
Â Â Â Â Â Â Â handleClose();
Â Â Â Â Â Â Â setToaster({
Â Â Â Â Â Â Â Â Â type: "success",
Â Â Â Â Â Â Â Â Â message: "Comment updated ðŸš€",
Â Â Â Â Â Â Â Â Â show: true,
Â Â Â Â Â Â Â Â Â title: "Success!",
Â Â Â Â Â Â Â });
Â Â Â Â Â Â Â refresh();
Â Â Â Â Â })
Â Â Â Â Â .catch((error) =&gt; {
Â Â Â Â Â Â Â setToaster({
Â Â Â Â Â Â Â Â Â type: "danger",
Â Â Â Â Â Â Â Â Â message: "An error occurred.",
Â Â Â Â Â Â Â Â Â show: true,
Â Â Â Â Â Â Â Â Â title: "Comment Error",
Â Â Â Â Â Â Â });
Â Â Â Â Â });
 };
...</pre>
			<p>Letâ€™s import and add this<a id="_idIndexMarker592"/> component to the <code>Comment.jsx</code> file:</p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/comments/Comment.jsx</p>
			<pre class="source-code">
â€¦
Â Â Â Â Â Â Â Â Â {user.name === comment.author.name &amp;&amp; (
Â Â Â Â Â Â Â Â Â Â Â &lt;div&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Dropdown&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Dropdown.Toggle as={MoreToggleIcon}&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/Dropdown.Toggle&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Dropdown.Menu&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;UpdateComment
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â comment={comment}
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â refresh={refresh}
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â postId={postId}
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â /&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;Dropdown.Item onClick={handleDelete}
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â className="text-danger"&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Delete
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/Dropdown.Item&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/Dropdown.Menu&gt;
Â Â Â Â Â Â Â Â Â Â Â Â Â &lt;/Dropdown&gt;
Â Â Â Â Â Â Â Â Â Â Â &lt;/div&gt;
Â Â Â Â Â Â Â Â Â )}
Â Â Â Â Â Â Â &lt;/Card.Title&gt;
Â Â Â Â Â Â Â &lt;Card.Text&gt;{comment.body}&lt;/Card.Text&gt;
Â Â Â Â Â &lt;/Card.Body&gt;
Â Â Â &lt;/Card&gt;
â€¦</pre>
			<p>After adding this piece of code, once you click on the <strong class="bold">Modify</strong> option of the <strong class="bold">More</strong> menu, a modal will appear, like in the following figure:</p>
			<div><div><img src="img/Figure_9.09_B18221.jpg" alt="Figure 9.9 â€“ Modify comment modal"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.9 â€“ Modify comment modal</p>
			<p>If the modification is<a id="_idIndexMarker593"/> submitted and successful, a toast will appear at the top of the page:</p>
			<div><div><img src="img/Figure_9.10_B18221.jpg" alt="Figure 9.10 â€“ Toast showing successful comment modification"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.10 â€“ Toast showing successful comment modification</p>
			<p>Nice! We have completed working on CRUD actions for the comment feature. An exciting feature to have for the comments is the possibility to like a comment. It is similar to what we have done for<a id="_idIndexMarker594"/> the posts. This is the next step for this chapter, but also an exercise.</p>
			<h1 id="_idParaDest-188"><a id="_idTextAnchor198"/>Liking a comment</h1>
			<p>Adding the <strong class="bold">Like</strong> feature to the <strong class="bold">Comment</strong> feature <a id="_idIndexMarker595"/>will require some changes to the Django API and some code t<a id="_idTextAnchor199"/>o be added to the React application. First, le<a id="_idTextAnchor200"/>t me provide you with the final result:</p>
			<div><div><img src="img/Figure_9.11_B18221.jpg" alt="Figure 9.11 â€“ Comments with the Like feature and likes count"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.11 â€“ Comments with the Like feature and likes count</p>
			<p>Here is a list of the requirements of the feature:</p>
			<ul>
				<li>The user can see the number of likes on a comment</li>
				<li>The user can like a comment</li>
				<li>The user can remove a like from a comment</li>
			</ul>
			<p>This will require some tweaks on the Django API as well. Feel free to get inspired by what weâ€™ve done for the post feature.</p>
			<p>Good luck with the exercise. You can find the solution at <a href="https://github.com/PacktPublishing/Full-stack-Django-and-React/blob/main/social-media-react/src/components/comments/Comment.jsx">https://github.com/PacktPublishing/Full-stack-Django-and-React/blob/main/social-media-react/src/components/comments/Comment.jsx</a>.</p>
			<p>After adding the <strong class="bold">Like</strong> feature to <a id="_idIndexMarker596"/>comments, we are now ready to finally add CRUD operations to the profile of the React application. We will create a profile page and allow the user to edit the information in their profile. We will also enable the user to update their avatar and set a default avatar image for users.</p>
			<h1 id="_idParaDest-189"><a id="_idTextAnchor201"/>Summary</h1>
			<p>In this chapter, we focused on adding CRUD operations to the comments feature. Weâ€™ve learned how to play with <code>react-router</code> Hooks to retrieve parameters and use them in the code. Weâ€™ve also added a <code>useState</code> and <code>useContext</code> Hooks and the way they affect a state in React. We have also learned how to create a dropdown component, how to use the custom toaster, and how to tweak a component to fits some requirements.</p>
			<p>In the next chapter, weâ€™ll focus on CRUD operations on the user profile, and we will also learn how to upload a profile picture.</p>
			<h1 id="_idParaDest-190"><a id="_idTextAnchor202"/>Questions</h1>
			<ol>
				<li>What is the usage of <code>useParams</code>?</li>
				<li>How do you write a route in React that can support parameter passing?</li>
				<li>What is the use of the <code>useContext</code> Hook?</li>
			</ol>
		</div>
	</body></html>