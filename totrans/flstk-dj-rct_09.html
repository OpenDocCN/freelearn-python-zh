<html><head></head><body>
		<div id="_idContainer111">
			<h1 id="_idParaDest-176" class="chapter-number"><a id="_idTextAnchor182"/>9</h1>
			<h1 id="_idParaDest-177"><a id="_idTextAnchor183"/>Post Comments</h1>
			<p>An exciting part of every social media platform is the comment functionality. In the previous chapter, we’ve added post creation, listing, update, and deletion functionality. This chapter will cover a comment’s creation, listing, update, and deletion. We will create a page to display information about a post, add components to list comments, add a modal to display a form to create comments and add a dropdown to allow the user to delete or modify a comment. At the end of this chapter, you will learn how to navigate to a single page with URL parameters using React and <span class="No-Break">React Router.</span></p>
			<p>In this chapter, we will cover the <span class="No-Break">following topics:</span></p>
			<ul>
				<li>Listing comments on a <span class="No-Break">post page</span></li>
				<li>Creating a comment using <span class="No-Break">a form</span></li>
				<li>Editing and deleting <span class="No-Break">a comment</span></li>
				<li>Updating <span class="No-Break">a comment</span></li>
			</ul>
			<h1 id="_idParaDest-178">Technical <a id="_idTextAnchor184"/>requirements</h1>
			<p>Make sure to have VS Code and an updated browser installed and configured on your machine. You can find the code of this chapter <span class="No-Break">at </span><a href="https://github.com/PacktPublishing/Full-stack-Django-and-React/tree/chap9"><span class="No-Break">https://github.com/PacktPublishing/Full-stack-Django-and-React/tree/chap9</span></a><span class="No-Break">.</span></p>
			<h1 id="_idParaDest-179"><a id="_idTextAnchor185"/>Creating a UI</h1>
			<p>In the next paragraphs, we will modify the <strong class="source-inline">Post</strong> component for consistency when displaying a single post, add a <strong class="bold">Back</strong> button on the layout so the user can go back to the home page, and finally, add <a id="_idIndexMarker550"/>CRUD features, a little bit similar to the <strong class="source-inline">Post</strong> components. Before listing the comments, we need to ensure that the user can create comments. This will require building a page called <strong class="source-inline">SinglePost</strong> that will show details about a post and <span class="No-Break">the comments.</span></p>
			<p>Let’s look at the UI of the page in the <span class="No-Break">following figure:</span></p>
			<div>
				<div id="_idContainer100" class="IMG---Figure">
					<img src="image/Figure_9.01_B18221.jpg" alt="Figure 9.1 – ﻿Result of the SinglePost page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.1 – <a id="_idTextAnchor186"/>Result of the SinglePost page</p>
			<p>The UI in the preceding figure <a id="_idIndexMarker551"/>gives us a good idea of the result. When the page is built and the user clicks on a comment, a modal will appear, and the user will be able to create a comment. Let’s stick to this case first, and we’ll explore the other CRUD <span class="No-Break">operations later.</span></p>
			<p>Notice that we also have a back button in the top-left corner of the page – something to add to the <strong class="source-inline">Layout</strong> component. We will start by making some tweaks to the <strong class="source-inline">Post.jsx</strong> component first. This is because we are going to reuse the <strong class="source-inline">Post</strong> component, but we will mask options such as comment count<a id="_idTextAnchor187"/> and the <strong class="bold">Comment</strong> icon. After modifying the component, we will create a page displaying one article <span class="No-Break">and comments.</span></p>
			<h2 id="_idParaDest-180"><a id="_idTextAnchor188"/>Tweaking the Post component</h2>
			<p>The <strong class="source-inline">Post</strong> component will be simply reused<a id="_idIndexMarker552"/> to display more<a id="_idIndexMarker553"/> information about the post. Following the UI in <span class="No-Break"><em class="italic">Figure 9</em></span><em class="italic">.1</em>, we will just mask the number of comments on the post and the <span class="No-Break"><strong class="bold">Comment</strong></span><span class="No-Break"> icon.</span></p>
			<p>Inside <strong class="source-inline">Post.jsx</strong>, we will add another prop called <strong class="source-inline">isSinglePost</strong>. When this prop is <strong class="source-inline">true</strong>, it means that we are showing the component on the <span class="No-Break"><strong class="source-inline">SinglePost</strong></span><span class="No-Break"> page:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/posts/Post.jsx</p>
			<pre class="source-code">
...
function Post(props) {
<strong class="bold"> const { post, refresh, isSinglePost } = props;</strong>
...
 return (
   &lt;&gt;
    ...
            {!isSinglePost &amp;&amp; (
             &lt;p className="ms-1 fs-6"&gt;
               &lt;small&gt;
                 &lt;Link&gt;
                   {post.comments_count} comments
                 &lt;/Link&gt;
               &lt;/small&gt;
             &lt;/p&gt;
           )}
   ...
                {!isSinglePost &amp;&amp; (
           &lt;div className="d-flex flex-row"&gt;
             &lt;CommentOutlined
               style={{
                 width: "24px",
                 height: "24px",
                 padding: "2px",
                 fontSize: "20px",
                 color: "#C4C4C4",
               }}
             /&gt;
             &lt;p className="ms-1 mb-0"&gt;
               &lt;small&gt;Comment&lt;/small&gt;
             &lt;/p&gt;
           &lt;/div&gt;
         )}
...</pre>
			<p>With the modification<a id="_idIndexMarker554"/> done to the <strong class="source-inline">Post</strong> component, we can now add the back<a id="_idIndexMarker555"/> button to the <span class="No-Break"><strong class="source-inline">Layout</strong></span><span class="No-Break"> component.</span></p>
			<h2 id="_idParaDest-181"><a id="_idTextAnchor189"/>Adding a back button to the Layout component</h2>
			<p>The back button has the<a id="_idIndexMarker556"/> role of navigating the user to the preceding page if the action<a id="_idIndexMarker557"/> is initiated. An interesting idea about doing that is to add the actual path to the component where a go-back action can happen. However, it’ll require a lot of code and will introduce <span class="No-Break">some complexity.</span></p>
			<p>Thankfully, the <strong class="source-inline">react-router</strong> library provides a simple way to navigate to the preceding page in just <span class="No-Break">one line:</span></p>
			<p><span class="No-Break"><strong class="bold">navigate(-1)</strong></span></p>
			<p>Yes! Let’s add this function to the <span class="No-Break"><strong class="source-inline">Layout.jsx</strong></span><span class="No-Break"> component:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/Layout.jsx</p>
			<pre class="source-code">
import { ArrowLeftOutlined } from "@ant-design/icons";
import { useNavigate } from "react-router-dom";
function Layout(props) {
 const { hasNavigationBack } = props;
 const navigate = useNavigate();
...
  return (
     &lt;div&gt;
       &lt;Navigationbar /&gt;
       {hasNavigationBack &amp;&amp; (
         &lt;ArrowLeftOutlined
           style={{
             color: "#0D6EFD",
             fontSize: "24px",
             marginLeft: "5%",
             marginTop: "1%",
           }}
           onClick={() =&gt; navigate(-1)}
         /&gt;
       )}
       &lt;div className="container my-2"&gt;
           {props.children}
       &lt;/div&gt;
...</pre>
			<p>In the preceding code, we <a id="_idIndexMarker558"/>added a prop called <strong class="source-inline">hasNavigationBack</strong>. This prop will tell <a id="_idIndexMarker559"/>React whether it should render the icon to nagivate back to the precedent page. The rendering process is done in the JSX code, using conditional. If <strong class="source-inline">hasNavigationBack</strong> is <strong class="source-inline">true</strong>, we show the <strong class="bold">Back</strong> icon, and the user <span class="No-Break">can navigate.</span></p>
			<p>With the option <a id="_idIndexMarker560"/>of going back <a id="_idIndexMarker561"/>added, we can now move to write the <span class="No-Break"><strong class="source-inline">SinglePost.jsx</strong></span><span class="No-Break"> page.</span></p>
			<h2 id="_idParaDest-182"><a id="_idTextAnchor190"/>Creating the SinglePost component</h2>
			<p>In the <strong class="source-inline">src/pages</strong> directory, create a new file called <strong class="source-inline">SinglePost.jsx</strong>. This file will contain the code to display <a id="_idIndexMarker562"/>information about a post and, most importantly, the comments. The <a id="_idIndexMarker563"/>following figure shows a simple wireframe of the page so we can have an idea about the layout of <span class="No-Break">the components:</span></p>
			<div>
				<div id="_idContainer101" class="IMG---Figure">
					<img src="image/Figure_9.02_B18221.jpg" alt="Figure 9.2 – Wireframe of the SinglePost page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.2 – Wireframe of the SinglePost page</p>
			<p>Let’s move the file and start coding. In the following snippet, we will create the <strong class="source-inline">SinglePost</strong> page, add the imports, and <a id="_idIndexMarker564"/>define the functions and states that will be <a id="_idIndexMarker565"/>used on <span class="No-Break">the page:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/pages/SinglePost.jsx</p>
			<pre class="source-code">
import React from "react";
import Layout from "../components/Layout";
import { Row, Col } from "react-bootstrap";
import { useParams } from "react-router-dom";
import useSWR from "swr";
import { fetcher } from "../helpers/axios";
import { Post } from "../components/posts";
import CreateComment from "../components/comments/CreateComment";
import Comment from "../components/comments/Comment";
function SinglePost() {
 let { postId } = useParams();
 const post = useSWR(`/post/${postId}/`, fetcher);
 const comments = useSWR(`/post/${postId}/comment/`, fetcher);
 return (
   &lt;Layout hasNavigationBack&gt;
     {post.data ? (
       &lt;Row className="justify-content-center"&gt;
         &lt;Col sm={8}&gt;
           &lt;Post post={post.data} refresh={post.mutate}              isSinglePost /&gt;
           // Adding CreateComment form and list all comments               here
         &lt;/Col&gt;
       &lt;/Row&gt;
     ) : (
       &lt;div&gt;Loading...&lt;/div&gt;
     )}
   &lt;/Layout&gt;
 );
}
export default SinglePost;</pre>
			<p>We are using the <strong class="source-inline">Row</strong> and <strong class="source-inline">Col</strong> feature from <strong class="source-inline">react-bootstrap</strong> again. This structure will help us have one<a id="_idIndexMarker566"/> column taking 8/12 of the layout and having objects centered. Next, we need a form for <span class="No-Break">comment creation.</span></p>
			<p>We are also using a new Hook, <strong class="source-inline">useParams</strong>. As stated in the official documentation, the <strong class="source-inline">useParams</strong> Hook <a id="_idIndexMarker567"/>returns an object of <strong class="bold">key/value</strong> pairs of the dynamic params from the current URL that was matched by <strong class="source-inline">&lt;Route path&gt;</strong>. Child routes inherit all parameters from their <span class="No-Break">parent routes.</span></p>
			<p>A little bit complicated to grasp, but let’s register this page and load it in the browser. Inside the <strong class="source-inline">App.jsx</strong> file, add a <span class="No-Break">new route:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/App.jsx</p>
			<pre class="source-code">
...
function App() {
 return (
   &lt;Routes&gt;
     &lt;Route
       path="/"
       element={
         &lt;ProtectedRoute&gt;
           &lt;Home /&gt;
         &lt;/ProtectedRoute&gt;
       }
     /&gt;
     <strong class="bold">&lt;Route</strong>
<strong class="bold">       path="/post/:postId/"</strong>
<strong class="bold">       element={</strong>
<strong class="bold">         &lt;ProtectedRoute&gt;</strong>
<strong class="bold">           &lt;SinglePost /&gt;</strong>
<strong class="bold">         &lt;/ProtectedRoute&gt;</strong>
<strong class="bold">       }</strong>
<strong class="bold">     /&gt;</strong>
...</pre>
			<p>The path of the newly added<a id="_idIndexMarker568"/> route has an interesting pattern with the<a id="_idIndexMarker569"/> addition of <strong class="source-inline">postId</strong>. We can tell <strong class="source-inline">react-router</strong> to expect a parameter that will be passed, and this parameter will then be available in the <span class="No-Break"><strong class="source-inline">useParams</strong></span><span class="No-Break"> Hook.</span></p>
			<p>Let’s add the redirection to the <strong class="source-inline">SinglePost</strong> page in the <span class="No-Break"><strong class="source-inline">Post</strong></span><span class="No-Break"> component:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/posts/CreatePost.jsx</p>
			<pre class="source-code">
return (
   &lt;&gt;
    ...
            {!isSinglePost &amp;&amp; (
             &lt;p className="ms-1 fs-6"&gt;
<strong class="bold">               &lt;small&gt;</strong>
<strong class="bold">                 &lt;Link to={`/post/${post.id}/`}&gt;</strong>
<strong class="bold">                   {post.comments_count} comments</strong>
<strong class="bold">                 &lt;/Link&gt;</strong>
<strong class="bold">               &lt;/small&gt;</strong>
             &lt;/p&gt;
           )}
    ...</pre>
			<p>Inside<a id="_idIndexMarker570"/> the <strong class="source-inline">SinglePost.jsx</strong> file, add <a id="_idIndexMarker571"/>a <strong class="source-inline">console</strong> log <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">useParams()</strong></span><span class="No-Break">:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/pages/SinglePost.jsx</p>
			<pre class="source-code">
...
function SinglePost() {
<strong class="bold"> console.log(useParams())</strong>
<strong class="bold"> let { postId } = useParams();</strong>
...</pre>
			<p>Go into the browser and click on a post to access the <strong class="source-inline">SinglePost</strong> page. You will have a <span class="No-Break">similar result:</span></p>
			<div>
				<div id="_idContainer102" class="IMG---Figure">
					<img src="image/Figure_9.03_B18221.jpg" alt="Figure 9.3 – Post page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.3 – Post page</p>
			<p>Check the browser console to see the content <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">useParams()</strong></span><span class="No-Break">:</span></p>
			<div>
				<div id="_idContainer103" class="IMG---Figure">
					<img src="image/Figure_9.04_B18221.jpg" alt="Figure 9.4 – Content of useParams()"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.4 – Content of useParams()</p>
			<p>We have an<a id="_idIndexMarker572"/> object containing the <strong class="source-inline">postId</strong> value. With <strong class="source-inline">useParams()</strong> explained, let’s move <a id="_idIndexMarker573"/>on to add the <span class="No-Break"><strong class="source-inline">CreateComment</strong></span><span class="No-Break"> form.</span></p>
			<h2 id="_idParaDest-183"><a id="_idTextAnchor191"/>Creating a comment</h2>
			<p>Inside the <strong class="source-inline">src/components</strong> directory, create a<a id="_idIndexMarker574"/> new directory called <strong class="source-inline">comments</strong>. This <a id="_idIndexMarker575"/>directory will contain the code for the <strong class="source-inline">comments</strong> feature components. Inside the newly created directory, create a new file called <strong class="source-inline">CreateComment.jsx</strong>. This component represents the form that the user will use to add comments to <span class="No-Break">a post.</span></p>
			<p>Once the file is created, add the <span class="No-Break">required imports:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/comments/CreateComment.jsx</p>
			<pre class="source-code">
import React, { useState, useContext } from "react";
import { Button, Form, Image } from "react-bootstrap";
import axiosService from "../../helpers/axios";
import { getUser } from "../../hooks/user.actions";
import { randomAvatar } from "../../utils";
import { Context } from "../Layout";
function CreateComment(props) {
 const { postId, refresh } = props;
 return (
   &lt;Form&gt;
   &lt;/Form&gt;
 );
}
export default CreateComment;</pre>
			<p>On the <strong class="source-inline">CreateComment</strong> page, we are going to show toast notifications when a CRUD action is made. That means that we are going to use the <strong class="source-inline">Context</strong> <span class="No-Break">method again.</span></p>
			<p>Let’s start by defining the props<a id="_idIndexMarker576"/> and creating <strong class="source-inline">handleSubmit</strong>. This process will be pretty similar to what we’ve done in the <span class="No-Break"><strong class="source-inline">CreatePost</strong></span><span class="No-Break"> component:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/comments/CreateComment</p>
			<pre class="source-code">
...
function CreateComment(props) {
 const { postId, refresh } = props;
 const [avatar, setAvatar] = useState(randomAvatar());
 const [validated, setValidated] = useState(false);
 const [form, setForm] = useState({});
 const { toaster, setToaster } = useContext(Context);
 const user = getUser();
 const handleSubmit = (event) =&gt; {
   // Logic to handle form submission
 };
...</pre>
			<p>Let’s now<a id="_idIndexMarker577"/> add the <span class="No-Break"><strong class="source-inline">Form</strong></span><span class="No-Break"> UI:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/component/comments/CreateComment.jsx</p>
			<pre class="source-code">
...
return (
   &lt;Form
     className="d-flex flex-row justify-content-between"
     noValidate
     validated={validated}
     onSubmit={handleSubmit}
   &gt;
     &lt;Image
       src={avatar}
       roundedCircle
       width={48}
       height={48}
       className="my-2"
     /&gt;
     &lt;Form.Group className="m-3 w-75"&gt;
       &lt;Form.Control
         className="py-2 rounded-pill border-primary"
         type="text"
         placeholder="Write a comment"
         value={form.body}
         name="body"
         onChange={(e) =&gt; setForm({ ...form,
                                   body: e.target.value })}
       /&gt;
     &lt;/Form.Group&gt;
     &lt;div className="m-auto"&gt;
       &lt;Button
         variant="primary"
         onClick={handleSubmit}
         disabled={form.body === undefined}
         size="small"
       &gt;
         Comment
       &lt;/Button&gt;
     &lt;/div&gt;
   &lt;/Form&gt;
 );
...</pre>
			<p>With the UI added, we<a id="_idIndexMarker578"/> can write the <span class="No-Break"><strong class="source-inline">handeSubmit</strong></span><span class="No-Break"> method:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/component/comments/CreateComment.jsx</p>
			<pre class="source-code">
...
 const handleSubmit = (event) =&gt; {
   event.preventDefault();
   const createCommentForm = event.currentTarget;
   if (createCommentForm.checkValidity() === false) {
     event.stopPropagation();
   }
   setValidated(true);
   const data = {
     author: user.id,
     body: form.body,
     post: postId,
   };
   axiosService
     .post(`/post/${postId}/comment/`, data)
     .then(() =&gt; {
       setForm({ ...form, body: "" });
       setToaster({
         type: "success",
         message: "Comment posted successfully🚀",
         show: true,
         title: "Comment!",
       });
       refresh();
     })
     .catch(() =&gt; {
       setToaster({
         type: "danger",
         message: "",
         show: true,
         title: "An error occurred.!",
       });
     });
 };
...</pre>
			<p>Similar to the <strong class="source-inline">CreatePost</strong> component, we are doing checks on the validity of the form but also sending a<a id="_idIndexMarker579"/> request to the <strong class="source-inline">/post/${postId}/comment/</strong> endpoint. Then, depending on the response, we show a toast and clean the form. Let’s test the form and add the first comment <span class="No-Break">using React:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/pages/SinglePost.jsx</p>
			<pre class="source-code">
...
 return (
   &lt;Layout hasNavigationBack&gt;
     {post.data ? (
       &lt;Row className="justify-content-center"&gt;
         &lt;Col sm={8}&gt;
           &lt;Post post={post.data} refresh={post.mutate}
             isSinglePost /&gt;
           &lt;CreateComment postId={post.data.id}
             refresh={comments.mutate} /&gt;
         &lt;/Col&gt;
       &lt;/Row&gt;
     ) : (
       &lt;div&gt;Loading...&lt;/div&gt;
     )}
   &lt;/Layout&gt;
 );
...</pre>
			<p>You should have a<a id="_idIndexMarker580"/> <span class="No-Break">similar result:</span></p>
			<div>
				<div id="_idContainer104" class="IMG---Figure">
					<img src="image/Figure_9.05_B18221.jpg" alt="Figure 9.5 – Creating a comment"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.5 – Creating a comment</p>
			<p>In the preceding paragraphs, we have created a page to display information about a post, thus allowing us to <a id="_idIndexMarker581"/>add a modal displaying a form to create a new comment related to <span class="No-Break">this post.</span></p>
			<p>Now, we need to display the <span class="No-Break">created comments.</span></p>
			<h1 id="_idParaDest-184"><a id="_idTextAnchor192"/>Listing the comments</h1>
			<p>We can create <a id="_idIndexMarker582"/>comments, but we can’t see them. In <strong class="source-inline">src/components/comments</strong>, create a new file called <strong class="source-inline">CreateComment.jsx</strong>. This will contain the code for the <strong class="source-inline">Comment</strong> component that will be used to show details about a comment. Here’s a wireframe of the <span class="No-Break"><strong class="source-inline">Comment</strong></span><span class="No-Break"> component:</span></p>
			<div>
				<div id="_idContainer105" class="IMG---Figure">
					<img src="image/Figure_9.06_B18221.jpg" alt="Figure 9.6 – Wireframe of the Comment component"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.6 – Wireframe of the Comment component</p>
			<p>Let’s move on to writing the code. Let’s start by adding the <strong class="source-inline">CreateComment</strong> function and the imports, and <a id="_idIndexMarker583"/>defining the state that we will use in <span class="No-Break">this component:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US"> src/components/comments/CreateComment.jsx</p>
			<pre class="source-code">
import React, { useState, useContext } from "react";
import { format } from "timeago.js";
import { Image, Card, Dropdown } from "react-bootstrap";
import { randomAvatar } from "../../utils";
import axiosService from "../../helpers/axios";
import { getUser } from "../../hooks/user.actions";
import UpdateComment from "./UpdateComment";
import { Context } from "../Layout";
import MoreToggleIcon from "../MoreToggleIcon";
function Comment(props) {
 const { postId, comment, refresh } = props;
 const { toaster, setToaster } = useContext(Context);
 const user = getUser();
 const handleDelete = () =&gt; {
    // Handle the deletion of a comment
 };
 return (
   &lt;Card className="rounded-3 my-2"&gt;
    // Code for the comment card
   &lt;/Card&gt;
 );
}
export default Comment;</pre>
			<p>We have the necessary<a id="_idIndexMarker584"/> imports. Let’s start with the <a id="_idTextAnchor193"/>UI first. It’s a little bit like the <strong class="source-inline">Post</strong> component in <span class="No-Break">its structure:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/comments/CreateComment.jsx</p>
			<pre class="source-code">
...
 return (
   &lt;Card className="rounded-3 my-2"&gt;
     &lt;Card.Body&gt;
       &lt;Card.Title className="d-flex flex-row
         justify-content-between"&gt;
         &lt;div className="d-flex flex-row"&gt;
           &lt;Image
             src={randomAvatar()}
             roundedCircle
             width={48}
             height={48}
             className="me-2 border border-primary
                        border-2"
           /&gt;
           &lt;div className="d-flex flex-column
               justify-content-start
               align-self-center mt-2"&gt;
             &lt;p className="fs-6 m-0"&gt;{comment.author.name}
             &lt;/p&gt;
             &lt;p className="fs-6 fw-lighter"&gt;
               &lt;small&gt;{format(comment.created)}&lt;/small&gt;
             &lt;/p&gt;
           &lt;/div&gt;
         &lt;/div&gt;
         {user.name === comment.author.name &amp;&amp; (
           &lt;div&gt;
             &lt;Dropdown&gt;
               &lt;Dropdown.Toggle
                 as={MoreToggleIcon}&gt;&lt;/Dropdown.Toggle&gt;
               &lt;Dropdown.Menu&gt;
                 &lt;Dropdown.Item&gt;
                   Modify
                 &lt;/Dropdown.Item&gt;
                 &lt;Dropdown.<a id="_idTextAnchor194"/>Item onClick={handleDelete}
                   className="text-danger"&gt;
                   Delete
                 &lt;/Dropdown.Item&gt;
               &lt;/Dropdown.Menu&gt;
             &lt;/Dropdown&gt;
           &lt;/div&gt;
         )}
       &lt;/Card.Title&gt;
       &lt;Card.Text&gt;{comment.body}&lt;/Card.Text&gt;
     &lt;/Card.Body&gt;
   &lt;/Card&gt;
 );
...</pre>
			<p>The UI for the <strong class="source-inline">Comment</strong> component is<a id="_idIndexMarker585"/> ready. Let’s see the result on a <span class="No-Break">post page:</span></p>
			<div>
				<div id="_idContainer106" class="IMG---Figure">
					<img src="image/Figure_9.07_B18221.jpg" alt="Figure 9.7 – List of comments on a post"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.7 – List of comments on a post</p>
			<p>We also have the <strong class="bold">More</strong> dots in the top-right corner of each component, meaning that we need to implement features for the deletion and modification of a comment. Let’s add the <span class="No-Break">deletion feature.</span></p>
			<h1 id="_idParaDest-185"><a id="_idTextAnchor195"/>Deleting a comment</h1>
			<p>The <strong class="bold">More</strong> dots menu provides two options: deleting and modifying a comment. Let’s start by adding code and <a id="_idIndexMarker586"/>actions to delete a comment. The function has already been declared; we just need to add <span class="No-Break">the logic:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">Src/components/comments/CreateComment.jsx</p>
			<pre class="source-code">
...
 const handleDelete = () =&gt; {
   axiosService
     .delete(`/post/${postId}/comment/${comment.id}/`)
     .then(() =&gt; {
       setToaster({
         type: "danger",
         message: "Comment deleted 🚀",
         show: true,
         title: "Comment Deleted",
       });
       refresh();
     })
     .catch((err) =&gt; {
       setToaster({
         type: "warning",
         message: "Comment deleted 🚀",
         show: true,
         title: "Comment Deleted",
       });
     });
 };
...</pre>
			<p>In the <strong class="source-inline">handleDelete</strong> function, we make a request using <strong class="source-inline">axios</strong> to <strong class="source-inline">/post/${postId}/comment/${comment.id}/</strong> to delete a comment. Depending on the result of the HTTP request, we show a toaster with the correct message. Once you are done adding<a id="_idIndexMarker587"/> the code, let’s test <span class="No-Break">the result:</span></p>
			<div>
				<div id="_idContainer107" class="IMG---Figure">
					<img src="image/Figure_9.08_B18221.jpg" alt="Figure 9.8 – Deleting a comment"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.8 – Deleting a comment</p>
			<p>The deletion of a comment in our React application is now possible. Let’s move on to adding the feature for <span class="No-Break">modifying comments.</span></p>
			<h1 id="_idParaDest-186"><a id="_idTextAnchor196"/>Updating a comment</h1>
			<p>Updating a comment<a id="_idIndexMarker588"/> will be similar to what was done in the <strong class="source-inline">UpdatePost.jsx</strong> file. However, I’ll assist you in writing this feature for the comments. We also have an exciting element to add to our comments: liking and unliking a comment, but as an exercise. Let’s focus on the modification of a comment. For this purpose, we will have to create <span class="No-Break">a modal.</span></p>
			<h2 id="_idParaDest-187"><a id="_idTextAnchor197"/>Adding the UpdateComment modal</h2>
			<p>Inside the <strong class="source-inline">src/components/comments</strong> directory, create a file called <strong class="source-inline">UpdateComment.jsx</strong>. This file will contain the <a id="_idIndexMarker589"/>modal and the form that will allow the user to update <span class="No-Break">a comment:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/comments/UpdateComment.jsx</p>
			<pre class="source-code">
import React, { useState, useContext } from "react";
import { Button, Modal, Form, Dropdown } from "react-bootstrap";
import axiosService from "../../helpers/axios";
import { Context } from "../Layout";
function UpdateComment(props) {
 const { postId, comment, refresh } = props;
 const [show, setShow] = useState(false);
 const [validated, setValidated] = useState(false);
 const [form, setForm] = useState({
   author: comment.author.id,
   body: comment.body,
   post: postId
 });
 const { toaster, setToaster } = useContext(Context);
 const handleSubmit = (event) =&gt; {
   // handle the modification of a comment
 };
 return (
   &lt;&gt;
     &lt;Dropdown.Item
       onClick={handleShow}&gt;Modify&lt;/Dropdown.Item&gt;
     // Adding the Modal here
   &lt;/&gt;
 );
}
export default UpdateComment;</pre>
			<p>We are doing the required imports and defining the states that will be used and updated when a modification is triggered. Note<a id="_idIndexMarker590"/> that we also pass <strong class="source-inline">postId</strong> and the <strong class="source-inline">comment</strong> object as <strong class="bold">props</strong>. The first is needed for the endpoint; the second is also for the endpoint, but most importantly, to have a default value, we need to show it in the form for the user <span class="No-Break">to modify.</span></p>
			<p>Let’s add the <span class="No-Break">modal UI:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/comments/UpdateComment.jsx</p>
			<pre class="source-code">
…
 return (
   &lt;&gt;
     &lt;Dropdown.Item onClick={handleShow}&gt;Modify
     &lt;/Dropdown.Item&gt;
     &lt;Modal show={show} onHide={handleClose}&gt;
       &lt;Modal.Header closeButton className="border-0"&gt;
         &lt;Modal.Title&gt;Update Post&lt;/Modal.Title&gt;
       &lt;/Modal.Header&gt;
       &lt;Modal.Body className="border-0"&gt;
         &lt;Form noValidate validated={validated}
           onSubmit={handleSubmit}&gt;
           &lt;Form.Group className="mb-3"&gt;
             &lt;Form.Control
               name="body"
               value={form.body}
               onChange={(e) =&gt; setForm({ ...form,
                 body: e.target.value })}
               as="textarea"
               rows={3}
             /&gt;
           &lt;/Form.Group&gt;
         &lt;/Form&gt;
       &lt;/Modal.Body&gt;
       &lt;Modal.Footer&gt;
         &lt;Button variant="primary" onClick={handleSubmit}&gt;
           Modify
         &lt;/Button&gt;
       &lt;/Modal.Footer&gt;
     &lt;/Modal&gt;
   &lt;/&gt;
 );
…</pre>
			<p>With the UI ready, we<a id="_idIndexMarker591"/> can now write the <span class="No-Break"><strong class="source-inline">handleSubmit</strong></span><span class="No-Break"> function:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/comments/UpdateComment.jsx</p>
			<pre class="source-code">
…
 const handleSubmit = (event) =&gt; {
   event.preventDefault();
   const updateCommentForm = event.currentTarget;
   if (updateCommentForm.checkValidity() === false) {
     event.stopPropagation();
   }
   setValidated(true);
   const data = {
     author: form.author,
     body: form.body,
     post: postId
   };
   axiosService
     .put(`/post/${postId}/comment/${comment.id}/`, data)
     .then(() =&gt; {
       handleClose();
       setToaster({
         type: "success",
         message: "Comment updated 🚀",
         show: true,
         title: "Success!",
       });
       refresh();
     })
     .catch((error) =&gt; {
       setToaster({
         type: "danger",
         message: "An error occurred.",
         show: true,
         title: "Comment Error",
       });
     });
 };
...</pre>
			<p>Let’s import and add this<a id="_idIndexMarker592"/> component to the <span class="No-Break"><strong class="source-inline">Comment.jsx</strong></span><span class="No-Break"> file:</span></p>
			<p class="SC---Heading" lang="en-US" xml:lang="en-US">src/components/comments/Comment.jsx</p>
			<pre class="source-code">
…
         {user.name === comment.author.name &amp;&amp; (
           &lt;div&gt;
             &lt;Dropdown&gt;
               &lt;Dropdown.Toggle as={MoreToggleIcon}&gt;
               &lt;/Dropdown.Toggle&gt;
               &lt;Dropdown.Menu&gt;
                 &lt;UpdateComment
                   comment={comment}
                   refresh={refresh}
                   postId={postId}
                 /&gt;
                 &lt;Dropdown.Item onClick={handleDelete}
                   className="text-danger"&gt;
                   Delete
                 &lt;/Dropdown.Item&gt;
               &lt;/Dropdown.Menu&gt;
             &lt;/Dropdown&gt;
           &lt;/div&gt;
         )}
       &lt;/Card.Title&gt;
       &lt;Card.Text&gt;{comment.body}&lt;/Card.Text&gt;
     &lt;/Card.Body&gt;
   &lt;/Card&gt;
…</pre>
			<p>After adding this piece of code, once you click on the <strong class="bold">Modify</strong> option of the <strong class="bold">More</strong> menu, a modal will appear, like in the <span class="No-Break">following figure:</span></p>
			<div>
				<div id="_idContainer108" class="IMG---Figure">
					<img src="image/Figure_9.09_B18221.jpg" alt="Figure 9.9 – Modify comment modal"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.9 – Modify comment modal</p>
			<p>If the modification is<a id="_idIndexMarker593"/> submitted and successful, a toast will appear at the top of <span class="No-Break">the page:</span></p>
			<div>
				<div id="_idContainer109" class="IMG---Figure">
					<img src="image/Figure_9.10_B18221.jpg" alt="Figure 9.10 – Toast showing successful comment modification"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.10 – Toast showing successful comment modification</p>
			<p>Nice! We have completed working on CRUD actions for the comment feature. An exciting feature to have for the comments is the possibility to like a comment. It is similar to what we have done for<a id="_idIndexMarker594"/> the posts. This is the next step for this chapter, but also <span class="No-Break">an exercise.</span></p>
			<h1 id="_idParaDest-188"><a id="_idTextAnchor198"/>Liking a comment</h1>
			<p>Adding the <strong class="bold">Like</strong> feature to the <strong class="bold">Comment</strong> feature <a id="_idIndexMarker595"/>will require some changes to the Django API and some code t<a id="_idTextAnchor199"/>o be added to the React application. First, le<a id="_idTextAnchor200"/>t me provide you with the <span class="No-Break">final result:</span></p>
			<div>
				<div id="_idContainer110" class="IMG---Figure">
					<img src="image/Figure_9.11_B18221.jpg" alt="Figure 9.11 – Comments with the Like feature and likes count"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 9.11 – Comments with the Like feature and likes count</p>
			<p>Here is a list of the requirements of <span class="No-Break">the feature:</span></p>
			<ul>
				<li>The user can see the number of likes on <span class="No-Break">a comment</span></li>
				<li>The user can like <span class="No-Break">a comment</span></li>
				<li>The user can remove a like from <span class="No-Break">a comment</span></li>
			</ul>
			<p>This will require some tweaks on the Django API as well. Feel free to get inspired by what we’ve done for the <span class="No-Break">post feature.</span></p>
			<p>Good luck with the exercise. You can find the solution <span class="No-Break">at </span><a href="https://github.com/PacktPublishing/Full-stack-Django-and-React/blob/main/social-media-react/src/components/comments/Comment.jsx"><span class="No-Break">https://github.com/PacktPublishing/Full-stack-Django-and-React/blob/main/social-media-react/src/components/comments/Comment.jsx</span></a><span class="No-Break">.</span></p>
			<p>After adding the <strong class="bold">Like</strong> feature to <a id="_idIndexMarker596"/>comments, we are now ready to finally add CRUD operations to the profile of the React application. We will create a profile page and allow the user to edit the information in their profile. We will also enable the user to update their avatar and set a default avatar image <span class="No-Break">for users.</span></p>
			<h1 id="_idParaDest-189"><a id="_idTextAnchor201"/>Summary</h1>
			<p>In this chapter, we focused on adding CRUD operations to the comments feature. We’ve learned how to play with <strong class="source-inline">react-router</strong> Hooks to retrieve parameters and use them in the code. We’ve also added a <strong class="bold">Like</strong> feature to the comment. A user can like or unlike a comment, and also see the number of likes for a post. That led us to learn more about the <strong class="source-inline">useState</strong> and <strong class="source-inline">useContext</strong> Hooks and the way they affect a state in React. We have also learned how to create a dropdown component, how to use the custom toaster, and how to tweak a component to fits <span class="No-Break">some requirements.</span></p>
			<p>In the next chapter, we’ll focus on CRUD operations on the user profile, and we will also learn how to upload a <span class="No-Break">profile picture.</span></p>
			<h1 id="_idParaDest-190"><a id="_idTextAnchor202"/>Questions</h1>
			<ol>
				<li>What is the usage <span class="No-Break">of </span><span class="No-Break"><strong class="source-inline">useParams</strong></span><span class="No-Break">?</span></li>
				<li>How do you write a route in React that can support <span class="No-Break">parameter passing?</span></li>
				<li>What is the use of the <span class="No-Break"><strong class="source-inline">useContext</strong></span><span class="No-Break"> Hook?</span></li>
			</ol>
		</div>
	</body></html>