<html><head></head><body>
<div><div><h1 class="chapter-number" id="_idParaDest-58"><a id="_idTextAnchor009"/>5</h1>
<h1 id="_idParaDest-59">Running Python Applications with PyCharm</h1>
<p>In this chapter, we are going to run a Lambda application with PyCharm. Running Lambda applications via PyCharm is both useful and practical during development as it consists of a code editor, debugger, and common development tools with a developer-friendly graphical user interface. These features of PyCharm help us to easily find bugs in our code.</p>
<p>This chapter covers the following topics:</p>
<ul>
<li>Installing the AWS Toolkit</li>
<li>Configuring the AWS Toolkit</li>
<li>Creating a sample Lambda function in AWS</li>
<li>Running an AWS Lambda function using the AWS Toolkit</li>
</ul>
<h1 id="_idParaDest-60">Installing the AWS Toolkit</h1>
<p>In this section, we will install the AWS Toolkit<a id="_idIndexMarker171"/> in PyCharm. The AWS Toolkit is an extension for PyCharm to develop, debug, and deploy your applications for AWS. Let’s get to it:</p>
<ol>
<li>Open PyCharm on your computer.</li>
<li>Open <strong class="bold">Preferences</strong> from the <strong class="bold">PyCharm</strong> dropdown and select <strong class="bold">Plugins</strong>:</li>
</ol>
<div><div><img alt="" height="639" src="img/Figure_5.1_B19195.jpg" width="1100"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.1 – Preferences</p>
<ol>
<li value="3">Type <code>AWS Toolkit</code> in the search<a id="_idIndexMarker172"/> area and click <strong class="bold">Install</strong>:</li>
</ol>
<div><div><img alt="" height="378" src="img/Figure_5.2_B19195.jpg" width="1028"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.2 — Install the AWS Toolkit</p>
<ol>
<li value="4">After installation, the IDE will ask you to restart it. Click the <strong class="bold">Restart </strong><strong class="bold">IDE</strong> button:</li>
</ol>
<div><div><img alt="" height="313" src="img/Figure_5.3_B19195.jpg" width="672"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.3 – Restart the IDE</p>
<p>We have installed the AWS Toolkit<a id="_idIndexMarker173"/> in PyCharm. As the next step, we are going to configure the credentials for our AWS account.</p>
<h1 id="_idParaDest-61">Configuring the AWS Toolkit</h1>
<p>We are going to configure<a id="_idIndexMarker174"/> the AWS Toolkit in order to connect it to our AWS account. We will start by setting the credentials for our AWS account:</p>
<ol>
<li>After restarting the IDE, you will see the text <strong class="bold">AWS: No credentials selected</strong> at the bottom-right of the page. Click this text:</li>
</ol>
<div><div><img alt="" height="220" src="img/Figure_5.4_B19195.jpg" width="923"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.4 – AWS: No credentials selected</p>
<ol>
<li value="2">After clicking it, you will see the <strong class="bold">AWS Connection Settings </strong>menu appear. We are now going<a id="_idIndexMarker175"/> to configure the credentials. In order for the IDE to connect to AWS, we need to provide the AWS access key and secret key:</li>
</ol>
<div><div><img alt="" height="354" src="img/Figure_5.5_B19195.jpg" width="710"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.5 – Click Region</p>
<p>In the previous chapter, <a href="B19195_04.xhtml#_idTextAnchor006"><em class="italic">Chapter 4</em></a>, <em class="italic">Running Python Applications on EC2</em>, we created an S3User via the IAM service. For our current use case, we follow the same steps in order to create<a id="_idIndexMarker176"/> a user that has Lambda access:</p>
<ol>
<li>In the IAM console, add a user with the name <code>ProgrammaticUser</code> and click <strong class="bold">Next: Permissions</strong>:</li>
</ol>
<div><div><img alt="" height="568" src="img/Figure_5.6_B19195.jpg" width="1101"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.6 – Add user</p>
<ol>
<li value="2">In the next panel, select <strong class="bold">AWSLambda_FullAccess</strong> and proceed to create a new user. The steps are the same as those we used to create the user in the previous chapter. Click <strong class="bold">Next: Tags</strong> and proceed:</li>
</ol>
<div><div><img alt="" height="766" src="img/Figure_5.7_B19195.jpg" width="1099"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.7 – Add permission</p>
<ol>
<li value="3">We will now provide<a id="_idIndexMarker177"/> the access key ID and secret access key for the AWS connection setup. Open PyCharm again and click <strong class="bold">Edit AWS </strong><strong class="bold">Credential file(s)</strong>:</li>
</ol>
<div><div><img alt="" height="179" src="img/Figure_5.8_B19195.jpg" width="346"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.8 – Edit credentials</p>
<ol>
<li value="4">Click the <strong class="bold">Create</strong> button on the following dialog window that appears:</li>
</ol>
<div><div><img alt="" height="292" src="img/Figure_5.9_B19195.jpg" width="749"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.9 – Create the credential file</p>
<ol>
<li value="5">Once you click <strong class="bold">Create</strong>, you will be presented with a file in which you can enter the credentials. Place the access key ID and secret access key in the file and save it:</li>
</ol>
<div><div><img alt="" height="282" src="img/Figure_5.10_B19195.jpg" width="1060"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.10 – Edit the credential file</p>
<p>We have created<a id="_idIndexMarker178"/> the AWS credentials and adjusted them in the PyCharm. As a next step, we are ready to create a Lambda function.</p>
<h1 id="_idParaDest-62">Creating a sample Lambda function in AWS</h1>
<p>In this step, we are going<a id="_idIndexMarker179"/> to create a Lambda function that reads and prints<a id="_idIndexMarker180"/> a file from S3. In the previous chapter, we learned how to create the S3 bucket and Lambda function. Hence, we keep the explanation short here:</p>
<ol>
<li>We are going to copy a sample file to the S3 bucket:</li>
</ol>
<div><div><img alt="" height="457" src="img/Figure_5.11_B19195.jpg" width="1100"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.11 – File in S3</p>
<ol>
<li value="2">Create a Lambda function that reads the file from S3. I’ve called the Lambda function <code>FileProcessing</code>; however, you can give it any name that you prefer:</li>
</ol>
<div><div><img alt="" height="447" src="img/Figure_5.12_B19195.jpg" width="891"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.12 – Lambda function</p>
<ol>
<li value="3">Once the Lambda is created, we paste<a id="_idIndexMarker181"/> the code to Lambda from the GitHub link<a id="_idIndexMarker182"/> under the image. In the code block, we are going to implement a simple function to read the content of the S3 bucket and print it. You can retrieve the code block from the GitHub page that I have shared after <em class="italic">Figure 5</em><em class="italic">.13</em>. Broadly speaking, the <code>s3.get_object</code> method reads the file with the given parameters of <code>bucket</code> and <code>key</code>. Once you have a file stored in S3, the content is under the <code>Body</code> JSON file and the final step is to print the content:</li>
</ol>
<div><div><img alt="" height="446" src="img/Figure_5.13_B19195.jpg" width="1069"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.13 – Code in Lambda</p>
<p>The following GitHub link consists of the code block for the S3 Reader application: <a href="https://github.com/PacktPublishing/Python-Essentials-for-AWS-Cloud-Developers/blob/main/S3Reader.py">https://github.com/PacktPublishing/Python-Essentials-for-AWS-Cloud-Developers/blob/main/S3Reader.py</a>.</p>
<ol>
<li value="4">Click the <strong class="bold">Test</strong> button<a id="_idIndexMarker183"/> in order to check whether the Lambda function<a id="_idIndexMarker184"/> is running. When you click the <strong class="bold">Test</strong> button the first time, you need to configure the sample event:</li>
</ol>
<div><div><img alt="" height="644" src="img/Figure_5.14a_B19195.jpg" width="1079"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">(a)</p>
<div><div><img alt="" height="522" src="img/Figure_5.14b_B19195.jpg" width="1059"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">(b)</p>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.14 – Configure and test the Lambda function</p>
<p>We have created the Lambda function. In the next section, we are going to run this function within PyCharm via the AWS Toolkit.</p>
<h1 id="_idParaDest-63">Running an AWS Lambda function using the AWS Toolkit</h1>
<p>In this section, we are going<a id="_idIndexMarker185"/> to run our Lambda function within PyCharm. Let’s follow the steps:</p>
<ol>
<li>Open <strong class="bold">AWS Toolkit</strong> on the left side of PyCharm and you will be able to see the Lambda functions that are defined in the AWS Lambda service. Seeing this means that the connection we configured works:</li>
</ol>
<div><div><img alt="" height="678" src="img/Figure_5.15_B19195.jpg" width="605"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.15 – Open the AWS Toolkit menu</p>
<p>In the list, we can see<a id="_idIndexMarker186"/> the functions that we created in the <strong class="bold">us-east-2</strong> region. We are now ready to run the Lambda function that we created in the previous section.</p>
<ol>
<li value="2">Right-click <strong class="bold">FileProcessing</strong> and, on the resulting menu, click the <strong class="bold">Run ‘[Remote] </strong><strong class="bold">FileProcess...’</strong> button:</li>
</ol>
<div><div><img alt="" height="860" src="img/Figure_5.16_B19195.jpg" width="1054"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.16 – Run the function</p>
<p>When you click the link, the AWS Toolkit<a id="_idIndexMarker187"/> will run the Lambda function via PyCharm:</p>
<div><div><img alt="" height="684" src="img/Figure_5.17_B19195.jpg" width="1099"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.17 – Logs of the function</p>
<p>After running the function, some Lambda logs will appear in PyCharm. As you can see, this makes it easier to develop<a id="_idIndexMarker188"/> Python applications for AWS. You can test this from your local machine without logging into the AWS Management Console.</p>
<h1 id="_idParaDest-64">Summary</h1>
<p>In this chapter, we learned how to install and use the AWS Toolkit within PyCharm. It is always helpful when you implement and deploy AWS services within PyCharm in a practical way. AWS Toolkit has AWS services integration; therefore, instead of using the AWS Management Console, you can use PyCharm where it is installed on the local machine. In the following chapter, we will take a look at how to deploy a Python application to Elastic Beanstalk.</p>
</div>
</div></body></html>