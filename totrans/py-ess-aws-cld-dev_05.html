<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer127">
<h1 class="chapter-number" id="_idParaDest-58"><a id="_idTextAnchor009"/>5</h1>
<h1 id="_idParaDest-59">Running Python Applications with PyCharm</h1>
<p>In this chapter, we are going to run a Lambda application with PyCharm. Running Lambda applications via PyCharm is both useful and practical during development as it consists of a code editor, debugger, and common development tools with a developer-friendly graphical user interface. These features of PyCharm help us to easily find bugs in <span class="No-Break">our code.</span></p>
<p>This chapter covers the <span class="No-Break">following topics:</span></p>
<ul>
<li>Installing the <span class="No-Break">AWS Toolkit</span></li>
<li>Configuring the <span class="No-Break">AWS Toolkit</span></li>
<li>Creating a sample Lambda function <span class="No-Break">in AWS</span></li>
<li>Running an AWS Lambda function using the <span class="No-Break">AWS Toolkit</span></li>
</ul>
<h1 id="_idParaDest-60">Installing the AWS Toolkit</h1>
<p>In this section, we will install the AWS Toolkit<a id="_idIndexMarker171"/> in PyCharm. The AWS Toolkit is an extension for PyCharm to develop, debug, and deploy your applications for AWS. Let’s get <span class="No-Break">to it:</span></p>
<ol>
<li>Open PyCharm on <span class="No-Break">your computer.</span></li>
<li>Open <strong class="bold">Preferences</strong> from the <strong class="bold">PyCharm</strong> dropdown and <span class="No-Break">select </span><span class="No-Break"><strong class="bold">Plugins</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer109">
<img alt="" height="639" src="image/Figure_5.1_B19195.jpg" width="1100"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.1 – Preferences</p>
<ol>
<li value="3">Type <strong class="source-inline">AWS Toolkit</strong> in the search<a id="_idIndexMarker172"/> area and <span class="No-Break">click </span><span class="No-Break"><strong class="bold">Install</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer110">
<img alt="" height="378" src="image/Figure_5.2_B19195.jpg" width="1028"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.2 — Install the AWS Toolkit</p>
<ol>
<li value="4">After installation, the IDE will ask you to restart it. Click the <strong class="bold">Restart </strong><span class="No-Break"><strong class="bold">IDE</strong></span><span class="No-Break"> button:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer111">
<img alt="" height="313" src="image/Figure_5.3_B19195.jpg" width="672"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.3 – Restart the IDE</p>
<p>We have installed the AWS Toolkit<a id="_idIndexMarker173"/> in PyCharm. As the next step, we are going to configure the credentials for our <span class="No-Break">AWS account.</span></p>
<h1 id="_idParaDest-61">Configuring the AWS Toolkit</h1>
<p>We are going to configure<a id="_idIndexMarker174"/> the AWS Toolkit in order to connect it to our AWS account. We will start by setting the credentials for our <span class="No-Break">AWS account:</span></p>
<ol>
<li>After restarting the IDE, you will see the text <strong class="bold">AWS: No credentials selected</strong> at the bottom-right of the page. Click <span class="No-Break">this text:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer112">
<img alt="" height="220" src="image/Figure_5.4_B19195.jpg" width="923"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.4 – AWS: No credentials selected</p>
<ol>
<li value="2">After clicking it, you will see the <strong class="bold">AWS Connection Settings </strong>menu appear. We are now going<a id="_idIndexMarker175"/> to configure the credentials. In order for the IDE to connect to AWS, we need to provide the AWS access key and <span class="No-Break">secret key:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer113">
<img alt="" height="354" src="image/Figure_5.5_B19195.jpg" width="710"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.5 – Click Region</p>
<p>In the previous chapter, <a href="B19195_04.xhtml#_idTextAnchor006"><span class="No-Break"><em class="italic">Chapter 4</em></span></a>, <em class="italic">Running Python Applications on EC2</em>, we created an S3User via the IAM service. For our current use case, we follow the same steps in order to create<a id="_idIndexMarker176"/> a user that has <span class="No-Break">Lambda access:</span></p>
<ol>
<li>In the IAM console, add a user with the name <strong class="source-inline">ProgrammaticUser</strong> and click <span class="No-Break"><strong class="bold">Next: Permissions</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer114">
<img alt="" height="568" src="image/Figure_5.6_B19195.jpg" width="1101"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.6 – Add user</p>
<ol>
<li value="2">In the next panel, select <strong class="bold">AWSLambda_FullAccess</strong> and proceed to create a new user. The steps are the same as those we used to create the user in the previous chapter. Click <strong class="bold">Next: Tags</strong> <span class="No-Break">and proceed:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer115">
<img alt="" height="766" src="image/Figure_5.7_B19195.jpg" width="1099"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.7 – Add permission</p>
<ol>
<li value="3">We will now provide<a id="_idIndexMarker177"/> the access key ID and secret access key for the AWS connection setup. Open PyCharm again and click <strong class="bold">Edit AWS </strong><span class="No-Break"><strong class="bold">Credential file(s)</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer116">
<img alt="" height="179" src="image/Figure_5.8_B19195.jpg" width="346"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.8 – Edit credentials</p>
<ol>
<li value="4">Click the <strong class="bold">Create</strong> button on the following dialog window <span class="No-Break">that appears:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer117">
<img alt="" height="292" src="image/Figure_5.9_B19195.jpg" width="749"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.9 – Create the credential file</p>
<ol>
<li value="5">Once you click <strong class="bold">Create</strong>, you will be presented with a file in which you can enter the credentials. Place the access key ID and secret access key in the file and <span class="No-Break">save it:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer118">
<img alt="" height="282" src="image/Figure_5.10_B19195.jpg" width="1060"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.10 – Edit the credential file</p>
<p>We have created<a id="_idIndexMarker178"/> the AWS credentials and adjusted them in the PyCharm. As a next step, we are ready to create a <span class="No-Break">Lambda function.</span></p>
<h1 id="_idParaDest-62">Creating a sample Lambda function in AWS</h1>
<p>In this step, we are going<a id="_idIndexMarker179"/> to create a Lambda function that reads and prints<a id="_idIndexMarker180"/> a file from S3. In the previous chapter, we learned how to create the S3 bucket and Lambda function. Hence, we keep the explanation <span class="No-Break">short here:</span></p>
<ol>
<li>We are going to copy a sample file to the <span class="No-Break">S3 bucket:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer119">
<img alt="" height="457" src="image/Figure_5.11_B19195.jpg" width="1100"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.11 – File in S3</p>
<ol>
<li value="2">Create a Lambda function that reads the file from S3. I’ve called the Lambda function <strong class="source-inline">FileProcessing</strong>; however, you can give it any name that <span class="No-Break">you prefer:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer120">
<img alt="" height="447" src="image/Figure_5.12_B19195.jpg" width="891"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.12 – Lambda function</p>
<ol>
<li value="3">Once the Lambda is created, we paste<a id="_idIndexMarker181"/> the code to Lambda from the GitHub link<a id="_idIndexMarker182"/> under the image. In the code block, we are going to implement a simple function to read the content of the S3 bucket and print it. You can retrieve the code block from the GitHub page that I have shared after <span class="No-Break"><em class="italic">Figure 5</em></span><em class="italic">.13</em>. Broadly speaking, the <strong class="source-inline">s3.get_object</strong> method reads the file with the given parameters of <strong class="source-inline">bucket</strong> and <strong class="source-inline">key</strong>. Once you have a file stored in S3, the content is under the <strong class="source-inline">Body</strong> JSON file and the final step is to print <span class="No-Break">the content:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer121">
<img alt="" height="446" src="image/Figure_5.13_B19195.jpg" width="1069"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.13 – Code in Lambda</p>
<p>The following GitHub link consists of the code block for the S3 Reader application: <a href="https://github.com/PacktPublishing/Python-Essentials-for-AWS-Cloud-Developers/blob/main/S3Reader.py">https://github.com/PacktPublishing/Python-Essentials-for-AWS-Cloud-Developers/blob/main/S3Reader.py</a>.</p>
<ol>
<li value="4">Click the <strong class="bold">Test</strong> button<a id="_idIndexMarker183"/> in order to check whether the Lambda function<a id="_idIndexMarker184"/> is running. When you click the <strong class="bold">Test</strong> button the first time, you need to configure the <span class="No-Break">sample event:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer122">
<img alt="" height="644" src="image/Figure_5.14a_B19195.jpg" width="1079"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">(a)</p>
<div>
<div class="IMG---Figure" id="_idContainer123">
<img alt="" height="522" src="image/Figure_5.14b_B19195.jpg" width="1059"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">(b)</p>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.14 – Configure and test the Lambda function</p>
<p>We have created the Lambda function. In the next section, we are going to run this function within PyCharm via the <span class="No-Break">AWS Toolkit.</span></p>
<h1 id="_idParaDest-63">Running an AWS Lambda function using the AWS Toolkit</h1>
<p>In this section, we are going<a id="_idIndexMarker185"/> to run our Lambda function within PyCharm. Let’s follow <span class="No-Break">the steps:</span></p>
<ol>
<li>Open <strong class="bold">AWS Toolkit</strong> on the left side of PyCharm and you will be able to see the Lambda functions that are defined in the AWS Lambda service. Seeing this means that the connection we <span class="No-Break">configured works:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer124">
<img alt="" height="678" src="image/Figure_5.15_B19195.jpg" width="605"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.15 – Open the AWS Toolkit menu</p>
<p>In the list, we can see<a id="_idIndexMarker186"/> the functions that we created in the <strong class="bold">us-east-2</strong> region. We are now ready to run the Lambda function that we created in the previous section.</p>
<ol>
<li value="2">Right-click <strong class="bold">FileProcessing</strong> and, on the resulting menu, click the <strong class="bold">Run ‘[Remote] </strong><span class="No-Break"><strong class="bold">FileProcess...’</strong></span><span class="No-Break"> button:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer125">
<img alt="" height="860" src="image/Figure_5.16_B19195.jpg" width="1054"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.16 – Run the function</p>
<p>When you click the link, the AWS Toolkit<a id="_idIndexMarker187"/> will run the Lambda function <span class="No-Break">via PyCharm:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer126">
<img alt="" height="684" src="image/Figure_5.17_B19195.jpg" width="1099"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.17 – Logs of the function</p>
<p>After running the function, some Lambda logs will appear in PyCharm. As you can see, this makes it easier to develop<a id="_idIndexMarker188"/> Python applications for AWS. You can test this from your local machine without logging into the AWS <span class="No-Break">Management Console.</span></p>
<h1 id="_idParaDest-64">Summary</h1>
<p>In this chapter, we learned how to install and use the AWS Toolkit within PyCharm. It is always helpful when you implement and deploy AWS services within PyCharm in a practical way. AWS Toolkit has AWS services integration; therefore, instead of using the AWS Management Console, you can use PyCharm where it is installed on the local machine. In the following chapter, we will take a look at how to deploy a Python application to <span class="No-Break">Elastic Beanstalk.</span></p>
</div>
</div></body></html>