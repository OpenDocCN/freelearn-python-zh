<html><head></head><body>
<div><h1 class="chapter-number" id="_idParaDest-126"><a id="_idTextAnchor127"/>5</h1>
<h1 id="_idParaDest-127"><a id="_idTextAnchor128"/>Dos and Don’ts for Network Programming</h1>
<p>Writing code for networks is exciting because when it fails, it is challenging, and when it works, it is rewarding. If you are an experienced programmer, you will have an easier ride, but if you are a newbie, it will be stormy. Let’s dive into some coding practices that will help you get through these storms easier.</p>
<p>We are going to focus on this chapter on coding aspects for Python and Go related to network programming. The subject covered here would be also good for any type of programming; however, we are going to focus on programming for networks, and these are the topics we will cover:</p>
<ul>
<li>Coding topics</li>
<li>Applying best practices in coding</li>
<li>Coding formatters</li>
<li>Versioning and concurrent development</li>
<li>Testing your code</li>
</ul>
<p>At the end of this chapter, you should be familiar with coding terms used by the community and which of them matter most. You will be able to understand coding best practices and how to become a better network code developer. If you are an experienced coder, it will be a good refresh. If you are new, this chapter will be your mantra when writing code.</p>
<h1 id="_idParaDest-128"><a id="_idTextAnchor129"/>Coding topics</h1>
<p>Writing <a id="_idIndexMarker522"/>code used to be very simple and straightforward; it only required the ability to understand a program’s workflow, its performance, and its algorithms. But today, the story is a bit different. Coding now has a culture that has evolved in the last few decades. What matters most is the code’s reusability and, therefore, its style. To be reusable, code has to be easy to understand and should have few or no bugs or security issues.</p>
<p>If you are new to coding, or network coding, it is important to know all the topics used in coding culture today. Let’s discuss briefly the most important ones in this section.</p>
<h2 id="_idParaDest-129"><a id="_idTextAnchor130"/>Peer review</h2>
<p>It’s not recommended to write code and publish<a id="_idIndexMarker523"/> without a <strong class="bold">peer review</strong>. Peer review<a id="_idIndexMarker524"/> allows the coder to be consistent with the team and avoid undesirable mistakes. However, for most organizations, this process can be slow and sometimes expensive. One alternative is to use software robots that can perform most of the peer review that was once done by another software engineer.</p>
<p>A peer review is a conscious and objective review done by another developer that has the objective of checking team standards, language standards, and community best practices, sharing knowledge, verifying code repetition and name convention, and aligning design with implementation, among others. As the list is long, the peer review process is not an easy and straightforward job; it sometimes takes longer to review the code than to write it.</p>
<h2 id="_idParaDest-130"><a id="_idTextAnchor131"/>Life cycle</h2>
<p>It is important to keep track of <a id="_idIndexMarker525"/>your code by measuring and storing the date of creation, compilation (if any), and distribution. This is done by having some sort of life-cycle management. With a life cycle, it is possible to trigger actions to go back to the source code and verify whether the current recommendations are still valid on the source code, and also check whether there is any new security vulnerability. There are tools that do life-cycle management automatically to your code base and your applications; use them when possible.</p>
<h2 id="_idParaDest-131"><a id="_idTextAnchor132"/>Refactoring</h2>
<p>In computer <a id="_idIndexMarker526"/>programming, <strong class="bold">refactoring</strong> (or <strong class="bold">code refactoring</strong>) is the term used to change <a id="_idIndexMarker527"/>the code without changing its external behaviors in terms of output and input. Refactoring can be used to fix bugs, improve performance, remove security vulnerabilities, or comply with new code styling. The important thing here is that refactoring does not change the features of the code. In other words, the external behavior, inputs, and outputs are preserved.</p>
<p class="callout-heading">Important note</p>
<p class="callout">Check more on <a id="_idIndexMarker528"/>code refactoring on the site <a href="https://refactoring.guru/">https://refactoring.guru/</a>.</p>
<h2 id="_idParaDest-132"><a id="_idTextAnchor133"/>Copying code and licensing</h2>
<p>The first thing you should do before publishing your code is to think about the <strong class="bold">copyright</strong> and <strong class="bold">code license</strong>. Why? Because if your code is good, it will definitely be reusable by <a id="_idIndexMarker529"/>someone <a id="_idIndexMarker530"/>else or will be copied for other purposes, unless you strictly specify the rules of copying on the license document. In addition, if you are importing or using external libraries, you might be compromised by copyright issues.</p>
<p>Therefore, it is important to create appropriate license documents and read the license documents of the code you are using or copying. The types of licenses that are attributed to software are listed here:</p>
<ul>
<li><strong class="bold">Trade secret licenses</strong>: No<a id="_idIndexMarker531"/> information made public; private internal usage; unpublished</li>
<li><strong class="bold">Proprietary licenses</strong>: Have<a id="_idIndexMarker532"/> copyrights; no public licenses and no source code</li>
<li><strong class="bold">Noncommercial licenses</strong>: Used<a id="_idIndexMarker533"/> for noncommercial use and no source code</li>
<li><strong class="bold">Copyleft licenses</strong>: Grant <a id="_idIndexMarker534"/>use rights; forbids relicensing and public source code</li>
<li><strong class="bold">Permissive licenses</strong>: Grant<a id="_idIndexMarker535"/> use rights; allows relicensing and public source code</li>
<li><strong class="bold">Public domain licenses</strong>: All<a id="_idIndexMarker536"/> possible grants</li>
</ul>
<p>Why do we care about these types of licenses? Because you are not supposed to distribute or publish the software you are working on. You could receive legal penalties and fines for breaching the license agreement on the code you are creating locally at your company. Most of the time, you are probably going to reuse someone else’s library or code into a major piece of software. Before using an external library or code, the best way is to consult the legal department and check whether there are any licenses that are forbidden for use internally.</p>
<p>Consequently, it is<a id="_idIndexMarker537"/> recommended when writing code to check the license disclaimer document provided. It is normally located in the root directory of the source code, in capital letters, with names such as <code>LICENSE</code> or <code>LICENSE.rst</code>, but sometimes <code>COPYRIGHT</code>, <code>COPYING</code>, or something similar is used to express the copy grants.</p>
<p>For open source, the code also can rely on rules defined by definitions created by other entities; to do that, you just need to read the <code>LICENSE</code> file and check which one is applied. One of the most used ones in open source code is<a id="_idIndexMarker538"/> the <strong class="bold">MIT License</strong>.</p>
<p>Before <a id="_idIndexMarker539"/>using the open source library or copying it into your code, make sure the license does not present a risk to your organization. The open source code that presents<a id="_idIndexMarker540"/> the most risk when <a id="_idIndexMarker541"/>reusing it in private<a id="_idIndexMarker542"/> organizations is <strong class="bold">GPL 2.0</strong> and <strong class="bold">GPL 3.0</strong> (<strong class="bold">GNU General Public License</strong>). The<a id="_idIndexMarker543"/> low-risk <a id="_idIndexMarker544"/>ones are <strong class="bold">MIT License</strong>, <strong class="bold">Apache License 2.0</strong>, and <strong class="bold">BSD License 2.0</strong>.</p>
<p>The following table shows the top five most used licenses in projects at GitHub:</p>
<table class="No-Table-Style _idGenTablePara-1" id="table001-2">
<colgroup>
<col/>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="bold">Rank</strong></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold">License</strong></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold">% of projects</strong></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>1</p>
</td>
<td class="No-Table-Style">
<p>MIT</p>
</td>
<td class="No-Table-Style">
<p>44.69</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>2</p>
</td>
<td class="No-Table-Style">
<p>Other</p>
</td>
<td class="No-Table-Style">
<p>15.68</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>3</p>
</td>
<td class="No-Table-Style">
<p>GLP 2.0</p>
</td>
<td class="No-Table-Style">
<p>12.96</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>4</p>
</td>
<td class="No-Table-Style">
<p>Apache</p>
</td>
<td class="No-Table-Style">
<p>11.19</p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>5</p>
</td>
<td class="No-Table-Style">
<p>GLP 3.0</p>
</td>
<td class="No-Table-Style">
<p>8.88</p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 5.1 – Rank of the most used licenses in GitHub projects</p>
<p>The following screenshot shows the evolution of GitHub project licenses from 2008 to 2015. Note the <a id="_idIndexMarker545"/>growth of <a id="_idIndexMarker546"/>MIT licenses:</p>
<div><div><img alt="Figure 5.1 – License usage in GitHub projects (source: github.blog)" src="img/B18165_05_001.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.1 – License usage in GitHub projects (source: github.blog)</p>
<p>Now that you are familiar with the most popular code licenses, let’s progress with discussing code quality and perception.</p>
<h2 id="_idParaDest-133"><a id="_idTextAnchor134"/>Code quality and perception</h2>
<p><strong class="bold">Code quality</strong> is a<a id="_idIndexMarker547"/> term normally heard among software engineers, but to be very clear, it is not an easy subject, and the definition of quality is normally subjective and prone to personal preferences.</p>
<p>To avoid such an ambiguous definition, code quality should focus on team or company guidelines and standards. If the company that you have just started has loose or no code guidelines, the code <em class="italic">quality</em> probably relies on the senior engineer. But that must—and should—be avoided.</p>
<p>Code quality should <a id="_idIndexMarker548"/>be measured by using standards and code practices, not by a person. If there are no standards or code practices in your team, use this chapter to guide you while creating one.</p>
<p>When defining the quality<a id="_idIndexMarker549"/> of the code, try to use measurable metrics that will allow software engineers to understand poor quality without taking it personally. Look for the following characteristics in the code:</p>
<ul>
<li><strong class="bold">Reliability</strong>: Measure how many times the code runs without failures</li>
<li><strong class="bold">Maintainability</strong>: Measure how easily the code can be changed, including size, complexity, and structure</li>
<li><strong class="bold">Testability</strong>: Measure how the code can be controlled, observed, and isolated to create automated testing such as unit tests (which will be discussed in the <em class="italic">Testing your code</em> section later in this chapter)</li>
<li><strong class="bold">Portability</strong>: How easily the code can run in different environments</li>
<li><strong class="bold">Reusability</strong>: Measure how the code can be reused by dependencies or by copying</li>
</ul>
<p>When possible, use automated tools that can classify and format the code, which avoids personal subjective analysis.</p>
<h2 id="_idParaDest-134"><a id="_idTextAnchor135"/>Architecture and modeling</h2>
<p>Software architecture and design is a very long and wide topic. Depending on the size of your project, you might not need to do a design or architecture when working with network automation code. However, it is important to know they exist and can be used effectively to have a better code structure and better organization. </p>
<p>I would suggest that the most important part of software architecture<a id="_idIndexMarker550"/> is the modeling, which helps a lot in the early stages to validate the structure and the organization of the code. Communication with a model is easy with customers and can be understood even if you are not a software developer.</p>
<p>The <a id="_idIndexMarker551"/>most popular used <a id="_idIndexMarker552"/>models are <strong class="bold">Unified Modeling Language</strong> (<strong class="bold">UML</strong>) as generic, <strong class="bold">Systems Modeling Language</strong> (<strong class="bold">SysML</strong>), a subset of UML, <strong class="bold">Service-oriented architecture Modeling language</strong> (<strong class="bold">SoaML</strong>), also <a id="_idIndexMarker553"/>a subset of UML, and<a id="_idIndexMarker554"/> the <strong class="bold">C4 model</strong>. It does not matter which one you will choose; using any model before you start coding will help you to get the code right.</p>
<p>Let’s use the deployment pipeline described in <a href="B18165_04.xhtml#_idTextAnchor100"><em class="italic">Chapter 4</em></a> as an example to create a software <a id="_idIndexMarker555"/>model of the solution. <em class="italic">Figure 5.2</em> illustrates how it would be a very simple model for the deployment pipeline:</p>
<div><div><img alt="Figure 5.2 – Deployment pipeline software model example described in Chapter 4" src="img/B18165_05_002.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.2 – Deployment pipeline software model example described in <a href="B18165_04.xhtml#_idTextAnchor100">Chapter 4</a></p>
<p>The preceding diagram illustrates, using arrows and boxes, how a developer would tackle the problem of constructing a deployment pipeline. The inputs are the router definition and templates, then a configuration render creates the configuration and stores it at the desired state. The syntax is checked, and then the running config is verified if it is equal to <code>applied</code>. If not, it stops and waits for manual intervention; if it is okay, then launch a network simulation. Then, all tests are done. If the tests are passed, update the approved configs. The next step is to apply the configuration to the routers, and if it is <a id="_idIndexMarker556"/>applied correctly, then update the <code>applied</code> configs.</p>
<p>We have discussed in this section a few code culture topics that are used nowadays within the developing community. In the next section, we are going to dive into what the best practices are for writing code for Python and Go.</p>
<h1 id="_idParaDest-135"><a id="_idTextAnchor136"/>Applying best practices in coding</h1>
<p>Here are points that are not necessarily standards, but they are important when we are writing code for networks.</p>
<h2 id="_idParaDest-136"><a id="_idTextAnchor137"/>Follow the standards</h2>
<p>In the '90s, the internet was starting <a id="_idIndexMarker557"/>to grow fast, and programmers started to become more present in the community. Shell scripting started to grow as a viable tool to help system engineers work with their servers. Then came <strong class="bold">Perl</strong> as a powerful scripting language to help as well. Other languages were <a id="_idIndexMarker558"/>also mature, such as C, C++, and Java. But every developer wrote differently with their own style, which did not help code collaboration and made sharing code a disaster. When Python was created, the coding style problem already existed. Something had to be done to avoid confusion when sharing code.</p>
<p>Let’s check now what the standards are for Python and Go languages.</p>
<h3>Python standard style</h3>
<p>Python<a id="_idIndexMarker559"/> can be written in so many different ways. If you are an old programmer, you would remember Perl, which was a scripting language like Python but without any particular style, which was a mess. There are documents that help programmers to write better code in Python. The documents are created by the Python community, and they are called <strong class="bold">PEPs</strong>, which stands<a id="_idIndexMarker560"/> for <strong class="bold">Python Enhancement Proposals</strong>.</p>
<p>Initially, the PEP process was created to propose and discuss consensus on new features, but it is also used to document information. A PEP is similar to an internet <strong class="bold">Request For Comments</strong> (<strong class="bold">RFC</strong>) for<a id="_idIndexMarker561"/> Python, and when describing new features, it has to contain a description of the feature in detail and a rationale for the creation of it.</p>
<p>When proposing new features for Python, the writer is responsible for building consensus within the community, describing different options, collecting input from the community, and documenting it.</p>
<p>Some PEPs are informational and are basically used to guide Python coding style. If you are planning to become a Python code developer, a PEP is like your daily journal to check and read. It is important to keep updated with the latest PEP and make sure your code follows the <a id="_idIndexMarker562"/>recommendations.</p>
<p>So far, there are a few useful PEPs to help the community with guidance and best practices on how to write code with Python. Let’s check the most important ones.</p>
<h4>Writing code with the guidance of PEP-8</h4>
<p><em class="italic">PEP-8</em> is perhaps<a id="_idIndexMarker563"/> the most important PEP you have to read if you are new to Python because it describes in detail all styles and conventions when writing code in Python. Although the language does not force you to select a style when writing, using <em class="italic">PEP-8</em> (or <em class="italic">PEP8</em>) will make your code easy to understand for anyone in the Python community.</p>
<p>When you are new to Python, it might be difficult to remember what a part of the code you wrote weeks or a few days ago was supposed to do. However, if you follow <em class="italic">PEP-8</em>, you can be sure that you have named your variables well, you have added enough whitespace, and you have commented your code well. Following these guidelines will make your code more readable for others and for you when coming back to read after a while. Beginners will also learn Python much faster and with ease when following <em class="italic">PEP-8</em>.</p>
<p>The <em class="italic">PEP-8</em> document is very clear; it shows a wrong code style and then a correct style with an explanation of why to use that style.</p>
<h3>Go standard style</h3>
<p>Before describing the standards in the <a id="_idIndexMarker564"/>Go language, it is important to note that Go is also known as <code>golang.org</code>. Now, the Go language is hosted on <code>go.dev</code>.</p>
<p>Go is quite different from Python in terms of code formatting and style. Go does not have PEP-like documents to point out how to write better code in Go. So, the style standard relies mostly on the internal formatting tool, called <code>gofmt</code>, which is responsible for formatting the source code in a predictable way.</p>
<p>Although the <code>gofmt</code> formatter can be skipped, it is highly recommended to use it as soon as you change something in your code and before publishing it. Some tools will run the formatter automatically before running or compiling your Go program. In addition to <code>gofmt</code>, there are Go <strong class="bold">linters</strong> that<a id="_idIndexMarker566"/> can point out style errors or suspicious constructions; we are going to describe these in the <em class="italic">Coding formatters</em> section later in this chapter.</p>
<p>Furthermore, the Go community has published several guidelines that help with writing better code. Here is a list of the best ones:</p>
<ul>
<li><a href="https://github.com/uber-go/guide/blob/master/style.md">https://github.com/uber-go/guide/blob/master/style.md</a></li>
<li><a href="https://github.com/dgryski/awesome-go-style">https://github.com/dgryski/awesome-go-style</a></li>
<li><a href="https://staticcheck.io/docs/checks/">https://staticcheck.io/docs/checks/</a></li>
</ul>
<h2 id="_idParaDest-137"><a id="_idTextAnchor138"/>Mindful code writing</h2>
<p>Most of the time, we are <a id="_idIndexMarker567"/>going to be reading code instead of writing because the process of writing code drives you to read other parts of the code. So, you know where your code goes, how your code follows the existing design, and the behaviors the existing code has so that it doesn’t crash. The important point here is, even if you have no intention to share your code with anyone else, it will be probably forgotten by you in a few months, and if you might need to update it, you will have a hard time understanding what it does. So, write always thinking about someone reading it, even if this is just you. </p>
<p>Therefore, the process of writing code must be much more mindful than the process of reading. When someone reads part of the code, it should not create any doubts; it should be straightforward and easy, and quick to comprehend.</p>
<h2 id="_idParaDest-138"><a id="_idTextAnchor139"/>Making it extremely readable</h2>
<p>When writing code, don’t save words or phrases. If you have the opportunity to choose a mistake when writing your code, choose the one that over-explains your code. Why? Because your code should be <a id="_idIndexMarker568"/>understandable by anyone, and that includes you, in a few months or years. Therefore, make sure your code is easy to understand and easy to follow by someone new.</p>
<h2 id="_idParaDest-139"><a id="_idTextAnchor140"/>Commenting your code</h2>
<p>The code<a id="_idIndexMarker569"/> should be clear to understand; however, sometimes, it is necessary to comment on your code to help readers and reviewers understand your code. You should add comments throughout the code when you want to emphasize nuances in your code, describe details of some algorithms, or warn the reader about something odd. </p>
<h3>Comment headers</h3>
<p>Some text headers in comments<a id="_idIndexMarker570"/> are used to help the reader avoid spending time on code that should or might be changed. When you start coding with your team, check which terms are used for helping code readers and code reviewers. The comment headings listed here are not fixed and change between organizations and teams. Here are the most popular comment headers:</p>
<ul>
<li><code>TODO</code>: Perhaps the most common comment used<a id="_idIndexMarker571"/> is <code>TODO</code>, which is used to designate part of the code that needs to be added or refactored. This comment helps the reviewer avoid spending time reviewing a chunk of code that needs to be modified.</li>
<li><code>FIXME</code>: Some developers when writing code also <a id="_idIndexMarker572"/>use the <code>FIXME</code> comment heading, which designates the part of the code that is wrong, ugly, has performance issues, or is too complicated. Use <code>FIXME</code> when you know something is wrong and should be fixed soon.</li>
<li><code>HACK</code>: This text heading is used to designate <a id="_idIndexMarker573"/>part of the code that has a workaround to fix a bug or to help performance. The <code>HACK</code> heading is also another important comment to show the reader a quick workaround to be fixed later, helping them understand why that part of the code is there.</li>
<li><code>BUG</code>: This <a id="_idIndexMarker574"/>heading is used to show a problem in the code, which must be fixed soon. The author has identified the problem and decided to comment on that part of the code as a bug. The code reviewer can then evaluate and decide whether they have to accept the code with the bug or ask for corrections. Again, these comments save the time of the reviewer as they do not need to evaluate that part of the code in depth. Use this whenever you see a problem in the code.</li>
<li><code>NOTE</code>: This heading is for the author to communicate with the readers some notable gotchas or particular details to help readers understand the code faster. Use them wisely to help reviewers understand, as too <a id="_idIndexMarker575"/>many <code>NOTE</code> headings can also be annoying and create a distraction.</li>
</ul>
<h3>Docstring</h3>
<p>A docstring<a id="_idIndexMarker576"/> refers to a comment string that is used in Python to describe a module, function, class, or method. Docstrings are particular to Python and are detailed in <em class="italic">PEP-257</em>.</p>
<p>Some <strong class="bold">integrated development environments</strong> (<strong class="bold">IDEs</strong>) such as PyCharm and IntelliJ will automatically create a docstring for you as soon as you define a function.</p>
<p>Here’s an example of a multiline docstring for a Python function:</p>
<pre class="source-code">
def router_connection(hostname, timeout):
    """Perform a connection to a router
    :param string hostname:
    :param int timeout:
    :return: True | False
    """
    print("Connecting to host", hostname)
    .
    .
    .
    return True</pre>
<p>Note that the docstring is always initiated and ended with triple-double quotes (<code>"""</code>). The preceding example is a suggestion and other styles are possible. To visualize all possible styles, read the docstring conventions in <em class="italic">PEP-257</em>.</p>
<p class="callout-heading">Note</p>
<p class="callout">Docstring<a id="_idIndexMarker577"/> documentation can be found at <a href="https://peps.python.org/pep-0257/">https://peps.python.org/pep-0257/</a>.</p>
<h3>Godoc</h3>
<p>In Go, there is g<code>odoc</code>, which <a id="_idIndexMarker578"/>is simpler than a docstring as it is not a language construct or machine-readable syntax; it is just string text comments. The convention is simple: to document a variable, function, package, or constant, just write comments directly before its declaration. Here is an example of the comments used for the <code>Asin</code> function in the Go <code>math</code> package:</p>
<pre class="source-code">
// Asin returns the arcsine, in radians, of x.//
// Special cases are:
//
//    Asin(±0) = ±0
//    Asin(x) = NaN if x &lt; -1 or x &gt; 1
func Asin(x float64) float64 {
    if haveArchAsin {
        return archAsin(x)
    }
    return asin(x)
}</pre>
<p>Note that in this example, the comments are placed before the <code>Asin</code> function, and they describe in detail what to expect with the function and its special cases. Comments are always text that starts with a double slash (<code>//</code>).</p>
<p>The preceding example was taken from the Go source code at <a href="https://github.com/golang/go/blob/master/src/math/asin.go#L14-L25">https://github.com/golang/go/blob/master/src/math/asin.go#L14-L25</a>.</p>
<p>After commenting your code in Go, add explanations on functions such as in the preceding example. Developers can use the <code>godoc</code> tool, which extracts text and generates documentation in HTML or TXT format.</p>
<p class="callout-heading">Note</p>
<p class="callout">The <code>godoc</code> documentation is<a id="_idIndexMarker579"/> available at <a href="https://pkg.go.dev/golang.org/x/tools/cmd/godoc">https://pkg.go.dev/golang.org/x/tools/cmd/godoc</a>.</p>
<h2 id="_idParaDest-140"><a id="_idTextAnchor141"/>Use IP libraries</h2>
<p>Newbies in programming for<a id="_idIndexMarker580"/> networks may think IP addresses can be treated as a string or a list of characters. But when dealing with networks, it is very important to use the correspondent IP library to load an IP from a text file or to create <a id="_idIndexMarker581"/>one from a loop. There are several reasons you might want to avoid strings for IPs; some are presented here:</p>
<ul>
<li>Avoid numbers that are out of the scope of an IP, such as the number 256</li>
<li>Avoid malformed text IP addresses</li>
<li>Make sure not to overlap other space addresses</li>
<li>Easy to find the network, mask, and broadcast</li>
<li>Easy transition from IP version 4 to IP version 6</li>
</ul>
<p>Let’s check how to use these IP libraries in Python and Go.</p>
<h3>IP libraries in Python</h3>
<p>The IP address library in <a id="_idIndexMarker582"/>Python did not exist natively until version 3.3. Before version 3.3, Python coders had to use external libraries to handle IP addresses. Python had<a id="_idIndexMarker583"/> to incorporate this library internally after realizing its importance. The transition was documented in <em class="italic">PEP-3144</em> (<a href="https://peps.python.org/pep-3144/">https://peps.python.org/pep-3144/</a>).</p>
<h4>Examples of IP manipulation using Python</h4>
<p>First, let’s print all<a id="_idIndexMarker584"/> valid IP addresses in a subnet:</p>
<pre class="source-code">
import ipaddress
 
network = ipaddress.ip_network("10.8.8.0/30")
print(list(network.hosts()))</pre>
<p>Here’s the output: </p>
<pre class="console">
[IPv4Address('10.8.8.1'), IPv4Address('10.8.8.2')]</pre>
<p>Note that the output type is <code>IPv4Address</code> and not a string. The <code>ipaddress.ip_network()</code> method automatically detects whether it is an IPv4 or IPv6 address.</p>
<p>Now, let’s print the subnets that exist in a larger subnet, excluding one subnet:</p>
<pre class="source-code">
import ipaddress
 
network = ipaddress.ip_network("10.8.8.0/24")
subnet_to_exclude = ipaddress.ip_network("10.8.8.64/26")
print(list(network.address_exclude(subnet_to_exclude)))</pre>
<p>Here’s the output: </p>
<pre class="console">
[IPv4Network('10.8.8.128/25'), IPv4Network('10.8.8.0/26')]</pre>
<p>Note that the<a id="_idIndexMarker585"/> type on the output is not an IP address type as it was before, but a network type called <code>IPv4Network</code>.</p>
<h3>IP libraries in Go</h3>
<p>Go is different<a id="_idIndexMarker586"/> from Python as IP address libraries came after the Go language’s <a id="_idIndexMarker587"/>first version. IP manipulations in Go are faster than in Python because Go is not interpreted like Python but compiled.</p>
<h4>Examples of IP manipulation using Go</h4>
<p>In Go, we are<a id="_idIndexMarker588"/> first going to check whether an IP address belongs to a subnet:</p>
<pre class="source-code">
import (
    "fmt"
    "net"
)
 
func main() {
    _, subnet, _ := net.ParseCIDR("10.8.8.0/29")
    ip := net.ParseIP("10.8.8.22")
    fmt.Println(subnet.Contains(ip))
}</pre>
<p>Here’s the output: <code>false</code>.</p>
<p>The <code>10.8.8.22</code> IP address does not belong to the <code>10.8.8.0/29</code> subnet as the program prints <code>false</code>.</p>
<p>The next example checks whether a subnet belongs to another subnet:</p>
<pre class="source-code">
import (
    "fmt"
    "net/netip"
)
 
func main() {
    first_subnet := netip.MustParsePrefix("10.8.8.8/30")
    second_subnet := netip.MustParsePrefix("10.8.8.0/24")
 
    fmt.Println(second_subnet.Overlaps(first_subnet))
}</pre>
<p>Here’s the output: <code>true</code>.</p>
<p>In this example, <code>first_subnet</code> belongs to <code>second_subnet</code>, so they overlap. Note that in this example, we used a <code>"net/netip"</code> import instead of <code>"net"</code>, which is a newer IP manipulation package introduced to the Go language.</p>
<p>In terms of comparison, the Python built-in library has more features for IP manipulation than the built-in Go IP packages. On the other hand, Go can manipulate IPs faster.</p>
<p>If you are looking <a id="_idIndexMarker589"/>for particular features for IP manipulation that are not present in <code>net</code> or <code>net/netip</code>, you can use a newly developed community package called <code>inet.af/netaddr</code>, described at <a href="https://pkg.go.dev/inet.af/netaddr">https://pkg.go.dev/inet.af/netaddr</a>.</p>
<h2 id="_idParaDest-141"><a id="_idTextAnchor142"/>Follow naming conventions</h2>
<p>It is wise to verify with your team what the<a id="_idIndexMarker590"/> local development name conventions are before starting to publish any code for review. There are particular differences that might be a problem to use in your organization. Here, we are going to describe the most popular name conventions used, but feel free to adapt this to your local team culture.</p>
<p>Before starting to describe the name conventions, let’s define three ways of writing multi-word names, as listed here:</p>
<ul>
<li><code>myFirstTestName</code></li>
<li><code>MyFirstTestName</code></li>
<li><code>my_first_test_name</code></li>
</ul>
<p>In the case of defining constants, all characters in the name must be in uppercase for most programming languages. Therefore, snake case is used always in lowercase, unless the name is describing a <a id="_idIndexMarker594"/>constant. Here’s an example of a name describing a constant that will define the maximum storage capacity: <code>MAX_STORAGE_CAPACITY</code>.</p>
<h3>Naming in Python</h3>
<p>For Python, there are a few <a id="_idIndexMarker595"/>rules to follow when writing variable names. Here is a short list of what to do:</p>
<ul>
<li>Variable names can start only with letters or underscore characters (<code>_</code>)</li>
<li>The variable name can only have alphanumeric characters and underscores</li>
<li>Never start a variable name with a number</li>
<li>Dashes (<code>-</code>) are used only for package and module names, never for variables</li>
<li>Double underscore characters starting in variables are reserved for Python</li>
<li>Use pascal case for class names</li>
<li>Use snake case for module names and functions</li>
<li>Constants in Python use <a id="_idIndexMarker596"/>all uppercase characters—for example, <code>MYCONSTANT</code></li>
</ul>
<p class="callout-heading">Note</p>
<p class="callout">Google has a created a great name convention guide<a id="_idIndexMarker597"/> for Python, available publicly at <a href="https://google.github.io/styleguide/pyguide.html#316-naming">https://google.github.io/styleguide/pyguide.html#316-naming</a>.</p>
<h3>Naming in Go</h3>
<p>For Go, there are a few rules to <a id="_idIndexMarker598"/>follow. Here is a list of the major ones to follow:</p>
<ul>
<li>Variable names use camel case or pascal case</li>
<li>As with variable names, function names use camel case or pascal case</li>
<li>Variable or function names don’t start with a number</li>
<li>Use only alphanumeric characters for variable and function names</li>
<li>Dashes or underscores are normally not used for names</li>
<li>Go allows the use of snake case for variable names, but check whether your organization’s name convention allows it, because it is not common to use snake case in the Go community</li>
<li>Constants in Go are like in Python: use all uppercase characters</li>
</ul>
<p>Moreover, Go has a particular difference from other languages, and uses uppercase in the variables inside a Go package (or module). So, if the variable name starts with uppercase, it is normally a variable that can be accessed from outside the Go package. When the variable starts with lowercase, it’s a local variable that is only accessible with code within the same Go package.</p>
<p class="callout-heading">Note</p>
<p class="callout">A good reference for names in <a id="_idIndexMarker599"/>Go can be obtained at <a href="https://go.dev/doc/effective_go">https://go.dev/doc/effective_go</a>.</p>
<h2 id="_idParaDest-142"><a id="_idTextAnchor143"/>Don’t shorten variable names</h2>
<p>In the early times of<a id="_idIndexMarker600"/> computer programming, variable names had to be small to save more space in memory when saving the uncompiled code. But today, this is not a problem, so don’t save memory when writing variable names.</p>
<p>If you have to write a variable for representing the number of birds flying, write <code>number_of_birds_flying</code> in snake case or <code>numberOfBirdsFlying</code> in camel case.</p>
<p>There is an exception to this rule if you are using variables inside list comprehension or variables in a loop such as <a id="_idIndexMarker601"/>counters or indexes; then, shortened variables are okay to use.</p>
<h2 id="_idParaDest-143"><a id="_idTextAnchor144"/>Avoid complex loops</h2>
<p>Loops are added to code for<a id="_idIndexMarker602"/> several reasons: to increment, interact with a list, repeat an operation, and read a stream, among others. It is possible to use loops for deterministic or non-deterministic sizes, which can be very useful when you don’t know what you are going to interact with.</p>
<p>But irrespective of the intention you are using a loop in your code for, use them wisely so that they don’t become unreadable or too complex to understand. A good rule of thumb is to avoid too many lines inside a loop. I would say that 20 lines would be the limit. Another good practice is to avoid nested loops or loops within loops. If you have to do a nested loop, limit the number of levels to no more than two. Loops are hard to read when they are nested, and even worse when there are too many lines inside them.</p>
<p>So, what is the best way to create a loop with fewer than 20 lines? The suggestion is to group a few operations into functions that can be called inside the loop. Name the function whatever you want it to do, and add the operations to it. When you are reading the loop, the function call will be easy to spot and the name of the function will indicate what the operation is doing, which is really easy to read and understand. Also, it is easier to write unit tests when using this approach.</p>
<p>How to avoid nested loops? Use functions to call a loop. Instead, you can also use generators, list comprehensions, or maps to avoid loops. Using maps has the advantage of making your code even faster as you don’t need to interact with it. List comprehensions are used in Python. Generators can be used in Python and are implemented using goroutines in Golang. So, whenever you need a nested loop, try not to overcomplicate it, and, if possible, use one of these mechanisms to avoid it.</p>
<h2 id="_idParaDest-144"><a id="_idTextAnchor145"/>Don’t repeat code</h2>
<p>In software <a id="_idIndexMarker603"/>development, there is one term that is called <strong class="bold">DRY</strong> or <strong class="bold">Don’t Repeat Yourself</strong>. The worst a <a id="_idIndexMarker604"/>developer can do is repeat code. Yes, it is bad—really bad. Why? Because if you write code that performs a task over and over in multiple places, whenever you want to modify that task, you will be required to carry out the same change in several places. The other problem is that you will have to write multiple unit tests for the same task.</p>
<p>The opposite view of DRY is <strong class="bold">WET</strong>, which stands<a id="_idIndexMarker605"/> for <strong class="bold">Write Everything Twice</strong>. A WET solution might occur because of multi-tiered architecture where developers have different tasks, and in the end, repetition may happen. A DRY approach should eliminate code redundancy by using a framework that helps developers avoid repetition.</p>
<p>In this section, we have seen some examples of how we can use best practices when writing code. In the next section, we are going to explore how we can use tools to help us write better code.</p>
<p class="callout-heading">Note</p>
<p class="callout">There are many more suggestions on best practices when writing code. A more extensive list can be found at <a href="https://github.com/golang/go/wiki/CodeReviewComments">https://github.com/golang/go/wiki/CodeReviewComments</a> and https://go.dev/doc/effective_go.</p>
<p class="callout">For Python, I recommend the book <em class="italic">Effective Python</em> by Scott Meyers.</p>
<h1 id="_idParaDest-145"><a id="_idTextAnchor146"/>Coding formatters</h1>
<p>As we can now see, there are<a id="_idIndexMarker606"/> several rules and conventions to follow when writing code in Go or Python, and the list is long, which does not help when you are a beginner. But thanks to the community, there are tools that help to fix the code format for you. These tools can automatically fix your code or suggest modifications. Let’s have a look at a few code formatters for Python and Go.</p>
<h2 id="_idParaDest-146"><a id="_idTextAnchor147"/>Python Black</h2>
<p><strong class="bold">Black</strong> is a <a id="_idIndexMarker607"/>very <a id="_idIndexMarker608"/>popular code formatter for Python. It is <em class="italic">PEP-8</em> compliant, so it checks all <em class="italic">PEP-8</em> recommendations. The default run will reformat the code to be <em class="italic">PEP-8</em> compliant, but you can run it as a preview to identify the code change suggestions.</p>
<p>With Black, it is possible to fix Python code automatically. Here is an example of wrong code written for Python:</p>
<pre class="source-code">
if long_variable_name is not None and \
 long_variable_name.field &gt; 0 or long_variable_name.is_debug:
 z = 'hello '+'world'
else:
 world = 'world'
 a = 'hello {}'.format(world)
 f = rf'hello {world}'</pre>
<p>After running Black, the code will look like this:</p>
<pre class="source-code">
if (
    long_variable_name is not None
    and long_variable_name.field &gt; 0
    or long_variable_name.is_debug
):
    z = "hello " + "world"
else:
    world = "world"
    a = "hello {}".format(world)
    f = rf"hello {world}"</pre>
<p>Black does apply all recommendations of <em class="italic">PEP-8</em> and also has its own style. In the preceding example, Black has correctly changed the <code>if</code> statement and added the correct indentation. In addition, it changed the strings assignment from single quotes to double quotes. There is no specific PEP designating if you have to write strings with double or single quotes, but Black’s own style uses double quotes for strings.</p>
<p>I personally think code that has single quotes in some strings and double quotes in other strings looks very ugly. So, I would recommend using double quotes only for strings, as Black does.</p>
<p class="callout-heading">Note</p>
<p class="callout">More on Python<a id="_idIndexMarker609"/> Black can be found here: <a href="https://github.com/psf/black">https://github.com/psf/black</a>.</p>
<h2 id="_idParaDest-147"><a id="_idTextAnchor148"/>Python isort</h2>
<p>One important bit<a id="_idIndexMarker610"/> that is not actually explained easily are the import lines that are present in the Python code. Sometimes there are dozens of imports, and if they are not properly <a id="_idIndexMarker611"/>organized, it is difficult to realize which ones are used and which are not.</p>
<p>Thanks to the <code>isort</code> utility, it is possible to fix <code>import</code> statements, group them correctly, and sort them automatically.</p>
<p>Here is one example of code that has a loose ugly <code>import</code> statement:</p>
<pre class="source-code">
from central_lib import Path
import os
from central_lib import Path3
from central_lib import Path2
import sys
from my_lib import lib15, lib1, lib2, lib3, lib4, lib5, lib6, lib7, lib8, lib9, lib10, lib11, lib12, lib13, lib14
import sys</pre>
<p>After running <code>isort</code>, the code looks like this:</p>
<pre class="source-code">
import os
import sys
from my_lib import (lib1, lib2, lib3, lib4, lib5, lib6,
                    lib7, lib8, lib9, lib10, lib11, lib12,
                    lib13, lib14, lib15)
from central_lib import Path, Path2, Path3</pre>
<p>Note that <code>isort</code> grouped the imports and sorted them in a predictable way. If you need to add extra imports, you will not repeat or miss them.</p>
<p class="callout-heading">Note</p>
<p class="callout">More on <code>isort</code> can be<a id="_idIndexMarker612"/> found here: <a href="https://pypi.org/project/isort/">https://pypi.org/project/isort/</a>.</p>
<h2 id="_idParaDest-148"><a id="_idTextAnchor149"/>Python YAPF</h2>
<p>Although <em class="italic">PEP-8</em> guidelines may allow you to write code in a way that other developers will appreciate, it<a id="_idIndexMarker613"/> does not necessarily mean your code looks good. The <strong class="bold">YAPF</strong> acronym is not actually <a id="_idIndexMarker614"/>explained on the tool’s page, but it perhaps means <strong class="bold">Yet Another Python Formatter</strong>.</p>
<p>In essence, YAPF is similar to Black, which has its own style besides the <em class="italic">PEP-8</em> recommendations, but a major difference is that it can be configured for fine-tuning style formatting.</p>
<p>YAPF is based on <code>clang-format</code> developed by Daniel Jasper, which takes the original code and reformats it using the YAPF style guide, even if the original code did not violate any <em class="italic">PEP-8</em> guidelines. If used in all code, the style remains consistent throughout the project, and reviewers would not need to discuss or argue about the style during code review.</p>
<p class="callout-heading">Note</p>
<p class="callout">More on YAPF can be <a id="_idIndexMarker615"/>found here: <a href="https://github.com/google/yapf">https://github.com/google/yapf</a>.</p>
<p>YAPF, <code>isort</code>, and Black are the three major Python code formatters, but the list of Python formatters is very extensive. Other formatters can be found at <a href="https://github.com/life4/awesome-python-code-formatters">https://github.com/life4/awesome-python-code-formatters</a>.</p>
<h2 id="_idParaDest-149"><a id="_idTextAnchor150"/>Go gofmt</h2>
<p>The Go language has its own <a id="_idIndexMarker616"/>formatter that comes with the Go language package, and it is called <code>gofmt</code>. Its <a id="_idIndexMarker617"/>objective is similar to Python Black and Python YAPF, which formats the source code to the best format that can be done consistently. The formatter is used with the CLI command of <code>go</code>—for example, <code>go fmt myprogram.go</code>.</p>
<p>Some platforms run automatically <code>gofmt</code> every time you want to build or run a Go program.</p>
<h2 id="_idParaDest-150"><a id="_idTextAnchor151"/>Go golines</h2>
<p><code>golines</code> is a <a id="_idIndexMarker618"/>formatter that shortens long lines in addition to fixes done by <code>gofmt</code>. This formatter was <a id="_idIndexMarker619"/>created because <code>gofmt</code> does not break long lines and it is hard to visualize when lines are too long.</p>
<p>Here is an example before running <code>golines</code>:</p>
<pre class="source-code">
myVariable := map[string]string{"a key": "a value", "b key": "b value", "c key": "c value", "d key": "d value", "e key": "e value"}</pre>
<p>After running <code>golines</code>, the code looks like this:</p>
<pre class="source-code">
myVariable := map[string]string{
            "a key": "a value",
            "b key": "b value",
            "c key": "c value",
            "d key": "d value",
            "e key": "e value"
}</pre>
<p>More details <a id="_idIndexMarker620"/>on how <code>golines</code> works are available at <a href="https://yolken.net/blog/cleaner-go-code-golines">https://yolken.net/blog/cleaner-go-code-golines</a>.</p>
<h2 id="_idParaDest-151"><a id="_idTextAnchor152"/>Go golangci-lint</h2>
<p>A programming language lint or linter is <a id="_idIndexMarker621"/>software used to point errors, bugs, style errors, and<a id="_idIndexMarker622"/> suspicious constructs in the source code. It does not fix these automatically but flags errors and warnings to be fixed. For Go, the best linter<a id="_idIndexMarker623"/> package is <code>golangci-lint</code>, described in detail at <a href="https://golangci-lint.run/">https://golangci-lint.run/</a>. The original linter used for Go was located at <a href="https://github.com/golang/lint">https://github.com/golang/lint</a> but was deprecated and frozen because of a lack of contribution.</p>
<p>There are several checks that <code>golangci-lint</code> can do. The default most important checks are listed here:</p>
<ul>
<li><code>govet</code>: Checks whether format strings in <code>Printf</code> calls have correct aligned arguments</li>
<li><code>unused</code>: Checks unused variables, functions, and types</li>
<li><code>gosimple</code>: Points to parts of the code that can be simplified</li>
<li><code>structcheck</code>: Verifies unused struct fields</li>
<li><code>deadcode</code>: Verifies any<a id="_idIndexMarker624"/> code <a id="_idIndexMarker625"/>that is not being used</li>
</ul>
<p>A complete list of linters <a id="_idIndexMarker626"/>available can be found at <a href="https://golangci-lint.run/usage/linters/">https://golangci-lint.run/usage/linters/</a>.</p>
<p class="callout-heading">Note</p>
<p class="callout">A list of additional Go code formatters<a id="_idIndexMarker627"/> can be obtained at <a href="https://github.com/life4/awesome-go-code-formatters">https://github.com/life4/awesome-go-code-formatters</a>.</p>
<p>There are many more awesome tools that can format your code, not only via command-line tools but also via integrated IDE formatting tools. This section was created to introduce some of the tools used by Python and Go and show how to use them to help your code improve. In the next section, we are going to talk about how to use tools when developing code to help concurrent development and versioning.</p>
<h1 id="_idParaDest-152"><a id="_idTextAnchor153"/>Versioning and concurrent development</h1>
<p>Nowadays, writing code is not only about the lines of code you are creating but also about the code others are writing to contribute to your software. In addition, code that has changes requires some information regarding why the changes are there and some version tags to identify these so that developers can easily revert changes or use different versions when testing or deploying.</p>
<p>How can we accomplish such tasks when writing code? The best answer is to use a version control system. Today the most<a id="_idIndexMarker628"/> popular<a id="_idIndexMarker629"/> free tools are <strong class="bold">Git</strong>, <strong class="bold">SVN</strong>, <strong class="bold">Mercurial</strong>, and <strong class="bold">CVS</strong>. Git, for <a id="_idIndexMarker630"/>sure, is the most popular of all, basically because of Linux and the <a id="_idIndexMarker631"/>growth of the GitHub website. <em class="italic">Table 5.2</em> shows a quick comparison between these <a id="_idIndexMarker632"/>four version control systems.</p>
<table class="No-Table-Style _idGenTablePara-1" id="table002-1">
<colgroup>
<col/>
<col/>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><strong class="bold">Version system</strong></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold">Year created</strong></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold">Famous for</strong></p>
</td>
<td class="No-Table-Style">
<p><strong class="bold">Website</strong></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Git</p>
</td>
<td class="No-Table-Style">
<p>2005</p>
</td>
<td class="No-Table-Style">
<p>Linux and <a href="http://github.com">github.com</a></p>
</td>
<td class="No-Table-Style">
<p><a href="http://www.git-scm.com">www.git-scm.com</a></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>SVN</p>
</td>
<td class="No-Table-Style">
<p>2000</p>
</td>
<td class="No-Table-Style">
<p>FreeBSD and <a href="http://sourceforge.com">sourceforge.com</a></p>
</td>
<td class="No-Table-Style">
<p><a href="http://subversion.apache.org">subversion.apache.org</a></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>CVS</p>
</td>
<td class="No-Table-Style">
<p>1986</p>
</td>
<td class="No-Table-Style">
<p>NetBSD and OpenBSD</p>
</td>
<td class="No-Table-Style">
<p><a href="http://www.nongnu.org/cvs/">www.nongnu.org/cvs/</a></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p>Mercurial</p>
</td>
<td class="No-Table-Style">
<p>2005</p>
</td>
<td class="No-Table-Style">
<p>Python and Mozilla</p>
</td>
<td class="No-Table-Style">
<p><a href="http://www.mercurial-scm.org">www.mercurial-scm.org</a></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 5.2 – Most popular version control systems comparison</p>
<p>When writing code, it is recommended to use a source version control system, which allows the software to be edited by multiple developers at the same mechanism to avoid adding code to the system without syncing the changes. Several different terms are used in versioning systems; the terms are almost the same over different systems such as Git or SVN.</p>
<p>Let’s describe the most common commands used by versioning systems.</p>
<h2 id="_idParaDest-153"><a id="_idTextAnchor154"/>clone</h2>
<p><code>clone</code> is a <a id="_idIndexMarker633"/>command<a id="_idIndexMarker634"/> to copy the whole source code, including subdirectories and versioning system data, to your local directory.</p>
<p>Here’s an example of the command being used in Git: <code>git clone https://github.com/brnuts/matrix.git</code>.</p>
<h2 id="_idParaDest-154"><a id="_idTextAnchor155"/>checkout</h2>
<p><code>checkout</code> is <a id="_idIndexMarker635"/>a command to update files in the working directory to match the<a id="_idIndexMarker636"/> source tree source code. It is also used to switch to another code branch.</p>
<p>Here’s an example of the command being used in Git for updating the current branch: <code>git checkout</code>.</p>
<p>And here’s an example of it being used in Git for checking out another branch: <code>git checkout mybranch</code>.</p>
<h2 id="_idParaDest-155"><a id="_idTextAnchor156"/>commit</h2>
<p>While changing the <a id="_idIndexMarker637"/>source code is <a id="_idIndexMarker638"/>recommended to change small chunks, each small change should attach a text tag describing the changes. The <code>commit</code> command is a command that adds a text tag to the code and a checkpoint number. As your code changes, you add commits to each small change. After the whole change is complete, you will have a change log that has multiple commit text explanations, helping the reader understand why and how the changes were made.</p>
<h2 id="_idParaDest-156"><a id="_idTextAnchor157"/>Mainline</h2>
<p><strong class="bold">Mainline</strong> is <a id="_idIndexMarker639"/>normally the name of the main <strong class="bold">branch</strong> of the code. Other branches <a id="_idIndexMarker640"/>of the code normally ramify from the main branch or from other branches, which after ramification have a parent branch. In this sense, the mainline is a branch that has no parent branch.</p>
<p>The mainline branch is known as the trunk of the source code tree and can also be called <strong class="bold">master</strong> or sometimes <strong class="bold">baseline</strong>.</p>
<h2 id="_idParaDest-157"><a id="_idTextAnchor158"/>Branching</h2>
<p>You can use <a id="_idIndexMarker641"/>versioning systems to create branches in <a id="_idIndexMarker642"/>your code. A <strong class="bold">branch</strong> is normally a ramification of the code from another branch. The goal of having a branch is to make particular changes to the code without interfering with the parent branch.</p>
<p>The code branch can then have as many changes as needed, and when ready can be added to the parent branch by using the <code>merge</code> command.</p>
<p>There are several advantages of using branches—one of them is to clarify the communication on the intention of a large change by adding several small change <strong class="bold">commits</strong> on the<a id="_idIndexMarker643"/> branch, with an explanation of each <a id="_idIndexMarker644"/>change. Another advantage is to allow other developers to continue to add changes to the parent branch.</p>
<p>A branch without a parent branch is the mainline branch or the master branch.</p>
<h2 id="_idParaDest-158"><a id="_idTextAnchor159"/>Merging</h2>
<p>A code <code>merge</code> command<a id="_idIndexMarker646"/> checks whether code can be added without interfering with the mainline branch code. If there is interference, it will create code <code>merge</code> command can also be done between individual branches without a mainline.</p>
<p>The merging technique is the safest technique used to combine branches without compromising any code that differs from other code. But sometimes, there are so many conflicts to be resolved that this might not be feasible. When that occurs, it is recommended to start a new branch and try to add the changes, gradually merging eventually, or to use the <code>rebase</code> command, which allows the commit to be applied from one branch to another branch interactively if necessary.</p>
<p>Have a look at the following diagram:</p>
<div><div><img alt="Figure 5.3 – A description of the mainline commits and branches" src="img/B18165_05_003.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.3 – A description of the mainline commits and branches</p>
<p><em class="italic">Figure 5.3</em> shows an <a id="_idIndexMarker648"/>example with all details of the versioning system for the mainline and the branches. You can also spot the commits and merges that are done for each branch and for the mainline as well. Note that branch 1 (green) was created to add two files, called <code>LICENSE</code> and <code>COPYRIGHT</code>, then was merged to the mainline. Branch 2 was created from a <code>432384DC</code> commit and has not been merged to the mainline yet.</p>
<p>In this section, we investigated how versioning tools help a great deal when developing code concurrently. Use a versioning system whenever you can to organize your development. In the next section, we are going to explore why and how we add testing to our code.</p>
<h1 id="_idParaDest-159"><a id="_idTextAnchor160"/>Testing your code</h1>
<p>Testing code is another<a id="_idIndexMarker649"/> subject that has grown in the past decades. In the early '70s, testing code was not actually part of the development process but part of the debugging process when there was a problem with the software. Testing assumed significance when American computer scientist Glenford Myers published the classic book <em class="italic">The Art of Software Testing</em> in 1979, proposing the separation of debugging from testing.</p>
<p>Since then, much has improved in the development process with testing. Today, it is about preventing errors, and the<a id="_idIndexMarker650"/> process to develop code with tests that prevent errors is called <strong class="bold">test-driven development</strong> or <strong class="bold">TDD</strong>.</p>
<p>In the process of developing the code, the developer must identify two parts of the code: <strong class="bold">testable</strong> and <strong class="bold">non-testable</strong> code. Testable code<a id="_idIndexMarker651"/> is pieces of code that are easily verified by low-level testing, such as <a id="_idIndexMarker652"/>a unit test. Non-testable code is pieces of code (such as the import of a library) that are not easily tested at a lower level and normally are tested with higher-level testing such as integration tests.</p>
<p>Therefore, when writing code, the developer must be mindful of when and how tests would be performed for that part of the code. The developer will easily identify which part of the code can be done with lower- or higher-level testing. There are several levels of testing. Let’s discuss a few of them in the following subsections.</p>
<h2 id="_idParaDest-160"><a id="_idTextAnchor161"/>Unit testing</h2>
<p><strong class="bold">Unit tests</strong> are<a id="_idIndexMarker653"/> the lower level of testing because they are intended to cover a small part of code, which is the smallest piece of code that can be logically isolated. These pieces of<a id="_idIndexMarker654"/> code can be subroutines, functions, methods, loops, or properties. The goal of unit tests is to show that individual parts of the code are correct and—when used in methods or functions—to make sure they work as expected.</p>
<p>If in the future, code has its libraries or modules upgraded or refactored, the unit tests created before are able to identify whether the code still works with the change, making it robust against eventual bugs introduced with upgrades. For that, unit tests have to be written to cover all functions, modules, methods, and properties; then, whatever change happens that could cause a fault would be quickly identified by the unit tests.</p>
<p>Unit tests can be written in several ways: some would write a function and then write the unit tests for this function; some would write the unit tests and then write the function. When unit <a id="_idIndexMarker655"/>tests are written first, this is normally <a id="_idIndexMarker656"/>called <strong class="bold">test-driven development</strong> (<strong class="bold">TDD</strong>) or <strong class="bold">extreme programming</strong> (<strong class="bold">XP</strong>).</p>
<p>As some code cannot be tested with unit tests, each team and organization has a <strong class="bold">test coverage</strong> parameter<a id="_idIndexMarker657"/> used to evaluate each software package. The number varies, but normally it is higher than 50% test coverage for the software package, and something higher than 80% for all new functions and methods introduced.</p>
<p>Unit tests<a id="_idIndexMarker658"/> are easy to create when a function or method has clear input parameters and some outputs, but it is not easy to create when a function interacts with external<a id="_idIndexMarker659"/> elements such as a database. For dealing with these external environments, some languages have <strong class="bold">mock capabilities</strong> (or <strong class="bold">mockups</strong>) to <a id="_idIndexMarker660"/>simulate the external behavior, without doing it.</p>
<p>If part of the code is not unit-testable (mocks are not available), it will probably be covered by higher-level testing, as with the ones we are going to talk about next.</p>
<h2 id="_idParaDest-161"><a id="_idTextAnchor162"/>Integration testing</h2>
<p><strong class="bold">Integration tests</strong> are <a id="_idIndexMarker661"/>used to fill the gaps of tests not possible to be performed with unit<a id="_idIndexMarker662"/> tests. These are normally tests that touch or require external environments such as databases, external files, or service APIs.</p>
<p>From a testing order perspective, integration testing is the second step after the unit tests have been done successfully and <a id="_idIndexMarker663"/>before the <strong class="bold">end-to-end</strong> (<strong class="bold">E2E</strong>) testing (if required). Integration testing normally uses broader code coverage in terms of modules and functions. It groups them into a large aggregate and applies a test plan to validate the expected outputs. Individual functions and modules are tested using unit tests. During integration tests, they are not necessarily tested individually but in a higher-level group.</p>
<p>It is important to set up a test environment that can support integration testing, such as an external test database. During integration tests, the mockups added in the unit tests are not used, but real external testing environments are used. The external testing environment is normally separated from production and is dedicated to integration testing.</p>
<p>When performing integration tests, the test environment should behave in the same manner as the production environment, or at least very close to production. With similar production behavior, we can have more confidence, after the integration tests are passed, that the software will work in production.</p>
<p>Unit tests can <a id="_idIndexMarker664"/>run on someone’s computer; on the other hand, integration tests<a id="_idIndexMarker665"/> can’t because they rely on a testing environment that would validate the external communication from the software. Someone might say, <em class="italic">set up an environment for integration testing on your computer</em>, but it would then not be possible to validate some tests that require consistency.</p>
<h2 id="_idParaDest-162"><a id="_idTextAnchor163"/>E2E testing</h2>
<p>Most tests can be<a id="_idIndexMarker666"/> done by unit tests and integration tests; however, some might <a id="_idIndexMarker667"/>still be missing. <strong class="bold">E2E tests</strong> are added in another level of testing, which will evaluate the overall software, including performance, under a production-like environment. </p>
<p>If possible and allowed, the ideal way is to run the E2E testing in the production environment. If it is not possible to run this in production, an isolated production-like environment can be used. The goal is to simulate the real scenario of the software running from the start to the end so that passing tests can validate the software and can be used without restrictions in production.</p>
<p>In terms of testing time and cycle, the E2E test should run last, as these tests take much longer to run than the integration tests. The test coverage should cover broader behavior, not only touching external interfaces but also using the whole workflow process that the software belongs to.</p>
<p>To summarize unit tests, integration tests, and E2E tests, let’s use an example. Imagine your software creates a robot that can paint cars. What would the responsibility of each testing level be? Here’s a possible implementation:</p>
<ul>
<li><strong class="bold">Unit tests</strong>: Lower-level testing of small modules of the software:<ul><li>Move <em class="italic">x</em>, <em class="italic">y</em>, and <em class="italic">z</em> directions</li><li>Self-identify unalignments</li><li>Identify which color a container has</li><li>Spray paint evenly in all directions</li><li>Don’t leak paint</li><li>Identify the ending paint in the container</li></ul></li>
<li><strong class="bold">Integration tests</strong>: Higher-level testing with external modules:<ul><li>Can paint a car full</li><li>Can refill paint in an empty paint container</li><li>Can paint car with different colors</li><li>Doesn’t leave blank color spots in the car</li></ul></li>
<li><strong class="bold">E2E tests</strong>: These would be the higher level, ultimate tests:<ul><li>Car can be painted in <em class="italic">X</em> minutes</li><li>No interference on the next car or previous car when painting the current car</li><li>Robot can paint <em class="italic">Y</em> number of cars per hour, with paint refill and color change</li></ul></li>
</ul>
<p>As we can see in this example, the number of tests is normally higher when the level of testing is lower. So, unit tests would have more tests than integration or E2E tests. However, the time to run tests is slower as we go higher up the levels. E2E testing should take longer to finish than integration or unit tests.</p>
<h2 id="_idParaDest-163"><a id="_idTextAnchor164"/>Other testing</h2>
<p>There are several other testing classifications. For our network automation, we are going to use only the three levels we just described: unit tests, integration tests, and E2E tests. The others we are going to explain here, for reference, can be added to your automation work if you think they are necessary.</p>
<p>Let’s talk briefly about them now.</p>
<h3>System testing</h3>
<p>Technically speaking, all tests can be done by unit tests, integration tests, and E2E testing. The <strong class="bold">system testing</strong> is <a id="_idIndexMarker668"/>to add an extra testing phase that can be used to evaluate the<a id="_idIndexMarker669"/> system’s compliance with the specified requirements. Therefore, system testing is another name for testing in a formal procedure to verify that all requirements have been met.</p>
<h3>Acceptance testing</h3>
<p>When<a id="_idIndexMarker670"/> dealing with projects that involve end customers, it is important to align the<a id="_idIndexMarker671"/> expectations of the behavior of the software. Acceptance testing is a mechanism to negotiate and communicate with the end customer about the correct behavior of the system. <strong class="bold">Acceptance tests</strong> are like a contract between the end customer and the developer to delineate the final delivery of the software. The end customer is normally involved when selecting a test plan and tests so that the tests cover the system’s behavior and expectations.</p>
<p>The usual terms<a id="_idIndexMarker672"/> used here <a id="_idIndexMarker673"/>are <strong class="bold">user acceptance test</strong> (or <strong class="bold">UAT</strong>) and <strong class="bold">operational acceptance test</strong> (or <strong class="bold">OAT</strong>).</p>
<p>If your network automation code is highly dependable on a customer’s use, with clear requirements, I would highly recommend writing test cases with the customer for UAT and OAT. But if your work is for internal usage and has no end-user requirements, integration and unit tests are sufficient.</p>
<h3>Security testing</h3>
<p>If your software is deployed in restricted or vulnerable areas or touches network devices in a sensitive area, you might need to run security testing. Different from the other tests, <strong class="bold">security testing</strong> focuses<a id="_idIndexMarker674"/> on vulnerabilities of the code that you have created <a id="_idIndexMarker675"/>and also on all module dependencies that are imported by your code. The versions of all modules are also checked, and some versions might be prohibited because of some internal security policies.</p>
<p>One additional test is <a id="_idIndexMarker676"/>called a <strong class="bold">pentest</strong> or a <strong class="bold">penetration test</strong>, which is performed on the system your software is created on. The idea of a pentest is to perform a simulated cyberattack on the final system used by your code. The test has the objective of identifying weaknesses and potential access for unauthorized people to data or the system.</p>
<p>Security testing also verifies the password management in the code and any cryptography used. There are some best practices when using passwords, such as cryptography and secrets that reduce the risk of unauthorized people accessing the system.</p>
<p>For our network automation, security testing would be required if the devices we are going to automate were located in a vulnerable area, or if the software might be exposed to external parties or<a id="_idIndexMarker677"/> to the internet. But in general, there is no need for security testing for internal <a id="_idIndexMarker678"/>usage.</p>
<p>For sure, there is more to discuss in terms of security testing, but that would probably require a book on its own.</p>
<h3>Destructive testing</h3>
<p><strong class="bold">Destructive software testing</strong> or <strong class="bold">DST</strong> is performed in the software to evaluate the robustness of the final system<a id="_idIndexMarker679"/> with the code that has been added. The<a id="_idIndexMarker680"/> tests are intended to stress the system or to enter invalid inputs so that the software starts to fail. The success of the test is to expose possible design weaknesses and performance limitations under normal and strained conditions.</p>
<p>Failures during destructive tests are seen as good results if the system shows clearly the methods it has used to recover or to avoid breaking down completely. The performance is measured under the test, and the system resources are stressed to the maximum until degradation or failure occurs. It is possible to use the measurements taken during the performance stress later to add input system limitations for the current implementation, consequently avoiding any degradation.</p>
<h3>Alpha and beta testing</h3>
<p>When tests <a id="_idIndexMarker681"/>are performed before going to production, some would call them <strong class="bold">alpha</strong> or <strong class="bold">beta testing</strong>. Normally, alpha<a id="_idIndexMarker682"/> tests are performed before beta tests, just because of the alphabetical order. The tests are not necessarily different from integration or E2E testing, but normally they are performed in a production-like environment, or sometimes in production.</p>
<p>Some beta<a id="_idIndexMarker683"/> tests also<a id="_idIndexMarker684"/> involve customers that are aware of the new features being tested and can help evaluate the new software before it goes to other customers in production. Therefore, beta testing would be the final stage before the software is considered reliable enough to be deployed in full production. Beta and alpha tests can have windows of testing that can last from hours to days.</p>
<h1 id="_idParaDest-164"><a id="_idTextAnchor165"/>Summary</h1>
<p>Congratulations! At this point, you are familiar with the coding practices used today. You know how to use tools to help your source code in terms of quality and concurrent development. You are also able to perceive the importance of having unit tests and integration tests added to your code.</p>
<p>From now on, as a new code developer for automation, you are more equipped with the jargon and terms used in the software development community. You are able to improve not only the quality of your code but also your team’s code quality. Use the tools and the topics discussed here throughout your automation development career.</p>
<p>In the next chapter, we are going to have more practical examples of how to use Go and Python for network automation. We are going to explore some examples of automation in Go and Python and compare them.</p>
</div>
</body></html>