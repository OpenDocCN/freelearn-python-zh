<html><head></head><body>
  <div class="Basic-Text-Frame" id="_idContainer105">
    <h1 class="chapterNumber">7</h1>
    <h1 class="chapterTitle" id="_idParaDest-172">Network Monitoring with Python – Part 1</h1>
    <p class="normal">Imagine you get a call from your company’s network operations center at 2:00 a.m. The person on the other end says: “Hi, we are facing a difficult issue that is impacting production services. We suspect it might be network related. Can you check for us?” For this type of urgent, open-ended question, what would be the first thing you do? Most of the time, the thing that comes to mind would be: What changed in the time between when the network was working and when something went wrong? We would check our monitoring tool and see if any key metrics have changed in the last few hours. Better yet, we may have received monitoring alerts for any metrics that deviated from the normal baseline numbers.</p>
    <p class="normal">Throughout this book, we have been discussing various ways to systematically make predictable changes to our network, intending to keep the network running as smoothly as possible. However, networks are not static – far from it. They are probably one of the most fluid parts of the entire infrastructure. By definition, a network connects different parts of the infrastructure, constantly passing traffic back and forth.</p>
    <p class="normal">There are lots of moving parts that can cause our network to stop working as expected: hardware failures, software with bugs, human mistakes despite their best intentions, and many more. It is not a question of whether things will go wrong but of when and what will go wrong when it happens. We need ways to monitor our network to make sure it works as expected and hopefully be notified when it does not.</p>
    <p class="normal">In the upcoming two chapters, we will look at various ways to perform network monitoring tasks. Many tools we have looked at thus far can be tied together or directly managed by Python. Like many tools we have looked at, network monitoring has two parts.</p>
    <p class="normal">First, we need to know what monitoring-related information the equipment can transmit. Second, we need to identify what useful, actionable information we can interpret from the data.</p>
    <p class="normal">In this chapter, we will begin by looking at a few tools that allow us to monitor the network effectively:</p>
    <ul>
      <li class="bulletList">The lab setup</li>
      <li class="bulletList">The <strong class="keyWord">Simple Network Management Protocol </strong>(<strong class="keyWord">SNMP</strong>) and related Python libraries to work with SNMP</li>
      <li class="bulletList">Python visualization libraries:<ul>
          <li class="bulletList">Matplotlib and examples</li>
          <li class="bulletList">Pygal and examples</li>
        </ul>
      </li>
      <li class="bulletList">Python integration with MRTG and Cacti for network visualization</li>
    </ul>
    <p class="normal">This list is not exhaustive, and there is certainly no lack of commercial vendors in the network monitoring space. The basics of network monitoring that we will look at, however, carry well for both open source and commercial tools.</p>
    <h1 class="heading-1" id="_idParaDest-173">Lab Setup</h1>
    <p class="normal">The lab for this chapter consists of IOSv devices to simplify device configuration. We will use the same lab for this and the next chapters. The topology is as follows:</p>
    <figure class="mediaobject"><img alt="Diagram  Description automatically generated" src="../Images/B18403_07_01.png"/></figure>
    <p class="packt_figref">Figure 7.1: Lab topology</p>
    <p class="normal">The device configuration is as follows:</p>
    <table class="table-container" id="table001">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Device</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Management IP</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Loopback IP</strong></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">r1</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">192.168.2.218</code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">192.168.0.1</code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">r2</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">192.168.2.219</code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">192.168.0.2</code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">r3</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">192.168.2.220</code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">192.168.0.3</code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">r5</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">192.168.2.221</code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">192.168.0.4</code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">r6</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">192.168.2.222</code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">192.168.0.5</code></p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="normal">The Ubuntu hosts information is as follows:</p>
    <table class="table-container" id="table002">
      <tbody>
        <tr>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Device Name</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">External Link Eth0</strong></p>
          </td>
          <td class="table-cell">
            <p class="normal"><strong class="keyWord">Internal IP Eth1</strong></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Client</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">192.168.2.211</code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">10.0.0.9</code></p>
          </td>
        </tr>
        <tr>
          <td class="table-cell">
            <p class="normal">Server</p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">192.168.2.212</code></p>
          </td>
          <td class="table-cell">
            <p class="normal"><code class="inlineCode">10.0.0.5</code></p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="normal">The Linux hosts <a id="_idIndexMarker507"/>are <code class="inlineCode">tinycore-linux</code> (<a href="http://tinycorelinux.net/"><span class="url">http://tinycorelinux.net/</span></a>) migrated from previous versions of VIRL. The default username and password are both <code class="inlineCode">cisco</code>. If we need to change the interface IP and default gateways, they can be done via the following commands: </p>
    <pre class="programlisting con"><code class="hljs-con">cisco@Client:~$ sudo ifconfig eth0 192.168.2.211 netmask 255.255.255.0
cisco@Client:~$ sudo route add default gw 192.168.2.1
cisco@Server:~$ sudo ifconfig eth0 192.168.2.212 netmask 255.255.255.0
cisco@Server:~$ sudo route add default gw 192.168.2.1
</code></pre>
    <p class="normal">The two Ubuntu hosts will be used to generate traffic across the network so that we can look at some non-zero counters. The lab file is included in the book’s GitHub repository.</p>
    <h1 class="heading-1" id="_idParaDest-174">SNMP</h1>
    <p class="normal">SNMP is a standardized protocol<a id="_idIndexMarker508"/> used to collect and manage devices. Although the standard allows you to use SNMP for device management, in my experience, most network administrators prefer to keep SNMP as an information collection mechanism only. Since SNMP operates on UDP, which is connectionless, and considering the relatively weak security mechanism in versions 1 and 2, making device changes via SNMP tends to make network operators uneasy. SNMP version 3 has added cryptographic security and new concepts and terminology to the protocol, but how SNMP version 3 is adapted varies among network device vendors.</p>
    <p class="normal">SNMP is widely used in network monitoring and has been around since 1988 as part of RFC 1065. The operations are straightforward, with the network manager sending <code class="inlineCode">GET</code> and <code class="inlineCode">SET</code> requests toward the device and the device with the SNMP agent responding with the information per request. The most widely adopted standard is SNMPv2c, defined in RFC 1901 – RFC 1908. It uses a simple community-based security scheme for security. It has also introduced new features, such as the ability to get bulk information. The following diagram displays the high-level operation for SNMP:</p>
    <figure class="mediaobject"><img alt="Diagram  Description automatically generated" src="../Images/B18403_07_02.png"/></figure>
    <p class="packt_figref">Figure 7.2: SNMP operations</p>
    <p class="normal">The information residing<a id="_idIndexMarker509"/> in the device<a id="_idIndexMarker510"/> is structured in the <strong class="keyWord">management information base</strong> (<strong class="keyWord">MIB</strong>). The MIB uses a hierarchical namespace containing an <strong class="keyWord">object identifier</strong> (<strong class="keyWord">OID</strong>), which represents the information that can be read<a id="_idIndexMarker511"/> and fed back to the requester. When we talk about using SNMP to query device information, we are talking about using the management station to query the specific OID that represents the information we are after. A common OID structure, such as a systems and interfaces OID, is shared among vendors. Besides common OID, each vendor can also supply an enterprise-level OID specific to them.</p>
    <p class="normal">As an operator, we must put some effort into consolidating information into an OID structure in our environment to retrieve useful information. This can sometimes be a tedious process of finding one OID at a time. For example, you might be requesting a device OID and receive a value of 10,000. What is that value? Is that interface traffic? Is it in bytes or bits? Or maybe it represents the number of packets? How do we know? We will need to consult either the standard or the vendor documentation to find out. There are tools that help with this process, such as a MIB browser that can provide more metadata to the value. But, at least in my experience, constructing an SNMP-based monitoring tool for your network can sometimes feel like a cat-and-mouse game of trying to find that one missing value.</p>
    <p class="normal">Some of the main points to take away from the operation are as follows:</p>
    <ul>
      <li class="bulletList">The implementation relies heavily on the amount of information the device agent can provide. This, in turn, relies on how the vendor treats SNMP: as a core feature or an added feature.</li>
      <li class="bulletList">SNMP agents generally require CPU cycles from the control plane to return a value. Not only is this inefficient for devices with, say, large BGP tables, it is also not feasible to use SNMP to query the data at small intervals.</li>
      <li class="bulletList">The user needs to know the OID to query the data.</li>
    </ul>
    <p class="normal">Since SNMP<a id="_idIndexMarker512"/> has been around for a while, I assume you have some experience with it already. Let’s jump directly into package installation and our first SNMP example.</p>
    <h2 class="heading-2" id="_idParaDest-175">Setup</h2>
    <p class="normal">First, let’s ensure we have the SNMP<a id="_idIndexMarker513"/> managing device and agent working in our setup. The SNMP bundle can be installed on either the hosts (client or server) in our lab or the managing device on the management network. As long as the SNMP manager has IP reachability to the device and the managed device allows the inbound connection, SNMP should work. In production, you should only install the software on the management host and only allow SNMP traffic in the control plane.</p>
    <p class="normal">In this lab, we have installed SNMP on both the Ubuntu host on the management network and the client host in the lab:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$ </span>sudo apt update &amp;&amp; sudo apt upgrade
<span class="hljs-con-meta">$ </span>sudo apt-get install snmp
</code></pre>
    <p class="normal">The next step is to turn on and configure the SNMP options on the network devices. There are many optional parameters you can configure on the network device, such as contact, location, chassis ID, and SNMP packet size. The SNMP configuration options are device-specific, and you should check the documentation for the particular device. For IOSv devices, we will configure an access list to limit only the desired host for querying the device and tying the access list with the SNMP community string. In our example, we will use the word <code class="inlineCode">secret</code> as the read-only community string and <code class="inlineCode">permit_snmp</code> as the access list name:</p>
    <pre class="programlisting con"><code class="hljs-con">!
ip access-list standard permit_snmp
 permit &lt;management station&gt; log
 deny   any log
!
snmp-server community secret RO permit_snmp
!
</code></pre>
    <p class="normal">The SNMP community<a id="_idIndexMarker514"/> string is acting as a shared password between the manager and the agent; therefore, it needs to be included any time you want to query the device.</p>
    <p class="normal">As mentioned earlier in this chapter, finding the right OID is oftentimes half of the battle when working with SNMP. We can use tools<a id="_idIndexMarker515"/> such as Cisco SNMP Object Navigator (<a href="https://cloudsso.cisco.com/as/authorization.oauth2?response_type=code&amp;code_challenge=ngEnA4XYgjNQYcrfs1YqSc5DMFgNzZ7gqLljZkt7gnY&amp;code_challenge_method=S256&amp;client_id=wam_prod_ac&amp;redirect_uri=https%3A%2F%2Fsnmp.cloudapps.cisco.com%2Fpa%2Foidc%2Fcb&amp;state=eyJ6aXAiOiJERUYiLCJhbGciOiJkaXIiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2Iiwia2lkIjoiRUU2UUxudnVkSm1OMmVaYUpxcHhXNy02SWI4Iiwic3VmZml4IjoiVU5ZRU9NLjE2NzM2MDI1NjgifQ..TUfcVL2mjdqQ8HCH_OkAcw.3VfzJObgb7ak5DdJQGzP4H6DPuQCfDTez1jSiP9r9h3iJLDUbipZ7wsoGmEHWW8pfRngsJ9tCWdpPOsu3YtmUe-JBeUxD91Z0H4lb17SU0kIlM-cVuwRylmF3nYZiIM0UVVvX4b4mJPUqTOjYbM-ZQFOPhfuZDSh6gVGkXOYQf0REPvaD38pxhntp12igJod.vH_7zysxoaMerV1XEUYU3w&amp;nonce=J2Cc7sHznKF_at2Ghrf8z63yUIh0FIjvrIY5h7kIoys&amp;acr_values=stdnomfa&amp;scope=openid%20profile%20address%20email%20phone&amp;vnd_pi_requested_resource=https%3A%2F%2Fsnmp.cloudapps.cisco.com%2FSupport%2FSNMP%2Fdo%2FBrowseOID.do%3Flocal%3Den&amp;vnd_pi_application_name=CAEAXprod-snmp.cloudapps"><span class="url">https://snmp.cloudapps.cisco.com/Support/SNMP/do/BrowseOID.do?local=en</span></a>) to find specific OIDs to query.</p>
    <p class="normal">Alternatively, we can just start walking through the SNMP tree, starting from the top of Cisco’s enterprise tree at <code class="inlineCode">.1.3.6.1.4.1.9</code>. We will perform the walk to make sure that the SNMP agent and the access list are working:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$ </span>snmpwalk -v2c -c secret 192.168.2.218 .1.3.6.1.4.1.9
iso.3.6.1.4.1.9.2.1.1.0 = STRING: "
Bootstrap program is IOSv
"
iso.3.6.1.4.1.9.2.1.2.0 = STRING: "reload"
iso.3.6.1.4.1.9.2.1.3.0 = STRING: "iosv-1"
iso.3.6.1.4.1.9.2.1.4.0 = STRING: "virl.info"
&lt;skip&gt;
</code></pre>
    <p class="normal">We can be more specific about the OID we need to query as well:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$ </span>snmpwalk -v2c -c secret 192.168.2.218 .1.3.6.1.4.1.9.2.1.61.0
iso.3.6.1.4.1.9.2.1.61.0 = STRING: "cisco Systems, Inc.
170 West Tasman Dr.
San Jose, CA  95134-1706
U.S.A.
Ph +1-408-526-4000
Customer service 1-800-553-6387 or +1-408-526-7208
24HR Emergency 1-800-553-2447 or +1-408-526-7209
Email Address tac@cisco.com
World Wide Web http://www.cisco.com"
</code></pre>
    <p class="normal">As a matter of demonstration, what if we type in the wrong value by <code class="inlineCode">1</code> digit, from <code class="inlineCode">0</code> to <code class="inlineCode">1</code> at the end of the last OID? This is what we would see:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$ </span>snmpwalk -v2c -c secret 192.168.2.218 .1.3.6.1.4.1.9.2.1.61.1
iso.3.6.1.4.1.9.2.1.61.1 = No Such Instance currently exists at this OID
</code></pre>
    <p class="normal">Unlike API calls, there are no useful error codes or messages; it simply states that the OID does not exist. This can be pretty frustrating at times.</p>
    <p class="normal">The last thing to check would be that the access list we configured will deny unwanted SNMP queries. Because we had the log keyword for both the <code class="inlineCode">permit</code> and <code class="inlineCode">deny</code> entries in the access list, only <code class="inlineCode">172.16.1.123</code> is permitted to query the devices:</p>
    <pre class="programlisting con"><code class="hljs-con">*Sep 17 23:32:10.155: %SEC-6-IPACCESSLOGNP: list permit_snmp permitted 0 192.168.2.126 -&gt; 0.0.0.0, 1 packet
</code></pre>
    <p class="normal">As you can see, the biggest challenge<a id="_idIndexMarker516"/> in setting up SNMP is finding the right OID. Some OIDs are defined in standardized MIB-2; others are under the enterprise portion of the tree. Vendor documentation is the best bet, though. Some tools can help, such as a MIB browser; you can add MIBs (again, provided by the vendors) to the browser and see the description of the enterprise-based OIDs. A tool<a id="_idIndexMarker517"/> such as Cisco’s SNMP Object Navigator (<a href="http://snmp.cloudapps.cisco.com/Support/SNMP/do/BrowseOID.do?local=en"><span class="url">http://snmp.cloudapps.cisco.com/Support/SNMP/do/BrowseOID.do?local=en</span></a>) proves to be very valuable when you need to find the correct OID of the object you are looking for.</p>
    <h2 class="heading-2" id="_idParaDest-176">PySNMP</h2>
    <p class="normal">PySNMP is a cross-platform, pure<a id="_idIndexMarker518"/> Python SNMP engine<a id="_idIndexMarker519"/> implementation developed by Ilya Etingof (<a href="https://github.com/etingof"><span class="url">https://github.com/etingof</span></a>). It abstracts a lot of SNMP details for you, as great libraries do, and supports both Python 2 and Python 3.</p>
    <p class="normal">PySNMP requires the PyASN1 package. The following is taken from Wikipedia:</p>
    <blockquote class="packt_quote">
      <p class="quote">”ASN.1 is a standard and notation that describes rules and structures for representing, encoding, transmitting, and decoding data in telecommunication and computer networking.”</p>
    </blockquote>
    <p class="normal">PyASN1 conveniently provides a Python wrapper around ASN.1. Let’s install the package first. Note that since we are using a virtual environment, we will use the virtual environment’s Python interpreter:</p>
    <pre class="programlisting con"><code class="hljs-con">(venv) $ cd /tmp
(venv) $ git clone https ://github.com/etingof/pyasn1.git
(venv) $ cd pyasn1
(venv) $ git checkout 0.2.3
(venv) $ python3 setup.py install # notice the venv path
</code></pre>
    <p class="normal">Next, install<a id="_idIndexMarker520"/> the PySNMP<a id="_idIndexMarker521"/> package:</p>
    <pre class="programlisting con"><code class="hljs-con">(venv) $ cd /tmp
(venv) $ git clone https://github.com/etingof/pysnmp
(venv) $ cd pysnmp/
(venv) $ git checkout v4.3.10
(venv) $ python3 setup.py install # notice the venv path
</code></pre>
    <div class="packt_tip">
      <p class="normal">We are using an older version of PySNMP due to the fact that <code class="inlineCode">pysnmp.entity.rfc3413.oneliner</code> was removed starting with version 5.0.0 (<a href="https://github.com/etingof/pysnmp/blob/a93241007b970c458a0233c16ae2ef82dc107290/CHANGES.txt"><span class="url">https://github.com/etingof/pysnmp/blob/a93241007b970c458a0233c16ae2ef82dc107290/CHANGES.txt</span></a>). If you use <code class="inlineCode">pip</code> to install the packages, the examples will probably break.</p>
    </div>
    <p class="normal">Let’s look at how to use PySNMP to query the same Cisco contact information we used in the previous example. We will import the necessary module and create a <code class="inlineCode">CommandGenerator</code> object first:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">from</span> pysnmp.entity.rfc3413.oneliner <span class="hljs-con-keyword">import</span> cmdgen
<span class="hljs-con-meta">&gt;&gt;&gt;</span> cmdGen = cmdgen.CommandGenerator()
<span class="hljs-con-meta">&gt;&gt;&gt;</span> cisco_contact_info_oid = <span class="hljs-con-string">"1.3.6.1.4.1.9.2.1.61.0"</span>
</code></pre>
    <p class="normal">We can perform SNMP using the <code class="inlineCode">getCmd</code> method. The result is unpacked into various variables; of these, we care most about <code class="inlineCode">varBinds</code>, which contains the query result:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">&gt;&gt;&gt;</span> errorIndication, errorStatus, errorIndex, varBinds = cmdGen.getCmd(
        cmdgen.CommunityData('secret'),
        cmdgen.UdpTransportTarget(('192.168.2.218', 161)),
        cisco_contact_info_oid)
<span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">for</span> name, val <span class="hljs-con-keyword">in</span> varBinds:
        print('%s=%s' % (name.prettyPrint(), str(val)))
   
SNMPv2-SMI::enterprises.9.2.1.61.0=cisco Systems, Inc.
170 West Tasman Dr.
San Jose, CA  95134-1706
U.S.A.
Ph +1-408-526-4000
Customer service 1-800-553-6387 or +1-408-526-7208
24HR Emergency 1-800-553-2447 or +1-408-526-7209
Email Address tac@cisco.com
World Wide Web http://www.cisco.com
<span class="hljs-con-meta">&gt;&gt;&gt;</span>
</code></pre>
    <p class="normal">Note that the response<a id="_idIndexMarker522"/> values are PyASN1<a id="_idIndexMarker523"/> objects. The <code class="inlineCode">prettyPrint()</code> method will convert some of these values into a human-readable format, but the result in our return variable was not converted. We converted it into a string manually.</p>
    <p class="normal">We can write a script based on the preceding interactive example. We will name it <code class="inlineCode">pysnmp_1.py </code>with error checking. We can also include multiple OIDs in the <code class="inlineCode">getCmd()</code> method:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">#!/usr/bin/env/python3</span>
<span class="hljs-keyword">from</span> pysnmp.entity.rfc3413.oneliner <span class="hljs-keyword">import</span> cmdgen
cmdGen = cmdgen.CommandGenerator()
system_up_time_oid = <span class="hljs-string">"</span><span class="hljs-string">1.3.6.1.2.1.1.3.0"</span>
cisco_contact_info_oid = <span class="hljs-string">"1.3.6.1.4.1.9.2.1.61.0"</span>
errorIndication, errorStatus, errorIndex, varBinds = cmdGen.getCmd(
    cmdgen.CommunityData(<span class="hljs-string">'secret'</span>),
    cmdgen.UdpTransportTarget((<span class="hljs-string">'192.168.2.218'</span>, <span class="hljs-number">161</span>)),
    system_up_time_oid,
    cisco_contact_info_oid
)
<span class="hljs-comment"># Check for errors and print out results</span>
<span class="hljs-keyword">if</span> errorIndication:
    <span class="hljs-built_in">print</span>(errorIndication)
<span class="hljs-keyword">else</span>:
    <span class="hljs-keyword">if</span> errorStatus:
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'%s at %s'</span> % (
            errorStatus.prettyPrint(),
            errorIndex <span class="hljs-keyword">and</span> varBinds[<span class="hljs-built_in">int</span>(errorIndex)-<span class="hljs-number">1</span>] <span class="hljs-keyword">or</span> <span class="hljs-string">'?'</span>
            )
        )
    <span class="hljs-keyword">else</span>:
        <span class="hljs-keyword">for</span> name, val <span class="hljs-keyword">in</span> varBinds:
            <span class="hljs-built_in">print</span>(<span class="hljs-string">'%s = %s'</span> % (name.prettyPrint(), <span class="hljs-built_in">str</span>(val)))
</code></pre>
    <p class="normal">The result will be unpacked and list the values of the two OIDs:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$ </span>python pysnmp_1.py
SNMPv2-MIB::sysUpTime.0 = 599083
SNMPv2-SMI::enterprises.9.2.1.61.0 = cisco Systems, Inc.
170 West Tasman Dr.
San Jose, CA  95134-1706
U.S.A.
Ph +1-408-526-4000
Customer service 1-800-553-6387 or +1-408-526-7208
24HR Emergency 1-800-553-2447 or +1-408-526-7209
Email Address tac@cisco.com
World Wide Web http://www.cisco.com
</code></pre>
    <p class="normal">In the following example, we will persist<a id="_idIndexMarker524"/> the values we received<a id="_idIndexMarker525"/> from the queries to perform other functions, such as visualization, with the data. For our example, we will use <code class="inlineCode">ifEntry</code> within the MIB-2 tree for interface-related values to be graphed.</p>
    <p class="normal">You can find a number of resources that map out the <code class="inlineCode">ifEntry</code> tree; here is a screenshot of the Cisco SNMP Object Navigator site that we accessed previously for <code class="inlineCode">ifEntry</code>:</p>
    <figure class="mediaobject"><img alt="A picture containing text  Description automatically generated" src="../Images/B18403_07_03.png"/></figure>
    <p class="packt_figref">Figure 7.3: SNMP ifEntry OID tree</p>
    <p class="normal">A quick test will<a id="_idIndexMarker526"/> illustrate the OID mapping<a id="_idIndexMarker527"/> of the interfaces on the device:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$ </span>snmpwalk -v2c -c secret 172.16.1.189 .1.3.6.1.2.1.2.2.1.2
iso.3.6.1.2.1.2.2.1.2.1 = STRING: "GigabitEthernet0/0"
iso.3.6.1.2.1.2.2.1.2.2 = STRING: "GigabitEthernet0/1"
iso.3.6.1.2.1.2.2.1.2.3 = STRING: "GigabitEthernet0/2"
iso.3.6.1.2.1.2.2.1.2.4 = STRING: "Null0"
iso.3.6.1.2.1.2.2.1.2.5 = STRING: "Loopback0"
</code></pre>
    <p class="normal">From the documentation, we can map the values of <code class="inlineCode">ifInOctets(10)</code>, <code class="inlineCode">ifInUcastPkts(11)</code>, <code class="inlineCode">ifOutOctets(16)</code>, and <code class="inlineCode">ifOutUcastPkts(17)</code> into their respective OID values. From a quick check of the CLI and MIB documentation, we can see that the value of the <code class="inlineCode">GigabitEthernet0/0</code> packets output maps to OID <code class="inlineCode">1.3.6.1.2.1.2.2.1.17.1</code>. We will follow the rest of the same process to map out the rest of the OIDs for the interface statistics. When checking between the CLI and SNMP, keep in mind that the values should be close but not the same since there might be some traffic on the wire between the time of the CLI output and the SNMP query time:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">r1#</span>sh int gig 0/0 | i packets
  5 minute input rate 0 bits/sec, 0 packets/sec
  5 minute output rate 0 bits/sec, 0 packets/sec
     6872 packets input, 638813 bytes, 0 no buffer
     4279 packets output, 393631 bytes, 0 underruns
<span class="hljs-con-meta">$ </span>snmpwalk -v2c -c secret 192.168.2.218 .1.3.6.1.2.1.2.2.1.17.1
iso.3.6.1.2.1.2.2.1.17.1 = Counter32: 4292
</code></pre>
    <p class="normal">If we are in a production environment, we will probably write the results into a database. But since this is just an example, we will write the query values to a flat file. We will write the <code class="inlineCode">pysnmp_3.py</code> script for information queries and write the results to the file. In the script, we have defined various OIDs that we need to query:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"># Hostname OID</span>
system_name = <span class="hljs-string">'1.3.6.1.2.1.1.5.0'</span>
<span class="hljs-comment"># Interface OID</span>
gig0_0_in_oct = <span class="hljs-string">'1.3.6.1.2.1.2.2.1.10.1'</span>
gig0_0_in_uPackets = <span class="hljs-string">'1.3.6.1.2.1.2.2.1.11.1'</span>
gig0_0_out_oct = <span class="hljs-string">'1.3.6.1.2.1.2.2.1.16.1'</span>
gig0_0_out_uPackets = <span class="hljs-string">'1.3.6.1.2.1.2.2.1.17.1'</span>
</code></pre>
    <p class="normal">The values were consumed in the <code class="inlineCode">snmp_query()</code> function, with <code class="inlineCode">host</code>, <code class="inlineCode">community</code>, and <code class="inlineCode">oid</code> as input:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">def</span> <span class="hljs-title">snmp_query</span>(<span class="hljs-params">host, community, oid</span>):
    errorIndication, errorStatus, errorIndex, varBinds = cmdGen.getCmd(
        cmdgen.CommunityData(community),
        cmdgen.UdpTransportTarget((host, <span class="hljs-number">161</span>)),
        oid
    )
</code></pre>
    <p class="normal">All of the values are put in a dictionary<a id="_idIndexMarker528"/> with various keys<a id="_idIndexMarker529"/> and written to a file called <code class="inlineCode">results.txt</code>:</p>
    <pre class="programlisting code"><code class="hljs-code">result = {}
result[<span class="hljs-string">'Time'</span>] = datetime.datetime.utcnow().isoformat()
result[<span class="hljs-string">'hostname'</span>] = snmp_query(host, community, system_name)
result[<span class="hljs-string">'Gig0-0_In_Octet'</span>] = snmp_query(host, community, gig0_0_in_oct)
result[<span class="hljs-string">'Gig0-0_In_uPackets'</span>] = snmp_query(host, community, gig0_0_in_uPackets)
result[<span class="hljs-string">'Gig0-0_Out_Octet'</span>] = snmp_query(host, community, gig0_0_out_oct)
result[<span class="hljs-string">'Gig0-0_Out_uPackets'</span>] = snmp_query(host, community, gig0_0_out_uPackets)
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'/home/echou/Master_Python_Networking/Chapter7/results.txt'</span>, <span class="hljs-string">'</span><span class="hljs-string">a'</span>) <span class="hljs-keyword">as</span> f:
    f.write(<span class="hljs-built_in">str</span>(result))
    f.write(<span class="hljs-string">'\n'</span>)
</code></pre>
    <p class="normal">The outcome will be a file with results showing the interface packets represented at the time of the query:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$ </span><span class="hljs-con-built_in">cat</span> results.txt
{'Gig0-0_In_Octet': '3990616', 'Gig0-0_Out_uPackets': '60077', 'Gig0-0_In_uPackets': '42229', 'Gig0-0_Out_Octet': '5228254', 'Time': '2017-03-06T02:34:02.146245', 'hostname': 'iosv-1.virl.info'}
{'Gig0-0_Out_uPackets': '60095', 'hostname': 'iosv-1.virl.info', 'Gig0-0_Out_Octet': '5229721', 'Time': '2017-03-06T02:35:02.072340', 'Gig0-0_In_Octet': '3991754', 'Gig0-0_In_uPackets': '42242'}
&lt;skip&gt;
</code></pre>
    <p class="normal">We can make this script executable and schedule a <code class="inlineCode">cron</code> job to be executed every 5 minutes:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$ </span><span class="hljs-con-built_in">chmod</span> +x pysnmp_3.py
<span class="hljs-con-meta"># </span>crontab configuration
*/5 * * * * /home/echou/Mastering_Python_Networking_Fourth_Edition/Chapter07/pysnmp_3.py
</code></pre>
    <p class="normal">As mentioned previously, in a production environment, we would put the information in a database. For a SQL database, you can use a unique ID as the primary key. In a NoSQL database, we might use time as the primary index (or key) because it is always unique, followed by various key-value pairs.</p>
    <p class="normal">We will wait for the script to be executed<a id="_idIndexMarker530"/> a few times for the values<a id="_idIndexMarker531"/> to be populated. If you are the impatient type, you can shorten the <code class="inlineCode">cron</code> job interval to 1 minute. After you see enough values in the <code class="inlineCode">results.txt</code> file to make an interesting graph, we can move on to the next section to see how we can use Python to visualize the data.</p>
    <h1 class="heading-1" id="_idParaDest-177">Python for Data Visualization</h1>
    <p class="normal">We gather network data to gain insight<a id="_idIndexMarker532"/> into our network. One of the best ways to know<a id="_idIndexMarker533"/> what the data means is to visualize it with graphs. This is true for almost all data, but especially true for time series data in the context of network monitoring. How much data was transmitted over the network in the last week? What is the percentage of the TCP protocol among all of the traffic? These are values we can glean from using data-gathering mechanisms such as SNMP, and we can produce visualization graphs with some of the popular Python libraries.</p>
    <p class="normal">In this section, we will use the data we collected from the last section using SNMP and use two popular Python libraries, Matplotlib and Pygal, to graph them.</p>
    <h2 class="heading-2" id="_idParaDest-178">Matplotlib</h2>
    <p class="normal"><strong class="keyWord">Matplotlib</strong> (<a href="http://matplotlib.org/"><span class="url">http://matplotlib.org/</span></a>) is a Python 2D plotting<a id="_idIndexMarker534"/> library<a id="_idIndexMarker535"/> for the Python language<a id="_idIndexMarker536"/> and its NumPy mathematical extension. It can produce publication-quality figures, such as plots, histograms, and bar graphs, with a few lines of code.</p>
    <p class="normal">NumPy is an extension of the Python programming language. It is open source and widely used in various data<a id="_idIndexMarker537"/> science projects. You can learn more about it at <a href="https://en.wikipedia.org/wiki/NumPy"><span class="url">https://en.wikipedia.org/wiki/NumPy</span></a>.</p>
    <p class="normal">Let’s begin with the installation.</p>
    <h3 class="heading-3" id="_idParaDest-179">Installation</h3>
    <p class="normal">The installation can be done using the Linux package<a id="_idIndexMarker538"/> management system for the distribution or Python <code class="inlineCode">pip</code>. In the latest version of Matplotlib, we will also install <code class="inlineCode">python3-tk</code> for display: </p>
    <pre class="programlisting con"><code class="hljs-con">(venv) $ pip install matplotlib
(venv) $ sudo apt install python3-tk
</code></pre>
    <p class="normal">Now, let’s get into our first example.</p>
    <h3 class="heading-3" id="_idParaDest-180">Matplotlib – the first example</h3>
    <p class="normal">For the following<a id="_idIndexMarker539"/> examples, the output figures are displayed as the standard output by default. Typically, the standard output is your monitor screen. During development, it is often easier to try out the code initially and produce the graph on the standard output first before finalizing the code with a script. If you have been following along with this book via a virtual machine, it is recommended that you use the VM window instead of SSH so that you can see the graphs. If you do not have access to the standard output, you can save the figure and view it after downloading it (as you will see soon). Note that you will need to set the <code class="inlineCode">$DISPLAY</code> variable in some of the graphs we produce in this section.</p>
    <p class="normal">The following screenshot of the Ubuntu desktop is used in this chapter’s visualization example. As soon as the <code class="inlineCode">plt.show()</code> command is issued in the Terminal window, <strong class="screenText">Figure 1 </strong>will appear on the screen. When you close the figure, you will return to the Python shell:</p>
    <figure class="mediaobject"><img alt="A screenshot of a computer  Description automatically generated" src="../Images/B18403_07_04.png"/></figure>
    <p class="packt_figref">Figure 7.4: Matplotlib visualization with the Ubuntu desktop</p>
    <p class="normal">Let’s look at the line graph<a id="_idIndexMarker540"/> first. A line graph simply gives two lists of numbers that correspond to the <em class="italic">x</em>-axis and <em class="italic">y</em>-axis values:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">import</span> matplotlib.pyplot <span class="hljs-con-keyword">as</span> plt
<span class="hljs-con-meta">&gt;&gt;&gt;</span> plt.plot([<span class="hljs-con-number">0</span>,<span class="hljs-con-number">1</span>,<span class="hljs-con-number">2</span>,<span class="hljs-con-number">3</span>,<span class="hljs-con-number">4</span>], [<span class="hljs-con-number">0</span>,<span class="hljs-con-number">10</span>,<span class="hljs-con-number">20</span>,<span class="hljs-con-number">30</span>,<span class="hljs-con-number">40</span>])
[&lt;matplotlib.lines.Line2D object at 0x7f932510df98&gt;]
<span class="hljs-con-meta">&gt;&gt;&gt;</span> plt.ylabel(<span class="hljs-con-string">'Something on Y'</span>)
&lt;matplotlib.text.Text object at 0x7f93251546a0&gt;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> plt.xlabel(<span class="hljs-con-string">'</span><span class="hljs-con-string">Something on X'</span>)
&lt;matplotlib.text.Text object at 0x7f9325fdb9e8&gt;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> plt.show()
</code></pre>
    <p class="normal">The graph will be a line graph:</p>
    <figure class="mediaobject"><img alt="Graphical user interface, chart, line chart  Description automatically generated" src="../Images/B18403_07_05.png"/></figure>
    <p class="packt_figref">Figure 7.5: Matplotlib line graph</p>
    <p class="normal">Alternatively, if you do not have access to standard output or have saved the figure first, you can use the <code class="inlineCode">savefig()</code> method:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">&gt;&gt;&gt;</span> plt.savefig(<span class="hljs-con-string">'figure1.png'</span>) <span class="hljs-con-keyword">or</span>
<span class="hljs-con-meta">&gt;&gt;&gt;</span> plt.savefig(<span class="hljs-con-string">'figure1.pdf'</span>)
</code></pre>
    <p class="normal">With this basic knowledge of graphing<a id="_idIndexMarker541"/> plots, we can now graph the results we receive from SNMP queries.</p>
    <h3 class="heading-3" id="_idParaDest-181">Matplotlib for SNMP results</h3>
    <p class="normal">In our first Matplotlib<a id="_idIndexMarker542"/> example, <code class="inlineCode">matplotlib_1.py</code>, we will import the <code class="inlineCode">dates</code> module<a id="_idIndexMarker543"/> besides <code class="inlineCode">pyplot</code>. We will use the <code class="inlineCode">matplotlib.dates</code> module instead of the Python standard library <code class="inlineCode">dates</code> module.</p>
    <p class="normal">Unlike the Python <code class="inlineCode">dates</code> module, the <code class="inlineCode">matplotlib.dates</code> library will convert the date value internally into a float type, which is required by Matplotlib:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-keyword">import</span> matplotlib.dates <span class="hljs-keyword">as</span> dates
</code></pre>
    <p class="normal">Matplotlib provides<a id="_idIndexMarker544"/> sophisticated<a id="_idIndexMarker545"/> date plotting capabilities; you can find more<a id="_idIndexMarker546"/> information on this at <a href="https://matplotlib.org/stable/api/dates_api.html"><span class="url">https://matplotlib.org/stable/api/dates_api.html</span></a>. </p>
    <p class="normal">In the script, we will create two empty lists, each representing the <em class="italic">x</em>-axis and <em class="italic">y</em>-axis values. Note that on line 12, we used the built-in <code class="inlineCode">eval()</code> Python function to read the input as a dictionary instead of a default string:</p>
    <pre class="programlisting code"><code class="hljs-code">x_time = []
y_value = []
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'results.txt'</span>, <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> f:
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():
        <span class="hljs-comment"># eval(line) reads in each line as dictionary instead of string</span>
        line = <span class="hljs-built_in">eval</span>(line)
        <span class="hljs-comment"># convert to internal float</span>
        x_time.append(dates.datestr2num(line[<span class="hljs-string">'Time'</span>]))
        y_value.append(line[<span class="hljs-string">'Gig0-0_Out_uPackets'</span>])
</code></pre>
    <p class="normal">In order to read the <em class="italic">x</em>-axis value back in a human-readable date format, we will need to use the <code class="inlineCode">plot_date()</code> function instead of <code class="inlineCode">plot()</code>. We will also tweak the size of the figure a bit, as well as rotate the value on the <em class="italic">x</em>-axis so that we can read the value in full:</p>
    <pre class="programlisting code"><code class="hljs-code">plt.subplots_adjust(bottom=<span class="hljs-number">0.3</span>)
plt.xticks(rotation=<span class="hljs-number">80</span>)
plt.plot_date(x_time, y_value)
plt.title(<span class="hljs-string">'Router1 G0/0'</span>)
plt.xlabel(<span class="hljs-string">'Time in UTC'</span>)
plt.ylabel(<span class="hljs-string">'Output Unicast Packets'</span>)
plt.savefig(<span class="hljs-string">'matplotlib_1_result.png'</span>)
plt.show()
</code></pre>
    <p class="normal">The final result will display the <strong class="screenText">Router1 G0/0</strong> and <strong class="screenText">Output Unicast Packets</strong>, as follows:</p>
    <figure class="mediaobject"><img alt="Graphical user interface, chart, line chart  Description automatically generated" src="../Images/B18403_07_06.png"/></figure>
    <p class="packt_figref">Figure 7.6: Router1 Matplotlib graph</p>
    <p class="normal">Note that if you prefer<a id="_idIndexMarker547"/> a straight line<a id="_idIndexMarker548"/> instead of dots, you can use the third optional parameter in the <code class="inlineCode">plot_date()</code> function:</p>
    <pre class="programlisting code"><code class="hljs-code">plt.plot_date(x_time, y_value, <span class="hljs-string">"-"</span>)
</code></pre>
    <p class="normal">We can repeat the steps for the rest of the values for output octets, input unicast packets, and input as individual graphs. However, in our next example, that is, <code class="inlineCode">matplotlib_2.py</code>, we will show you how to graph multiple values against the same time range, as well as additional Matplotlib options.</p>
    <p class="normal">In this case, we will create additional lists and populate the values accordingly:</p>
    <pre class="programlisting code"><code class="hljs-code">x_time = []
out_octets = []
out_packets = []
in_octets = []
in_packets = []
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'results.txt'</span>, <span class="hljs-string">'r'</span>) <span class="hljs-keyword">as</span> f:
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():
        <span class="hljs-comment"># eval(line) reads in each line as dictionary instead of string</span>
        line = <span class="hljs-built_in">eval</span>(line)
        <span class="hljs-comment"># convert to internal float</span>
        x_time.append(dates.datestr2num(line[<span class="hljs-string">'Time'</span>]))
        out_packets.append(line[<span class="hljs-string">'Gig0-0_Out_uPackets'</span>])
        out_octets.append(line[<span class="hljs-string">'Gig0-0_Out_Octet'</span>])
        in_packets.append(line[<span class="hljs-string">'Gig0-0_In_uPackets'</span>])
        in_octets.append(line[<span class="hljs-string">'Gig0-0_In_Octet'</span>])
</code></pre>
    <p class="normal">Since we have identical <em class="italic">x</em>-axis values, we can just add<a id="_idIndexMarker549"/> the different <em class="italic">y</em>-axis values<a id="_idIndexMarker550"/> to the same graph:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"># Use plot_date to display x-axis back in date format</span>
plt.plot_date(x_time, out_packets, <span class="hljs-string">'-'</span>, label=<span class="hljs-string">'Out Packets'</span>)
plt.plot_date(x_time, out_octets, <span class="hljs-string">'-'</span>, label=<span class="hljs-string">'Out Octets'</span>)
plt.plot_date(x_time, in_packets, <span class="hljs-string">'-'</span>, label=<span class="hljs-string">'In Packets'</span>)
plt.plot_date(x_time, in_octets, <span class="hljs-string">'-'</span>, label=<span class="hljs-string">'In Octets'</span>)
</code></pre>
    <p class="normal">Also, add <code class="inlineCode">grid</code> and <code class="inlineCode">legend</code> to the graph:</p>
    <pre class="programlisting code"><code class="hljs-code">plt.title(<span class="hljs-string">'Router1 G0/0'</span>)
plt.legend(loc=<span class="hljs-string">'upper left'</span>)
plt.grid(<span class="hljs-literal">True</span>)
plt.xlabel(<span class="hljs-string">'Time in UTC'</span>)
plt.ylabel(<span class="hljs-string">'Values'</span>)
plt.savefig(<span class="hljs-string">'matplotlib_2_result.png'</span>)
plt.show()
</code></pre>
    <p class="normal">The final result will combine all of the values in a single graph. Note that some of the values in the upper-left corner are blocked by the legend. You can resize the figure and/or use the pan/zoom option to move around the graph to see the values:</p>
    <figure class="mediaobject"><img alt="Graphical user interface, application, table  Description automatically generated" src="../Images/B18403_07_07.png"/></figure>
    <p class="packt_figref">Figure 7.7: Router1 – Matplotlib multiline graph</p>
    <p class="normal">There are many<a id="_idIndexMarker551"/> more graphing<a id="_idIndexMarker552"/> options available in Matplotlib; we are certainly not limited to plot graphs. For example, in <code class="inlineCode">matplotlib_3.py</code>, we can use the following mock data to graph the percentage of different traffic types that we can see on the wire:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">#!/usr/bin/env python3</span>
<span class="hljs-comment"># Example from http://matplotlib.org/2.0.0/examples/pie_and_polar_charts/pie_demo_features.html</span>
<span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt
<span class="hljs-comment"># Pie chart, where the slices will be ordered and plotted counter-clockwise:</span>
labels = <span class="hljs-string">'TCP'</span>, <span class="hljs-string">'UDP'</span>, <span class="hljs-string">'ICMP'</span>, <span class="hljs-string">'Others'</span>
sizes = [<span class="hljs-number">15</span>, <span class="hljs-number">30</span>, <span class="hljs-number">45</span>, <span class="hljs-number">10</span>]
explode = (<span class="hljs-number">0</span>, <span class="hljs-number">0.1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)  <span class="hljs-comment"># Make UDP stand out</span>
fig1, ax1 = plt.subplots()
ax1.pie(sizes, explode=explode, labels=labels, autopct=<span class="hljs-string">'%1.1f%%'</span>,
        shadow=<span class="hljs-literal">True</span>, startangle=<span class="hljs-number">90</span>)
ax1.axis(<span class="hljs-string">'equal'</span>)  <span class="hljs-comment"># Equal aspect ratio ensures that pie is drawn as a circle.</span>
plt.savefig(<span class="hljs-string">'matplotlib_3_result.png'</span>)
plt.show()
</code></pre>
    <p class="normal">The preceding code leads to this pie chart from <code class="inlineCode">plt.show()</code>:</p>
    <figure class="mediaobject"><img alt="Chart, pie chart  Description automatically generated" src="../Images/B18403_07_08.png"/></figure>
    <p class="packt_figref">Figure 7.8: Matplotlib pie chart</p>
    <p class="normal">In this section, we have used Matplotlib<a id="_idIndexMarker553"/> to graph our network data<a id="_idIndexMarker554"/> into more visually appealing graphs to help us understand the state of our network. This was done with bar graphs, line charts, and pie charts, which are appropriate for the data at hand. Matplotlib is a powerful tool that is not limited to Python. As an open-source tool, many additional Matplotlib resources can be leveraged to learn about the tool.</p>
    <h3 class="heading-3" id="_idParaDest-182">Additional Matplotlib resources</h3>
    <p class="normal">Matplotlib is one of the best Python<a id="_idIndexMarker555"/> plotting libraries, able to produce publication-quality figures. Like Python, it aims to make complex tasks simple. With over 10,000 stars (and counting) on GitHub, it is also one of the most popular open-source projects.</p>
    <p class="normal">Its popularity directly translates into faster bug fixes, a friendly user community, extensive documentation, and general usability. Using the package has a bit of a learning curve, but it is well worth the effort.</p>
    <p class="normal">In this section, we barely <a id="_idIndexMarker556"/>scratched the surface of Matplotlib. You’ll find additional resources at <a href="https://matplotlib.org/stable/index.html"><span class="url">https://matplotlib.org/stable/index.html</span></a> (the Matplotlib project page) and <a href="https://github.com/matplotlib/matplotlib"><span class="url">https://github.com/matplotlib/matplotlib</span></a> (the Matplotlib GitHub repository).</p>
    <p class="normal">In the coming section, we will take a look at another popular Python graph library: <strong class="keyWord">Pygal</strong>.</p>
    <h2 class="heading-2" id="_idParaDest-183">Pygal</h2>
    <p class="normal">Pygal (<a href="https://www.pygal.org/en/stable/"><span class="url">https://www.pygal.org/en/stable/</span></a>) is a dynamic <strong class="keyWord">Scalable Vector Graphics </strong>(<strong class="keyWord">SVG</strong>)<strong class="keyWord"><a id="_idIndexMarker557"/></strong> charting library<a id="_idIndexMarker558"/> written in Python. The biggest<a id="_idIndexMarker559"/> advantage of Pygal, in my opinion, is that it produces write SVG graphs easily and natively. There are many advantages of SVG<a id="_idIndexMarker560"/> over other graph formats. Two of the main advantages are that it is web browser-friendly and it provides scalability without sacrificing image quality. In other words, you can display the resulting image in any modern web browser and zoom in and out of the image without losing the details of the graph. Did I mention that we can do this in a few lines of Python code? How cool is that?</p>
    <p class="normal">Let’s get Pygal installed, then move on to the first example.</p>
    <h3 class="heading-3" id="_idParaDest-184">Installation</h3>
    <p class="normal">The installation<a id="_idIndexMarker561"/> is done via <code class="inlineCode">pip</code>:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">(venv)$ </span>pip install pygal
</code></pre>
    <h3 class="heading-3" id="_idParaDest-185">Pygal – the first example</h3>
    <p class="normal">Let’s look at the line chart example<a id="_idIndexMarker562"/> demonstrated<a id="_idIndexMarker563"/> on Pygal’s documentation, available at <a href="http://pygal.org/en/stable/documentation/types/line.html"><span class="url">http://pygal.org/en/stable/documentation/types/line.html</span></a>:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">import</span> pygal
<span class="hljs-con-meta">&gt;&gt;&gt;</span> line_chart = pygal.Line()
<span class="hljs-con-meta">&gt;&gt;&gt;</span> line_chart.title = <span class="hljs-con-string">'Browser usage evolution (in %)'</span>
<span class="hljs-con-meta">&gt;&gt;&gt;</span> line_chart.x_labels = <span class="hljs-con-built_in">map</span>(<span class="hljs-con-built_in">str</span>, <span class="hljs-con-built_in">range</span>(<span class="hljs-con-number">2002</span>, <span class="hljs-con-number">2013</span>))
<span class="hljs-con-meta">&gt;&gt;&gt;</span> line_chart.add(<span class="hljs-con-string">'Firefox'</span>, [<span class="hljs-con-literal">None</span>, <span class="hljs-con-literal">None</span>,    <span class="hljs-con-number">0</span>, <span class="hljs-con-number">16.6</span>,   <span class="hljs-con-number">25</span>,   <span class="hljs-con-number">31</span>, <span class="hljs-con-number">36.4</span>, <span class="hljs-con-number">45.5</span>, <span class="hljs-con-number">46.3</span>, <span class="hljs-con-number">42.8</span>, <span class="hljs-con-number">37.1</span>])
&lt;pygal.graph.line.Line object at 0x7f4883c52b38&gt;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> line_chart.add(<span class="hljs-con-string">'Chrome'</span>,  [<span class="hljs-con-literal">None</span>, <span class="hljs-con-literal">None</span>, <span class="hljs-con-literal">None</span>, <span class="hljs-con-literal">None</span>, <span class="hljs-con-literal">None</span>, <span class="hljs-con-literal">None</span>,    <span class="hljs-con-number">0</span>,  <span class="hljs-con-number">3.9</span>, <span class="hljs-con-number">10.8</span>, <span class="hljs-con-number">23.8</span>, <span class="hljs-con-number">35.3</span>])
&lt;pygal.graph.line.Line object at 0x7f4883c52b38&gt;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> line_chart.add(<span class="hljs-con-string">'IE'</span>,      [<span class="hljs-con-number">85.8</span>, <span class="hljs-con-number">84.6</span>, <span class="hljs-con-number">84.7</span>, <span class="hljs-con-number">74.5</span>,   <span class="hljs-con-number">66</span>, <span class="hljs-con-number">58.6</span>, <span class="hljs-con-number">54.7</span>, <span class="hljs-con-number">44.8</span>, <span class="hljs-con-number">36.2</span>, <span class="hljs-con-number">26.6</span>, <span class="hljs-con-number">20.1</span>])
&lt;pygal.graph.line.Line object at 0x7f4883c52b38&gt;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> line_chart.add(<span class="hljs-con-string">'Others'</span>,  [<span class="hljs-con-number">14.2</span>, <span class="hljs-con-number">15.4</span>, <span class="hljs-con-number">15.3</span>,  <span class="hljs-con-number">8.9</span>,    <span class="hljs-con-number">9</span>, <span class="hljs-con-number">10.4</span>,  <span class="hljs-con-number">8.9</span>,  <span class="hljs-con-number">5.8</span>,  <span class="hljs-con-number">6.7</span>,  <span class="hljs-con-number">6.8</span>,  <span class="hljs-con-number">7.5</span>])
&lt;pygal.graph.line.Line object at 0x7f4883c52b38&gt;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> line_chart.render_to_file(<span class="hljs-con-string">'pygal_example_1.svg'</span>)
</code></pre>
    <p class="normal">In this example, we created a line object with the <code class="inlineCode">x_labels</code> automatically rendered as strings for 11 units. Each of the objects can be added with the label and the value in a list format, such as Firefox, Chrome, and IE.</p>
    <p class="normal">The interesting bit to focus on is the fact that each of the line chart items has the exact number of matching numbers to the number of x units. When there is no value, for example, the years 2002 – 2007 for Chrome, the value <strong class="screenText">None</strong> is entered.</p>
    <p class="normal">Here’s the resulting graph, as viewed in the Firefox browser:</p>
    <figure class="mediaobject"><img alt="Chart, line chart  Description automatically generated" src="../Images/B18403_07_09.png"/></figure>
    <p class="packt_figref">Figure 7.9: Pygal sample graph</p>
    <p class="normal">Now that we can see the general<a id="_idIndexMarker564"/> usage of Pygal, we can use the same method to graph the SNMP results we have in hand. We will do this in the coming section.</p>
    <h3 class="heading-3" id="_idParaDest-186">Pygal for SNMP results</h3>
    <p class="normal">For the Pygal line graph, we<a id="_idIndexMarker565"/> can largely follow the same pattern as our Matplotlib<a id="_idIndexMarker566"/> example, where we create lists of values by reading the file. We no longer need to convert the <em class="italic">x</em>-axis value into an internal float, as we did for Matplotlib; however, we do need to convert the numbers in each of the values we would have received into float:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">#!/usr/bin/env python3</span>
<span class="hljs-keyword">import</span> pygal
x_time = []
out_octets = []
out_packets = []
in_octets = []
in_packets = []
<span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">'results.txt'</span>, <span class="hljs-string">'</span><span class="hljs-string">r'</span>) <span class="hljs-keyword">as</span> f:
    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():
        <span class="hljs-comment"># eval(line) reads in each line as dictionary instead of string</span>
        line = <span class="hljs-built_in">eval</span>(line)
        x_time.append(line[<span class="hljs-string">'Time'</span>])
        out_packets.append(<span class="hljs-built_in">float</span>(line[<span class="hljs-string">'Gig0-0_Out_uPackets'</span>]))
        out_octets.append(<span class="hljs-built_in">float</span>(line[<span class="hljs-string">'</span><span class="hljs-string">Gig0-0_Out_Octet'</span>]))
        in_packets.append(<span class="hljs-built_in">float</span>(line[<span class="hljs-string">'Gig0-0_In_uPackets'</span>]))
        in_octets.append(<span class="hljs-built_in">float</span>(line[<span class="hljs-string">'Gig0-0_In_Octet'</span>]))
</code></pre>
    <p class="normal">We can use the same<a id="_idIndexMarker567"/> mechanism that we saw to construct<a id="_idIndexMarker568"/> the line graph:</p>
    <pre class="programlisting code"><code class="hljs-code">line_chart = pygal.Line()
line_chart.title = <span class="hljs-string">"Router 1 Gig0/0"</span>
line_chart.x_labels = x_time
line_chart.add(<span class="hljs-string">'out_octets'</span>, out_octets)
line_chart.add(<span class="hljs-string">'out_packets'</span>, out_packets)
line_chart.add(<span class="hljs-string">'in_octets'</span>, in_octets)
line_chart.add(<span class="hljs-string">'</span><span class="hljs-string">in_packets'</span>, in_packets)
line_chart.render_to_file(<span class="hljs-string">'pygal_example_2.svg'</span>)
</code></pre>
    <p class="normal">The outcome is similar to what we have already seen, but the graph is now in an SVG format that can be easily displayed on a web page. It can be viewed in a modern web browser:</p>
    <figure class="mediaobject"><img alt="Table  Description automatically generated" src="../Images/B18403_07_10.png"/></figure>
    <p class="packt_figref">Figure 7.10: Router 1— Pygal multiline graph</p>
    <p class="normal">Just like Matplotlib, Pygal provides<a id="_idIndexMarker569"/> many more options<a id="_idIndexMarker570"/> for graphs. For example, to graph the pie chart we saw previously in Matplotlib, we can use the <code class="inlineCode">pygal.Pie()</code> object. This is shown in <code class="inlineCode">pygal_2.py</code>:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment">#!/usr/bin/env python3</span>
<span class="hljs-keyword">import</span> pygal
line_chart = pygal.Pie()
line_chart.title = <span class="hljs-string">"Protocol Breakdown"</span>
line_chart.add(<span class="hljs-string">'</span><span class="hljs-string">TCP'</span>, <span class="hljs-number">15</span>)
line_chart.add(<span class="hljs-string">'UDP'</span>, <span class="hljs-number">30</span>)
line_chart.add(<span class="hljs-string">'ICMP'</span>, <span class="hljs-number">45</span>)
line_chart.add(<span class="hljs-string">'Others'</span>, <span class="hljs-number">10</span>)
line_chart.render_to_file(<span class="hljs-string">'pygal_example_3.svg'</span>)
</code></pre>
    <p class="normal">The resulting SVG file is shown here:</p>
    <figure class="mediaobject"><img alt="Chart, pie chart  Description automatically generated" src="../Images/B18403_07_11.png"/></figure>
    <p class="packt_figref">Figure 7.11: Pygal pie chart</p>
    <p class="normal">Pygal is a great tool<a id="_idIndexMarker571"/> when it comes to generating production-ready<a id="_idIndexMarker572"/> SVG graphs. If this is the type of graph required, look no further than the Pygal library. In this section, we have examined examples of using Pygal to generate graphs for our network data. Similar to Matplotlib, there are many additional resources to help us to learn about Pygal if you’re interested.</p>
    <h3 class="heading-3" id="_idParaDest-187">Additional Pygal resources</h3>
    <p class="normal">Pygal provides many more customizable features<a id="_idIndexMarker573"/> and graphing capabilities for the data you collect from basic network monitoring tools such as SNMP. We demonstrated a simple line graph and pie graph in this section. You can find more information<a id="_idIndexMarker574"/> about the project here:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Pygal documentation</strong>: <a href="http://www.pygal.org/en/stable/index.html"><span class="url">http://www.pygal.org/en/stable/index.html</span></a></li>
      <li class="bulletList"><strong class="keyWord">Pygal GitHub project page</strong>: <a href="https://github.com/Kozea/pygal"><span class="url">https://github.com/Kozea/pygal</span></a></li>
    </ul>
    <p class="normal">In the coming section, we will continue<a id="_idIndexMarker575"/> with the SNMP theme of network monitoring but with a fully featured network monitoring system called <strong class="keyWord">Cacti</strong>.</p>
    <h1 class="heading-1" id="_idParaDest-188">Python for Cacti</h1>
    <p class="normal">In my early days as a junior network<a id="_idIndexMarker576"/> engineer at a regional ISP, we used<a id="_idIndexMarker577"/> the open-source cross-platform <strong class="keyWord">Multi Router Traffic Grapher</strong> (<strong class="keyWord">MRTG</strong>) (<a href="https://en.wikipedia.org/wiki/Multi_Router_Traffic_Grapher"><span class="url">https://en.wikipedia.org/wiki/Multi_Router_Traffic_Grapher</span></a>) tool to check the traffic load on network<a id="_idIndexMarker578"/> links. We relied on the tool almost exclusively for traffic monitoring. I was amazed at how good and useful an open-source project could be. It was one of the first open-source high-level network monitoring systems that abstracted the details of SNMP, the database, and HTML<a id="_idIndexMarker579"/> for network<a id="_idIndexMarker580"/> engineers. Then came the <strong class="keyWord">round-robin database tool</strong> (<strong class="keyWord">RRDtool</strong>) (<a href="https://en.wikipedia.org/wiki/RRDtool"><span class="url">https://en.wikipedia.org/wiki/RRDtool</span></a>). In its first release in 1999, it was referred to as “MRTG Done Right.” It greatly improved<a id="_idIndexMarker581"/> the database and poller performance in the backend.</p>
    <p class="normal">Released in 2001, Cacti (<a href="https://en.wikipedia.org/wiki/Cacti_(software)"><span class="url">https://en.wikipedia.org/wiki/Cacti_(software)</span></a>) is an open-source<a id="_idIndexMarker582"/> web-based network monitoring<a id="_idIndexMarker583"/> and graphing tool designed as an improved frontend for RRDtool. Because of the heritage of MRTG and RRDtool, you will notice a familiar graph layout, templates, and SNMP poller. As a packaged tool, the installation and usage will need to stay within the boundary of the tool. However, Cacti offers a custom data query feature that we can use Python to handle. In this section, we will see how we can use Python as an input method for Cacti.</p>
    <p class="normal">First, we’ll go through the installation process.</p>
    <h2 class="heading-2" id="_idParaDest-189">Installation</h2>
    <p class="normal">Because Cacti<a id="_idIndexMarker584"/> is an all-in-one tool, including web frontend, collection scripts, and database backend, unless you already have experience with Cacti, I would recommend installing the tool on a standalone VM or a container in our lab. The following instructions will be shown for a VM, but a container Dockerfile would be similar. </p>
    <p class="normal">Installation on Ubuntu is straightforward when using APT on the Ubuntu management VM:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$ </span>sudo apt-get install cacti
</code></pre>
    <p class="normal">It will trigger a series of installation and setup steps, including the MySQL database, web server (Apache or <code class="inlineCode">lighttpd</code>), and various configuration tasks. Once it’s installed, navigate to <code class="inlineCode">http://&lt;ip&gt;/cacti</code> to get started. The last step is to log in with the default username and password (<code class="inlineCode">admin/admin</code>); you will be prompted to change the password.</p>
    <p class="normal">During installation, when in doubt, go with the default option and keep it simple.</p>
    <p class="normal">Once logged in, we can follow the documentation to add a device and associate it with a template. There is a Cisco router premade template that you can go with. Cacti<a id="_idIndexMarker585"/> has good documentation at <a href="http://docs.cacti.net/"><span class="url">http://docs.cacti.net/</span></a> for adding a device and creating your first graph, so we will quickly look at some screenshots that you can expect to see:</p>
    <figure class="mediaobject"><img alt="Graphical user interface, application  Description automatically generated" src="../Images/B18403_07_12.png"/></figure>
    <p class="packt_figref">Figure 7.12: Cacti device edit page</p>
    <p class="normal">A sign indicating the SNMP communication is working is when you can see the device uptime:</p>
    <figure class="mediaobject"><img alt="Text  Description automatically generated" src="../Images/B18403_07_13.png"/></figure>
    <p class="packt_figref">Figure 7.13: Device edit result page</p>
    <p class="normal">You can add graphs<a id="_idIndexMarker586"/> to the device for interface traffic and other statistics:</p>
    <figure class="mediaobject"><img alt="Graphical user interface  Description automatically generated" src="../Images/B18403_07_14.png"/></figure>
    <p class="packt_figref">Figure 7.14: New graphs for the device</p>
    <p class="normal">After some time, you will start seeing traffic, as shown here:</p>
    <figure class="mediaobject"><img alt="Table  Description automatically generated" src="../Images/B18403_07_15.png"/></figure>
    <p class="packt_figref">Figure 7.15: 5-minute average graph</p>
    <p class="normal">We are now ready to look at how to use Python scripts to extend Cacti’s data-gathering functionality.</p>
    <h2 class="heading-2" id="_idParaDest-190">Python script as an input source</h2>
    <p class="normal">There are two documents<a id="_idIndexMarker587"/> that we should read before<a id="_idIndexMarker588"/> we try to use<a id="_idIndexMarker589"/> our Python script<a id="_idIndexMarker590"/> as an input source:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Data input methods</strong>: <a href="http://www.cacti.net/downloads/docs/html/data_input_methods.html "><span class="url">http://www.cacti.net/downloads/docs/html/data_input_methods.html</span></a></li>
      <li class="bulletList"><strong class="keyWord">Making your scripts work with Cacti</strong>: <a href="http://www.cacti.net/downloads/docs/html/making_scripts_work_with_cacti.html"><span class="url">http://www.cacti.net/downloads/docs/html/making_scripts_work_with_cacti.html</span></a></li>
    </ul>
    <p class="normal">You might wonder what the use cases are for using a Python script as an extension for data inputs. One of the use cases would be to provide monitoring to resources that do not have a corresponding OID, for example, if we would like to know how to graph how many times the access list <code class="inlineCode">permit_snmp</code> has allowed the host <code class="inlineCode">172.16.1.173</code> to conduct an SNMP query. </p>
    <div class="packt_tip">
      <p class="normal">The example assumes the SNMP station is at IP <code class="inlineCode">172.16.1.173</code>; please substitute the IP for the current lab management station IP.</p>
    </div>
    <p class="normal">We know we can see the number of matches via the CLI:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">iosv-1#</span>sh ip access-lists permit_snmp | I 172.16.1.173 10 permit 172.16.1.173 <span class="hljs-con-built_in">log</span> (6362 matches)
</code></pre>
    <p class="normal">However, the chances are there<a id="_idIndexMarker591"/> are no OIDs associated with this value (or we can just pretend that there are none). This is where we can use an external script to produce an output that can be consumed by the Cacti host.</p>
    <p class="normal">We can reuse the Pexpect script we discussed in <em class="chapterRef">Chapter 2</em>, <em class="italic">Low-Level Network Device Interactions</em>, <code class="inlineCode">chapter1_1.py</code>. We will rename it <code class="inlineCode">cacti_1.py</code>. Everything should be the same as the original script, except that we will execute the CLI command and save the output:</p>
    <pre class="programlisting code"><code class="hljs-code">&lt;skip&gt;
<span class="hljs-keyword">for</span> device <span class="hljs-keyword">in</span> devices.keys():
…
    child.sendline<span class="hljs-string">''</span>sh ip access-lists permit_snmp | i <span class="hljs-number">172.16.1.17</span><span class="hljs-string">''</span>)
    child.expect(device_prompt)
    output = child.before
</code></pre>
    <p class="normal">The output in its raw form will appear as follows:</p>
    <pre class="programlisting con"><code class="hljs-con">''sh ip access-lists permit_snmp | i 172.16.1.173rn 10 permit 172.16.1.173 log (6428 matches)r''
</code></pre>
    <p class="normal">We will use the <code class="inlineCode">split()</code> function for the string to only leave the number of matches and print them out on standard output in the script:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-built_in">print</span>(<span class="hljs-built_in">str</span>(output).split<span class="hljs-string">'''')[1].split()[0])</span>
</code></pre>
    <p class="normal">To test this, we can see the number of increments by executing the script a number of times:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$ </span>./cacti_1.py
6428
<span class="hljs-con-meta">$ </span>./cacti_1.py
6560
<span class="hljs-con-meta">$ </span>./cacti_1.py
6758
</code></pre>
    <p class="normal">We can make the script executable and put it into the default Cacti script location:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$ </span><span class="hljs-con-built_in">chmod</span> a+x cacti_1.py
<span class="hljs-con-meta">$ </span>sudo <span class="hljs-con-built_in">cp</span> cacti_1.py /usr/share/cacti/site/scripts/
</code></pre>
    <p class="normal">The Cacti<a id="_idIndexMarker592"/> documentation, available<a id="_idIndexMarker593"/> at <a href="http://www.cacti.net/downloads/docs/html/how_to.html"><span class="url">http://www.cacti.net/downloads/docs/html/how_to.html</span></a>, provides detailed steps on how to add the script result to the output graph.</p>
    <p class="normal">These steps include adding the script as a data input method, adding the input method to a data source, and then creating a graph to be viewed:</p>
    <figure class="mediaobject"><img alt="Graphical user interface  Description automatically generated" src="../Images/B18403_07_16.png"/></figure>
    <p class="packt_figref">Figure 7.16: Data input method results page</p>
    <p class="normal">SNMP is a common<a id="_idIndexMarker594"/> way to provide network monitoring services to devices. RRDtool with Cacti<a id="_idIndexMarker595"/> as the frontend provides a good platform for all network devices via SNMP. We can also use Python scripts to extend information gathering beyond SNMP.</p>
    <h1 class="heading-1" id="_idParaDest-191">Summary</h1>
    <p class="normal">In this chapter, we explored ways to perform network monitoring via SNMP. We configured SNMP-related commands on network devices and used our network management VM with an SNMP poller to query the devices. We used the PySNMP module to simplify and automate our SNMP queries. We also learned how to save the query results in a flat file or database to be used for future examples.</p>
    <p class="normal">Later in this chapter, we used two different Python visualization packages, Matplotlib and Pygal, to graph SNMP results. Each package has its distinct advantages. Matplotlib is a mature, feature-rich library widely used in data science projects. Pygal can natively generate SVG-format graphs that are flexible and web-friendly. We saw how to generate line and pie graphs relevant to network monitoring.</p>
    <p class="normal">Toward the end of this chapter, we looked at an all-inclusive network monitoring tool named Cacti. It primarily uses SNMP for network monitoring, but we saw how we could use Python scripts as an input source to extend the platform’s monitoring capabilities when SNMP OID is not available on the remote host.</p>
    <p class="normal">In <em class="chapterRef">Chapter 8</em>, <em class="italic">Network Monitoring with Python – Part 2</em>, we will continue to discuss the tools we can use to monitor our networks and gain insight into whether the network is behaving as expected. We will look at flow-based monitoring using NetFlow, sFlow, and IPFIX. We will also use tools such as Graphviz to visualize our network topology and detect any topological changes.</p>
    <h1 class="heading-1">Join our book community</h1>
    <p class="normal">To join our community for this book – where you can share feedback, ask questions to the author, and learn about new releases – follow the QR code below:</p>
    <p class="normal"><a href="https://packt.link/networkautomationcommunity"><span class="url">https://packt.link/networkautomationcommunity</span></a></p>
    <p class="normal"><img alt="" src="../Images/QR_Code2903617220506617062.png"/></p>
  </div>
</body></html>