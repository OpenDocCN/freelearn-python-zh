- en: Chapter 7. Working with Images Using Computer Vision
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第7章. 使用计算机视觉处理图像
- en: In this chapter, we will be getting started on interfacing a USB camera with
    a BeagleBone board and capturing images from the camera using OpenCV. We will
    start by installing OpenCV first and then move ahead with capturing images using
    OpenCV and Python.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将开始将USB摄像头与BeagleBone板接口，并使用OpenCV从摄像头捕获图像。我们将首先安装OpenCV，然后继续使用OpenCV和Python捕获图像。
- en: 'We will look deeply into the topics given in this chapter:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将深入探讨本章中给出的主题：
- en: Prerequisites
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 前提条件
- en: Adding a USB camera to BeagleBone Black
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将USB摄像头添加到BeagleBone Black
- en: An introduction to OpenCV
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: OpenCV简介
- en: Using Python and OpenCV together
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Python和OpenCV一起
- en: Image capture from a camera using Python and OpenCV
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Python和OpenCV从摄像头捕获图像
- en: Prerequisites
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 前提条件
- en: This topic will cover what parts you will need in this chapter. These can be
    bought online.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 本节将介绍在本章中你需要哪些部件。这些部件都可以在网上购买。
- en: 'We will need the following materials to begin:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将需要以下材料开始：
- en: 1x BeagleBone Black
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1x BeagleBone Black
- en: 1x microSD card with the latest version of Debian flashed on it to boot the
    BeagleBone board from a microSD card
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1x带有最新版本Debian的microSD卡，用于从microSD卡启动BeagleBone板
- en: 1x 5V DC, 2A power supply
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1x 5V DC，2A电源
- en: 1x Ethernet cable
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1x以太网线
- en: 1x USB camera
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1x USB摄像头
- en: Materials needed
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 需要的材料
- en: 1x BeagleBone Black
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1x BeagleBone Black
- en: 1x microSD card with latest version of Debian flashed on it to boot the BeagleBone
    board from an microSD card
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1x带有最新版本Debian的microSD卡，用于从microSD卡启动BeagleBone板
- en: 1x 5V DC, 2A power supply
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1x 5V DC，2A电源
- en: 1x Ethernet cable
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1x以太网线
- en: 1x USB camera
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 1x USB摄像头
- en: Adding a USB camera to a BeagleBone board
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将USB摄像头添加到BeagleBone板
- en: 'Adding a USB camera to a BeagleBone board is pretty straightforward. All you
    need to do is get a USB camera that is compatible with Linux, so one which has
    drivers for Linux. These days almost all USB web cameras come with this support.
    If you have a very old USB web camera that you want to interface with a BeagleBone
    board, you might have to add some additional steps to install the device drivers
    to see your video camera element on the Linux devices list on the BeagleBone board.
    For this topic explanation, I used a Logitech C270 HD webcam, as shown in the
    following figure:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 将USB摄像头添加到BeagleBone板非常简单。你所需要做的就是获取一个与Linux兼容的USB摄像头，也就是有Linux驱动程序的摄像头。如今，几乎所有的USB网络摄像头都带有这种支持。如果你有一个非常旧的USB网络摄像头，你想与BeagleBone板接口，你可能需要添加一些额外的步骤来安装设备驱动程序，以便在BeagleBone板的Linux设备列表上看到你的视频摄像头元素。对于这个主题解释，我使用了如图所示的Logitech
    C270 HD网络摄像头：
- en: '![Adding a USB camera to a BeagleBone board](img/4602_07_01.jpg)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![将USB摄像头添加到BeagleBone板](img/4602_07_01.jpg)'
- en: 'You can use the USB port available on the BeagleBone board to connect the USB
    camera as shown in the following picture:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用BeagleBone板上的USB端口，如图所示连接USB摄像头：
- en: '![Adding a USB camera to a BeagleBone board](img/4602_07_02.jpg)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![将USB摄像头添加到BeagleBone板](img/4602_07_02.jpg)'
- en: 'Boot the BeagleBone board using Debian on the MicroSD Card that we flashed
    earlier, and login into the BeagleBone board via SSH. Now type the command `Lsusb`
    as shown in the following screenshot:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 使用我们之前烧录的Debian在MicroSD卡上启动BeagleBone板，并通过SSH登录到BeagleBone板。现在输入命令 `Lsusb`，如图所示：
- en: '![Adding a USB camera to a BeagleBone board](img/4602_07_03.jpg)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![将USB摄像头添加到BeagleBone板](img/4602_07_03.jpg)'
- en: If you are able to see the webcam listed on the device list, it means the camera
    is connected properly to the BeagleBone board, via USB.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你能在设备列表中看到网络摄像头，这意味着摄像头已通过USB正确连接到BeagleBone板。
- en: Then, check whether the drivers are available for the camera in the Linux kernel
    and if it has successfully interfaced, and created a video input element in the
    list of devices in Debian. Let's change the directory to dev directory `cd /dev`,
    and then `ls`. If you see the **video0** listed on the list, then you can assume
    that everything went well and the USB web camera was interfaced with the BeagleBone
    board successfully. We now have a video0 element that we can use in OpenCV or
    in any other software that we will be installing in BeagleBone board to get a
    video input from the camera.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，检查Linux内核中是否为摄像头提供了驱动程序，以及它是否已成功接口，并在Debian设备列表中创建了一个视频输入元素。让我们更改目录到dev目录
    `cd /dev`，然后 `ls`。如果你看到列表上列出了**video0**，那么你可以假设一切顺利，USB网络摄像头已成功与BeagleBone板接口。我们现在有一个可以用于OpenCV或任何其他软件的视频0元素，我们将安装到BeagleBone板上以从摄像头获取视频输入。
- en: '![Adding a USB camera to a BeagleBone board](img/4602_07_04.jpg)'
  id: totrans-31
  prefs: []
  type: TYPE_IMG
  zh: '![将USB摄像头添加到BeagleBone板](img/4602_07_04.jpg)'
- en: Now that we have a video component available in our BeagleBone board, we can
    go ahead and install OpenCV to get started with capturing images from the USB
    web camera and store them on the microSD card available on our BeagleBone board.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们BeagleBone板上已经有了视频组件，我们可以继续安装OpenCV，开始从USB网络摄像头捕获图像并将它们存储在BeagleBone板上的microSD卡上。
- en: OpenCV – introduction and setting up on the BeagleBone board
  id: totrans-33
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: OpenCV – 简介和在BeagleBone板上设置
- en: In this topic you will learn about what OpenCV is and how we can use it to capture
    images from a web camera that is connected to the BeagleBone board.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个主题中，你将了解OpenCV是什么以及我们如何使用它从连接到BeagleBone板的网络摄像头捕获图像。
- en: OpenCV stands for Open Source Computer Vision. It is mainly designed for real-time
    computer visualization. So, this library will basically help us to use commonly
    used programming languages like C, C++ and Python to capture images from the camera
    connected to our computer – in our case, using the BeagleBone board. When we go
    to the project section of this chapter to capture an image from the USB camera
    using Python, you will understand how simple the OpenCV library makes it to code
    in getting inputs from the camera, generate outputs as image files, and much more
    in image processing.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: OpenCV代表开源计算机视觉。它主要是为实时计算机视觉设计的。因此，这个库将基本上帮助我们使用常用的编程语言，如C、C++和Python，从连接到我们计算机的摄像头捕获图像——在我们的案例中，使用BeagleBone板。当我们进入本章的项目部分，使用Python从USB摄像头捕获图像时，你会理解OpenCV库如何使代码从摄像头获取输入、生成图像文件输出以及更多图像处理功能变得简单。
- en: Installing OpenCV on Debian on a BeagleBone board
  id: totrans-36
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在BeagleBone板上的Debian系统上安装OpenCV
- en: 'Follow the steps to install OpenCV on Debian on a BeagleBone board:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 按照步骤在BeagleBone板上的Debian系统上安装OpenCV：
- en: 'Step 1: Install compiler:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 第1步：安装编译器：
- en: '[PRE0]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'These compilers are very important to build packages from source codes and
    then install them. Installing them will be useful for us in future, particularly
    during the robot project:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 这些编译器对于从源代码构建软件包然后安装它们非常重要。安装它们对我们未来很有用，尤其是在机器人项目期间：
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_05.jpg)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上的Debian系统上安装OpenCV](img/4602_07_05.jpg)'
- en: 'Step 2: Install the other required packages that are needed before compiling
    compulsorily:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 第2步：安装编译前必需的其他软件包：
- en: '[PRE1]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: In Linux, most of the software written will use other open source packages in
    them to build their software, so these packages are the ones that OpenCV use in
    their software to give us a beautiful and easy to code/use library.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在Linux中，大多数编写的软件将使用其他开源软件包来构建它们的软件，因此这些软件包是OpenCV在它们的软件中使用的，以给我们一个美丽且易于编码/使用的库。
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_06.jpg)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上的Debian系统上安装OpenCV](img/4602_07_06.jpg)'
- en: When you install the packages, if it prompts you to use additional disk space,
    go ahead and hit *Y* and then *Enter* to get started installing the required packages.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 当你安装这些软件包时，如果提示你使用额外的磁盘空间，请继续按*Y*然后按*Enter*开始安装所需的软件包。
- en: 'There are some more software packages you will have to install before compiling,
    which are listed following:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在编译之前，你还需要安装一些其他软件包，这些软件包如下所示：
- en: '`sudo apt-get -y install libjpeg62-dev`'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sudo apt-get -y install libjpeg62-dev`'
- en: '`sudo apt-get -y install libtiff4-dev libjasper-dev`'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sudo apt-get -y install libtiff4-dev libjasper-dev`'
- en: '`sudo apt-get -y install libgtk2.0-dev`'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sudo apt-get -y install libgtk2.0-dev`'
- en: '`sudo apt-get -y install libavcodec-dev libavformat-dev libswscale-dev libv4l-dev`'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sudo apt-get -y install libavcodec-dev libavformat-dev libswscale-dev libv4l-dev`'
- en: '`sudo apt-get -y install libdc1394-22-dev`'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sudo apt-get -y install libdc1394-22-dev`'
- en: '`sudo apt-get -y install libxine-dev libgstreamer0.10-dev libgstreamer-plugins-base0.10-dev`'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sudo apt-get -y install libxine-dev libgstreamer0.10-dev libgstreamer-plugins-base0.10-dev`'
- en: '`sudo apt-get -y install python-dev python-numpy`'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sudo apt-get -y install python-dev python-numpy`'
- en: '`sudo apt-get -y install libqt4-dev`'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sudo apt-get -y install libqt4-dev`'
- en: '`sudo apt-get install unzip`'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sudo apt-get install unzip`'
- en: 'Step 3: Install a few other optional softwares that might come in handy in
    the future while working with OpenCV. These are recommended by OpenCV:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 第3步：安装一些可能在未来使用OpenCV时很有用的其他可选软件。这些软件由OpenCV推荐：
- en: '`sudo apt-get install python-dev python-numpy libjpeg-dev libpng-dev libtiff-dev
    libjasper-dev libdc1394-22-dev`'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sudo apt-get install python-dev python-numpy libjpeg-dev libpng-dev libtiff-dev
    libjasper-dev libdc1394-22-dev`'
- en: These softwares are not compulsory to for OpenCV to work, but when you connect
    a display to a BeagleBone board in the future and want to use graphics, these
    will surely come in handy. It's better to install them now instead of getting
    frustrated in the future with errors popping up when you write codes with display
    elements and GUI.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 这些软件对于OpenCV的正常运行并非必需，但当你将来将显示器连接到BeagleBone板并希望使用图形时，这些软件将非常有用。现在安装它们比将来在编写带有显示元素和GUI的代码时遇到错误而感到沮丧要好。
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_07.jpg)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装Debian上的OpenCV](img/4602_07_07.jpg)'
- en: 'By this stage, we have installed all the necessary packages needed to compile
    and install OpenCV on BeagleBone Black. So, now let''s go ahead and download the
    source code files of OpenCV and then compile and install them. Let''s create a
    new directory and save all the files inside it while building the OpenCV library:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 到这一步，我们已经安装了编译和安装OpenCV在BeagleBone Black上所需的所有必要软件包。因此，现在让我们继续下载OpenCV的源代码文件，然后编译和安装它们。让我们创建一个新的目录，并在构建OpenCV库时将所有文件保存在其中：
- en: 'Step 4: Create an OpenCVdirectory with the following commands:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 第4步：使用以下命令创建一个OpenCV目录：
- en: '`mkdir OCV`'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`mkdir OCV`'
- en: '`cd OCV`'
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`cd OCV`'
- en: 'It will look like this:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 它将看起来像这样：
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_08.jpg)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装Debian上的OpenCV](img/4602_07_08.jpg)'
- en: 'Step 5: Clone the OpenCV source code into our working directory:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 第5步：将OpenCV源代码克隆到我们的工作目录中：
- en: '`wget https://sourceforge.net/projects/opencvlibrary/files/opencv-unix/2.4.9/opencv-2.4.9.zip`'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`wget https://sourceforge.net/projects/opencvlibrary/files/opencv-unix/2.4.9/opencv-2.4.9.zip`'
- en: 'The `wget` command will download the file from the URL that follows it and
    save it in the present working directory. You can see the percentage of the download
    status as it happens in the Linux shell, as shown in the following screenshot:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: '`wget`命令将从它后面的URL下载文件，并将其保存在当前工作目录中。您可以在Linux shell中看到下载状态的百分比，如下面的截图所示：'
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_09.jpg)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装Debian上的OpenCV](img/4602_07_09.jpg)'
- en: 'You need to wait until the download completes and check whether you received
    the zip file by using the `ls` command. If you see the file, as shown in the following
    screenshot, you can proceed to the next step:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要等待下载完成，并使用`ls`命令检查是否收到了zip文件。如果您看到文件，如下面的截图所示，您可以继续下一步：
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_10.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装Debian上的OpenCV](img/4602_07_10.jpg)'
- en: 'Step 6: Building OpenCV from source files using cmake:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 第6步：使用cmake从源文件构建OpenCV：
- en: '`unzip opencv-2.4.9.zip –d opencv`'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`unzip opencv-2.4.9.zip –d opencv`'
- en: First we need to unzip the `.zip` file we downloaded to extract the contents
    of the file.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们需要解压我们下载的`.zip`文件以提取文件内容。
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_11.jpg)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装Debian上的OpenCV](img/4602_07_11.jpg)'
- en: 'Then we compile the files inside it wait until unzipping process is completed:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们编译文件夹内的文件，等待解压过程完成：
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_12.jpg)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装Debian上的OpenCV](img/4602_07_12.jpg)'
- en: 'Then use the `ls` command to check whether an `opencv` folder is created and
    the contents of the `.zip` have been extracted inside it:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 然后使用`ls`命令检查是否已创建`opencv`文件夹，以及`.zip`文件的内容是否已提取到其中：
- en: '`ls`'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ls`'
- en: 'You can see the `opencv` folder has been created, inside which the files have
    been unzipped: `cd opencv`:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以看到已经创建了`opencv`文件夹，其中包含了已解压的文件：`cd opencv`：
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_13.jpg)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装Debian上的OpenCV](img/4602_07_13.jpg)'
- en: 'This is how the `ls` and `cd opencv-2.4.9` will look like in the command:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是`ls`和`cd opencv-2.4.9`在命令行中的样子：
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_14.jpg)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装Debian上的OpenCV](img/4602_07_14.jpg)'
- en: 'Now we need to create a folder inside which we will compile and build the files
    for installation from the source files available inside the `opencv-2.4.9` folder.
    You need to execute the commands `mkdir build` and `cd build` in order to do that:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们需要在`opencv-2.4.9`文件夹中创建一个文件夹，我们将在这个文件夹中编译和构建安装文件。您需要执行`mkdir build`和`cd
    build`命令来完成此操作：
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_15.jpg)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装Debian上的OpenCV](img/4602_07_15.jpg)'
- en: '`cmake -D CMAKE_BUILD_TYPE=RELEASE -D CMAKE_INSTALL_PREFIX=/usr/local -D WITH_TBB=ON
    -D BUILD_NEW_PYTHON_SUPPORT=ON -D WITH_V4L=ON -D INSTALL_C_EXAMPLES=ON -D INSTALL_PYTHON_EXAMPLES=ON
    -D BUILD_EXAMPLES=ON -D WITH_QT=OFF -D WITH_OPENGL=ON`'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`cmake -D CMAKE_BUILD_TYPE=RELEASE -D CMAKE_INSTALL_PREFIX=/usr/local -D WITH_TBB=ON
    -D BUILD_NEW_PYTHON_SUPPORT=ON -D WITH_V4L=ON -D INSTALL_C_EXAMPLES=ON -D INSTALL_PYTHON_EXAMPLES=ON
    -D BUILD_EXAMPLES=ON -D WITH_QT=OFF -D WITH_OPENGL=ON`'
- en: 'This is how it looks:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是它的样子：
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_16.jpg)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装OpenCV到Debian](img/4602_07_16.jpg)'
- en: 'Now, wait until the configuration is finished:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，等待配置完成：
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_17.jpg)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装OpenCV到Debian](img/4602_07_17.jpg)'
- en: Once it has finished, you should see something like the preceding screenshot.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦完成，你应该会看到类似于前面的截图。
- en: 'Now we can go ahead and compile the files:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以继续编译文件：
- en: 'Step 7: Compile `make` and it will look like this:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 第7步：编译`make`，它看起来像这样：
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_18.jpg)'
  id: totrans-95
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装OpenCV到Debian](img/4602_07_18.jpg)'
- en: 'Wait until the program is compiled and ready to install:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 等待程序编译并准备安装：
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_19.jpg)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装OpenCV到Debian](img/4602_07_19.jpg)'
- en: 'Once the files are compiled and built, we can install OpenCV libraries to our
    system using the next step:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦文件编译和构建完成，我们可以使用以下步骤将OpenCV库安装到我们的系统中：
- en: 'Step 8: Install `sudo make install`:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 第8步：安装`sudo make install`：
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_20.jpg)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装OpenCV到Debian](img/4602_07_20.jpg)'
- en: Wait until the program is installed.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 等待程序安装完成。
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_21.jpg)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装OpenCV到Debian](img/4602_07_21.jpg)'
- en: 'Once installed let''s go ahead and test whether everything was installed properly
    with the following command:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完成后，让我们使用以下命令测试是否所有内容都正确安装：
- en: 'Step 9: Validate the installation'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 第9步：验证安装
- en: 'Since we will be using Python and OpenCV together, lets validate whether the
    Python library of OpenCV was installed properly or not, using the following command:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们将一起使用Python和OpenCV，让我们使用以下命令验证OpenCV的Python库是否正确安装：
- en: '`sudo python`'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sudo python`'
- en: 'Inside the Python interactive shell enter the `from cv2 import_version_` command
    to import the library, and then to print the version execute the following command:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 在Python交互式shell中输入`from cv2 import_version_`命令以导入库，然后执行以下命令以打印版本：
- en: '`_version_`'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`_版本_`'
- en: 'You should see something like the following screenshot:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 你应该会看到以下截图：
- en: '![Installing OpenCV on Debian on a BeagleBone board](img/4602_07_22.jpg)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![在BeagleBone板上安装OpenCV到Debian](img/4602_07_22.jpg)'
- en: If it prints the version without any errors, everything is fine, you can see
    that its **2.4.9**, and that is the same version you downloaded as a zip file
    in step 5.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 如果它没有错误地打印版本，那么一切正常，你可以看到它是**2.4.9**，这与你在第5步中下载的zip文件中的版本相同。
- en: Now that we have the OpenCV library successfully installed we can go ahead to
    our next topic where we will be using Python and OpenCV together to capture an
    image from the USB video camera that we have plugged into our BeagleBone board.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经成功安装了OpenCV库，我们可以继续到下一个主题，我们将使用Python和OpenCV一起从我们插入到BeagleBone板上的USB视频相机捕获图像。
- en: 'Project: Image capture from a camera using Python and OpenCV'
  id: totrans-113
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 项目：使用Python和OpenCV从相机捕获图像
- en: In this chapter we will be writing a code to capture an image from a camera
    and saving it in `.jpg` format using Python.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将编写一个代码来从相机捕获图像，并使用Python将其保存为`.jpg`格式。
- en: 'Let''s first create a directory named `ImageCapture` inside which we can save
    the Python file in which we write the code, and where we can also save the image
    file that we capture:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们先创建一个名为`ImageCapture`的目录，在其中我们可以保存我们编写的Python文件，以及我们捕获的图像文件：
- en: '`mkdir ImageCapture`'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`mkdir ImageCapture`'
- en: '`cd ImageCapture`'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`cd ImageCapture`'
- en: 'It will look like the following screenshot:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 它看起来像以下截图：
- en: '![Project: Image capture from a camera using Python and OpenCV](img/4602_07_23.jpg)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![项目：使用Python和OpenCV从相机捕获图像](img/4602_07_23.jpg)'
- en: '`sudo nano TakePhoto.py`'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`sudo nano TakePhoto.py`'
- en: 'Refer to the following image:'
  id: totrans-121
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 参考以下图像：
- en: '![Project: Image capture from a camera using Python and OpenCV](img/4602_07_24.jpg)'
  id: totrans-122
  prefs:
  - PREF_IND
  type: TYPE_IMG
  zh: '![项目：使用Python和OpenCV从相机捕获图像](img/4602_07_24.jpg)'
- en: 'Now we can go ahead and start writing the code to capture an image from the
    camera and save it on the BeagleBone Black:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以开始编写代码来从相机捕获图像并将其保存到BeagleBone Black上：
- en: 'The simplest code possible to do this is given in the following screenshot:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 完成此任务的最简单代码如下截图所示：
- en: '![Project: Image capture from a camera using Python and OpenCV](img/4602_07_25.jpg)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
  zh: '![项目：使用Python和OpenCV从相机捕获图像](img/4602_07_25.jpg)'
- en: Save it and run it to capture an image from the camera and save it.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 保存它并运行它以从相机捕获图像并保存。
- en: 'The output you will see when you run the code `sudo python TakePhoto.py` is
    as shown in the following screenshot:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 当您运行`sudo python TakePhoto.py`代码时，您将看到的输出如下截图所示：
- en: '![Project: Image capture from a camera using Python and OpenCV](img/4602_07_26.jpg)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![项目：使用Python和OpenCV从相机捕获图像](img/4602_07_26.jpg)'
- en: 'If you don''t get any errors and the program ends printing the **Saving Image**
    text, everything should have happened properly. To check this let''s see whether
    the `Photo.jpg` file has been created inside the folder or not. You can use the
    `ls` command to do it and you should see the `Photo.jpg` file created as shown
    in the following screenshot:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您没有收到任何错误，并且程序结束时打印出**保存图像**文本，那么一切应该都进行得很顺利。为了检查这一点，让我们看看`Photo.jpg`文件是否已经创建在文件夹中。您可以使用`ls`命令来检查，您应该会看到如下截图所示的`Photo.jpg`文件已创建：
- en: '![Project: Image capture from a camera using Python and OpenCV](img/4602_07_27.jpg)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![项目：使用Python和OpenCV从相机捕获图像](img/4602_07_27.jpg)'
- en: Since we are working on BeagleBone Black via SSH we don't have the option to
    view the image directly on the GUI now – we will need a **File Transfer Protocol**
    (**FTP**) client software to download the image that was captured. So, let's go
    ahead and install one on our Windows PC now.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们正在通过SSH在BeagleBone Black上工作，我们现在没有直接在GUI上查看图像的选项 - 我们将需要一个**文件传输协议**（**FTP**）客户端软件来下载捕获的图像。所以，让我们现在在我们的Windows
    PC上安装一个。
- en: Tip
  id: totrans-132
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 小贴士
- en: FileZilla is my favourite, so I will be using it in this tutorial, you can use
    the ones you are familiar with or install FileZilla if you don't have it.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: FileZilla是我最喜欢的，所以在这个教程中我会使用它，您可以使用您熟悉的软件，或者如果您还没有安装FileZilla，可以安装它。
- en: 'Once you have opened the FTP software, it will ask you for the IP address of
    the device, username, password, and port number:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您打开了FTP软件，它将要求您输入设备的IP地址、用户名、密码和端口号：
- en: '![Project: Image capture from a camera using Python and OpenCV](img/4602_07_28.jpg)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![项目：使用Python和OpenCV从相机捕获图像](img/4602_07_28.jpg)'
- en: This is how the software looks. You can see on the top left corner a space for
    entering the host's IP address, username, password, and port number. Below that
    you can see the directory selection of where you want the files to be downloaded
    and uploaded from, and at the bottom, you can see the log of data transfers.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是软件的外观。您可以在左上角看到一个输入主机IP地址、用户名、密码和端口号的空间。下面您可以看到您想要下载和上传文件的目录选择，底部您可以看到数据传输的日志。
- en: 'Now lets go ahead and connect our PC to the BeagleBone Black via FTP to transfer
    the image file we captured and see how it looks. The details you need to enter
    are the IP address assigned to the BeagleBone board, using which you connect to
    it via SSH, the same IP address and user name as `debian` and password `temppwd`
    which is default, if you have changed your username and password, then use them
    here and the port number is `22`. Then click on the Quick connect button and you
    should see the files on the BeagleBone Black, as shown in the following screenshot:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们继续将我们的PC通过FTP连接到BeagleBone Black，以传输我们捕获的图像文件，并看看它的样子。您需要输入的详细信息是分配给BeagleBone板的IP地址，您将通过SSH连接到它，与`debian`相同的IP地址和用户名，默认密码为`temppwd`，如果您已经更改了用户名和密码，则在这里使用它们，端口号为`22`。然后点击快速连接按钮，您应该会看到BeagleBone
    Black上的文件，如下面的截图所示：
- en: '![Project: Image capture from a camera using Python and OpenCV](img/4602_07_29.jpg)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![项目：使用Python和OpenCV从相机捕获图像](img/4602_07_29.jpg)'
- en: 'You can click on the **+** symbol next to the `Debian` folder shown in the
    picture and navigate to the `ImageCapture` folder inside which the `Photo.jpg`
    file that we captured and saved is present. You will see something like the following
    screenshot:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以点击图片中显示的`Debian`文件夹旁边的**+**符号，然后导航到其中的`ImageCapture`文件夹，我们捕获并保存的`Photo.jpg`文件就在这个文件夹里。您会看到如下截图所示的内容：
- en: '![Project: Image capture from a camera using Python and OpenCV](img/4602_07_30.jpg)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![项目：使用Python和OpenCV从相机捕获图像](img/4602_07_30.jpg)'
- en: 'Now you can go ahead and download the file. Once you click on **Download**,
    the file will be downloaded to the FTP folder or the folder which you have selected
    on the PC fpr where the files will be downloaded. You can see in the following
    screenshot that the `Photo.jpg` file is now inside the FTP folder which was empty
    before on your PC:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您可以继续下载文件。一旦您点击**下载**，文件将被下载到FTP文件夹或您在PC上选择的用于下载文件的文件夹中。您可以在下面的屏幕截图中看到，`Photo.jpg`文件现在位于您的PC上之前为空的FTP文件夹中：
- en: '![Project: Image capture from a camera using Python and OpenCV](img/4602_07_31.jpg)'
  id: totrans-142
  prefs: []
  type: TYPE_IMG
  zh: '![项目：使用Python和OpenCV从相机捕获图像](img/4602_07_31.jpg)'
- en: So, now that you have the photo that you captured, downloaded to your PC, you
    can go ahead and open it to see it with the image viewer software you have set
    up on your PC.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，现在您已经将捕获的照片下载到您的PC上，您可以继续打开它，使用您在PC上设置的图像查看软件查看它。
- en: '![Project: Image capture from a camera using Python and OpenCV](img/4602_07_32.jpg)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![项目：使用Python和OpenCV从相机捕获图像](img/4602_07_32.jpg)'
- en: 'The image captured is as shown in the previous screenshot and the arrangement
    of the camera while taking this picture was as shown in the following screenshot:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 捕获的图像如前一个屏幕截图所示，拍摄此照片时相机的布置如以下屏幕截图所示：
- en: '![Project: Image capture from a camera using Python and OpenCV](img/4602_07_33.jpg)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![项目：使用Python和OpenCV从相机捕获图像](img/4602_07_33.jpg)'
- en: In the preceding picture you can see that the camera has been placed pointing
    towards the BeagleBone Black and at a distance, so the image that we captured
    was showing the side view of the BeagleBone Black, showing the USB connected to
    it, and the background.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的图片中，您可以看到相机已经被放置，指向BeagleBone Black，并且距离较远，因此我们捕获的图像显示了BeagleBone Black的侧面视图，显示了连接到它的USB，以及背景。
- en: So, in this way, you can use Python and OpenCV together to take pictures and
    save them for use in many applications.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，这样，您可以使用Python和OpenCV一起拍照并保存它们，用于许多应用程序。
- en: Summary
  id: totrans-149
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: This chapter was just a start for you get to know what open OpenCV is, to set
    it up on BeagleBone Black and to understand a little bit of what you can do with
    it using Python by writing just a few lines of code. In this chapter, the image
    capture project is just a simple thing we did – you can play around and do a lot
    more like capturing videos and saving them, changing a color image to black and
    white, and other image processing using OpenCV and Python. Now we know how to
    click a picture and save it.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 本章只是为您了解OpenCV是什么，将其设置在BeagleBone Black上，以及通过编写几行代码了解您可以使用它做什么的开始。在本章中，图像捕获项目只是我们做的简单事情——您可以尝试更多，比如捕获视频并保存，将彩色图像转换为黑白，以及使用OpenCV和Python进行其他图像处理。现在我们知道了如何拍照并保存。
- en: In the next chapter, we will build a home security application project using
    a sensor to detect motion and click a picture whenever a motion is detected. In
    this way, we will be building a real-time application using OpenCV, BeagleBone
    Black and Python where the system will interact with the physical world.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将构建一个家庭安全应用程序项目，使用传感器检测运动并在检测到运动时拍照。这样，我们将构建一个实时应用程序，使用OpenCV、BeagleBone
    Black和Python，系统将与物理世界进行交互。
