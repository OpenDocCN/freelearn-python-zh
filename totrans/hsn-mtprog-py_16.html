<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer133">
<h1 id="_idParaDest-160"><em class="italic"><a id="_idTextAnchor162"/>Chapter 13</em>: Applying GOF Design Patterns – Part 2</h1>
<p>In this chapter, we will continue looking at the concept of design patterns in Python 3 and its various categories and their implementation while developing software using Python.</p>
<p>In the previous chapter, we learned how to apply behavioral design patterns with examples. In this chapter, we will continue looking at the remaining two categories – structural and creational design patterns. We will see how they can be applied in Python using our core example of <em class="italic">ABC Megamart</em>.</p>
<p>In this chapter, we will be looking at the following main topics:</p>
<ul>
<li>Understanding structural design patterns</li>
<li>Understanding creational design patterns</li>
</ul>
<p>By the end of this chapter, you should be able to understand some of the examples of important structural and creational design patterns and learn how they can be implemented in various applications.</p>
<h1 id="_idParaDest-161"><a id="_idTextAnchor163"/>Technical requirements</h1>
<p>The code examples shared in this chapter are available on GitHub under the code for this chapter here: <a href="https://github.com/PacktPublishing/Metaprogramming-with-Python/tree/main/Chapter13">https://github.com/PacktPublishing/Metaprogramming-with-Python/tree/main/Chapter13</a>.</p>
<h1 id="_idParaDest-162"><a id="_idTextAnchor164"/>Exploring structural design patterns</h1>
<p>As the name suggests, structural design patterns are used to design the structure of classes and their implementation in such a way that the classes and objects can be extended or reused effectively. In this section, we will be covering three such structural design patterns — bridge, façade, and proxy patterns. We are considering these three design patterns because they are unique and they represent three different aspects of how structural design patterns can be used.</p>
<h2 id="_idParaDest-163"><a id="_idTextAnchor165"/>Understanding the bridge pattern</h2>
<p>The bridge design pattern is<a id="_idIndexMarker605"/> applied to bridge multiple elements or operations of implementation using the concept of abstraction or the abstract method. To explain this further and to implement this design pattern, our code should have the<a id="_idIndexMarker606"/> following elements:</p>
<ul>
<li><strong class="bold">Abstraction superclass</strong>: The<a id="_idIndexMarker607"/> base class with the abstract method to perform a specific action, along with methods to bridge any additional implementation</li>
<li><strong class="bold">Abstraction subclasses</strong>: One<a id="_idIndexMarker608"/> or more subclasses that implement the abstract method from the abstraction superclass to perform their respective action</li>
<li><strong class="bold">Implementation superclass</strong>: A base <a id="_idIndexMarker609"/>that adds an additional implementation or design over the abstraction</li>
<li><strong class="bold">Implementation subclasses</strong>: Subclasses<a id="_idIndexMarker610"/> that inherit the implementation superclass</li>
</ul>
<p>Let’s look at the<a id="_idIndexMarker611"/> bridge pattern with an example. In this example, we will look at printing the business card for branch managers that belong to two different supermarkets – <em class="italic">ABC Megamart</em> and <em class="italic">XYZ Megamart</em>. Let’s see how:</p>
<ol>
<li>To illustrate the design pattern further, let’s create an abstraction superclass named <strong class="source-inline">PrintCard</strong>, and add three methods. The <strong class="source-inline">add_name</strong> method adds the name of the supermarket, and the <strong class="source-inline">add_manager</strong> method adds the formatting specific to a manager. The <strong class="source-inline">add_manager</strong> method gets the formatting input from the implementation subclass, which we will discuss later in this section. The third method is the <strong class="source-inline">printcard</strong> method, which is an abstract method and will be defined in the subclasses:<p class="source-code">from abc import abstractmethod, ABC</p><p class="source-code">class PrintCard(ABC):    </p><p class="source-code">    def add_name(self, name):</p><p class="source-code">        self.name = name        </p><p class="source-code">    def add_manager(self, branch):</p><p class="source-code">        self.branch = branch.FORMATTING        </p><p class="source-code">    @abstractmethod</p><p class="source-code">    def printcard(self):</p><p class="source-code">        pass</p></li>
<li>Let’s<a id="_idIndexMarker612"/> further create an abstraction subclass named <strong class="source-inline">CardABC</strong>. This class will initialize the logo, name from the super class, and manager from the super class. The <strong class="source-inline">printcard</strong> method will print the logo, the name of the supermarket, and the address of the branch:<p class="source-code">class CardABC(PrintCard):</p><p class="source-code">    def __init__(self, logo, name, branch):</p><p class="source-code">        self.logo = logo</p><p class="source-code">        super().add_name(name)</p><p class="source-code">        super().add_manager(branch)</p><p class="source-code">        </p><p class="source-code">    def printcard(self, *args):</p><p class="source-code">        print(self.logo + self.name)</p><p class="source-code">        for arg in args:</p><p class="source-code">            print(self.branch + str(arg))</p></li>
<li>Next, create an abstraction subclass named <strong class="source-inline">CardXYZ</strong>. It will initialize the following variables – style, logo, name from super class, and manager from the superclass. The <strong class="source-inline">printcard</strong> method will print the logo, the style for the card, the name of the supermarket, and the address of the branch:<p class="source-code">class CardXYZ(PrintCard):</p><p class="source-code">    def __init__(self, style, logo, name, branch):</p><p class="source-code">        self.style = style</p><p class="source-code">        self.logo = logo</p><p class="source-code">        super().add_name(name)</p><p class="source-code">        super().add_manager(branch)</p><p class="source-code">        </p><p class="source-code">    def printcard(self, *args):</p><p class="source-code">        print(self.logo + self.style + self.name)</p><p class="source-code">        for arg in args:</p><p class="source-code">            print(self.branch + str(arg))</p></li>
<li>Now, let’s <a id="_idIndexMarker613"/>create the implementation superclass named <strong class="source-inline">Manager</strong> with a method named <strong class="source-inline">formatting</strong>:<p class="source-code">class Manager:</p><p class="source-code">    def formatting(self):</p><p class="source-code">        pass</p></li>
<li>Next, create an implementation subclass named <strong class="source-inline">Manager_manhattan</strong> to add formatting to the business card, specifically for the branch manager from the Manhattan branch:<p class="source-code">class Manager_manhattan(Manager):</p><p class="source-code">    def __init__(self):</p><p class="source-code">        self.formatting()</p><p class="source-code">    </p><p class="source-code">    def formatting(self):</p><p class="source-code">        self.FORMATTING = '\33[7m'</p></li>
<li>Let’s now create an implementation subclass named <strong class="source-inline">Manager_albany</strong> to add formatting for the business card specifically for the branch manager from the Albany branch:<p class="source-code">class Manager_albany(Manager):</p><p class="source-code">    def __init__(self):</p><p class="source-code">        self.formatting()</p><p class="source-code">    </p><p class="source-code">    def formatting(self):</p><p class="source-code">        self.FORMATTING = '\033[94m'</p></li>
<li>Next, instantiate <strong class="source-inline">CardABC</strong>, which is an abstraction subclass. The three input parameters<a id="_idIndexMarker614"/> for this class are the format of the logo, the name of the supermarket, and the branch from where the formatting will be added to the card:<p class="source-code">manager_manhattan = CardABC(logo = '\33[43m', name = 'ABC Megamart', branch = Manager_manhattan())</p></li>
<li>And now we will print the card:<p class="source-code">manager_manhattan.printcard('John M',</p><p class="source-code">              'john.m@abcmegamart.com',</p><p class="source-code">  '40097 5th Main Street',</p><p class="source-code">  'Manhattan',</p><p class="source-code">  'New York City',</p><p class="source-code">  'New York',</p><p class="source-code">  11007)</p></li>
</ol>
<p>The output is represented as follows, with the formatting as provided in the class instantiation:</p>
<p class="source-code"><strong class="bold">ABC Megamart</strong></p>
<p class="source-code"><strong class="bold">John M</strong></p>
<p class="source-code"><strong class="bold">john.m@abcmegamart.com</strong></p>
<p class="source-code"><strong class="bold">40097 5th Main Street</strong></p>
<p class="source-code"><strong class="bold">Manhattan</strong></p>
<p class="source-code"><strong class="bold">New York City</strong></p>
<p class="source-code"><strong class="bold">New York</strong></p>
<p class="source-code"><strong class="bold">11007</strong></p>
<ol>
<li value="9">Let’s now<a id="_idIndexMarker615"/> instantiate <strong class="source-inline">CardXYZ</strong>, which is an abstraction subclass. The four input parameters for this class are the style, the format of the logo, the name of the supermarket, and the branch from where the formatting will be added to the card:<p class="source-code">manager_albany = CardXYZ(style = '\33[43m',logo = '\33[5m', name = 'XYZ Megamart', branch = Manager_albany())</p></li>
<li>Now, let’s print the card.<p class="source-code">manager_albany.printcard('Ron D','ron.d@abcmegamart.com','123 Main Street','Albany','New York', 12084)</p></li>
</ol>
<p>The output is represented as follows, with the style and formatting as provided in the class instantiation:</p>
<p class="source-code"><strong class="bold">XYZ Megamart</strong></p>
<p class="source-code"><strong class="bold">Ron D</strong></p>
<p class="source-code"><strong class="bold">ron.d@abcmegamart.com</strong></p>
<p class="source-code"><strong class="bold">123 Main Street</strong></p>
<p class="source-code"><strong class="bold">Albany</strong></p>
<p class="source-code"><strong class="bold">New York</strong></p>
<p class="source-code"><strong class="bold">12084</strong></p>
<p>Let’s connect the elements of this design pattern with their corresponding objects in the example with the following graphical representation:</p>
<div>
<div class="IMG---Figure" id="_idContainer129">
<img alt="Figure 13.1 – Bridge pattern classes " height="1012" src="image/Figure_13.1_B13426.jpg" width="891"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.1 – Bridge pattern classes</p>
<p>So, the bridge <a id="_idIndexMarker616"/>pattern has been implemented by creating a bridge between the abstraction and the implementation classes. With this understanding, let’s look at the facade pattern.</p>
<h2 id="_idParaDest-164"><a id="_idTextAnchor166"/>Understanding the facade pattern</h2>
<p>In this section, we <a id="_idIndexMarker617"/>will look at the facade pattern, where we will design a black box kind of implementation to hide the complexity of a system that handles multiple subsystems from the end user or client. To explain this further and to implement this design<a id="_idIndexMarker618"/>/core pattern, our code needs the following elements:</p>
<ul>
<li><strong class="bold">Functionality</strong>: The core functionalities that need to be implemented for a system are defined in these <a id="_idIndexMarker619"/>functionality classes.</li>
<li><strong class="bold">Facade</strong>: This is<a id="_idIndexMarker620"/> the class that wraps the core functionalities and their implementation from the end users.</li>
<li><strong class="bold">End user</strong>: The function, method, or class <a id="_idIndexMarker621"/>using which the core functionalities of a system are accessed using the facade class.</li>
</ul>
<p>To understand the<a id="_idIndexMarker622"/> facade pattern further, let’s create a set of functionalities that starts from adding items to the shopping cart, moving to the counter, scanning bar codes, billing, and finally, printing the invoice: </p>
<ol>
<li value="1">The first functionality class in this series is <strong class="source-inline">Cart</strong>, where items will be added to the shopping cart in the <strong class="source-inline">return_cart</strong> method:<p class="source-code">class Cart:</p><p class="source-code">    def __init__(self, items):</p><p class="source-code">        self.items = items</p><p class="source-code">    def return_cart(self):</p><p class="source-code">        cart_items = []</p><p class="source-code">        for i in self.items:</p><p class="source-code">            cart_items.append(i)</p><p class="source-code">        print("Running return_cart...")</p><p class="source-code">        return cart_items</p></li>
<li>The second functionality class is the <strong class="source-inline">Counter</strong> class, where the name of the counter is returned in the <strong class="source-inline">goto_counter</strong> method:<p class="source-code">class Counter:</p><p class="source-code">    def __init__(self, name):</p><p class="source-code">        self.name = name</p><p class="source-code">    def goto_counter(self):</p><p class="source-code">        countername = self.name</p><p class="source-code">        print("Running goto_counter...")</p><p class="source-code">        return countername</p></li>
<li>The third functionality class is the <strong class="source-inline">BarCode</strong> class, where the scanned bar codes are returned in the <strong class="source-inline">scan_bar_code</strong> method:<p class="source-code">class BarCode:</p><p class="source-code">    def __init__(self, scan):</p><p class="source-code">        self.scan = scan</p><p class="source-code">    def scan_bar_code(self):</p><p class="source-code">        codes = []</p><p class="source-code">        for i in self.scan:</p><p class="source-code">            codes.append(i)</p><p class="source-code">        print("Running scan_bar_code...")</p><p class="source-code">        return codes</p></li>
<li>The fourth<a id="_idIndexMarker623"/> functionality is the <strong class="source-inline">Billing</strong> class, where the price is tagged to the bar codes and returned as a dictionary object in the <strong class="source-inline">add_billing</strong> method:<p class="source-code">class Billing:</p><p class="source-code">    def __init__(self, codes, units ):</p><p class="source-code">        self.codes = codes</p><p class="source-code">        self.units = units</p><p class="source-code">    def add_billing(self):</p><p class="source-code">        codes = self.codes.scan_bar_code()</p><p class="source-code">        pricetag = []</p><p class="source-code">        for i in self.units:</p><p class="source-code">            pricetag.append(i)</p><p class="source-code">        bill = dict(zip(codes, pricetag))</p><p class="source-code">        print("Running add_billing...")</p><p class="source-code">        return bill</p></li>
<li>The next <a id="_idIndexMarker624"/>functionality is the <strong class="source-inline">Tax</strong> class, where tax values are returned using the <strong class="source-inline">add_tax</strong> method in the class:<p class="source-code">class Tax:</p><p class="source-code">    def __init__(self, tax):</p><p class="source-code">        self.tax = tax</p><p class="source-code">    def add_tax(self):</p><p class="source-code">        taxed = []</p><p class="source-code">        for i in self.tax:</p><p class="source-code">            taxed.append(i)</p><p class="source-code">        print("Running add_tax...")</p><p class="source-code">        return taxed</p></li>
<li>The functionality after this is the <strong class="source-inline">FinalBill</strong> class, where we will be calculating the final bill using the <strong class="source-inline">calc_bill</strong> method:<p class="source-code">class FinalBill:</p><p class="source-code">    def __init__(self, billing, cart, tax):</p><p class="source-code">        self.billing = billing</p><p class="source-code">        self.cart = cart</p><p class="source-code">        self.tax = tax    </p><p class="source-code">    def calc_bill(self):</p><p class="source-code">        bill = self.billing.add_billing()</p><p class="source-code">        items = []</p><p class="source-code">        cart_items = self.cart.return_cart()</p><p class="source-code">        calc_bill = []</p><p class="source-code">        taxes = self.tax.add_tax()</p><p class="source-code">        for item,tax in zip(bill.items(),taxes):</p><p class="source-code">            items.append(item[1])</p><p class="source-code">            calc_bill.append(item[1] + item[1]*tax)</p><p class="source-code">        finalbill = dict(zip(cart_items, calc_bill))</p><p class="source-code">        print("Running calc_bill...")</p><p class="source-code">        return finalbill</p></li>
<li>The <a id="_idIndexMarker625"/>final functionality class in the facade pattern is the <strong class="source-inline">Invoice</strong> class, where we will be creating a <strong class="source-inline">print_invoice</strong> method to print the final invoice:<p class="source-code">class Invoice:</p><p class="source-code">    def __init__(self, finalbill, counter):</p><p class="source-code">        self.finalbill = finalbill</p><p class="source-code">        self.counter = counter</p><p class="source-code">    def print_invoice(self):</p><p class="source-code">        finalbill = self.finalbill.calc_bill()</p><p class="source-code">        final_total = sum(finalbill.values())</p><p class="source-code">        print("Running print_invoice...")</p><p class="source-code">        print('**************ABC </p><p class="source-code">               Megamart*****************')</p><p class="source-code">        print('***********------------------</p><p class="source-code">               **************')</p><p class="source-code">        print('Counter Name: ', </p><p class="source-code">               self.counter.goto_counter())</p><p class="source-code">        for item,price in finalbill.items():</p><p class="source-code">            print(item,": ", price)</p><p class="source-code">        print('Total:',final_total)</p><p class="source-code">        print('***********------------------</p><p class="source-code">               **************')</p><p class="source-code">        print('***************PAID********************</p><p class="source-code">               ****')</p></li>
<li>Now, let’s <a id="_idIndexMarker626"/>create the <strong class="source-inline">Facade</strong> class named <strong class="source-inline">Queue</strong>. It has two functions – the <strong class="source-inline">pipeline</strong> method to explicitly run some of the methods in the functionality classes, and the <strong class="source-inline">pipeline_implicit</strong> method to run the <strong class="source-inline">print_invoice</strong> method from the <strong class="source-inline">Invoice</strong> class, which will in turn call all other methods in the rest of the functionality classes:<p class="source-code">class Queue:</p><p class="source-code">    def __init__(self, items, name, scan, units, tax):</p><p class="source-code">        self.cart = Cart(items)</p><p class="source-code">        self.counter = Counter(name)</p><p class="source-code">        self.barcode = BarCode(scan)</p><p class="source-code">        self.billing = Billing(self.barcode, units)</p><p class="source-code">        self.tax = Tax(tax)</p><p class="source-code">        self.finalbill = FinalBill(self.billing, </p><p class="source-code">                         self.cart, self.tax)</p><p class="source-code">        self.invoice = Invoice(self.finalbill, </p><p class="source-code">                               self.counter)</p><p class="source-code">    def pipeline(self):</p><p class="source-code">        self.cart.return_cart()</p><p class="source-code">        self.counter.goto_counter()</p><p class="source-code">        self.barcode.scan_bar_code()</p><p class="source-code">        self.tax.add_tax()</p><p class="source-code">    def pipeline_implicit(self):</p><p class="source-code">        self.invoice.print_invoice()</p></li>
<li>Let’s create<a id="_idIndexMarker627"/> an end user function to run the methods in functionality classes using the <strong class="source-inline">Facade</strong> class by creating an instance for <strong class="source-inline">Queue</strong> and calling the <strong class="source-inline">pipeline</strong> method:<p class="source-code">def run_facade():</p><p class="source-code">    queue = Queue(items = ['paperclips','blue </p><p class="source-code">                    pens','stapler','pencils'],</p><p class="source-code">             name = ['Regular Counter'],</p><p class="source-code">             scan = [113323,3434332,2131243,2332783],</p><p class="source-code">             units = [10,15,12,14],</p><p class="source-code">             tax = [0.04,0.03,0.035,0.025],</p><p class="source-code">             )</p><p class="source-code">    queue.pipeline()</p></li>
<li>Now, let’s call the <strong class="source-inline">run_facade</strong> method to test the design pattern:<p class="source-code">run_facade()</p></li>
</ol>
<p>The output for the preceding test is as follows:</p>
<p class="source-code"><strong class="bold">Running return_cart...</strong></p>
<p class="source-code"><strong class="bold">Running goto_counter...</strong></p>
<p class="source-code"><strong class="bold">Running scan_bar_code...</strong></p>
<p class="source-code"><strong class="bold">Running add_tax...</strong></p>
<ol>
<li value="11">Finally, let’s create another end user function to run the methods in functionality classes using the <strong class="source-inline">Facade</strong> class by creating an instance for <strong class="source-inline">Queue</strong> and calling the <strong class="source-inline">pipeline_implicit</strong> method:<p class="source-code">def run_facade_implicit():</p><p class="source-code">    queue = Queue(items = ['paperclips','blue </p><p class="source-code">                     pens','stapler','pencils'],</p><p class="source-code">             name = ['Regular Counter'],</p><p class="source-code">             scan = [113323,3434332,2131243,2332783],</p><p class="source-code">             units = [10,15,12,14],</p><p class="source-code">             tax = [0.04,0.03,0.035,0.025],</p><p class="source-code">             )</p><p class="source-code">    queue.pipeline_implicit()</p></li>
<li>Then, let’s <a id="_idIndexMarker628"/>call the <strong class="source-inline">run_facade_implicit</strong> method to test the design pattern:<p class="source-code">run_facade_implicit()</p></li>
</ol>
<p>The output for the preceding test is as follows:</p>
<p class="source-code"><strong class="bold">Running scan_bar_code...</strong></p>
<p class="source-code"><strong class="bold">Running add_billing...</strong></p>
<p class="source-code"><strong class="bold">Running return_cart...</strong></p>
<p class="source-code"><strong class="bold">Running add_tax...</strong></p>
<p class="source-code"><strong class="bold">Running calc_bill...</strong></p>
<p class="source-code"><strong class="bold">Running print_invoice...</strong></p>
<p class="source-code"><strong class="bold">**************ABC Megamart*****************</strong></p>
<p class="source-code"><strong class="bold">***********------------------**************</strong></p>
<p class="source-code"><strong class="bold">Running goto_counter...</strong></p>
<p class="source-code"><strong class="bold">Counter Name:  ['Regular Counter']</strong></p>
<p class="source-code"><strong class="bold">paperclips :  10.4</strong></p>
<p class="source-code"><strong class="bold">blue pens :  15.45</strong></p>
<p class="source-code"><strong class="bold">stapler :</strong><strong class="bold">  12.42</strong></p>
<p class="source-code"><strong class="bold">pencils :  14.35</strong></p>
<p class="source-code"><strong class="bold">Total: 52.620000000000005</strong></p>
<p class="source-code"><strong class="bold">***********------------------**************</strong></p>
<p class="source-code"><strong class="bold">***************PAID************************</strong></p>
<p>Let’s connect<a id="_idIndexMarker629"/> the elements of this design pattern with their corresponding objects in the example in the following graphical representation:</p>
<div>
<div class="IMG---Figure" id="_idContainer130">
<img alt="Figure 13.2 – Facade pattern classes " height="859" src="image/Figure_13.2_B13426.jpg" width="737"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.2 – Facade pattern classes</p>
<p>So, the facade pattern has been implemented by creating a black box that provides the end users with an interface to access the functions of a complex system without worrying about the implementation details. Now, let’s look at the proxy pattern.</p>
<h2 id="_idParaDest-165"><a id="_idTextAnchor167"/>Understanding the proxy pattern</h2>
<p>In this section, we <a id="_idIndexMarker630"/>will look at the proxy design pattern. As the name implies, the proxy pattern is applied to create a proxy around the actual functionality so that the actual functionality is executed only when the proxy allows it based on certain preconditions. To explain this further and to implement this design pattern, our code<a id="_idIndexMarker631"/> needs the following elements:</p>
<ul>
<li><strong class="bold">Functionality class</strong>: The <a id="_idIndexMarker632"/>base functionalities of the system are designed in this class as methods.</li>
<li><strong class="bold">Proxy class</strong>: This<a id="_idIndexMarker633"/> is a proxy around the <strong class="source-inline">functionality</strong> class and it provides restrictions <a id="_idIndexMarker634"/>as to when to execute the base functionalities from the <strong class="source-inline">functionality</strong> class.</li>
</ul>
<p>In this example, let’s <a id="_idIndexMarker635"/>consider the NYC branch of <em class="italic">ABC Megamart</em> and create a class named <strong class="source-inline">NYC</strong>: </p>
<ol>
<li value="1">The <strong class="source-inline">NYC</strong> class is initialized with four empty dictionary parameters named <strong class="source-inline">manager</strong>, <strong class="source-inline">branch</strong>, <strong class="source-inline">product</strong>, and <strong class="source-inline">sales</strong>. Let’s also add three methods named <strong class="source-inline">set_parameters</strong> (to set the four dictionary parameters), <strong class="source-inline">get_parameters</strong> (to return the parameters), and <strong class="source-inline">calc_tax_nyc</strong> (to calculate the tax and return the parameters along with selling price data):<p class="source-code">class NYC:</p><p class="source-code">    def __init__(self):</p><p class="source-code">        self.manager = {}</p><p class="source-code">        self.branch = {}</p><p class="source-code">        self.product = {}</p><p class="source-code">        self.sales = {}        </p><p class="source-code">    def set_parameters(self, manager, branch, product,</p><p class="source-code">                       sales):</p><p class="source-code">        self.manager = manager</p><p class="source-code">        self.branch = branch</p><p class="source-code">        self.product = product</p><p class="source-code">        self.sales = sales        </p><p class="source-code">    def get_parameters(self):</p><p class="source-code">        return self.manager, self.branch, </p><p class="source-code">               self.product, self.sales    </p><p class="source-code">    def calc_tax_nyc(self):</p><p class="source-code">        branch = self.branch</p><p class="source-code">        manager = self.manager</p><p class="source-code">        product = self.product</p><p class="source-code">        sales = self.sales</p><p class="source-code">        pricebeforetax = sales['purchase_price'] + </p><p class="source-code">                         sales['purchase_price'] * </p><p class="source-code">                         sales['profit_margin']</p><p class="source-code">        finalselling_price = pricebeforetax + </p><p class="source-code">            (pricebeforetax * (sales['tax_rate'] + </p><p class="source-code">             sales['local_rate']))  </p><p class="source-code">        sales['selling_price'] = finalselling_price</p><p class="source-code">        return branch, manager, product, sales   </p></li>
<li>The <a id="_idIndexMarker636"/>next step of the implementation is to create a proxy <strong class="source-inline">ReturnBook</strong> class to call the methods from the <strong class="source-inline">NYC</strong> class to set parameters, get parameters, and calculate tax:<p class="source-code">class ReturnBook(NYC):</p><p class="source-code">    def __init__(self, nyc):</p><p class="source-code">        self.nyc = nyc</p><p class="source-code">    def add_book_details(self, state, manager, branch, </p><p class="source-code">                         product, sales):</p><p class="source-code">        if state in ['NY', 'NYC', 'New York']:</p><p class="source-code">            self.nyc.set_parameters(manager, branch, </p><p class="source-code">                                    product, sales)</p><p class="source-code">        else:</p><p class="source-code">            print("There is no branch in the state:", </p><p class="source-code">                  state)</p><p class="source-code">    def show_book_details(self, state):</p><p class="source-code">        if state in ['NY', 'NYC', 'New York']:</p><p class="source-code">            return self.nyc.get_parameters()</p><p class="source-code">        else:</p><p class="source-code">            print(state, "has no data")</p><p class="source-code">    def calc_tax(self, state):</p><p class="source-code">        if state in ['NY', 'NYC', 'New York']:</p><p class="source-code">            return self.nyc.calc_tax_nyc()</p><p class="source-code">        else:</p><p class="source-code">            print("The state", state, "is not </p><p class="source-code">                   supported") </p></li>
<li>Let’s now<a id="_idIndexMarker637"/> instantiate the proxy <strong class="source-inline">ReturnBook</strong> class and provide the <strong class="source-inline">NYC</strong> functionality class as the input parameter:<p class="source-code">branch_manhattan = ReturnBook(NYC())</p></li>
<li>To set the parameters from the <strong class="source-inline">NYC</strong> class, we will be calling the <strong class="source-inline">add_book_details</strong> method from the proxy class. The parameters will be set in the <strong class="source-inline">NYC</strong> class only if the conditions provided in <strong class="source-inline">add_book_details</strong> are successfully met by the input state parameter: <p class="source-code">branch_manhattan.add_book_details(state = 'NY', manager = {'regional_manager': 'John M',</p><p class="source-code">  'branch_manager': 'Tom H',</p><p class="source-code">  'sub_branch_id': '2021-01'},</p><p class="source-code">   branch = {'branchID': 2021,</p><p class="source-code">  'branch_street': '40097 5th Main Street',</p><p class="source-code">  'branch_borough': 'Manhattan',</p><p class="source-code">  'branch_city': 'New York City',</p><p class="source-code">  'branch_state': 'New York',</p><p class="source-code">  'branch_zip': 11007},</p><p class="source-code">   product = {'productId': 100002,</p><p class="source-code">  'product_name': 'WashingMachine',</p><p class="source-code">  'product_brand': 'Whirlpool'},</p><p class="source-code">   sales = {'purchase_price': 450,</p><p class="source-code">  'profit_margin': 0.19,</p><p class="source-code">  'tax_rate': 0.4,</p><p class="source-code">  'local_rate': 0.055})</p></li>
<li>Let’s further<a id="_idIndexMarker638"/> call the <strong class="source-inline">show_book_details</strong> method to get the parameters from the <strong class="source-inline">NYC</strong> class, provided that the state parameter in the input is <strong class="source-inline">NY</strong>, <strong class="source-inline">NYC</strong>, or <strong class="source-inline">New York</strong>:<p class="source-code">branch_manhattan.show_book_details('NY')</p></li>
</ol>
<p>The output of the preceding code is as follows:</p>
<p class="source-code"><strong class="bold">({'regional_manager': 'John M',</strong></p>
<p class="source-code"><strong class="bold">  'branch_manager': 'Tom H',</strong></p>
<p class="source-code"><strong class="bold">  'sub_branch_id': '2021-01'},</strong></p>
<p class="source-code"><strong class="bold"> {'branchID': 2021,</strong></p>
<p class="source-code"><strong class="bold">  'branch_street': '40097 5th Main Street',</strong></p>
<p class="source-code"><strong class="bold">  'branch_borough': 'Manhattan',</strong></p>
<p class="source-code"><strong class="bold">  'branch_city': 'New York City',</strong></p>
<p class="source-code"><strong class="bold">  'branch_state': 'New York',</strong></p>
<p class="source-code"><strong class="bold">  'branch_zip': 11007},</strong></p>
<p class="source-code"><strong class="bold"> {'productId': 100002,</strong></p>
<p class="source-code"><strong class="bold">  'product_name': 'WashingMachine',</strong></p>
<p class="source-code"><strong class="bold">  'product_brand': 'Whirlpool'},</strong></p>
<p class="source-code"><strong class="bold"> {'purchase_price': 450,</strong></p>
<p class="source-code"><strong class="bold">  'profit_margin': 0.19,</strong></p>
<p class="source-code"><strong class="bold">  'tax_rate': 0.4,</strong></p>
<p class="source-code"><strong class="bold">  'local_rate': 0.055})</strong></p>
<ol>
<li value="6">Let’s further<a id="_idIndexMarker639"/> call the <strong class="source-inline">calc_tax</strong> method from the proxy class to calculate the selling price, provided the state parameters are successful:<p class="source-code">branch_manhattan.calc_tax('NY')</p></li>
<li>Let’s test the restrictions in the proxy methods by providing incorrect input to the state parameter:<p class="source-code">branch_manhattan.add_book_details(state = 'LA', manager = {'regional_manager': 'John M',</p><p class="source-code">  'branch_manager': 'Tom H',</p><p class="source-code">  'sub_branch_id': '2021-01'},</p><p class="source-code">   branch = {'branchID': 2021,</p><p class="source-code">  'branch_street': '40097 5th Main Street',</p><p class="source-code">  'branch_borough': 'Manhattan',</p><p class="source-code">  'branch_city': 'New York City',</p><p class="source-code">  'branch_state': 'New York',</p><p class="source-code">  'branch_zip': 11007},</p><p class="source-code">   product = {'productId': 100002,</p><p class="source-code">  'product_name': 'WashingMachine',</p><p class="source-code">  'product_brand': 'Whirlpool'},</p><p class="source-code">   sales = {'purchase_price': 450,</p><p class="source-code">  'profit_margin': 0.19,</p><p class="source-code">  'tax_rate': 0.4,</p><p class="source-code">  'local_rate': 0.055})</p></li>
</ol>
<p>The output of the preceding code is as follows:</p>
<p class="source-code"><strong class="bold">There is no branch in the state: LA</strong></p>
<ol>
<li value="8">Similarly, let’s<a id="_idIndexMarker640"/> also test the <strong class="source-inline">show_book_details</strong> method:<p class="source-code">branch_manhattan.show_book_details('LA')</p></li>
</ol>
<p>The output of the preceding code is as follows:</p>
<p class="source-code"><strong class="bold">LA has no data</strong></p>
<ol>
<li value="9">Finally, let’s test the <strong class="source-inline">calc_tax</strong> method from the proxy:<p class="source-code">branch_manhattan.calc_tax('LA')</p></li>
</ol>
<p>The output is as follows:</p>
<p class="source-code"><strong class="bold">The state LA is not supported</strong></p>
<p>Let’s connect the elements of this design pattern with their corresponding objects in the example in the following graphical representation:</p>
<div>
<div class="IMG---Figure" id="_idContainer131">
<img alt="Figure 13.3 – Proxy design pattern classes " height="775" src="image/Figure_13.3_B13426.jpg" width="862"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.3 – Proxy design pattern classes</p>
<p>So, the <a id="_idIndexMarker641"/>proxy pattern has been implemented by creating a proxy class that adds the required conditions to execute the actual functionalities. Next, we’re moving on to exploring the creational design patterns.</p>
<h1 id="_idParaDest-166"><a id="_idTextAnchor168"/>Exploring creational design patterns</h1>
<p>Creational design patterns are<a id="_idIndexMarker642"/> various methods to add abstraction in the process of object creation. In <a id="_idIndexMarker643"/>this section, we will be looking at three such design patterns, namely the factory method, prototype pattern, and singleton pattern.</p>
<h2 id="_idParaDest-167"><a id="_idTextAnchor169"/>Understanding the factory method</h2>
<p>The<a id="_idIndexMarker644"/> factory design pattern is<a id="_idIndexMarker645"/> a method of abstraction where a factory class is created to create an object for the class from the factory class instead of directly instantiating the object. To explain this further and to implement this design pattern, our code needs the<a id="_idIndexMarker646"/> following elements:</p>
<ul>
<li><strong class="bold">Abstract class</strong>: The<a id="_idIndexMarker647"/> abstract class with the abstract methods for functionalities to be defined in the subclasses.</li>
<li><strong class="bold">Abstraction subclasses</strong>: The <a id="_idIndexMarker648"/>subclasses are inherited from the abstract class and overwrite the abstract methods.</li>
<li><strong class="bold">Factory class</strong>: The class <a id="_idIndexMarker649"/>to create objects for the abstraction subclasses.</li>
<li><strong class="bold">End user method</strong>: The <a id="_idIndexMarker650"/>class or method to test or call the factory method.</li>
</ul>
<p>For this example, let’s implement<a id="_idIndexMarker651"/> using another scenario from <em class="italic">ABC Megamart</em>:</p>
<ol>
<li value="1">Let’s create an abstract class with two methods, <strong class="source-inline">buy_product</strong> and <strong class="source-inline">maintenance_cost</strong>:<p class="source-code">from abc import abstractmethod</p><p class="source-code">class Branch:</p><p class="source-code">    @abstractmethod</p><p class="source-code">    def buy_product(self):</p><p class="source-code">        pass</p><p class="source-code">    @abstractmethod</p><p class="source-code">    def maintenance_cost(self):</p><p class="source-code">        pass</p></li>
<li>Now, let’s create a subclass for the <strong class="source-inline">Branch</strong> class named <strong class="source-inline">Brooklyn</strong> and implement the <strong class="source-inline">buy_product</strong> and <strong class="source-inline">maintenance_cost</strong> methods:<p class="source-code">class Brooklyn(Branch):</p><p class="source-code">    def __init__(self,product,unit_price,quantity,</p><p class="source-code">                 product_type):</p><p class="source-code">        self.product = product</p><p class="source-code">        self.unit_price = unit_price</p><p class="source-code">        self.quantity = quantity</p><p class="source-code">        self.product_type = product_type        </p><p class="source-code">    def buy_product(self):</p><p class="source-code">        if (self.product_type == 'FMCG'):</p><p class="source-code">            self.statetax_rate = 0.035</p><p class="source-code">            self.promotiontype = 'Discount'</p><p class="source-code">            self.discount = 0.10</p><p class="source-code">            self.initialprice = </p><p class="source-code">                self.unit_price*self.quantity </p><p class="source-code">            self.salesprice = self.initialprice + </p><p class="source-code">                self.initialprice*self.statetax_rate</p><p class="source-code">            self.finalprice = self.salesprice * </p><p class="source-code">                (1-self.discount)</p><p class="source-code">            return self.salesprice, </p><p class="source-code">                self.product,self.promotiontype</p><p class="source-code">        else:</p><p class="source-code">            return "We don't stock this product"</p><p class="source-code">     def maintenance_cost(self):</p><p class="source-code">        self.coldstorageCost = 100</p><p class="source-code">        if (self.product_type == 'FMCG'):</p><p class="source-code">            self.maintenance_cost = self.quantity * </p><p class="source-code">                0.25 + self.coldstorageCost    </p><p class="source-code">            return self.maintenance_cost</p><p class="source-code">        else:</p><p class="source-code">            return "We don't stock this product"</p></li>
<li>Similarly, let’s create <a id="_idIndexMarker652"/>another subclass, named <strong class="source-inline">Manhattan</strong>, which inherits the <strong class="source-inline">Branch</strong> class, as follows:<p class="source-code">class Manhattan(Branch):</p><p class="source-code">    def __init__(self,product,unit_price,quantity,</p><p class="source-code">                 product_type):</p><p class="source-code">        self.product = product</p><p class="source-code">        self.unit_price = unit_price</p><p class="source-code">        self.quantity = quantity</p><p class="source-code">        self.product_type = product_type</p></li>
<li>Let’s further define a method named <strong class="source-inline">buy_product</strong> to return the product price, product name, and promotion in cases where the product is electronic:<p class="source-code">    def buy_product(self):</p><p class="source-code">        if (self.product_type == 'Electronics'):</p><p class="source-code">            self.statetax_rate = 0.05        </p><p class="source-code">            self.promotiontype = 'Buy 1 Get 1'</p><p class="source-code">            self.discount = 0.50</p><p class="source-code">            self.initialprice = </p><p class="source-code">                self.unit_price*self.quantity </p><p class="source-code">            self.salesprice = self.initialprice + </p><p class="source-code">                self.initialprice*self.statetax_rate</p><p class="source-code">            self.finalprice = self.salesprice * </p><p class="source-code">                (1-self.discount)</p><p class="source-code">            return self.finalprice, </p><p class="source-code">                self.product,self.promotiontype</p><p class="source-code">        else:</p><p class="source-code">            return "We don't stock this product"</p></li>
<li>Let’s now <a id="_idIndexMarker653"/>define another method to calculate the maintenance cost:<p class="source-code">    def maintenance_cost(self):</p><p class="source-code">        if (self.product_type == 'Electronics'):</p><p class="source-code">          self.maintenance_cost = self.quantity * 0.05</p><p class="source-code">            return self.maintenance_cost</p><p class="source-code">        else:</p><p class="source-code">            return "We don't stock this product"</p></li>
<li>In the next step, let’s create a factory class named <strong class="source-inline">BranchFactory</strong>, which creates the instance for the branch subclasses, <strong class="source-inline">Brooklyn</strong> or <strong class="source-inline">Manhattan</strong>:<p class="source-code">Class BranchFactory:</p><p class="source-code">    def create_branch(self,branch,product,unit_price,</p><p class="source-code">                      quantity,product_type):</p><p class="source-code">        if str.upper(branch) == 'BROOKLYN':</p><p class="source-code">            return Brooklyn(product,unit_price,</p><p class="source-code">                            quantity,product_type)</p><p class="source-code">        </p><p class="source-code">        elif str.upper(branch) == 'MANHATTAN':</p><p class="source-code">            return Manhattan(product,unit_price,</p><p class="source-code">                             quantity,product_type)</p></li>
<li>Now, let’s test the factory method by creating a function named <strong class="source-inline">test_factory</strong>:<p class="source-code">def test_factory(branch,product,unit_price,quantity,product_type):</p><p class="source-code">    branchfactory = BranchFactory()</p><p class="source-code">    branchobject = branchfactory.create_branch(branch,</p><p class="source-code">            product,unit_price,quantity,product_type) </p><p class="source-code">    print(branchobject)</p><p class="source-code">    print(branchobject.buy_product())</p><p class="source-code">    print(branchobject.maintenance_cost())</p></li>
<li>Let’s<a id="_idIndexMarker654"/> now call the <strong class="source-inline">test_factory</strong> function with inputs as <strong class="source-inline">Brooklyn</strong>, <strong class="source-inline">Milk</strong>, <strong class="source-inline">10.5</strong>, and <strong class="source-inline">FMCG</strong> as follows:<p class="source-code">test_factory('Brooklyn','Milk', 10,5,'FMCG')</p></li>
</ol>
<p>The output for the preceding code is as follows:</p>
<p class="source-code"><strong class="bold">&lt;__main__.Brooklyn object at 0x000002101D4569A0&gt;</strong></p>
<p class="source-code"><strong class="bold">(51.75, 'Milk', 'Discount')</strong></p>
<p class="source-code"><strong class="bold">101.25</strong></p>
<ol>
<li value="9">Now, call the <strong class="source-inline">test_factory</strong> function with inputs as <strong class="source-inline">manhattan</strong>, <strong class="source-inline">iPhone</strong>, <strong class="source-inline">1000</strong>, <strong class="source-inline">1</strong>, and <strong class="source-inline">Electronics</strong> as follows:<p class="source-code">test_factory('manhattan','iPhone', 1000,1,'Electronics')</p></li>
</ol>
<p>The output for the preceding code is as follows:</p>
<p class="source-code"><strong class="bold">&lt;__main__.Manhattan object at 0x000002101D456310&gt;</strong></p>
<p class="source-code"><strong class="bold">(525.0, 'iPhone', 'Buy 1 Get 1')</strong></p>
<p class="source-code"><strong class="bold">0.05</strong></p>
<p>Let’s connect the elements of this design pattern with their corresponding objects in the example with the following graphical representation:</p>
<div>
<div class="IMG---Figure" id="_idContainer132">
<img alt="Figure 13.4 – Factory pattern classes " height="546" src="image/Figure_13.4_B13426.jpg" width="1377"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 13.4 – Factory pattern classes</p>
<p>So, the<a id="_idIndexMarker655"/> factory pattern has been implemented by creating a factory class that instantiates the <strong class="source-inline">Abstraction</strong> subclasses. With this implementation, we have learned about the creational design pattern with an example.</p>
<h2 id="_idParaDest-168"><a id="_idTextAnchor170"/>Understanding the prototype method</h2>
<p>The <a id="_idIndexMarker656"/>prototype design pattern is also used to <a id="_idIndexMarker657"/>implement abstraction during the creation of a Python object. A prototype can be used by the end user to create a copy of an object of a class without the overhead of understanding the detailed implementation behind it. To explain this further and to implement this design pattern, our code needs the<a id="_idIndexMarker658"/> following elements:</p>
<ul>
<li><strong class="bold">Prototype class</strong>: This <a id="_idIndexMarker659"/>class has a method to clone or copy another Python object that has the implementation.</li>
<li><strong class="bold">Implementation class</strong>: This <a id="_idIndexMarker660"/>class has the<a id="_idIndexMarker661"/> actual implementation of the functionalities as attributes and methods.</li>
</ul>
<p>For this example, let’s<a id="_idIndexMarker662"/> implement using another scenario from <em class="italic">ABC Megamart</em>:</p>
<ol>
<li value="1">Let’s create a class named <strong class="source-inline">Prototype</strong> and define a method named <strong class="source-inline">clone</strong> to copy the Python object provided as input to the method:<p class="source-code">class Prototype:</p><p class="source-code">    def __init__(self):</p><p class="source-code">        self.cp = __import__('copy')</p><p class="source-code">                </p><p class="source-code">    def clone(self, objname):</p><p class="source-code">        return self.cp.deepcopy(objname)</p></li>
<li>Let’s now create an implementation class named <strong class="source-inline">FMCG</strong> and initialize a set of variables pertaining to the supplier details, and add a method to get the supplier details:<p class="source-code">class FMCG:</p><p class="source-code">    def __init__(self,supplier_name,supplier_code,</p><p class="source-code">    supplier_address,supplier_contract_start_date,\</p><p class="source-code">    supplier_contract_end_date,supplier_quality_code):</p><p class="source-code">        self.supplier_name = supplier_name</p><p class="source-code">        self.supplier_code = supplier_code</p><p class="source-code">        self.supplier_address = supplier_address</p><p class="source-code">        self.supplier_contract_start_date = </p><p class="source-code">             supplier_contract_start_date</p><p class="source-code">        self.supplier_contract_end_date = </p><p class="source-code">             supplier_contract_end_date</p><p class="source-code">        self.supplier_quality_code = </p><p class="source-code">             supplier_quality_code</p><p class="source-code">        </p><p class="source-code">    def get_supplier_details(self):</p><p class="source-code">        supplierDetails = {</p><p class="source-code">           'Supplier_name': self.supplier_name, </p><p class="source-code">            'Supplier_code': self.supplier_code,</p><p class="source-code">            'Supplier_address': self.supplier_address,</p><p class="source-code">            'ContractStartDate': </p><p class="source-code">                 self.supplier_contract_start_date,</p><p class="source-code">            'ContractEndDate': </p><p class="source-code">                 self.supplier_contract_end_date, </p><p class="source-code">            'QualityCode': self.supplier_quality_code</p><p class="source-code">        }</p><p class="source-code">        return supplierDetails</p></li>
<li>In the<a id="_idIndexMarker663"/> next step, let’s create an object named <strong class="source-inline">fmcg_supplier</strong> for the <strong class="source-inline">FMCG</strong> class:<p class="source-code">fmcg_supplier = FMCG('Test Supplier','a0015','5093 9th Main Street, Pasadena,California, 91001', '05/04/2020', '05/04/2025',1)</p></li>
<li>Let’s also create an object for the <strong class="source-inline">Prototype</strong> class, named <strong class="source-inline">proto</strong>:<p class="source-code">proto = Prototype()</p></li>
<li>Now, we can directly clone the <strong class="source-inline">fmcg_supplier</strong> object without passing all the attributes of the <strong class="source-inline">FMCG</strong> class as input. To do this, we will make use of the <strong class="source-inline">clone</strong> method from the <strong class="source-inline">Prototype</strong> class:<p class="source-code">fmcg_supplier_reuse = proto.clone(fmcg_supplier)</p></li>
<li>The <strong class="source-inline">fmcg_supplier_reuse</strong> object is a clone of the <strong class="source-inline">fmcg_supplier</strong> object<a id="_idIndexMarker664"/> and it is not the same object itself. This can be verified by looking at the ID of both of these objects:<p class="source-code">id(fmcg_supplier)</p></li>
</ol>
<p>The output is as follows:</p>
<p class="source-code"><strong class="bold">2268233820528</strong></p>
<ol>
<li value="7">Similarly, we can also look at the ID of the cloned object:<p class="source-code">id(fmcg_supplier_reuse)</p></li>
</ol>
<p>The output is as follows:</p>
<p class="source-code"><strong class="bold">2268233819616</strong></p>
<ol>
<li value="8">Let’s also verify that the cloned object can be modified without impacting the actual object:<p class="source-code">fmcg_supplier_reuse.supplier_name = 'ABC Supplier'</p><p class="source-code">fmcg_supplier_reuse.get_supplier_details()</p></li>
</ol>
<p>The output is as follows:</p>
<p class="source-code"><strong class="bold">{'Supplier_name': 'ABC Supplier',</strong></p>
<p class="source-code"><strong class="bold"> 'Supplier_code': 'a0015',</strong></p>
<p class="source-code"><strong class="bold"> 'Supplier_address': '5093 9th Main Street, Pasadena,California, 91001',</strong></p>
<p class="source-code"><strong class="bold"> 'ContractStartDate': '05/04/2020',</strong></p>
<p class="source-code"><strong class="bold"> 'ContractEndDate': '05/04/2025',</strong></p>
<p class="source-code"><strong class="bold"> 'QualityCode': 1}</strong></p>
<ol>
<li value="9">In the preceding output, we have modified the cloned object and this should not impact <a id="_idIndexMarker665"/>the original object. Let’s verify the original object:<p class="source-code">fmcg_supplier.get_supplier_details()</p></li>
</ol>
<p>The output is as follows:</p>
<p class="source-code"><strong class="bold">{'Supplier_name': 'Test Supplier',</strong></p>
<p class="source-code"><strong class="bold"> 'Supplier_code': 'a0015',</strong></p>
<p class="source-code"><strong class="bold"> 'Supplier_address': '5093 9th Main Street, Pasadena,California, 91001',</strong></p>
<p class="source-code"><strong class="bold"> 'ContractStartDate': '05/04/2020',</strong></p>
<p class="source-code"><strong class="bold"> 'ContractEndDate': '05/04/2025',</strong></p>
<p class="source-code"><strong class="bold"> 'QualityCode': 1}</strong></p>
<p>So, the prototype pattern has been implemented by creating a <strong class="source-inline">Prototype</strong> class that copies the object of the implementation class. Now that you’ve understood this, let’s look at the singleton design pattern.</p>
<h2 id="_idParaDest-169"><a id="_idTextAnchor171"/>Understanding the singleton pattern</h2>
<p>As the name <a id="_idIndexMarker666"/>suggests, the singleton<a id="_idIndexMarker667"/> pattern is a design pattern where we can limit the number of class instances created for a class while initializing the class itself. To explain this further and implement this design pattern, we need to develop the elements of <a id="_idIndexMarker668"/>the <strong class="bold">singleton class</strong> in our code. </p>
<p>Unlike the other<a id="_idIndexMarker669"/> patterns, this pattern has only one element – the singleton class. A singleton class will have a constraint set within its <strong class="source-inline">init</strong> method to limit the number of instances to one.</p>
<p>For this example, let’s<a id="_idIndexMarker670"/> implement using another scenario from <em class="italic">ABC Megamart</em>:</p>
<ol>
<li value="1">Let’s define a class named <strong class="source-inline">SingletonBilling</strong>. This class will have the attributes required to generate a bill for a product: <p class="source-code">class SingletonBilling:</p><p class="source-code">    billing_instance = None</p><p class="source-code">    product_name = 'Dark Chocolate'</p><p class="source-code">    unit_price = 6</p><p class="source-code">    quantity = 4</p><p class="source-code">    tax = 0.054</p></li>
<li>Let’s add a <a id="_idIndexMarker671"/>constraint in the <strong class="source-inline">init</strong> method of this class to limit the number of class instances to one:<p class="source-code">    def __init__(self):</p><p class="source-code">        if SingletonBilling.billing_instance == None:</p><p class="source-code">            SingletonBilling.billing_instance = self</p><p class="source-code">        else:</p><p class="source-code">            print("Billing can have only one </p><p class="source-code">                   instance")</p></li>
<li>In the next step, let’s also add a <strong class="source-inline">generate_bill</strong> method to perform the function of generating a bill for a product based on the class attributes:<p class="source-code">    def generate_bill(self):</p><p class="source-code">        total = self.unit_price * self.quantity </p><p class="source-code">        final_total = total + total*self.tax</p><p class="source-code">        print('***********------------------</p><p class="source-code">               **************')</p><p class="source-code">        print('Product:', self.product_name)</p><p class="source-code">        print('Total:',final_total)</p><p class="source-code">        print('***********------------------</p><p class="source-code">               **************')</p></li>
<li>In the<a id="_idIndexMarker672"/> next step, we can instantiate the class object for the first time and call its <strong class="source-inline">generate_bill</strong> method:<p class="source-code">invoice1 = SingletonBilling()</p><p class="source-code">invoice1.generate_bill()</p></li>
</ol>
<p>The output is displayed as follows:</p>
<p class="source-code"><strong class="bold">***********------------------**************</strong></p>
<p class="source-code"><strong class="bold">Product: Dark Chocolate</strong></p>
<p class="source-code"><strong class="bold">Total: 25.296</strong></p>
<p class="source-code"><strong class="bold">***********------------------**************</strong></p>
<ol>
<li value="5">Let’s now test the singleton pattern by instantiating one more instance for the class:<p class="source-code">invoice2 = SingletonBilling()</p></li>
</ol>
<p>The second instance could not be created for the class due to its singleton property. The output is as expected:</p>
<p class="source-code"><strong class="bold">Billing can have only one instance</strong></p>
<p>So, the singleton pattern has been implemented by restricting the singleton class from creating more than one instance. With this example, we have covered three types of creational design patterns and their implementation.</p>
<h1 id="_idParaDest-170"><a id="_idTextAnchor172"/>Summary</h1>
<p>In this chapter, we have learned about the concept of structural and creational design patterns by applying some of these design patterns in Python 3. We implemented the bridge design pattern and understood each of its elements. We understood the facade design pattern and its various elements. We also implemented the proxy design pattern with an example. We also covered creational design patterns such as the factory method, prototype, and singleton patterns with their corresponding examples.</p>
<p>Similar to other chapters covered in this book, this chapter, which explains the second part of design patterns, also focused on metaprogramming and its impact on Python code.</p>
<p>In the next chapter, we will continue the code generation with some examples.</p>
</div>
</div></body></html>