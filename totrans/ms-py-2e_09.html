<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer174" class="Basic-Text-Frame">&#13;
    <h1 class="chapterNumber">9</h1>&#13;
    <h1 id="_idParaDest-221" class="chapterTitle">Documentation – How to Use Sphinx and reStructuredText</h1>&#13;
    <p class="normal">Documenting code can be both fun and useful! I will admit that many programmers have a strong dislike for documenting code and understandably so. Writing documentation can be a boring job and, traditionally, only others reap the benefits of that effort. The tools available for Python, however, make it almost trivial to generate useful and up-to-date documentation with little to no effort at all. Generating documentation has actually become so easy that I often create and generate documentation before using a Python package. Assuming it wasn’t available already, that is.</p>&#13;
    <p class="normal">In addition to simple text documentation explaining what a function does, it is also possible to add metadata, such as type hints. These type hints can be used to make the arguments and return types of a function or class clickable in the documentation. But more importantly, many modern IDEs and editors, such as VIM, have plugins available that parse the type hints and use them for intelligent autocompletion. So if you type <code class="inlineCode">'some_string.'</code>, your editor will automatically complete the specific attributes and methods of a string object, something that is traditionally only viable with statically typed languages such as Java, C, and C++.</p>&#13;
    <p class="normal">This chapter will explain the types of documentation available in Python and how easily a full set of documentation can be created. With the amazing tools that Python provides, you can have fully functioning documentation within minutes.</p>&#13;
    <p class="normal">The topics covered in this chapter are as follows:</p>&#13;
    <ul>&#13;
      <li class="bulletList">Type hinting</li>&#13;
      <li class="bulletList">The reStructuredText syntax</li>&#13;
      <li class="bulletList">The Markdown syntax</li>&#13;
      <li class="bulletList">Setting up documentation using Sphinx</li>&#13;
      <li class="bulletList">Sphinx-, Google-, and NumPy-style docstrings</li>&#13;
    </ul>&#13;
    <h1 id="_idParaDest-222" class="heading-1">Type hinting</h1>&#13;
    <p class="normal">Since Python 3.5, we’ve <a id="_idIndexMarker598"/>had a feature called type hinting, which is arguably one of the most useful additions to Python 3. It allows you to specify the types of variables and return values, which means your editor will be able to give you smart autocompletion. This makes it useful for all Python programmers, regardless of level, and can make your life much easier when paired with a good editor.</p>&#13;
    <h2 id="_idParaDest-223" class="heading-2">Basic example</h2>&#13;
    <p class="normal">Most editors are <a id="_idIndexMarker599"/>already smart enough to recognize basic types in regular variables such as these:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">&gt;&gt;&gt;</span> a = <span class="hljs-con-number">123</span>&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> b = <span class="hljs-con-string">'test'</span>&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> c = <span class="hljs-con-literal">True</span>&#13;
</code></pre>&#13;
    <p class="normal">It becomes a lot harder for an editor when, instead of <code class="inlineCode">a = 123</code>, we have something like <code class="inlineCode">a = some_function()</code>. In some cases, the return type of a function is obvious (i.e. <code class="inlineCode">return True</code>), but if the return type depends on the input variables or is not consistent, it becomes much harder for the editor to understand what is happening.</p>&#13;
    <p class="normal">As the Zen of Python tells us, explicit is better than implicit. In the case of function return types, this is often the case and can be implemented with very little effort:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">def</span><span class="hljs-con-function"> </span><span class="hljs-con-title">pow</span><span class="hljs-con-function">(</span><span class="hljs-con-params">base: </span><span class="hljs-con-built_in">int</span><span class="hljs-con-params">, exponent: </span><span class="hljs-con-built_in">int</span><span class="hljs-con-function">) -&gt; int:</span>&#13;
<span class="hljs-con-meta">...</span>     <span class="hljs-con-keyword">return</span> base ** exponent&#13;
&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-built_in">help</span>(<span class="hljs-con-built_in">pow</span>)&#13;
Help on function pow in module __main__:&#13;
&lt;BLANKLINE&gt;&#13;
pow(base: int, exponent: int) -&gt; int&#13;
&lt;BLANKLINE&gt;&#13;
&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-built_in">pow</span>.__annotations__&#13;
{'base': &lt;class 'int'&gt;,&#13;
 'exponent': &lt;class 'int'&gt;,&#13;
 'return': &lt;class 'int'&gt;}&#13;
&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-built_in">pow</span>(<span class="hljs-con-number">2</span>, <span class="hljs-con-number">10</span>)&#13;
1024&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-built_in">pow</span>(<span class="hljs-con-built_in">pow</span>(<span class="hljs-con-number">9</span>, <span class="hljs-con-number">2</span>) + <span class="hljs-con-built_in">pow</span>(<span class="hljs-con-number">19</span>, <span class="hljs-con-number">2</span>) / <span class="hljs-con-number">22</span>, <span class="hljs-con-number">0.25</span>)&#13;
3.1415926525826463&#13;
</code></pre>&#13;
    <p class="normal">That works as expected. With a simple <code class="inlineCode">-&gt; type</code>, you can specify the function return type, which is automatically reflected in the <code class="inlineCode">__annotations__</code>, which is also visible in the <code class="inlineCode">help()</code>. And the arguments (and variables) can be type-specified using <code class="inlineCode">name: type</code>. </p>&#13;
    <p class="normal">In this case, you may notice that even though we specified the function to return an <code class="inlineCode">int</code>, it can actually return<a id="_idIndexMarker600"/> a <code class="inlineCode">float</code> as well, since Python only has type hints, not type constraints/enforcements.</p>&#13;
    <p class="normal">While basic types such as <code class="inlineCode">int</code>, <code class="inlineCode">float</code>, <code class="inlineCode">str</code>, <code class="inlineCode">dict</code>, <code class="inlineCode">list</code>, and <code class="inlineCode">set</code> can be specified with <code class="inlineCode">variable: int</code> alone, for more advanced types, we need the <code class="inlineCode">typing</code> module.</p>&#13;
    <div class="packt_tip">&#13;
      <p class="normal">Since Python 3.9, you can use <code class="inlineCode">variable: list[int]</code>. For older versions of Python, you need to use <code class="inlineCode">variable: typing.List[int]</code> for all collection types such as <code class="inlineCode">dict</code>/<code class="inlineCode">list</code>/<code class="inlineCode">set</code> that require the getitem (<code class="inlineCode">[]</code>) operator.</p>&#13;
    </div>&#13;
    <p class="normal">The <code class="inlineCode">typing</code> module contains types such as <code class="inlineCode">typing.Any</code> to allow everything, <code class="inlineCode">typing.Optional</code> to allow for <code class="inlineCode">None</code>, and <code class="inlineCode">typing.Union</code> to specify multiple allowed types, which we will now demonstrate:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">import</span> typing&#13;
&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> int_or_float = typing.Union[<span class="hljs-con-built_in">int</span>, <span class="hljs-con-built_in">float</span>]&#13;
&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">def</span><span class="hljs-con-function"> </span><span class="hljs-con-title">pow</span><span class="hljs-con-function">(</span><span class="hljs-con-params">base: </span><span class="hljs-con-built_in">int</span><span class="hljs-con-params">, exponent: </span><span class="hljs-con-built_in">int</span><span class="hljs-con-function">) -&gt; int_or_float:</span>&#13;
<span class="hljs-con-meta">...</span>     <span class="hljs-con-keyword">return</span> base ** exponent&#13;
&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-built_in">help</span>(<span class="hljs-con-built_in">pow</span>)&#13;
Help on function pow in module __main__:&#13;
&lt;BLANKLINE&gt;&#13;
pow(base: int, exponent: int) -&gt; Union[int, float]&#13;
&lt;BLANKLINE&gt;&#13;
</code></pre>&#13;
    <p class="normal">With <code class="inlineCode">typing.Union</code>, we can specify a list of types that apply. Similarly, an optional type can be specified using <code class="inlineCode">typing.Optional[int]</code> to indicate that the type can be either <code class="inlineCode">int</code> or <code class="inlineCode">None</code>, effectively being <a id="_idIndexMarker601"/>equivalent to <code class="inlineCode">typing.Union[int, None]</code>. Additionally, since Python 3.10 we can write this as <code class="inlineCode">int</code> <code class="inlineCode">|</code> <code class="inlineCode">None</code>.</p>&#13;
    <h2 id="_idParaDest-224" class="heading-2">Custom types</h2>&#13;
    <p class="normal">Since regular Python <a id="_idIndexMarker602"/>objects are their own type, you usually don’t even have to think about what type they are. Simply specify the object and it will work:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">class</span><span class="hljs-con-class"> </span><span class="hljs-con-title">Sandwich</span><span class="hljs-con-class">:</span>&#13;
<span class="hljs-con-meta">...</span>     <span class="hljs-con-keyword">pass</span>&#13;
&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">def</span><span class="hljs-con-function"> </span><span class="hljs-con-title">get_sandwich</span><span class="hljs-con-function">() -&gt; Sandwich:</span>&#13;
<span class="hljs-con-meta">...</span>     <span class="hljs-con-keyword">return</span> Sandwich()&#13;
</code></pre>&#13;
    <p class="normal">But what would happen with circular definitions or other circumstances where you do not have the type available yet? In that case, you can work around the issue by specifying the type as a string:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">class</span><span class="hljs-con-class"> </span><span class="hljs-con-title">A</span><span class="hljs-con-class">:</span>&#13;
<span class="hljs-con-meta">...</span> <span class="hljs-con-meta">    @staticmethod</span>&#13;
<span class="hljs-con-meta">...</span>     <span class="hljs-con-keyword">def</span><span class="hljs-con-function"> </span><span class="hljs-con-title">get_b</span><span class="hljs-con-function">() -&gt; 'B':</span>&#13;
<span class="hljs-con-meta">...</span>         <span class="hljs-con-keyword">return</span> B()&#13;
&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">class</span><span class="hljs-con-class"> </span><span class="hljs-con-title">B</span><span class="hljs-con-class">:</span>&#13;
<span class="hljs-con-meta">...</span> <span class="hljs-con-meta">    @staticmethod</span>&#13;
<span class="hljs-con-meta">...</span>     <span class="hljs-con-keyword">def</span><span class="hljs-con-function"> </span><span class="hljs-con-title">get_a</span><span class="hljs-con-function">() -&gt; A:</span>&#13;
<span class="hljs-con-meta">...</span>         <span class="hljs-con-keyword">return</span> A()&#13;
</code></pre>&#13;
    <p class="normal">Whenever possible, I would recommend against this method because it gives you no guarantee that the type can actually be resolved:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-comment"># Works without an issue</span>&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> some_variable: <span class="hljs-con-string">'some_non_existing_type'</span>&#13;
&#13;
<span class="hljs-con-comment"># Error as expected</span>&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> some_variable: some_non_existing_type&#13;
Traceback (most recent call last):&#13;
    ...&#13;
NameError: name 'some_non_existing_type' is not defined&#13;
</code></pre>&#13;
    <p class="normal">Naturally, this will only check whether the type actually exists. For proper type checking, we can use tools such as <code class="inlineCode">mypy</code>, which will be covered in the next section. To make sure that your type checker can resolve the type, you can encase your imports in an <code class="inlineCode">if typing.TYPE_CHECKING</code> block like so:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">if</span> typing.TYPE_CHECKING:&#13;
<span class="hljs-con-meta">...</span>     <span class="hljs-con-comment"># Add your import for some_non_existing_type here</span>&#13;
<span class="hljs-con-meta">...</span>     ...&#13;
</code></pre>&#13;
    <p class="normal">The <code class="inlineCode">typing.TYPE_CHECKING</code> constant is not normally set, but can be set by type checkers such as <code class="inlineCode">mypy</code> to make sure all types are working correctly.</p>&#13;
    <p class="normal">In the examples <a id="_idIndexMarker603"/>above, we have seen custom classes as custom types, but what if we want to create a custom type out of an existing built-in type? That is also possible using <code class="inlineCode">typing.NewType</code>, which creates a new type that behaves like the base type, but can be checked by static type checkers:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">import</span> typing&#13;
&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> Username = typing.NewType(<span class="hljs-con-string">'Username'</span>, <span class="hljs-con-built_in">str</span>)&#13;
&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> rick = Username(<span class="hljs-con-string">'Rick'</span>)&#13;
&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-built_in">type</span>(rick)&#13;
&lt;class 'str'&gt;&#13;
</code></pre>&#13;
    <p class="normal">Here we created a type called <code class="inlineCode">Username</code>, which is treated as a subclass of <code class="inlineCode">str</code> in this case.</p>&#13;
    <h2 id="_idParaDest-225" class="heading-2">Generics</h2>&#13;
    <p class="normal">In some cases, you don’t want to statically specify the type of a function, but make it depend on the input instead. For this reason, the Python type system supports generics. If you’re familiar with Java, C++, or C#, you might be familiar with them.</p>&#13;
    <p class="normal">Generics allow you to <a id="_idIndexMarker604"/>create a generic type whose only constraint is that it is the same in all cases. This means that if you specify a generic type as both the input and the output for a function, it will be assumed to be the same; if you input an <code class="inlineCode">int</code> into a function, you will receive an <code class="inlineCode">int</code>. </p>&#13;
    <p class="normal">First, we need to specify a generic type and, after that, we can specify it as parameters for our functions:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">import</span> typing&#13;
&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> T = typing.TypeVar(<span class="hljs-con-string">'T'</span>, <span class="hljs-con-built_in">int</span>, <span class="hljs-con-built_in">str</span>)&#13;
&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> <span class="hljs-con-keyword">def</span><span class="hljs-con-function"> </span><span class="hljs-con-title">add</span><span class="hljs-con-function">(</span><span class="hljs-con-params">a: T, b: T</span><span class="hljs-con-function">) -&gt; T:</span>&#13;
<span class="hljs-con-meta">...</span>     <span class="hljs-con-keyword">return</span> a + b&#13;
&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> add(<span class="hljs-con-number">1</span>, <span class="hljs-con-number">2</span>)&#13;
3&#13;
<span class="hljs-con-meta">&gt;&gt;&gt;</span> add(<span class="hljs-con-string">'a'</span>, <span class="hljs-con-string">'b'</span>)&#13;
'ab'&#13;
</code></pre>&#13;
    <p class="normal">In this case, we created a <a id="_idIndexMarker605"/>generic type with the constraint that it needs to be either <code class="inlineCode">int</code> or <code class="inlineCode">str</code>. When the type checker runs, it will check if <code class="inlineCode">a</code>, <code class="inlineCode">b</code>, and the <code class="inlineCode">return</code> value have the same type. This means that even though an <code class="inlineCode">int</code> is valid for type <code class="inlineCode">T</code>, if you make <code class="inlineCode">a</code> a <code class="inlineCode">str</code>, <code class="inlineCode">b</code> and the output have to be <code class="inlineCode">str</code> as well.</p>&#13;
    <h2 id="_idParaDest-226" class="heading-2">Type checking</h2>&#13;
    <p class="normal">Now that we know how to specify and <a id="_idIndexMarker606"/>create type hints, it’s time to run a type checker. The reference implementation for type checking is the <code class="inlineCode">mypy</code> tool. It can thoroughly check your code and warn about potential problems.</p>&#13;
    <p class="normal">First, we need to install <code class="inlineCode">mypy</code> – luckily, that’s easy enough with <code class="inlineCode">pip</code>:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> pip3 install -U mypy&#13;
</code></pre>&#13;
    <p class="normal">Now we will use <code class="inlineCode">mypy</code> to check some of the earlier examples with a few errors added:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">import</span> typing&#13;
&#13;
<span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">pow</span><span class="hljs-function">(</span><span class="hljs-params">base: </span><span class="hljs-built_in">int</span><span class="hljs-params">, exponent: </span><span class="hljs-built_in">int</span><span class="hljs-function">) -&gt; int:</span>&#13;
    <span class="hljs-keyword">return</span> base ** exponent&#13;
&#13;
<span class="hljs-built_in">pow</span>(<span class="hljs-number">2.5</span>, <span class="hljs-number">10</span>)&#13;
</code></pre>&#13;
    <p class="normal">Since we hinted <code class="inlineCode">base</code> to be an <code class="inlineCode">int</code>, <code class="inlineCode">2.5</code> is not a valid value since it is a <code class="inlineCode">float</code>:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> mypy T_01_type_hinting.py&#13;
T_01_type_hinting.py:8: error: Argument 1 to "pow" has incompatible type "float"; expected "int"&#13;
</code></pre>&#13;
    <p class="normal">Now an example with a custom type:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Username = typing.NewType(<span class="hljs-string">'Username'</span>, <span class="hljs-built_in">str</span>)&#13;
&#13;
rick = Username(<span class="hljs-string">'Rick'</span>)&#13;
&#13;
<span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">print_username</span><span class="hljs-function">(</span><span class="hljs-params">username: Username</span><span class="hljs-function">):</span>&#13;
    print(<span class="hljs-string">f'Username: </span><span class="hljs-subst">{username}</span><span class="hljs-string">'</span>)&#13;
&#13;
print_username(rick)&#13;
print_username(<span class="hljs-built_in">str</span>(rick))&#13;
</code></pre>&#13;
    <p class="normal">Here we specified that <code class="inlineCode">print_username()</code> should receive a <code class="inlineCode">Username</code> type. Even though <code class="inlineCode">Username</code> inherits <code class="inlineCode">str</code>, it is not considered valid:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> mypy T_01_type_hinting.py&#13;
T_01_type_hinting.py:22: error: Argument 1 to "print_username" has incompatible type "str"; expected "Username"&#13;
</code></pre>&#13;
    <p class="normal">Lastly, we will create a generic type:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">T = typing.TypeVar(<span class="hljs-string">'T'</span>)&#13;
&#13;
<span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">to_string</span><span class="hljs-function">(</span><span class="hljs-params">value: T</span><span class="hljs-function">) -&gt; T:</span>&#13;
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(value)&#13;
&#13;
to_string(<span class="hljs-number">1</span>)&#13;
</code></pre>&#13;
    <p class="normal">Since <code class="inlineCode">to_string()</code> received an <code class="inlineCode">int</code>, it <a id="_idIndexMarker607"/>should return an <code class="inlineCode">int</code>, which is not the case. Let’s run <code class="inlineCode">mypy</code> to see what’s wrong:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con">error: Incompatible return value type (got "str", expected "T")&#13;
</code></pre>&#13;
    <p class="normal">While writing code, <code class="inlineCode">mypy</code> can save you a lot of debugging by warning you about incorrect type usage.</p>&#13;
    <h2 id="_idParaDest-227" class="heading-2">Python type interface files</h2>&#13;
    <p class="normal">Python type hint files (<code class="inlineCode">.pyi</code>), also called stub files, are files <a id="_idIndexMarker608"/>that allow you to specify all type hints for a file without touching the original file. This is useful for libraries that you do not have write access to, or if you do not want to clutter your files with type hints.</p>&#13;
    <p class="normal">The files use the regular Python syntax, but the functions are not meant to contain anything beyond stubs that only hint the types. An example stub for the <code class="inlineCode">print_username()</code> function mentioned above could be:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">import</span> typing&#13;
&#13;
Username = typing.NewType(<span class="hljs-string">'Username'</span>, <span class="hljs-built_in">str</span>)&#13;
&#13;
<span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">print_username</span><span class="hljs-function">(</span><span class="hljs-params">username: Username</span><span class="hljs-function">):</span> ...&#13;
</code></pre>&#13;
    <p class="normal">The files are nothing <a id="_idIndexMarker609"/>special, but they can be especially useful when interacting with libraries that lack type hinting. If your regular file is named <code class="inlineCode">test.py</code>, the <code class="inlineCode">pyi</code> file would be named <code class="inlineCode">test.pyi</code>.</p>&#13;
    <h2 id="_idParaDest-228" class="heading-2">Type hinting conclusion</h2>&#13;
    <p class="normal">Within this section, you have seen a<a id="_idIndexMarker610"/> few very basic examples of how type hinting can be applied and how the types can be checked. The Python <code class="inlineCode">typing</code> module is still getting enhanced quite a lot and <code class="inlineCode">mypy</code> has really extensive documentation that can be useful if you are applying this to your own code. Make sure to look at the documentation if you have any specific issues; it is high quality and very useful. </p>&#13;
    <p class="normal">When it comes to using type hinting in your own projects, my suggestion is to use it wherever it enhances your workflow but not to go overboard. In many cases, your editor will be smart enough to figure out the arguments automatically, or it won’t really matter too much. But when passing along more advanced classes where you tend to forget the methods available for that class, it becomes a really useful feature. Having smart autocompletion can really save you a lot of time.</p>&#13;
    <p class="normal">Now that we have type hints covered, it is time to continue with documenting our code and the markup languages available for that task.</p>&#13;
    <h1 id="_idParaDest-229" class="heading-1">reStructuredText and Markdown</h1>&#13;
    <p class="normal">The <strong class="keyWord">reStructuredText</strong> format (also known as <strong class="keyWord">RST</strong>, <strong class="keyWord">ReST</strong>, or <strong class="keyWord">reST</strong>) was developed in 2002 as a language that implements <a id="_idIndexMarker611"/>enough markup to be usable, but is simple enough to be readable as plain text. These two features make it readable enough to use in code, yet still versatile enough to generate pretty and useful documentation.</p>&#13;
    <p class="normal">The Markdown format<a id="_idIndexMarker612"/> is really similar to reStructuredText and largely comparable. While reStructuredText is slightly older (2012) than Markdown (2014), the Markdown format has gained a bit more popularity because it’s a bit simpler and less Python-focused. Both standards are excellent for writing text that is legible straightaway and can easily be converted to other formats such as HTML or PDF files.</p>&#13;
    <p class="normal">The main <a id="_idIndexMarker613"/>advantages of reST are:</p>&#13;
    <ul>&#13;
      <li class="bulletList">A very extensive feature set</li>&#13;
      <li class="bulletList">A strictly defined standard</li>&#13;
      <li class="bulletList">Easy extensibility</li>&#13;
    </ul>&#13;
    <p class="normal">The main <a id="_idIndexMarker614"/>advantages of Markdown are:</p>&#13;
    <ul>&#13;
      <li class="bulletList">It is less Python-centric, which caused it to gain more widespread adoption</li>&#13;
      <li class="bulletList">A more forgiving and less strict parser, which makes it easier to write</li>&#13;
    </ul>&#13;
    <p class="normal">The greatest thing about both reStructuredText and<a id="_idIndexMarker615"/> Markdown is that they are very intuitive to write and natively supported by most (social) coding platforms such as GitHub, GitLab, BitBucket, and PyPI.</p>&#13;
    <p class="normal">Even without knowing anything about the standard, you can easily write documentation in this style. However, more advanced techniques, such as images and links, do require some explanation.</p>&#13;
    <p class="normal">For Python documentation itself, reStructuredText is<a id="_idIndexMarker616"/> the most convenient standard since it’s well supported by tools such as Sphinx and docutils. For readme files on sites such as GitHub and the Python Package Index, the Markdown standard is generally better supported.</p>&#13;
    <div class="packt_tip">&#13;
      <p class="normal">To easily convert between formats such as reStructuredText and Markdown, use the Pandoc tool, available<a id="_idIndexMarker617"/> at <a href="https://pandoc.org/"><span class="url">https://pandoc.org/</span></a>.</p>&#13;
    </div>&#13;
    <p class="normal">The basic syntax reads just like text and the next few paragraphs will show some of the more advanced features. However, let us start with a simple example demonstrating how simple a reStructuredText or Markdown file can be:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Documentation, how to use Sphinx and reStructuredText&#13;
##################################################################&#13;
&#13;
Documenting code can be both fun and useful! ...&#13;
&#13;
Additionally, adding ...&#13;
&#13;
... So that typing 'some_string.' will automatically ...&#13;
&#13;
Topics covered in this chapter are as follows:&#13;
&#13;
 - The reStructuredText syntax&#13;
 - Setting up documentation using Sphinx&#13;
 - Sphinx style docstrings&#13;
 - Google style docstrings&#13;
 - NumPy style docstrings&#13;
&#13;
The reStructuredText syntax&#13;
******************************************************************&#13;
&#13;
The reStructuredText format (also known as ...&#13;
</code></pre>&#13;
    <p class="normal">That’s how easy it is to <a id="_idIndexMarker618"/>convert the text of this chapter so far to reStructuredText or<a id="_idIndexMarker619"/> Markdown. The example above works in both. But for the Markdown file to look similar, we need to modify the headers slightly:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"># Documentation, how to use Sphinx and reStructuredText&#13;
&#13;
...&#13;
&#13;
## The reStructuredText syntax&#13;
&#13;
...&#13;
</code></pre>&#13;
    <p class="normal">The following paragraphs will cover the following features:</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;">&#13;
      <li class="numberedList" value="1">Inline markup (italic, bold, code, and links)</li>&#13;
      <li class="numberedList">Lists</li>&#13;
      <li class="numberedList">Headers</li>&#13;
      <li class="numberedList">Advanced links</li>&#13;
      <li class="numberedList">Images</li>&#13;
      <li class="numberedList">Substitutions</li>&#13;
      <li class="numberedList">Blocks containing code, math, and others</li>&#13;
    </ol>&#13;
    <h2 id="_idParaDest-230" class="heading-2">Getting started with reStructuredText</h2>&#13;
    <p class="normal">To quickly convert a<a id="_idIndexMarker620"/> reStructuredText file to HTML, we can use the <code class="inlineCode">docutils</code> library. The <code class="inlineCode">sphinx</code> library discussed later in this chapter actually uses the <code class="inlineCode">docutils</code> library internally, but has some extra features that we won’t need initially. To get started, we just need to install <code class="inlineCode">docutils</code>:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> pip3 install docutils&#13;
</code></pre>&#13;
    <p class="normal">After that, we can easily convert reStructuredText into PDF, LaTeX, HTML, and other formats. For the examples in this paragraph, we’ll use the HTML format, which is easily generated using the following command:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> rst2html.py file.rst file.html&#13;
</code></pre>&#13;
    <p class="normal">The <a id="_idIndexMarker621"/>reStructuredText language has two basic components:</p>&#13;
    <ul>&#13;
      <li class="bulletList">Roles that allow for <strong class="keyWord">inline</strong> modifications of the output, such as <code class="inlineCode">:code:</code>, <code class="inlineCode">:math:</code>, <code class="inlineCode">:emphasis:</code>, and <code class="inlineCode">:literal:</code>.</li>&#13;
      <li class="bulletList">Directives that generate markup <strong class="keyWord">blocks</strong>, such as code samples with multiple lines. These look like this:&#13;
        <pre class="programlisting code"><code class="hljs-code">.. code:: python&#13;
&#13;
  print(<span class="hljs-string">'Hello world'</span>)&#13;
</code></pre>&#13;
      </li>&#13;
    </ul>&#13;
    <p class="normal">Within pure reStructuredText, the directives are the most important, but we will see many uses for the roles in the section on <em class="italic">Sphinx roles</em> later in this chapter.</p>&#13;
    <h2 id="_idParaDest-231" class="heading-2">Getting started with Markdown</h2>&#13;
    <p class="normal">To quickly<a id="_idIndexMarker622"/> convert a Markdown file to HTML we have many options available. But, because we are using Python, we will use the <code class="inlineCode">markdown</code> package:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> pip3 install markdown&#13;
</code></pre>&#13;
    <p class="normal">Now we can convert our file to HTML with the following command:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> markdown_py file.md -f file.html&#13;
</code></pre>&#13;
    <p class="normal">It should be noted that this converter only supports plain Markdown, not the GitHub flavored Markdown, which also supports code syntax highlighting.</p>&#13;
    <div class="packt_tip">&#13;
      <p class="normal">The <code class="inlineCode">grip</code> (GitHub Readme Instant Preview) Python package supports live rendering of GitHub flavored Markdown by using the GitHub servers and can be useful while writing Markdown.</p>&#13;
    </div>&#13;
    <h2 id="_idParaDest-232" class="heading-2">Inline markup</h2>&#13;
    <p class="normal"><strong class="keyWord">Inline markup</strong> is the <a id="_idIndexMarker623"/>markup that is used within a regular line of text. Examples of these are emphasis, inline code examples, links, images, and bullet lists.</p>&#13;
    <div class="note">&#13;
      <p class="normal">Within reStructuredText, these are implemented through roles, but often have useful shorthands. Instead of <code class="inlineCode">:emphasis:'text'</code>, you can also use <code class="inlineCode">*text*</code>.</p>&#13;
    </div>&#13;
    <p class="normal">Emphasis, for example, can be added by encapsulating the words between one or two asterisk signs. This sentence, for example, could add a little bit of <code class="inlineCode">*emphasis*</code> by adding a single asterisk on both sides, or a lot of <code class="inlineCode">**emphasis**</code> by adding two asterisks on both sides. There are many different inline markup directives so we will list only the most common ones. A full list can always be found <a id="_idIndexMarker624"/>through the reStructuredText home page at <a href="https://docutils.sourceforge.io/docs/"><span class="url">https://docutils.sourceforge.io/docs/</span></a> and the Markdown<a id="_idIndexMarker625"/> home page at <a href="https://daringfireball.net/projects/markdown/syntax"><span class="url">https://daringfireball.net/projects/markdown/syntax</span></a>, respectively.</p>&#13;
    <p class="normal">The following are some examples that work for both reST and Markdown:</p>&#13;
    <ul>&#13;
      <li class="bulletList">Emphasis (italic) text: <code class="inlineCode">*emphasis for this phrase*</code>.</li>&#13;
      <li class="bulletList">Extra emphasis (bold) text: <code class="inlineCode">**extra emphasis for this phrase**</code>.</li>&#13;
      <li class="bulletList">For lists without numbers, a simple dash with a space after it:<ul>&#13;
          <li class="bulletList"><code class="inlineCode">- item 1</code></li>&#13;
          <li class="bulletList"><code class="inlineCode">- item 2</code></li>&#13;
        </ul>&#13;
      </li>&#13;
    </ul>&#13;
    <div class="note">&#13;
      <p class="normal">Note</p>&#13;
      <p class="normal">The space after the dash is required for reStructuredText to recognize the list.</p>&#13;
    </div>&#13;
    <ul>&#13;
      <li class="bulletList">For lists with numbers, the number followed by a period and a space:<ul>&#13;
          <li class="bulletList"><code class="inlineCode">1. item 1</code></li>&#13;
          <li class="bulletList"><code class="inlineCode">2. item 2</code></li>&#13;
        </ul>&#13;
      </li>&#13;
      <li class="bulletList">For numbered lists, the period after the number is required.</li>&#13;
      <li class="bulletList">Interpreted text: These are domain-specific. Within Python documentation, the default role is code, which means that surrounding text with backticks will convert your code to use code tags, for example, <code class="inlineCode">'if spam and eggs:'</code>.</li>&#13;
      <li class="bulletList">Inline literals: This is formatted with a monospace font, which makes it ideal for inline code. Just add two backticks to <code class="inlineCode">''add some code''</code>. For Markdown, there is no noticeable difference between single and double backticks in output, but it can be used to escape single backticks: <code class="inlineCode">''some code ' with backticks''</code>.</li>&#13;
      <li class="bulletList">Escaping in reST can be done using a \, similar to escaping in Python: <code class="inlineCode">''some code \' with backticks''</code>.</li>&#13;
    </ul>&#13;
    <p class="normal">For <a id="_idIndexMarker626"/>reStructuredText, there are a few extra options using roles, similar to the interpreted text role we saw earlier. These roles can be set through role prefixes or suffixes depending on your preference; for example, <code class="inlineCode">:math:'E=mc^2'</code> to show mathematical equations.</p>&#13;
    <p class="normal">References can be added through a trailing underscore. They can point to headers, links, labels, and more. The next section will cover more about these, but the basic syntax is simply <code class="inlineCode">reference_</code>, or enclosed in backticks when the reference contains spaces – <code class="inlineCode">'some reference link'_</code>.</p>&#13;
    <p class="normal">There are many more available, but these are the ones you will use the most when writing reStructuredText.</p>&#13;
    <h2 id="_idParaDest-233" class="heading-2">Headers</h2>&#13;
    <p class="normal">The headers are <a id="_idIndexMarker627"/>used to indicate the start of a document, section, chapter, or paragraph. It is therefore the first structure you need in a document. While not strictly needed, its usage is highly recommended as it serves several purposes:</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;">&#13;
      <li class="numberedList" value="1">The headers are consistently formatted according to their level.</li>&#13;
      <li class="numberedList">A table of contents (TOC) tree can be generated from the headers.</li>&#13;
      <li class="numberedList">All <a id="_idIndexMarker628"/>headers automatically function as labels, which means you can create links to them.</li>&#13;
    </ol>&#13;
    <p class="normal">The format required to make headers overlaps a little between reST and Markdown, but for clarity, we will cover them separately.</p>&#13;
    <h3 id="_idParaDest-234" class="heading-3">Headers with reStructuredText</h3>&#13;
    <p class="normal">When<a id="_idIndexMarker629"/> creating headers, consistency is one of the few constraints; the <a id="_idIndexMarker630"/>number of characters used is fairly arbitrary, as is the number of levels.</p>&#13;
    <p class="normal">Personally, I default to a simple system with a fixed-size header, but I recommend at least following the default of the Python documentation in terms of the parts, chapters, sections, subsections, subsubsections, and paragraphs, something along the lines of the following:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Part&#13;
################################################################&#13;
&#13;
Chapter&#13;
****************************************************************&#13;
&#13;
Section&#13;
================================================================&#13;
&#13;
Subsection&#13;
----------------------------------------------------------------&#13;
&#13;
Subsubsection&#13;
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&#13;
&#13;
Paragraph&#13;
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""&#13;
&#13;
Content&#13;
</code></pre>&#13;
    <p class="normal">This creates the following output:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_01.png" alt="Headers" width="355" height="334"/></figure>&#13;
    <p class="packt_figref">Figure 9.1: Headers with reStructuredText</p>&#13;
    <p class="normal">That is just the <a id="_idIndexMarker631"/>common usage of the headers, but the main idea of<a id="_idIndexMarker632"/> reStructuredText is that you can use just about anything that feels natural to you, which means that you can use any of the following characters: <code class="inlineCode">= - ' : ' " ~ ^ _ * + # &lt;&gt;</code>. It also supports both underlines and overlines, so if you prefer that, they are options as well:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">################################################################&#13;
Part&#13;
################################################################&#13;
&#13;
****************************************************************&#13;
Chapter&#13;
****************************************************************&#13;
&#13;
================================================================&#13;
Section&#13;
================================================================&#13;
&#13;
----------------------------------------------------------------&#13;
Subsection&#13;
----------------------------------------------------------------&#13;
&#13;
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&#13;
Subsubsection&#13;
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&#13;
&#13;
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""&#13;
Paragraph&#13;
""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""&#13;
&#13;
Content&#13;
</code></pre>&#13;
    <p class="normal">While I try<a id="_idIndexMarker633"/> to keep the number of characters fixed to 78 characters <a id="_idIndexMarker634"/>as <code class="inlineCode">PEP8</code> (<em class="chapterRef">Chapter 3</em>, <em class="italic">Pythonic Syntax and Common Pitfalls</em>) recommends for Python, the number of characters used is mostly arbitrary, but it does have to be at least as long as the text of the header. This allows it to accept the following result:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Section&#13;
=======&#13;
</code></pre>&#13;
    <p class="normal">But not this:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Section&#13;
====&#13;
</code></pre>&#13;
    <h3 id="_idParaDest-235" class="heading-3">Headers with Markdown</h3>&#13;
    <p class="normal">With <a id="_idIndexMarker635"/>Markdown, you have several options for headers depending on what you feel<a id="_idIndexMarker636"/> like. Similar to reST, you can use the <code class="inlineCode">=</code> and <code class="inlineCode">–</code> characters to underline, but only those, and the length and blank lines after them do not matter:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Part&#13;
=&#13;
Chapter&#13;
-&#13;
</code></pre>&#13;
    <p class="normal">If you want <a id="_idIndexMarker637"/>more levels, you <a id="_idIndexMarker638"/>can use up to 6 levels by using the <code class="inlineCode">#</code> prefix and optional suffixes:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"># Part&#13;
## Chapter&#13;
### Section&#13;
#### Subsection&#13;
##### Subsubsection&#13;
###### Paragraph&#13;
Content&#13;
###### Paragraph with suffix ######&#13;
Content&#13;
</code></pre>&#13;
    <p class="normal">This results in:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_02.png" alt="" width="580" height="446"/></figure>&#13;
    <p class="packt_figref">Figure 9.2: Headers in Markdown</p>&#13;
    <p class="normal">As you can see, Markdown<a id="_idIndexMarker639"/> is slightly less flexible than reStructuredText when it <a id="_idIndexMarker640"/>comes to headers, but in most cases, it offers enough features to be perfectly usable. </p>&#13;
    <h2 id="_idParaDest-236" class="heading-2">Lists</h2>&#13;
    <p class="normal">The reStructuredText format has several styles of lists:</p>&#13;
    <ol class="numberedList" style="list-style-type: decimal;">&#13;
      <li class="numberedList" value="1">Enumerated</li>&#13;
      <li class="numberedList">Bulleted</li>&#13;
      <li class="numberedList">Options</li>&#13;
      <li class="numberedList">Definitions</li>&#13;
    </ol>&#13;
    <p class="normal">The simplest forms of<a id="_idIndexMarker641"/> lists were already displayed in the introduction section, but it’s actually possible to use many different characters, such as letters, Roman numerals, and others, for enumeration. After demonstrating the basic list types, we will continue with the nesting of lists and structures, which makes them even more powerful. Care must be taken with the amount of whitespace, as one space too many can cause a structure to be recognized as regular text instead of a structure.</p>&#13;
    <h3 id="_idParaDest-237" class="heading-3">Enumerated lists</h3>&#13;
    <p class="normal">Enumerated lists are <a id="_idIndexMarker642"/>convenient for all sorts of enumerations. The basic <a id="_idIndexMarker643"/>premise for enumerated lists is an alphanumeric character followed by a period, a right parenthesis, or parentheses on both sides. Additionally, the <code class="inlineCode">#</code> character functions as an automatic enumeration. For example:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">1. With&#13;
2. Numbers&#13;
&#13;
a. With&#13;
#. letters&#13;
&#13;
i. Roman&#13;
#. numerals&#13;
&#13;
(1) With&#13;
(2) Parenthesis&#13;
</code></pre>&#13;
    <p class="normal">The output is perhaps a bit simpler than you would expect. The reason is that it depends on the output format. The following figure shows the rendered HTML output, which has no support for parentheses. If you output LaTeX, for example, the difference can be made visible.</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_03.png" alt="Enumerated list" width="122" height="229"/></figure>&#13;
    <p class="packt_figref">Figure 9.3: Enumerated lists generated with the HTML output format</p>&#13;
    <p class="normal">Markdown also <a id="_idIndexMarker644"/>supports enumerated lists, but it is a bit more limited in its options. It <a id="_idIndexMarker645"/>only supports regular numbered lists. It’s more convenient in how it supports them though; there is no need for explicit numbering, and repeating <code class="inlineCode">1.</code> works without a problem:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">1. With&#13;
1. Numbers&#13;
</code></pre>&#13;
    <h3 id="_idParaDest-238" class="heading-3">Bulleted lists</h3>&#13;
    <p class="normal">If the order of the list is not <a id="_idIndexMarker646"/>relevant and you simply need a list of items without <a id="_idIndexMarker647"/>enumeration, then the bulleted list is what you should use. To create a simple list using bullets only, the bulleted items need to start with a <code class="inlineCode">*</code>, <code class="inlineCode">+</code>, <code class="inlineCode">-</code>, <code class="inlineCode">•</code>, ‣, or ⁃. This list is mostly arbitrary and can be modified by extending Sphinx or Docutils. For example:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">- dashes&#13;
- and more dashes&#13;
&#13;
* asterisk&#13;
* stars&#13;
&#13;
+ plus&#13;
+ and plus&#13;
</code></pre>&#13;
    <p class="normal">As you can see in the following figure, with the HTML output, all bullets again look identical. </p>&#13;
    <p class="normal">When generating documentation as LaTeX (and consecutively, PDF or Postscript), these can differ. </p>&#13;
    <p class="normal">Since web-based documentation is by far the most common output format for Sphinx, we default to that output instead. The rendered HTML output is as follows:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_04.png" alt="Bulleted list" width="186" height="232"/></figure>&#13;
    <p class="packt_figref">Figure 9.4: Bulleted lists with HTML output</p>&#13;
    <p class="normal">As you can see, all <a id="_idIndexMarker648"/>bulleted lists are rendered the same in this case. This is dependent on the<a id="_idIndexMarker649"/> renderer, however, so it’s a good idea to check the output to see if it matches your preference.</p>&#13;
    <h3 id="_idParaDest-239" class="heading-3">Option lists</h3>&#13;
    <p class="normal">The <code class="inlineCode">option</code> list is one<a id="_idIndexMarker650"/> meant specifically for documenting the command-line <a id="_idIndexMarker651"/>arguments of a program. The only special thing about the syntax is that the comma space is recognized as a separator for options:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">-s, --spam  This is the spam option&#13;
--eggs      This is the eggs option&#13;
</code></pre>&#13;
    <p class="normal">The following is the output:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_05.png" alt="Option list" width="316" height="71"/></figure>&#13;
    <p class="packt_figref">Figure 9.5: Option list</p>&#13;
    <p class="normal">In Markdown, there <a id="_idIndexMarker652"/>is no support for option lists, but you can achieve similar results by creating a table:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">| Argument     | Help                    |&#13;
|--------------|-------------------------|&#13;
| '-s, --spam' | This is the spam option |&#13;
| '--eggs'     | This is the eggs option |&#13;
</code></pre>&#13;
    <p class="normal">Note that in most <a id="_idIndexMarker653"/>Markdown implementations, the headers for a table are required. But the header alignment as is done here is optional, and the following would render the same:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">| Argument | Help |&#13;
|-|-|&#13;
| '-s, --spam' | This is the spam option |&#13;
| '--eggs' | This is the eggs option |&#13;
</code></pre>&#13;
    <h3 id="_idParaDest-240" class="heading-3">Definition lists (reST only)</h3>&#13;
    <p class="normal">The definition list is a bit <a id="_idIndexMarker654"/>more obscure than the other types of lists, since the actual structure <a id="_idIndexMarker655"/>consists of whitespace only. It’s therefore pretty straightforward to use, but not always as easy to identify in a file, and it is only supported by reST:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">spam&#13;
    Spam is a canned pork meat product&#13;
eggs&#13;
    Is, similar to spam, also food&#13;
</code></pre>&#13;
    <p class="normal">The following is the output:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_06.png" alt="Definition list" width="379" height="137"/></figure>&#13;
    <p class="packt_figref">Figure 9.6: Definitions list</p>&#13;
    <p class="normal">The definition<a id="_idIndexMarker656"/> list is<a id="_idIndexMarker657"/> especially useful when explaining the meaning of certain keywords in your documentation.</p>&#13;
    <h3 id="_idParaDest-241" class="heading-3">Nested lists</h3>&#13;
    <p class="normal">Nesting items is actually<a id="_idIndexMarker658"/> not limited to lists and can be done with multiple types of blocks, but <a id="_idIndexMarker659"/>the idea is the same. You could nest a code block within a bulleted list, for example. Just be careful to keep the indenting at the correct level. If you don’t, it either won’t be recognized as a separate level or you will get an error:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">1. With&#13;
2. Numbers&#13;
&#13;
   (food) food&#13;
	&#13;
    spam&#13;
        Spam is a canned pork meat product&#13;
    eggs&#13;
        Is, similar to spam, also food&#13;
&#13;
    (other) non-food stuff&#13;
</code></pre>&#13;
    <p class="normal">The following figure shows the output:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_07.png" alt="Nested lists" width="394" height="339"/></figure>&#13;
    <p class="packt_figref">Figure 9.7: Nested lists</p>&#13;
    <p class="normal">For Markdown, the<a id="_idIndexMarker660"/> same kind of <a id="_idIndexMarker661"/>nesting is possible, as long as the right list types are used.</p>&#13;
    <h2 id="_idParaDest-242" class="heading-2">Links, references, and labels</h2>&#13;
    <p class="normal">The links<a id="_idIndexMarker662"/> syntax is quite different between Markdown and reStructuredText, but they offer similar features. Both support inline links and links using a list of references.</p>&#13;
    <p class="normal">The simplest links with protocols such as <a href="http://python.org"><span class="url">http://python.org</span></a> will automatically be recognized by most parsers for both Markdown and reStructuredText. For custom labels, the syntax is a bit different:</p>&#13;
    <ul>&#13;
      <li class="bulletList">reStructuredText: <code class="inlineCode">'Python &lt;http://python.org&gt;'_</code></li>&#13;
      <li class="bulletList">Markdown: <code class="inlineCode">[Python](http://python.org)</code></li>&#13;
    </ul>&#13;
    <p class="normal">Both of these are nice for simple links that won’t be repeated too often, but generally, it’s more convenient to attach labels<a id="_idIndexMarker663"/> to links so they can be reused and don’t clog up the text too much.</p>&#13;
    <p class="normal">For example, refer to the following reStructuredText example:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">The switch to reStructuredText and Sphinx was made with the&#13;
'Python 2.6 &lt;https://docs.python.org/whatsnew/2.6.html&gt;'_&#13;
release.&#13;
</code></pre>&#13;
    <p class="normal">Now compare it with the following:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">The switch to reStructuredText and Sphinx was made with the&#13;
'python 2.6'_ release.&#13;
.. _'Python 2.6': https://docs.python.org/whatsnew/2.6.html&#13;
</code></pre>&#13;
    <p class="normal">The output is as follows:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_08.png" alt="Links, references, and labels" width="709" height="30"/></figure>&#13;
    <p class="packt_figref">Figure 9.8: Link with a custom label</p>&#13;
    <p class="normal">And the Markdown equivalents:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">The switch to reStructuredText and Sphinx was made with the [Python 2.6](https://docs.python.org/whatsnew/2.6.html) release.&#13;
&#13;
The switch to reStructuredText and Sphinx was made with the [Python 2.6] release.&#13;
&#13;
[Python 2.6]: https://docs.python.org/whatsnew/2.6.html&#13;
</code></pre>&#13;
    <p class="normal">Using labels, you can easily have a list of references at a designated location without making the actual text harder to read.</p>&#13;
    <p class="normal">For reStructuredText, these <a id="_idIndexMarker664"/>labels can be used for more than external links, however. Similar to the <code class="inlineCode">GOTO</code> statements found in older programming languages, you can create labels and refer to them from other parts of the documentation:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">.. _label:&#13;
</code></pre>&#13;
    <p class="normal">Within HTML or PDF output, this can be used to create a clickable link from anywhere in the text using the underscore links. Creating a clickable link to the label is as simple as having <code class="inlineCode">label_</code> in the text. </p>&#13;
    <p class="normal">Note that reStructuredText ignores case differences, so both uppercase and lowercase links work just fine. Even though we’re not likely to make this mistake, having the same label in a single document with only case differences results in an error, to make sure that duplicates never occur.</p>&#13;
    <p class="normal">The usage of<a id="_idIndexMarker665"/> references in conjunction with the headers works in a very natural way; you can just refer to them as you normally would and add an underscore to make it a link:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">The introduction section&#13;
================================================================&#13;
&#13;
This section contains:&#13;
&#13;
- 'chapter 1'_&#13;
- :ref:'chapter2'&#13;
&#13;
  1. my_label_&#13;
&#13;
  2. 'And a label link with a custom title &lt;my_label&gt;'_&#13;
Chapter 1&#13;
&#13;
----------------------------------------------------------------&#13;
&#13;
Jumping back to the beginning of 'chapter 1'_ is also possible.&#13;
Or jumping to :ref:'Chapter 2 &lt;chapter2&gt;'&#13;
&#13;
.. _chapter2:&#13;
&#13;
Chapter 2 With a longer title&#13;
----------------------------------------------------------------&#13;
&#13;
The next chapter.&#13;
&#13;
.. _my_label:&#13;
&#13;
The label points here.&#13;
&#13;
Back to 'the introduction section'_&#13;
</code></pre>&#13;
    <p class="normal">The output is as follows:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_09.png" alt="Links, references, and labels" width="613" height="534"/></figure>&#13;
    <p class="packt_figref">Figure 9.9: Links, labels, and references</p>&#13;
    <p class="normal">For Markdown, you can partially get similar results depending on the renderer that is used. In the case of the GitHub parser, all headers are automatically converted to HTML anchors, so a header like <code class="inlineCode"># Some header</code> can be linked to by using <code class="inlineCode">[name of the link](#some-header)</code>.</p>&#13;
    <p class="normal">While this method is convenient for simple cases, it comes with a number of drawbacks:</p>&#13;
    <ul>&#13;
      <li class="bulletList">When the header changes, all links to it are broken</li>&#13;
      <li class="bulletList">When multiple headers have the same name, only the first one can be linked to</li>&#13;
      <li class="bulletList">Only headers can be linked to</li>&#13;
    </ul>&#13;
    <h2 id="_idParaDest-243" class="heading-2">Images</h2>&#13;
    <p class="normal">Images is a<a id="_idIndexMarker666"/> feature that is implemented quite differently between reStructuredText and Markdown.</p>&#13;
    <h3 id="_idParaDest-244" class="heading-3">Images with reStructuredText</h3>&#13;
    <p class="normal">In reStructuredText, the<a id="_idIndexMarker667"/> image directive looks very similar to the label syntax. They’re<a id="_idIndexMarker668"/> actually a bit different, but the pattern is quite similar. The image directive is just one of the many directives that are supported by reStructuredText. We will see more about that later on when we cover Sphinx and reStructuredText extensions. For the time being, it is enough to know that the directives start with two periods followed by a space, the name of the directive, and two colons:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"> .. name_of_directive::&#13;
</code></pre>&#13;
    <p class="normal">In the case of the image, the directive is called <code class="inlineCode">image</code> of course:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">.. image:: python.png&#13;
</code></pre>&#13;
    <p class="normal">Here is the scaled output, as the actual image is much larger:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_10.png" alt="Images" width="319" height="308"/></figure>&#13;
    <p class="packt_figref">Figure 9.10: Image output with reStructuredText</p>&#13;
    <div class="note">&#13;
      <p class="normal">Note the double colon after the directives.</p>&#13;
    </div>&#13;
    <p class="normal">But how about specifying <a id="_idIndexMarker669"/>the size and other properties? The <a id="_idIndexMarker670"/>image directive has many other options (as do most other directives) that can be used: <a href="https://docutils.sourceforge.io/docs/ref/rst/directives.html#images"><span class="url">https://docutils.sourceforge.io/docs/ref/rst/directives.html#images</span></a>; they are mostly fairly obvious, however. To specify the width and height or the scale (in percent) of the image:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">.. image:: python.png&#13;
   :width: 150&#13;
   :height: 100&#13;
&#13;
.. image:: python.png&#13;
   :scale: 10&#13;
</code></pre>&#13;
    <p class="normal">The <a id="_idIndexMarker671"/>following is <a id="_idIndexMarker672"/>the output:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_11.png" alt="Images" width="198" height="227"/></figure>&#13;
    <p class="packt_figref">Figure 9.11: Scaled image with reStructuredText</p>&#13;
    <div class="note">&#13;
      <p class="normal">The <code class="inlineCode">scale</code> option uses the <code class="inlineCode">width</code> and <code class="inlineCode">height</code> options if available and falls back to the PIL (Python Imaging Library) or Pillow library to detect the image. If neither <code class="inlineCode">width</code>/<code class="inlineCode">height</code> nor PIL/Pillow are available, the <code class="inlineCode">scale</code> option will be ignored silently.</p>&#13;
    </div>&#13;
    <p class="normal">In addition to the <code class="inlineCode">image</code> directive, there is also the <code class="inlineCode">figure</code> directive. The difference is that <code class="inlineCode">figure</code> adds a<a id="_idIndexMarker673"/> caption to the image. Beyond that, the usage is the <a id="_idIndexMarker674"/>same as <code class="inlineCode">image</code>:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">.. figure:: python.png&#13;
   :scale: 10&#13;
&#13;
   The Python logo&#13;
</code></pre>&#13;
    <p class="normal">The output is as follows:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_12.png" alt="Images" width="206" height="231"/></figure>&#13;
    <p class="packt_figref">Figure 9.12: Adding a figure caption with reStructuredText</p>&#13;
    <p class="normal">Now, let’s compare what we’ve just seen with how to deal with images using Markdown.</p>&#13;
    <h3 id="_idParaDest-245" class="heading-3">Images with Markdown</h3>&#13;
    <p class="normal">The support for images in <a id="_idIndexMarker675"/>Markdown is similar to the support for links, but <a id="_idIndexMarker676"/>you need to add a <code class="inlineCode">!</code> in front of it:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">![python](python.png)&#13;
</code></pre>&#13;
    <p class="normal">As is the case with links, you can also use references:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">![python]&#13;
&#13;
[python]: python.png&#13;
</code></pre>&#13;
    <p class="normal">However, changing other properties such as the size is not supported by most Markdown implementations.</p>&#13;
    <h2 id="_idParaDest-246" class="heading-2">Substitutions</h2>&#13;
    <p class="normal">When writing documentation, you will often have to use the same images and links over and over again. While you<a id="_idIndexMarker677"/> can add those inline, it is often very verbose, tedious, and hard to maintain.</p>&#13;
    <p class="normal">Within reStructuredText pages, we already have the internal labeling system that handles a lot of cases for us. For external links and images, however, we need to use one of the other reStructuredText features. With substitution definitions, you can shorten directives so they can easily be re-used. In the common Markdown implementations, there is no equivalent feature for this.</p>&#13;
    <p class="normal">Let’s assume we have a logo that we use quite often within a bit of text. Instead of typing the entire <code class="inlineCode">.. image:: &lt;url&gt;</code>, it would be very handy to have a shorthand to make it easier. That’s where the substitutions are very useful:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">.. |python| image:: python.png&#13;
   :scale: 1&#13;
&#13;
The Python programming language uses the logo: |python|&#13;
</code></pre>&#13;
    <p class="normal">As you can see, you can use the pipe character to create and use substitutions anywhere in your text. As is usual in most languages, you can escape the character with a backslash (<code class="inlineCode">\</code>) if you need to use a pipe outside of substitutions.</p>&#13;
    <p class="normal">The output is as follows:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_13.png" alt="Substitutions" width="430" height="27"/></figure>&#13;
    <p class="packt_figref">Figure 9.13: Rendered reStructuredText using a substitution for an image directive</p>&#13;
    <p class="normal">These substitutions can be used with many directives, though they are particularly useful for outputting a variable in many places of a document. For example:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">.. |author| replace:: Rick van Hattem&#13;
&#13;
This book was written by |author|&#13;
</code></pre>&#13;
    <p class="normal">The following is the output:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_14.png" alt="Substitutions" width="389" height="28"/></figure>&#13;
    <p class="packt_figref">Figure 9.14: Rendered reStructuredText using a text substitution for an author’s name</p>&#13;
    <p class="normal">These types of <a id="_idIndexMarker678"/>substitutions are really useful while writing documentation because they make your reStructuredText files more readable, but they also allow you to change your entire documentation by updating a single variable. As opposed to a search/replace, which is generally an error-prone operation.</p>&#13;
    <p class="normal">While writing this chapter, a substitution for <code class="inlineCode">|rest|</code> to return <code class="inlineCode">reStructuredText</code> would have been very useful.</p>&#13;
    <h2 id="_idParaDest-247" class="heading-2">Blocks, code, math, comments, and quotes</h2>&#13;
    <p class="normal">When writing documentation, a common scenario is the need for blocks<a id="_idIndexMarker679"/> that contain different types of content, explanations <a id="_idIndexMarker680"/>with mathematical formulae, code examples, and more. </p>&#13;
    <p class="normal">The usage of these directives is similar to the image directive. The following is an example of a code block:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">.. code:: python&#13;
&#13;
   <span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">spam</span><span class="hljs-function">(</span><span class="hljs-params">*args</span><span class="hljs-function">):</span>&#13;
       print(<span class="hljs-string">'spam got args'</span>, args)&#13;
</code></pre>&#13;
    <p class="normal">The output is as follows:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_15.png" alt="Blocks, code, math, comments, and quotes" width="395" height="59"/></figure>&#13;
    <p class="packt_figref">Figure 9.15: Code block output</p>&#13;
    <p class="normal">This is one of the cases where Markdown is a bit simpler to use. With plain Markdown, a code block only requires indenting:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Code below:&#13;
&#13;
    <span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">spam</span><span class="hljs-function">(</span><span class="hljs-params">*args</span><span class="hljs-function">):</span>&#13;
        print(<span class="hljs-string">'spam got args'</span>, args)&#13;
</code></pre>&#13;
    <p class="normal">Or with the GitHub flavored Markdown with syntax highlighting:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">'''python&#13;
<span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">spam</span><span class="hljs-function">(</span><span class="hljs-params">*args</span><span class="hljs-function">):</span>&#13;
    print(<span class="hljs-string">'spam got args'</span>, args)&#13;
'''&#13;
</code></pre>&#13;
    <p class="normal">With <a id="_idIndexMarker681"/>reStructuredText you have more options, however. You can also display mathematical formulae using the LaTeX syntax. Here’s the fundamental theorem of calculus, for example:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">.. math::&#13;
&#13;
    \int_a^b f(x)\,dx = F(b) - F(a)&#13;
</code></pre>&#13;
    <p class="normal">The following is the output:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_16.png" alt="Blocks, code, math, comments, and quotes" width="279" height="75"/></figure>&#13;
    <p class="packt_figref">Figure 9.16: Mathematical formula output</p>&#13;
    <p class="normal">Commenting a<a id="_idIndexMarker682"/> bunch of text/commands is easily achieved by using the “empty” directive followed by an indent. Effectively, this means two dots, as is the case with any directive, but with the <code class="inlineCode">directive::</code> bit omitted:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Before comments&#13;
&#13;
.. Everything here will be commented&#13;
&#13;
  &#13;
   And this as well&#13;
   .. code:: python&#13;
      def even_this_code_sample():&#13;
          pass  # Will be commented&#13;
&#13;
After comments&#13;
</code></pre>&#13;
    <p class="normal">The output is as follows:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_17.png" alt="Blocks, code, math, comments, and quotes" width="190" height="69"/></figure>&#13;
    <p class="packt_figref">Figure 9.17: Output (with hidden comments)</p>&#13;
    <p class="normal">With Markdown, you have no real method of adding comments, but you can use links as a hack around this limitation in a few limited cases:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">[_]: &lt;&gt; (this will not be shown)&#13;
</code></pre>&#13;
    <p class="normal">While this method works, it is still far from pretty, of course. Often, you are better off moving the contents to a separate scratch file, or removing the content instead of commenting it and using a version control system such as Git to retrieve the data if you need it later.</p>&#13;
    <p class="normal">Quoting text<a id="_idIndexMarker683"/> is supported by both reStructuredText and Markdown, but the syntax conflicts. Within reStructuredText, you can create a block quote using indentation, which would result in code formatting in Markdown:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Normal text&#13;
&#13;
    Quoted text&#13;
</code></pre>&#13;
    <p class="normal">The output is as follows:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_18.png" alt="Blocks, code, math, comments, and quotes" width="183" height="78"/></figure>&#13;
    <p class="packt_figref">Figure 9.18: Quoting text</p>&#13;
    <p class="normal">Within Markdown, the format is comparable to how text-based email clients generally quote replies:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Normal text&#13;
&gt; Quoted text&#13;
</code></pre>&#13;
    <h2 id="_idParaDest-248" class="heading-2">Conclusion</h2>&#13;
    <p class="normal">Both reStructuredText and Markdown are very useful languages for creating some documentation. A large portion of the syntax comes naturally when writing plain text notes. A full guide to all the intricacies of reST, however, could fill a separate book. The previous demonstrations should have given enough of an introduction to do at least 90 percent of the work you will need when documenting your projects. Beyond that, Sphinx will help a lot, as we will see in the next sections.</p>&#13;
    <p class="normal">In general, I would suggest using reStructuredText for actual documentation because it has many more features than Markdown. However, Markdown is generally more convenient for the basic readme files on PyPI and GitHub, mainly because you can use the same readme file for both cases, and GitHub supports Markdown slightly better than reStructuredText.</p>&#13;
    <h1 id="_idParaDest-249" class="heading-1">The Sphinx documentation generator</h1>&#13;
    <p class="normal">The Sphinx documentation generator <a id="_idIndexMarker684"/>was created in 2008 for the Python 2.6 release to replace the old LaTeX documentation for Python. It’s a generator that makes it almost trivial to generate documentation for programming projects, but even outside of the programming world, it can be easily used. Within programming projects, there is specific support for the following domains (programming languages):</p>&#13;
    <ul>&#13;
      <li class="bulletList">Python</li>&#13;
      <li class="bulletList">C</li>&#13;
      <li class="bulletList">C++</li>&#13;
      <li class="bulletList">JavaScript</li>&#13;
      <li class="bulletList">reStructuredText</li>&#13;
    </ul>&#13;
    <p class="normal">Outside of these languages, there are extensions available for many other languages, such as CoffeeScript, MATLAB, PHP, Ruby Lisp, Go, and Scala. And if you’re simply looking for snippet code highlighting, the Pygments highlighter, which is used internally, supports over 120 languages and is easily extendible for new languages if needed.</p>&#13;
    <p class="normal">The most important advantage of Sphinx is that almost everything can be automatically generated from your source code. The result is that your documentation is always up to date.</p>&#13;
    <h2 id="_idParaDest-250" class="heading-2">Getting started with Sphinx</h2>&#13;
    <p class="normal">First of all, we have to make sure we install <a id="_idIndexMarker685"/>Sphinx. Even though the Python core documentation is written using Sphinx, it is still a separately maintained project and must be installed separately. Luckily, that’s easy enough using pip:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> pip3 install sphinx&#13;
</code></pre>&#13;
    <p class="normal">After installing Sphinx, there are two ways of getting started with a project: the <code class="inlineCode">sphinx-quickstart</code> script, and the <code class="inlineCode">sphinx-apidoc</code> script.</p>&#13;
    <p class="normal">If you want to create and customize an entire Sphinx project, then I would recommend the <code class="inlineCode">sphinx-quickstart</code> command, as it assists you in configuring a fully featured Sphinx project.</p>&#13;
    <p class="normal">If you want to start<a id="_idIndexMarker686"/> quickly and generate some API documentation for an <strong class="keyWord">existing</strong> Python project, then <code class="inlineCode">sphinx-apidoc</code> might be better suited since it takes a single command and no further input to create a project. After running it, you will have fully functioning documentation based on your Python source.</p>&#13;
    <p class="normal">In the end, both are valid options for creating Sphinx projects, and personally I usually end up generating the initial configuration using <code class="inlineCode">sphinx-quickstart</code> and call the <code class="inlineCode">sphinx-apidoc</code> command every time I add a Python module to add the new module. </p>&#13;
    <p class="normal">The <code class="inlineCode">sphinx-apidoc</code> command does not overwrite any files by default, making it a safe operation to run repeatedly.</p>&#13;
    <h3 id="_idParaDest-251" class="heading-3">Using sphinx-quickstart</h3>&#13;
    <p class="normal">The <code class="inlineCode">sphinx-quickstart</code> script<a id="_idIndexMarker687"/> interactively asks you about the most important decisions in your Sphinx project. There is no need to worry about typos; the configuration is stored in a <code class="inlineCode">conf.py</code> file and can be modified like a regular Python file.</p>&#13;
    <p class="normal">Usage is easy enough. As a default, I would recommend creating the documentation in a separate <code class="inlineCode">docs</code> directory, as is the convention for many projects. The output uses the following conventions:</p>&#13;
    <ul>&#13;
      <li class="bulletList">Inline comments start with <code class="inlineCode">#</code></li>&#13;
      <li class="bulletList">User input lines start with <code class="inlineCode">&gt;</code></li>&#13;
      <li class="bulletList">Cropped output is indicated with <code class="inlineCode">...</code> and all questions skipped in between use the default settings</li>&#13;
    </ul>&#13;
    <p class="normal">Note the <code class="inlineCode">docs</code> after the command:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> sphinx-quickstart docs&#13;
Welcome to the Sphinx 3.2.1 quickstart utility.&#13;
&#13;
Please enter values for the following settings (just press Enter to&#13;
accept a default value, if one is given in brackets).&#13;
&#13;
Selected root path: docs&#13;
&#13;
You have two options for placing the build directory for Sphinx output.&#13;
Either, you use a directory "_build" within the root path, or you separate&#13;
"source" and "build" directories within the root path.&#13;
&gt; Separate source and build directories (y/n) [n]:&#13;
&#13;
The project name will occur in several places in the built documentation.&#13;
&gt; Project name: Mastering Python&#13;
&gt; Author name(s): Rick van Hattem&#13;
&gt; Project release []:&#13;
&#13;
...&#13;
</code></pre>&#13;
    <p class="normal">You should now populate your master file, <code class="inlineCode">docs/index.rst</code>, and create other documentation source files. Use the Makefile to build the docs, like so:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> make &lt;builder&gt;&#13;
</code></pre>&#13;
    <p class="normal">Where “<code class="inlineCode">&lt;builder&gt;</code>" is one of the supported builders, for example, <code class="inlineCode">html</code>, <code class="inlineCode">latex</code>, or <code class="inlineCode">linkcheck</code>. After running this, we should have a <code class="inlineCode">docs</code> directory containing the Sphinx project. Let’s see what the <a id="_idIndexMarker688"/>command actually created for us:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> find docs&#13;
docs&#13;
docs/index.rst&#13;
docs/_templates&#13;
docs/Makefile&#13;
docs/conf.py&#13;
docs/_static&#13;
docs/make.bat&#13;
docs/_build&#13;
</code></pre>&#13;
    <p class="normal">The <code class="inlineCode">_build</code>, <code class="inlineCode">_static</code>, and <code class="inlineCode">_templates</code> directories are initially empty and can be ignored for now. The <code class="inlineCode">_build</code> directory is used to output the generated documentation, whereas the <code class="inlineCode">_static</code> directory can be used to easily include custom CSS files and such. The <code class="inlineCode">_templates</code> directory makes it possible to style the HTML output to your liking as well. Examples of these can be found in the Sphinx Git repository at <a href="https://www.sphinx-doc.org/en/master/usage/theming.html#builtin-themes"><span class="url">https://www.sphinx-doc.org/en/master/usage/theming.html#builtin-themes</span></a>.</p>&#13;
    <p class="normal"><code class="inlineCode">Makefile</code> and <code class="inlineCode">make.bat</code> can be used to generate the documentation output. <code class="inlineCode">Makefile</code> can be used for any operating system that supports the make utility, and <code class="inlineCode">make.bat</code> is there to support Windows systems out of the box. Now let’s look at the <code class="inlineCode">index.rst</code> source:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Welcome to Mastering Python's documentation!&#13;
============================================&#13;
&#13;
.. toctree::&#13;
   :maxdepth: 2&#13;
   :caption: Contents:&#13;
&#13;
&#13;
&#13;
Indices and tables&#13;
==================&#13;
&#13;
* :ref:'genindex'&#13;
* :ref:'modindex'&#13;
* :ref:'search'&#13;
</code></pre>&#13;
    <p class="normal">We see the <a id="_idIndexMarker689"/>document title as expected, followed by <code class="inlineCode">toctree</code> (table of contents tree; more about that later in this chapter), and the links to the indices and search. <code class="inlineCode">toctree</code> automatically generates a tree out of the headers of all available documentation pages. </p>&#13;
    <p class="normal">The indices and tables are automatically generated Sphinx pages, which are very useful, but nothing we need to worry about in terms of settings.</p>&#13;
    <p class="normal">Now it’s time to generate the <code class="inlineCode">HTML</code> output:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> cd docs&#13;
<span class="hljs-con-meta">$</span> make html&#13;
</code></pre>&#13;
    <p class="normal">The <code class="inlineCode">make html</code> command generates the documentation for you and the result is placed in <code class="inlineCode">_build/html/</code>. Just open <code class="inlineCode">index.html</code> in your browser to see the results. You should now have something looking similar to the following: </p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_19.png" alt="" width="607" height="189"/></figure>&#13;
    <p class="packt_figref">Figure 9.19: Viewing index.html</p>&#13;
    <p class="normal">With just that single command and by answering a few questions, we now have a documentation project with an index, search, and table of contents on all the pages.</p>&#13;
    <p class="normal">In addition to the HTML output, there are quite a few other formats supported by default, although<a id="_idIndexMarker690"/> some require external libraries to actually work:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> make help&#13;
Sphinx v3.2.1&#13;
Please use 'make target' where target is one of&#13;
  html        to make standalone HTML files&#13;
  dirhtml     to make HTML files named index.html in directories&#13;
  singlehtml  to make a single large HTML file&#13;
  pickle      to make pickle files&#13;
  json        to make JSON files&#13;
  htmlhelp    to make HTML files and an HTML help project&#13;
  qthelp      to make HTML files and a qthelp project&#13;
  devhelp     to make HTML files and a Devhelp project&#13;
  epub        to make an epub&#13;
  latex       to make LaTeX files, you can set PAPER=a4 or ...&#13;
  latexpdf    to make LaTeX and PDF files (default pdflatex)&#13;
  latexpdfja  to make LaTeX files and run them through platex/...&#13;
  text        to make text files&#13;
  man         to make manual pages&#13;
  texinfo     to make Texinfo files&#13;
  info        to make Texinfo files and run them through makeinfo&#13;
  gettext     to make PO message catalogs&#13;
  changes     to make an overview of all changed/added/... items&#13;
  xml         to make Docutils-native XML files&#13;
  pseudoxml   to make pseudoxml-XML files for display purposes&#13;
  linkcheck   to check all external links for integrity&#13;
  doctest     to run all doctests embedded in the documentation&#13;
  coverage    to run coverage check of the documentation&#13;
</code></pre>&#13;
    <h3 id="_idParaDest-252" class="heading-3">Using sphinx-apidoc</h3>&#13;
    <p class="normal">The <code class="inlineCode">sphinx-apidoc</code> command is <a id="_idIndexMarker691"/>generally used together with <code class="inlineCode">sphinx-quickstart</code>. It is possible to generate an entire project with the <code class="inlineCode">--full</code> parameter, but it’s generally a better idea to generate the entire project using <code class="inlineCode">sphinx-quickstart</code> and simply add the API documentation using <code class="inlineCode">sphinx-apidoc</code>. </p>&#13;
    <p class="normal">To properly demonstrate the <code class="inlineCode">sphinx-apidoc</code> command, we need some Python files, so we’ll create two files within a project called <code class="inlineCode">apidoc_example</code>.</p>&#13;
    <p class="normal">The first one is <code class="inlineCode">apidoc_example/a.py</code>, containing a class called <code class="inlineCode">A</code> with some methods:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">class</span><span class="hljs-class"> </span><span class="hljs-title">A</span><span class="hljs-class">(</span><span class="hljs-built_in">object</span><span class="hljs-class">):</span>&#13;
    <span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">__init__</span><span class="hljs-function">(</span><span class="hljs-params">self, arg, *args, **kwargs</span><span class="hljs-function">):</span>&#13;
        <span class="hljs-keyword">pass</span>&#13;
&#13;
    <span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">regular_method</span><span class="hljs-function">(</span><span class="hljs-params">self, arg</span><span class="hljs-function">):</span>&#13;
        <span class="hljs-keyword">pass</span>&#13;
&#13;
<span class="hljs-meta">    @classmethod</span>&#13;
    <span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">decorated_method</span><span class="hljs-function">(</span><span class="hljs-params">self, arg</span><span class="hljs-function">):</span>&#13;
        <span class="hljs-keyword">pass</span>&#13;
&#13;
    <span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">_hidden_method</span><span class="hljs-function">(</span><span class="hljs-params">self</span><span class="hljs-function">):</span>&#13;
        <span class="hljs-keyword">pass</span>&#13;
</code></pre>&#13;
    <p class="normal">Next, we have <code class="inlineCode">apidoc_example/b.py</code> containing a <code class="inlineCode">B</code> class that inherits <code class="inlineCode">A</code>:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">from</span> . <span class="hljs-keyword">import</span> a&#13;
&#13;
<span class="hljs-keyword">class</span><span class="hljs-class"> </span><span class="hljs-title">B</span><span class="hljs-class">(</span><span class="hljs-params">a.A</span><span class="hljs-class">):</span>&#13;
    <span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">regular_method</span><span class="hljs-function">(</span><span class="hljs-params">self</span><span class="hljs-function">):</span>&#13;
        <span class="hljs-string">'''This regular method overrides</span>&#13;
<span class="hljs-string">        :meth:'a.A.regular_method'</span>&#13;
<span class="hljs-string">        '''</span>&#13;
        <span class="hljs-keyword">pass</span>&#13;
</code></pre>&#13;
    <p class="normal">Now that we have our source files, it’s time to generate the actual API documentation:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> sphinx-apidoc apidoc_example -o docs&#13;
Creating file docs/apidoc_example.rst.&#13;
Creating file docs/modules.rst. &#13;
</code></pre>&#13;
    <p class="normal">This alone is not enough to include the API in the documentation. It needs to be added to <code class="inlineCode">toctree</code>. Luckily, that’s as simple as adding modules to <code class="inlineCode">toctree</code> in the <code class="inlineCode">index.rst</code> file to look something like this:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">.. toctree::&#13;
   :maxdepth: 2&#13;
&#13;
   modules&#13;
</code></pre>&#13;
    <p class="normal">The <code class="inlineCode">toctree</code> directive is discussed in further detail later in this chapter.</p>&#13;
    <p class="normal">We also have to make<a id="_idIndexMarker692"/> sure that the modules can be imported, otherwise Sphinx won’t be able to read the Python files. To do that, we simply add the parent directory (as seen from the <code class="inlineCode">docs</code> directory) to <code class="inlineCode">sys.path</code>; this can be put anywhere in the <code class="inlineCode">conf.py</code> file:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">import</span> os&#13;
<span class="hljs-keyword">import</span> sys&#13;
&#13;
sys.path.insert(<span class="hljs-number">0</span>, os.path.abspath(<span class="hljs-string">'..'</span>))&#13;
</code></pre>&#13;
    <p class="normal">Additionally, the <code class="inlineCode">autodoc</code> module needs to be enabled in <code class="inlineCode">conf.py</code>:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">extensions = [&#13;
    <span class="hljs-string">'sphinx.ext.autodoc'</span>,&#13;
]&#13;
</code></pre>&#13;
    <p class="normal">Now it’s time to generate the documentation again by using the <code class="inlineCode">html</code> builder:</p>&#13;
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> make html&#13;
Running Sphinx v3.2.1&#13;
making output directory... done&#13;
building [mo]: targets for 0 po files that are out of date&#13;
building [html]: targets for 3 source files that are out of date&#13;
updating environment: [new config] 3 added, 0 changed, 0 removed&#13;
reading sources... [100%] modules&#13;
looking for now-outdated files... none found&#13;
pickling environment... done&#13;
checking consistency... done&#13;
preparing documents... done&#13;
writing output... [100%] modules&#13;
generating indices...  genindex py-modindexdone&#13;
writing additional pages...  searchdone&#13;
copying static files... ... done&#13;
copying extra files... done&#13;
dumping search index in English (code: en)... done&#13;
dumping object inventory... done&#13;
build succeeded.&#13;
&#13;
The HTML pages are in _build/html. &#13;
</code></pre>&#13;
    <p class="normal">Open the <code class="inlineCode">docs/_build/index.html</code> file again. For the sake of brevity, the repeated parts of the document will be omitted from the screenshots. The cropped output is as follows:</p>&#13;
    <figure class="mediaobject"> <img src="Images/B15882_09_20.png" alt="" width="279" height="111"/></figure>&#13;
    <p class="packt_figref">Figure 9.20: Viewing the Contents</p>&#13;
    <p class="normal">But it actually generated<a id="_idIndexMarker693"/> quite a bit more. When running the <code class="inlineCode">sphinx-apidoc</code> command, it looks at all the Python modules in the specified directory recursively and generates an <code class="inlineCode">rst</code> file for each of them. After generating all those files, it adds all of them to a file called <code class="inlineCode">modules.rst</code>, which makes it easy to add them to your documentation.</p>&#13;
    <p class="normal">The <code class="inlineCode">modules.rst</code> file is really straight to the point; nothing more than a list of modules with the package name as the title:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">apidoc_example&#13;
==============&#13;
&#13;
.. toctree::&#13;
   :maxdepth: 4&#13;
&#13;
   apidoc_example &#13;
</code></pre>&#13;
    <p class="normal">The <code class="inlineCode">apidoc_example</code> page output is as follows:</p>&#13;
    <figure class="mediaobject"> <img src="Images/B15882_09_21.png" alt="" width="460" height="521"/></figure>&#13;
    <p class="packt_figref">Figure 9.21: The apidoc_example page</p>&#13;
    <p class="normal">The <code class="inlineCode">apidoc_example.rst</code> file <a id="_idIndexMarker694"/>simply lists all the documented modules in <code class="inlineCode">automodule</code> directives with a few settings:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">apidoc\_example package&#13;
=======================&#13;
&#13;
Submodules&#13;
----------&#13;
&#13;
apidoc\_example.a module&#13;
------------------------&#13;
&#13;
.. automodule:: apidoc_example.a&#13;
   :members:&#13;
   :undoc-members:&#13;
   :show-inheritance:&#13;
&#13;
apidoc\_example.b module&#13;
------------------------&#13;
&#13;
.. automodule:: apidoc_example.b&#13;
   :members:&#13;
   :undoc-members:&#13;
   :show-inheritance:&#13;
&#13;
Module contents&#13;
---------------&#13;
&#13;
.. automodule:: apidoc_example&#13;
   :members:&#13;
   :undoc-members:&#13;
   :show-inheritance:&#13;
</code></pre>&#13;
    <p class="normal">But as you have seen <a id="_idIndexMarker695"/>in the previous screenshot, it does not include hidden or magic methods. By adding some extra arguments to the <code class="inlineCode">automodule</code> directive, we can change this:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">apidoc\_example package&#13;
=======================&#13;
&#13;
Submodules&#13;
----------&#13;
&#13;
apidoc\_example.a module&#13;
------------------------&#13;
&#13;
.. automodule:: apidoc_example.a&#13;
   :members:&#13;
   :undoc-members:&#13;
   :show-inheritance:&#13;
<code style="font-weight: bold;" class="codeHighlighted">   :private-members:</code>&#13;
<code style="font-weight: bold;" class="codeHighlighted">   :special-members:</code>&#13;
<code style="font-weight: bold;" class="codeHighlighted">   :inherited-members:</code>&#13;
&#13;
apidoc\_example.b module&#13;
------------------------&#13;
&#13;
.. automodule:: apidoc_example.b&#13;
   :members:&#13;
   :undoc-members:&#13;
   :show-inheritance:&#13;
<code style="font-weight: bold;" class="codeHighlighted">   :private-members:</code>&#13;
<code style="font-weight: bold;" class="codeHighlighted">   :special-members:</code>&#13;
<code style="font-weight: bold;" class="codeHighlighted">   :inherited-members:</code>&#13;
&#13;
Module contents&#13;
---------------&#13;
&#13;
.. automodule:: apidoc_example&#13;
   :members:&#13;
   :undoc-members:&#13;
   :show-inheritance:&#13;
<code style="font-weight: bold;" class="codeHighlighted">   :private-members:</code>&#13;
<code style="font-weight: bold;" class="codeHighlighted">   :special-members:</code>&#13;
<code style="font-weight: bold;" class="codeHighlighted">   :inherited-members: </code>&#13;
</code></pre>&#13;
    <p class="normal">With these extra <a id="_idIndexMarker696"/>settings (<code class="inlineCode">private-members</code>, <code class="inlineCode">special-members</code>, and <code class="inlineCode">inherited-members</code>), we get a lot of extra and arguably useful documentation:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_22.png" alt="" width="624" height="813"/></figure>&#13;
    <p class="packt_figref">Figure 9.22: The updated apidoc_example page</p>&#13;
    <p class="normal">Which of these<a id="_idIndexMarker697"/> settings are useful for you depends on your use case, of course. But it shows how easily we can generate full documentation for classes with barely any effort. And all references such as the bases and the overridden methods are clickable as well.</p>&#13;
    <div class="note">&#13;
      <p class="normal">New files won’t be added to your docs automatically. It is safe to rerun the <code class="inlineCode">sphinx-apidoc</code> command to add the new files, but it won’t update your existing files. Even though the <code class="inlineCode">--force</code> option can be used to force overwriting the files, within existing files I recommend manually editing them instead. As we will see in the next sections, there are quite a few reasons to manually modify the generated files afterward.</p>&#13;
    </div>&#13;
    <h2 id="_idParaDest-253" class="heading-2">Sphinx directives</h2>&#13;
    <p class="normal">Sphinx adds a few <a id="_idIndexMarker698"/>directives on top of the default ones in reStructuredText and an easy API to add new directives yourself. Most of them are generally not that relevant to modify but, as one would expect, Sphinx has pretty good documentation in case you need to know more about them. </p>&#13;
    <p class="normal">We have already seen the labels, images, math, substitutions, code, and comment reST directives. But there are also quite a few Sphinx-specific directives. Most of them are not too important to talk about, but perhaps interesting to take a look at: <a href="https://www.sphinx-doc.org/en/master/usage/restructuredtext/directives.html"><span class="url">https://www.sphinx-doc.org/en/master/usage/restructuredtext/directives.html</span></a>.</p>&#13;
    <p class="normal">We’ve already<a id="_idIndexMarker699"/> covered the most important one of all, the <code class="inlineCode">autodoc</code> module, which is used by<a id="_idIndexMarker700"/> the <code class="inlineCode">automodule</code> directive. There is another one that requires a tiny bit of coverage, however: the <code class="inlineCode">toctree</code> directive. We have already seen it in use earlier, but it has a few interesting configuration options that are really useful for larger projects.</p>&#13;
    <p class="normal">The <code class="inlineCode">toctree</code> directive is one of the most important directives in Sphinx; it generates the table of contents tree. The <code class="inlineCode">toctree</code> directive<a id="_idIndexMarker701"/> has a couple of options, but the most important one is probably <code class="inlineCode">maxdepth</code>, which specifies how deep the tree needs to go. The top level of <code class="inlineCode">toctree</code> has to be specified manually by specifying the files to be read, but beyond that, every level within a document (section, chapter, paragraph, and so on) can be another level in <code class="inlineCode">toctree</code>, depending on the depth, of course. Even though the <code class="inlineCode">maxdepth</code> option is optional, without it all the available levels will be shown, which is usually more than required. In most cases, a <code class="inlineCode">maxdepth</code> of 2 is a good default value, which makes the basic example look like this:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">.. toctree::&#13;
   :maxdepth: 2&#13;
</code></pre>&#13;
    <p class="normal">The items in <code class="inlineCode">toctree</code> are the <code class="inlineCode">.rst</code> files in the same directory without the extension. This can include subdirectories, in which case the directories are separated with a <code class="inlineCode">.</code> (period):</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">.. toctree::&#13;
   :maxdepth: 2&#13;
&#13;
<code style="font-weight: bold;" class="codeHighlighted">   module.a</code>&#13;
<code style="font-weight: bold;" class="codeHighlighted">   module.b</code>&#13;
<code style="font-weight: bold;" class="codeHighlighted">   module.c</code>&#13;
</code></pre>&#13;
    <p class="normal">Another very useful<a id="_idIndexMarker702"/> option is the <code class="inlineCode">glob</code> option. It tells <code class="inlineCode">toctree</code> to use the <code class="inlineCode">glob</code> module in Python to automatically add all the documents matching a pattern. By simply adding a directory with a <code class="inlineCode">glob</code> pattern, you can add all the files in that directory. This<a id="_idIndexMarker703"/> makes the <code class="inlineCode">toctree</code> we had before as simple as:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">.. toctree::&#13;
   :maxdepth: 2&#13;
   :glob:&#13;
&#13;
   module.*&#13;
</code></pre>&#13;
    <p class="normal">If, for some reason, the document title is not as you would have liked, you can easily change the title to something customized:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">.. toctree::&#13;
   :maxdepth: 2&#13;
&#13;
   The A module &lt;module.a&gt;&#13;
</code></pre>&#13;
    <h2 id="_idParaDest-254" class="heading-2">Sphinx roles</h2>&#13;
    <p class="normal">We have seen Sphinx <a id="_idIndexMarker704"/>directives, which are separate blocks. Now we will discuss Sphinx roles, which<a id="_idIndexMarker705"/> can be used inline. A role allows you to tell Sphinx how to parse some input. Examples of these roles are links, math, code, and markup. But the most important ones are the roles within the Sphinx domains for referencing other classes, even for external projects. Within Sphinx, the default domain is the Python one, so a role such as <code class="inlineCode">:py:meth:</code> can be used as <code class="inlineCode">:meth:</code> as well. These roles are really useful to link to different packages, modules, classes, methods, and other objects. The basic usage is simple enough. To link to a class, use the following:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Spam: :class:'spam.Spam'&#13;
</code></pre>&#13;
    <p class="normal">The output is:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_23.png" alt="Sphinx roles" width="178" height="33"/></figure>&#13;
    <p class="packt_figref">Figure 9.23: Linking to a class</p>&#13;
    <p class="normal">The same goes for just about any other object, functions, exceptions, attributes, and so on. The Sphinx documentation offers a list of supported objects: <a href="https://www.sphinx-doc.org/domains.html#cross-referencing-python-objects"><span class="url">https://www.sphinx-doc.org/domains.html#cross-referencing-python-objects</span></a>.</p>&#13;
    <p class="normal">One of the nicer features of Sphinx is that these references can extend beyond your project. Similar to how we added a link to the class above, adding a reference to the <code class="inlineCode">int</code> object in the standard Python documentation is easily possible using <code class="inlineCode">:obj:'int'</code>. Adding <a id="_idIndexMarker706"/>references to your own projects in other documentation sets and on other websites is <a id="_idIndexMarker707"/>done in a similar fashion.</p>&#13;
    <p class="normal">For inter-project links, you will need to enable the <code class="inlineCode">intersphinx</code> module in <code class="inlineCode">conf.py</code>:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">extensions = [&#13;
    <span class="hljs-string">'sphinx.ext.autodoc'</span>,&#13;
    <span class="hljs-string">'sphinx.ext.intersphinx'</span>,&#13;
]&#13;
</code></pre>&#13;
    <p class="normal">After that, we need to tell <code class="inlineCode">intersphinx</code> where it can find the documentation of the other projects by adding <code class="inlineCode">intersphinx_mapping</code> to <code class="inlineCode">conf.py</code>:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">intersphinx_mapping = {&#13;
    <span class="hljs-string">'python'</span>: (<span class="hljs-string">'https://docs.python.org/'</span>, <span class="hljs-literal">None</span>),&#13;
    <span class="hljs-string">'sphinx'</span>: (<span class="hljs-string">'https://www.sphinx-doc.org/'</span>, <span class="hljs-literal">None</span>),&#13;
}&#13;
</code></pre>&#13;
    <p class="normal">Now we can easily link to the documentation on the Sphinx home page:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Link to the intersphinx module: :mod:'sphinx.ext.intersphinx'&#13;
</code></pre>&#13;
    <p class="normal">The following is the output:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_24.png" alt="Sphinx roles" width="526" height="32"/></figure>&#13;
    <p class="packt_figref">Figure 9.24: Linking to another project</p>&#13;
    <p class="normal">This links to <a href="https://www.sphinx-doc.org/en/master/ext/intersphinx.html"><span class="url">https://www.sphinx-doc.org/en/master/ext/intersphinx.html</span></a>.</p>&#13;
    <p class="normal">Now that we know how to use Sphinx to generate documentation from our code, let’s enhance that documentation to be even more useful.</p>&#13;
    <h1 id="_idParaDest-255" class="heading-1">Documenting code</h1>&#13;
    <p class="normal">There are currently three<a id="_idIndexMarker708"/> different documentation styles supported by Sphinx: the original Sphinx style and the more recent NumPy and Google styles. The differences between them are mainly in style, but it’s actually slightly more than that.</p>&#13;
    <p class="normal">The Sphinx style was developed using a bunch of reStructuredText roles, a very effective method, but it can be detrimental for readability when used a lot. You can probably tell what the following does, but it’s not the nicest syntax:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">:param number: The number of eggs to return&#13;
:type number: int&#13;
</code></pre>&#13;
    <p class="normal">The Google style was (as the name suggests) developed by Google. The goal was to have a simple/readable format that works both as in-code documentation and is parseable for Sphinx. In my opinion, it comes closer to the original idea of reStructuredText, a format that’s very close to how you would document instinctively. This example has the same meaning as the Sphinx style example shown earlier:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Args:&#13;
    number (int): The number of eggs to return&#13;
</code></pre>&#13;
    <p class="normal">The NumPy style was created specifically for the NumPy project. The NumPy project has many functions, with a huge amount of documentation, and generally a lot of documentation per argument. It is slightly more verbose than the Google format, but quite easy to read as well:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code">Parameters&#13;
----------&#13;
number : int&#13;
    The number of eggs to return&#13;
</code></pre>&#13;
    <div class="note">&#13;
      <p class="normal">With the type hint annotations introduced in Python 3.5, at least the argument type part of these syntaxes has become less useful. Since Sphinx 3.0 you can tell Sphinx to use the type hints instead of manually adding the type by adding this line to your Sphinx <code class="inlineCode">conf.py</code>:</p>&#13;
      <pre class="programlisting code"><code class="hljs-code">autodoc_typehints = 'description'&#13;
</code></pre>&#13;
    </div>&#13;
    <h2 id="_idParaDest-256" class="heading-2">Documenting a class with the Sphinx style</h2>&#13;
    <p class="normal">First of all, let’s look <a id="_idIndexMarker709"/>at the traditional style, the Sphinx style. While it’s easy to understand <a id="_idIndexMarker710"/>what all the parameters mean, it’s a bit verbose, which reduces the readability somewhat. Nonetheless, the meaning is immediately clear and it is definitely not a bad style to use:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">class</span><span class="hljs-class"> </span><span class="hljs-title">Eggs</span><span class="hljs-class">:</span>&#13;
    <span class="hljs-keyword">pass</span>&#13;
&#13;
<span class="hljs-keyword">class</span><span class="hljs-class"> </span><span class="hljs-title">Spam</span><span class="hljs-class">(</span><span class="hljs-built_in">object</span><span class="hljs-class">):</span>&#13;
    <span class="hljs-string">'''</span>&#13;
<span class="hljs-string">    The Spam object contains lots of spam</span>&#13;
<span class="hljs-string">    :param arg: The arg is used for ...</span>&#13;
<span class="hljs-string">    :type arg: str</span>&#13;
<span class="hljs-string">    :param '*args': The variable arguments are used for ...</span>&#13;
<span class="hljs-string">    :param '**kwargs': The keyword arguments are used for ...</span>&#13;
<span class="hljs-string">    :ivar arg: This is where we store arg</span>&#13;
<span class="hljs-string">    :vartype arg: str</span>&#13;
<span class="hljs-string">    '''</span>&#13;
&#13;
    <span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">__init__</span><span class="hljs-function">(</span><span class="hljs-params">self, arg: </span><span class="hljs-built_in">str</span><span class="hljs-params">, *args, **kwargs</span><span class="hljs-function">):</span>&#13;
        self.arg: <span class="hljs-built_in">str</span> = arg&#13;
&#13;
    <span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">eggs</span><span class="hljs-function">(</span><span class="hljs-params">self, number: </span><span class="hljs-built_in">int</span><span class="hljs-params">, cooked: </span><span class="hljs-built_in">bool</span><span class="hljs-function">) -&gt; Eggs:</span>&#13;
        <span class="hljs-string">'''We can't have spam without eggs, so here are the eggs</span>&#13;
&#13;
<span class="hljs-string">        :param number: The number of eggs to return</span>&#13;
<span class="hljs-string">        :type number: int</span>&#13;
<span class="hljs-string">        :param bool cooked: Should the eggs be cooked?</span>&#13;
<span class="hljs-string">        :raises: :class:'RuntimeError': Out of eggs</span>&#13;
&#13;
<span class="hljs-string">        :returns: A bunch of eggs</span>&#13;
<span class="hljs-string">        :rtype: Eggs</span>&#13;
<span class="hljs-string">        '''</span>&#13;
        <span class="hljs-keyword">pass</span>&#13;
</code></pre>&#13;
    <p class="normal">The output looks like this:</p>&#13;
    <figure class="mediaobject"><img src="Images/B15882_09_25.png" alt="" width="609" height="456"/></figure>&#13;
    <p class="packt_figref">Figure 9.25: The Sphinx style documentation</p>&#13;
    <p class="normal">This is a very <a id="_idIndexMarker711"/>useful output indeed, with documented<a id="_idIndexMarker712"/> functions, classes, and arguments. And, more importantly, the types are documented as well, resulting in a clickable link to the actual type. An added advantage of specifying the type is that many editors understand the documentation and will provide autocompletion based on the given types. </p>&#13;
    <p class="normal">You might have also noticed that we specified the variable types both as documentation and using type hinting. While this is technically not needed, they apply to different parts of the documentation. The types shown in the function itself are done through type hinting: <code class="inlineCode">eggs(number: int, cooked: bool) -&gt; 13_sphinx_style.Eggs</code>. The <code class="inlineCode">Parameters</code> and <code class="inlineCode">Return type</code> are specified through the <code class="inlineCode">:type</code> in the documentation.</p>&#13;
    <p class="normal">To explain what’s actually happening here, Sphinx has a few roles within the docstrings that offer hints as to what we are documenting.</p>&#13;
    <p class="normal">The <code class="inlineCode">param</code> role paired with a name sets the documentation for the parameter with that name. The <code class="inlineCode">type</code> role paired with a name tells Sphinx the data type of the parameter. Both the roles are optional and the parameter simply won’t have any added documentation if they are omitted, but the <code class="inlineCode">param</code> role is always required for any documentation to show. Simply adding the <code class="inlineCode">type</code> role without the <code class="inlineCode">param</code> role will result in no output whatsoever, so take note to always pair them.</p>&#13;
    <p class="normal">The <code class="inlineCode">returns</code> role is similar to the <code class="inlineCode">param</code> role with regards to documenting. While the <code class="inlineCode">param</code> role documents a parameter, the <code class="inlineCode">returns</code> role documents the returned object. They are slightly different, however. As opposed to the <code class="inlineCode">param</code> role, the <code class="inlineCode">returns</code> role is not dependent on the <code class="inlineCode">rtype</code> role, or vice versa. They both work independently of each other, making it possible to use either or both of the roles.</p>&#13;
    <p class="normal">The <code class="inlineCode">rtype</code>, as you<a id="_idIndexMarker713"/> can expect, tells Sphinx (and several editors) what <a id="_idIndexMarker714"/>type of object is returned from the function. With the introduction of type hinting, however, the <code class="inlineCode">rtype</code> role is pretty useless since you have an easier way of specifying the return type.</p>&#13;
    <h2 id="_idParaDest-257" class="heading-2">Documenting a class with the Google style</h2>&#13;
    <p class="normal">The Google style is <a id="_idIndexMarker715"/>just a more legible version of the Sphinx style <a id="_idIndexMarker716"/>documentation. It doesn’t actually support more or less, but it’s a lot more intuitive to use. Here’s the Google style version of the <code class="inlineCode">Spam</code> class:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">class</span><span class="hljs-class"> </span><span class="hljs-title">Eggs</span><span class="hljs-class">:</span>&#13;
    <span class="hljs-keyword">pass</span>&#13;
&#13;
<span class="hljs-keyword">class</span><span class="hljs-class"> </span><span class="hljs-title">Spam</span><span class="hljs-class">(</span><span class="hljs-built_in">object</span><span class="hljs-class">):</span>&#13;
    <span class="hljs-string">r'''</span>&#13;
<span class="hljs-string">    The Spam object contains lots of spam</span>&#13;
<span class="hljs-string">    Args:</span>&#13;
<span class="hljs-string">        arg: The arg is used for ...</span>&#13;
<span class="hljs-string">        \*args: The variable arguments are used for ...</span>&#13;
<span class="hljs-string">        \*\*kwargs: The keyword arguments are used for ...</span>&#13;
<span class="hljs-string">    Attributes:</span>&#13;
<span class="hljs-string">        arg: This is where we store arg,</span>&#13;
<span class="hljs-string">    '''</span>&#13;
&#13;
    <span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">__init__</span><span class="hljs-function">(</span><span class="hljs-params">self, arg: </span><span class="hljs-built_in">str</span><span class="hljs-params">, *args, **kwargs</span><span class="hljs-function">):</span>&#13;
        self.arg: <span class="hljs-built_in">str</span> = arg&#13;
&#13;
    <span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">eggs</span><span class="hljs-function">(</span><span class="hljs-params">self, number: </span><span class="hljs-built_in">int</span><span class="hljs-params">, cooked: </span><span class="hljs-built_in">bool</span><span class="hljs-function">) -&gt; Eggs:</span>&#13;
        <span class="hljs-string">'''We can't have spam without eggs, so here are the eggs</span>&#13;
&#13;
<span class="hljs-string">        Args:</span>&#13;
<span class="hljs-string">            number (int): The number of eggs to return</span>&#13;
<span class="hljs-string">            cooked (bool): Should the eggs be cooked?</span>&#13;
&#13;
<span class="hljs-string">        Raises:</span>&#13;
<span class="hljs-string">            RuntimeError: Out of eggs</span>&#13;
&#13;
<span class="hljs-string">        Returns:</span>&#13;
<span class="hljs-string">            Eggs: A bunch of eggs</span>&#13;
<span class="hljs-string">        '''</span>&#13;
        <span class="hljs-keyword">pass</span>&#13;
</code></pre>&#13;
    <p class="normal">This is easier on the <a id="_idIndexMarker717"/>eyes than the Sphinx style and has the same<a id="_idIndexMarker718"/> number of possibilities. For longer argument documentation, it’s less than convenient though. Just imagine how a multiline description of <code class="inlineCode">number</code> would look. That is why the NumPy style was developed, providing a lot of documentation for its arguments.</p>&#13;
    <h2 id="_idParaDest-258" class="heading-2">Documenting a class with the NumPy style</h2>&#13;
    <p class="normal">The NumPy style is <a id="_idIndexMarker719"/>meant for having a lot of documentation. Honestly, most<a id="_idIndexMarker720"/> people are too lazy for that, so for most projects it would not be a good fit. If you do plan to have extensive documentation of your functions and all their parameters, the NumPy style might be a good option for you. It’s a bit more verbose than the Google style, but it’s very legible, especially with more detailed documentation. The following is the NumPy version of the <code class="inlineCode">Spam</code> class:</p>&#13;
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">class</span><span class="hljs-class"> </span><span class="hljs-title">Eggs</span><span class="hljs-class">:</span>&#13;
    <span class="hljs-keyword">pass</span>&#13;
&#13;
<span class="hljs-keyword">class</span><span class="hljs-class"> </span><span class="hljs-title">Spam</span><span class="hljs-class">(</span><span class="hljs-built_in">object</span><span class="hljs-class">):</span>&#13;
    <span class="hljs-string">r'''</span>&#13;
<span class="hljs-string">    The Spam object contains lots of spam</span>&#13;
<span class="hljs-string">    Parameters</span>&#13;
<span class="hljs-string">    ----------</span>&#13;
<span class="hljs-string">    arg : str</span>&#13;
<span class="hljs-string">        The arg is used for ...</span>&#13;
<span class="hljs-string">    \*args</span>&#13;
<span class="hljs-string">        The variable arguments are used for ...</span>&#13;
<span class="hljs-string">    \*\*kwargs</span>&#13;
<span class="hljs-string">        The keyword arguments are used for ...</span>&#13;
<span class="hljs-string">    Attributes</span>&#13;
<span class="hljs-string">    ----------</span>&#13;
<span class="hljs-string">    arg : str</span>&#13;
<span class="hljs-string">        This is where we store arg,</span>&#13;
<span class="hljs-string">    '''</span>&#13;
&#13;
    <span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">__init__</span><span class="hljs-function">(</span><span class="hljs-params">self, arg, *args, **kwargs</span><span class="hljs-function">):</span>&#13;
        self.arg = arg&#13;
&#13;
    <span class="hljs-keyword">def</span><span class="hljs-function"> </span><span class="hljs-title">eggs</span><span class="hljs-function">(</span><span class="hljs-params">self, number, cooked</span><span class="hljs-function">):</span>&#13;
        <span class="hljs-string">'''We can't have spam without eggs, so here are the eggs</span>&#13;
&#13;
<span class="hljs-string">        Parameters</span>&#13;
<span class="hljs-string">        ----------</span>&#13;
<span class="hljs-string">        number : int</span>&#13;
<span class="hljs-string">            The number of eggs to return</span>&#13;
<span class="hljs-string">        cooked : bool</span>&#13;
<span class="hljs-string">            Should the eggs be cooked?</span>&#13;
&#13;
<span class="hljs-string">        Raises</span>&#13;
<span class="hljs-string">        ------</span>&#13;
<span class="hljs-string">        RuntimeError</span>&#13;
<span class="hljs-string">            Out of eggs</span>&#13;
&#13;
<span class="hljs-string">        Returns</span>&#13;
<span class="hljs-string">        -------</span>&#13;
<span class="hljs-string">        Eggs</span>&#13;
<span class="hljs-string">            A bunch of eggs</span>&#13;
<span class="hljs-string">        '''</span>&#13;
        <span class="hljs-keyword">pass</span>&#13;
</code></pre>&#13;
    <p class="normal">While the NumPy <a id="_idIndexMarker721"/>style definitely isn’t bad, it’s just very verbose. This <a id="_idIndexMarker722"/>example alone is about 1.5 times as long as the alternatives. So, for longer and more detailed documentation it’s a very good choice, but if you’re planning to have short documentation anyhow, just use the Google style instead.</p>&#13;
    <h2 id="_idParaDest-259" class="heading-2">Which style to choose</h2>&#13;
    <p class="normal">For most projects, the Google style is the best choice since it is readable but not too verbose. If you are planning to use large amounts of documentation per parameter, then the NumPy style might be a good option as well.</p>&#13;
    <p class="normal">The only reason for choosing the Sphinx style is legacy. Even though the Google style might be more legible, consistency is more important.</p>&#13;
    <h1 id="_idParaDest-260" class="heading-1">Exercises</h1>&#13;
    <p class="normal">To practice a little with Python type hinting, it would be good to add some of this documentation to your own projects.</p>&#13;
    <p class="normal">Some examples of less trivial type hints would be:</p>&#13;
    <ul>&#13;
      <li class="bulletList">Dictionaries</li>&#13;
      <li class="bulletList">Nested or even recursive types</li>&#13;
      <li class="bulletList">Generating stubs for documenting external projects that don’t have type hinting</li>&#13;
    </ul>&#13;
    <div class="note">&#13;
      <p class="normal">Example answers for these exercises can be found on GitHub: <a href="Chapter_9.xhtml"><span class="url">https://github.com/mastering-python/exercises</span></a>. You are encouraged to submit your own solutions and learn about alternative solutions from others.</p>&#13;
    </div>&#13;
    <h1 id="_idParaDest-261" class="heading-1">Summary</h1>&#13;
    <p class="normal">In this chapter, you have learned how to add, use, and test type hinting in your code using both the built-in types and your own custom types. You learned how to write Markdown and reStructuredText to document your projects and your code itself. Lastly, you learned how to use the Sphinx documentation generator to generate fully functioning documentation for your projects.</p>&#13;
    <p class="normal">Documentation can help greatly in a project’s popularity, and bad documentation can kill productivity. I think there are few aspects of a library that have more impact on the usage by third parties than documentation. Thus, in many cases, documentation is a more important factor in deciding the usage of a project than the actual code quality. That’s why it is very important to always try to have good documentation available. Sphinx is a great help in this case because it makes it much easier to keep your documentation up to date and matching your code. The only thing worse than no documentation is incorrect and/or out-of-date documentation.</p>&#13;
    <p class="normal">With Sphinx, it is easy to generate documentation. With just a few minutes of your time, you can have a fully functioning website with documentation available, or a PDF, or ePub, or one of the many other output formats. There really is no excuse for having no documentation anymore. And even if you don’t use the documentation that much yourself, offering type hints to your editor can help a lot with productivity as well. Making your editor smarter should always help with productivity. I, for one, have added type hints to several external projects simply to increase my productivity.</p>&#13;
    <p class="normal">The next chapter will explain how code can be tested in Python and some part of the documentation will return there. Using <code class="inlineCode">doctest</code>, it is possible to have example code, documentation, and tests in one.</p>&#13;
    <h1 class="heading-1">Join our community on Discord</h1>&#13;
    <p class="normal">Join our community’s Discord space for discussions with the author and other readers: <a href="https://discord.gg/QMzJenHuJf"><span class="url">https://discord.gg/QMzJenHuJf</span></a></p>&#13;
    <p class="normal"><img src="Images/QR_Code156081100001293319171.png" alt="" width="177" height="177"/></p>&#13;
  </div>&#13;
</div></body></html>