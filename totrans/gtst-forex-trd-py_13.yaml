- en: '13'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To Trade or Not to Trade – Performance Analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In the previous chapter, we developed a simple trend-following strategy, ran
    a backtest, and generated our first equity curve (a visual representation of the
    strategy’s profits and losses over time). Intuitively, we already know that equity
    curves of profitable strategies should grow over time, and the steeper the growth,
    the better. At first glance, our strategy looks fit to this requirement, but of
    course, it would be better to be able to base our opinions on facts and not just
    emotions. So, we would like to have a quantitative metric that could be used as
    an indicator: if its value is greater than something, then the strategy is good.
    If it’s less, then the strategy is not good.'
  prefs: []
  type: TYPE_NORMAL
- en: 'As you might have already guessed, such a single, universal metric does not
    exist. A trading strategy is quite a complex structure, even if its logic seems
    simplistic, and its performance should be analyzed from different standpoints.
    We are interested in knowing not only how much money a particular strategy could
    make but also how much we should put at stake as risk capital in order to achieve
    such a gain. Similarly, not only the overall net profit but also how profits (and
    losses!) are distributed over time matters. Ultimately, we want to be sure that
    the strategy is indeed tradable: that trades placed in the real market will be
    more or less similar to those emulated during the backtest.'
  prefs: []
  type: TYPE_NORMAL
- en: 'This chapter is very far from an ultimate guide on trading strategy performance
    analysis: this subject is so vast that it would require a separate book, if not
    multiple books. Here, we are going to consider the most essential metrics and
    see how they help assess a strategy’s performance and make our main decision –
    whether to give this strategy a try or set it aside.'
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, you will learn about the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Trade analysis
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Average trade and trading costs
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Measuring performance – alpha and beta revisited
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Net profit versus buy and hold
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Drawdown
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The power of leverage – or how much do I need to trade it?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Trade analysis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As you remember, the difference between trading and investing is, broadly speaking,
    the number of trades. If you buy and hold a position in an asset for 1 year or
    more, then it’s an investment. If you buy, sell, and buy the same asset or different
    assets again multiple times during the same year, it’s trading.
  prefs: []
  type: TYPE_NORMAL
- en: Why a year?
  prefs: []
  type: TYPE_NORMAL
- en: According to most tax laws, holding a position for 1 year and 1 day qualifies
    it as an investment, and any profit resulting from this activity is taxed at a
    discounted rate. If you held the position even for 1 day less than 1 year, it
    will be considered trading and the resulting profit will be taxed at a full income
    tax rate. This rule is applicable mostly to equities trading, but at least it
    makes sense to use 1 year as a reference term.
  prefs: []
  type: TYPE_NORMAL
- en: So, the strategy is actively opening and closing positions during a given period.
    Regardless of the total net profit (or loss) for the entire period, first, and
    above all, we are interested in how much each trade contributes to the overall
    result – at least on average.
  prefs: []
  type: TYPE_NORMAL
- en: Average trade and trading costs
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Average trade is one of the most essential yet simplistic metrics: it’s just
    the ratio of the total net profit achieved by a strategy to the total number of
    trades:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_B19145_13_001.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Why do we need this value?
  prefs: []
  type: TYPE_NORMAL
- en: To answer this question, we should recall a few things from theory again.
  prefs: []
  type: TYPE_NORMAL
- en: In [*Chapter 3*](B19145_03.xhtml#_idTextAnchor044), *FX Market Overview from
    a Developer’s Standpoint*, we considered how markets are organized and learned
    that there is always a difference between the price at which we can buy and at
    which we can sell – the spread. Regardless of the type of orders used in the strategy,
    the market price must move for the distance of the spread *at the very least*,
    only to move the newly opened position from a negative zone to break even.
  prefs: []
  type: TYPE_NORMAL
- en: 'Besides that, don’t forget the various issues with liquidity and order execution
    that were considered in [*Chapter 10*](B19145_10.xhtml#_idTextAnchor171), *Types
    of Orders and Their Simulation in Python*. If the strategy uses market orders,
    it may encounter slippage, partial fills, or rejects (depending on the TIF specification,
    see the *Time in force: better control over execution* section in the same chapter).
    In any case, it’s just another cost of trading that should be covered by the strategy.'
  prefs: []
  type: TYPE_NORMAL
- en: Finally, don’t forget that the broker and the trading venue will charge commissions,
    and this cost should also be absorbed by the trading strategy.
  prefs: []
  type: TYPE_NORMAL
- en: So, the average trade value should be greater than the sum of the spread, typical
    slippage, and broker and/or trading venue commissions. Only in this case can the
    strategy make money in the real market.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s now look at real figures, based on the performance of the strategy that
    we developed in the previous chapter. In order to obtain the necessary values,
    let’s add a few lines to the strategy code. First, we will add a `list_of_orders`
    property to the `tradingSystemMetadata` class – here, we will save all executed
    orders. Next, in the `processOrders()` function, we will add the following statement
    right after the `if order[''Status''] == ''``Executed'':` line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'And finally, at the very end of the backtester’s code, right after `plt.plot(System.equity_timeseries)`
    (see the *Backtesting platform with historical data feed* section of [*Chapter
    11*](B19145_11.xhtml#_idTextAnchor186), *Backtesting and* *Theoretical Performance*):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: If you run the backtesting now again with the same data (AUD/USD daily), you
    should get 37 total trades and an average trade value of about 79.41.
  prefs: []
  type: TYPE_NORMAL
- en: Is that good or bad?
  prefs: []
  type: TYPE_NORMAL
- en: Regarding the number of trades, generally speaking, the greater the number,
    the better. Why? Because all metrics used to assess the strategy performance are
    based on statistics, and statistics work best if the size of the dataset is significant.
    I am not going to go into details about the exact meaning of *significant* in
    this sense, as it’s too complex a subject, but for simplicity’s sake, let’s take
    it for granted that we need at least 20-30 data points so that statistical metrics
    start making sense. From this standpoint, 37 trades look satisfactory.
  prefs: []
  type: TYPE_NORMAL
- en: Now the average trade itself. Its value is 79.41, but in which units? Dollars?
    Australian dollars? Maybe something else?
  prefs: []
  type: TYPE_NORMAL
- en: 'Here, we should recall that spot FX is always traded on margin (see the *Trade
    mechanics: again some terminology* section of [*Chapter 3*](B19145_03.xhtml#_idTextAnchor044),
    *FX Market Overview from a Developer’s Standpoint*) and that the value of 1 pip
    in money depends on the trading size. In the *Trading application with live data
    feed* section of [*Chapter 11*](B19145_11.xhtml#_idTextAnchor186), *Backtesting
    and Theoretical Performance*, we already pointed out that for backtesting, we
    may want to use a trading size that will make 1 pip equal to $1\. This is why
    we chose a trading size of 10,000 for the backtest and now we can interpret the
    average trade as *79.41 pips*. Then, we can finally decide whether it’s sufficient
    or not.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s sum up all trading costs that we mentioned here: spread, slippage, and
    commission.'
  prefs: []
  type: TYPE_NORMAL
- en: Spread
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Spreads depend on the liquidity provider or the broker (the latter often add
    their own fees into the spread, such a practice is called **markup**), and also
    on the time of day. An industry average spread for AUD/USD today is between 0.5
    and 2 pips with rare increases to 5 and more, typically before economic news.
    So, it would be safe to suppose that we should subtract 1 pip from the average
    trade value to account for the market spread during a somewhat less liquid time
    (remember that our strategy places orders at midnight, when liquidity is thinner
    than during regular work hours).
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: If you use the unmodified `emulateBrokerExecution` function in the backtester
    code, then a spread of 0.5 pips is already included there. You can modify it every
    time you run a new strategy with a new currency pair, or remove it completely
    and subtract the spread from the resulting average trade.
  prefs: []
  type: TYPE_NORMAL
- en: Slippage
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Slippage mostly depends on the trading size and liquidity in the order book.
    If the sizes of your orders never exceed top-of-book liquidity, then in the absolute
    majority of cases, the slippage would be zero. To get a more precise estimate,
    we need to analyze the top-of-book data at the time of the trade. If you trade
    with a retail broker, then you may have a hard time getting order book data –
    normally, brokers do not publish it. If you use a broker as an STP to get access
    directly to a trading venue, then you will get at least top-of-book data with
    volumes. Let’s do an estimate using LMAX data.
  prefs: []
  type: TYPE_NORMAL
- en: Our strategy places trades only at end of the day, which is midnight (New York
    time, EST/EDT). This is not the most liquid time, but on average, we can see 50,000
    to 200,000 AUD at the top of the book at that time. So, if your order size doesn’t
    exceed 50,000 AUD, then you can safely assume that slippage will be negligible.
    However, if your order size exceeds 50,000 AUD, then most likely you will experience
    slippage of up to 1 pip – depending on the actual trading volume. If the trading
    size exceeds 500,000 AUD, then the slippage may increase to 2 pips and even more.
  prefs: []
  type: TYPE_NORMAL
- en: Which estimate should we use? How can you know which trading size you’re going
    to use?
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s again recall that the FX markets are traded on margin. This means that
    you don’t need to have the entire amount of money in the broker account to open
    a position: the broker will provide you with a credit line according to the leverage
    available according to your status: retail or professional. If you’re a retail
    trader, then most likely you will get a 30:1 leverage. If you’re a professional
    trader, then higher leverage such as 100:1 is available. However, as you will
    see later in this chapter (see the *The power of leverage – how much do I need
    to trade it?* section), it is highly unlikely that you’re going to use a leverage
    greater than 10:1\. Most likely, it is going to be somewhere in the vicinity of
    2:1-5:1\. In our example, in order to open a position of 200,000 AUD/USD with
    a leverage of 10:1, you will need approximately the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_B19145_13_002.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 0.6918 is the average rate of AUD/USD for the last 52 weeks (a work year). In
    reality, you will need a bit more because the open position should be able to
    withstand a drawdown (see below in this chapter), but in essence, an estimate
    of about $15,000 seems adequate. Without any intention to count money in your
    pocket, let me suppose that if you’re a retail trader, then you will hardly open
    positions with a size greater than 200,000 AUD, so it is safe to suppose that
    a slippage of 1 pip would provide a sufficient overhead for our estimate.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: The main idea behind all our estimates is to suppose a theoretical worst scenario,
    something that probably won’t be realized in real trading. If the strategy is
    still able to make money on paper after we have accounted for all possible negative
    impacts, then it is probable that it’s going to make money in real life.
  prefs: []
  type: TYPE_NORMAL
- en: However, if you work with a financial institution, then most likely the average
    order size can be multiplied at least 10 times, so slippage starts to play quite
    an important role. I’d suggest subtracting at least 1 pip per 100,000 in the order
    size to account for slippage in case trades are placed during an illiquid time
    such as at night.
  prefs: []
  type: TYPE_NORMAL
- en: Trading size, slippage, and execution
  prefs: []
  type: TYPE_NORMAL
- en: In real life, orders whose size exceeds the top of the book are seldom sent
    directly to the market as market orders to avoid execution at unwanted prices.
    If you really need to fill a large order, consider rewriting the `processOrders()`
    function, splitting a large order into parts, and executing them one by one.
  prefs: []
  type: TYPE_NORMAL
- en: Commission
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The last part of trading costs seems to be the commission. Typically, a trading
    venue charges about 25-40 **dollars per million** (**DPM**). How do we recalculate
    it into dollar value for our trades?
  prefs: []
  type: TYPE_NORMAL
- en: The trading size used in the backtest is 10,000 AUD/USD. This means we buy or
    sell 10,000 Australian dollars or (using an average rate of AUD/USD of about 0.6920)
    approximately 7000 US dollars. With a rate of 30 DPM, the broker commission would
    be around $0.21\. Now, if we recall that in our backtest $1 equals 1 pip, we can
    say that the commission makes about 0.21 pips.
  prefs: []
  type: TYPE_NORMAL
- en: So far, we calculated a realistic estimate for the spread, slippage, and broker
    commission. Is this all we should account for?
  prefs: []
  type: TYPE_NORMAL
- en: 'No, there is another cost that is very frequently forgotten by many traders:
    overnight swaps.'
  prefs: []
  type: TYPE_NORMAL
- en: Overnight swaps
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In the *Economic news* section of [*Chapter 6*](B19145_06.xhtml#_idTextAnchor101),
    *Basics of Fundamental Analysis and Its Possible Use in FX Trading*, we already
    mentioned one of the most peculiar features of the FX market: the difference in
    interest rates between the two currencies in a pair. This difference may be positive
    and may be negative: for example, if the interest rate of the British pound is
    5% per annum and the interest rate of the Japanese yen is 0% per annum, then the
    difference for GBP/JPY is positive (5%) and the difference for JPY/GBP is negative
    (-5%).'
  prefs: []
  type: TYPE_NORMAL
- en: Once you hold an open position overnight (past the NY bank settlement time),
    you either receive interest (if the difference is positive) or pay the interest
    (if the difference is negative). In our example, if you buy GBP/JPY (or sell JPY/GBP,
    which is the same), then you receive interest, and if you sell GBP/JPY or buy
    JPY/GBP, then you pay interest.
  prefs: []
  type: TYPE_NORMAL
- en: With our present strategy, we hold AUD/USD for multiple days, sometimes long,
    sometimes short, so we may receive or pay the interest depending on the side of
    the position and the current difference in interest rates.
  prefs: []
  type: TYPE_NORMAL
- en: We have to account for these overnight fees, frequently referred to as **swaps**.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: Do not confuse swaps with financial instruments, which we discussed in the *FX
    instruments* section in [*Chapter 3*](B19145_03.xhtml#_idTextAnchor044), *FX Market
    Overview from a* *Developer’s Standpoint*.
  prefs: []
  type: TYPE_NORMAL
- en: 'However, it is surprisingly quite a non-trivial task. There are two problems
    here:'
  prefs: []
  type: TYPE_NORMAL
- en: First, these swap rates change over time because they are based on the interest
    rates set by central banks (usually referred to as the base rate) and these rates
    also change. So, we need historical data for base rates at the very least.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Second, each broker adds their own premium, or markup, to the base rate, and,
    in most cases, this premium is publicly unknown. Given that brokers do not store
    historical data for their overnight swap rates, it becomes problematic to reliably
    restore the history of interest rates differential in a currency pair.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Nevertheless, we can make an attempt. First, we need historical interest rate
    data. It’s a bit less widespread than historical market data, but there are a
    few resources that provide it free of charge – for example, [Global-rates.com](https://Global-rates.com).
    Go to [https://www.global-rates.com/en/interest-rates/central-banks/central-banks.aspx](https://www.global-rates.com/en/interest-rates/central-banks/central-banks.aspx)
    and there you will find links to the Federal Reserve and the Reserve Bank of Australia
    interest rate data.
  prefs: []
  type: TYPE_NORMAL
- en: 'As you can see, the data changes quite infrequently, no more than once a month
    – because decisions on interest rates are made by a special central bank committee
    and normally they have monthly meetings. We don’t need to be absolutely precise
    in our calculations: in the long run, the overnight swap is going to be just a
    fraction of a pip, so it’s sufficient to sync data for up to a month. I copied
    the data into an Excel sheet and here’s what I got:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **RBA** |  | **FED** |  | **Rates difference** |'
  prefs: []
  type: TYPE_TB
- en: '| 12/06/22 | 3.10% | 12/14/22 | 4.50% | -1.40% |'
  prefs: []
  type: TYPE_TB
- en: '| 11/01/22 | 2.85% | 11/02/22 | 4.00% | -1.15% |'
  prefs: []
  type: TYPE_TB
- en: '| 10/04/22 | 2.60% |  | 3.25% | -0.65% |'
  prefs: []
  type: TYPE_TB
- en: '| 09/06/22 | 2.35% | 09/21/22 | 3.25% | -0.90% |'
  prefs: []
  type: TYPE_TB
- en: '| 08/02/22 | 1.85% | 07/28/22 | 2.50% | -0.65% |'
  prefs: []
  type: TYPE_TB
- en: '| 07/06/22 | 1.35% | 06/15/22 | 1.75% | -0.40% |'
  prefs: []
  type: TYPE_TB
- en: '| 06/07/22 | 0.85% | 05/04/22 | 1.00% | -0.15% |'
  prefs: []
  type: TYPE_TB
- en: '| 05/03/22 | 0.35% | 03/16/22 | 0.50% | -0.15% |'
  prefs: []
  type: TYPE_TB
- en: '| 11/03/20 | 0.10% | 03/15/20 | 0.25% | -0.15% |'
  prefs: []
  type: TYPE_TB
- en: '| 03/19/20 | 0.25% | 03/03/20 | 1.25% | -1.00% |'
  prefs: []
  type: TYPE_TB
- en: Table 13.1 – Historical central banks’ interest rates for RBA and the Fed
  prefs: []
  type: TYPE_NORMAL
- en: If we subtract the former from the latter, we will get the difference in interest
    rates for the AUD/USD currency pair. We can see that it changes from as low as
    0.15% to 1.4%. Now, the question is how much it means in money.
  prefs: []
  type: TYPE_NORMAL
- en: 'To calculate that, we should first recall that a year has 365 days and then
    we should divide the value in the last column of the table by 365\. Let’s do it
    with the latest value:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_B19145_13_003.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Next, we should multiply the daily interest by the trading size. In our example,
    we trade 10,000 AUD, so we multiply the daily interest by 10,000\. Finally, if
    we want to know the swap value in USD, not AUD, we should multiply the result
    by the actual exchange rate, that is, the market price of AUD/USD.
  prefs: []
  type: TYPE_NORMAL
- en: 'I think here it’s become obvious that swap rates change not only because central
    banks change their interest rates but also because the market price of the currency
    pair changes. For our rough estimate, we may use the 52-week average of the spot
    price, and thus multiply the final result by 0.68\. Thus, in our example, we get:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_B19145_13_004.jpg)'
  prefs: []
  type: TYPE_IMG
- en: How do we interpret this result?
  prefs: []
  type: TYPE_NORMAL
- en: 'This result means that if we buy 10,000 AUD/USD and hold this position overnight,
    then we pay 26 cents. Looks negligible, but only because a trading size of 10,000
    is quite small: don’t forget that the FX market is traded on margin, and even
    with a retail leverage of 30:1, you need only $300 in the account to be able to
    open a position of $10,000\. Quite often, retail trades are placed with 100,000
    of base currency and institutional trades normally *start* with 1,000,000\. If
    you hold a position of 100,000 overnight, you pay $2.6 – not much, but if you
    do it every night, then it gradually grows into a considerable amount. And if
    you trade as an institutional trader, then you start paying $26 every night, averaging
    $130 a week, and so on.'
  prefs: []
  type: TYPE_NORMAL
- en: Alright, I hear you saying, *“it’s clear that we pay when we are long AUD/USD,
    but if we’re short, we should receive an equivalent amount every night,* *shouldn’t
    we?”*
  prefs: []
  type: TYPE_NORMAL
- en: 'Unfortunately, real life is (as always) more complicated than any theory. The
    issue is that every broker adds their own markup to the overnight rate. There’s
    no surprise in it: brokers also have to borrow to provide you with a credit line,
    and they can’t borrow directly from a central bank, so for them, the interest
    rate will already be higher. This means that the negative values become even more
    negative, and positive values become... well, in most cases also negative! I encourage
    you to check the overnight swap rates with any broker, compare them with our calculated
    *fair values*, and see the difference. In reality, as of today (at the beginning
    of January 2023), the best overnight swap rate I could find was -$5.30 for a long
    position and -$0.30 for a short one for a trading size of 100,000 AUD/USD.'
  prefs: []
  type: TYPE_NORMAL
- en: Also, keep in mind that on Wednesday, you will be charged extra because we trade
    spot, and the spot is delivered on a T+2 basis (again, see the *FX instruments*
    section of [*Chapter 3*](B19145_03.xhtml#_idTextAnchor044), *FX Market Overview
    From a* *Developer’s Standpoint*).
  prefs: []
  type: TYPE_NORMAL
- en: We can use an estimate that in the absolutely worst case, we pay about 0.5 pips
    for the luxury of holding the position overnight. Pips – because, I hope, you
    remember that using a trading size of 10,000 AUD/USD allows us to interpret the
    result both in dollars and pips, which is very convenient for further calculations.
  prefs: []
  type: TYPE_NORMAL
- en: And now! Finally! Let’s sum up all costs we’ve discussed so far.
  prefs: []
  type: TYPE_NORMAL
- en: Trading Costs Calculation
  prefs: []
  type: TYPE_NORMAL
- en: Total trading costs per trade = 1 pip spread + 1 pip slippage + 0.21 pips commission
    + 0.5 pips overnight swap * 20 days in position on average = 2.71 pips.
  prefs: []
  type: TYPE_NORMAL
- en: This is what we must subtract from the average trade, and if the remainder is
    still positive, then our strategy can make money, at least on paper.
  prefs: []
  type: TYPE_NORMAL
- en: Obviously, now we can see that an average trade of 79 pips is huge because all
    the costs, even taken with excess, hardly make 15% of the expected return. This
    is a truly great result, and it’s achievable only for long-term trading strategies.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: 'There is a strong relationship between the strategy’s position in the market,
    the average trade value for such a strategy, and the volatility of its returns:
    the longer we stay in a position, the greater the average trade we can expect
    and, unfortunately, the volatility of returns for such a strategy will also be
    greater. This fact can even be proven mathematically as a theorem, but it lies
    way beyond the scope of this book, so I suggest taking it for granted – for now.'
  prefs: []
  type: TYPE_NORMAL
- en: All in all, the trading costs analysis shows that our strategy is very robust
    in this regard (and believe me, most strategies you will develop yourself in the
    future won’t pass even this first test – but it’s normal for research and development).
    What’s next?
  prefs: []
  type: TYPE_NORMAL
- en: Next, we have to revisit a couple of concepts that we already mentioned earlier
    in the book.
  prefs: []
  type: TYPE_NORMAL
- en: Measuring performance – alpha and beta revisited
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In [*Chapter 9*](B19145_09.xhtml#_idTextAnchor152), *Trading Strategies and
    Their Core Elements*, we touched on two important concepts that are mainly used
    to analyze performance: alpha and beta. Back then, we looked at them from a slightly
    different angle: we were in search of opportunities to systematically make profits
    in the market and considered all these metrics only from that standpoint. However,
    don’t forget that they were originally suggested for evaluating the performance
    of an investment – if put in simple words, to judge whether the investment outperforms
    or *beats* the market or not.'
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: I will intentionally simplify the concepts of both alpha and beta and avoid
    exact mathematical formulae for their calculation. Using them requires good command
    of the theory of probabilities, and I know from my past experience that it’s the
    very domain of mathematics that causes a lot of confusion to many readers. So
    forgive me, math purists, but I just want these relatively complex subjects to
    be understood by everyone.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s start with alpha as the more common and simplistic metric.
  prefs: []
  type: TYPE_NORMAL
- en: Alpha in investment and trading
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Alpha stands for excess returns; this is the very metric that ultimately says
    whether you beat the market within the given time span.
  prefs: []
  type: TYPE_NORMAL
- en: 'Normally, in capital management, alpha is calculated according to the following
    formula:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_B19145_13_005.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Here, R means the return of a portfolio, ![](img/Formula_B19145_13_006.png)
    denotes the so-called *risk-free* rate of return, ![](img/Formula_B19145_13_007.png)
    represents the return of the benchmark, and ![](img/Formula_B19145_13_008.png)
    represents the volatility of returns (see the following).
  prefs: []
  type: TYPE_NORMAL
- en: Sounds complex?
  prefs: []
  type: TYPE_NORMAL
- en: Well, it’s not as complex as it seems at first glance. We only need to understand
    the meaning of each element of this equation better.
  prefs: []
  type: TYPE_NORMAL
- en: Return, in general, refers to how much money was gained (or lost) per given
    period of time. Normally, in portfolio investment, returns are estimated by month
    and by year, in active trading, we also consider daily returns – in some cases,
    even more granular time frames.
  prefs: []
  type: TYPE_NORMAL
- en: It should be intuitively clear with the return of an investment or a trading
    strategy, but what is a *risk-free* rate of return? How anything in trading or
    investing can be risk-free?
  prefs: []
  type: TYPE_NORMAL
- en: Usually, a risk-free return is understood as the difference between the current
    respective bond yield and the inflation rate. For investments in the United States
    and denominated in US dollars, we can use Treasury bonds. For investments in the
    Eurozone and denominated in the euro, usually, German bonds are considered a *risk-free*
    investment, and so on.
  prefs: []
  type: TYPE_NORMAL
- en: And now we again see a *benchmark*. As we discussed in the *Using currency rates
    as benchmark* section of [*Chapter 9*](B19145_09.xhtml#_idTextAnchor152), *Trading
    Strategies and Their Core Elements*, finding a proper benchmark for FX trading
    can be quite problematic. Therefore, we normally use the change in the price of
    the currency pair itself to see whether our strategy could do it any better than
    the market.
  prefs: []
  type: TYPE_NORMAL
- en: 'If we want to illustrate all of this as simplistically as possible, we could
    use a linear model of both the market growth and returns with an assumption that
    ![](img/Formula_B19145_13_009.png) = 0 (no free lunch ever, right?) and ![](img/Formula_B19145_13_010.png)
    = 1 (the volatility of returns is exactly the same as the volatility of the market
    itself). If the *x*-axis represents time, for example, days, and the *y*-axis
    represents the return, then alpha happens to be the difference between the values
    of the two functions:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.1 – Simplified model of returns and alpha](img/B19145_13_01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.1 – Simplified model of returns and alpha
  prefs: []
  type: TYPE_NORMAL
- en: 'To make the story about alpha complete, I should note that sometimes, especially
    analyzing the performance of active trading strategies rather than investment,
    alpha is supposed to be derived from the classical form of a linear equation:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_B19145_13_011.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'As in our previous example, this is a very, very simplified model that shows
    how returns grow over time. If we assume that the market itself grows linearly
    and its growth rate is equal to 1 (y = x), then any ![](img/Formula_B19145_13_012.png)
    > 1 would mean that the investment’s returns grow faster than the market and that
    the investment actually beats the market. Similarly, any ![](img/Formula_B19145_13_013.png)<
    1 would mean that the investment’s returns grow slower than the market itself.
    In this case, even if this investment brings some money to an account, it does
    not beat the market: you can potentially make more by simply buying the market
    itself (stocks, commodities, and even currencies can constitute the respective
    market benchmark). This simple assumption is shown in the following figure:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B19145_13_02.png)Figure 13.2 – Linear functions with ![](img/Formula_B19145_13_014.png)
    = 1, ![](img/Formula_B19145_13_015.png) > 1, and ![](img/Formula_B19145_13_016.png)
    < 1'
  prefs: []
  type: TYPE_NORMAL
- en: The benchmark (the market) is assumed to grow at a rate of ![](img/Formula_B19145_13_017.png)
    = 1 (black line). Any function with ![](img/Formula_B19145_13_017.png) > 1 (in
    our example ![](img/Formula_B19145_13_019.png) = 2) will grow faster, and any
    function with ![](img/Formula_B19145_13_020.png) < 1 (![](img/Formula_B19145_13_021.png)
    = 0.5 in our example) will grow slower than the benchmark.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: Such an interpretation of alpha is not common and cannot be used in classical
    capital management theory. I provided this unusual point of view only for your
    reference.
  prefs: []
  type: TYPE_NORMAL
- en: Now, I hope it’s more or less clear with alpha in all its aspects, but what
    about beta?
  prefs: []
  type: TYPE_NORMAL
- en: Beta
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Beta is a measure of the volatility of returns. Remember the analogy of a road
    trip that we discussed in the *Beta – earn on volatility* section of [*Chapter
    9*](B19145_09.xhtml#_idTextAnchor152), *Trading Strategies and Their Core Elements*?
    Not only the fact that we were able to get from point A to point B matters but
    also how we got there, so how straight or winding the path was. If we want to
    illustrate this comparison, we can again use a linear function as the example
    of a straight path and the same linear function with a periodical component added
    to it as the example of a path with extra volatility:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.3 – Linear function with and without added volatility](img/B19145_13_03.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.3 – Linear function with and without added volatility
  prefs: []
  type: TYPE_NORMAL
- en: We can see that both functions *get* from point **(0,0)** to **(2,2)**, but
    the linear one does it *faster*. Now, let’s imagine that both graphs illustrate
    the return on a certain investment. Then, the *x*-axis means time and the *y*-axis
    means the amount of money earned or lost during a certain period. Therefore, when
    we see that the curve is growing, this means that money is accumulating in the
    account, and when we see it going down, this means that the account is losing
    money.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, let’s take periodical snapshots of the activity in our sample investments
    and measure two metrics:'
  prefs: []
  type: TYPE_NORMAL
- en: How much the value changed from the time of the previous snapshot until the
    time of the current snapshot
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How much the value changed during the snapshot inside a given period of time
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'In the following figure, I zoomed in and marked the corresponding values on
    the graph:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.4 – Returns and their volatility in a simplified model](img/B19145_13_04.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.4 – Returns and their volatility in a simplified model
  prefs: []
  type: TYPE_NORMAL
- en: In this example, we check the return (**R**) and volatility (**V**) at every
    integer value (1, 2, 3, and so on).
  prefs: []
  type: TYPE_NORMAL
- en: Let the difference between the previous value of the return (measured at 0)
    and the current value (1) be **ΔR**. In our example, ![](img/Formula_B19145_13_022.png).
  prefs: []
  type: TYPE_NORMAL
- en: Then we notice that the return first grows (from 0 to approximately 1.3) then
    falls down to about -0.65, then grows again to 1.6, then falls down to -0.15,
    and, finally, grows back to about 1.4\. So, during the snapshot period from 0
    to 1, the function already made several extremes, both maximums and minimums.
    Let **ΔV** be the difference between a local maximum and the next local minimum,
    which immediately follows this maximum (not vice versa!) In our example, ![](img/Formula_B19145_13_023.png).
  prefs: []
  type: TYPE_NORMAL
- en: The value of **ΔV** is called **drawdown** and is one of the key performance
    metrics of any investment or trading strategy.
  prefs: []
  type: TYPE_NORMAL
- en: So, how can we now estimate (very roughly, but anyway) the beta of the returns?
  prefs: []
  type: TYPE_NORMAL
- en: 'We are interested in the ratio of the return to drawdown:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/Formula_B19145_13_024.png)'
  prefs: []
  type: TYPE_IMG
- en: We want the value of this ratio to be as high as possible. If we have a choice
    between two or more strategies, then we prefer the one for which the ratio of
    return to drawdown is greater.
  prefs: []
  type: TYPE_NORMAL
- en: In our example, the obvious choice would be a *linear* strategy because it delivers
    only gains without a single loss down the road. This means that this strategy
    has a value of ΔV = 0 and thus the ratio in question is infinite. Of course, it
    never happens in reality, but it gives a clear idea about the utopian goal of
    any investor.
  prefs: []
  type: TYPE_NORMAL
- en: 'The second strategy features a ratio of return to a drawdown of about 0.77\.
    This means that although this strategy makes money, the investor will have quite
    a few desperate moments until it gets to the positive zone: the volatility of
    returns of this strategy is greater than the return itself!'
  prefs: []
  type: TYPE_NORMAL
- en: The approach that we have just considered is, of course, a very simplified one.
    In practical applications, beta is normally calculated as the volatility of returns
    compared not to returns on the same strategy or investment but to a benchmark,
    as with alpha and other investment performance metrics. Besides that, it would
    be more correct to evaluate not only the ratio of return to drawdown for the entire
    investment or trading period but to also calculate them first for a number of
    smaller periods, then average them, and finally calculate the dispersion of these
    values, thus understanding how this ratio changes over time or how consistent
    the volatility of returns is for this given strategy or investment.
  prefs: []
  type: TYPE_NORMAL
- en: 'However, I promised to keep things simple in this book and not require specific
    knowledge from the theory of probabilities, so we won’t go that far during our
    first acquaintance with performance metrics. If you want to deep-dive into this
    very interesting and very complex subject, I recommend starting with a framework
    article at Investopedia ([https://www.investopedia.com/investing/measure-mutual-fund-risk](https://www.investopedia.com/investing/measure-mutual-fund-risk))
    and following all links provided there: very quickly, you will find yourself in
    the jungles of means, standard deviations, variance, and covariance, but in the
    long run, it’s going to be quite a rewarding experience.'
  prefs: []
  type: TYPE_NORMAL
- en: Important note
  prefs: []
  type: TYPE_NORMAL
- en: The suggested estimate of beta is not the same beta used in the classical capital
    management formula earlier in this chapter. It is introduced here only to explain
    the essence of the volatility of returns and better understand the basic performance
    metrics discussed next.
  prefs: []
  type: TYPE_NORMAL
- en: Alright, we have refreshed our memory about both alpha and beta, but did you
    notice that so far we have been talking about alpha as a performance metric for
    investments? Is there any difference between investing and trading, and can we
    still use alpha to assess the performance of trading strategies?
  prefs: []
  type: TYPE_NORMAL
- en: The main difference between the two is that investing assumes buying an asset
    and holding it for a long time, while trading means that you actively buy and
    sell the asset during the same period of time. Therefore, with investment, we
    can potentially outperform the market by choosing assets that perform better than
    the broad market (by an index or any other benchmark), and in active trading,
    we try to outperform the asset itself by holding it for shorter periods of time.
  prefs: []
  type: TYPE_NORMAL
- en: The main problem with using both alpha- and beta-related metrics to analyze
    the performance of trading strategies is the lack of relevant benchmarks suitable
    for this purpose. We already mentioned this problem in [*Chapter 9*](B19145_09.xhtml#_idTextAnchor152),
    *Trading Strategies and Their Core Elements*, and pointed out that it would make
    more sense to use specific FX benchmarks to assess the performance of FX trading
    strategies.
  prefs: []
  type: TYPE_NORMAL
- en: 'However, sometimes it is really difficult to find a suitable benchmark to compare
    apples to apples: for example, if we try to assess the performance of an intraday
    strategy that opens and closes multiple positions per day ideally, we should compare
    it to a similar intraday strategy used as a reference, but finding such a reference
    will be quite a challenge by itself! So, what do we do in order to adequately
    assess the performance of a trading strategy given that we don’t have a benchmark
    as such?'
  prefs: []
  type: TYPE_NORMAL
- en: 'Well, this is why most of the performance metrics used to evaluate the trading
    strategy performance only use that same performance data, sometimes in conjunction
    with the asset price data. These metrics can be considered *proxies* to *true
    alpha* or *true beta*, and if put together, they can give quite a comprehensive
    analysis, which helps answer the main question of trading: whether to put money
    at stake with this strategy or not.'
  prefs: []
  type: TYPE_NORMAL
- en: Let’s start with metrics that aim at estimating the alpha of a trading strategy
    returns.
  prefs: []
  type: TYPE_NORMAL
- en: Net profit versus buy and hold
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This is the first thing to check after you have confirmed that the average trade
    is greater than the required absolute minimum to cover all trading costs. Buy
    and hold means that we buy the same quantity of the currency that we use in backtest,
    hold the position for the entire period of the backtest, and then look at the
    final **profit and loss** (**PnL**), on the last bar of the price time series.
    In our case, we should *buy* 10,000 AUD/USD, hold it for approximately 3 years,
    and look at the return from this single trade.
  prefs: []
  type: TYPE_NORMAL
- en: 'I recommend comparing not only the net profits of the strategy and buy and
    hold but also the equity curves: this will give us an idea about the change in
    the equity over time in both scenarios.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s quickly create the equity curve of a buy-and-hold strategy. As you remember,
    we isolated the trade logic into a separate function, `tradeLogic()`, so we only
    should rewrite the part between the `Trade logic starts here` and `Trade logic
    ends here` comments while keeping the rest of the code untouched. It’s a good
    idea to make a copy of the `tradeLogic()` function first and give it a proper
    name – for example, `buyAndHold()`, before making changes to the code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: As you can see, the only difference between `buyAndHold()` and `tradeLogic()`
    is that we removed all trade logic and replaced it with a single trade placed
    on the very first bar. No other trades are placed for the rest of the backtesting.
  prefs: []
  type: TYPE_NORMAL
- en: 'If we now run the backtest, we will see the equity curve of our hypothetical
    buy-and-hold *investment*. Note that the *x*- and *y*-axes mean the same as in
    the simplified illustrations: the *x*-axis represents time – in our backtest,
    days (because we use daily data in our backtest) – and the *y*-axis represents
    the returns.'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.5 – Buy-and-hold returns, AUD/USD](img/B19145_13_05.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.5 – Buy-and-hold returns, AUD/USD
  prefs: []
  type: TYPE_NORMAL
- en: 'And the output in the console reads as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: This means that if we bought 10,000 Australian dollars for US dollars 3 years
    ago (and the historical price data starts in 2020), then we would have had a generous
    return of -153 dollars (!), which equals -1.53% (!) in 3 years. And this is even
    without saying that we had a drawdown of almost 1,500 dollars or 15% before we
    achieved such an incredible result.
  prefs: []
  type: TYPE_NORMAL
- en: 'Well, I hope you got my sarcasm: now you can see why I always become very skeptical
    when I hear anything about *investments* in currency markets: even in such a brief
    timespan of 3 years, it’s very hard to find a currency pair that could deliver
    returns comparable to the *normal* state of a stock market (by *normal* here,
    I mean the bull market, when stock indices grow every year, quarter, and sometimes
    even every month. Let’s forget about bear markets for now, not to spoil such an
    idealistic picture). Without actively managing the positions (buying *and* selling),
    it would be impossible to achieve any acceptable returns in the FX markets. Let’s
    do the switch back – replace the `buyAndHold()` function with `tradeLogic()` and
    run the backtest again:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.6 – Returns of the sample trend-following trading strategy, AUD/USD](img/B19145_13_06.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.6 – Returns of the sample trend-following trading strategy, AUD/USD
  prefs: []
  type: TYPE_NORMAL
- en: 'And the console output now reads as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'This means that for the same test period of 3 years, we made almost $3,000
    by trading exactly the same size of 10,000 AUD/USD. Without any comments, it’s
    evident how this result surpasses the buy-and-hold strategy: it equals 30% in
    3 years compared to -1.53% for buy-and-hold.'
  prefs: []
  type: TYPE_NORMAL
- en: Let’s calculate an estimate of alpha for our trend-following strategy. The strategy
    return is 30%, the *risk-free* rate of return could be estimated at -2.85% (3
    years of treasury bills at 4.25% yield minus inflation at 7.1% in 2022), the benchmark
    return at -1.53%, and given that the beta, or the volatility of returns, is at
    least no worse than the benchmark (which is obviously the case just looking at
    the two figures here), then the alpha for our strategy is about 31.53% in 3 years.
  prefs: []
  type: TYPE_NORMAL
- en: 'So, we can say that the strategy has passed two checks: it has an average trade
    value that allows the strategy to actually trade (not only on paper), but it also
    generates alpha (outperforms the benchmark) and its returns are comparable to
    those of a conventional investment (for example, investing in the S&P 500 ETF
    would return about 18% in the same 3 years).'
  prefs: []
  type: TYPE_NORMAL
- en: Let’s now move on to assessing the beta, or the volatility of returns. As noted
    previously, we are not going to provide the classical definition of beta used
    in capital management because it requires specific knowledge from the theory of
    probabilities. Instead, we will consider drawdown, the third most important metric
    after average trade and overall returns, and show why it can be used as a *proxy*
    to assess the volatility of returns.
  prefs: []
  type: TYPE_NORMAL
- en: Drawdown
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'According to an article published on CFI (Maximum Drawdown: [https://corporate     financeinstitute.com/resources/capital-markets/maximum-drawdown/](https://corporatefinanceinstitute.com/resources/capital-markets/maximum-drawdown/)),
    “A maximum drawdown (MDD) measures the maximum fall in the value of the investment,
    as given by the difference between the value of the lowest trough and that of
    the highest peak before the trough.” We already saw an illustration of the drawdown
    in *Figure 13**.4* and it is quite easy to understand. However, real equity curves
    never look like ideal sine waves used for illustration purposes, so drawdown is
    not a constant value; it changes over time and these changes also may say a lot
    about the volatility of returns.'
  prefs: []
  type: TYPE_NORMAL
- en: 'So, we want to calculate a new time series according to the following algorithm:'
  prefs: []
  type: TYPE_NORMAL
- en: Let the first (leftmost) data point in the equity curve be the current historical
    high (maximum).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Compare the next value with the current one.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If the next value is greater than the current, let the next value be the new
    historical high.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If the next value is less than the current, store the difference between this
    value and the current historical high as the drawdown.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Finish updating the drawdown when the equity curve makes a new historical high
    and repeat the entire algorithm.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'As you can see, if we work with time series or any other sequences, iterables,
    arrays, and so on, we can more efficiently realize the same calculation in just
    two steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Form a new sequence in which the next element is either equal to the preceding
    one or greater.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Subtract the original sequence from the resulting sequence.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: This will give us a sequence of drawdowns.
  prefs: []
  type: TYPE_NORMAL
- en: To better understand what the drawdown is and how it is calculated, let’s consider
    a simple example.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s create a list containing a sequence of non-negative values:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'Then, prepare an empty list where we’re going to store the result:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'And initialize a variable that is supposed to store the current high (maximum)
    in the initial list:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'Now, we iterate over all elements in the list, `a`, compare them to the last
    maximum value, choose the new maximum, update it, and append it to the resulting
    list, `m`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'If you did everything correctly, then `m` should contain the following sequence:
    `[1, 2, 4, 4, 5, 8, 8, 8, 8, 9, 10]`. If we now subtract the original sequence,
    `a`, from `m`, then we get the series of drawdowns:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: This returns `[0, 0, 0, -1, 0, 0, -1, -2, -6, 0, 0]`. This is the list of drawdowns
    calculated at every data point in the original sequence.
  prefs: []
  type: TYPE_NORMAL
- en: We can verify the result by scanning the data in the original sequence from
    left to right. The second element in `a` is greater than the first, so the drawdown
    is 0 and the latest high is 2\. The third element is greater than the latest high,
    so the drawdown is again 0, and the latest high is updated to 4\. The fourth element
    in `a` is less than the latest high by 1, so the fourth element in `m` is -1,
    and the latest high remains 4\. You can continue this calculation and make sure
    that all the drawdown values are calculated correctly – and that you now fully
    understand the meaning of the drawdown.
  prefs: []
  type: TYPE_NORMAL
- en: 'There is a faster way of doing exactly this by using `numpy` arrays:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: 'This simple code will generate the same sequence of drawdowns as before, the
    only difference now is that it’s going to be a `numpy` array rather than a native
    Python list:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: Now that we fully understand what drawdown is and how it can be calculated,
    let’s do it for the equity time series of our trend-following strategy.
  prefs: []
  type: TYPE_NORMAL
- en: Firstly, and above all, we should add `import numpy` at the very beginning of
    the code, among other imports.
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, let’s slightly modify the very end of the backtester code, where `matplotlib`
    `plot()` is called:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'You can see a new command: `plt.subplot()`. It is used to place multiple charts
    or graphs on the same canvas (see [*Chapter 8*](B19145_08.xhtml#_idTextAnchor130),
    *Data Visualization in FX Trading with Python*, to refresh your memory regarding
    the object model of `matplotlib` plots). To save time and space here, I recommend
    you have a glance at a tutorial at [https://www.w3schools.com/python/matplotlib_subplot.asp](https://www.w3schools.com/python/matplotlib_subplot.asp)
    to understand the meaning of `subplot()` parameters.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, if you have done everything correctly and run the backtest again (using,
    of course, the same source price data!), you will now see the same equity curve
    as before, but with the drawdown chart beneath it:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.7 – Equity curve and drawdown of the sample trend-following strategy](img/B19145_13_07.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.7 – Equity curve and drawdown of the sample trend-following strategy
  prefs: []
  type: TYPE_NORMAL
- en: Now, we know a lot more about our strategy, especially about the risks associated
    with it. Even without doing precise calculations (which can be quite complex)
    and taking only a surface look at the resulting graphs here, we can make a number
    of important conclusions, which we are going to consider in the very next section.
  prefs: []
  type: TYPE_NORMAL
- en: Risk/reward and return on drawdown
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'First of all, we want to understand whether drawdowns are distributed more
    or less evenly during the backtest period. This is very important because if there
    are significant drawdowns that appear at random, then it’s a warning sign: this
    means that there are some occasional processes in the market that are not accounted
    for by the model used in the trading strategy, and sooner or later, one of these
    processes may destroy the strategy completely.'
  prefs: []
  type: TYPE_NORMAL
- en: Before we proceed, I recommend you refresh your memory about the mean and standard
    deviation, which we discussed in the *Volatility indicators* section of [*Chapter
    6*](B19145_06.xhtml#_idTextAnchor101), *Basics of Fundamental Analysis and Its
    Possible Use in* *FX Trading*.
  prefs: []
  type: TYPE_NORMAL
- en: 'We can quickly analyze the result by running the backtest in an interactive
    console and entering the following after the initial chart is displayed:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: 'This calculates the mean drawdown. The following command returns the standard
    deviation of drawdowns:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: 'Now, add three lines to the plot: the mean drawdown, mean minus 1 sigma, and
    mean minus 2 sigma:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: 'If you have done everything correctly, you should see something like this in
    the following figure:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 13.8 – Mean minus 1 and 2 sigma of drawdowns](img/B19145_13_08.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Figure 13.8 – Mean minus 1 and 2 sigma of drawdowns
  prefs: []
  type: TYPE_NORMAL
- en: How do we interpret the result?
  prefs: []
  type: TYPE_NORMAL
- en: Drawdowns that lie outside of 2 sigma (the bottom horizontal line in the chart)
    are so-called outliers. They deserve special attention because usually, they are
    caused by reasons not accounted for in the strategy logic. In our case, fortunately,
    they are not numerous and at least the very first one is easily explained by the
    market volatility at the beginning of the COVID-19 panic.
  prefs: []
  type: TYPE_NORMAL
- en: Drawdowns between mean and 2 sigma are distributed more or less evenly over
    time. This means that they are just systematic drawdowns caused by the imperfections
    of the market model used in the strategy.
  prefs: []
  type: TYPE_NORMAL
- en: Most of the drawdowns are above the mean value and again, they are distributed
    evenly along the time axis – so, this gives us hope that the market model is adequate
    for the market.
  prefs: []
  type: TYPE_NORMAL
- en: After an initial visual qualitative analysis, let’s go to numbers. The maximum
    drawdown (which also can be found by typing `min(dd)` in an interactive console
    or adding `print(min(dd))` to the code) of our strategy is 646 pips. Is it large
    or small? If you invest $10,000 and temporarily lose $646, this means that you
    risk about 6.5% of your account. This is a moderate-to-low-risk, which is considered
    acceptable to most investors.
  prefs: []
  type: TYPE_NORMAL
- en: 'However, a more important metric is the risk-to-reward ratio. The meaning of
    this metric is quite intuitive: the less the ratio, the less the volatility of
    returns and thus the less the overall risk of investing.'
  prefs: []
  type: TYPE_NORMAL
- en: Let’s do the simple math for our example. The total net profit of our strategy
    is slightly above 3,000 pips in 3 years. Even if we assume that it generates the
    same return each year (which is not the case), then on average, it returns about
    1,500 pips per annum. This means that by risking $646, we may expect about $1,500,
    so the risk/reward ratio is about 0.43.
  prefs: []
  type: TYPE_NORMAL
- en: 'The sacramental question again: is that *good* or *bad*?'
  prefs: []
  type: TYPE_NORMAL
- en: Generally speaking, any risk/reward ratio less than 1 is good because this means
    that you risk less than you may expect to win. There are debates on the *optimal*
    value of the risk/reward ratio (along with *optimal* values for all other performance
    metrics) but most authors agree that any value less than 0.5 gives a potential
    green light to investing in a financial product.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: Strictly speaking, the question about the risk/reward ratio is also closely
    connected to the problem of benchmarking. Unfortunately, this subject is too wide
    and too complex to be carefully considered in this book, but the provided rough
    estimates can work quite well as starting points for your research.
  prefs: []
  type: TYPE_NORMAL
- en: 'Another metric that is essentially the inverted risk/reward ratio is the return
    on drawdown. The only difference is that the latter is usually calculated as a
    percentage and not as a fractional value. The meaning of this metric is also very
    intuitive: it means the expected premium for the risk – the payoff we expect if
    we risk a certain amount of money.'
  prefs: []
  type: TYPE_NORMAL
- en: In our example, the return on drawdown equals 1,500/646*100 = 232.2% in 2 years.
    In other words, you may expect about twice the amount of risk you can afford to
    allocate to this strategy.
  prefs: []
  type: TYPE_NORMAL
- en: At this point, you may exclaim, *“why, but earlier in this chapter, we calculated
    an alpha of only about 30%, how come now we get such a* *huge return?”*
  prefs: []
  type: TYPE_NORMAL
- en: This is probably the most confusing part of FX trading and we will consider
    it in detail in the very next section.
  prefs: []
  type: TYPE_NORMAL
- en: The power of leverage – how much do I need to trade it?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Finally, we are about to answer the main question of any investor: how much
    do I have to have in my trading account and how much can I expect from it?'
  prefs: []
  type: TYPE_NORMAL
- en: Before we continue, let me draw your attention to the following important fact
    about FX trading.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: Do not confuse the return on investment as a performance metric with the actual
    return on actual investment!
  prefs: []
  type: TYPE_NORMAL
- en: To understand it, we should again recall the essence of margin trading and how
    it differs from regular investment and trading without margins.
  prefs: []
  type: TYPE_NORMAL
- en: When you invest or trade without margin, you can buy only that amount of assets
    (equities, commodities, whatever) that cost the amount of money in your account.
    For example, if you trade stocks, and a stock’s price is $100, and you have $10,000
    in your account, then you can buy no more than 100 shares of the stock (actually
    a bit less because of trading costs).
  prefs: []
  type: TYPE_NORMAL
- en: However, if you trade on margin, then you are supposed to have only a fraction
    of the full required amount, and the rest will be provided as a credit line by
    your broker. In our example with AUD/USD, if you have 10,000 US dollars in your
    account and your broker provides you with a retail leverage of 30:1, then you
    potentially can buy as much as ![](img/Formula_B19145_13_025.png) Australian dollars.
  prefs: []
  type: TYPE_NORMAL
- en: The ability to purchase magnitudes more assets than otherwise possible with
    the amount in your trading account makes margin trading very attractive to many
    novice traders. However, leverage is a double-edged sword. Let’s do some simple
    math and see why it may be quite dangerous.
  prefs: []
  type: TYPE_NORMAL
- en: Do you remember that we consistently calculated everything in pips, and not
    in money? Now we can benefit from this because we only need to adjust the pip
    value according to the chosen leverage and scale all the performance metrics.
  prefs: []
  type: TYPE_NORMAL
- en: So, when we traded 10,000 AUD/USD, the net return was about 3,000 pips, and
    the maximum drawdown was 646 pips. If we had the same $10,000 in our account,
    that would mean that we traded without leverage, and for unleveraged trading,
    the return indeed would make about 30% while the drawdown would remain acceptably
    low, around 6.5%.
  prefs: []
  type: TYPE_NORMAL
- en: Now, we trade with a leverage of 30:1\. This means that a pip value now equals
    $30, not $1\. Then, the return would make $30 * 3000 = $90,000 – what a handsome
    profit! If we present this figure as percent growth over the initial investment,
    we will have an incredible value of 900% in just 3 years. So, margin trading is
    a great benefit and the way to go, isn’t it?
  prefs: []
  type: TYPE_NORMAL
- en: But we forgot about the drawdown. We also have to scale it up, as now 1 pip
    costs $30\. This way, a drawdown of 646 pips translates into $30 * 646 = $19,380.
  prefs: []
  type: TYPE_NORMAL
- en: Oops.
  prefs: []
  type: TYPE_NORMAL
- en: 'The drawdown now is twice as much as the total initial capital in the account!
    This means that in reality, we would have never reached the expected return. Moreover,
    instead of making a profit, we would have lost all money in our account and faced
    a catastrophe notoriously known as a *margin call*: the situation when the broker
    calls for adding funds to your account because otherwise, the open position cannot
    be maintained. Most retail brokers do not wait until clients add funds to their
    accounts and simply liquidate such a position with a loss. Therefore, if we traded
    our strategy with a leverage of 30:1, we would have lost all money in the account
    during the very first drawdown.'
  prefs: []
  type: TYPE_NORMAL
- en: So, how do we choose the acceptable leverage?
  prefs: []
  type: TYPE_NORMAL
- en: With margin trading, we normally start from the opposite end. Instead of calculating
    the projected returns from the strategy metrics, first of all, we try to estimate
    a leverage that would allow our positions to remain open during the entire trading
    period.
  prefs: []
  type: TYPE_NORMAL
- en: We know that the maximum drawdown is 646 pips and we have $10,000 in a trading
    account. Thus, the maximum possible leverage should make the pip value no greater
    than 10,000/646, which is about $15\. Therefore, the absolute maximum possible
    leverage is 15:1, which is twice as low as the 30:1 offered by the broker.
  prefs: []
  type: TYPE_NORMAL
- en: Now, let’s have a critical look at the result.
  prefs: []
  type: TYPE_NORMAL
- en: Can we trade our strategy with leverage of 15:1? Theoretically yes, practically
    no because in this case, the drawdown would make up 100% of the trading account.
    I can’t imagine any trader, not commenting on investors, who would be able to
    withstand such a drawdown, even just psychologically.
  prefs: []
  type: TYPE_NORMAL
- en: 'In reality, the calculation of the right leverage is performed in the following
    sequence:'
  prefs: []
  type: TYPE_NORMAL
- en: Define the maximum level of losses. This is not the maximum drawdown of a strategy,
    but the maximum drawdown acceptable by the investor.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Calculate the pip value so that this acceptable level of losses would equal
    the strategy drawdown.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Define leverage as the ratio of the projected pip value to the original pip
    value.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Define the trading size as the original trading size multiplied by the leverage.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Let’s calculate the leverage for our strategy with the assumption that an average
    investor can afford to withstand a drawdown of 10% of the initial investment.
    Let’s also assume that the initial investment is $10,000\. Therefore, the maximum
    loss in the account should not ever exceed $1,000\. With a maximum strategy drawdown
    of 646 pips, the value of 1 pip can be equal to $1,000/646 = $1.54\. So, we use
    leverage of just 1.5:1 (not 15:1, not 30:1, and of course not 100:1 as offered
    by many brokers!) Now, we recall that a pip value of $1 is obtained when we trade
    $10,000 per trade. We multiply the original trading size (10,000) by the leverage
    (1.5) and we get only 15,000 AUD/USD.
  prefs: []
  type: TYPE_NORMAL
- en: 'And what about returns? Previously we calculated two metrics – alpha and return
    on drawdown – and they gave two very different values: about 30% in the former
    case and over 200% in the latter. With our acceptable level of losses of 10% and
    leverage of 1.5:1, we expect a return of 3,000 pips * $1.5 = $4,500 in 2 years.
    This equals 45% of the initial investment of $10,000.'
  prefs: []
  type: TYPE_NORMAL
- en: Now, let’s cover the key takeaways from everything we discussed in this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: Alpha is calculated for an unleveraged investment and gives the lowest estimate
    of possible returns.
  prefs: []
  type: TYPE_NORMAL
- en: Return on drawdown is calculated for the maximum possible leverage and gives
    the upper estimate of possible returns (assuming that the drawdown may reach 100%
    of the initial investment).
  prefs: []
  type: TYPE_NORMAL
- en: The realistic return is calculated based on the chosen risk level and is always
    between alpha and the return on the drawdown.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we familiarized ourselves with the most basic yet essential
    performance metrics. We understand now that there are three main aspects that
    help assess the strategy performance: trade analysis, alpha-related metrics such
    as returns, and beta-related metrics such as the volatility of returns and analysis
    of drawdowns. We learned about the main factors that always have a negative impact
    on performance, such as spread, slippage, commission, and overnight swaps, and
    we saw how we can realistically account for them in our assessment.'
  prefs: []
  type: TYPE_NORMAL
- en: We have had a surface peek into the basics of capital management and considered
    alpha and beta, in a simplified form, but at least in a helpful enough way to
    improve our judgments regarding strategy. Finally, we carefully considered the
    leverage, saw its double-edged nature, and adopted the correct way of choosing
    the leverage for markets traded on margin, such as FX.
  prefs: []
  type: TYPE_NORMAL
- en: Of course, this chapter is only an introduction to the vast, complex, but interesting
    world of capital management and risk assessment, as this entire book is only an
    introduction to the world of systematic FX trading in general. However, even the
    basic facts and techniques considered in this book are enough to start your own
    homework. Hopefully, this homework is going to be perpetual – because any successful
    trader, in the long run, is a perpetual student of the market.
  prefs: []
  type: TYPE_NORMAL
- en: I encourage you to test any idea you may come across – now that you know how
    to do it, critically analyze the results – using the approach outlined in this
    chapter, and continue your studies, using my remarks *“it is unfortunately outside
    the scope of this book”* as invitations to learn more yourself. One day, you may
    find that you operate a portfolio of various strategies running in a large number
    of markets, bringing you both mental satisfaction from decent work and quite a
    significant material reward.
  prefs: []
  type: TYPE_NORMAL
