<html><head></head><body>
<div><h1 class="chapter-number" id="_idParaDest-110"><a id="_idTextAnchor112"/>5</h1>
<h1 id="_idParaDest-111"><a id="_idTextAnchor113"/>Version Control with Git in PyCharm</h1>
<p>Version control is<a id="_idIndexMarker394"/> an essential best practice in the field of software development. The mechanics of the process, though, are daunting for new developers. It is easy to make mistakes. As a bootcamp instructor at Southern Methodist University (Go Ponies!), I have seen quite a few blunders, such as accidentally adding your entire home folder to a Git repository, creating repositories inside of other repositories, and wiping out the product of hard work by pushing and pulling out of order. I prefer my students to master Git on the command line. In fact, it is the very first skill I teach, and in my opinion, it is one of the most difficult.</p>
<p>After a developer gains confidence with the whole Git process, it is something of an annoyance to have to constantly jump out of the IDE to perform four or five commands, then jump back into the IDE to continue work. It is true you could use the built-in terminal window available in PyCharm, but the IDE offers a better option: a built-in version control GUI.</p>
<p>PyCharm supports<a id="_idIndexMarker395"/> a number of the major <strong class="bold">version control systems</strong> (<strong class="bold">VCSs</strong>), including the following:</p>
<ul>
<li>Git</li>
<li>Mercurial</li>
<li>Subversion</li>
<li>Perforce</li>
<li>Microsoft <strong class="bold">Team </strong><strong class="bold">Foundation Server</strong></li>
</ul>
<p>While there are many other VCSs available, these are easily the most popular, and among those in this list, Git has become the de facto standard in the industry.</p>
<p>This chapter will first cover some basic information about version control and VCSs just in case you are new to the concept. Following this introduction, we will focus entirely on the tooling for Git, since as I just hinted, it has a capital lead in terms of market share.</p>
<p>By the end of the chapter, you will come to understand the following:</p>
<ul>
<li>The merits of using a VCS</li>
<li>Working with Git to perform adding, committing, pushing, merging, and branching operations</li>
<li>Creating and maintaining a <code>.</code><code>gitignore</code> file</li>
<li>Working with the Git tooling in the IDE, which may be referenced from several vectors</li>
</ul>
<h1 id="_idParaDest-112"><a id="_idTextAnchor114"/>Technical requirements</h1>
<p>To be successful with this chapter, you will need the following:</p>
<ul>
<li>A working installation of Python 3.10 or later.</li>
<li>A working installation of PyCharm.</li>
<li>Git client software for your computer. Mac and Linux systems usually have this installed as standard. Windows users can visit <a href="https://gitforwindows.org">https://gitforwindows.org</a> to download the free software.</li>
<li>A free GitHub account. Register at <a href="https://github.com">https://github.com</a>. Note that while there are paid features of GitHub, we won’t be using them</li>
</ul>
<h1 id="_idParaDest-113"><a id="_idTextAnchor115"/>Version control and Git essentials</h1>
<p>Software industry<a id="_idIndexMarker396"/> icon <strong class="bold">Joel Spolsky</strong>, who <a id="_idIndexMarker397"/>created Stack Overflow, wrote a famous blog back in the year 2000. One of his many influential posts included one titled <em class="italic">The Joel Test: 12 Steps to Better Code</em>. The post was designed to give software developers an easy assessment to rate any software development organization’s maturity level. He asked 12 questions, with one point per question. A good software development group should have a score of 11 or higher. The very first item on the list is the concern of this chapter: Do you use source control? If you are curious about the rest, there is a link to the blog post, as well as a reference to Mr. Spolsky’s book <em class="italic">Joel on Software</em>, in the <em class="italic">Further reading</em> section of this chapter.</p>
<p>Joel called it <strong class="bold">source control</strong>. I call it <strong class="bold">version control</strong>. The terms are interchangeable. I will call it <em class="italic">version control</em> in order to be consistent with the UI in PyCharm, which refers to the group of features we’re talking about<a id="_idIndexMarker398"/> as a <strong class="bold">version control system</strong>, or<strong class="bold"> VCS</strong>. Strictly speaking, version control is a process used to track changes to the files that make up your <a id="_idIndexMarker399"/>program over time. The <a id="_idIndexMarker400"/>objectives of a VCS include the following:</p>
<ul>
<li>The ability to revert to any previously saved version of any file in your project.</li>
<li>The ability to automatically merge the work of multiple developers on a team so long as their work does not conflict. A conflict occurs when two developers change the same file in the same place.</li>
<li>Provide an easy means to review conflicts and resolve them through collaboration.</li>
<li>The ability to track which developers made each change in the code over time.</li>
<li>Provide a branching system to allow bug fixes, enhancements, and experimentation without sacrificing the stability of your production code.</li>
</ul>
<p>A VCS, then, is a software system designed to enable that process. VCSs come in two varieties, depending on how revisions<a id="_idIndexMarker401"/> are stored. <strong class="bold">Centralized VCSs</strong> work <a id="_idIndexMarker402"/>a little like your local public library. Your project is checked <a id="_idIndexMarker403"/>into a <strong class="bold">repository</strong>. Developers can then check out the code in order to work on creating a new revision. Doing so will retrieve the latest version of the project. Some systems, such as <strong class="bold">Perforce</strong>, traditionally <a id="_idIndexMarker404"/>require you to explicitly check out the files you want to work with just like you’d check out a book from a library. While you have those files checked out, nobody else is allowed<a id="_idIndexMarker405"/> to modify them until you check them back in with your changes. Other systems, such as <strong class="bold">Subversion</strong>, don’t have this requirement. Anybody can work on their local working copy. When work is done, the developer <strong class="bold">commits</strong> their work to the central repository. During the commit process, the VCS checks for <strong class="bold">conflicts</strong>. If no conflicts exist, the incoming work is <strong class="bold">merged</strong> and a new version is stored on the VCS server, which is then available for other developers through an update process. If conflicts are detected, the commit is rejected, and the developer must work with other developers on the team to resolve the conflict before the work can be merged and finally committed. In all centralized systems, each developer on a team has only the latest version of the code on their local computer.</p>
<p>In contrast, <strong class="bold">distributed version control systems</strong> (<strong class="bold">DVCSs</strong>) such<a id="_idIndexMarker406"/> as <strong class="bold">Git</strong> and <strong class="bold">Mercurial</strong> keep<a id="_idIndexMarker407"/> every <a id="_idIndexMarker408"/>revision ever performed on the<a id="_idIndexMarker409"/> project on each developer’s computer. The advantage here is there is no single point of failure that might result in a total loss of the <a id="_idIndexMarker410"/>project code. In a centralized system, if the server is compromised, the project’s revision history might be lost. In a distributed system, there isn’t a central system to store the project’s revision history. Every developer has the project’s entire history on their computer, so the loss of any one computer isn’t a big deal beyond the usual pain of replacing the equipment.</p>
<p>With that said, distributed systems do use a central <strong class="bold">hub</strong> or <strong class="bold">remote</strong> to allow easy synchronization between the working copies on each developer’s computer. The hub server allows additional functionality, such as managing who is allowed to view or change the code, as well as collaborative features such as code reviews, bug tracking, documentation, and discussion. A DVCS <a id="_idIndexMarker411"/>also presents an easy way to control the publication of new releases of web-based applications. Many continuous deployment systems, such <a id="_idIndexMarker412"/>as <strong class="bold">Travis CI</strong>, <strong class="bold">CircleCI</strong>, and <strong class="bold">Beanstalk</strong>, are simply leveraging features <a id="_idIndexMarker413"/>of the DVCS to control the release management process.</p>
<p>The most famous DVCS is Git, created <a id="_idIndexMarker414"/>by <strong class="bold">Linus Torvalds</strong>, who also <a id="_idIndexMarker415"/>created the <strong class="bold">Linux</strong> operating system. The most famous DVCS hub is, you guessed it, GitHub, which is owned by Microsoft. Many people use the terms <em class="italic">Git</em> and <em class="italic">GitHub</em> interchangeably. This is a mistake. GitHub is a place on the internet. The software used to access <em class="italic">GitHub</em> is called <em class="italic">Git</em>. Many projects that use Git as their DVCS host their repository hub<a id="_idIndexMarker416"/> in services other than GitHub, such <a id="_idIndexMarker417"/>as <strong class="bold">GitLab</strong>, <strong class="bold">Microsoft Azure DevOps</strong>, <strong class="bold">Atlassian Bitbucket</strong>, and <strong class="bold">Beanstalk</strong> (<a href="https://beanstalkapp.com">https://beanstalkapp.com</a>, not<a id="_idIndexMarker418"/> to be confused with the Beanstalk service<a id="_idIndexMarker419"/> on <strong class="bold">Amazon Web Services</strong>, which has nothing to<a id="_idIndexMarker420"/> do with version control).</p>
<p>As developers make changes to their working copy, they can commit changes to their local copy. They can later synchronize their code by pulling changes from the central hub, reconciling any conflicts, and then pushing their merged work. Again, the big difference is in a DVCS; everything happens on the developer’s computer versus on a server with a centralized system.</p>
<h1 id="_idParaDest-114"><a id="_idTextAnchor116"/>Setting up Git on your computer</h1>
<p>Whether<a id="_idIndexMarker421"/> you installed Git for Windows on your Windows computer, or you are working with a pre-installed Git client on your Mac or Linux computer, you need to perform some additional setup beyond simply installing the software. The setup tasks ahead include the following:</p>
<ol>
<li>Set your default username and email address.</li>
<li>Create a <strong class="bold">Secure Shell</strong> (<strong class="bold">SSH</strong>) key so <a id="_idIndexMarker422"/>you can securely communicate with remote hubs such as GitHub.</li>
<li>Add the SSH key to your account on GitHub.</li>
</ol>
<p>Let’s go through the process for each.</p>
<p>To get started, you need to launch a terminal. If you are using Mac or Linux, you should be able to find an app on your system, simply called <em class="italic">Terminal</em>. The commands I’ll present are going to be using<a id="_idIndexMarker423"/> the <strong class="bold">Bash shell</strong>. Mac’s terminal program defaults to a shell called <a id="_idIndexMarker424"/>the <strong class="bold">Z shell</strong> (<strong class="bold">zsh</strong>), which is directly compatible with Bash. Most Linux installations default to Bash, so you are all set. If you are in Windows, you need to have installed <a id="_idIndexMarker425"/>the Git software from <a href="https://gitforwindows.org">https://gitforwindows.org</a>. One of the programs installed is called <em class="italic">gitbash</em>. Launching <strong class="bold">gitbash</strong> will allow<a id="_idIndexMarker426"/> us all to use the same commands regardless of which operating system we’re using.</p>
<h2 id="_idParaDest-115"><a id="_idTextAnchor117"/>Setting your default username and email address</h2>
<p>Having<a id="_idIndexMarker427"/> launched your terminal, you <a id="_idIndexMarker428"/>need to execute the following command to set your default username:</p>
<pre class="console">
git config --global user.name "FIRST_NAME LAST_NAME"</pre> <p>Naturally, you’ll fill in your actual name. Next, fill in your email address. If you work for a corporation, I strongly recommend creating a separate GitHub account to keep your work separate from your employers to avoid any nasty intellectual property disputes. Keeping that<a id="_idIndexMarker429"/> in mind, use an appropriate email address for your work with the following command:</p>
<pre class="console">
git config --global user.email "MY_NAME@example.com"</pre> <p>There are <a id="_idIndexMarker430"/>more extensive configuration options beyond using these two globals, but this is the most common way to set up Git, and you won’t be able to push code to GitHub without these settings. If you’d like more in-depth information on working with Git, I recommend checking out the additional reading in the <em class="italic">Further reading</em> section of this chapter.</p>
<h2 id="_idParaDest-116"><a id="_idTextAnchor118"/>Generating an SSH key</h2>
<p>One <a id="_idIndexMarker431"/>objective of a remote hub is to keep your code secure from malicious tampering. One of the ways this happens is to ensure all communications between your computer and the remote are encrypted. You can work with HTTPS encryption or SSH. While both are valid encryption tools, SSH is considered far superior and is the mark of a real pro. In order to work with SSH, you need to generate a unique pair of encryption keys: one public key and a matching private key. I won’t go into how SSH works here, but if you’re curious, I’ll leave some reading suggestions in the <em class="italic">Further reading</em> section of this chapter.</p>
<p>Generating a key is pretty simple. Having opened a Bash session, simply type the following:</p>
<pre class="console">
ssh-keygen</pre> <p>The key generation program will ask you some questions, such as where to store your key files and what to call them. By default, they are called <code>id_rsa</code> (the private key) and <code>id_rsa.pub</code> (the public key), both of which are stored in your home folder in a sub-folder called <code>.ssh</code>.</p>
<p>The last question asked is the passphrase for the key. You can enter a password for the key for extra security, or just press <em class="italic">Enter</em> for an empty passphrase. This is generally not advisable, since security is tighter when you create a passphrase. The drawback to having a passphrase is you are constantly challenged to enter the passphrase. An empty passphrase bypasses these interruptions but puts security at risk by making your key easier to compromise. I recommend entering a passphrase because one of the advantages of using PyCharm’s tooling is that it stores your passphrase in its own encrypted database. PyCharm will answer all your challenges for you, eliminating the inconvenience of working with a passphrase-protected encryption key.</p>
<p>After the passkey is entered, you’ll get some additional feedback. You can check your key by typing the following:</p>
<pre class="console">
ls ~/.ssh -a</pre> <p>This lists (<code>ls</code>) the files in your home folder (<code>~/</code>) under the <code>.ssh</code> sub-folder including any hidden files (<code>-a</code> for “all files”). You should see, at a minimum, the <code>id_rsa</code> and <code>id_rsa.pub</code> files. You are going to need the contents of the <code>id_rsa.pub</code> file in just a moment as you are going to paste its contents onto a screen on GitHub.</p>
<p>We’ve <a id="_idIndexMarker432"/>come to the part in the book where I offer a fatherly lecture on security. Never ever, ever, ever (times infinity to the googleth power plus one) paste your private key into anything. Never ever (ad nauseam) allow anybody to copy your private key. Don’t put it on a thumb drive. Don’t copy it to a network drive or cloud file share for safekeeping. For the love of everything holy, never check it into a repository! That goes for any passwords for any system. Your repos might ultimately become public, if not to the whole world, then at least to the rest of your team.</p>
<p>The public key is for sharing. The private key is to be kept secret and hidden. If your private key is compromised, only your passphrase protects your work. If you left the passphrase blank, then you have no further protection!</p>
<p>To display the contents of your public key, type the following:</p>
<pre class="console">
cat ~/.ssh/id_rsa.pub</pre> <p>The contents of your public key will appear in your terminal window. Select the entire key, right-click, and click <strong class="bold">Copy</strong>.</p>
<h2 id="_idParaDest-117"><a id="_idTextAnchor119"/>Adding your SSH key to your GitHub account</h2>
<p>I’m going to<a id="_idIndexMarker433"/> cover this pretty quickly since I suspect many of you have done this before. If you need a better tutorial on adding an SSH key to your GitHub account, see the <em class="italic">Further reading</em> section at the end of this chapter for an explicit list of steps specific to Git.</p>
<p>Log in to GitHub<a id="_idIndexMarker434"/> and click your face. By that, I mean the avatar on GitHub in the upper-right corner, assuming they haven’t re-designed their site since going to press. Find the option for working with your profile and find <strong class="bold">Settings</strong>. Inside your profile settings is an option to manage your SSH keys. Click that link, then find the option to add an SSH key. Paste in the public key you copied a moment ago, give it a name that is easy to remember, and click the <strong class="bold">Add</strong> button.</p>
<p>Congratulations! You are fully set up for secure communications between your computer and GitHub remotes. It is possible to reuse your SSH key between different computers you own. Just copy the <code>.ssh</code> folder between computers. Just be careful not to compromise the key by keeping it on a portable drive you might lose, or a cloud file share that might be compromised.</p>
<h1 id="_idParaDest-118"><a id="_idTextAnchor120"/>Setting up a repository manually</h1>
<p>In <a href="B19644_03.xhtml#_idTextAnchor052"><em class="italic">Chapter 3</em></a>, <em class="italic">Customizing Interpreters and Virtual Environments</em>, we created a virtual environment manually in order to become<a id="_idIndexMarker435"/> familiar with the process. We’ll do the same thing here. Let’s use the command line to create a repository and perform all the basic functions available in Git. Afterward, we’ll see where PyCharm’s tooling allows us to perform the same operations right from the IDE in a convenient GUI.</p>
<p class="callout-heading">Don’t use spaces in any file or folder name</p>
<p class="callout">I’m going to bring this up often since I know a lot of readers skip around in books like this one. If you are new to software development, you may not know that using filenames with spaces can cause problems. Avoid using file and folder names with spaces, including any folders created by your operating system. Instead, use separators in place of spaces, such as dashes or underscores, or use camelCase names, which omit spaces and present word boundaries with a capital letter.</p>
<p>With your Bash terminal session open, the first thing we’re going to do is create a folder for our project. We’ll do this in your home folder with this command:</p>
<pre class="console">
mkdir first-repository</pre> <p>Next, let’s change the directory to the newly created folder:</p>
<pre class="console">
cd first-repository</pre> <p>This is where<a id="_idIndexMarker436"/> our code is going to live! Before we go any further though, we need to talk about a sensitive subject.</p>
<h2 id="_idParaDest-119"><a id="_idTextAnchor121"/>Master versus main branches in GitHub</h2>
<p>For the <a id="_idIndexMarker437"/>first 12 years after GitHub was established, whenever one created a new repository in GitHub, the tool established a default starting<a id="_idIndexMarker438"/> branch called <em class="italic">master</em>. In 2020, an organization called <em class="italic">The Software Freedom Conservancy</em> advised GitHub to change the name of the default branch from <em class="italic">master</em> to <em class="italic">main</em> owing to the association of the term <em class="italic">master</em> with slavery. While Git doesn’t force you to use any particular name, the default on GitHub has been changed to <em class="italic">main</em>. Since GitHub doesn’t control Git, this name change is only the default on repositories created by GitHub. We’ve been creating our repositories using the Git command line, which is leveraged by PyCharm’s Git tools. Whether you use the Git command or PyCharm’s integration, there’s a solid chance you’re going to get a repository initialized with a branch called <em class="italic">master</em>. When you create a remote on GitHub, that repo will be created with <a id="_idIndexMarker439"/>a default branch called <em class="italic">main</em>.</p>
<p>You should take care to match the names of the default branches so that when you perform your first push, your branches synchronize properly. You can either change the name in GitHub or set the Git command on your computer to use <em class="italic">main</em> for the default.</p>
<p>If you want to change it on GitHub, you can go into your profile settings and click <strong class="bold">Repositories</strong>. You’ll find the setting at the top, as shown in <em class="italic">Figure 5</em><em class="italic">.1</em>.</p>
<div><div><img alt="Figure 5.1: You can set the default name of repositories in GitHub to match the default on your computer" src="img/B19644_05_01.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.1: You can set the default name of repositories in GitHub to match the default on your computer</p>
<p>You can also set a global setting on your computer with this command:</p>
<pre class="console">
git config --global init.defaultBranch main</pre> <p>If you<a id="_idIndexMarker440"/> intend to do a lot of work with GitHub as your remote, it is a good idea to synchronize the default branch name. If you don’t, the first time you try to push the repository you created on your computer to the remote created on GitHub, you’ll encounter an error. The default locally is <em class="italic">master</em>, while the default on the remote is <em class="italic">main</em>. The remote won’t have a branch called <em class="italic">master</em>, so you’ll get a message stating there is no upstream branch called <em class="italic">master</em>. You’ll have to do some work to get this settled. I’ll leave a link to an article on how to resolve this situation should you encounter it. I encourage you to just avoid it entirely by using the preceding Git command to set your local global setting to <em class="italic">main</em> so it matches GitHub.</p>
<h2 id="_idParaDest-120"><a id="_idTextAnchor122"/>Manually initializing the repository</h2>
<p>Let’s <a id="_idIndexMarker441"/>create our repository. It is entirely possible, and even normal, to create a repository after you have created a code project. However, we will start with the repository since this will be a very simple demonstration. To create a new Git repository, or repo for short, type the following:</p>
<pre class="console">
git init</pre> <p>That was easy! It might look like nothing much happened. You’ll get a message stating the repository was created. Let’s look at the changes to the folder:</p>
<pre class="console">
ls -a</pre> <p>The <code>ls</code> command<a id="_idIndexMarker442"/> lists all the files. The <code>-a</code> switch shows hidden files and folders. When you initialized the Git repository, the Git software created a folder called <code>.git</code>. Since the folder name starts with a period (<code>.</code>), the folder is hidden in Linux-like systems. If you perform these steps in Windows with PowerShell, you’ll be able to see the folder, but it’s hidden in the other operating systems.</p>
<p>The <code>.git</code> folder is where all your revisions are stored, along with all your project’s settings. In general, you should never need to alter the contents of this folder.</p>
<p>We have a repository on our local computer. Let’s add a new file. Type the following:</p>
<pre class="console">
echo "hello world" &gt; test.txt</pre> <p>This created a new file called <code>test.txt</code>. Within that file is the line <code>hello world</code>. What a great way to start, right? You can check the contents of the file by typing the following:</p>
<pre class="console">
cat test.txt</pre> <p>Who needs an IDE, right? Wait, no, forget I said that. The order of the next few steps is important. The process is as follows:</p>
<ol>
<li>Add the file(s) to the repository. The files you are adding are the files you have either created or modified since your last commit. We don’t have one of those yet. Adding your files to the repo is also called staging your files. We are making the repository aware of new and changed files. You shouldn’t always add every file to your project. There are some you should keep out of your repository. We’ll cover that a little later.</li>
<li>Commit your files. This creates a new version of your code on your local computer. The commit action requires you to include a comment that explains the nature of the changes you’ve made. This is vital! You should endeavor to write a concise summary of your changes, and you should write these comments as though your most important customer will one day read all these comments. This is not a place to vent your frustrations! Trust me on this one. I’ve seen projects fall under unexpected audits where mean or inappropriate comments surfaced and working relationships were ruined. Assume everything you write will be read and judged by the whole world.</li>
<li>Pull changes <a id="_idIndexMarker443"/>from the remote hub. You always want to pull before you push. This allows you to find any conflicts between your work, and any work that might have been pushed by another developer on the project. This is important! If you don’t pull before your push, it is possible to overwrite another developer’s revision! This is certainly not catastrophic since all revisions are held in the repo. It will, however, make tomorrow’s stand-up meeting very awkward for you as the other developer will likely not be happy with you for making extra work for the group! It’s simple. Just remember to pull before you push. Do this even if you are the only person working on the project and just make it a habit!</li>
<li>Assuming there are no conflicts, push your work to the remote hub.</li>
</ol>
<p>Your revisions are now available to the rest of the team and stored securely on the remote server. Let’s go through the commands for this process.</p>
<p>First, add your new and changed files to Git. Remember, this is also called <strong class="bold">staging</strong> your files:</p>
<pre class="console">
git add test.txt</pre> <p>If you have a bunch of files in your project, it is possible to add them all at once with the following:</p>
<pre class="console">
git add .</pre> <p>With your latest changes staged, you can now commit them to the local repo. This creates a new version of your project on your computer. You need to include a comment that summarizes your changes:</p>
<pre class="console">
git commit -m "initialized repository and added test.txt which might be the best code in the world."</pre> <p>The <code>-m</code> switch is our comment, which is enclosed in double quotes. Just remember it as a <em class="italic">commit message</em> and the <code>-m</code> switch is <a id="_idIndexMarker444"/>easy to remember. Of course, by the end of the chapter, you won’t need to remember all this command-line stuff since you’ll have a nifty GUI.</p>
<h2 id="_idParaDest-121"><a id="_idTextAnchor123"/>Working with remotes</h2>
<p>It is<a id="_idIndexMarker445"/> possible to work with a project entirely on your local computer. Naturally, you’d lose all the collaborative benefits provided by a remote hub, including the benefits of a remote backup of your change history. Earlier, I presented a four-step process:</p>
<ol>
<li>Add or stage your changed files.</li>
<li>Commit your changes to create a new revision.</li>
<li>Pull changes from the remote.</li>
<li>Push your merged work to the remote.</li>
</ol>
<p>We’re halfway through the list, having completed the first two steps on our local copy of the repository. We must interrupt the process at this point because we don’t presently have a remote. We’re going to create one on GitHub, but naturally, you can use any compatible service.</p>
<h2 id="_idParaDest-122"><a id="_idTextAnchor124"/>Adding a remote on GitHub</h2>
<p>Log on <a id="_idIndexMarker446"/>to GitHub and find the <strong class="bold">Add Repository</strong> button. It is usually a very obvious green button. With my luck, they’ll redo the site at press time. Nevertheless, they usually make the <strong class="bold">Create repository</strong> button very obvious on the UI.</p>
<p>Let’s create a repository to match the one we created locally. I’ll make mine public, which means everybody can see it. If you’re bashful, you can make it private. It won’t matter for this exercise.</p>
<p>Once you have created the repository, GitHub will display instructions for adding the GitHub version of the repo as a remote. Just copy and paste the code GitHub generated into your terminal, making sure that your terminal is currently in the repository folder as the present working directory.</p>
<p>You can verify the remote by typing the following:</p>
<pre class="console">
git remote -a</pre> <p>The command<a id="_idIndexMarker447"/> generated by GitHub sets the name of the GitHub copy of the repo as <em class="italic">origin</em>. You should have one remote called <em class="italic">origin</em>, while the local version of the repository is referred to by the current branch, which is usually <em class="italic">main</em>, as described earlier.</p>
<h2 id="_idParaDest-123"><a id="_idTextAnchor125"/>The first push</h2>
<p>Now that you <a id="_idIndexMarker448"/>have a remote, you can push your local repo to the remote. Type the following:</p>
<pre class="console">
git push origin main -u</pre> <p>This pushes your copy of the main branch to the remote and sets upstream tracking for the main branch. This is just a fancy way of saying both the remote and the local repository are aware of the main branch, and any push here will result in the remote main branch being updated. If the remote doesn’t have a branch called <code>main</code>, one will be created and everything will synchronize nicely.</p>
<h2 id="_idParaDest-124"><a id="_idTextAnchor126"/>Making, committing, and pushing a change</h2>
<p>Now that we <a id="_idIndexMarker449"/>have a fully working repository, complete with a remote on GitHub, let’s make one full round of changes to our code. We’ll cover the four-step process this time without interruption. This is the process you’ll follow many times per day for the duration of your project.</p>
<p>The next <a id="_idIndexMarker450"/>step is very important. Make this a habit!</p>
<pre class="console">
git pull</pre> <p>This pulls any changes<a id="_idIndexMarker451"/> sitting on the remote and allows you to fix any conflicts before they go out into the world! Naturally, in this situation, there won’t be any conflicts since only we are working on the project.</p>
<p>Next, let’s change the contents of our text file. Type the following:</p>
<pre class="source-code">
echo "this is the best code in the world" &gt; test.txt</pre> <p>You can check the result with the following:</p>
<pre class="source-code">
cat test.txt</pre> <p>You should see the changed file. Now let’s do a full cycle of add, commit, pull, and push. Type each of the following lines, one at a time, and press <em class="italic">Enter</em> at the end of each one:</p>
<pre class="source-code">
git add test.txt
git commit -m "changed the text in test.txt"
git pull
git push origin main</pre> <p>Switch to<a id="_idIndexMarker452"/> your <a id="_idIndexMarker453"/>browser <a id="_idIndexMarker454"/>where you created your repository, and refresh the page. You should see your code. You can click the <code>test.txt</code> file in the browser to verify the new contents were pushed. You should also see there are two revisions.</p>
<p>Your repo is set up and working properly! Let’s switch our focus from the command line to working in the IDE.</p>
<h1 id="_idParaDest-125"><a id="_idTextAnchor127"/>Working with Git in the IDE</h1>
<p>We have already<a id="_idIndexMarker455"/> gone through some of the Git workflows in PyCharm. In <a href="B19644_02.xhtml#_idTextAnchor028"><em class="italic">Chapter 2</em></a>, <em class="italic">Installation and Configuration</em>, we used PyCharm to clone the sample code repository for this book. Since we’ve covered cloning, we won’t do it again. Instead, let’s consider all we did manually a moment ago:</p>
<ol>
<li>We used <code>git init</code> to initialize a new local repository.</li>
<li>We made a change to our code.</li>
<li>We used <code>git add</code> to add the changes as staged files in preparation for a commit.</li>
<li>We committed our changes to the local repository.</li>
<li>We pulled from the remote to make sure we have the latest code on this branch and that no conflicts exist between what we have in our working copy and what exists on the remote. The remote could have recently changed owing to some other developer pushing their changes.</li>
<li>Finally, we pushed our changes to the remote.</li>
</ol>
<p>This list <a id="_idIndexMarker456"/>represents the most basic workflow for capturing and managing revisions on a project. We can do all of this and more in PyCharm’s GUI. It is also fairly common to do some work in PyCharm and some in the command line. Using one or the other doesn’t preclude anything. For example, I often branch and merge in the command line because it’s quick and easy for me. If there is a conflict, I find resolving it in PyCharm to be superior in every way versus a manual approach. The GUI for this task is outstanding. We’ll get to all this in good time. For now, open the folder you’ve been using in PyCharm, and let’s explore what the IDE can do for us regarding these first steps we’ve taken manually.</p>
<h1 id="_idParaDest-126"><a id="_idTextAnchor128"/>Version control in PyCharm</h1>
<p>PyCharm <a id="_idIndexMarker457"/>has several places in the UI that allow you to access your VCS, which for us is Git. They aren’t redundant, but instead, each area provides a visual <a id="_idIndexMarker458"/>tool for a particular task. The first is the main menu, as seen in <em class="italic">Figure 5</em><em class="italic">.2</em>.</p>
<div><div><img alt="Figure 5.2: The Git menu allows you to access all the commands you might normally use at the command line" src="img/B19644_05_02.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.2: The Git menu allows you to access all the commands you might normally use at the command line</p>
<p>The second provides a fast and easy way to commit files. This can be found in the sidebar<a id="_idIndexMarker459"/> menu, as seen in <em class="italic">Figure 5</em><em class="italic">.3</em>:</p>
<div><div><img alt="Figure 5.3: The Git commit tools can be found in the sidebar" src="img/B19644_05_03.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.3: The Git commit tools can be found in the sidebar</p>
<p>The third allows <a id="_idIndexMarker460"/>visualization of the branch and commit history. This can be found in the tool window located at the bottom of the screen. This section of the screen collapses, but the tool window selector is always available at the bottom of the sidebar, as seen in <em class="italic">Figure 5</em><em class="italic">.4</em>.</p>
<div><div><img alt="Figure 5.4: Clicking the Git tool window will open a window that shows you the commit history, along with all the branches" src="img/B19644_05_04.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.4: Clicking the Git tool window will open a window that shows you the commit history, along with all the branches</p>
<p>The fourth<a id="_idIndexMarker461"/> is on the top toolbar next to the main menu. This area<a id="_idIndexMarker462"/> shows you the branch you are currently working on and allows easy branch management. You can see this in <em class="italic">Figure 5</em><em class="italic">.5</em>.</p>
<div><div><img alt="Figure 5.5: The current branch is displayed near the main menu. Clicking here allows you access to a few commands" src="img/B19644_05_05.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.5: The current branch is displayed near the main menu. Clicking here allows you access to a few commands</p>
<p>The fifth is the VCS operations popup, as shown in <em class="italic">Figure 5</em><em class="italic">.6</em>. This has been around for quite a<a id="_idIndexMarker463"/> while and I would consider it legacy even though it’s still there. You<a id="_idIndexMarker464"/> can get to the popup using <em class="italic">Ctrl</em> + <em class="italic">`</em>. Please note that isn’t a quotation mark. The <code>`</code> key, called the gravure mark, is located to the left of the <em class="italic">1 </em>(one) key on the US keyboard layout.</p>
<div><div><img alt="Figure 5.6: The VCS operations pop-up window is activated with Ctrl/Cmd + `." src="img/B19644_05_06.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.6: The VCS operations pop-up window is activated with Ctrl/Cmd + `.</p>
<p>Finally, you can right-click the editor window or a tab in the editor window to access the same Git<a id="_idIndexMarker465"/> menu found in the main menu, as shown in <em class="italic">Figure 5</em><em class="italic">.7</em>.</p>
<div><div><img alt="Figure 5.7: You can right-click in the editor window or on a tab to see the Git menu" src="img/B19644_05_07.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.7: You can right-click in the editor window or on a tab to see the Git menu</p>
<p>As you can see, tooling <a id="_idIndexMarker466"/>for revision control is neatly woven into the IDE in an organized and intelligent fashion. Since we opened a folder that already had a Git repository in place, PyCharm simply recognizes that fact and presents the interface. When you open a folder or create a project without a GitHub repo, most of the tooling will still be visible, but it won’t be Git specific. Since PyCharm supports many VCSs, a project that hasn’t been initialized using Git or any other VCS will present generic tooling until such initialization is complete.</p>
<h1 id="_idParaDest-127"><a id="_idTextAnchor129"/>Creating a new project from scratch using VCS tooling in PyCharm</h1>
<p>Let’s make a<a id="_idIndexMarker467"/> new project. The code for this project is in the repo for the book, but you don’t really want to just open that copy because it will already be associated with a repository, and you won’t see everything I’m about to show you. For this exercise, you should create a new project from scratch as I am about to do.</p>
<p>Click the hamburger icon in the top-left corner of the application to activate the main menu, then click <code>project_git_demo</code>. I’ll leave everything else as default. You can see my project creation dialog in <em class="italic">Figure 5</em><em class="italic">.8</em>.</p>
<div><div><img alt="Figure 5.8: My demo project settings" src="img/B19644_05_08.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.8: My demo project settings</p>
<p>We now have a <a id="_idIndexMarker468"/>project with which we can work.</p>
<h2 id="_idParaDest-128"><a id="_idTextAnchor130"/>Initializing the local Git repository</h2>
<p>After<a id="_idIndexMarker469"/> my project has been created, I need to initialize a Git repository. Manually, we did this with the <code>git init</code> command. In PyCharm, we can use the main menu’s <strong class="bold">VCS</strong> option. Right now, it says <strong class="bold">VCS</strong> because we haven’t initialized a repository with any VCS yet, so the terminology in the UI is generic. As you can see in <em class="italic">Figure 5</em><em class="italic">.9</em>, we have options for revision control in Mercurial, Git, GitHub, Perforce, and Subversion. There is a new option for sharing a<a id="_idIndexMarker470"/> project on JetBrains’ new collaboration product called <strong class="bold">Space</strong>, which<a id="_idIndexMarker471"/> contains a Git hosting service. Naturally, as the Space product grows, you can expect to see more and more integration appear in all the IDEs. I’m going to click <strong class="bold">Create Git Repository…</strong>, as shown in <em class="italic">Figure 5</em><em class="italic">.9</em>.</p>
<div><div><img alt="Figure 5.9: Creating a Git repository from the PyCharm VCS menu" src="img/B19644_05_09.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.9: Creating a Git repository from the PyCharm VCS menu</p>
<p>As you can see in <em class="italic">Figure 5</em><em class="italic">.10</em>, you are next prompted to select the folder where you’d like to create the repository. It defaults to the current folder, which is correct.</p>
<div><div><img alt="Figure 5.10: Select the folder where you’d like to create the Git repository" src="img/B19644_05_10.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.10: Select the folder where you’d like to create the Git repository</p>
<p>Clicking<a id="_idIndexMarker472"/> the <strong class="bold">OK</strong> button creates the repository in the selected folder. You can verify that it worked by checking whether the default branch (master) appears in the top toolbar with a dropdown that contains a few Git operations. Now that we have initialized a Git repository, the menus no longer use the term <strong class="bold">VCS</strong> but instead list options specifically for Git.</p>
<h2 id="_idParaDest-129"><a id="_idTextAnchor131"/>Adding a remote on GitHub</h2>
<p>There<a id="_idIndexMarker473"/> isn’t tooling in PyCharm for creating a remote. You need to log in to GitHub and create a repository just as you did earlier. <em class="italic">Figure 5</em><em class="italic">.11</em> shows me setting up the remote repository in my personal account. Note this is distinct from the book’s repository, which is meant to house all the code in the book rather than serve as a demonstration of creating a repository.</p>
<div><div><img alt="Figure 5.11: The settings for my remote" src="img/B19644_05_11.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.11: The settings for my remote</p>
<p>Note that only the bare minimum is set. No <code>.gitignore</code> file, no README file, and so on. I’m going to add all those in PyCharm. When I click the <strong class="bold">Create repository</strong> button, GitHub generates<a id="_idIndexMarker474"/> the URL I need for adding the remote. I’ve pointed this out in <em class="italic">Figure 5</em><em class="italic">.12</em>.</p>
<div><div><img alt="Figure 5.12: You need the URL for the remote in order to add it to your local repository" src="img/B19644_05_12.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.12: You need the URL for the remote in order to add it to your local repository</p>
<p>Next, switch back to PyCharm and find the <strong class="bold">git</strong> menu within the main menu. Remember, a minute ago, the menu said <strong class="bold">VCS</strong> because we had not defined a repository, but now it says <strong class="bold">git</strong>.</p>
<p>Within the <strong class="bold">git</strong> menu, you’ll find an option called <strong class="bold">Manage Remotes</strong>. Click that and you’ll see a modal dialog, shown in <em class="italic">Figure 5</em><em class="italic">.13</em>, which allows you to add the remote you just created on GitHub.</p>
<div><div><img alt="Figure 5.13: The Git Remotes dialog allows you to add the remote you created on GitHub" src="img/B19644_05_13.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.13: The Git Remotes dialog allows you to add the remote you created on GitHub</p>
<p>Click the <strong class="bold">+</strong> button<a id="_idIndexMarker475"/> to add a remote. You get yet another dialog on top of this one, as seen in <em class="italic">Figure 5</em><em class="italic">.14</em>.</p>
<div><div><img alt="Figure 5.14: Add the URL you copied from the GitHub page" src="img/B19644_05_14.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.14: Add the URL you copied from the GitHub page</p>
<p>Click <code>main.py</code> file is red.. You’ll just have to trust me. It’s red because it is an untracked file. We need to add our files to our repository so we can track them.</p>
<h2 id="_idParaDest-130"><a id="_idTextAnchor132"/>Adding project files</h2>
<p>Setting up<a id="_idIndexMarker476"/> the project and the remote is something you generally only do once for the duration of the project. If you’re joining an existing team, it may have been done long before you joined. This next set of actions, though, is something you’ll work with every day.</p>
<p>When you are working with changes you’ve made to the project, you’ll find the <strong class="bold">Commit</strong> window very useful. Refer back to <em class="italic">Figure 5</em><em class="italic">.3</em> if you have forgotten how to locate the <strong class="bold">Commit</strong> window.</p>
<h2 id="_idParaDest-131"><a id="_idTextAnchor133"/>Adding a .gitignore file</h2>
<p>If <a id="_idIndexMarker477"/>you’re not familiar, a <code>.gitignore</code> file defines files and folders you don’t want to include in your repository. As a general rule, anything that can be generated from your code doesn’t need to be in your repository. When working with Python projects, a short list of things you don’t want in your repo might include the following:</p>
<ul>
<li>The <code>venv</code> folder since this is generated by running <code>pip</code></li>
<li>Python cache folders (you’ll see them as <code>__pycache__</code> folders)</li>
<li>Byte-compiled DLL files</li>
<li>C extensions</li>
<li>Build files from distribution and packaging</li>
<li>PyInstaller manifests</li>
<li>Application log files</li>
<li>Test coverage reports</li>
</ul>
<p>This is by no means an exhaustive list. The list will really depend on what kind of application you are building and exactly what gets generated during a run of your project. There are plenty of suggestions on the contents of a <code>.gitignore</code> file. GitHub has such a list in a gist. You can get this file at <a href="https://githubgitm/github/gigitnore/blgitmain/Python.gitignore">https://githubgitm/github/gigitnore/blgitmain/Python.gitignore</a>. It is also the <code>.gitignore</code> file in the book’s Git repository. You can use this <code>.gitignore</code> file if you’d like, but to keep this short and easy, I’m just going to include a few entries in a <code>.gitignore</code> file we will create.</p>
<p>Switch back to<a id="_idIndexMarker478"/> the file view, as shown in <em class="italic">Figure 5</em><em class="italic">.15</em>. You do this by clicking the folder icon (<code>project_git_demo</code> project title (<code>.gitignore</code>. No creativity is allowed here. It must be called <code>.gitignore</code>, all lowercase.</p>
<div><div><img alt="Figure 5.15: Switch back to the file view and create a new file called .gitignore" src="img/B19644_05_15.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.15: Switch back to the file view and create a new file called .gitignore</p>
<p>When you create the new file, PyCharm will prompt you to add the file to Git, as shown in <em class="italic">Figure 5</em><em class="italic">.16</em>. If you want to add new files to become the default, you can click the <strong class="bold">Don’t ask again</strong> checkbox and all files you create will be added to GitHub automatically.</p>
<div><div><img alt="Figure 5.16: Each time you create a file in PyCharm, you are prompted to add it to the repository" src="img/B19644_05_16.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.16: Each time you create a file in PyCharm, you are prompted to add it to the repository</p>
<p>Regardless <a id="_idIndexMarker479"/>of what you do with the checkbox, click the <code>.gitignore</code> file shows green in the project explorer since it was added and nothing has yet changed. Within the <code>.gitignore</code> file, add these lines:</p>
<pre class="source-code">
venv
__pycache__</pre> <p>This will exclude the entire <code>venv</code> folder and any cache folders generated by Python. PyCharm saves your files as we go, so let’s add this file and the <code>main.py</code> file to the repository. Switch to the <strong class="bold">Commit</strong> window and you’ll see something like <em class="italic">Figure 5</em><em class="italic">.17</em>.</p>
<div><div><img alt="Figure 5.17: The commit window after we’ve added our .gitignore file" src="img/B19644_5_17.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.17: The commit window after we’ve added our .gitignore file</p>
<p>Wow! Where did all that come from? We just added one file! As you can see, the <code>.gitignore</code> file was added in response to the dialog we saw when we created the file. The only other code file in the project is the <code>main.py</code> file generated by PyCharm when we created the project. What about the rest? Why is there a second <code>.gitignore</code> file listed in the unversioned files list?</p>
<p>These all come from the <code>.idea</code> folder created by PyCharm. There is some debate on whether this folder belongs in source control. JetBrains has a page in their documentation at <a href="https://intellij-support.jetbrains.com/hc/en-us/articles/206544839">https://intellij-support.jetbrains.com/hc/en-us/articles/206544839</a> discussing their ideas on the subject. To sum up the article, JetBrains recommends storing the contents of the <code>.idea</code> folder pertaining to the project, but not any files that contain user-specific settings, which are the following:</p>
<ul>
<li><code>workspace.xml</code></li>
<li><code>usage.statistics.xml</code></li>
<li>Anything in the <code>shelf</code> directory</li>
</ul>
<p>The <a id="_idIndexMarker480"/>article is meant to cover all <code>.gitignore</code> file. We haven’t committed anything yet, so add these lines to your <code>.</code><code>gitignore</code> file:</p>
<pre class="source-code">
.idea/workspace.xml
.idea/usage.statistics.xml
.idea/shelf</pre> <p>Let’s check all the boxes to get all those files added, as shown in <em class="italic">Figure 5</em><em class="italic">.18</em>.</p>
<div><div><img alt="Figure 5.18: Everything is added and we’re ready to commit" src="img/B19644_05_18.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.18: Everything is added and we’re ready to commit</p>
<p>Add a<a id="_idIndexMarker482"/> commit message in the box. You can click the <strong class="bold">Commit</strong> button to commit to your local repository or <strong class="bold">Commit and Push…</strong> to send the changes straight to GitHub. As a general rule, you should not use the <strong class="bold">Commit and Push…</strong> button unless you are completely certain that no one could have pushed changes since the last push. It is probably safe because we have never pushed; however, I’m going to hit the <strong class="bold">Commit</strong> button to demonstrate the whole process laid out earlier. You add your changes, commit, pull, and then push. So far, we’ve added our changes, and now we’re committing.</p>
<p>If all goes well, a toast will appear in the lower-right corner of your screen stating that your files were successfully committed. If you didn’t set your global username and email address during the manual exercise, you will be prompted via a dialog to set them up.</p>
<h2 id="_idParaDest-132"><a id="_idTextAnchor134"/>Pulling and pushing</h2>
<p>Now that <a id="_idIndexMarker483"/>the first commit is out of the way, we are set <a id="_idIndexMarker484"/>to do the last half of the process. We always pull before pushing to ensure we have the latest revision on the current branch. This allows us a chance to resolve any conflicts that might have arisen since our last pull. In Git, the command we used was <code>pull</code>. There is a <code>pull</code> option in the Git tools, but before we go there, I will point out another option: <strong class="bold">Update Project…</strong>. This is found in the dropdown in the toolbar denoted by the current branch, as shown in <em class="italic">Figure 5</em><em class="italic">.19</em>.</p>
<div><div><img alt="Figure 5.19: The Update Project… command isn’t really a Git command. It refers to an update strategy" src="img/B19644_05_19.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.19: The Update Project… command isn’t really a Git command. It refers to an update strategy</p>
<p>When<a id="_idIndexMarker485"/> you click <strong class="bold">Update Project…</strong>, you’ll be<a id="_idIndexMarker486"/> asked to set your preference for updating your local Git repository. There are two possibilities depicted in the ensuing dialog box, as shown in <em class="italic">Figure 5</em><em class="italic">.20</em>.</p>
<div><div><img alt="Figure 5.20: There are two update strategies from which to choose" src="img/B19644_05_20.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.20: There are two update strategies from which to choose</p>
<p>The <code>git pull</code> command we executed earlier embodies the first option. The pull operation will <em class="italic">fetch</em> any changes from the remote and automatically <em class="italic">merge</em> those changes into our local copy. The <code>rebase</code> operation is a different strategy. It changes the structure of your repository in order to show a cleaner timeline of changes. I won’t get into the arguments of which strategy to use, but I will include a link in the <em class="italic">Further reading</em> section of this chapter should you desire to dive deeper.</p>
<p>Personally, I prefer the first option since it is simpler and safer. I only have to click the <strong class="bold">OK</strong> button. I can click the <strong class="bold">Don’t show again</strong> checkbox if I do not want to be prompted before use. PyCharm will forevermore use the selection I make here and now.</p>
<p>If you <a id="_idIndexMarker487"/>have <a id="_idIndexMarker488"/>problems with commitment, I don’t mean generally, but technically, when it comes to executing <code>git commit</code>, you can skip this dialog entirely. Just use the <strong class="bold">Pull…</strong> menu item on the Git menu, as shown in <em class="italic">Figure 5</em><em class="italic">.21</em>.</p>
<div><div><img alt="Figure 5.21: You can do a traditional Git pull from any of the Git menus" src="img/B19644_05_21.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.21: You can do a traditional Git pull from any of the Git menus</p>
<p>There is nothing left to do but push. Perhaps the quickest way was shown previously in <em class="italic">Figure 5</em><em class="italic">.19</em>, where we encountered the <strong class="bold">Update </strong><strong class="bold">Project…</strong> command.</p>
<h2 id="_idParaDest-133"><a id="_idTextAnchor135"/>Branching and merging</h2>
<p>We have <a id="_idIndexMarker489"/>discussed the most basic functions of any VCS, which protects the project’s code by tracking revisions over time. A second set of very important functions entails segregating the project work into several copies. This practice is<a id="_idIndexMarker490"/> called <strong class="bold">branching</strong>. There are many benefits to branching; I can’t cover them all here. If you’d like more details on version control with Git, check out the Packt book <em class="italic">Git for Programmers</em> listed in the <em class="italic">Further reading</em> section of this chapter. However, I’ll offer what I consider to be the most important benefits.</p>
<p>Consider a typical web<a id="_idIndexMarker491"/> start-up that goes through a cycle of creating a repository and iterating development to its first release. The release is sitting on a production server somewhere in the cloud and customers have started using the app. The start-up company not only wants to enhance their offering with additional features, but they will also encounter bugs and problems that must be fixed. Let’s pretend the development and quality assurance teams did such an amazing job that there are virtually no bugs in the release. Pleased with themselves, the company wants to start adding new features. All work is being done in the main branch because that is the only one that exists. In order to add a new feature, we need to change something deep within the code. The moment you start the change, you need a week to finish it, and during that time, the development version of the product is very unstable.</p>
<p>All of a sudden, reality sets in. It is nigh impossible to have a software release with no bugs, unless, of course, the software was written by unicorns or Chuck Norris. Let’s say it’s not just a bug. It’s a bad bug. Something like someone forgot a <code>WHERE customer_id=@customerId</code> on a SQL statement and your app erroneously displays all customer data to all customers. That’s a career-ender! I’ve seen it happen and it isn’t pretty. You need to fix it <em class="italic">immediately</em>! Except you can’t without backing out all those changes you’ve made that might render the app unstable. That is one option. Another option is that you could revert to the code you released, then implement the fix and save your career. You would then spend a lot of time trying to cherry-pick the commits to salvage your feature work. You could also elect to write all of your code in Notepad using a keyboard set to the Dvorak layout with totally blank keys. You could do it, but it wouldn’t be a productive use of your time.</p>
<p>This is where branching comes into play. The start-up can do all its work on the main branch. They shouldn’t, but let’s keep the story constrained to what we have so far. Once the software is released, they could make a new branch and maybe call it <em class="italic">development-branch</em>. The name isn’t important. The branching operation creates a copy of what was released. It is in that branch that our intrepid development team starts to make changes that might have rendered the development version unstable.</p>
<p>Boom! The bad thing happens. You can switch from <em class="italic">development-branch</em> back to <em class="italic">main</em>. You now<a id="_idIndexMarker492"/> have the code that was released, and you<a id="_idIndexMarker493"/> can fix the problem. After the fix is in place, you can merge the fix into your development branch and continue working on your unstable app in <em class="italic">development-branch</em>. Keeping the work segregated allows you to work on new features independently of emergency bug fixes.</p>
<p>I am grossly over-simplifying the typical branching strategy used by most teams in this illustration. I would prefer to leave coverage of that topic to works dedicated to version control. I’ll leave suggestions for further reading on branching strategies in the <em class="italic">Further reading</em> section of this chapter. Let’s continue with the mechanics of working with branches. They are vital to your daily practice of software development.</p>
<h2 id="_idParaDest-134"><a id="_idTextAnchor136"/>Creating a branch</h2>
<p>Creating a new <a id="_idIndexMarker494"/>branch is very easy. Click the branch menu on the top menu bar and click <strong class="bold">New Branch</strong>. You’ll see the dialog shown in <em class="italic">Figure 5</em><em class="italic">.22</em>.</p>
<div><div><img alt="Figure 5.22: The Create New Branch dialog allows you to create a new Git branch" src="img/B19644_05_22.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.22: The Create New Branch dialog allows you to create a new Git branch</p>
<p>Type a name for your new branch. The branch is created locally, and you are automatically switched to the new branch.</p>
<h2 id="_idParaDest-135"><a id="_idTextAnchor137"/>Switching between branches</h2>
<p>This is also<a id="_idIndexMarker495"/> very easy. Go back to the branch menu. The local branches are listed in the branch dropdown, as shown in <em class="italic">Figure 5</em><em class="italic">.23</em>.</p>
<div><div><img alt="Figure 5.23: Local branches are listed in the branch menu" src="img/B19644_05_23.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.23: Local branches are listed in the branch menu</p>
<p>Switching to a different branch is just a matter of clicking the desired branch from the list and then clicking <strong class="bold">Checkout</strong>. As you can see, there are other operations you can perform on the branch.</p>
<h2 id="_idParaDest-136"><a id="_idTextAnchor138"/>Merging</h2>
<p>When you’re<a id="_idIndexMarker496"/> ready to merge a branch back into main, or any other branch for that matter, simply switch to that branch, then use the <strong class="bold">Merge</strong> command in the branch menu, as shown in <em class="italic">Figure 5</em><em class="italic">.24</em>.</p>
<div><div><img alt="Figure 5.24: The Merge command can be found in the branch menu" src="img/B19644_05_24.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.24: The Merge command can be found in the branch menu</p>
<p>The <strong class="bold">Merge</strong> dialog, shown in <em class="italic">Figure 5</em><em class="italic">.24</em>, will allow you to select the branch you’d like to merge into<a id="_idIndexMarker497"/> the currently selected branch.</p>
<p>If you need something more exotic than the standard merge operation, there is a <strong class="bold">Modify options</strong> dropdown, which allows you to do the equivalent of several command-line switches normally employed during the manual merge process.</p>
<h2 id="_idParaDest-137"><a id="_idTextAnchor139"/>Viewing the branch diagram</h2>
<p>The Git tool in <a id="_idIndexMarker498"/>the tool window provides a graphical view of the various branches in your repository. You can see it in <em class="italic">Figure 5</em><em class="italic">.25</em>. This can be useful when you need to review what has recently changed in the repository. It’s the kind of thing you might do first thing in the morning so you can review your team’s changes in the last 24 hours.</p>
<div><div><img alt="Figure 5.25: The Git tool can be activated by clicking on the toolbar on the lower-left edge of the PyCharm window" src="img/B19644_05_25.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.25: The Git tool can be activated by clicking on the toolbar on the lower-left edge of the PyCharm window</p>
<p>To activate it, click<a id="_idIndexMarker499"/> the Git icon in the tool window (<strong class="bold">1</strong>). You can search the revision history and filter it using the various tools on the toolbar (<strong class="bold">2</strong>). Selecting a commit (<strong class="bold">3</strong>) allows you to see the details of that commit (<strong class="bold">4</strong>) along with the commit message.</p>
<h1 id="_idParaDest-138"><a id="_idTextAnchor140"/>Diffs and conflict resolution</h1>
<p>Sooner or later, you’re <a id="_idIndexMarker500"/>going to perform a pull prior to pushing some changes only to discover a conflict exists. This can be intimidating and stressful even for experienced developers because you are running the risk of breaking someone else’s recent contribution. Nevertheless, it happens and you need a way to deal with the problem. This leads us to one of my favorite features in PyCharm. In <a href="B19644_01.xhtml#_idTextAnchor014"><em class="italic">Chapter 1</em></a>, <em class="italic">Introduction to PyCharm – the Most Popular IDE for Python</em>, I told you about my experience with Microsoft’s debugger. Having experienced it early in my career, to me, nothing else will do. I have the same regard for PyCharm’s merge tool. Resolving a conflicted merge in anything else feels painful.</p>
<p>There is only one file in<a id="_idIndexMarker501"/> the project. By now, you’ll recognize it as the <code>main.py</code> file PyCharm generates with new projects. We’re going to generate a conflict using the following steps:</p>
<ol>
<li>Create a new project in PyCharm.</li>
<li>Change the contents of the <code>main.py</code> file to a single line of code to ensure we generate a conflict.</li>
<li>Initialize a Git repository in the project folder.</li>
<li>Add and commit all project files.</li>
<li>Create a new branch called <em class="italic">development</em>.</li>
<li>Change the line of code that renders the <em class="italic">Hello </em><em class="italic">World</em> message.</li>
<li>Commit the change to the branch.</li>
<li>Switch back to the main branch.</li>
<li>Make a different change to the one line of code.</li>
<li>Commit the change.</li>
<li>Now try to merge the development branch into the main branch.</li>
</ol>
<p>The result of these 11 steps will be a conflict. Let’s resolve it!</p>
<p>First, create a new project called <code>conflict_resolution</code> in PyCharm, as shown in <em class="italic">Figure 5</em><em class="italic">.26</em>. Make sure you create the project in a location on your drive outside of the folder structure for the book’s repository. Remember, the book’s code is already in a repository. You can’t create a new repo inside another repo.</p>
<div><div><img alt="Figure 5.26: My conflict_resolution project settings. They’re just defaults" src="img/B19644_05.26.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.26: My conflict_resolution project settings. They’re just defaults</p>
<p>PyCharm generates<a id="_idIndexMarker502"/> a project with a <code>main.py</code> file. Delete all the lines in <code>main.py</code> and replace them with this code:</p>
<pre class="source-code">
foo = "foo"</pre> <p>Just so we’re clear, your PyCharm window should look just like mine in <em class="italic">Figure 5</em><em class="italic">.27</em>.</p>
<div><div><img alt="Figure 5.27: The main.py file has been reduced to one line of code" src="img/B19644_05_27.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.27: The main.py file has been reduced to one line of code</p>
<p>Click the <strong class="bold">VCS</strong> menu<a id="_idIndexMarker503"/> in the <strong class="bold">File</strong> menu and click <strong class="bold">Create Git repository</strong>. If you don’t remember where in the menu to find this, refer back to <em class="italic">Figure 5</em><em class="italic">.9</em>. Make note of the default branch that was created. We don’t need a remote for this exercise, so it doesn’t matter whether it’s <em class="italic">main</em>, <em class="italic">master</em>, or something else; you just need to remember its name. I’ll assume it’s called <em class="italic">main</em>.</p>
<p>Use the commit window to add the files for the project to the repository. <em class="italic">Figure 5</em><em class="italic">.3</em> will remind you if you have forgotten how. Go ahead and commit the files by entering a commit message.</p>
<p>Next, we need to create a branch. Click the branch dropdown and click <code>development</code>.</p>
<p>Open the <code>main.py</code> file. Replace the code with this one line:</p>
<pre class="source-code">
foo = "bar"</pre> <p>By limiting ourselves to a single line, we can be positive our actions will result in a conflict. Commit this change to the <code>development</code> branch.</p>
<p>Switch back to the main branch using the branch dropdown. Change the contents of <code>main.py</code> to this code:</p>
<pre class="source-code">
foo = "baz baz baz"</pre> <p>Commit this change to the main branch. You’ve just simulated two developers changing the same file, in the same area. There will be no way for Git to reconcile the differences. With the main branch active, click the branch dropdown, click the development branch, and click <strong class="bold">Merge development into main</strong>. You will see a conflict message, as shown in <em class="italic">Figure 5</em><em class="italic">.28</em>.</p>
<div><div><img alt="Figure 5.28: We have a conflict that needs to be resolved before we can merge" src="img/B19644_05_28.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.28: We have a conflict that needs to be resolved before we can merge</p>
<p>You generally have three <a id="_idIndexMarker504"/>options when resolving a conflict. You can choose to ignore the incoming changes and select your local work as the correct code by clicking the <strong class="bold">Accept Yours</strong> button. Likewise, you can select the incoming code changes and discard your local copy by clicking <strong class="bold">Accept Theirs</strong>. Often, though, you will need to merge parts of your local revision with the incoming changes. For this, you will need to activate the merge tool, as shown in <em class="italic">Figure 5</em><em class="italic">.29</em>, by clicking the <strong class="bold">Merge…</strong> button.</p>
<div><div><img alt="Figure 5.29: Activate the merge tool to pick parts from the incoming code to merge with yours" src="img/B19644_05_29.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.29: Activate the merge tool to pick parts from the incoming code to merge with yours</p>
<p>With the merge tool <a id="_idIndexMarker505"/>active, you can see three panes. The pane on the left (<strong class="bold">1</strong>) represents the conflicting code from the main branch. The code on the right (<strong class="bold">2</strong>) is the revision coming from the development branch. The pane in the middle (<strong class="bold">3</strong>) represents the amalgamation of the two. You can pick parts of your code and parts of the incoming code to make the best possible combination. Experiment with the <strong class="bold">&gt;&gt;</strong> buttons (<strong class="bold">4</strong>), which copy the code into the central merged result. The buttons labeled <strong class="bold">X</strong> (<strong class="bold">4</strong>) will ignore the conflicted line. You can use the up and down arrows (<strong class="bold">5</strong>) to jump to the next unresolved conflict in the file.</p>
<p>Let’s pretend the best resolution to my conflict is to have a line from the left pane and a line from the right pane together. In real life, this wouldn’t work because we’re going to wind up with two variable assignments next to each other, but it does demonstrate how the tool works. To use the line from the left pane, I can click the button indicated by the arrow in <em class="italic">Figure 5</em><em class="italic">.30</em>.</p>
<div><div><img alt="Figure 5.30: This button will move the code from the left pane into the working merge solution" src="img/B19644_05_30.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.30: This button will move the code from the left pane into the working merge solution</p>
<p>Next, I’d like to <a id="_idIndexMarker506"/>place the line from the right pane below the line I just moved. Often, you want to use some of the code from both sides rather than it simply being right or wrong from one side. Click the button indicated by the arrow in <em class="italic">Figure 5</em><em class="italic">.31</em> to copy the code from the left pane below the current line in the middle pane.</p>
<div><div><img alt="Figure 5.31: Clicking the double arrow copies this line below the one we selected from the right side" src="img/B19644_05_31.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.31: Clicking the double arrow copies this line below the one we selected from the right side</p>
<p>Once you complete this action, you have resolved the conflict! You are rewarded with a nice green message telling you as much.</p>
<p>Your objective is to use the left and right panes to create the best version of the code in the middle <a id="_idIndexMarker507"/>pane, which represents the resolution of the conflict. When you’re finished, you can click the <strong class="bold">Apply</strong> button. If you have unresolved conflicts remaining in the file, PyCharm will tell you that. If you got them all, the merge you attempted is completed. If you are working with a remote, you should push the resulting conflict resolution once the commit is successful.</p>
<h2 id="_idParaDest-139"><a id="_idTextAnchor141"/>Viewing diffs</h2>
<p>You<a id="_idIndexMarker508"/> don’t need a conflict to use the diff window we just saw. A diff window is a window that shows two or more versions of code side by side. You can diff between branches, or between revisions. Say I make a quick change to our merged code by adding this line:</p>
<pre class="source-code">
text = "I'm adding this line"</pre> <p>I also take out line 2, which reads as follows:</p>
<pre class="source-code">
foo = "bar"</pre> <p>My code is now very different. If I want to compare my new code with the latest in the branch, I can right-click the <code>main.py</code> tab and click <strong class="bold">Git</strong> | <strong class="bold">Show Diff</strong>. I’ll see a side-by-side diff of the two files, as shown in <em class="italic">Figure 5</em><em class="italic">.32</em>.</p>
<div><div><img alt="Figure 5.32: The diff view between what you’ve got in your editor versus the last committed version" src="img/B19644_05_32.jpg"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 5.32: The diff view between what you’ve got in your editor versus the last committed version</p>
<p>This diff is appearing in a side-by-side format. You can change it to an in-line view, which is often shown on GitHub when you view commits, by changing the drop-down setting labeled (<strong class="bold">1</strong>). You can also edit the file using the same line-moving tools you just saw in the merge indicated by (<strong class="bold">2</strong>).</p>
<h1 id="_idParaDest-140"><a id="_idTextAnchor142"/>Summary</h1>
<p>In this chapter, we have covered two main topics—the idea of version control in application development and programming and its importance, as well as how to practice it using Git and GitHub within PyCharm. Specifically, we have learned how to carry out version control using Git and GitHub in two different ways: manually and with PyCharm.</p>
<p>With this knowledge, PyCharm users can apply version control to their own projects in a flexible way, skipping over the manual and tedious process in the terminal/command line. We see that, by offering these features, PyCharm allows us to focus on the actual development process in any given software engineering project.</p>
<p>Aside from version control, there are other practices in application development— which PyCharm provides intuitive, straightforward commands to facilitate. Without these commands, application development be quite complex and intimidating. These processes are testing, debugging, and profiling, all of which will be discussed in the next chapter.</p>
<h1 id="_idParaDest-141"><a id="_idTextAnchor143"/>Questions</h1>
<ol>
<li>What does the term <em class="italic">version control</em> entail, specifically in the context of programming?</li>
<li>What are the benefits of using version control?</li>
<li>What are the basic steps to version control for your own projects with Git and GitHub?</li>
<li>What is <em class="italic">branching</em> and why is it important?</li>
<li>Name the various windows and tool locations throughout PyCharm that give you access to Git and other VCS commands.</li>
</ol>
<h1 id="_idParaDest-142"><a id="_idTextAnchor144"/>Further reading</h1>
<ul>
<li>Be sure to check out the companion website for the book at <a href="https://www.pycharm-book.com">https://www.pycharm-book.com</a>.</li>
<li><em class="italic">Merging vs. </em><em class="italic">Rebasing</em>: <a href="https://www.atlassian.com/git/tutorials/merging-vs-rebasing">https://www.atlassian.com/git/tutorials/merging-vs-rebasing</a></li>
<li>How Secure Shell (SSH) works: <a href="https://en.wikipedia.org/wiki/Secure_Shell">https://en.wikipedia.org/wiki/Secure_Shell</a></li>
<li><em class="italic">Adding a new SSH key to your GitHub </em><em class="italic">account</em>: <a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account ">https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account</a></li>
<li><em class="italic">Why GitHub renamed its master branch to </em><em class="italic">main</em>: <a href="https://www.theserverside.com/feature/Why-GitHub-renamed-its-master-branch-to-main ">https://www.theserverside.com/feature/Why-GitHub-renamed-its-master-branch-to-main</a></li>
<li><em class="italic">Git Merge Strategy Options and </em><em class="italic">Examples</em>: <a href="https://www.atlassian.com/git/tutorials/using-branches/merge-strategy ">https://www.atlassian.com/git/tutorials/using-branches/merge-strategy</a></li>
<li>Git branching guidance: <a href="https://learn.microsoft.com/en-us/azure/devops/repos/git/git-branching-guidance ">https://learn.microsoft.com/en-us/azure/devops/repos/git/git-branching-guidance</a></li>
<li>Git Essentials for Beginners: <a href="https://www.packtpub.com/product/mastering-git/9781783553754">https://www.packtpub.com/product/mastering-git/9781783553754</a></li>
<li>Liberty, J. (2021). <em class="italic">Git for Programmers: Master Git for effective implementation of version control for your programming projects</em>. Packt Publishing Limited.<a href="https://www.atlassian.com/git/tutorials/merging-vs-rebasing "/></li>
<li>Narebski, J. (2016). <em class="italic">Mastering Git</em>. Packt Publishing Ltd.</li>
<li><em class="italic">The Joel Test: 12 Steps to Better </em><em class="italic">Code</em>: <a href="https://www.joelonsoftware.com/2000/08/09/the-joel-test-12-steps-to-better-code/">https://www.joelonsoftware.com/2000/08/09/the-joel-test-12-steps-to-better-code/</a></li>
<li>Be sure to check out the companion website for the book at <a href="https://www.pycharm-book.com">https://www.pycharm-book.com</a>.</li>
</ul>
</div>
</body></html>