<html><head></head><body>
<div><div><h1 id="_idParaDest-25"><em class="italic"><a id="_idTextAnchor027"/>Chapter 2</em>: Refresher of OOP Concepts in Python</h1>
<p>In the previous chapter, we looked at an overview of and discussed the need for metaprogramming and its practical applications, such as using the add function. But before we deep dive into the concepts of metaprogramming, it is important for you to have knowledge of the <a id="_idIndexMarker047"/>basic Object-Oriented Programming (OOP) concepts available in Python. This chapter gives an overview of the existing OOP concepts along with examples. </p>
<p>The main topics we will be covering in this chapter are as follows:</p>
<ul>
<li>Introducing our core example</li>
<li>Creating classes</li>
<li>Understanding objects</li>
<li>Applying methods</li>
<li>Implementing inheritance</li>
<li>Extending to multiple inheritance</li>
<li>Understanding polymorphism</li>
<li>Hiding details with abstraction</li>
<li>Protecting information with encapsulation</li>
</ul>
<p>By the end of this chapter, you will be able to understand the concepts of OOP in Python along with some practical examples.</p>
<p class="callout-heading">Note</p>
<p class="callout">This chapter is completely optional, so if you are already familiar with the concepts of OOP, you can proceed directly learning metaprogramming concepts.</p>
<h1 id="_idParaDest-26"><a id="_idTextAnchor028"/>Technical requirements</h1>
<p>The code examples shared in this chapter are available on GitHub under the code for this chapter here: <a href="https://github.com/PacktPublishing/Metaprogramming-with-Python/tree/main/Chapter02">https://github.com/PacktPublishing/Metaprogramming-with-Python/tree/main/Chapter02</a>.</p>
<h1 id="_idParaDest-27"><a id="_idTextAnchor029"/>Introducing our core example</h1>
<p>Throughout this chapter, we <a id="_idIndexMarker048"/>will be making use of a simulated schema <a id="_idIndexMarker049"/>named <em class="italic">ABC Megamart</em> to explain the concepts of OOP. The availability of an object-oriented approach in a programming language helps with effective reusability and abstraction of the language. Our example, <em class="italic">ABC Megamart</em>, is a simulated large retail store that sells multiple products across different cities and consists of multiple branches.</p>
<p>Let us give a structure to different entities of this store and look at how they can fit into an organized OOP paradigm. Our store consists of the following:</p>
<ul>
<li>Products</li>
<li>Branches</li>
<li>Invoices</li>
<li>Holidays</li>
<li>Shelves</li>
<li>Inventory</li>
<li>Sales</li>
<li>Promotions/offers</li>
<li>Exchange counter</li>
<li>Finance</li>
</ul>
<p>Each of these entities can have multiple attributes of data or information that are required to perform multiple functions in the smooth and efficient management of the stores.</p>
<p>Let us explore how <a id="_idIndexMarker050"/>these entities and their attributes can be structured into a software model developed by applying the concepts of OOP:</p>
<ul>
<li>Each of the preceding 10 entities can be connected either directly or indirectly</li>
<li>Each branch will have sales and each sale will have invoices</li>
<li>Each branch city will have holidays and sales can happen during holiday seasons</li>
<li>Each branch (store) can have shelves and products will be placed on shelves</li>
<li>Each product can have promotions or offers and promotions influence sales</li>
</ul>
<p>Thus, multiple entities can be linked together to develop software, maintain a database schema, or both, depending on the application being modeled. Here is a representation of how these entities can be linked:</p>
<div><div><img alt="Figure 2.1 – Example of how a simple linkage can be modeled to connect various entities " height="595" src="img/B13426_02_01.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.1 – Example of how a simple linkage can be modeled to connect various entities</p>
<p>There is more than one way in which we can structure the previous entity model but we are not covering all of them. This is more of a simple representation of the entity relationship at a higher level.</p>
<p>Using this example as the base, let us now dive into the topic of creating classes in Python.</p>
<h1 id="_idParaDest-28"><a id="_idTextAnchor030"/>Creating classes</h1>
<p>A <strong class="bold">class</strong> is a <a id="_idIndexMarker051"/>collection of common attributes and methods that can be reused by creating instances of the class. By creating a class, we define it once and reuse it multiple times, thus avoiding redundancy.</p>
<p>Let us look at what <a id="_idIndexMarker052"/>a class can look like. We can consider the <code>Branch</code> entity of <em class="italic">ABC Megamart.</em> A <code>Branch</code> can have an <code>ID</code> and an <code>Address</code>. <code>Address</code> can further be detailed into <code>Street</code>, <code>City</code>, <code>State</code>, and <code>Zip code</code>. If we consider <code>Branch</code> as a class, <code>ID</code>, <code>Street</code>, <code>City</code>, <code>State</code>, and <code>Zip code</code> would become its attributes. All operations that can be performed by a branch will become its methods.</p>
<p>A branch can sell products, maintain invoices, maintain inventory, and so on. The generic format of a class is as follows:</p>
<div><div><img alt="Figure 2.2 – Class " height="424" src="img/B13426_02_02.jpg" width="233"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.2 – Class</p>
<p>A class can be defined as follows:</p>
<pre class="source-code">class ClassName:  </pre>
<pre class="source-code">    '''attributes...'''        </pre>
<pre class="source-code">    '''methods...'''  </pre>
<p>The format <a id="_idIndexMarker053"/>of the <code>Branch</code> class is as follows:</p>
<div><div><img alt="Figure 2.3 – Branch class " height="406" src="img/B13426_02_03.jpg" width="228"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.3 – Branch class</p>
<p>Similarly, a <code>Branch</code> class can be defined as follows:</p>
<pre class="source-code">class Branch:  </pre>
<pre class="source-code">    '''attributes...'''        </pre>
<pre class="source-code">    '''methods...'''  </pre>
<p>A <code>Branch</code> class can have multiple attributes and methods to perform various operations. These attributes and methods will be initialized as NULLs and added to the class in this example, as shown here:</p>
<pre class="source-code">class Branch:  </pre>
<pre class="source-code">    '''attributes'''  </pre>
<pre class="source-code">    branch_id = None  </pre>
<pre class="source-code">    branch_street = None  </pre>
<pre class="source-code">    branch_city = None  </pre>
<pre class="source-code">    branch_state = None  </pre>
<pre class="source-code">    branch_zip = None  </pre>
<pre class="source-code">    '''methods'''  </pre>
<pre class="source-code">    def get_product(self):  </pre>
<pre class="source-code">        return 'product'        </pre>
<pre class="source-code">    def get_sales(self):  </pre>
<pre class="source-code">        return 'sales'            </pre>
<pre class="source-code">    def get_invoice(self):  </pre>
<pre class="source-code">        return 'invoice'  </pre>
<p>The attributes <a id="_idIndexMarker054"/>of the class can be initialized either with a specific value or as NULL and modified later while defining an object for the class and calling it to perform various functions.</p>
<p>Let us look further into utilizing and modifying these class attributes by creating class objects.</p>
<h1 id="_idParaDest-29"><a id="_idTextAnchor031"/>Understanding objects</h1>
<p>An <code>ClassName</code>.</p>
<p>A class without an <a id="_idIndexMarker056"/>object is practically unusable. All the attributes and methods created for the class can be effectively utilized once we create an object instance, as follows:</p>
<pre class="source-code">obj_name = ClassName()  </pre>
<p>Considering the earlier example of a <code>Branch</code> class, we can create and utilize its objects as follows:</p>
<pre class="source-code">branch_albany = Branch()  </pre>
<p>Now, <code>branch_albany</code> is an instance of the<code>Branch</code> class and all its attributes can be modified for this instance without impacting the attributes within the class definition of <code>Branch</code>. An instance<a id="_idIndexMarker057"/> is more like a copy of the class that can be utilized without affecting the class itself. Let’s take the following code as an example:</p>
<pre class="source-code">branch_albany.branch_id = 123  </pre>
<pre class="source-code">branch_albany.branch_street = '123 Main Street'  </pre>
<pre class="source-code">branch_albany.branch_city = 'Albany'  </pre>
<pre class="source-code">branch_albany.branch_state = 'New York'  </pre>
<pre class="source-code">branch_albany.branch_zip = 12084  </pre>
<p>Calling the preceding defined attributes returns the following values defined for those attributes:</p>
<pre class="source-code">branch_albany.branch_id  </pre>
<pre class="source-code"><strong class="bold">123</strong></pre>
<pre class="source-code">branch_albany.branch_street  </pre>
<pre class="source-code"><strong class="bold">'123 Main Street'</strong></pre>
<p>We can create another object for the <code>Branch</code> class and the class would still remain unaffected. We can then assign a value to <code>branch_id</code> that belongs to the newly created <code>branch</code> object, as follows:</p>
<pre class="source-code">branchNevada = Branch()  </pre>
<pre class="source-code">branchNevada.branch_id  </pre>
<p>Now, <code>branchNevada.branch_id</code> is a variable of the the<code>branchNevada</code> object and it returns no value as it can be defined for this instance:</p>
<pre class="source-code">branchNevada.branch_id = 456  </pre>
<pre class="source-code">branchNevada.branch_id  
<strong class="bold">456</strong></pre>
<p>This is not the only way to define values for class variables using an object. Alternatively, all attributes can be added as parameters to the <code>init</code> method in the class definition and all values for those attributes can be initiated while creating an object instance. To make this work, we <a id="_idIndexMarker058"/>will have to redefine the <code>Branch</code> class, as follows:</p>
<pre class="source-code">class Branch:  </pre>
<pre class="source-code">    def __init__(self, branch_id, branch_street,</pre>
<pre class="source-code">       branch_city, branch_state, branch_zip):  </pre>
<pre class="source-code">        self.branch_id = branch_id  </pre>
<pre class="source-code">        self.branch_street = branch_street  </pre>
<pre class="source-code">        self.branch_city = branch_city  </pre>
<pre class="source-code">        self.branch_state = branch_state  </pre>
<pre class="source-code">        self.branch_zip = branch_zip    </pre>
<pre class="source-code">    def get_product(self):  </pre>
<pre class="source-code">        return 'product'  </pre>
<pre class="source-code">    def get_sales(self):  </pre>
<pre class="source-code">        return 'sales'            </pre>
<pre class="source-code">    def get_invoice(self):  </pre>
<pre class="source-code">        return 'invoice'  </pre>
<p>Creating an object instance for the preceding redefined class in the same method as before would lead to an error:</p>
<pre class="source-code">object_albany = Branch()  </pre>
<p>The following is the error message we receive:</p>
<div><div><img alt="Figure 2.4 – Missing required arguments error " height="163" src="img/B13426_02_04.jpg" width="991"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.4 – Missing required arguments error</p>
<p>Yes, all the <a id="_idIndexMarker059"/>parameters we declared in the <code>init</code> class are missing in the earlier object instantiation. The new object for this class needs to be created with all the values initiated, as follows:</p>
<pre class="source-code">object_albany = Branch(101,'123 Main Street','Albany','New York', 12084)  </pre>
<pre class="source-code">print (object_albany.branch_id, </pre>
<pre class="source-code">       object_albany.branch_street,</pre>
<pre class="source-code">       object_albany.branch_city,</pre>
<pre class="source-code">       object_albany.branch_state,</pre>
<pre class="source-code">       object_albany.branch_zip)  </pre>
<pre class="source-code"><strong class="bold">101 123 Main Street Albany New York 12084</strong></pre>
<p>With this understanding, let us look at the concept of defining methods inside a class and calling them using objects.</p>
<h1 id="_idParaDest-30"><a id="_idTextAnchor032"/>Applying methods</h1>
<p><strong class="bold">Methods</strong> are<a id="_idIndexMarker060"/> similar to the user-defined functions we create to perform various operations in a program, the difference being methods are defined inside a class and are <a id="_idIndexMarker061"/>governed by the rules of the class. Methods can be utilized only by calling them using an object instance created for that class. User-defined functions, on the other hand, are global and can be called freely anywhere within the program. A method can be as simple as printing a statement or can be a highly complex mathematical calculation that involves a large number of parameters.</p>
<p>Defining methods with simple print statements inside the <code>Branch</code> class looks as follows:</p>
<pre class="source-code">class Branch:  </pre>
<pre class="source-code">    def __init__(self, branch_id, branch_street, </pre>
<pre class="source-code">      branch_city, branch_state, branch_zip):           </pre>
<pre class="source-code">        self.branch_id = branch_id  </pre>
<pre class="source-code">        self.branch_street = branch_street  </pre>
<pre class="source-code">        self.branch_city = branch_city  </pre>
<pre class="source-code">        self.branch_state = branch_state  </pre>
<pre class="source-code">        self.branch_zip = branch_zip    </pre>
<pre class="source-code">    def get_product(self):  </pre>
<pre class="source-code">        return 'product'        </pre>
<pre class="source-code">    def get_sales(self):  </pre>
<pre class="source-code">        return 'sales'            </pre>
<pre class="source-code">    def get_invoice(self):  </pre>
<pre class="source-code">        return 'invoice'  </pre>
<pre class="source-code">object_albany = Branch(101,'123 Main Street','Albany','New York', 12084) </pre>
<p>By calling the <a id="_idIndexMarker062"/>preceding methods from <code>object_albany</code>, we will get the following output:</p>
<pre class="source-code">object_albany.get_invoice()  </pre>
<pre class="source-code"><strong class="bold">'invoice'</strong></pre>
<pre class="source-code">object_albany.get_sales()  </pre>
<pre class="source-code"><strong class="bold">'sales'</strong></pre>
<pre class="source-code">object_albany.get_product()  </pre>
<pre class="source-code"><strong class="bold">'product'</strong></pre>
<p>As a variation, we <a id="_idIndexMarker063"/>can look at creating methods with parameters and calculations. For this example, let us consider a scenario where we need to calculate the selling price for a product in a particular branch given the tax rate for the state, the purchase price for the product, and the profit margin. After calculating the selling price of the product, the method should return branch details, product details, selling price, and sales tax.</p>
<p>To write this method, we will create three dictionary variables using Python keyword arguments and name them <code>**branch</code>, <code>**sales</code>, and <code>**product</code>. We will be creating three methods to set values for branch, sales, and product information, as follows:</p>
<pre class="source-code">class Branch:       </pre>
<pre class="source-code">    def set_branch(self, **branch):  </pre>
<pre class="source-code">        return branch        </pre>
<pre class="source-code">    def set_sales(self, **sales):  </pre>
<pre class="source-code">        return sales        </pre>
<pre class="source-code">    def set_product(self, **product):  </pre>
<pre class="source-code">        return product  </pre>
<p>The preceding code takes in all the values that can be included for the branch, sales, and product. We will be creating an object for the <code>Branch</code> class:</p>
<pre class="source-code">branch_nyc = Branch()  </pre>
<p>In the following code, we will make use of the <code>set_branch</code> method to store the values in the <code>branch</code> dictionary variable within the object of <code>Branch</code>:</p>
<pre class="source-code">branch_nyc.branch = branch_nyc.set_branch(branch_id = 202,  </pre>
<pre class="source-code">branch_street = '234 3rd Main Street',  </pre>
<pre class="source-code">branch_city = 'New York City',  </pre>
<pre class="source-code">branch_state = 'New York',  </pre>
<pre class="source-code">branch_zip = 11005)  </pre>
<p>We will now call the <code>branch</code> attribute on the <code>branch_nyc</code> object, as follows:</p>
<pre class="source-code">branch_nyc.branch</pre>
<p>Executing the <a id="_idIndexMarker064"/>preceding code results in the following output, which is a dictionary of <code>branch_id</code> along with its address:</p>
<pre class="source-code"><strong class="bold">{'branch_id': 202,</strong></pre>
<pre class="source-code"><strong class="bold"> 'branch_street': '234 3rd Main Street',</strong></pre>
<pre class="source-code"><strong class="bold"> 'branch_city': 'New York City',</strong></pre>
<pre class="source-code"><strong class="bold"> 'branch_state': 'New York',</strong></pre>
<pre class="source-code"><strong class="bold"> 'branch_zip': 11005}</strong></pre>
<p>Similarly, in the following code, we will make use of the <code>set_product</code> method to store the values in the <code>product</code> dictionary variable within the object of <code>Branch</code>:</p>
<pre class="source-code">branch_nyc.product = branch_nyc.set_product(  </pre>
<pre class="source-code">    product_id = 100001,  </pre>
<pre class="source-code">    product_name = 'Refrigerator',  </pre>
<pre class="source-code">    productBrand = 'Whirlpool'  )</pre>
<p>We will now call the <code>product</code> attribute on the <code>branch_nyc</code> object, as follows:</p>
<pre class="source-code">branch_nyc.product</pre>
<p>Executing the preceding code results in the following output, which is a dictionary of all product IDs along with their details:</p>
<pre>{'product_id': 100001,
 'product_name': 'Refrigerator',
 'productBrand': 'Whirlpool'}</pre>
<p>Similarly, in the following code, we will make use of the <code>set_sales</code> method to store the values in the <code>sales</code> dictionary variable within the object of <code>Branch</code>:</p>
<pre class="source-code">branch_nyc.sales = branch_nyc.set_sales(  </pre>
<pre class="source-code">    purchase_price = 300,  </pre>
<pre class="source-code">    profit_margin = 0.20,  </pre>
<pre class="source-code">    tax_rate = 0.452  </pre>
<pre class="source-code">)  </pre>
<p>We will now <a id="_idIndexMarker065"/>call the <code>sales</code> attribute on the <code>branch_nyc</code> object, as follows:</p>
<pre class="source-code">branch_nyc.sales</pre>
<p>Executing the preceding code results in the following output, which is a dictionary of all sales information:</p>
<pre>{'purchase_price': 300,
 'profit_margin': 0.2,
 'tax_rate': 0.452,
 'selling_price': 522.72}</pre>
<p>Calculating the selling price will be done in the following two steps:</p>
<ol>
<li>Calculate the price before tax by adding the purchase price with the product between the purchase price and profit margin percentage.</li>
<li>Calculate the selling price by adding the price before tax, with the product between price before tax and sales tax rate.</li>
</ol>
<p>In the following code, we will include the <code>calc_tax</code> method to perform the preceding calculation steps and to return the branch details along with product information and sales data:</p>
<pre class="source-code">class Branch:  </pre>
<pre class="source-code">     def set_branch(self, **branch):  </pre>
<pre class="source-code">        return branch        </pre>
<pre class="source-code">    def set_sales(self, **sales):  </pre>
<pre class="source-code">        return sales        </pre>
<pre class="source-code">    def set_product(self, **product):  </pre>
<pre class="source-code">        return product    </pre>
<pre class="source-code">    def calc_tax(self):  </pre>
<pre class="source-code">        branch = self.branch  </pre>
<pre class="source-code">        product = self.product  </pre>
<pre class="source-code">        sales = self.sales  </pre>
<pre class="source-code">        pricebeforetax = sales['purchase_price'] + \</pre>
<pre class="source-code">        sales['purchase_price'] * sales['profit_margin']  </pre>
<pre class="source-code">        finalselling_price = pricebeforetax + \</pre>
<pre class="source-code">        (pricebeforetax * sales['tax_rate'])  </pre>
<pre class="source-code">        sales['selling_price'] = finalselling_price  </pre>
<pre class="source-code">        return branch, product, sales  </pre>
<p>Calling the<a id="_idIndexMarker066"/> preceding function provides the following results:</p>
<pre class="source-code">branch_nyc.calc_tax()</pre>
<pre class="source-code"><strong class="bold">({'branch_id': 202,</strong></pre>
<pre class="source-code"><strong class="bold">  'branch_street': '234 3rd Main Street',</strong></pre>
<pre class="source-code"><strong class="bold">  'branch_city': 'New York City',</strong></pre>
<pre class="source-code"><strong class="bold">  'branch_state': 'New York',</strong></pre>
<pre class="source-code"><strong class="bold">  'branch_zip': 11005},</strong></pre>
<pre class="source-code"><strong class="bold"> {'product_id': 100001,</strong></pre>
<pre class="source-code"><strong class="bold">  'product_name': 'Refrigerator',</strong></pre>
<pre class="source-code"><strong class="bold">  'productBrand': 'Whirlpool'},</strong></pre>
<pre class="source-code"><strong class="bold"> {'purchase_price': 300,</strong></pre>
<pre class="source-code"><strong class="bold">  'profit_margin': 0.2,</strong></pre>
<pre class="source-code"><strong class="bold">  'tax_rate': 0.452,</strong></pre>
<pre class="source-code"><strong class="bold">  'selling_price': 522.72})</strong></pre>
<p>Now that we <a id="_idIndexMarker067"/>know how to apply methods, we can look further into the concept of inheritance.</p>
<h1 id="_idParaDest-31"><a id="_idTextAnchor033"/>Implementing inheritance</h1>
<p><strong class="bold">Inheritance</strong> in<a id="_idIndexMarker068"/> a literal sense means acquiring the properties of a parent by the child, and it means the same in the case of OOP too. A new class can inherit the <a id="_idIndexMarker069"/>attributes and methods of a parent class and it can also have its own properties and methods. The new class that inherits the parent class will be called a child class or a subclass while the parent class can also be called a base class. The following is a simple representation of it:</p>
<div><div><img alt="Figure 2.5 – Inheritance " height="299" src="img/B13426_02_05.jpg" width="585"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.5 – Inheritance</p>
<p>Extending our latest class definition of <code>Branch</code> to have an individual class for <code>NYC</code>—since it has multiple intra-city branches and it also has other properties of its own in addition to the <code>Branch</code> class—we will be applying Inheritance to create a new subclass or child class named <code>NYC</code>. It has propertiessuch as having multiple hierarchies of management. NYC has a regional manager and each branch has its own branch manager. For NYC, we will <a id="_idIndexMarker070"/>also add an additional local tax component to the calculation of the selling price, which varies from branch to branch.</p>
<div><div><img alt="Figure 2.6 – NYC class inherits from Branch class " height="393" src="img/B13426_02_06.jpg" width="597"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.6 – NYC class inherits from Branch class</p>
<p>The general structure of inheritance while defining a child class inheriting from a parent class looks as follows:</p>
<pre class="source-code">class Parent:  </pre>
<pre class="source-code">    '''attributes...'''  </pre>
<pre class="source-code">      </pre>
<pre class="source-code">    '''methods...'''   </pre>
<pre class="source-code">class Child(Parent):  </pre>
<pre class="source-code">    '''attributes...'''  </pre>
<pre class="source-code">  </pre>
<pre class="source-code">    '''methods...'''  </pre>
<p>Inheriting the <code>NYC</code> child class from the <code>Branch</code> parent class can be defined as follows:</p>
<pre class="source-code">class NYC(Branch):  </pre>
<pre class="source-code">    def set_management(self, **intercitybranch):  </pre>
<pre class="source-code">        return intercitybranch  </pre>
<pre class="source-code">      </pre>
<pre class="source-code">    def calc_tax_nyc(self):  </pre>
<pre class="source-code">        branch = self.branch  </pre>
<pre class="source-code">        intercitybranch = self.intercitybranch  </pre>
<pre class="source-code">        product = self.product  </pre>
<pre class="source-code">        sales = self.sales  </pre>
<pre class="source-code">        pricebeforetax = sales['purchase_price'] + \</pre>
<pre class="source-code">        sales['purchase_price'] * sales['profit_margin']  </pre>
<pre class="source-code">        finalselling_price = pricebeforetax + \</pre>
<pre class="source-code">        (pricebeforetax * (sales['tax_rate'] +\</pre>
<pre class="source-code">         sales['local_rate']))    </pre>
<pre class="source-code">        sales['selling_price'] = finalselling_price  </pre>
<pre class="source-code">        return branch,intercitybranch, product, sales    </pre>
<p>Let us examine <a id="_idIndexMarker071"/>the proceeding code before going any further with object creation. The<code>NYC</code> subclass has its own additional attribute, <code>intercitybranch</code>, introduced as a parameter in its own method, <code>set_management</code>. NYC also has its own method to calculate tax, <code>calc_tax_nyc</code>. The <code>calc_tax_nyc</code> method in NYC includes an additional component, <code>local_rate</code>, to calculate the selling price.</p>
<p>Now, let us examinewhether NYC can make use of the methods of the <code>Branch</code> class to set the new values for branch, product, and sales:</p>
<pre class="source-code">branch_manhattan = NYC()</pre>
<p>By examining the methods that are available in the <code>branch_manhattan</code> object, as shown in the following screenshot, we can see that NYC can make use of the set methods <a id="_idIndexMarker072"/>defined in the <code>Branch</code> class:</p>
<div><div><img alt="Figure 2.7 – Set methods inherited from Branch " height="324" src="img/B13426_02_07.jpg" width="382"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.7 – Set methods inherited from Branch</p>
<p>We can proceed further by setting attributes using all of these methods and calculating the selling price after sales tax and local tax rate for the Manhattan branch, as follows:</p>
<pre class="source-code">branch_manhattan.branch = branch_manhattan.set_branch(branch_id = 2021,  </pre>
<pre class="source-code">branch_street = '40097 5th Main Street',  </pre>
<pre class="source-code">branch_borough = 'Manhattan',</pre>
<pre class="source-code">branch_city = 'New York City',  </pre>
<pre class="source-code">branch_state = 'New York',  </pre>
<pre class="source-code">branch_zip = 11007)  </pre>
<p>We will call the <code>branch</code> attribute on the <code>branch_manhattan</code> object, as follows:</p>
<pre class="source-code">branch_manhattan.branch</pre>
<pre class="source-code"><strong class="bold">{'branch_id': 2021,</strong></pre>
<pre class="source-code"><strong class="bold"> 'branch_street': '40097 5th Main Street',</strong></pre>
<pre class="source-code"><strong class="bold"> 'branch_borough': 'Manhattan',</strong></pre>
<pre class="source-code"><strong class="bold"> 'branch_city': 'New York City',</strong></pre>
<pre class="source-code"><strong class="bold"> 'branch_state': 'New York',</strong></pre>
<pre class="source-code"><strong class="bold"> 'branch_zip': 11007}</strong></pre>
<p>In the <a id="_idIndexMarker073"/>following code, we will make use of the <code>set_management</code> method to store the values in the <code>intercitybranch</code> dictionary variable within the object of NYC:</p>
<pre class="source-code">branch_manhattan.intercitybranch = branch_manhattan.set_management(  </pre>
<pre class="source-code">    regional_manager = 'John M',  </pre>
<pre class="source-code">    branch_manager = 'Tom H',  </pre>
<pre class="source-code">    subBranch_id = '2021-01'      </pre>
<pre class="source-code">)  </pre>
<p>Let’s call the <code>intercitybranch</code> attribute on the <code>branch_manhattan</code> object, as follows:</p>
<pre class="source-code">branch_manhattan.intercitybranch</pre>
<pre class="source-code"><strong class="bold">{'regional_manager': 'John M',</strong></pre>
<pre class="source-code"><strong class="bold"> 'branch_manager': 'Tom H',</strong></pre>
<pre class="source-code"><strong class="bold"> 'subBranch_id': '2021-01'}</strong></pre>
<p>Similarly, in the following code, we will make use of the <code>set_product</code> method to store the values in the <code>product</code> dictionary variable within the object of NYC:</p>
<pre class="source-code">branch_manhattan.product = branch_manhattan.set_product(  </pre>
<pre class="source-code">    product_id = 100002,  </pre>
<pre class="source-code">    product_name = 'WashingMachine',  </pre>
<pre class="source-code">    productBrand = 'Whirlpool'    </pre>
<pre class="source-code">)  </pre>
<p>We will now call the <code>product</code> attribute on the <code>branch_manhattan</code> object:</p>
<pre class="source-code">branch_manhattan.product</pre>
<pre class="source-code"><strong class="bold">{'product_id': 100002,</strong></pre>
<pre class="source-code"><strong class="bold"> 'product_name': 'WashingMachine',</strong></pre>
<pre class="source-code"><strong class="bold"> 'productBrand': 'Whirlpool'}</strong></pre>
<p>Similarly, in<a id="_idIndexMarker074"/> the following code, we will make use of the <code>set_sales</code> method to store the values in the <code>sales</code> dictionary variable within the object of NYC:</p>
<pre class="source-code">branch_manhattan.sales = branch_manhattan.set_sales(  </pre>
<pre class="source-code">    purchase_price = 450,  </pre>
<pre class="source-code">    profit_margin = 0.19,  </pre>
<pre class="source-code">    tax_rate = 0.4,  </pre>
<pre class="source-code">    local_rate = 0.055      </pre>
<pre class="source-code">) </pre>
<p>We will further call the <code>sales</code> attribute on the <code>branch_manhattan</code> object, as follows:</p>
<pre class="source-code">branch_manhattan.sales
{'purchase_price': 450,
 'profit_margin': 0.19,
 'tax_rate': 0.4,
 'local_rate': 0.055}</pre>
<p>With all the preceding attributes and their value assignments, we can calculate tax for the Manhattan<a id="_idIndexMarker075"/> branch using the following code:</p>
<pre class="source-code">branch_manhattan.calc_tax_nyc()</pre>
<pre class="source-code">({'branch_id': 2021,</pre>
<pre class="source-code">  'branch_street': '40097 5th Main Street',</pre>
<pre class="source-code">  'branch_borough': 'Manhattan',</pre>
<pre class="source-code">  'branch_city': 'New York City',</pre>
<pre class="source-code">  'branch_state': 'New York',</pre>
<pre class="source-code">  'branch_zip': 11007},</pre>
<pre class="source-code"> {'regional_manager': 'John M',</pre>
<pre class="source-code">  'branch_manager': 'Tom H',</pre>
<pre class="source-code">  'subBranch_id': '2021-01'},</pre>
<pre class="source-code"> {'product_id': 100002,</pre>
<pre class="source-code">  'product_name': 'WashingMachine',</pre>
<pre class="source-code">  'productBrand': 'Whirlpool'},</pre>
<pre class="source-code"> {'purchase_price': 450,</pre>
<pre class="source-code">  'profit_margin': 0.19,</pre>
<pre class="source-code">  'tax_rate': 0.4,</pre>
<pre class="source-code">  'local_rate': 0.055,</pre>
<pre class="source-code"><strong class="bold">  'selling_price': 779.1525})</strong></pre>
<p>We can still make use of the <code>calc_tax</code> method available in the <code>Branch</code> class if we don’t want to calculate the selling price based on the local tax rate:</p>
<pre class="source-code">branch_manhattan.calc_tax()</pre>
<pre class="source-code">({'branch_id': 2021,</pre>
<pre class="source-code">  'branch_street': '40097 5th Main Street',</pre>
<pre class="source-code">  'branch_borough': 'Manhattan',</pre>
<pre class="source-code">  'branch_city': 'New York City',</pre>
<pre class="source-code">  'branch_state': 'New York',</pre>
<pre class="source-code">  'branch_zip': 11007},</pre>
<pre class="source-code"> {'product_id': 100002,</pre>
<pre class="source-code">  'product_name': 'WashingMachine',</pre>
<pre class="source-code">  'productBrand': 'Whirlpool'},</pre>
<pre class="source-code"> {'purchase_price': 450,</pre>
<pre class="source-code">  'profit_margin': 0.19,</pre>
<pre class="source-code">  'tax_rate': 0.4,</pre>
<pre class="source-code">  'local_rate': 0.055,</pre>
<pre class="source-code"><strong class="bold">  'selling_price': 749.7})</strong></pre>
<p>The preceding <a id="_idIndexMarker076"/>code and its output demonstrate the reusable nature of inheritance in OOP. Now let’s look at an extended concept called multiple inheritance.</p>
<h1 id="_idParaDest-32"><a id="_idTextAnchor034"/>Extending to multiple inheritance</h1>
<p>Python <a id="_idIndexMarker077"/>also supports <code>Product</code> and <code>Branch</code>, and let the <code>Sales</code> class inherit both these base classes. Here is a quick representation of the logic we’d be using:</p>
<div><div><img alt="Figure 2.8 – Multiple inheritance example " height="491" src="img/B13426_02_08.jpg" width="722"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.8 – Multiple inheritance example</p>
<p>In the following <a id="_idIndexMarker078"/>code, we will be creating a <code>Product</code> class where we will define the attributes for a product and a <code>get_product</code> method to return the product details:</p>
<pre class="source-code">class Product:  </pre>
<pre class="source-code">    _product_id = 100902  </pre>
<pre class="source-code">    _product_name = 'Iphone X'  </pre>
<pre class="source-code">    _product_category = 'Electronics'  </pre>
<pre class="source-code">    _unit_price = 700  </pre>
<pre class="source-code">      </pre>
<pre class="source-code">    def get_product(self):  </pre>
<pre class="source-code">        return self._product_id, self._product_name,\</pre>
<pre class="source-code">           self._product_category, self._unit_price  </pre>
<p>We will also be creating another class, <code>Branch</code>, where we will define the attributes for a branch and a <code>get_branch</code> method to return the branch details:</p>
<pre class="source-code">class Branch:  </pre>
<pre class="source-code">    _branch_id = 2021  </pre>
<pre class="source-code">    _branch_street = '40097 5th Main Street'  </pre>
<pre class="source-code">    _branch_borough = 'Manhattan'  </pre>
<pre class="source-code">    _branch_city = 'New York City'  </pre>
<pre class="source-code">    _branch_state = 'New York'  </pre>
<pre class="source-code">    _branch_zip = 11007  </pre>
<pre class="source-code">      </pre>
<pre class="source-code">    def get_branch(self):  </pre>
<pre class="source-code">        return self._branch_id, self._branch_street, \</pre>
<pre class="source-code">          self._branch_borough, self._branch_city, \</pre>
<pre class="source-code">          self._branch_state, self._branch_zip  </pre>
<p>We will be implementing<a id="_idIndexMarker079"/> the concept of multiple inheritance by inheriting two parent classes, <code>Product</code> and <code>Branch</code>, into the child class, <code>Sales</code>:</p>
<pre class="source-code">class Sales(Product, Branch):  </pre>
<pre class="source-code">    date = '08/02/2021'  </pre>
<pre class="source-code">    def get_sales(self):  </pre>
<pre class="source-code">        return self.date, Product.get_product(self), \</pre>
<pre class="source-code">          Branch.get_branch(self)  </pre>
<p>In the preceding code, the <code>Sales</code> class inherited two methods, <code>get_product</code>, and <code>get_branch</code>, from the <code>Product</code> class and the <code>Branch</code> class, respectively.</p>
<p>In the following code, we will be creating an object for the <code>Sales</code> class:</p>
<pre class="source-code">sales = Sales()</pre>
<p>Calling the <code>get_sales</code> method from the <code>Sales</code> class results in returning the <code>date</code> attribute <a id="_idIndexMarker080"/>from the <code>Sales</code> class along with the <code>product</code> and <code>branch</code> attributes from its parent classes:</p>
<pre class="source-code">sales.get_sales()</pre>
<pre class="source-code"><strong class="bold">('08/02/2021',</strong></pre>
<pre class="source-code"><strong class="bold"> (100902, 'Iphone X', 'Electronics', 700),</strong></pre>
<pre class="source-code"><strong class="bold"> (2021,</strong></pre>
<pre class="source-code"><strong class="bold">  '40097 5th Main Street</strong>'<strong class="bold">,</strong></pre>
<pre class="source-code"><strong class="bold">  'Manhattan',</strong></pre>
<pre class="source-code"><strong class="bold">  'New York City',</strong></pre>
<pre class="source-code"><strong class="bold">  'New York',</strong></pre>
<pre class="source-code"><strong class="bold">  11007))</strong></pre>
<p>With these examples, we can proceed further to understand the concept of polymorphism, which extends on our earlier examples of inheritance.</p>
<h1 id="_idParaDest-33"><a id="_idTextAnchor035"/>Understanding polymorphism</h1>
<p><strong class="bold">Polymorphism</strong> is the <a id="_idIndexMarker081"/>concept of the OOP paradigm where we can reuse the name of a function from a parent class either by redefining or overriding an existing function or by creating two different functions for two different classes with the same name and using them separately. In this section, we will look at examples for both variations of polymorphism:</p>
<ul>
<li>Polymorphism within inheritance</li>
<li>Polymorphism in independent classes</li>
</ul>
<h2 id="_idParaDest-34"><a id="_idTextAnchor036"/>Polymorphism within inheritance</h2>
<p>Let us look <a id="_idIndexMarker082"/>at the earlier example of the child class, <code>NYC</code>, which inherits from <code>Branch</code>. To calculate the selling price along with the local tax rate for the specific branch, we created a new method within the <code>NYC</code> class named <code>calc_tax_nyc</code>. Instead of creating a new method, we can also override the <code>Parent</code> method, <code>calc_tax</code>, with the new calculation in the child class. This concept is polymorphism within inheritance. Here is a representation of it:</p>
<div><div><img alt="Figure 2.9 – calc_tax method overridden in child class, NYC " height="363" src="img/B13426_02_09.jpg" width="566"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.9 – calc_tax method overridden in child class, NYC</p>
<p>To begin with, polymorphism, let us first recall the <code>calc_tax</code> method from the <code>Branch</code> class, and then we can override it in the child class, <code>NYC</code>:</p>
<pre class="source-code">class Branch:</pre>
<pre class="source-code">    def calc_tax(self):</pre>
<pre class="source-code">        branch = self.branch</pre>
<pre class="source-code">        product = self.product</pre>
<pre class="source-code">        sales = self.sales</pre>
<pre class="source-code">        pricebeforetax = sales['purchase_price'] + \</pre>
<pre class="source-code">        sales['purchase_price'] * sales['profit_margin']</pre>
<pre class="source-code">        finalselling_price = pricebeforetax + \</pre>
<pre class="source-code">        (pricebeforetax * sales['tax_rate'])</pre>
<pre class="source-code">        sales['selling_price'] = finalselling_price</pre>
<pre class="source-code">        return branch, product, sales</pre>
<p>We will now <a id="_idIndexMarker083"/>define the <code>NYC</code> class by inheriting the <code>Branch</code> class. This class has two methods, <code>set_management</code> and <code>calc_tax</code>. The <code>set_management</code> method returns <code>intercitybranch</code> as a dictionary attribute. The <code>calc_tax</code> method is now overridden in the child class, <code>NYC</code>, and it returns branch details, intercity branch details, product details, and sales details:</p>
<pre class="source-code">class NYC(Branch):  </pre>
<pre class="source-code">    def set_management(self, **intercitybranch):  </pre>
<pre class="source-code">        return intercitybranch  </pre>
<pre class="source-code">      </pre>
<pre class="source-code"><strong class="bold">    def calc_tax(self):  </strong></pre>
<pre class="source-code">        branch = self.branch  </pre>
<pre class="source-code">        intercitybranch = self.intercitybranch  </pre>
<pre class="source-code">        product = self.product  </pre>
<pre class="source-code">        sales = self.sales  </pre>
<pre class="source-code">        pricebeforetax = sales['purchase_price'] + \</pre>
<pre class="source-code">        sales['purchase_price'] * sales['profit_margin']  </pre>
<pre class="source-code">        finalselling_price = pricebeforetax + \</pre>
<pre class="source-code">        (pricebeforetax * (sales['tax_rate'] + \</pre>
<pre class="source-code">        sales['local_rate']))    </pre>
<pre class="source-code">        sales['selling_price'] = finalselling_price  </pre>
<pre class="source-code">        return branch,intercitybranch, product, sales     </pre>
<pre class="source-code"><strong class="bold">branch_manhattan = NYC()</strong></pre>
<p>The following is a representation of all the methods supported by the <code>branch_manhattan</code> object of the child class, <code>NYC</code>:</p>
<div><div><img alt="Figure 2.10 – calc_tax after polymorphism " height="153" src="img/B13426_02_10.jpg" width="302"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"> </p>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.10 – calc_tax after polymorphism</p>
<p>The <a id="_idIndexMarker084"/>following code displays the results of calling the <code>calc_tax</code> method from <code>branch_manhattan</code>, which is the method overridden from its parent class to calculate the selling price after applying the local tax rate:</p>
<pre class="source-code">branch_manhattan.calc_tax()</pre>
<pre class="source-code">({'branch_id': 2021,</pre>
<pre class="source-code">  'branch_street': '40097 5th Main Street',</pre>
<pre class="source-code">  'branch_borough': 'Manhattan',</pre>
<pre class="source-code">  'branch_city': 'New York City',</pre>
<pre class="source-code">  'branch_state': 'New York',</pre>
<pre class="source-code">  'branch_zip': 11007},</pre>
<pre class="source-code"> {'regional_manager': 'John M',</pre>
<pre class="source-code">  'branch_manager': 'Tom H',</pre>
<pre class="source-code">  'subBranch_id': '2021-01'},</pre>
<pre class="source-code"> {'product_id': 100002,</pre>
<pre class="source-code">  'product_name': 'WashingMachine',</pre>
<pre class="source-code">  'productBrand': 'Whirlpool'},</pre>
<pre class="source-code"> {'purchase_price': 450,</pre>
<pre class="source-code">  'profit_margin': 0.19,</pre>
<pre class="source-code">  'tax_rate': 0.4,</pre>
<pre class="source-code">  'local_rate': 0.055,</pre>
<pre class="source-code"><strong class="bold">  'selling_price': 779.1525})</strong></pre>
<p>As we can <a id="_idIndexMarker085"/>see, the <code>calc_tax</code> method returns the output as defined in NYC.</p>
<h2 id="_idParaDest-35"><a id="_idTextAnchor037"/>Polymorphism in independent classes</h2>
<p>Polymorphism <a id="_idIndexMarker086"/>need not always happen in a <em class="italic">parent-childpc</em> class relationship. We can always have two completely different classes that can have two different function definitions with the same name and the functions can both be utilized by calling them using their class object instances.</p>
<p>For this example, we will be creating two independent classes, <code>Queens</code> and <code>Brooklyn</code>,, which are two different branches of <em class="italic">ABC Megamart</em>. We will not associate these branches with the <code>Branch</code> parent class in order to explain the concept of polymorphism in independent classes. The Brooklyn branch stocks only <code>maintenance_cost</code>, and defining them according to the requirements of storage for each branch.</p>
<div><div><img alt="Figure 2.11 – Polymorphism of one method in independent classes " height="149" src="img/B13426_02_11.jpg" width="636"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.11 – Polymorphism of one method in independent classes</p>
<p>In the following code, for the <code>Brooklyn</code> class, we will calculate the maintenance cost only if the product type is <code>FMCG</code>. We will calculate the product of quantity costing 0.25 and add 100 USD for cold storage. If the product type is anything other than FMCG, we will notify you<a id="_idIndexMarker088"/> that the product will not be stocked. Let’s take a look at the code:</p>
<pre class="source-code">class Brooklyn:  </pre>
<pre class="source-code">    def maintenance_cost(self, product_type, quantity):  </pre>
<pre class="source-code">        self.product_type = product_type  </pre>
<pre class="source-code">        self.quantity = quantity  </pre>
<pre class="source-code">        coldstorage_cost = 100  </pre>
<pre class="source-code">        if (product_type == 'FMCG'):  </pre>
<pre class="source-code">            maintenance_cost = self.quantity * 0.25 + \</pre>
<pre class="source-code">              coldstorage_cost      </pre>
<pre class="source-code">            return maintenance_cost  </pre>
<pre class="source-code">        else:  </pre>
<pre class="source-code">            return "We don't stock this product"  </pre>
<p>In the following code, for the <code>Queens</code> class, we will calculate maintenance cost only if the product type is <code>Electronics</code>. We will calculate the product of quantity costing 0.05 since the maintenance cost for electronics is lower and there is also no cold storage cost required here. If the product type is anything other than <code>Electronics</code>, we will notify that the product will not be stocked:</p>
<pre class="source-code">class Queens:  </pre>
<pre class="source-code">    def maintenance_cost(self, product_type, quantity):  </pre>
<pre class="source-code">        self.product_type = product_type  </pre>
<pre class="source-code">        self.quantity = quantity  </pre>
<pre class="source-code">        if (product_type == 'Electronics'):  </pre>
<pre class="source-code">            maintenance_cost = self.quantity * 0.05  </pre>
<pre class="source-code">            return maintenance_cost  </pre>
<pre class="source-code">        else:  </pre>
<pre class="source-code">            return "We don't stock this product"  </pre>
<p>Please <a id="_idIndexMarker089"/>note that we have used the same function names in both the preceding examples. The next step is to call these functions. Each of these functions can be called by creating an object for each class and the functions can be accessed separately to perform different calculations even when they are used within the same program:</p>
<pre class="source-code">object_brooklyn = Brooklyn()  </pre>
<pre class="source-code">object_queens = Queens()  </pre>
<pre class="source-code">object_brooklyn.maintenance_cost('FMCG', 2000)  </pre>
<pre class="source-code"><strong class="bold">600.0</strong></pre>
<pre class="source-code">object_queens.maintenance_cost('Electronics', 2000)  </pre>
<pre class="source-code"><strong class="bold">100.0</strong></pre>
<p>We now have an understanding of the concept of polymorphism within classes. We will next look at abstraction, which behaves along the same lines as polymorphism but with a difference that will be explained further in the coming section.</p>
<h1 id="_idParaDest-36"><a id="_idTextAnchor038"/>Hiding details with abstraction</h1>
<p><code>ABC</code> that can be imported to define abstract base classes. Abstraction is more like giving a black box to external users by not revealing all the details of various methods defined inside a class but instead giving a reference class that can help the external users to implement the methods according to their own requirements.</p>
<p>For instance, the <a id="_idIndexMarker093"/>users of the Brooklyn branch don’t have to know the calculations that are handled by the Queens branch to calculate their maintenance cost. The information that the users of the Brooklyn branch need to know is that they can inherit the <code>Branch</code> class and implement the calculations for maintenance costs according to their own books and they need not worry about how the Queens branch is calculating their maintenance costs. At the same time, the <code>Branch</code> class, which is their parent class, will not be able to provide one common implementation for calculating maintenance costs since the calculations are going to vary depending on the branch. In this kind of scenario, the <code>Branch</code> class can create an abstract method, <code>maintenance_cost</code>, and let its subclasses or child classes implement it according to their requirements. The implementation of the <code>maintenance_cost</code> method by Brooklyn will not impact the implementation of the same method by Queens; the purpose of the implementation ends within the child class and the parent abstract class is always available for other child classes to define their own implementation. </p>
<p>If this kind of implementation can be done by simply applying polymorphism to a parent class method, then why do we need an abstract class to do the same? Let us first look at this by implementing a parent class and its child classes without actually implementing it as an abstract class:</p>
<pre class="source-code">class Branch():     </pre>
<pre class="source-code">    def <strong class="bold">maintenance_cost(self):     </strong></pre>
<pre class="source-code">        pass    </pre>
<pre class="source-code">        </pre>
<pre class="source-code">class <strong class="bold">Brooklyn(Branch):</strong>     </pre>
<pre class="source-code">    def maintenance_cost(self, product_type, quantity):    </pre>
<pre class="source-code">        self.product_type = product_type    </pre>
<pre class="source-code">        self.quantity = quantity    </pre>
<pre class="source-code">        coldstorage_cost = 100    </pre>
<pre class="source-code">        if (product_type == 'FMCG'):    </pre>
<pre class="source-code">            maintenance_cost = self.quantity * 0.25 + \</pre>
<pre class="source-code">              coldstorage_cost        </pre>
<pre class="source-code">            return maintenance_cost    </pre>
<pre class="source-code">        else:    </pre>
<pre class="source-code">            return "We don't stock this product"    </pre>
<pre class="source-code">            </pre>
<pre class="source-code">class <strong class="bold">Queens(Branch):</strong>    </pre>
<pre class="source-code">    def maintenance_cost(self, product_type, quantity):    </pre>
<pre class="source-code">        self.product_type = product_type    </pre>
<pre class="source-code">        self.quantity = quantity    </pre>
<pre class="source-code">        if (product_type == 'Electronics'):    </pre>
<pre class="source-code">            maintenance_cost = self.quantity * 0.05    </pre>
<pre class="source-code">            return maintenance_cost    </pre>
<pre class="source-code">        else:    </pre>
<pre class="source-code">            return "We don't stock this product"    </pre>
<p>In the <a id="_idIndexMarker094"/>preceding implementation, we have two child classes for the <code>Branch</code> class and we have applied polymorphism to override the parent method, but it is still not an abstraction since we will be able to create an object instance for the parent class and the methods of the parent class can be exposed when an object is created.</p>
<p>Instead of the preceding implementation, if we make a slight modification and create <code>Branch</code> as an abstract base class, let us look at what happens then. Here is the representation of what we are going for:</p>
<div><div><img alt="Figure 2.12 -– Abstract class is inherited by two classes and the methods implemented " height="457" src="img/B13426_02_12.jpg" width="614"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.12 -– Abstract class is inherited by two classes and the methods implemented</p>
<p>Here, we <a id="_idIndexMarker095"/>will be importing <code>ABC</code> and <code>abstractmethod</code> from the <code>abc</code> library and we will create an abstract class called <code>Branch</code> followed by two child classes, <code>Brooklyn</code> and <code>Queens</code>, which inherit the parent class, <code>Branch</code>:</p>
<pre class="source-code"><strong class="bold">from abc</strong><strong class="bold"> import ABC,abstractmethod   </strong></pre>
<pre class="source-code">class Branch(ABC):   </pre>
<pre class="source-code">    <strong class="bold">@abstractmethod  </strong></pre>
<pre class="source-code">    def maintenance_cost(self):   </pre>
<pre class="source-code">        pass  </pre>
<pre class="source-code">      </pre>
<pre class="source-code">class Brooklyn(Branch):   </pre>
<pre class="source-code">    def maintenance_cost(self, product_type, quantity):  </pre>
<pre class="source-code">        self.product_type = product_type  </pre>
<pre class="source-code">        self.quantity = quantity  </pre>
<pre class="source-code">        coldstorage_cost = 100  </pre>
<pre class="source-code">        if (product_type == 'FMCG'):  </pre>
<pre class="source-code">            maintenance_cost = self.quantity * 0.25 + \</pre>
<pre class="source-code">              coldstorage_cost      </pre>
<pre class="source-code">            return maintenance_cost  </pre>
<pre class="source-code">        else:  </pre>
<pre class="source-code">            return "We don't stock this product"  </pre>
<pre class="source-code">          </pre>
<pre class="source-code">class Queens(Branch):  </pre>
<pre class="source-code">    def maintenance_cost(self, product_type, quantity):  </pre>
<pre class="source-code">        self.product_type = product_type  </pre>
<pre class="source-code">        self.quantity = quantity  </pre>
<pre class="source-code">        if (product_type == 'Electronics'):  </pre>
<pre class="source-code">            maintenance_cost = self.quantity * 0.05  </pre>
<pre class="source-code">            return maintenance_cost  </pre>
<pre class="source-code">        else:  </pre>
<pre class="source-code">            return "We don't stock this product"  </pre>
<p>We<a id="_idIndexMarker096"/> imported the <code>ABC</code> library, created <code>Branch</code> as an abstract class, and defined <code>maintenance_cost</code> as an abstract method using the <code>@abstractmethod</code> keyword.</p>
<p>Let us now try to create an object of the <code>Branch</code> class:</p>
<pre class="source-code">branch = Branch()</pre>
<p>It throws the following error:</p>
<div><div><img alt="Figure 2.13 – Abstract method instantiation error " height="163" src="img/B13426_02_13.jpg" width="862"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.13 – Abstract method instantiation error</p>
<p>If an <a id="_idIndexMarker097"/>object is instantiated for a class, all the attributes and methods of the class can be accessed through the object. It is possible in regular classes; whereas, in the case of an abstract class, an object cannot be instantiated. This is why it is helpful to hide information that need not be shared with external users. </p>
<p>Abstraction is a method of information protection in Python or any other OOP language. We will now look at encapsulation and more details on how information can be protected in a class.</p>
<h1 id="_idParaDest-37"><a id="_idTextAnchor039"/>Protecting information with encapsulation</h1>
<p><code>__</code> (double underscore) and protected members or variables are prefixed by <code>_</code> (single underscore). We will look at some examples of private and protected class members.</p>
<h2 id="_idParaDest-38"><a id="_idTextAnchor040"/>Private members</h2>
<p>In Python, the <a id="_idIndexMarker102"/>concept of a private variable does not exist as in other OOP languages. However, we can add two underscore symbols before the name of a variable or method to signify that a specific variable will be used as a private member within the class. It is done so that the developer can understand the naming convention that the program treats the variable as private. Adding two underscores before the name of a variable or method prevents name mangling by the Python interpreter to avoid collisions with the variable during inheritance, and it is not an actual private member as in other languages.</p>
<p>In this example, we will define our familiar <code>Branch</code> class with private variables for product ID, product name, brand, purchase price, and profit margin and create a private method to display the product details. We will also create branch ID, regional manager, and branch manager as class variables that are not private and look at the difference between accessing those using objects outside the class.</p>
<div><div><img alt="Figure 2.14 – Private members of theBranch class and its accessibility by the Branch object  " height="496" src="img/B13426_02_14.jpg" width="700"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.14 – Private members of theBranch class and its accessibility by the Branch object </p>
<p>Let us look at <a id="_idIndexMarker103"/>the following code to implement this example:</p>
<pre class="source-code">class Branch():  </pre>
<pre class="source-code">    branch_id = 2021  </pre>
<pre class="source-code">    regional_manager = 'John M'  </pre>
<pre class="source-code">    branch_manager = 'Tom H'  </pre>
<pre class="source-code">    __product_id = None  </pre>
<pre class="source-code">    __product_name = None  </pre>
<pre class="source-code">    __productBrand = None  </pre>
<pre class="source-code">    __purchase_price = None  </pre>
<pre class="source-code">    __profit_margin = None  </pre>
<pre class="source-code">      </pre>
<pre class="source-code">    def __display_product_details(self):  </pre>
<pre class="source-code">        self.__product_id = 100002  </pre>
<pre class="source-code">        self.__product_name = 'Washing Machine'  </pre>
<pre class="source-code">        self.__productBrand = 'Whirlpool'  </pre>
<pre class="source-code">        self.__purchase_price = 450  </pre>
<pre class="source-code">        self.__profit_margin = 0.19  </pre>
<pre class="source-code">        print('Product ID: ' + str(self.__product_id) + ',\</pre>
<pre class="source-code">          Product Name: ' + self.__product_name +  </pre>
<pre class="source-code">          ', Product Brand: ' + self.__productBrand + ',\</pre>
<pre class="source-code">          Purchase Price: ' + str(self.__purchase_price)</pre>
<pre class="source-code">          + ', Profit Margin: ' +  str(self.__profit_margin))  </pre>
<pre class="source-code">      </pre>
<pre class="source-code">    def __init__(self):  </pre>
<pre class="source-code">        self.__display_product_details()  </pre>
<p>On <a id="_idIndexMarker104"/>creating an object instance for the <code>Branch</code> class, we will be able to look at the results of the <code>__display_product_details</code> method since it is called within the class using the default <code>__init__</code> method:</p>
<pre class="source-code">branch = Branch()</pre>
<p>The output is as follows:</p>
<pre class="source-code"><strong class="bold">Product ID: 100002, Product Name: Washing Machine, Product Brand: Whirlpool, Purchase Price: 450, Profit Margin: 0.19</strong></pre>
<p>Let us try to access the <code>branch_id</code> variable, which is not declared as private:</p>
<pre class="source-code">branch.branch_id</pre>
<p>The output is as follows:</p>
<pre class="source-code"><strong class="bold">2021</strong></pre>
<p>We are able to access this variable. Let us now try to access <code>profit_margin</code>, which is declared with a prefix of double underscore:</p>
<pre class="source-code">branch.__profit_margin</pre>
<p>It gives us the following error:</p>
<div><div><img alt="Figure 2.15 – Error accessing private variable of a class  " height="138" src="img/B13426_02_15.jpg" width="740"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.15 – Error accessing private variable of a class </p>
<p>We are getting an error since this variable can only be accessed within the class and not by the object of the class due to name mangling. The same applies to the private method <a id="_idIndexMarker105"/>created to display product details as well:</p>
<pre class="source-code">branch.__display_product_details()</pre>
<p>We see the following:</p>
<div><div><img alt="" height="135" src="img/B13426_02_16.jpg" width="736"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.16 – Error accessing private method of a class</p>
<p>The following screenshot shows the list of class members for the <code>Branch</code> class that can be accessed by its object:</p>
<div><div><img alt="Figure 2.17 – Members accessible by the branch object after including private members " height="115" src="img/B13426_02_17.jpg" width="232"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.17 – Members accessible by the branch object after including private members</p>
<p>However, these private members can be accessed outside the class by creating an API to do it.</p>
<h2 id="_idParaDest-39"><a id="_idTextAnchor041"/>Protected members</h2>
<p>In this example, we <a id="_idIndexMarker106"/>will recreate the <code>Branch</code> class with protected variables for product ID, product name, brand, purchase price, and profit margin and create a protected method to display the product details. We will create a branch manager as a private variable. We will also create branch ID and regional manager as class variables that are not protected or private and look at the difference in accessing those using objects outside the class. We will also inherit the <code>Branch</code> class <a id="_idIndexMarker107"/>further to check which members are accessible.</p>
<div><div><img alt="Figure 2.18 – Protected members of the Branch class and its accessibility by inherited subclasses  " height="441" src="img/B13426_02_18.jpg" width="664"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.18 – Protected members of the Branch class and its accessibility by inherited subclasses </p>
<p>Let us look at the following code to implement this example:</p>
<pre class="source-code">class Branch():  </pre>
<pre class="source-code">    branch_id = 2022  </pre>
<pre class="source-code">    regional_manager = 'Ron D'  </pre>
<pre class="source-code">    __branch_manager = 'Sam J'  </pre>
<pre class="source-code">    _product_id = None  </pre>
<pre class="source-code">    _product_name = None  </pre>
<pre class="source-code">    _productBrand = None  </pre>
<pre class="source-code">    _purchase_price = None  </pre>
<pre class="source-code">    _profit_margin = None  </pre>
<pre class="source-code">      </pre>
<pre class="source-code">    def _display_product_details(self):  </pre>
<pre class="source-code">        self._product_id = 100003  </pre>
<pre class="source-code">        self._product_name = 'Washing Machine'  </pre>
<pre class="source-code">        self._productBrand = 'Samsung'  </pre>
<pre class="source-code">        self._purchase_price = 430  </pre>
<pre class="source-code">        self._profit_margin = 0.18  </pre>
<pre class="source-code">        print('Product ID: ' + str(self._product_id) + \</pre>
<pre class="source-code">          ', Product Name: ' + self._product_name +  </pre>
<pre class="source-code">          ', Product Brand: ' + self._productBrand +</pre>
<pre class="source-code">          ', Purchase Price: ' + str(self._purchase_price) </pre>
<pre class="source-code">         + ', Profit Margin: ' +  str(self._profit_margin))</pre>
<pre class="source-code">      </pre>
<pre class="source-code">    def __init__(self):  </pre>
<pre class="source-code">        self._display_product_details()  </pre>
<pre class="source-code">branch = Branch()</pre>
<p>The <a id="_idIndexMarker108"/>output is as follows:</p>
<pre class="source-code"><strong class="bold">Product ID: 100003, Product Name: Washing Machine, Product Brand: Samsung, Purchase Price: 430, Profit Margin: 0.18</strong></pre>
<p>An object created by <code>Branch</code> cannot access its protected members too similar to the private members, as we see here:</p>
<div><div><img alt="Figure 2.19 – Members accessible by branch object after including protected members " height="96" src="img/B13426_02_19.jpg" width="223"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.19 – Members accessible by branch object after including protected members</p>
<p>Let us <a id="_idIndexMarker109"/>create a child class called <code>Brooklyn</code> that inherits the parent class, <code>Branch</code>. The child class will inherit all the protected variables and methods from the parent class, whereas it will still not inherit the private members:</p>
<pre class="source-code">class Brooklyn(Branch):  </pre>
<pre class="source-code">    def __init__(self):  </pre>
<pre class="source-code">        print(self._product_id)  </pre>
<pre class="source-code">        self._display_product_details()  </pre>
<pre class="source-code">branch_brooklyn = Brooklyn()</pre>
<p>The output is as follows:</p>
<pre class="source-code"><strong class="bold">None</strong></pre>
<pre class="source-code"><strong class="bold">Product ID: 100003, Product Name: Washing Machine, Product Brand: Samsung, Purchase Price: 430, Profit Margin: 0.18</strong></pre>
<p>The <code>product_id</code> variable is a protected member of the parent class and <code>display_product_details</code> is also a protected member of the parent class, which is accessible by the <code>init</code> method of the child class, <code>Brooklyn</code>.</p>
<p>Let us now include a private member of the parent class and check whether it can be accessed from the child class:</p>
<pre class="source-code">class Brooklyn(Branch):  </pre>
<pre class="source-code">    def __init__(self):  </pre>
<pre class="source-code">        print(self._product_id)  </pre>
<pre class="source-code">        self._display_product_details()  </pre>
<pre class="source-code">        print(self.__branch_manager)  </pre>
<pre class="source-code">branch_brooklyn = Brooklyn()</pre>
<p>The <a id="_idIndexMarker110"/>output is as follows:</p>
<pre class="source-code"><strong class="bold">None</strong></pre>
<pre class="source-code"><strong class="bold">Product ID: 100003, Product Name: Washing Machine, Product Brand: Samsung, Purchase Price: 430, Profit Margin: 0.18</strong></pre>
<p>The following error clarifies that private members will still not be accessible by the child class:</p>
<div><div><img alt="Figure 2.20  – Error accessing private attribute of a parent class from its child class " height="247" src="img/B13426_02_20.jpg" width="747"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.20  – Error accessing private attribute of a parent class from its child class</p>
<p>These examples give us an understanding of how encapsulation can be implemented in Python.</p>
<h1 id="_idParaDest-40"><a id="_idTextAnchor042"/>Summary</h1>
<p>In this chapter, we reviewed the concept of classes and objects and looked at examples of how to create classes and object instances. We also learned the concept of methods and how to create methods inside classes. Along with this, we saw how to apply inheritance and multiple inheritances to classes and apply polymorphism to methods. We then learned how to create abstract classes and methods. Finally, we learned the concept of encapsulation and how to restrict access to methods and variables of a class.</p>
<p>This chapter has provided a review of all the concepts of OOP in Python, which is going to act as the foundation for the main topic of this book, which is metaprogramming.</p>
<p>In the next chapter, we will see in detail the concept of decorators and their implementation with examples. </p>
</div>
</div></body></html>