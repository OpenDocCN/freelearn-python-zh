<html><head></head><body><div class="chapter" title="Chapter&#xA0;5.&#xA0;Connecting Physical Computing Systems to the Internet"><div class="titlepage"><div><div><h1 class="title"><a id="ch05"/>Chapter 5. Connecting Physical Computing Systems to the Internet</h1></div></div></div><p>In this chapter, we will be focusing on connecting the BeagleBone board to the Internet to connect the physical computing systems that we build to the Internet. First we will look into giving Internet access to the BeagleBone board via Ethernet, then we will learn how to add Wi-Fi capability to the BeagleBone board so that the system we build can be placed anywhere where we have Wi-Fi access, and so that we are not restricted to setting up the system only where the Ethernet is available. Once we are done with this, we will go ahead and build two projects; in the first one we will send an e-mail alert whenever the temperature sensor reading goes above a set level in the Python program running on the BeagleBone board. The next one will be a basic beginner project on Internet of Things for you to get started where the BeagleBone board will be uploading the temperature sensor data to a cloud server on the Internet. So basically, we will be using the knowledge we learnt in previous chapters, in this chapter, in order to take our previous projects to the next level. We'll do this by connecting them to the Internet and by performing operations on the cloud and on messaging services such as e-mail. The contents of the chapter are divided into the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Prerequisites</li><li class="listitem" style="list-style-type: disc">Giving Internet access to your BeagleBone board</li><li class="listitem" style="list-style-type: disc">Adding Wi-Fi to your BeagleBone board</li><li class="listitem" style="list-style-type: disc">Intermediate level project: E-mail alert fire alarm – the Python program will send an e-mail if the temperature sensor readings go above a set level</li><li class="listitem" style="list-style-type: disc">Advanced project: Sensor data to cloud – a Python program will upload the temperature sensor data to an open source or freely available  cloud service using the HTTP web service</li></ul></div><div class="section" title="Prerequisites"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec36"/>Prerequisites</h1></div></div></div><p>This<a id="id216" class="indexterm"/> topic will cover what parts you need to get started with this chapter. These can be purchased from your favorite electrical hobby store or can simply be ordered online.</p><div class="section" title="Materials needed"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec11"/>Materials needed</h2></div></div></div><p>Following are the materials that we will need before moving ahead:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">1x BeagleBone Black</li><li class="listitem" style="list-style-type: disc">1x microSD card with latest version of Debian flashed on it to boot the BeagleBone board from the microSD card</li><li class="listitem" style="list-style-type: disc">1x 5V DC, 2A power supply</li><li class="listitem" style="list-style-type: disc">1x Ethernet cable</li><li class="listitem" style="list-style-type: disc">1x LM35 temperature sensor</li><li class="listitem" style="list-style-type: disc">1x compatible Wi-Fi dongle</li><li class="listitem" style="list-style-type: disc">1x BreadBoard</li><li class="listitem" style="list-style-type: disc">A few jumper wires</li></ul></div></div></div></div>
<div class="section" title="Giving Internet access to your BeagleBone board"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec37"/>Giving Internet access to your BeagleBone board</h1></div></div></div><p>Giving<a id="id217" class="indexterm"/> Internet access to the BeagleBone board via the Ethernet is very simple. All you need to do is connect one end of Ethernet cable to the BeagleBone board, and the other end to a router with an Internet connection. The BeagleBone board will obtain the IP address dynamically from the router using DHCP and get Internet access. To check this you can just type in the following command:</p><p>
<code class="literal">ping www.google.com</code>
</p><p>You will get the response as shown in the following screenshot. This means you have a working Internet connection.</p><div class="mediaobject"><img src="graphics/4602_05_01.jpg" alt="Giving Internet access to your BeagleBone board"/></div><p>Actually, what the ping command does is, it tests the connection and latency between two network connections. The ping command sends packets of data to the other network computer, in our case the <a class="ulink" href="http://www.google.com">www.google.com</a> server, or the IP address of that server. You can see next to <a class="ulink" href="http://www.google.com">www.google.com</a> in the output above, the global IP address of the server is shown. The picture shows how the ping command measures the time taken to get a response from that server computer, where the time is in milliseconds. </p><p>So, it's<a id="id218" class="indexterm"/> as simple as that to give Internet access to the BeagleBone board, running a working operating system such as Linux. This will automatically obtain the IP address from the Internet router to which it is connected using DHCP. But in most of the cases we will need a setup where the real-time embedded system is wireless which gives more flexibility in placing the system at any place for its operation instead of restricting the setup to be connected to Ethernet cable. The next topic of this chapter will focus on how to setup Wi-Fi access to BeagleBone board.</p></div>
<div class="section" title="Adding Wi-Fi to the BeagleBone board"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec38"/>Adding Wi-Fi to the BeagleBone board</h1></div></div></div><p>To add<a id="id219" class="indexterm"/> Wi-Fi capability to the BeagleBone board, let's connect a Wi-Fi dongle in the USB port available on the BeagleBone board, as shown in the following picture:</p><div class="mediaobject"><img src="graphics/4602_05_02.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>Once you have connected the USB Wi-Fi dongle you can check whether it is connected or not by typing the following command:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">lsusb</code>: This is shown in the following screenshot where the USB Wi-Fi dongle is highlighted, that is <span class="strong"><strong>Atheros Communications, Inc. AR9271 802.11n</strong></span>:<div class="mediaobject"><img src="graphics/4602_05_03.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div></li></ul></div><p>Then type the following command:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">iwconfig</code>: <code class="literal">iwconfig</code> will show you the details of the wireless LAN connection status, as shown in the previous screenshot, where you can see that wlan1, which is highlighted, shows the detail that is not associated with any access point as of now.</li></ul></div><p>Our <a id="id220" class="indexterm"/>next step is to connect the Wi-Fi dongle to the Wi-Fi access point. To do this we will be using a program called <code class="literal">wicd-curses</code>, which is available in Debian by default.</p><p>To use the program we need to enter the following command:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">sudo wicd-curses<div class="mediaobject"><img src="graphics/4602_05_64.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div></li></ul></div><p>Once you execute the command you will get an interactive program window as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_04.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>You <a id="id221" class="indexterm"/>can see in the preceding screenshot that the program states there are <span class="strong"><strong>No wireless networks found</strong></span>. This is because we need to set up the USB Wi-Fi device first, and then search for the available Wi-Fi access points in the range. To do this, follow the next steps as shown in the following screenshot:</p><p>Press the <span class="emphasis"><em>Tab</em></span> button once to open the configuration menu, – you should get the screen as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_05.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>Once you <a id="id222" class="indexterm"/>get this screen, then press page up button once – it should highlight the wireless interface area, and then you need to type <span class="strong"><strong>wlan1</strong></span> in it as shown in the following screenshot. If you remember, <span class="strong"><strong>wlan1</strong></span> is what we had in the details of the wireless interface when we used the command <code class="literal">iwconfig</code> to get details of the interface created because of the USB Wi-Fi dongle.</p><div class="mediaobject"><img src="graphics/4602_05_06.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>Then, press the <span class="emphasis"><em>F10</em></span> key to save the configuration. Once you have saved it, it will take you back to the previous main screen as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_07.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>Now you <a id="id223" class="indexterm"/>need to press the <span class="emphasis"><em>R</em></span> key once to refresh the program and search for available Wi-Fi access points in the range that the Wi-Fi dongle can connect to. Once you press the <span class="emphasis"><em>R</em></span> key you will get a screen as shown in the following screenshot saying that it's searching for available networks:</p><div class="mediaobject"><img src="graphics/4602_05_08.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>Then, after <a id="id224" class="indexterm"/>scanning, it will show the screen as shown in the following screenshot, listing out the available Wi-Fi access points in the range:</p><div class="mediaobject"><img src="graphics/4602_05_09.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>Once you <a id="id225" class="indexterm"/>have the list of available Wi-Fi access points you can choose the one to which you want the Wi-Fi dongle to connect by using the arrow keys up and down to select the access point. As you can see in the following screenshot, the access points get highlighted as you move the arrow keys. In this picture, <span class="strong"><strong>TERO</strong></span> is highlighted:</p><div class="mediaobject"><img src="graphics/4602_05_10.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>Once you <a id="id226" class="indexterm"/>have selected the network you want to connect to, when its highlighted as shown in the preceding picture, press the <span class="strong"><strong>right arrow</strong></span> key on the keyboard and you should see the screen as shown in following screenshot which is asking for a password to connect:</p><div class="mediaobject"><img src="graphics/4602_05_11.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>You need to <a id="id227" class="indexterm"/>set the options as shown in the following screenshot to get a DHCP-based IP allocation from the router, or if you want to have a static IP for your BeagleBone board, you can do that as well. Use the <span class="emphasis"><em>Tab</em></span> key to switch fields on the screen.</p><div class="mediaobject"><img src="graphics/4602_05_12.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>So, set the <a id="id228" class="indexterm"/>hostname and enter the passkey in the key field as shown in the preceding screenshot, and save by pressing the <span class="emphasis"><em>F10</em></span> key. Once you have done that you will get back to the main screen with a list of Wi-Fi access points available, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_13.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>Now you can <a id="id229" class="indexterm"/>press the <span class="emphasis"><em>C</em></span> key connect to the network. Once you press it, your shell connection will be lost, as the BeagleBone board will get disconnected from the network via the Ethernet connection through which you have logged in. Now, the BeagleBone board will connect to the network via Wi-Fi, so the IP address of the BeagleBone board must have changed. To check this, we need to login to the router configuration page of the same router as we used to connect to the Wi-Fi when we connected the BeagleBone board. Think back to what we did in the first chapter to find the IP address of the BeagleBone board connected via the Ethernet to the router. Now we need to do the same with the Wi-Fi connection.</p><p>Open the router page as follows:</p><div class="mediaobject"><img src="graphics/4602_05_14.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>Check the <a id="id230" class="indexterm"/>list of DHCP clients:</p><div class="mediaobject"><img src="graphics/4602_05_15.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>So, you <a id="id231" class="indexterm"/>can see the IP address of the BeagleBone board connected to the network via Wi-Fi and, if you remember, BeagleBone was the hostname we mentioned when configuring the Wi-Fi with our passkey. Now let's login into the Linux shell using this new IP address we have assigned:</p><div class="mediaobject"><img src="graphics/4602_05_16.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>Once <a id="id232" class="indexterm"/>logged in using the same user ID and password, type the command <code class="literal">iwconfig</code> again, and you can see that wlan1 is connected to the SSID that we configured and connected, which you can see it in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_17.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>Now<a id="id233" class="indexterm"/> type in the <code class="literal">ping</code> command to check the Internet connectivity:</p><div class="mediaobject"><img src="graphics/4602_05_18.jpg" alt="Adding Wi-Fi to the BeagleBone board"/></div><p>Once we have the Internet connection properly working on the BeagleBone board, we can move on to the next topics: two projects with the system connected to the Internet.</p></div>
<div class="section" title="Intermediate level project: An e-mail alert fire alarm"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec39"/>Intermediate level project: An e-mail alert fire alarm</h1></div></div></div><p>First of all, as <a id="id234" class="indexterm"/>in the <a id="id235" class="indexterm"/>previous chapter, take three berg wires and connect the LM35 temperature sensor to the BeagleBone board, as per the circuit diagram shown in the following image:</p><div class="mediaobject"><img src="graphics/4602_05_19.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>Then <a id="id236" class="indexterm"/>we <a id="id237" class="indexterm"/>will turn on the BeagleBone board and login to the Linux shell to start coding it.</p><p>Open the Python console to learn and test how to send an e-mail using Python:</p><div class="mediaobject"><img src="graphics/4602_05_20.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>Our first step will be to import the <code class="literal">smtplib</code> into Python, which is the mail transfer protocol library with the predefined function that we will be using in the program.</p><div class="mediaobject"><img src="graphics/4602_05_21.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>Next create a <a id="id238" class="indexterm"/>variable to store the e-mail ID to which you need to send the e-mail:</p><div class="mediaobject"><img src="graphics/4602_05_22.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>Then <a id="id239" class="indexterm"/>create the variables where you need to store the e-mail ID and password of the account from which you want to send the e-mail:</p><div class="mediaobject"><img src="graphics/4602_05_23.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>Create an SMTP object with a Gmail hostname and port number <span class="strong"><strong>587</strong></span>:</p><div class="mediaobject"><img src="graphics/4602_05_24.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>EHLO is just like HELO except that the server's response text provides computer-readable information about the server's abilities. The response of this helps us to confirm whether the SMTP server we created is at our service:</p><div class="mediaobject"><img src="graphics/4602_05_25.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>Next we need to create a secure connection. We already have a connection, which we checked in the last step, but it is insecure. STARTTLS is a way to take an existing insecure connection and upgrade it to a secure connection using SSL/TLS. You can do this as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_26.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>Once again<a id="id240" class="indexterm"/> use EHLO as shown in the picture below to check and create the running SMTP instance:</p><div class="mediaobject"><img src="graphics/4602_05_27.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>Our next<a id="id241" class="indexterm"/> step is to create the header variable with information about the sender e-mail address, the receiver e-mail address, and details about the subject of the e-mail:</p><div class="mediaobject"><img src="graphics/4602_05_28.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>We need to create another variable where we will add the header to the message we are going to send in the e-mail.</p><p>When you print it out using the <code class="literal">print msg</code> command you can see how it appears in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_29.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>Now we have the <code class="literal">msg</code> variable with information of the sender e-mail, receiver e-mail, subject of the e-mail and message of the e-mail as shown in preceding screenshot.</p><p>Our next step is to login to the server using the sender e-mail and password. You can do this as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_30.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>If you get the response as shown in the preceding screenshot, then you have successfully logged in.</p><p>Next send <a id="id242" class="indexterm"/>the e-mail using the <code class="literal">sendmail</code> function with the receiver e-mail ID, sender e-mail ID and message as arguments:</p><div class="mediaobject"><img src="graphics/4602_05_31.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>Once you <a id="id243" class="indexterm"/>have sent it you can go ahead and close the SMTP server and log out from it as shown following:</p><div class="mediaobject"><img src="graphics/4602_05_32.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>By now you must have received the e-mail on the receiver e-mail ID where you can see the subject <span class="strong"><strong>Python Email Test</strong></span> just as we mentioned in Python, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_33.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>If you open the e-mail you can see this message:</p><div class="mediaobject"><img src="graphics/4602_05_34.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>We can <a id="id244" class="indexterm"/>actually see the message content is in a similar format to what we printed out on the Python <a id="id245" class="indexterm"/>console. Click on the <span class="strong"><strong>Show original</strong></span> option on Gmail to see the original text e-mail, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_35.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>Once you click on <span class="strong"><strong>Show original</strong></span> you will see the e-mail as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_36.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>You can <a id="id246" class="indexterm"/>see<a id="id247" class="indexterm"/> the highlighted part in the mail, which is exactly the same as the message we composed and sent from the Python console, as shown following:</p><div class="mediaobject"><img src="graphics/4602_05_37.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>You can exit the Python console now:</p><div class="mediaobject"><img src="graphics/4602_05_38.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>Now let's <a id="id248" class="indexterm"/>go <a id="id249" class="indexterm"/>ahead and write the Python program to send an e-mail whenever the temperature goes too high. You can just edit the code from our project in the previous chapter and save it with a new name as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_39.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>Once you <a id="id250" class="indexterm"/>have saved it, you<a id="id251" class="indexterm"/> can run the code as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_40.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>You should get an e-mail now as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_41.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>Hold a<a id="id252" class="indexterm"/> flame <a id="id253" class="indexterm"/>near to the sensor as shown in the following picture:</p><div class="mediaobject"><img src="graphics/4602_05_42.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>The output<a id="id254" class="indexterm"/> of the<a id="id255" class="indexterm"/> running Python code will be as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_43.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>And you will get an e-mail as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_44.jpg" alt="Intermediate level project: An e-mail alert fire alarm"/></div><p>So, that ends our project. When you remove the flame, it will again send you an e-mail saying that <a id="id256" class="indexterm"/>the temperature is normal. Here is how the code works: whenever there is a change in the temperature level, that is if the temperature rises above a set or below a set limit, it will send an e-mail saying that the temperature is high or the temperature is low, respectively.</p><p>Unlike in <a id="id257" class="indexterm"/>this project, where a decision is made using the temperature measured with a temperature sensor, and then an email is sent based on this decision, the next project will directly upload the temperature sensor data to the cloud server.</p></div>
<div class="section" title="Advanced level project: Uploading sensor data to a web cloud"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec40"/>Advanced level project: Uploading sensor data to a web cloud</h1></div></div></div><p>The<a id="id258" class="indexterm"/> connections<a id="id259" class="indexterm"/> are similar<a id="id260" class="indexterm"/> to the previous project, the only difference in that will be writing a new Python program to upload data to a freely available cloud server using HTTP call methods.</p><p>With the same <a id="id261" class="indexterm"/>connections as the previous project, connect the temperature sensor to the BeagleBone board.</p><p>Then the first<a id="id262" class="indexterm"/> thing we need to do is setup the cloud server to which we need to upload data. We will be using a freely available cloud storage space website specially setup for IoT applications. The website is <a class="ulink" href="http://www.thingspeak.com">www.thingspeak.com</a>, We chose to use this cloud solution out of the many available because ThingSpeak makes it very simple to upload data from hardware to a cloud for IoT applications. They have a lot of examples for different hardware development boards used for different applications. Looking at these wide variety of examples and easy APIs will help you experiment a lot more on your own using the BeagleBone board than what we do in this chapter.</p><div class="mediaobject"><img src="graphics/4602_05_45.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>The first thing you need to do on this website is signup and create an account:</p><div class="mediaobject"><img src="graphics/4602_05_46.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>Once the<a id="id263" class="indexterm"/> account is created, and you can login into your account, you will see the screen as shown in <a id="id264" class="indexterm"/>the following screenshot, and will need to click on <span class="strong"><strong>New Channel</strong></span>:</p><div class="mediaobject"><img src="graphics/4602_05_47.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>When you click on <span class="strong"><strong>New Channel</strong></span> it will ask for details of the same. Fill them in as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_50.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>Once you <a id="id265" class="indexterm"/>have entered the details you can click on <span class="strong"><strong>Save Channel</strong></span>:</p><div class="mediaobject"><img src="graphics/4602_05_51.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>You can <a id="id266" class="indexterm"/>see the channel with the field as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_52.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>Next we <a id="id267" class="indexterm"/>should look at the API provided by the ThingSpeak website to update data to the cloud server.</p><p>You can <a id="id268" class="indexterm"/>see the details of the API of the HTTP call that you need to make to the ThingSpeak server in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_53.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>As highlighted<a id="id269" class="indexterm"/> in the preceding screenshot, we can use HTTP POST data to update data to the cloud server. The next steps will show you how to update data to the cloud server from Python using this HTTP POST call:</p><p>First, open the Python interactive console:</p><div class="mediaobject"><img src="graphics/4602_05_54.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>Then we need to import the <code class="literal">requests</code> module, which is a Python library that has built in functions to make HTTP requests on webservers:</p><div class="mediaobject"><img src="graphics/4602_05_55.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>Next we <a id="id270" class="indexterm"/>can directly try making the HTTP POST request to the server using the API that was given as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_56.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>The highlighted <a id="id271" class="indexterm"/>part is the parameter you pass to the server when you are make the POST call to <code class="literal">https://api.thingspeak.com/update.json</code> URL.</p><p>You can see that we have mentioned <code class="literal">field1=25</code> which will be updated on the ThingSpeak server.</p><p>The response will be stored in variable <code class="literal">r</code>, and when you <code class="literal">print r</code>, if you get the response as <code class="literal">200</code>, then the data was updated successfully:</p><div class="mediaobject"><img src="graphics/4602_05_57.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>Once you have the response as <code class="literal">200</code>, the data is updated on the webserver as you can see in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_58.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>Perform <a id="id272" class="indexterm"/>the <a id="id273" class="indexterm"/>HTTP post call with <code class="literal">field1</code> data equal to <code class="literal">10</code>:</p><div class="mediaobject"><img src="graphics/4602_05_59.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>Then you can see that field1 is updated with new data at that time instant:</p><div class="mediaobject"><img src="graphics/4602_05_60.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>Now we<a id="id274" class="indexterm"/> will go ahead and write the code to update the temperature data to the cloud continuously. We<a id="id275" class="indexterm"/> can use our <code class="literal">TestLM35.py</code> code to make changes in it and save it with a new name to update the temperature data every 61 seconds to the <a class="ulink" href="https://thingspeak.com/">https://thingspeak.com/</a> server:</p><div class="mediaobject"><img src="graphics/4602_05_61.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>When you run the program, the output will be as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_05_62.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>You <a id="id276" class="indexterm"/>can use <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>C</em></span> to end the program and exit.</p><p>Then, if <a id="id277" class="indexterm"/>you see the data on the field1 Chart on the ThingSpeak website, you can see that the data has been updated as shown in the pictures below. You can see the time stamp and see that the interval between the two instances of data update is 1 minute, and the temperature reading value also matches what we printed on the output on the console:</p><div class="mediaobject"><img src="graphics/4602_05_63.jpg" alt="Advanced level project: Uploading sensor data to a web cloud"/></div><p>So, we have successfully written a program that updates data and stores it in a cloud server every one minute.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec41"/>Summary</h1></div></div></div><p>In this chapter we learnt about giving Internet access to the BeagleBone board through Wi-Fi, and sending an e-mail alert whenever temperature measured, using a temperature sensor connected to BeagleBone board, goes high or low, depending on the threshold value set in the program. We also saw how we can upload data to the cloud web server using HTTP requests made to the server from the BeagleBone board using Python. So, we have learnt how to set up basic level Internet of Things projects in this chapter. You can go ahead and explore the options of using the <code class="literal">requests</code> module in Python to use HTTP Put, Post, and Get requests on various freely available open source cloud servers built for IoT which are just like <a class="ulink" href="https://thingspeak.com/">https://thingspeak.com/</a>, which we used in this chapter. There are options where, instead of uploading data using an HTTP post request, you can get data from a cloud server; that is you can read data from the cloud server and print it on the Python program. You can read data from the server instead of uploading data, just like we did in this chapter. I would suggest you explore all such possibilities.</p><p>In our next chapter we will go ahead and set up our own web server and connect it to the Internet. Once you learn that, in future if you can have one BeagleBone board acting as a webserver, instead of the third-party server we used in this chapter, another BeagleBone board may be uploading data to the server we setup using another BeagleBone board.</p></div></body></html>