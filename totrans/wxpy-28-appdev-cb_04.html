<html><head></head><body>
  <div id="sbo-rt-content"><div class="chapter" title="Chapter 4. Advanced Building Blocks of a User Interface"><div class="titlepage"><div><div><h1 class="title"><a id="ch04"/>Chapter 4. Advanced Building Blocks of a User Interface</h1></div></div></div><p>In this chapter, we will cover:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Listing data with a<code class="literal"> ListCtrl</code></li><li class="listitem" style="list-style-type: disc">Browsing files with the<code class="literal"> CustomTreeCtrl</code></li><li class="listitem" style="list-style-type: disc">Creating a<code class="literal"> VListBox</code></li><li class="listitem" style="list-style-type: disc"><code class="literal">StyledTextCtrl</code> using lexers</li><li class="listitem" style="list-style-type: disc">Working with tray icons</li><li class="listitem" style="list-style-type: disc">Adding tabs to a<code class="literal"> Notebook</code></li><li class="listitem" style="list-style-type: disc">Using the<code class="literal"> FlatNotebook</code></li><li class="listitem" style="list-style-type: disc">Scrolling with a<code class="literal"> ScrolledPanel</code></li><li class="listitem" style="list-style-type: disc">Simplifying the<code class="literal"> FoldPanelBar</code></li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec01"/>Introduction</h1></div></div></div><p>Displaying collections of data and managing complex window layouts are a task that most UI developers will be faced with at some point. wxPython provides a number of components to help developers meet the requirements of these more demanding interfaces.</p><p>As the amount of controls and data that an application is required to display in its user interface increases, so does the task of efficiently managing available screen real estate. To fit this information into the available space requires the use of some more advanced controls and containers; so let's dive in and begin our exploration of some of the more advanced controls that wxPython has to offer.</p></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Listing data with a ListCtrl"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec02"/>Listing data with a ListCtrl</h1></div></div></div><p>The<code class="literal"> ListCtrl</code> is a versatile control for displaying collections of text and/or images. The control supports many different display formats, although typically its most often-used display mode is the report mode. Report mode has a visual representation that is very similar to a grid or spreadsheet in that it can have multiple rows and columns with column headings. This recipe shows how to populate and retrieve data from a<code class="literal"> ListCtrl</code> that was created in report mode.<a id="id148" class="indexterm"/>
</p><div class="mediaobject"><img src="images/1780_04_01.jpg" alt="Listing data with a ListCtrl"/></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec01"/>How to do it...</h2></div></div></div><p>The<code class="literal"> ListCtrl</code> takes a little more set up than most basic controls, so we will start by creating a subclass that sets up the columns that we wish to have in the control:<a id="id149" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">class MyListCtrl(wx.ListCtrl):
    def __init__(self, parent):
        super(MyListCtrl, self).__init__(parent,
                                         style=wx.LC_REPORT)

        # Add three columns to the list          
        self.InsertColumn(0, "Column 1")
        self.InsertColumn(1, "Column 2")
        self.InsertColumn(2, "Column 3")
        
    def PopulateList(self, data):
        """Populate the list with the set of data. Data
        should be a list of tuples that have a value for each
        column in the list.
        [('hello', 'list', 'control'),]
        """
        for item in data:
            self.Append(item)

</pre></div><p>Next we will create an instance of our<code class="literal"> ListCtrl</code> and put it on a<code class="literal"> Panel</code>, and then use our<code class="literal"> PopulateList</code> method to put some sample data into the control:</p><div class="informalexample"><pre class="programlisting">class MyPanel(wx.Panel):
    def __init__(self, parent):
        super(MyPanel, self).__init__(parent)

        # Attributes
        self.lst = MyListCtrl(self)

        # Setup
        data = [ ("row %d" % x,
                  "value %d" % x,
                  "data %d" % x) for x in range(10) ]
        self.lst.PopulateList(data)

        # Layout
        sizer = wx.BoxSizer(wx.VERTICAL)
        sizer.Add(self.lst, 1, wx.EXPAND)
        self.SetSizer(sizer)

        # Event Handlers
        self.Bind(wx.EVT_LIST_ITEM_SELECTED, 
                  self.OnItemSelected)

    def OnItemSelected(self, event):
        selected_row = event.GetIndex()
        val = list()
        for column in range(3):
            item = self.lst.GetItem(selected_row, column)
            val.append(item.GetText())
        # Show what was selected in the frames status bar
        frame = self.GetTopLevelParent()
        frame.PushStatusText(",".join(val))

</pre></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec02"/>How it works...</h2></div></div></div><p>Usually there tends to be a fair amount of set up with the<code class="literal"> ListCtrl</code>, and due to this it is good to encapsulate the usage of the control in a specialized subclass instead of using it directly. We kept things pretty basic here in our<code class="literal"> ListCtrl</code> class. We just used the<code class="literal"> InsertColumn</code> method to set our list up with three columns. Then the<code class="literal"> PopulateList</code> method was added for convenience, to allow the population of the<code class="literal"> ListCtrl</code> from a Python list of data. It simply wraps the<code class="literal"> Append</code> method of<code class="literal"> ListCtrl</code>, which just takes an iterable that has a string for each column in the list.<a id="id151" class="indexterm"/>
</p><p>The<code class="literal"> MyPanel</code> class is there to show how to use the<code class="literal"> ListCtrl</code> class that we created. First we populate it with some data by generating a list of tuples and calling our<code class="literal"> PopulateList</code> method. To show how to retrieve data from the list, we created an event handler for<code class="literal"> EVT_LIST_ITEM_SELECTED</code> which will be fired each time a new selection is made in the control. In order to retrieve a value from a<code class="literal"> ListCtrl</code>, you need to know the row and column index of the cell that you wish to retrieve the data from, and then call<code class="literal"> GetItem</code> with the row and column to get the<code class="literal"> ListItem</code> object that represents that cell. Then the string value of the cell can be retrieved by calling the<code class="literal"> GetText</code> method of<code class="literal"> ListItem</code>.<a id="id152" class="indexterm"/>
</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec03"/>There's more...<a id="id153" class="indexterm"/>
</h2></div></div></div><p>Depending on the style flags that are used to create a<code class="literal"> ListCtrl</code>, it will behave in many different possible ways. Because of this, it is important to know some of the different style flags that can be used to create a<code class="literal"> ListCtr</code>.</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Style flags</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">LC_LIST</code>
</p>
</td><td style="text-align: left" valign="top">
<p>In List mode, the control will calculate the columns automatically, so there is no need to call<code class="literal"> InsertColumn</code>. It can be used to display strings and, optionally, small icons</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">LC_REPORT</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Single or multicolumn report view that can be shown with or without headers</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">LC_ICON</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Large icon view that can optionally have labels</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">LC_SMALL_ICON</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Small icon view that can optionally have labels</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">LC_EDIT_LABELS</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Allow the item labels to be editable by users</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">LC_NO_HEADER</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Hide the column headers (report mode)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">LC_SORT_ASCENDING</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Sort items in ascending order (must provide a<code class="literal"> SortItems</code> callback method)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">LC_SORT_DESCENDING</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Sort items in descending order (must provide a<code class="literal"> SortItems</code> callback method)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">LC_HRULE</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Draw a horizontal line between rows (report mode)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">LC_VRULE</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Draw a vertical line between columns (report mode)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">LC_SINGLE_SEL</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Only allow a single item to be selected at a time (Default is to allow for multiple selections)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">LC_VIRTUAL</code>
</p>
</td><td style="text-align: left" valign="top">
<p><a id="id154" class="indexterm"/>
Fetch items to display in the list on demand (report mode)</p>
</td></tr></tbody></table></div><div class="section" title="Virtual Mode"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec01"/>Virtual Mode</h3></div></div></div><p>When a<code class="literal"> ListCtrl</code> is created in virtual mode (using the<code class="literal"> LC_VIRTUAL</code> style flag), it does not store the data internally; instead it will instead ask for the data from a datasource when it needs to display it. This mode is useful when you have a very large set of data where preloading it in the control would present performance issues. To use a<code class="literal"> ListCtrl</code> in virtual mode, you must call<code class="literal"> SetItemCount</code> to tell the control how many rows of data there are, and override the<code class="literal"> OnGetItemText</code> method to return the text for the<code class="literal"> ListItem</code> when the control asks for it.<a id="id155" class="indexterm"/>
</p></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec04"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The<span class="emphasis"><em> Creating a VListBox</em></span> recipe in this chapter is another example of a control for presenting data as a list.</li></ul></div></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Browsing files with the CustomTreeCtrl"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec03"/>Browsing files with the CustomTreeCtrl</h1></div></div></div><p>A<code class="literal"> TreeCtrl</code> is a way of displaying hierarchical data in a user interface. The<code class="literal"> CustomTreeCtrl</code> is a fully owner-drawn<code class="literal"> TreeCtrl</code> that looks and functions much the same way as the default<code class="literal"> TreeCtrl</code>, but that offers a number of additional features and customizability that the default native control cannot. This recipe shows how to make a custom file browser class by using the<code class="literal"> CustomTreeCtrl</code>.<a id="id156" class="indexterm"/>
</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec05"/>How to do it...</h2></div></div></div><p>To create this custom<code class="literal"> FileBrowser</code> control, we will use its constructor to set up the images to use for the folders and files in the tree:<a id="id157" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">import  os
import wx
import wx.lib.customtreectrl as customtree

class FileBrowser(customtree.CustomTreeCtrl):
    FOLDER, \
    ERROR, \
    FILE = range(3)
    def __init__(self, parent, rootdir, *args, **kwargs):
        super(FileBrowser, self).__init__(parent,
                                          *args,
                                          **kwargs)         
        assert os.path.exists(rootdir), \
               "Invalid Root Directory!"
        assert os.path.isdir(rootdir), \
               "rootdir must be a Directory!"

        # Attributes
        self._il = wx.ImageList(16, 16)
        self._root = rootdir
        self._rnode = None  

        # Setup
        for art in (wx.ART_FOLDER, wx.ART_ERROR,
                    wx.ART_NORMAL_FILE):
            bmp = wx.ArtProvider.GetBitmap(art, size=(16,16))
            self._il.Add(bmp)
        self.SetImageList(self._il)
        self._rnode = self.AddRoot(os.path.basename(rootdir),
                                   image=FileBrowser.FOLDER,
                                   data=self._root)
        self.SetItemHasChildren(self._rnode, True)
        # use Windows-Vista-style selections       
        self.EnableSelectionVista(True)

        # Event Handlers
        self.Bind(wx.EVT_TREE_ITEM_EXPANDING, 
                  self.OnExpanding)
        self.Bind(wx.EVT_TREE_ITEM_COLLAPSED, 
                  self.OnCollapsed)

    def _GetFiles(self, path):
        try:
            files = [fname for fname in os.listdir(path)
                     if fname not in ('.', '..')]
        except OSError:
            files = None
        return files

</pre></div><p>The following two event handlers are used to update which files are displayed when a node is expanded or collapsed in the tree:<a id="id158" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">    def OnCollapsed(self, event):
        item = event.GetItem()
        self.DeleteChildren(item)

    def OnExpanding(self, event):
        item = event.GetItem()
        path = self.GetPyData(item)
        files = self._GetFiles(path)

        # Handle Access Errors
        if files is None:
            self.SetItemImage(item, FileBrowser.ERROR)
            self.SetItemHasChildren(item, False)
            return

        for fname in files:
            fullpath = os.path.join(path, fname)
            if os.path.isdir(fullpath):
                self.AppendDir(item, fullpath)
            else:
                self.AppendFile(item, fullpath)

</pre></div><p>The following methods are added as an API for working with the control to add items and retrieve their on-disk paths:</p><div class="informalexample"><pre class="programlisting">    def AppendDir(self, item, path):
        """Add a directory node"""
        assert os.path.isdir(path), "Not a valid directory!"
        name = os.path.basename(path)
        nitem = self.AppendItem(item, name,
                                image=FileBrowser.FOLDER,
                                data=path)
        self.SetItemHasChildren(nitem, True)

    def AppendFile(self, item, path):
        """Add a file to a node"""
        assert os.path.isfile(path), "Not a valid file!"
        name = os.path.basename(path)
        self.AppendItem(item, name,
                        image=FileBrowser.FILE,
                        data=path)

    def GetSelectedPath(self):
        """Get the selected path"""
        sel = self.GetSelection()
        path = self.GetItemPyData(sel)
        return path

    def GetSelectedPaths(self):
        """Get a list of selected paths"""
        sels = self.GetSelections()
        paths = [self.GetItemPyData(sel)
                 for sel in sels ]
        return paths

</pre></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec06"/>How it works...</h2></div></div></div><p>With just a few lines of code here we have created a pretty useful little widget for displaying and working with the file system. Let's take a quick look at how it works.<a id="id160" class="indexterm"/>
</p><p>In the classes constructor, we added a root node with the control's<code class="literal"> AddRoot</code> method. A root node is a top-level node that has no other parent nodes above it. The first argument is the text that will be shown, the<code class="literal"> image</code> argument specifies the default image for the<code class="literal"> TreeItem</code>, and the<code class="literal"> data</code> argument specifies any type of data associated with the item—in this case we are setting a string for the items path. We then called<code class="literal"> SetItemHasChildren</code> for the item so that it will get a button next to it to allow it to be expanded. The last thing that we did in the constructor was to<code class="literal"> Bind</code> the control to two events so that we can update the tree when one of its nodes is being expanded or collapsed.<a id="id161" class="indexterm"/>
</p><p>Immediately before the node is going to be expanded our handler for<code class="literal"> EVT_TREE_ITEM_EXPANDING</code> will be called. It is here where we find all the files and folders under a directory node, and then add them as children of that node by calling<code class="literal"> AppendItem</code>, which works just like<code class="literal"> AddRoot</code> but is used to add items to already-existing nodes in the tree.</p><p>Conversely when a node in the tree is going to be collapsed, our<code class="literal"> EVT_TREE_ITEM_COLLAPED</code> event handler will be called. Here we simply call<code class="literal"> DeleteChildren</code> in order to remove the children items from the node so that we can update them more easily the next time that the node is expanded. Otherwise, we would have to find what was different the next time it was expanded, and then remove the items that have been deleted and insert new items that may have been added to the directory.<a id="id162" class="indexterm"/>
</p><p>The last two items in our class are for getting the file paths of the selected items, which—since we store the file path in each node—is simply just a matter of getting the data from each of the currently-selected<code class="literal"> TreeItems</code> with a call to<code class="literal"> GetPyData</code>.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec07"/>There's more...</h2></div></div></div><p>Most of what we did in this recipe could actually also be replicated with the standard<code class="literal"> TreeCtrl</code>. The difference is in the amount of extra customizability that the<code class="literal"> CustomTreeCtrl</code> provides. Since it is a fully owner-drawn control, nearly all of the visible attributes of it can be customized. Following is a list of some of the functions that can be used to customize its appearance:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Functions</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">EnableSelectionGradient(bool)</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Use a gradient to draw the tree item selection rectangle.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">EnableSelectionVista(bool)</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Use a nice rounded rectangle for the item selections similar to the native control seen in Windows Vista.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">SetButtonsImageList(ImageList)</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Changes the expand/collapse buttons.<code class="literal"> ImageList</code> should have four bitmaps for the following states, in this order:<code class="literal"> Normal, Selected, Expanded</code>, and<code class="literal"> Expanded Selected</code>.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">SetConnectionPen(pen)</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Changes how the connection lines are drawn between items in the tree. Takes a<code class="literal"> wx.Pen</code> object that will be used to draw the lines.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">SetBackgroundImage(bitmap)</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Allows for an image to be used as the control's background.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">SetBackgroundColour(colour)</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Used to change the color of the control's background.</p>
</td></tr></tbody></table></div></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Creating a VListBox"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec04"/>Creating a VListBox</h1></div></div></div><p>The<code class="literal"> VListBox</code> control is much like a<code class="literal"> ListBox</code> control, but it is virtual (it doesn't store the data internally) and allows for items to have variable row heights. It works by providing a number of virtual callback methods that you must override in a subclass in order to draw the items on demand. Because of this requirement to override pure virtual methods, the<code class="literal"> VListBox</code> will always be subclassed. This recipe shows how to create a<code class="literal"> VListBox</code> derived control that supports an icon and text in each of its items.<a id="id163" class="indexterm"/>
</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec08"/>How to do it...</h2></div></div></div><p>To create our user list control, we just need to subclass a<code class="literal"> VListBox</code> and override some of its callback methods to perform the necessary actions:<a id="id164" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">class UserListBox(wx.VListBox):
    """Simple List Box control to show a list of users"""
    def __init__(self, parent, users):
        """@param users: list of user names"""
        super(UserListBox, self).__init__(parent)

        # Attributes
        # system-users.png is a sample image provided with
        # this chapters sample code.
        self.bmp = wx.Bitmap("system-users.png",
                             wx.BITMAP_TYPE_PNG)
        self.bh = self.bmp.GetHeight()
        self.users = users

        # Setup
        self.SetItemCount(len(self.users))

    def OnMeasureItem(self, index):
        """Called to get an items height"""
        # All our items are the same so index is ignored
        return self.bh + 4

    def OnDrawSeparator(self, dc, rect, index):
        """Called to draw the item separator"""
        oldpen = dc.GetPen()
        dc.SetPen(wx.Pen(wx.BLACK))
        dc.DrawLine(rect.x, rect.y,
                    rect.x + rect.width,
                    rect.y)
        rect.Deflate(0, 2)
        dc.SetPen(oldpen)

    def OnDrawItem(self, dc, rect, index):
        """Called to draw the item"""
        # Draw the bitmap
        dc.DrawBitmap(self.bmp, rect.x + 2,
                      ((rect.height - self.bh) / 2) + rect.y)
        # Draw the label to the right of the bitmap
        textx = rect.x + 2 + self.bh + 2
        lblrect = wx.Rect(textx, rect.y,
                          rect.width - textx,
                          rect.height)
        dc.DrawLabel(self.users[index], lblrect,
                     wx.ALIGN_LEFT|wx.ALIGN_CENTER_VERTICAL)

</pre></div><p>Here is a screenshot of what the<code class="literal"> UserListBox</code> looks like with some sample data in it.<a id="id165" class="indexterm"/>
</p><div class="mediaobject"><img src="images/1780_04_02.jpg" alt="How to do it..."/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec09"/>How it works...</h2></div></div></div><p>Our custom<code class="literal"> VListBox</code> control could be used in any kind of application that wants to display a list of users. The constructor takes a list of usernames and calls<code class="literal"> SetItemCount</code> to tell the control how many items it needs to be able to display. We also loaded a bitmap to use in our list's items. This bitmap is available in the sample code that accompanies this topic.<a id="id166" class="indexterm"/>
</p><p>The main thing to take from this recipe is the three virtual callback methods that we overrode in order to draw the items in our control:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">The first required override is<code class="literal"> OnMeasureItem</code>. This method will be called for each item in the list, and it needs to return the height of the item.<a id="id167" class="indexterm"/></li><li class="listitem">The next method is<code class="literal"> OnDrawSeparator</code>. This method is optional and can be used to draw a separator between each item in the control. It can also modify the<code class="literal"> Rect</code> if necessary, so that when<code class="literal"> OnDrawItem</code> is called it will know not to draw over the separator.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">The final method is<code class="literal"> OnDrawItem</code>. This method is used to draw the actual item. For our control, we draw a bitmap and then position the users' name as a label to the right of it. That's all there is to it; pretty easy right.</li></ol></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec10"/>There's more...</h2></div></div></div><p>There are a couple more methods available that can be useful in implementing a<code class="literal"> VListBox</code> subclass. The following list describes these methods.</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Methods</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">OnDrawItemBackground</code>
</p>
</td><td style="text-align: left" valign="top">
<p>This method can be overridden, as<code class="literal"> DrawItem</code> can, in order to draw a custom background for an item. The default base class does the reasonable thing of drawing the background of the selected item with the system default selection color.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">IsSelected</code>
</p>
</td><td style="text-align: left" valign="top">
<p>This method can be used to see if an item is selected or not, in case you want to change the way in which you draw the item in<code class="literal"> OnDrawItem</code>, for example making the font bold.</p>
</td></tr></tbody></table></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec11"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The<span class="emphasis"><em> Understanding inheritance limitations</em></span> recipe in<a class="link" href="ch01.html" title="Chapter 1. Getting Started with wxPython"> Chapter 1</a>,<span class="emphasis"><em> Getting Started with wxPython</em></span> contains an explanation about virtual methods in the C++ objects.</li><li class="listitem" style="list-style-type: disc">The<span class="emphasis"><em> Listing data with a ListCtrl</em></span> recipe in this chapter is another example of a control for presenting data as a list.</li><li class="listitem" style="list-style-type: disc">The<span class="emphasis"><em> Screen drawing</em></span> recipe in<a class="link" href="ch08.html" title="Chapter 8. Drawing to the Screen"> Chapter 8</a>,<span class="emphasis"><em> Drawing to the Screen</em></span>, discusses the usage of PaintEvents and Device Contexts.</li></ul></div></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="StyledTextCtrl using lexers"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec05"/>StyledTextCtrl using lexers</h1></div></div></div><p>The<code class="literal"> StyledTextCtrl</code> is an advanced text control class supplied by the<code class="literal"> wx.stc</code> module. The class is a wrapping around the Scintilla source control editing component (see<a class="ulink" href="http://www.scintilla.org)"> http://www.scintilla.org)</a>. The<code class="literal"> StyledTextCtrl</code> is primarily intended for displaying and working with source code for various programming languages. It provides built-in syntax highlighting support for many different types of source code files, and is extendable to work with custom lexers. This recipe shows how to setup the control to perform source code highlighting using its built-in lexer for Python.<a id="id168" class="indexterm"/>
</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec12"/>How to do it...</h2></div></div></div><p>To get started, we will define a language-generic editor class that will manage all the common style settings so that we can easily create other classes that support different types of programming languages:<a id="id169" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">imp ort wx
import wx.stc as stc
import keyword

class CodeEditorBase(stc.StyledTextCtrl):
    def __init__(self, parent):
        super(CodeEditorBase, self).__init__(parent)

        # Attributes
        font = wx.Font(10, wx.FONTFAMILY_MODERN,
                           wx.FONTSTYLE_NORMAL,
                           wx.FONTWEIGHT_NORMAL)
        self.face = font.GetFaceName()
        self.size = font.GetPointSize()

        # Setup
        self.SetupBaseStyles()

    def EnableLineNumbers(self, enable=True):
        """Enable/Disable line number margin"""
        if enable:
            self.SetMarginType(1, stc.STC_MARGIN_NUMBER)
            self.SetMarginMask(1, 0)
            self.SetMarginWidth(1, 25)
        else:
            self.SetMarginWidth(1, 0)

    def GetFaces(self):
        """Get font style dictionary"""
        return dict(font=self.face,
                    size=self.size)

    def SetupBaseStyles(self):
        """Sets up the the basic non lexer specific
        styles.
        """
        faces = self.GetFaces()
        default = "face:%(font)s,size:%(size)d" % faces
        self.StyleSetSpec(stc.STC_STYLE_DEFAULT, default)
        line = "back:#C0C0C0," + default
        self.StyleSetSpec(stc.STC_STYLE_LINENUMBER, line)
        self.StyleSetSpec(stc.STC_STYLE_CONTROLCHAR,
                          "face:%(font)s" % faces)

</pre></div><p>Now here we will derive a new class from our<code class="literal"> CodeEditorBase</code> class that specializes the control for Python files:<a id="id170" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">class PythonCodeEditor(CodeEditorBase):
    def __init__(self, parent):
        super(PythonCodeEditor, self).__init__(parent)

        # Setup
        self.SetLexer(wx.stc.STC_LEX_PYTHON)
        self.SetupKeywords()
        self.SetupStyles()
        self.EnableLineNumbers(True)

    def SetupKeywords(self):
        """Sets up the lexers keywords"""
        kwlist = u" ".join(keyword.kwlist)
        self.SetKeyWords(0, kwlist)
        #self.SetKeywords(1, user_kw)

    def SetupStyles(self):
        """Sets up the lexers styles"""
        # Python styles
        faces = self.GetFaces()
        fonts = "face:%(font)s,size:%(size)d" % faces
        default = "fore:#000000," + fonts

        # Default 
        self.StyleSetSpec(stc.STC_P_DEFAULT, default)
        # Comments
        self.StyleSetSpec(stc.STC_P_COMMENTLINE,
                          "fore:#007F00," + fonts)
        # Number
        self.StyleSetSpec(stc.STC_P_NUMBER,
                          "fore:#007F7F," + fonts)
        # String
        self.StyleSetSpec(stc.STC_P_STRING,
                          "fore:#7F007F," + fonts)
        # Single quoted string
        self.StyleSetSpec(stc.STC_P_CHARACTER,
                          "fore:#7F007F," + fonts)
        # Keyword
        self.StyleSetSpec(stc.STC_P_WORD,
                          "fore:#00007F,bold," + fonts)
        # Triple quotes
        self.StyleSetSpec(stc.STC_P_TRIPLE,
                          "fore:#7F0000," + fonts)
        # Triple double quotes
        self.StyleSetSpec(stc.STC_P_TRIPLEDOUBLE,
                          "fore:#7F0000," + fonts)
        # Class name definition
        self.StyleSetSpec(stc.STC_P_CLASSNAME,
                          "fore:#0000FF,bold," + fonts)
        # Function or method name definition
        self.StyleSetSpec(stc.STC_P_DEFNAME,
                          "fore:#007F7F,bold," + fonts)
        # Operators
        self.StyleSetSpec(stc.STC_P_OPERATOR, "bold," + fonts)
        # Identifiers
        self.StyleSetSpec(stc.STC_P_IDENTIFIER, default)
        # Comment-blocks
        self.StyleSetSpec(stc.STC_P_COMMENTBLOCK,
                          "fore:#7F7F7F," + fonts)
        # End of line where string is not closed
        eol_style = "fore:#000000,back:#E0C0E0,eol," + fonts
        self.StyleSetSpec(stc.STC_P_STRINGEOL, eol_style)

<a id="id171" class="indexterm"/>
</pre></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec13"/>How it works...</h2></div></div></div><p>We created two classes: a base editor class and a specialized class for Python source files. Let's first start by taking a look at the<code class="literal"> CodeEditorBase</code> class.</p><p>The<code class="literal"> CodeEditorBase</code> sets up the basic functionality of the control, and is just there to encapsulate some of the common items, should we decide to add other specialized classes for different types of source files later on.</p><p>First and foremost, it initializes the basic window styles and provides font information. The<code class="literal"> StyledTextCtrl</code> has a number of style specifications for styling different text in the buffer. These styles are specified using the<code class="literal"> StyleSetSpec</code> method, which takes the style ID and style specification string as arguments. The style IDs that are generic to all lexers are identified with the<code class="literal"> STC_STYLE_</code> prefix. The style specification string is formatted in the following way:<a id="id172" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">ATTRIBUTE:VALUE,ATTRIBUTE:VALUE,MODIFIER 
</pre></div><p>Here,<code class="literal"> ATTRIBUTE</code> and<code class="literal"> VALUE</code> are replaced by any combination of the possible specifications in the following table:<a id="id173" class="indexterm"/>
</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Attributes</p>
</th><th style="text-align: left" valign="bottom">
<p>Possible values</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">fore</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Foreground color; can either be a color name (black) or hex color string (for example,<code class="literal"> #000000)</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">back</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Background color; can either be a color name (white) or hex color string (for example,<code class="literal"> #FFFFFF)</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">face</code>
</p>
</td><td style="text-align: left" valign="top">
<p>A font face name (for example,<code class="literal"> Monaco)</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">size</code>
</p>
</td><td style="text-align: left" valign="top">
<p>A point size for the font (for example,<code class="literal"> 10)</code>
</p>
</td></tr></tbody></table></div><p>There is also support from some additional<code class="literal"> MODIFER</code> attributes that don't take a<code class="literal"> VALUE</code> argument:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Modifier</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">bold</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Makes the text bold</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">italic</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Italicizes the text</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">eol</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Extends the background style to the end of the current line</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">underline</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Underlines the text</p>
</td></tr></tbody></table></div><p>The<code class="literal"> StyledTextCtrl</code> also supports special margins on the left-hand side of the buffer for displaying things such as line numbers, breakpoints, and code folding buttons. Our<code class="literal"> CodeEditorBase</code> shows how to enable line numbers in the left-most margin with its<code class="literal"> EnableLineNumbers</code> method.<a id="id174" class="indexterm"/>
</p><p>Our derived<code class="literal"> PythonCodeEditor</code> class simply does the three basic things necessary to set up the proper lexer:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">First, it calls<code class="literal"> SetLexer</code> to set the lexer mode. This method simply takes one of the<code class="literal"> STC_LEX_FOO</code> values that are found in the<code class="literal"> stc</code> module.</li><li class="listitem">Second, it sets up the keywords for the lexer. There is little documentation on what keyword sets are available for each lexer, so it is sometimes necessary to look at the Scintilla source code to see what keyword sets have been defined for each lexer. The Python lexer supports two keyword sets: one for language keywords and a second for user- defined keywords. The<code class="literal"> SetKeywords</code> method takes two arguments: a keyword ID and a string of space-separated keywords to associate with that ID. Each keyword ID is associated with a Style ID for the given lexer. In this example, the keyword ID of zero is associated with the Style ID:<code class="literal"> STC_P_WORD</code>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Third and finally, it sets all of the styling specifications for the lexer. This is done just as we did in our base class by calling<code class="literal"> StyleSetSpec</code> for each lexer style specification ID that the lexer defines. A quick reference for what styles relate to what lexers can be found in the wxPython wiki (<a class="ulink" href="http://wiki.wxpython.org/StyledTextCtrl%20Lexer%20Quick%20Reference">http://wiki.wxpython.org/StyledTextCtrl%20Lexer%20Quick%20Reference</a>).<a id="id175" class="indexterm"/></li></ol></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec14"/>There's more...</h2></div></div></div><p>The<code class="literal"> StyledTextCtrl</code> is a big class that comes with a very large API. It has many additional features that we did not discuss here, such as pop-up lists for implementing auto-completion, clickable hotspots, code folding, and custom highlighting. Following are links to some references and documentation about the<code class="literal"> StyledTextCtrl:</code>
<a id="id176" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://www.yellowbrain.com/stc/index.html">http://www.yellowbrain.com/stc/index.html</a></li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://www.wxpython.org/docs/api/wx.stc.StyledTextCtrl-class.html">http://www.wxpython.org/docs/api/wx.stc.StyledTextCtrl-class.html</a></li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://wiki.wxpython.org/StyledTextCtrl">http://wiki.wxpython.org/StyledTextCtrl</a></li></ul></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec15"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The<span class="emphasis"><em> Using the TextCtrl</em></span> recipe in<a class="link" href="ch03.html" title="Chapter 3. Basic Building Blocks of a User Interface"> Chapter 3</a>,<span class="emphasis"><em> Basic Building Blocks of a User Interface</em></span> shows how to use the basic text control.</li><li class="listitem" style="list-style-type: disc">The<span class="emphasis"><em> StyledTextCtrl custom highlighting</em></span> recipe in<a class="link" href="ch10.html" title="Chapter 10. Creating Components and Extending Functionality"> Chapter 10</a>,<span class="emphasis"><em> Creating Components and Extending Functionality</em></span> shows how to extend the<code class="literal"> StyledTextCtrl</code> in order to perform custom text styling.</li></ul></div></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Working with tray icons"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec06"/>Working with tray icons</h1></div></div></div><p>Tray icons are UI components that integrate with the window manager's Task Bar (Windows / Linux) or Dock (OS X). They can be used for notifications and to provide a pop-up menu when the user clicks on the notification icon. This recipe shows how to create and use a tray icon through the use of the<code class="literal"> TaskBarIcon</code> class.<a id="id177" class="indexterm"/>
</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec16"/>How to do it...</h2></div></div></div><p>To create the icon bar for this recipe's sample code, we create a subclass of<code class="literal"> TaskBarIcon</code> that loads an image to use for its display, and that has handling for showing a<code class="literal"> Menu</code> when it is clicked on:<a id="id178" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">class CustomTaskBarIcon(wx.TaskBarIcon):
    ID_HELLO = wx.NewId()
    ID_HELLO2 = wx.NewId()
    def __init__(self):
        super(CustomTaskBarIcon, self).__init__()

        # Setup
        icon = wx.Icon("face-monkey.png", wx.BITMAP_TYPE_PNG)
        self.SetIcon(icon)

        # Event Handlers
        self.Bind(wx.EVT_MENU, self.OnMenu)

    def CreatePopupMenu(self):
        """Base class virtual method for creating the
        popup menu for the icon.
        """
        menu = wx.Menu()
        menu.Append(CustomTaskBarIcon.ID_HELLO, "HELLO")
        menu.Append(CustomTaskBarIcon.ID_HELLO2, "Hi!")
        menu.AppendSeparator()
        menu.Append(wx.ID_CLOSE, "Exit")
        return menu

    def OnMenu(self, event):
        evt_id = event.GetId()
        if evt_id == CustomTaskBarIcon.ID_HELLO:
            wx.MessageBox("Hello World!", "HELLO")
        elif evt_id == CustomTaskBarIcon.ID_HELLO2:
            wx.MessageBox("Hi Again!", "Hi!")
        elif evt_id == wx.ID_CLOSE:
            self.Destroy()
        else:
            event.Skip()

</pre></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec17"/>How it works...</h2></div></div></div><p>The<code class="literal"> TaskBarIcon</code> class is pretty easy and straightforward to use. All that needs to be done is to create an icon and call<code class="literal"> SetIcon</code> to create the UI part of the object that will be shown in the system tray. Then we override the<code class="literal"> CreatePopupMenu</code> method that the base class will call when the icon is clicked on, to create the menu. All that this method needs to do is create a<code class="literal"> Menu</code> object and then return it; the<code class="literal"> TaskBarIcon</code> class will take care of the rest. Finally, we added an event handler for<code class="literal"> EVT_MENU</code> to handle the menu events from our pop-up menu.<a id="id180" class="indexterm"/>
</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec18"/>There's more...</h2></div></div></div><p>The<code class="literal"> TaskBarIcon</code> class has a number of events associated with it, if you want to customize what different types of clicks do. Please see the following table for a list of available events and a description of when they are called.<a id="id181" class="indexterm"/>
</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Events</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">EVT_TASKBAR_CLICK</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Icon was clicked on by the mouse</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">EVT_TASKBAR_LEFT_DCLICK</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Left mouse button double clicked on the icon</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">EVT_TASKBAR_LEFT_DOWN</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Left mouse button clicked down on the icon</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">EVT_TASKBAR_LEFT_UP</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Left mouse button released on the icon</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">EVT_TASKBAR_MOVE</code>
</p>
</td><td style="text-align: left" valign="top">
<p>The<code class="literal"> TaskBarIcon</code> moved</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">EVT_TASKBAR_RIGHT_DCLICK</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Right mouse button double clicked on the icon</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">EVT_TASKBAR_RIGHT_DOWN</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Right mouse button clicked down on the icon</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">EVT_TASKBAR_RIGHT_UP</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Right mouse button released on the icon</p>
</td></tr></tbody></table></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec19"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The<span class="emphasis"><em> Adding Menus and MenuBars</em></span> recipe in<a class="link" href="ch03.html" title="Chapter 3. Basic Building Blocks of a User Interface"> Chapter 3</a>,<span class="emphasis"><em> Basic Building Blocks of a User Interface</em></span> contains more examples of using and creating menus.</li><li class="listitem" style="list-style-type: disc">The<span class="emphasis"><em> How to use PopupMenus</em></span> recipe in<a class="link" href="ch03.html" title="Chapter 3. Basic Building Blocks of a User Interface"> Chapter 3</a>,<span class="emphasis"><em> Basic Building Blocks of a User Interface</em></span> contains another example of creating a context menu.</li></ul></div></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Adding tabs to a Notebook"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec07"/>Adding tabs to a Notebook</h1></div></div></div><p>The<code class="literal"> Notebook</code> class is a container control that is used to manage multiple panels through the use of tabs. When a tab is selected, the associated panel is shown and the previous one is hidden. This recipe shows how to use the default native<code class="literal"> Notebook</code> class to create a tab-based user interface like the one shown in the following screenshot:<a id="id182" class="indexterm"/>
</p><div class="mediaobject"><img src="images/1780_04_03.jpg" alt="Adding tabs to a Notebook"/></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec20"/>How to do it...</h2></div></div></div><p>The following example code snippet defines a<code class="literal"> Notebook</code> class that has three tabs in it:<a id="id183" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">class MyNotebook(wx.Notebook):
    def __init__(self, parent):
        super(MyNotebook, self).__init__(parent)

        # Attributes
        self.textctrl = wx.TextCtrl(self, value="edit me",
                                    style=wx.TE_MULTILINE)
        self.blue = wx.Panel(self)
        self.blue.SetBackgroundColour(wx.BLUE)
        self.fbrowser = wx.GenericDirCtrl(self)

        # Setup
        self.AddPage(self.textctrl, "Text Editor")
        self.AddPage(self.blue, "Blue Panel")
        self.AddPage(self.fbrowser, "File Browser")

</pre></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec21"/>How it works...</h2></div></div></div><p>This recipe just shows the fundamental basics of how to use the<code class="literal"> Notebook</code> control. We simply created some window objects that we wish to put in the<code class="literal"> Notebook</code>. In this case, we created three different objects: a<code class="literal"> TextCtrl</code>, a<code class="literal"> Panel</code>, and a<code class="literal"> GenericDirCtrl</code>. The important thing to note is that the items that we wish to put in the<code class="literal"> Notebook</code> must be children of the<code class="literal"> Notebook</code>.<a id="id184" class="indexterm"/>
</p><p>The objects are then added to the<code class="literal"> Notebook</code> by calling its<code class="literal"> AddPage</code> method. This method takes a window object and a label to put on the tab as arguments.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec22"/>There's more...</h2></div></div></div><p>The basic<code class="literal"> Notebook</code> class doesn't offer too many more features beyond what was shown above. However, there are a few additional styles, and some events related to when tabs are selected. Included below are some quick references to these additional items.</p><div class="section" title="Styles"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec02"/>Styles</h3></div></div></div><p>The following styles can be provided to the Notebook's constructor:<a id="id185" class="indexterm"/>
</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Style</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">NB_BOTTOM</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Put the tabs at the bottom of the control area</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">NB_FIXEDWIDTH</code>
</p>
</td><td style="text-align: left" valign="top">
<p>All tabs are the same size (Windows only)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">NB_LEFT</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Put the tabs on the left side of the control area</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">NB_MULTILINE</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Allow for multiple rows of tabs (Windows only)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">NB_NOPAGETHEME</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Use a solid color for the tabs (Windows only)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">NB_RIGHT</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Put the tabs on the right-hand side of the control area</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">NB_TOP</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Put the tabs at the top of the control area (Default)</p>
</td></tr></tbody></table></div></div><div class="section" title="Events"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec03"/>Events</h3></div></div></div><p>The Notebook emits the following events:<a id="id186" class="indexterm"/>
</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Event</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">EVT_NOTEBOOK_PAGE_CHANGING</code>
</p>
</td><td style="text-align: left" valign="top">
<p>This event is fired when the Notebook is in the process of changing the page from one to another. Calling Veto on the event object will block the page from being changed.</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">EVT_NOTEBOOK_PAGE_CHANGED</code>
</p>
</td><td style="text-align: left" valign="top">
<p>This event is fired when the selected page has been changed.</p>
</td></tr></tbody></table></div></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec23"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The<span class="emphasis"><em> Using the FlatNotebook</em></span> recipe in this chapter shows the usage of another type of tab control.</li></ul></div></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Using the FlatNotebook"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec08"/>Using the FlatNotebook</h1></div></div></div><p>The<code class="literal"> FlatNotebook</code> class is a custom<code class="literal"> Notebook</code> implementation that provides a large array of features over the default<code class="literal"> Notebook</code>. The additional features include such things as being able to have a close button on each tab, drag and drop tabs to different positions, and a number of different tab styles to change the look and feel of the control. This recipe will explore some of the extended functionality that this control provides.<a id="id187" class="indexterm"/>
</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec24"/>How to do it...</h2></div></div></div><p>As an example of how to use the<code class="literal"> FlatNotebook</code>, we will define a subclass that has some specializations for displaying multiple<code class="literal"> TextCtrls:</code>
<a id="id188" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">import wx
import wx.lib
import wx.lib.flatnotebook as FNB

class MyFlatNotebook(FNB.FlatNotebook):
    def __init__(self, parent):
        mystyle = FNB.FNB_DROPDOWN_TABS_LIST|\
                  FNB.FNB_FF2|\
                  FNB.FNB_SMART_TABS|\
                  FNB.FNB_X_ON_TAB
        super(MyFlatNotebook, self).__init__(parent,
                                             style=mystyle)
        # Attributes
        self._imglst = wx.ImageList(16, 16)

        # Setup
        bmp = wx.Bitmap("text-x-generic.png")
        self._imglst.Add(bmp)
        bmp = wx.Bitmap("text-html.png")
        self._imglst.Add(bmp)
        self.SetImageList(self._imglst)

        # Event Handlers
        self.Bind(FNB.EVT_FLATNOTEBOOK_PAGE_CLOSING, 
                  self.OnClosing)

    def OnClosing(self, event):
        """Called when a tab is closing"""
        page = self.GetCurrentPage()
        if page and hasattr(page, "IsModified"):
            if page.IsModified():
                r = wx.MessageBox("Warning unsaved changes”
                                  “ will be lost",
                                  "Close Warning",
                                  wx.ICON_WARNING|\
                                  wx.OK|wx.CANCEL)
                if r == wx.CANCEL:
                    event.Veto()

</pre></div><p>In the following screenshot, we can see the above subclass in action, in a simple file editor application. The full source code for the below application is available with the code that accompanies this recipe.</p><div class="mediaobject"><img src="images/1780_04_04.jpg" alt="How to do it..."/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec25"/>How it works...</h2></div></div></div><p>This little recipe demonstrates quite a few of the features that the<code class="literal"> FlatNotebook</code> offers over the standard<code class="literal"> Notebook</code> class. So let's break it down, section by section, starting with the constructor.<a id="id190" class="indexterm"/>
</p><p>In our subclass's constructor we specified four style flags. The first,<code class="literal"> FNB_DROPDOWN_TAB_LIST</code>, specifies that we want to have a drop-down list that shows all the open tabs. The drop-down list is the small down-arrow button: clicking on it will show a pop-up menu that allows one of the currently open tabs to be selected from the list. The second style flag,<code class="literal"> FNB_FF2</code>, specifies that we want tabs that use the Firefox 2 tab renderer, which will draw tabs that look and feel similar to the ones in Firefox 2. The third style flag,<code class="literal"> FNB_SMART_TABS</code>, specifies that the<span class="emphasis"><em> Ctrl + Tab</em></span> shortcut will pop up a dialog that shows the open tabs and allows them to be cycled through by pressing the<span class="emphasis"><em> Tab</em></span> key. The fourth and final style flag that we used,<code class="literal"> FNB_X_ON_TAB</code>, specifies that we want a close button to be shown on the active tab. This allows the user to dismiss a tab when this button is clicked on.</p><p>In order to be able to show icons on the tabs, we also created and assigned an<code class="literal"> ImageList</code> to the control. An<code class="literal"> ImageList</code> is simply a container for holding<code class="literal"> Bitmap</code> objects, and the control will use it for retrieving the bitmap data when it draws the tabs. The important point to notice is that we keep a reference to the object by assigning it to<code class="literal"> self._imglst</code>; it is important to keep a reference to it so that it doesn't get garbage collected.</p><p>The last thing that we did was<code class="literal"> Bind</code> the control to the page closing event<code class="literal"> EVT_FLATNOTEBOOK_PAGE_CLOSING</code>. In this example, we are expecting our pages to provide an<code class="literal"> IsModified</code> method so that we can check for unsaved changes prior to closing the page, in order to give the user a chance to cancel closing the page.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec26"/>There's more...</h2></div></div></div><p>Because the<code class="literal"> FlatNotebook</code> is a pure Python class, it is more customizable than the basic<code class="literal"> Notebook</code> class. Included below is a listing of the style flags that can be used to customize the appearance and behavior of the control:<a id="id191" class="indexterm"/>
</p><div class="section" title="Style flags"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl3sec04"/>Style flags</h3></div></div></div><p>Here is a list of the other style flags that are available that we didn't already cover:</p><div class="informaltable"><table border="1"><colgroup><col style="text-align: left"/><col style="text-align: left"/></colgroup><thead><tr><th style="text-align: left" valign="bottom">
<p>Style flags</p>
</th><th style="text-align: left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_ALLOW_FOREIGN_DND</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Allow tabs to be dragged and moved to and accepted from other<code class="literal"> FlatNotebook</code> instances</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_BACKGROUND_GRADIENT</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Draw a gradient in the tabs background area</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_BOTTOM</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Place the tabs at the bottom of the control area</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_COLORFUL_TABS</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Use colorful tabs (VC8 style only)</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_DCLICK_CLOSES_TABS</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Allow double-clicks to close the active tab</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_DEFAULT_STYLE</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Combination of<code class="literal"> FNB_MOUSE_MIDDLE_CLOSES_TABS</code> and<code class="literal"> FNB_HIDE_ON_SINGLE_TAB</code>
</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_FANCY_TABS</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Use the<code class="literal"> fancy</code> tab renderer for drawing the tabs</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_HIDE_ON_SINGLE_TAB</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Hide the tab container area when there is only one tab open</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_MOUSE_MIDDLE_CLOSES_TABS</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Allow middle mouse button clicks to close tabs</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_NODRAG</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Don't allow tab drag and drop</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_NO_NAV_BUTTONS</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Don't show the tab scroll buttons</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_NO_X_BUTTON</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Don't show the<span class="strong"><strong> X</strong></span> button on the right hand side of the tab container area</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_TABS_BORDER_SIMPLE</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Draw a thin border around the page</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_VC71</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Use Visual Studio 2003 style tabs</p>
</td></tr><tr><td style="text-align: left" valign="top">
<p>
<code class="literal">FNB_VC8</code>
</p>
</td><td style="text-align: left" valign="top">
<p>Use Visual Studio 2005 style tabs</p>
</td></tr></tbody></table></div></div></div><div class="section" title="See also"><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec27"/>See also</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The<span class="emphasis"><em> Adding tabs to a Notebook</em></span> recipe in this chapter shows how to use the basic tab control.</li></ul></div></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Scrolling with a ScrolledPanel"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec09"/>Scrolling with a ScrolledPanel</h1></div></div></div><p>The<code class="literal"> ScrolledPanel</code> class is a custom<code class="literal"> Panel</code> class that has built in<code class="literal"> ScrollBars</code>. This class is provided by the<code class="literal"> scrolledpanel</code> module in<code class="literal"> wx.lib</code>. By default,<code class="literal"> Panels</code> do not have the ability to scroll when their contents overflow the windows given area. This recipe shows how to use the<code class="literal"> ScrolledPanel</code>, by using it to create a custom image list widget.<a id="id192" class="indexterm"/>
</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec28"/>How to do it...</h2></div></div></div><p>To create our custom image viewer control that uses the<code class="literal"> ScrolledPanel</code>, we will define this simple class that manages a list of<code class="literal"> Bitmaps:</code>
<a id="id193" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">import wx
import wx.lib.scrolledpanel as scrolledpanel

class ImageListCtrl(scrolledpanel.ScrolledPanel):
    """Simple control to display a list of images"""
    def __init__(self, parent, bitmaps=list(),
                 style=wx.TAB_TRAVERSAL|wx.BORDER_SUNKEN):
        super(ImageListCtrl, self).__init__(parent,
                                            style=style)

        # Attributes
        self.images = list()
        self.sizer = wx.BoxSizer(wx.VERTICAL)

        # Setup
        for bmp in bitmaps:
            self.AppendBitmap(bmp)
        self.SetSizer(self.sizer)

    def AppendBitmap(self, bmp):
        """Add another bitmap to the control"""
        self.images.append(bmp)
        sbmp = wx.StaticBitmap(self, bitmap=bmp)
        self.sizer.Add(sbmp, 0, wx.EXPAND|wx.TOP, 5)
        self.SetupScrolling()

<a id="id194" class="indexterm"/>
</pre></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec29"/>How it works...</h2></div></div></div><p>The<code class="literal"> ScrolledPanel</code> makes it pretty easy to work with<code class="literal"> ScrollBars</code>, so let's take a quick look at how it works.<a id="id195" class="indexterm"/>
</p><p>We created a simple class called<code class="literal"> ImageListCtrl</code>. This control can be used for displaying a list of bitmaps. We derived our class from<code class="literal"> ScrolledPanel</code> so that if it contains many images, the user will be able to scroll to see them all. The only special thing needed to use the<code class="literal"> ScrolledPanel</code> is to call its<code class="literal"> SetupScrolling</code> method when all of the panels' child controls have been added to its<code class="literal"> Sizer</code>. Typically, this is done in the subclasses<code class="literal"> __init__</code> method, but since our widget can add more<code class="literal"> Bitmap</code> items at any time we need to call it after each<code class="literal"> Bitmap</code> that is added in the<code class="literal"> AppendBitmap</code> method.</p><p>The<code class="literal"> SetupScrolling</code> method works by calculating the minimum size of the contents of the<code class="literal"> Panel</code> and setting up the virtual size of the containment area for the<code class="literal"> ScrollBar</code> objects to work with.<a id="id196" class="indexterm"/>
</p></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Simplifying the FoldPanelBar"><div class="titlepage"><div><div><h1 class="title"><a id="ch04lvl1sec10"/>Simplifying the FoldPanelBar</h1></div></div></div><p>The<code class="literal"> FoldPanelBar</code> is a custom container class that allows multiple controls to be grouped together into<code class="literal"> FoldPanelItem</code> controls that allow them to be expanded or contracted by clicking on its<code class="literal"> CaptionBar</code>. The<code class="literal"> FoldPanelBar</code> doesn't work with layouts based on a<code class="literal"> Sizer</code> and as such its API can get a little cumbersome, because it requires you to add each control one by one and set its layout by using various flags. This recipe shows how to create a custom<code class="literal"> FoldPanelBar</code> that works with<code class="literal"> Panel</code> objects. This class will allow for you to modularize your code into<code class="literal"> Panel</code> classes and then just add them to the<code class="literal"> FoldPanelBar</code> instead of directly adding everything to the<code class="literal"> FoldPanelBar</code> itself.<a id="id197" class="indexterm"/>
</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec30"/>How to do it...</h2></div></div></div><p>This custom<code class="literal"> FoldPanelBar</code> class uses a factory approach to simplify and abstract the addition of a new<code class="literal"> Panel</code> to the control:<a id="id198" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">import wx
import wx.lib.foldpanelbar as foldpanel

class FoldPanelMgr(foldpanel.FoldPanelBar):
    """Fold panel that manages a collection of Panels"""
    def __init__(self, parent, *args, **kwargs):
        super(FoldPanelMgr, self).__init__(parent,
                                           *args,
                                           **kwargs)

    def AddPanel(self, pclass, title=u"", collapsed=False):
        """Add a panel to the manager
        @param pclass: Class constructor (callable)
        @keyword title: foldpanel title
        @keyword collapsed: start with it collapsed
        @return: pclass instance
        """
        fpitem = self.AddFoldPanel(title, collapsed=collapsed)
        wnd = pclass(fpitem)
        best = wnd.GetBestSize()
        wnd.SetSize(best)
        self.AddFoldPanelWindow(fpitem, wnd)
        return wnd

</pre></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec31"/>How it works...</h2></div></div></div><p>Our subclass of<code class="literal"> FoldPanelBar</code>, adds one new method to the class<code class="literal"> AddPanel</code>. The<code class="literal"> AddPanel</code> method is a simple wrapper around the<code class="literal"> FoldPanelBar</code> control's<code class="literal"> AddFoldPanel</code> and<code class="literal"> AddFoldPanelWindow</code> methods. The<code class="literal"> AddFoldPanel</code> method is used to create the<code class="literal"> CaptionBar</code> and container for the controls and the<code class="literal"> AddFoldPanelWindow</code> method is used to add a Window object to the<code class="literal"> FoldPanel.</code>
<a id="id200" class="indexterm"/>
</p><p>Our<code class="literal"> AddPanel</code> method takes a callable object as its first parameter. The callable must accept a "parent" argument and return a new window that is a child of that parent window when called. We do this because our panels need to be created as children of the<code class="literal"> FoldPanelItem</code> that is returned by<code class="literal"> AddFoldPanel</code>. This is an important point to remember when working with the<code class="literal"> FoldPanelBar</code>. All of the controls that are added to it must be children of one of its<code class="literal"> FoldPanelItems</code> and not children of the<code class="literal"> FoldPanelBar</code> itself.</p><p>Since the<code class="literal"> FoldPanelBar</code> internally works with a manual layout, we need to set an explicit size on each<code class="literal"> Panel</code> as it is added. This is done by getting the best size from each Panel object's<code class="literal"> GetBestSize</code> method.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch04lvl2sec32"/>There's more...</h2></div></div></div><p>The<code class="literal"> CaptionBar</code> of the<code class="literal"> FoldPanelBar</code> can be customized by making a custom<code class="literal"> CaptionBarStyle</code> object and passing it to the<code class="literal"> AddFoldPanel</code> method. A<code class="literal"> CaptionBarStyle</code> object has methods for changing the colors, fonts, and styles that the<code class="literal"> CaptionBar</code> will use. The<code class="literal"> AddFoldPanel</code> method also accepts an optional<code class="literal"> foldIcons</code> argument, which accepts an<code class="literal"> ImageList</code> object that must have two 16x16 pixel bitmaps in it. The first will be used for the button's expanded state and the second will be used for its collapsed state.<a id="id201" class="indexterm"/>
</p></div></div></div>
</body></html>