<html><head></head><body>
<section data-number="0.4" id="chapter-1-numbers-strings-and-tuples">
<h2 class="likechapterhead" data-number="0.4"><span><span class="kobospan" id="kobo.1.1">1</span></span><br class="tipbox1"/> <span id="x1-170001"/><span class="kobospan" id="kobo.2.1">Numbers, Strings, and Tuples</span></h2>
<p class="normal"><span class="kobospan" id="kobo.3.1">This chapter will look at some of the central types of Python objects. </span><span class="kobospan" id="kobo.3.2">We’ll look at working with different kinds of numbers, working with strings, and using tuples. </span><span class="kobospan" id="kobo.3.3">These are the simplest kinds of data that Python works with. </span><span class="kobospan" id="kobo.3.4">In later chapters, we’ll look at data structures built on these foundations.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.4.1">While these recipes start with a beginner’s level of understanding of Python 3.12, they also provide some deeper background for those familiar with the language. </span><span class="kobospan" id="kobo.4.2">In particular, we’ll look at some details of how numbers are represented internally, because this can help when confronted with more advanced numerical programming problems. </span><span class="kobospan" id="kobo.4.3">This will help us distinguish the uses cases for the rich variety of numeric types.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.5.1">We’ll also look at the two different division operators. </span><span class="kobospan" id="kobo.5.2">These have distinct use cases, and we’ll look at one kind of algorithm that demands truncated division.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.6.1">When working with strings, there are several common operations that are important. </span><span class="kobospan" id="kobo.6.2">We’ll explore some of the differences between bytes—as used by our OS files—and strings used to represent Unicode text. </span><span class="kobospan" id="kobo.6.3">We’ll look at how we can exploit the full power of the Unicode character set.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.7.1">In this chapter, we’ll show the recipes as if we’re working from the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.8.1">&gt;&gt;&gt;</span></span></span></span><span class="kobospan" id="kobo.9.1"> prompt in interactive Python. </span><span class="kobospan" id="kobo.9.2">This is the prompt that’s provided when running </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.10.1">python</span></span></span></span><span class="kobospan" id="kobo.11.1"> from the command line or using</span><span id="dx1-17001"/><span class="kobospan" id="kobo.12.1"> the Python console in many </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.13.1">Integrated Development Environment </span></span><span class="kobospan" id="kobo.14.1">(</span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.15.1">IDE</span></span><span class="kobospan" id="kobo.16.1">) tools. </span><span class="kobospan" id="kobo.16.2">This</span><span id="dx1-17002"/><span class="kobospan" id="kobo.17.1"> is sometimes called the </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.18.1">read-evaluate-print loop </span></span><span class="kobospan" id="kobo.19.1">(</span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.20.1">REPL</span></span><span class="kobospan" id="kobo.21.1">). </span><span class="kobospan" id="kobo.21.2">In later chapters, we’ll change the style so it looks more like a script file. </span><span class="kobospan" id="kobo.21.3">One goal of this chapter is to encourage interactive exploration because it’s a great way to learn the language.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.22.1">We’ll cover these recipes to introduce basic Python data types:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><a href="ch005_split_000.xhtml#x1-180001" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.23.1">Choosing between float, decimal, and fraction</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch005_split_000.xhtml#x1-270002" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.24.1">Choosing between true division and floor division</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch005_split_000.xhtml#x1-350003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.25.1">String parsing with regular expressions</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch005_split_000.xhtml#x1-410004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.26.1">Building complicated strings with f-strings</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch005_split_000.xhtml#x1-470005" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.27.1">Building complicated strings from lists of strings</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch005_split_001.xhtml#x1-520006" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.28.1">Using the Unicode characters that aren’t on our keyboards</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch005_split_001.xhtml#x1-570007" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.29.1">Encoding strings – creating ASCII and UTF-8 bytes</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch005_split_001.xhtml#x1-620008" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.30.1">Decoding bytes – how to get proper characters from some bytes</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch005_split_001.xhtml#x1-670009" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.31.1">Using tuples of items</span></span></a></p></li>
<li class="calibre7"><p class="normal2"><a href="ch005_split_001.xhtml#x1-7500010" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.32.1">Using NamedTuples to simplify item access in tuples</span></span></a></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.33.1">We’ll start with numbers, work our way through strings, and end up working with simple combinations of objects in the form of tuples and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.34.1">NamedTuple</span></span></span></span><span class="kobospan" id="kobo.35.1"> objects. </span><span id="x1-17003r1"/></p>
<section data-number="0.4.1" id="choosing-between-float-decimal-and-fraction">
<h1 class="unnumbered" data-number="0.4.1"><span><span class="kobospan" id="kobo.36.1">1.1 </span></span> <span id="x1-180001"/><span class="kobospan" id="kobo.37.1">Choosing between float, decimal, and fraction</span></h1>
<p class="normal"><span class="kobospan" id="kobo.38.1">Python offers several ways to work with rational numbers and approximations of irrational numbers. </span><span class="kobospan" id="kobo.38.2">We have three basic choices:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.39.1">Float</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.40.1">Decimal</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.41.1">Fraction</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.42.1">When we have choices, it helps to have some criteria for making a selection. </span><span id="x1-18001r1"/></p>
<section data-number="0.4.1.1" id="getting-ready">
<h2 class="likechapterhead" data-number="0.4.1.1"><span><span class="kobospan" id="kobo.43.1">1.1.1 </span></span> <span id="x1-190001"/><span class="kobospan" id="kobo.44.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.45.1">There are three general cases for expressions that involve numbers beyond integers, which are:</span></p>
<ol class="calibre4">
<li class="calibre7"><div id="x1-19002x1" class="calibre14">
<p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.46.1">Currency</span></span><span class="kobospan" id="kobo.47.1">: Dollars, cents, euros, and so on. </span><span class="kobospan" id="kobo.47.2">Currency generally has a fixed number of decimal places and rounding rules to properly quantize results.</span></p>
</div></li>
<li class="calibre7"><div id="x1-19004x2" class="calibre14">
<p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.48.1">Rational Numbers or Fractions</span></span><span class="kobospan" id="kobo.49.1">: When we scale a recipe that serves eight</span><span id="dx1-19005"/><span class="kobospan" id="kobo.50.1">, for example, down to five people, we’re doing fractional math using a scaling factor of </span><span class="kobospan" id="kobo.51.1"><img alt="5 8" src="../media/file4.png" class="calibre9"/></span><span class="kobospan" id="kobo.52.1">.</span></p>
</div></li>
<li class="calibre7"><div id="x1-19007x3" class="calibre14">
<p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.53.1">Floating Point</span></span><span class="kobospan" id="kobo.54.1">: This includes all other kinds</span><span id="dx1-19008"/><span class="kobospan" id="kobo.55.1"> of calculations. </span><span class="kobospan" id="kobo.55.2">This also includes irrational numbers, like </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.56.1">π</span></span><span class="kobospan" id="kobo.57.1">, root extraction, and logarithms.</span></p>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.58.1">When we have one of the first two cases, we should avoid floating-point numbers. </span><span id="x1-19009r19"/></p>
</section>
<section data-number="0.4.1.2" id="how-to-do-it...">
<h2 class="likechapterhead" data-number="0.4.1.2"><span><span class="kobospan" id="kobo.59.1">1.1.2 </span></span> <span id="x1-200002"/><span class="kobospan" id="kobo.60.1">How to do it...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.61.1">We’ll look at each of the three cases separately.</span></p>
<section data-number="0.4.1.2.1" id="doing-currency-calculations">
<h3 class="likesubsubsectionhead" data-number="0.4.1.2.1"><span id="x1-210002"/><span class="kobospan" id="kobo.62.1">Doing currency calculations</span></h3>
<p class="normal"><span class="kobospan" id="kobo.63.1">When working with currency, we should</span><span id="dx1-21001"/><span class="kobospan" id="kobo.64.1"> always use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.65.1">decimal</span></span></span></span><span class="kobospan" id="kobo.66.1"> module. </span><span class="kobospan" id="kobo.66.2">If we try to use the values of Python’s built-in </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.67.1">float</span></span></span></span><span class="kobospan" id="kobo.68.1"> type, we can run into problems with the rounding and truncation of numbers:</span></p>
<ol class="calibre4">
<li class="calibre7"><div id="x1-21003x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.69.1">To work with currency, import the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.70.1">Decimal</span></span></span></span><span class="kobospan" id="kobo.71.1"> class from the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.72.1">decimal</span></span></span></span><span class="kobospan" id="kobo.73.1"> module:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.74.1">&gt;&gt;&gt; from decimal import Decimal</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-21007x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.75.1">We need to create </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.76.1">Decimal</span></span></span></span><span class="kobospan" id="kobo.77.1"> objects from strings or integers. </span><span class="kobospan" id="kobo.77.2">In this case, we want 7.25%, which is </span><span class="kobospan" id="kobo.78.1"><img alt="7.25 100" src="../media/file5.png" class="calibre9"/></span><span class="kobospan" id="kobo.79.1">. </span><span class="kobospan" id="kobo.79.2">We can compute the value using </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.80.1">Decimal</span></span></span></span><span class="kobospan" id="kobo.81.1"> objects:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.82.1">&gt;&gt;&gt; tax_rate = Decimal(’7.25’)/Decimal(100) 
 
&gt;&gt;&gt; purchase_amount = Decimal(’2.95’) 
 
&gt;&gt;&gt; tax_rate * purchase_amount 
 
Decimal(’0.213875’)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.83.1">We could also use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.84.1">Decimal(’0.0725’)</span></span></span></span><span class="kobospan" id="kobo.85.1"> instead of doing the division explicitly.</span></p>
</div></li>
<li class="calibre7"><div id="x1-21014x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.86.1">To round to the nearest penny, create a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.87.1">penny</span></span></span></span><span class="kobospan" id="kobo.88.1"> object:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.89.1">&gt;&gt;&gt; penny = Decimal(’0.01’)</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-21018x4" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.90.1">Quantize the result using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.91.1">penny</span></span></span></span><span class="kobospan" id="kobo.92.1"> object:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.93.1">&gt;&gt;&gt; total_amount = purchase_amount + tax_rate * purchase_amount 
 
&gt;&gt;&gt; total_amount.quantize(penny) 
 
Decimal(’3.16’)</span></code></pre>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.94.1">This uses the default rounding rule of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.95.1">ROUND_HALF_EVEN</span></span></span></span><span class="kobospan" id="kobo.96.1">. </span><span class="kobospan" id="kobo.96.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.97.1">Decimal</span></span></span></span><span class="kobospan" id="kobo.98.1"> module offers other rounding variations. </span><span class="kobospan" id="kobo.98.2">We might, for example, do something like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.99.1">&gt;&gt;&gt; import decimal 
 
&gt;&gt;&gt; total_amount.quantize(penny, decimal.ROUND_UP) 
 
Decimal(’3.17’)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.100.1">This shows the consequences</span><span id="dx1-21027"/><span class="kobospan" id="kobo.101.1"> of using a different rounding rule.</span></p>
</section>
<section data-number="0.4.1.2.2" id="fraction-calculations">
<h3 class="likesubsubsectionhead" data-number="0.4.1.2.2"><span id="x1-220002"/><span class="kobospan" id="kobo.102.1">Fraction calculations</span></h3>
<p class="normal"><span class="kobospan" id="kobo.103.1">When we’re doing calculations</span><span id="dx1-22001"/><span class="kobospan" id="kobo.104.1"> that have exact fraction values, we can use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.105.1">fractions</span></span></span></span><span class="kobospan" id="kobo.106.1"> module to create rational numbers. </span><span class="kobospan" id="kobo.106.2">In this example, we want to scale a recipe for eight down to five people, using </span><span class="kobospan" id="kobo.107.1"><img alt="58" src="../media/file6.png" class="calibre9"/></span><span class="kobospan" id="kobo.108.1"> of each ingredient. </span><span class="kobospan" id="kobo.108.2">When the recipe calls for 2</span><span class="kobospan" id="kobo.109.1"><img alt="1 2" src="../media/file7.png" class="calibre9"/></span><span class="kobospan" id="kobo.110.1"> cups of rice, what does that scale down to?</span></p>
<p class="normal1"><span class="kobospan" id="kobo.111.1">To work with fractions, we’ll do this:</span></p>
<ol class="calibre4">
<li class="calibre7"><div id="x1-22003x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.112.1">Import the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.113.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.114.1"> class from the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.115.1">fractions</span></span></span></span><span class="kobospan" id="kobo.116.1"> module:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.117.1">&gt;&gt;&gt; from fractions import Fraction</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-22007x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.118.1">Create </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.119.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.120.1"> objects from strings, integers, or pairs of integers. </span><span class="kobospan" id="kobo.120.2">We created one fraction from a string, ’</span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.121.1">2.5</span></span></span></span><span class="kobospan" id="kobo.122.1">’. </span><span class="kobospan" id="kobo.122.2">We created the second fraction from a floating-point expression, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.123.1">5</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.124.1"> /</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.125.1"> 8</span></span></span></span><span class="kobospan" id="kobo.126.1">. </span><span class="kobospan" id="kobo.126.2">This </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.127.1">only </span></span><span class="kobospan" id="kobo.128.1">works when the denominator is a power of 2:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.129.1">&gt;&gt;&gt; sugar_cups = Fraction(’2.5’) 
 
&gt;&gt;&gt; scale_factor = Fraction(5/8) 
 
&gt;&gt;&gt; sugar_cups * scale_factor 
 
Fraction(25, 16)</span></code></pre>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.130.1">We can see that we’ll use almost a cup and a half of rice to scale the recipe for five people instead of eight. </span><span class="kobospan" id="kobo.130.2">While float values will often be useful for rational fractions, they may not be exact unless the denominator</span><span id="dx1-22013"/><span class="kobospan" id="kobo.131.1"> is a power of two.</span></p>
</section>
<section data-number="0.4.1.2.3" id="floating-point-approximations">
<h3 class="likesubsubsectionhead" data-number="0.4.1.2.3"><span id="x1-230002"/><span class="kobospan" id="kobo.132.1">Floating-point approximations</span></h3>
<p class="normal"><span class="kobospan" id="kobo.133.1">Python’s built-in </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.134.1">float</span></span></span></span><span class="kobospan" id="kobo.135.1"> type can represent</span><span id="dx1-23001"/><span class="kobospan" id="kobo.136.1"> a wide variety of values. </span><span class="kobospan" id="kobo.136.2">The trade-off here is that a float value is often an approximation. </span><span class="kobospan" id="kobo.136.3">There may be a small discrepancy that reveals the differences between the implementation of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.137.1">float</span></span></span></span><span class="kobospan" id="kobo.138.1"> and the mathematical ideal of an irrational number:</span></p>
<ol class="calibre4">
<li class="calibre7"><div id="x1-23003x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.139.1">To work with </span><span class="obeylines-h"><span><span><span class="kobospan" id="kobo.140.1">float</span></span></span></span><span class="kobospan" id="kobo.141.1">, we often need to round values to make them look sensible. </span><span class="kobospan" id="kobo.141.2">It’s important to recognize that all float calculations are an approximation:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.142.1">&gt;&gt;&gt; (19/155)*(155/19) 
 
0.9999999999999999</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-23008x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.143.1">Mathematically, the value should be 1. </span><span class="kobospan" id="kobo.143.2">Because of the approximations used, the computed result isn’t exactly 1. </span><span class="kobospan" id="kobo.143.3">We can use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.144.1">round(answer,</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.145.1"> 3)</span></span></span></span><span class="kobospan" id="kobo.146.1"> to round to three digits, creating a value that’s more useful:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.147.1">&gt;&gt;&gt; answer = (19/155)*(155/19) 
 
&gt;&gt;&gt; round(answer, 3) 
 
1.0</span></code></pre>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.148.1">Approximations have a very important consequence.</span></p>
<div class="tipbox" id="tcolobox-5">
<div class="note">
<p class="normal1"><span class="kobospan" id="kobo.149.1">Don’t compare floating-point values for exact equality.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.150.1">Code that uses an exact </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.151.1">==</span></span></span></span><span class="kobospan" id="kobo.152.1"> test between floating-point numbers has the potential to cause problems when two approximations differ by a single bit.</span></p>
</div>
</div>
<p class="normal1"><span class="kobospan" id="kobo.153.1">The float approximation rules come from the IEEE, and are not a unique feature of Python. </span><span class="kobospan" id="kobo.153.2">Numerous programming languages</span><span id="dx1-23013"/><span class="kobospan" id="kobo.154.1"> work with float approximations and have identical behavior. </span><span id="x1-23014r20"/></p>
</section>
</section>
<section data-number="0.4.1.3" id="how-it-works...">
<h2 class="likechapterhead" data-number="0.4.1.3"><span><span class="kobospan" id="kobo.155.1">1.1.3 </span></span> <span id="x1-240003"/><span class="kobospan" id="kobo.156.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.157.1">For these numeric</span><span id="dx1-24001"/><span class="kobospan" id="kobo.158.1"> types, Python</span><span id="dx1-24002"/><span class="kobospan" id="kobo.159.1"> offers a variety</span><span id="dx1-24003"/><span class="kobospan" id="kobo.160.1"> of operators: </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.161.1">+</span></span></span></span><span class="kobospan" id="kobo.162.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.163.1">-</span></span></span></span><span class="kobospan" id="kobo.164.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.165.1">*</span></span></span></span><span class="kobospan" id="kobo.166.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.167.1">/</span></span></span></span><span class="kobospan" id="kobo.168.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.169.1">//</span></span></span></span><span class="kobospan" id="kobo.170.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.171.1">%</span></span></span></span><span class="kobospan" id="kobo.172.1">, and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.173.1">**</span></span></span></span><span class="kobospan" id="kobo.174.1">. </span><span class="kobospan" id="kobo.174.2">These are for addition, subtraction, multiplication, true division, truncated division, modulo, and raising to a power, respectively. </span><span class="kobospan" id="kobo.174.3">We’ll look at the two division operators, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.175.1">/</span></span></span></span><span class="kobospan" id="kobo.176.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.177.1">//</span></span></span></span><span class="kobospan" id="kobo.178.1">, in the </span><a href="ch005_split_000.xhtml#x1-270002" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.179.1">Choosing between true division and floor</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.180.1">division</span></span></a><span class="kobospan" id="kobo.181.1"> recipe.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.182.1">Python will do some conversions between the various numeric types. </span><span class="kobospan" id="kobo.182.2">We can mix </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.183.1">int</span></span></span></span><span class="kobospan" id="kobo.184.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.185.1">float</span></span></span></span><span class="kobospan" id="kobo.186.1"> values; the integers will be promoted to floating-point to provide the most accurate answer possible. </span><span class="kobospan" id="kobo.186.2">Similarly, we can mix </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.187.1">int</span></span></span></span><span class="kobospan" id="kobo.188.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.189.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.190.1"> as well as mixing </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.191.1">int</span></span></span></span><span class="kobospan" id="kobo.192.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.193.1">Decimal</span></span></span></span><span class="kobospan" id="kobo.194.1">. </span><span class="kobospan" id="kobo.194.2">Note that we cannot casually mix </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.195.1">Decimal</span></span></span></span><span class="kobospan" id="kobo.196.1"> with float or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.197.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.198.1">; an explicit conversion function will be required.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.199.1">It’s important to note that float values are approximations. </span><span class="kobospan" id="kobo.199.2">The Python syntax allows us to write floating-point values using base 10 digits; however, that’s not how values are represented internally.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.200.1">We can write the value 8</span><span class="cmti-10x-x"><span class="kobospan" id="kobo.201.1">.</span></span><span class="kobospan" id="kobo.202.1">066 </span><span><span class="kobospan" id="kobo.203.1">× </span></span><span class="kobospan" id="kobo.204.1">10</span><sup class="calibre15"><span class="cmr1"><span class="kobospan" id="kobo.205.1">67</span></span></sup><span class="kobospan" id="kobo.206.1"> like this in Python:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.207.1">&gt;&gt;&gt; 8.066e+67 
 
8.066e+67</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.208.1">The actual value used internally will involve a binary approximation of the decimal value we wrote. </span><span class="kobospan" id="kobo.208.2">The internal value for this example is this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.209.1">&gt;&gt;&gt; (6737037547376141/(2**53))*(2**226) 
 
8.066e+67</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.210.1">The numerator is a big number, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.211.1">6737037547376141</span></span></span></span><span class="kobospan" id="kobo.212.1">. </span><span class="kobospan" id="kobo.212.2">The denominator is always 2</span><sup class="calibre15"><span class="cmr1"><span class="kobospan" id="kobo.213.1">53</span></span></sup><span class="kobospan" id="kobo.214.1">. </span><span class="kobospan" id="kobo.214.2">This is why values can get truncated.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.215.1">We can use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.216.1">math.frexp()</span></span></span></span><span class="kobospan" id="kobo.217.1"> function to see these internal details of a number:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.218.1">&gt;&gt;&gt; import math 
 
&gt;&gt;&gt; math.frexp(8.066E+67) 
 
(0.7479614202861186, 226)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.219.1">The two parts</span><span id="dx1-24014"/><span class="kobospan" id="kobo.220.1"> are called</span><span id="dx1-24015"/><span class="kobospan" id="kobo.221.1"> the </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.222.1">mantissa </span></span><span class="kobospan" id="kobo.223.1">(or </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.224.1">significand</span></span><span class="kobospan" id="kobo.225.1">) and the </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.226.1">exponent</span></span><span class="kobospan" id="kobo.227.1">. </span><span class="kobospan" id="kobo.227.2">If we multiply the mantissa by 2</span><sup class="calibre15"><span class="cmr1"><span class="kobospan" id="kobo.228.1">53</span></span></sup><span class="kobospan" id="kobo.229.1">, we always get a whole number, which is the numerator of the binary fraction.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.230.1">Unlike the built-in float, a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.231.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.232.1"> is an exact ratio of two integer values. </span><span class="kobospan" id="kobo.232.2">We can create ratios that involve integers with a very large number of digits. </span><span class="kobospan" id="kobo.232.3">We’re not limited by a fixed denominator.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.233.1">A </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.234.1">Decimal</span></span></span></span><span class="kobospan" id="kobo.235.1"> value, similarly, is based</span><span id="dx1-24016"/><span class="kobospan" id="kobo.236.1"> on a very large integer</span><span id="dx1-24017"/><span class="kobospan" id="kobo.237.1"> value, as well as a scaling</span><span id="dx1-24018"/><span class="kobospan" id="kobo.238.1"> factor to determine where the decimal place goes. </span><span class="kobospan" id="kobo.238.2">These numbers can be huge and won’t suffer from peculiar representation issues. </span><span id="x1-24019r33"/></p>
</section>
<section data-number="0.4.1.4" id="theres-more...">
<h2 class="likechapterhead" data-number="0.4.1.4"><span><span class="kobospan" id="kobo.239.1">1.1.4 </span></span> <span id="x1-250004"/><span class="kobospan" id="kobo.240.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.241.1">The Python </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.242.1">math</span></span></span></span><span class="kobospan" id="kobo.243.1"> module</span><span id="dx1-25001"/><span class="kobospan" id="kobo.244.1"> contains several specialized functions for working with floating-point values. </span><span class="kobospan" id="kobo.244.2">This module includes common elementary functions such as square root, logarithms, and various trigonometry functions. </span><span class="kobospan" id="kobo.244.3">It also has some other functions such as gamma, factorial, and the Gaussian error function.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.245.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.246.1">math</span></span></span></span><span class="kobospan" id="kobo.247.1"> module</span><span id="dx1-25002"/><span class="kobospan" id="kobo.248.1"> includes several functions that can help us do more accurate floating-point calculations. </span><span class="kobospan" id="kobo.248.2">For example, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.249.1">math.fsum()</span></span></span></span><span class="kobospan" id="kobo.250.1"> function will compute a floating-point sum more carefully than the built-in </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.251.1">sum()</span></span></span></span><span class="kobospan" id="kobo.252.1"> function. </span><span class="kobospan" id="kobo.252.2">It’s less susceptible to approximation issues.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.253.1">We can also make use of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.254.1">math.isclose()</span></span></span></span><span class="kobospan" id="kobo.255.1"> function to compare two floating-point values, an expression, and a literal </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.256.1">1.0</span></span></span></span><span class="kobospan" id="kobo.257.1">, to see if they’re nearly equal:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.258.1">&gt;&gt;&gt; (19/155)*(155/19) == 1.0 
 
False 
 &gt;&gt;&gt; math.isclose((19/155)*(155/19), 1.0) 
 
True</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.259.1">This function provides us with a way to compare two floating-point numbers meaningfully for near-equality.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.260.1">Python also offers </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.261.1">complex </span></span><span class="kobospan" id="kobo.262.1">numbers. </span><span class="kobospan" id="kobo.262.2">A complex number</span><span id="dx1-25009"/><span class="kobospan" id="kobo.263.1"> has a real and an imaginary part. </span><span class="kobospan" id="kobo.263.2">In Python, we write </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.264.1">3.14+2.78j</span></span></span></span><span class="kobospan" id="kobo.265.1"> to represent the complex number 3</span><span class="cmti-10x-x"><span class="kobospan" id="kobo.266.1">.</span></span><span class="kobospan" id="kobo.267.1">14 + 2</span><span class="cmti-10x-x"><span class="kobospan" id="kobo.268.1">.</span></span><span class="kobospan" id="kobo.269.1">78</span><span class="kobospan" id="kobo.270.1"><img alt="√ --- − 1" class="calibre9" src="../media/file8.png"/></span><span class="kobospan" id="kobo.271.1">. </span><span class="kobospan" id="kobo.271.2">Python will comfortably convert between float and complex. </span><span class="kobospan" id="kobo.271.3">We have the usual group of operators available for complex numbers.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.272.1">To support complex</span><span id="dx1-25010"/><span class="kobospan" id="kobo.273.1"> numbers, there’s the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.274.1">cmath</span></span></span></span><span class="kobospan" id="kobo.275.1"> package. </span><span class="kobospan" id="kobo.275.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.276.1">cmath.sqrt()</span></span></span></span><span class="kobospan" id="kobo.277.1"> function, for example, will return a complex value rather than raise an exception when extracting the square root of a negative number. </span><span class="kobospan" id="kobo.277.2">Here’s an example:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.278.1">&gt;&gt;&gt; math.sqrt(-2) 
 
Traceback (most recent call last): 
 
... 
 
ValueError: math domain error 
 &gt;&gt;&gt; import cmath 
 
&gt;&gt;&gt; cmath.sqrt(-2) 
 
1.4142135623730951j</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.279.1">This module is helpful when working with complex numbers. </span><span id="x1-25020r37"/></p>
</section>
<section data-number="0.4.1.5" id="see-also">
<h2 class="likechapterhead" data-number="0.4.1.5"><span><span class="kobospan" id="kobo.280.1">1.1.5 </span></span> <span id="x1-260005"/><span class="kobospan" id="kobo.281.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.282.1">We’ll talk more about floating-point numbers and fractions in the </span><a href="ch005_split_000.xhtml#x1-270002" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.283.1">Choosing between true division and floor division</span></span></a><span class="kobospan" id="kobo.284.1"> recipe.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.285.1">See</span><span id="dx1-26001"/> <a class="url" href="https://en.wikipedia.org/wiki/IEEE_floating_point"><span class="url1"><span class="kobospan" id="kobo.286.1">https://en.wikipedia.org/wiki/IEEE_floating_point</span></span></a><span class="kobospan" id="kobo.287.1">.</span></p></li>
</ul>
<p class="normal1"><span id="x1-26002r18"/></p>
</section>
</section>
<section data-number="0.4.2" id="choosing-between-true-division-and-floor-division">
<h1 class="unnumbered" data-number="0.4.2"><span><span class="kobospan" id="kobo.288.1">1.2 </span></span> <span id="x1-270002"/><span class="kobospan" id="kobo.289.1">Choosing between true division and floor division</span></h1>
<p class="normal"><span class="kobospan" id="kobo.290.1">Python offers us two kinds of division</span><span id="dx1-27001"/><span class="kobospan" id="kobo.291.1"> operators. </span><span class="kobospan" id="kobo.291.2">What are they, and how do we know which one to use? </span><span class="kobospan" id="kobo.291.3">We’ll also look at the Python division rules and how they apply to integer values. </span><span id="x1-27002r40"/></p>
<section data-number="0.4.2.1" id="getting-ready-1">
<h2 class="likechapterhead" data-number="0.4.2.1"><span><span class="kobospan" id="kobo.292.1">1.2.1 </span></span> <span id="x1-280001"/><span class="kobospan" id="kobo.293.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.294.1">There are several general cases for division:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.295.1">A </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.296.1">div-mod </span></span><span class="kobospan" id="kobo.297.1">pair: We want both parts – the quotient</span><span id="dx1-28001"/><span class="kobospan" id="kobo.298.1"> and the remainder. </span><span class="kobospan" id="kobo.298.2">The name refers to the division and modulo operations combined together. </span><span class="kobospan" id="kobo.298.3">We can summarize the quotient and remainder as </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.299.1">q,r </span></span><span class="kobospan" id="kobo.300.1">= (</span><span><span class="kobospan" id="kobo.301.1">⌊</span></span><span class="kobospan" id="kobo.302.1"><img alt="a b" class="calibre9" data-align="middle" src="../media/file9.png"/></span><span><span class="kobospan" id="kobo.303.1">⌋</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.304.1">,a</span></span><span class="kobospan" id="kobo.305.1"> mod </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.306.1">b</span></span><span class="kobospan" id="kobo.307.1">).</span></p>
<p class="normal1"><span class="kobospan" id="kobo.308.1">We often use this when converting values from one base into another. </span><span class="kobospan" id="kobo.308.2">When we convert seconds into hours, minutes, and seconds, we’ll be doing a </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.309.1">div-mod </span></span><span class="kobospan" id="kobo.310.1">kind of division. </span><span class="kobospan" id="kobo.310.2">We don’t want the exact number of hours; we want a truncated number of hours, and the remainder will be converted into minutes and seconds.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.311.1">The </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.312.1">true </span></span><span class="kobospan" id="kobo.313.1">value: This is a typical floating-point value; it will be a good approximation</span><span id="dx1-28002"/><span class="kobospan" id="kobo.314.1"> to the quotient. </span><span class="kobospan" id="kobo.314.2">For example, if we’re computing an average of several measurements, we usually expect the result to be floating-point, even if the input values are all integers.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.315.1">A </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.316.1">rational fraction </span></span><span class="kobospan" id="kobo.317.1">value: This is often necessary when working</span><span id="dx1-28003"/><span class="kobospan" id="kobo.318.1"> in American units of feet, inches, and cups. </span><span class="kobospan" id="kobo.318.2">For this, we should be using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.319.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.320.1"> class. </span><span class="kobospan" id="kobo.320.2">When we divide </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.321.1">Fraction</span></span></span></span><span id="dx1-28004"/><span class="kobospan" id="kobo.322.1"> objects, we always get exact answers.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.323.1">We need to decide which of these cases apply, so we know which division operator to use. </span><span id="x1-28005r42"/></p>
</section>
<section data-number="0.4.2.2" id="how-to-do-it...-1">
<h2 class="likechapterhead" data-number="0.4.2.2"><span><span class="kobospan" id="kobo.324.1">1.2.2 </span></span> <span id="x1-290002"/><span class="kobospan" id="kobo.325.1">How to do it...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.326.1">We’ll look at these three cases separately.</span></p>
<section data-number="0.4.2.2.1" id="doing-floor-division">
<h3 class="likesubsubsectionhead" data-number="0.4.2.2.1"><span id="x1-300002"/><span class="kobospan" id="kobo.327.1">Doing floor division</span></h3>
<p class="normal"><span class="kobospan" id="kobo.328.1">When we are doing</span><span id="dx1-30001"/><span class="kobospan" id="kobo.329.1"> the </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.330.1">div-mod </span></span><span class="kobospan" id="kobo.331.1">kind of calculations, we might use the floor division operator, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.332.1">//</span></span></span></span><span class="kobospan" id="kobo.333.1">, and the modulo operator, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.334.1">%</span></span></span></span><span class="kobospan" id="kobo.335.1">. </span><span class="kobospan" id="kobo.335.2">The expression </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.336.1">a</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.337.1"> %</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.338.1"> b</span></span></span></span><span class="kobospan" id="kobo.339.1"> gives us the remainder from an integer division of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.340.1">a</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.341.1"> //</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.342.1"> b</span></span></span></span><span class="kobospan" id="kobo.343.1">. </span><span class="kobospan" id="kobo.343.2">Or, we might use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.344.1">divmod()</span></span></span></span><span class="kobospan" id="kobo.345.1"> built-in function to compute both at once:</span></p>
<ol class="calibre4">
<li class="calibre7"><div id="x1-30003x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.346.1">We’ll divide the number of seconds by 3,600 to get the value of hours. </span><span class="kobospan" id="kobo.346.2">The modulo, or remainder in division, computed with the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.347.1">%</span></span></span></span><span class="kobospan" id="kobo.348.1"> operator, can be converted separately into minutes and seconds:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.349.1">&gt;&gt;&gt; total_seconds = 7385 
 
&gt;&gt;&gt; hours = total_seconds // 3600 
 
&gt;&gt;&gt; remaining_seconds = total_seconds % 3600</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-30009x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.350.1">Next, we’ll divide the number of seconds by 60 to get minutes; the remainder is the number of seconds less than 60:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.351.1">&gt;&gt;&gt; minutes = remaining_seconds // 60 
 
&gt;&gt;&gt; seconds = remaining_seconds % 60 
 
&gt;&gt;&gt; hours, minutes, seconds 
 
(2, 3, 5)</span></code></pre>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.352.1">Here’s the alternative, using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.353.1">divmod()</span></span></span></span><span class="kobospan" id="kobo.354.1"> function to compute quotient and modulo together:</span></p>
<ol class="calibre4">
<li class="calibre7"><div id="x1-30016x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.355.1">Compute quotient</span><span id="dx1-30017"/><span class="kobospan" id="kobo.356.1"> and remainder at the same time:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.357.1">&gt;&gt;&gt; total_seconds = 7385 
 
&gt;&gt;&gt; hours, remaining_seconds = divmod(total_seconds, 3600)</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-30022x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.358.1">Compute quotient and remainder again:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.359.1">&gt;&gt;&gt; minutes, seconds = divmod(remaining_seconds, 60) 
 
&gt;&gt;&gt; hours, minutes, seconds 
 
(2, 3, 5)</span></code></pre>
</div></li>
</ol>
</section>
<section data-number="0.4.2.2.2" id="doing-true-division">
<h3 class="likesubsubsectionhead" data-number="0.4.2.2.2"><span id="x1-310002"/><span class="kobospan" id="kobo.360.1">Doing true division</span></h3>
<p class="normal"><span class="kobospan" id="kobo.361.1">Performing a true division</span><span id="dx1-31001"/><span class="kobospan" id="kobo.362.1"> calculation gives a floating-point approximation as the result. </span><span class="kobospan" id="kobo.362.2">For example, about how many hours is 7,385 seconds? </span><span class="kobospan" id="kobo.362.3">Here’s </span><span class="kobospan" id="kobo.363.1"><img alt="736805" src="../media/file10.png" class="calibre9"/></span><span class="kobospan" id="kobo.364.1"> using the true division operator:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.365.1">&gt;&gt;&gt; total_seconds = 7385 
 
&gt;&gt;&gt; hours = total_seconds / 3600 
 
&gt;&gt;&gt; round(hours, 4) 
 
2.0514</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.366.1">We provided two integer values, but got a floating-point exact result. </span><span class="kobospan" id="kobo.366.2">Consistent with our previous recipe, when using floating-point values, we rounded the result to avoid having to look at tiny error digits.</span></p>
</section>
<section data-number="0.4.2.2.3" id="rational-fraction-calculations">
<h3 class="likesubsubsectionhead" data-number="0.4.2.2.3"><span id="x1-320002"/><span class="kobospan" id="kobo.367.1">Rational fraction calculations</span></h3>
<p class="normal"><span class="kobospan" id="kobo.368.1">We can do division using </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.369.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.370.1"> objects</span><span id="dx1-32001"/><span class="kobospan" id="kobo.371.1"> and integers. </span><span class="kobospan" id="kobo.371.2">This forces the result to be a mathematically exact rational number:</span></p>
<ol class="calibre4">
<li class="calibre7"><div id="x1-32003x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.372.1">Create at least one </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.373.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.374.1"> value:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.375.1">&gt;&gt;&gt; from fractions import Fraction 
 
&gt;&gt;&gt; total_seconds = Fraction(7385)</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-32008x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.376.1">Use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.377.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.378.1"> value in a calculation. </span><span class="kobospan" id="kobo.378.2">Any integer will be promoted to a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.379.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.380.1">:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.381.1">&gt;&gt;&gt; hours = total_seconds / 3600 
 
&gt;&gt;&gt; hours 
 
Fraction(1477, 720)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.382.1">The denominator of 720 doesn’t seem too meaningful. </span><span class="kobospan" id="kobo.382.2">Working with fractions like this requires a bit of finesse to find useful denominators that makes sense to people. </span><span class="kobospan" id="kobo.382.3">Otherwise, converting to a floating-point value can be useful.</span></p>
</div></li>
<li class="calibre7"><div id="x1-32014x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.383.1">If necessary, convert the exact </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.384.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.385.1"> into a floating-point approximation:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.386.1">&gt;&gt;&gt; round(float(hours), 4) 
 
2.0514</span></code></pre>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.387.1">First, we created a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.388.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.389.1"> object for the total number of seconds. </span><span class="kobospan" id="kobo.389.2">When we do arithmetic on fractions, Python will promote any integers to </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.390.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.391.1"> objects; this promotion means that the math is done as precisely</span><span id="dx1-32018"/><span class="kobospan" id="kobo.392.1"> as possible. </span><span id="x1-32019r43"/></p>
</section>
</section>
<section data-number="0.4.2.3" id="how-it-works...-1">
<h2 class="likechapterhead" data-number="0.4.2.3"><span><span class="kobospan" id="kobo.393.1">1.2.3 </span></span> <span id="x1-330003"/><span class="kobospan" id="kobo.394.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.395.1">Python has two division operators:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.396.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.397.1">/</span></span></span></span><span class="kobospan" id="kobo.398.1"> true division operator produces</span><span id="dx1-33001"/><span class="kobospan" id="kobo.399.1"> a true, floating-point result. </span><span class="kobospan" id="kobo.399.2">It does this even when the two operands are integers. </span><span class="kobospan" id="kobo.399.3">This is an unusual operator in this respect. </span><span class="kobospan" id="kobo.399.4">All other operators preserve the type of the data. </span><span class="kobospan" id="kobo.399.5">The true division operation – when applied to integers – produces a float result.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.400.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.401.1">//</span></span></span></span><span class="kobospan" id="kobo.402.1"> truncated division operator always produces</span><span id="dx1-33002"/><span class="kobospan" id="kobo.403.1"> a truncated result. </span><span class="kobospan" id="kobo.403.2">For two integer operands, this is the truncated quotient. </span><span class="kobospan" id="kobo.403.3">When floating-point operands are used, this is a truncated floating-point result:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.404.1">&gt;&gt;&gt; 7358.0 // 3600.0 
 
2.0</span></code></pre></li>
</ul>
<p class="normal1"><span id="x1-33006r55"/></p>
</section>
<section data-number="0.4.2.4" id="see-also-1">
<h2 class="likechapterhead" data-number="0.4.2.4"><span><span class="kobospan" id="kobo.405.1">1.2.4 </span></span> <span id="x1-340004"/><span class="kobospan" id="kobo.406.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.407.1">For more on the choice between floating-point and fractions, see the </span><a href="ch005_split_000.xhtml#x1-180001" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.408.1">Choosing between float, decimal, and fraction</span></span></a><span class="kobospan" id="kobo.409.1"> recipe.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.410.1">See </span><a href="https://www.python.org/dev/peps/pep-0238" class="url"><span class="kobospan" id="kobo.411.1">PEP-238</span></a><span class="kobospan" id="kobo.412.1">.</span></p></li>
</ul>
<p class="normal1"><span id="x1-34001r41"/></p>
</section>
</section>
<section data-number="0.4.3" id="string-parsing-with-regular-expressions">
<h1 class="unnumbered" data-number="0.4.3"><span><span class="kobospan" id="kobo.413.1">1.3 </span></span> <span id="x1-350003"/><span class="kobospan" id="kobo.414.1">String parsing with regular expressions</span></h1>
<p class="normal"><span class="kobospan" id="kobo.415.1">How do we decompose</span><span id="dx1-35001"/><span class="kobospan" id="kobo.416.1"> a complex string? </span><span class="kobospan" id="kobo.416.2">What if we have</span><span id="dx1-35002"/><span class="kobospan" id="kobo.417.1"> complex, tricky punctuation? </span><span class="kobospan" id="kobo.417.2">Or—worse yet—what if we don’t have punctuation, but have to rely on patterns of digits to locate meaningful information? </span><span id="x1-35003r57"/></p>
<section data-number="0.4.3.1" id="getting-ready-2">
<h2 class="likechapterhead" data-number="0.4.3.1"><span><span class="kobospan" id="kobo.418.1">1.3.1 </span></span> <span id="x1-360001"/><span class="kobospan" id="kobo.419.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.420.1">The easiest way to decompose a complex string is by generalizing the string into a pattern and then writing a regular expression that describes that pattern.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.421.1">There are limits to the patterns that regular expressions can describe. </span><span class="kobospan" id="kobo.421.2">When we’re confronted with deeply nested documents in a language like HTML, XML, or JSON, we often run into problems and be prohibited from using regular expressions.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.422.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.423.1">re</span></span></span></span><span class="kobospan" id="kobo.424.1"> module contains all of the various classes and functions we need to create and use regular expressions.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.425.1">Let’s say that we want to decompose text from a recipe website. </span><span class="kobospan" id="kobo.425.2">Each line looks like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.426.1">&gt;&gt;&gt; ingredient = "Kumquat: 2 cups"</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.427.1">We want to separate the ingredient from the measurements. </span><span id="x1-36003r59"/></p>
</section>
<section data-number="0.4.3.2" id="how-to-do-it...-2">
<h2 class="likechapterhead" data-number="0.4.3.2"><span><span class="kobospan" id="kobo.428.1">1.3.2 </span></span> <span id="x1-370002"/><span class="kobospan" id="kobo.429.1">How to do it...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.430.1">To write and use regular expressions, we often do this:</span></p>
<ol class="calibre4">
<li class="calibre7"><div id="x1-37002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.431.1">Generalize the example. </span><span class="kobospan" id="kobo.431.2">In our case, we have something that we can generalize as:</span></p>
<pre class="programlisting" id="listing-2"><code class="calibre13"><span class="kobospan" id="kobo.432.1">(ingredient words): (amount digits) (unit words)</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-37005x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.433.1">We’ve replaced literal text with a two-part summary: what it means and how it’s represented. </span><span class="kobospan" id="kobo.433.2">For example, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.434.1">ingredient</span></span></span></span><span class="kobospan" id="kobo.435.1"> is represented as words, while </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.436.1">amount</span></span></span></span><span class="kobospan" id="kobo.437.1"> is represented as digits. </span><span class="kobospan" id="kobo.437.2">Import the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.438.1">re</span></span></span></span><span class="kobospan" id="kobo.439.1"> module:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.440.1">&gt;&gt;&gt; import re</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-37009x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.441.1">Rewrite the pattern into </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.442.1">regular expression </span></span><span class="kobospan" id="kobo.443.1">(</span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.444.1">RE</span></span><span class="kobospan" id="kobo.445.1">) notation:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.446.1">&gt;&gt;&gt; pattern_text = r’([\w\s]+):\s+(\d+)\s+(\w+)’</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.447.1">We’ve replaced representation hints such as </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.448.1">ingredient words</span></span><span class="kobospan" id="kobo.449.1">, a mixture of letters and spaces, with </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.450.1">[\w\s]+</span></span></span></span><span class="kobospan" id="kobo.451.1">. </span><span class="kobospan" id="kobo.451.2">We’ve replaced </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.452.1">amount digits</span></span><span class="kobospan" id="kobo.453.1"> with </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.454.1">\d+</span></span></span></span><span class="kobospan" id="kobo.455.1">. </span><span class="kobospan" id="kobo.455.2">And we’ve replaced </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.456.1">single spaces </span></span><span class="kobospan" id="kobo.457.1">with </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.458.1">\s+</span></span></span></span><span class="kobospan" id="kobo.459.1"> to allow one or more spaces to be used as punctuation. </span><span class="kobospan" id="kobo.459.2">We’ve left the colon in place because</span><span id="dx1-37012"/><span class="kobospan" id="kobo.460.1">, in regular expression</span><span id="dx1-37013"/><span class="kobospan" id="kobo.461.1"> notation, a colon matches itself.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.462.1">For each of the fields of data, we’ve used </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.463.1">()</span></span></span></span><span class="kobospan" id="kobo.464.1"> to capture the data matching the pattern. </span><span class="kobospan" id="kobo.464.2">We didn’t capture the colon or the spaces because we don’t need the punctuation characters.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.465.1">REs typically use a lot of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.466.1">\</span></span></span></span><span class="kobospan" id="kobo.467.1"> characters. </span><span class="kobospan" id="kobo.467.2">To make this work out nicely in Python, we almost always use </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.468.1">raw </span></span><span class="kobospan" id="kobo.469.1">strings. </span><span class="kobospan" id="kobo.469.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.470.1">r’</span></span></span></span><span class="kobospan" id="kobo.471.1"> tells Python not to look at the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.472.1">\</span></span></span></span><span class="kobospan" id="kobo.473.1"> characters and not to replace them with special characters that aren’t on our keyboards.</span></p>
</div></li>
<li class="calibre7"><div id="x1-37015x4" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.474.1">Compile the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.475.1">pattern</span></span></span></span><span class="kobospan" id="kobo.476.1">:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.477.1">&gt;&gt;&gt; pattern = re.compile(pattern_text)</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-37019x5" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.478.1">Match the pattern against the input text. </span><span class="kobospan" id="kobo.478.2">If the input matches the pattern, we’ll get a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.479.1">match</span></span></span></span><span class="kobospan" id="kobo.480.1"> object that shows details of the substring that matched:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.481.1">&gt;&gt;&gt; match = pattern.match(ingredient) 
 
&gt;&gt;&gt; match is None 
 
False 
 
&gt;&gt;&gt; match.groups() 
 
(’Kumquat’, ’2’, ’cups’)</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-37027x6" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.482.1">Extract the named groups of characters from the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.483.1">match</span></span></span></span><span class="kobospan" id="kobo.484.1"> object:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.485.1">&gt;&gt;&gt; match.group(1) 
 
’Kumquat’ 
 
&gt;&gt;&gt; match.group(2) 
 
’2’ 
 
&gt;&gt;&gt; match.group(3) 
 
’cups’</span></code></pre>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.486.1">Each group is identified by the order of the capture </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.487.1">()</span></span></span></span><span class="kobospan" id="kobo.488.1"> portions of the regular expression. </span><span class="kobospan" id="kobo.488.2">This gives us a tuple of the different fields captured from the string. </span><span class="kobospan" id="kobo.488.3">We’ll return to the use of the tuple data structure in the </span><a href="ch005_split_001.xhtml#x1-670009" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.489.1">Using tuples of items</span></span></a><span class="kobospan" id="kobo.490.1"> recipe. </span><span class="kobospan" id="kobo.490.2">This can be confusing in more complex regular expressions; there is a way to provide</span><span id="dx1-37035"/><span class="kobospan" id="kobo.491.1"> a name, instead of the numeric position, to identify</span><span id="dx1-37036"/><span class="kobospan" id="kobo.492.1"> a capture group. </span><span id="x1-37037r61"/></p>
</section>
<section data-number="0.4.3.3" id="how-it-works...-2">
<h2 class="likechapterhead" data-number="0.4.3.3"><span><span class="kobospan" id="kobo.493.1">1.3.3 </span></span> <span id="x1-380003"/><span class="kobospan" id="kobo.494.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.495.1">There are a lot of different kinds of string patterns that we can describe with regular expressions.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.496.1">We’ve shown a number of character classes:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.497.1">\w</span></span></span></span><span class="kobospan" id="kobo.498.1"> matches any alphanumeric character (a to z, A to Z, 0 to 9).</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.499.1">\d</span></span></span></span><span class="kobospan" id="kobo.500.1"> matches any decimal digit.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.501.1">\s</span></span></span></span><span class="kobospan" id="kobo.502.1"> matches any space or tab character.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.503.1">These classes also have inverses:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.504.1">\W</span></span></span></span><span class="kobospan" id="kobo.505.1"> matches any character that’s not a letter or a digit.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.506.1">\D</span></span></span></span><span class="kobospan" id="kobo.507.1"> matches any character that’s not a digit.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.508.1">\S</span></span></span></span><span class="kobospan" id="kobo.509.1"> matches any character that’s not some kind of space or tab.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.510.1">Many characters match themselves. </span><span class="kobospan" id="kobo.510.2">Some characters, however, have a special meaning, and we have to use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.511.1">\</span></span></span></span><span class="kobospan" id="kobo.512.1"> to escape from that special meaning:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.513.1">We saw that </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.514.1">+</span></span></span></span><span class="kobospan" id="kobo.515.1"> as a suffix means to match one or more of the preceding patterns. </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.516.1">\d+</span></span></span></span><span class="kobospan" id="kobo.517.1"> matches one or more digits. </span><span class="kobospan" id="kobo.517.2">To match an ordinary </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.518.1">+</span></span></span></span><span class="kobospan" id="kobo.519.1">, we need to use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.520.1">\+</span></span></span></span><span class="kobospan" id="kobo.521.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.522.1">We also have </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.523.1">*</span></span></span></span><span class="kobospan" id="kobo.524.1"> as a suffix, which matches zero or more of the preceding patterns. </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.525.1">\w*</span></span></span></span><span class="kobospan" id="kobo.526.1"> matches zero or more characters. </span><span class="kobospan" id="kobo.526.2">To match a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.527.1">*</span></span></span></span><span class="kobospan" id="kobo.528.1">, we need to use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.529.1">\*</span></span></span></span><span class="kobospan" id="kobo.530.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.531.1">We have </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.532.1">?</span></span></span></span><span class="kobospan" id="kobo.533.1"> as a suffix, which matches zero or one of the preceding expressions. </span><span class="kobospan" id="kobo.533.2">This character is used in other places, and has a different meaning in the other context. </span><span class="kobospan" id="kobo.533.3">We’ll see it used in </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.534.1">?P&lt;name&gt;...)|,</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.535.1"> where</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.536.1"> it</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.537.1"> is</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.538.1"> inside</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.539.1"> \verb|</span></span></span></span><span class="kobospan" id="kobo.540.1">)— to define special properties for the grouping.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.541.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.542.1">.</span></span></span></span><span class="kobospan" id="kobo.543.1"> character matches any single character. </span><span class="kobospan" id="kobo.543.2">To match a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.544.1">.</span></span></span></span><span class="kobospan" id="kobo.545.1"> specifically, we need to use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.546.1">\.</span></span></span></span><span class="kobospan" id="kobo.547.1">.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.548.1">We can create our own unique sets of characters using </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.549.1">[]</span></span></span></span><span class="kobospan" id="kobo.550.1"> to enclose the elements of the set. </span><span class="kobospan" id="kobo.550.2">We might have something like this:</span></p>
<pre class="programlisting" id="listing-3"><code class="calibre13"><span class="kobospan" id="kobo.551.1">(?P&lt;name&gt;\w+)\s*[=:]\s*(?P&lt;value&gt;.*)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.552.1">This has a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.553.1">\w+</span></span></span></span><span class="kobospan" id="kobo.554.1"> to match any number of alphanumeric characters. </span><span class="kobospan" id="kobo.554.2">This will be collected into a group called </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.555.1">name</span></span></span></span><span class="kobospan" id="kobo.556.1">. </span><span class="kobospan" id="kobo.556.2">It uses </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.557.1">\s*</span></span></span></span><span class="kobospan" id="kobo.558.1"> to match an optional sequence of spaces. </span><span class="kobospan" id="kobo.558.2">It matches any character in the set </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.559.1">[=:]</span></span></span></span><span class="kobospan" id="kobo.560.1">. </span><span class="kobospan" id="kobo.560.2">Exactly one of the two characters in this set must be present. </span><span class="kobospan" id="kobo.560.3">It uses </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.561.1">\s*</span></span></span></span><span class="kobospan" id="kobo.562.1"> again to match an optional sequence of spaces. </span><span class="kobospan" id="kobo.562.2">Finally, it uses </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.563.1">.*</span></span></span></span><span class="kobospan" id="kobo.564.1"> to match everything else in the string. </span><span class="kobospan" id="kobo.564.2">This is collected into a group named </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.565.1">value</span></span></span></span><span class="kobospan" id="kobo.566.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.567.1">We can use this to parse strings, like this:</span></p>
<pre class="programlisting" id="listing-4"><code class="calibre13"><span class="kobospan" id="kobo.568.1">size = 12 
 
weight: 14</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.569.1">By being flexible</span><span id="dx1-38004"/><span class="kobospan" id="kobo.570.1"> with the punctuation, we can make a program</span><span id="dx1-38005"/><span class="kobospan" id="kobo.571.1"> easier to use. </span><span class="kobospan" id="kobo.571.2">We’ll tolerate any number of spaces, and either an </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.572.1">=</span></span></span></span><span class="kobospan" id="kobo.573.1"> or a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.574.1">:</span></span></span></span><span class="kobospan" id="kobo.575.1"> as a separator. </span><span id="x1-38006r67"/></p>
</section>
<section data-number="0.4.3.4" id="theres-more...-1">
<h2 class="likechapterhead" data-number="0.4.3.4"><span><span class="kobospan" id="kobo.576.1">1.3.4 </span></span> <span id="x1-390004"/><span class="kobospan" id="kobo.577.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.578.1">A long regular expression can be awkward to read. </span><span class="kobospan" id="kobo.578.2">We have a clever Pythonic trick for presenting an expression in a way that’s much easier to read:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.579.1">&gt;&gt;&gt; ingredient_pattern = re.compile( 
 
... </span><span class="kobospan" id="kobo.579.2">r’(?P&lt;ingredient&gt;[\w\s]+):\s+’ # name of the ingredient up to the ":" 
 
... </span><span class="kobospan" id="kobo.579.3">r’(?P&lt;amount&gt;\d+)\s+’ # amount, all digits up to a space 
 
... </span><span class="kobospan" id="kobo.579.4">r’(?P&lt;unit&gt;\w+)’ # units, alphanumeric characters 
 
... </span><span class="kobospan" id="kobo.579.5">)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.580.1">This leverages three syntax</span><span id="dx1-39007"/><span class="kobospan" id="kobo.581.1"> rules:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.582.1">A statement isn’t finished until the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.583.1">()</span></span></span></span><span class="kobospan" id="kobo.584.1"> characters match.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.585.1">Adjacent string literals are silently concatenated into a single long string.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.586.1">Anything between </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.587.1">#</span></span></span></span><span class="kobospan" id="kobo.588.1"> and the end of the line is a comment, and is ignored.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.589.1">We’ve put Python comments after the important clauses in our regular expression. </span><span class="kobospan" id="kobo.589.2">This can help us understand what we did, and perhaps help us diagnose problems later.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.590.1">We can also use the regular expression’s ”verbose” mode to add gratuitous whitespace and comments inside a regular expression string. </span><span class="kobospan" id="kobo.590.2">To do this, we must use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.591.1">re.X</span></span></span></span><span class="kobospan" id="kobo.592.1"> as an option when compiling a regular expression to make whitespace and comments possible. </span><span class="kobospan" id="kobo.592.2">This revised syntax looks like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.593.1">&gt;&gt;&gt; ingredient_pattern_x = re.compile(r’’’ 
 
... </span><span class="kobospan" id="kobo.593.2">(?P&lt;ingredient&gt;[\w\s]+):\s+ # name of the ingredient up to the ":" 
 
... </span><span class="kobospan" id="kobo.593.3">(?P&lt;amount&gt;\d+)\s+ # amount, all digits up to a space 
 
... </span><span class="kobospan" id="kobo.593.4">(?P&lt;unit&gt;\w+) # units, alphanumeric characters 
 
... </span><span class="kobospan" id="kobo.593.5">’’’, re.X)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.594.1">We can either break the pattern up into separate string components, or make use of extended syntax to make the regular expression more readable. </span><span class="kobospan" id="kobo.594.2">The benefit of providing names shows up when we use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.595.1">groupdict()</span></span></span></span><span class="kobospan" id="kobo.596.1"> method of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.597.1">match</span></span></span></span><span class="kobospan" id="kobo.598.1"> object to extract parsed values by the name associated with the pattern being captured. </span><span id="x1-39014r68"/></p>
</section>
<section data-number="0.4.3.5" id="see-also-2">
<h2 class="likechapterhead" data-number="0.4.3.5"><span><span class="kobospan" id="kobo.599.1">1.3.5 </span></span> <span id="x1-400005"/><span class="kobospan" id="kobo.600.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.601.1">The </span><a href="ch005_split_001.xhtml#x1-620008" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.602.1">Decoding bytes – how to get proper characters from some bytes</span></span></a><span class="kobospan" id="kobo.603.1"> recipe.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.604.1">There are many books on regular expressions and Python regular expressions in particular, like </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.605.1">Mastering Python Regular Expressions</span></span> <a class="url" href="https://www.packtpub.com/application-development/mastering-python-regular-expressions"><span class="url1"><span class="kobospan" id="kobo.606.1">https://www.packtpub.com/application-development/mastering-python-regular-expressions</span></span></a><span class="kobospan" id="kobo.607.1">.</span></p></li>
</ul>
<p class="normal1"><span id="x1-40001r58"/></p>
</section>
</section>
<section data-number="0.4.4" id="building-complicated-strings-with-f-strings">
<h1 class="unnumbered" data-number="0.4.4"><span><span class="kobospan" id="kobo.608.1">1.4 </span></span> <span id="x1-410004"/><span class="kobospan" id="kobo.609.1">Building complicated strings with f-strings</span></h1>
<p class="normal"><span class="kobospan" id="kobo.610.1">Creating complex strings is, in many ways, the polar</span><span id="dx1-41001"/><span class="kobospan" id="kobo.611.1"> opposite of parsing</span><span id="dx1-41002"/><span class="kobospan" id="kobo.612.1"> a complex string. </span><span class="kobospan" id="kobo.612.2">We generally use a template with substitution rules to put data into a more complex format. </span><span id="x1-41003r71"/></p>
<section data-number="0.4.4.1" id="getting-ready-3">
<h2 class="likechapterhead" data-number="0.4.4.1"><span><span class="kobospan" id="kobo.613.1">1.4.1 </span></span> <span id="x1-420001"/><span class="kobospan" id="kobo.614.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.615.1">Let’s say we have pieces of data that we need to turn into a nicely formatted message. </span><span class="kobospan" id="kobo.615.2">We might have data that includes the following:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.616.1">&gt;&gt;&gt; id = "IAD" 
 
&gt;&gt;&gt; location = "Dulles Intl Airport" 
 
&gt;&gt;&gt; max_temp = 32 
 
&gt;&gt;&gt; min_temp = 13 
 
&gt;&gt;&gt; precipitation = 0.4</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.617.1">And we’d like a line that looks like this:</span></p>
<pre class="programlisting" id="listing-5"><code class="calibre13"><span class="kobospan" id="kobo.618.1">IAD : Dulles Intl Airport : 32 / 13 / 0.40</span></code></pre>
<p class="normal1"><span id="x1-42008r73"/></p>
</section>
<section data-number="0.4.4.2" id="how-to-do-it...-3">
<h2 class="likechapterhead" data-number="0.4.4.2"><span><span class="kobospan" id="kobo.619.1">1.4.2 </span></span> <span id="x1-430002"/><span class="kobospan" id="kobo.620.1">How to do it...</span></h2>
<ol class="calibre2">
<li class="calibre7"><div id="x1-43002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.621.1">Create an f-string for the result, replacing all of the data items with placeholders. </span><span class="kobospan" id="kobo.621.2">Inside each placeholder, put a variable name (or an expression.) Note that the string uses the prefix of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.622.1">f’</span></span></span></span><span class="kobospan" id="kobo.623.1">. </span><span class="kobospan" id="kobo.623.2">This prefix creates a sophisticated string object where values are interpolated into the template when the string is used:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.624.1">f’{id} : {location} : {max_temp} / {min_temp} / {precipitation}’</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-43006x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.625.1">For each name or expression, an optional data type can be appended to the names in the template string. </span><span class="kobospan" id="kobo.625.2">The basic data type codes are:</span></p>
<ul class="calibre17">
<li class="calibre12"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.626.1">s</span></span></span></span><span class="kobospan" id="kobo.627.1"> for string</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.628.1">d</span></span></span></span><span class="kobospan" id="kobo.629.1"> for decimal number</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.630.1">f</span></span></span></span><span class="kobospan" id="kobo.631.1"> for floating-point number</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.632.1">It would look like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.633.1">f’{id:s} : {location:s} : {max_temp:d} / {min_temp:d} / {precipitation:f}’</span></code></pre>
<div class="infobox" id="tcolobox-6">
<div class="note1">
<p class="normal2"><span class="kobospan" id="kobo.634.1">Because the book’s margins are narrow, the string has been broken to</span></p>
<p class="normal1"><span class="kobospan" id="kobo.635.1">fit on the page. </span><span class="kobospan" id="kobo.635.2">It’s a single (very wide) line of code.</span></p>
</div>
</div>
</div></li>
<li class="calibre7"><div id="x1-43010x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.636.1">Add length information</span><span id="dx1-43011"/><span class="kobospan" id="kobo.637.1"> where required. </span><span class="kobospan" id="kobo.637.2">Length is not always</span><span id="dx1-43012"/><span class="kobospan" id="kobo.638.1"> required, and in some cases, it’s not even desirable. </span><span class="kobospan" id="kobo.638.2">In this example, though, the length information ensures that each message has a consistent format. </span><span class="kobospan" id="kobo.638.3">For strings and decimal numbers, prefix the format with the length like this: </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.639.1">19s</span></span></span></span><span class="kobospan" id="kobo.640.1"> or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.641.1">3d</span></span></span></span><span class="kobospan" id="kobo.642.1">. </span><span class="kobospan" id="kobo.642.2">For floating-point numbers, use a two-part prefix like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.643.1">5.2f</span></span></span></span><span class="kobospan" id="kobo.644.1"> to specify the total length of five characters, with two to the right of the decimal point. </span><span class="kobospan" id="kobo.644.2">Here’s the whole format:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.645.1">&gt;&gt;&gt; f’{id:3s} : {location:19s} : {max_temp:3d} / {min_temp:3d} / {precipitation:5.2f}’ 
 
’IAD : Dulles Intl Airport :  32 /  13 /  0.40’</span></code></pre>
</div></li>
</ol>
<p class="normal1"><span id="x1-43016r75"/></p>
</section>
<section data-number="0.4.4.3" id="how-it-works...-3">
<h2 class="likechapterhead" data-number="0.4.4.3"><span><span class="kobospan" id="kobo.646.1">1.4.3 </span></span> <span id="x1-440003"/><span class="kobospan" id="kobo.647.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.648.1">F-strings can do a lot of relatively sophisticated string assembly by interpolating data into a template. </span><span class="kobospan" id="kobo.648.2">There are a number of conversions available.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.649.1">We’ve seen three of the formatting conversions—</span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.650.1">s</span></span></span></span><span class="kobospan" id="kobo.651.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.652.1">d</span></span></span></span><span class="kobospan" id="kobo.653.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.654.1">f</span></span></span></span><span class="kobospan" id="kobo.655.1">—but there are many others. </span><span class="kobospan" id="kobo.655.2">Details can be found in the </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.656.1">Formatted string literals </span></span><span class="kobospan" id="kobo.657.1">section of the </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.658.1">Python Standard Library</span></span><span class="kobospan" id="kobo.659.1">: </span><a class="url" href="https://docs.python.org/3/reference/lexical_analysis.html#formatted-string-literals"><span class="url1"><span class="kobospan" id="kobo.660.1">https://docs.python.org/3/reference/lexical_analysis.html\#formatted-string-literals</span></span></a><span class="kobospan" id="kobo.661.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.662.1">Here are some of the format conversions we might use:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.663.1">b</span></span></span></span><span class="kobospan" id="kobo.664.1"> is for binary, base 2.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.665.1">c</span></span></span></span><span class="kobospan" id="kobo.666.1"> is for Unicode character. </span><span class="kobospan" id="kobo.666.2">The value</span><span id="dx1-44001"/><span class="kobospan" id="kobo.667.1"> must be a number, which is converted</span><span id="dx1-44002"/><span class="kobospan" id="kobo.668.1"> into a character. </span><span class="kobospan" id="kobo.668.2">Often, we use hexadecimal numbers for these characters, so you might want to try values such as 0x2661 through 0x2666 to see interesting Unicode glyphs.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.669.1">d</span></span></span></span><span class="kobospan" id="kobo.670.1"> is for decimal numbers.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.671.1">E</span></span></span></span><span class="kobospan" id="kobo.672.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.673.1">e</span></span></span></span><span class="kobospan" id="kobo.674.1"> are for scientific notations. </span><span class="kobospan" id="kobo.674.2">6.626E-34 or 6.626e-34, depending on which </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.675.1">E</span></span></span></span><span class="kobospan" id="kobo.676.1"> or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.677.1">e</span></span></span></span><span class="kobospan" id="kobo.678.1"> character is used.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.679.1">F</span></span></span></span><span class="kobospan" id="kobo.680.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.681.1">f</span></span></span></span><span class="kobospan" id="kobo.682.1"> are for floating-point. </span><span class="kobospan" id="kobo.682.2">For </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.683.1">not a number</span></span><span class="kobospan" id="kobo.684.1">, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.685.1">f</span></span></span></span><span class="kobospan" id="kobo.686.1"> format shows lowercase </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.687.1">nan</span></span></span></span><span class="kobospan" id="kobo.688.1">; the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.689.1">F</span></span></span></span><span class="kobospan" id="kobo.690.1"> format shows uppercase </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.691.1">NAN</span></span></span></span><span class="kobospan" id="kobo.692.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.693.1">G</span></span></span></span><span class="kobospan" id="kobo.694.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.695.1">g</span></span></span></span><span class="kobospan" id="kobo.696.1"> are for general use. </span><span class="kobospan" id="kobo.696.2">This switches automatically between </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.697.1">E</span></span></span></span><span class="kobospan" id="kobo.698.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.699.1">F</span></span></span></span><span class="kobospan" id="kobo.700.1"> (or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.701.1">e</span></span></span></span><span class="kobospan" id="kobo.702.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.703.1">f</span></span></span></span><span class="kobospan" id="kobo.704.1">) to keep the output in the given sized field. </span><span class="kobospan" id="kobo.704.2">For a format of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.705.1">20.5G</span></span></span></span><span class="kobospan" id="kobo.706.1">, up to 20-digit numbers will be displayed using </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.707.1">F</span></span></span></span><span class="kobospan" id="kobo.708.1"> formatting. </span><span class="kobospan" id="kobo.708.2">Larger numbers will use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.709.1">E</span></span></span></span><span class="kobospan" id="kobo.710.1"> formatting.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.711.1">n</span></span></span></span><span class="kobospan" id="kobo.712.1"> is for locale-specific decimal numbers. </span><span class="kobospan" id="kobo.712.2">This will insert , or . </span><span class="kobospan" id="kobo.712.3">characters, depending on the current locale settings. </span><span class="kobospan" id="kobo.712.4">The default locale may not have 1,000 separators defined. </span><span class="kobospan" id="kobo.712.5">For more information, see the locale module.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.713.1">o</span></span></span></span><span class="kobospan" id="kobo.714.1"> is for octal, base 8.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.715.1">s</span></span></span></span><span class="kobospan" id="kobo.716.1"> is for string.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.717.1">X</span></span></span></span><span class="kobospan" id="kobo.718.1"> and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.719.1">x</span></span></span></span><span class="kobospan" id="kobo.720.1"> are for hexadecimal, base 16. </span><span class="kobospan" id="kobo.720.2">The digits include uppercase A-F and lowercase a-f, depending on which </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.721.1">X</span></span></span></span><span class="kobospan" id="kobo.722.1"> or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.723.1">x</span></span></span></span><span class="kobospan" id="kobo.724.1"> format character is used.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.725.1">%</span></span></span></span><span class="kobospan" id="kobo.726.1"> is for percentage. </span><span class="kobospan" id="kobo.726.2">The number is multiplied by 100 and the output includes a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.727.1">%</span></span></span></span><span class="kobospan" id="kobo.728.1"> character.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.729.1">We have a number of prefixes we can use for these different types. </span><span class="kobospan" id="kobo.729.2">The most common one is the length. </span><span class="kobospan" id="kobo.729.3">We might use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.730.1">{name:5d}</span></span></span></span><span class="kobospan" id="kobo.731.1"> to put in a 5-digit number. </span><span class="kobospan" id="kobo.731.2">There are several prefixes for the preceding types:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.732.1">Fill and alignment</span></span><span class="kobospan" id="kobo.733.1">: We can specify a specific</span><span id="dx1-44003"/><span class="kobospan" id="kobo.734.1"> filler character (space is the default) and an alignment. </span><span class="kobospan" id="kobo.734.2">Numbers are generally aligned to the right and strings to the left. </span><span class="kobospan" id="kobo.734.3">We can change that using </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.735.1">&lt;</span></span></span></span><span class="kobospan" id="kobo.736.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.737.1">&gt;</span></span></span></span><span class="kobospan" id="kobo.738.1">, or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.739.1">^</span></span></span></span><span class="kobospan" id="kobo.740.1">. </span><span class="kobospan" id="kobo.740.2">This forces left alignment, right alignment, or centering, respectively. </span><span class="kobospan" id="kobo.740.3">There’s a peculiar </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.741.1">=</span></span></span></span><span class="kobospan" id="kobo.742.1"> alignment that’s used to put padding after a leading sign.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.743.1">Sign</span></span><span class="kobospan" id="kobo.744.1">: The default rule is a leading negative sign where needed. </span><span class="kobospan" id="kobo.744.2">We can use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.745.1">+</span></span></span></span><span class="kobospan" id="kobo.746.1"> to put a sign on all numbers, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.747.1">-</span></span></span></span><span class="kobospan" id="kobo.748.1"> to put a sign only on negative numbers, and a space to use a space instead of a plus for positive numbers. </span><span class="kobospan" id="kobo.748.2">In scientific output, we often use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.749.1">{value:5.3f}</span></span></span></span><span class="kobospan" id="kobo.750.1">. </span><span class="kobospan" id="kobo.750.2">The space makes sure that room is left for the sign, ensuring that all the decimal points line up nicely.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.751.1">Alternate form</span></span><span class="kobospan" id="kobo.752.1">: We can use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.753.1">#</span></span></span></span><span class="kobospan" id="kobo.754.1"> to get an alternate form. </span><span class="kobospan" id="kobo.754.2">We might have something like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.755.1">{0:#x}</span></span></span></span><span class="kobospan" id="kobo.756.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.757.1">{0:#o}</span></span></span></span><span class="kobospan" id="kobo.758.1">, or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.759.1">{0:#b}</span></span></span></span><span class="kobospan" id="kobo.760.1"> to get a prefix on hexadecimal, octal, or binary values. </span><span class="kobospan" id="kobo.760.2">With a prefix, the numbers will look like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.761.1">0xnnn</span></span></span></span><span class="kobospan" id="kobo.762.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.763.1">0onnn</span></span></span></span><span class="kobospan" id="kobo.764.1">, or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.765.1">0bnnn</span></span></span></span><span class="kobospan" id="kobo.766.1">. </span><span class="kobospan" id="kobo.766.2">The default is to omit the two-character prefix.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.767.1">Leading zero</span></span><span class="kobospan" id="kobo.768.1">: We can include </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.769.1">0</span></span></span></span><span class="kobospan" id="kobo.770.1"> to get leading zeros to fill in the front of a number. </span><span class="kobospan" id="kobo.770.2">Something like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.771.1">{code:08x}</span></span></span></span><span class="kobospan" id="kobo.772.1"> will produce a hexadecimal value with leading zeroes to pad it out to eight characters.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="cmbx-10x-x"><span class="kobospan" id="kobo.773.1">Width and precision</span></span><span class="kobospan" id="kobo.774.1">: For integer values and strings, we only provide the width. </span><span class="kobospan" id="kobo.774.2">For floating-point values, we often provide </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.775.1">width.precision</span></span></span></span><span class="kobospan" id="kobo.776.1">.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.777.1">There are some times</span><span id="dx1-44004"/><span class="kobospan" id="kobo.778.1"> when we won’t use</span><span id="dx1-44005"/><span class="kobospan" id="kobo.779.1"> a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.780.1">{name:format}</span></span></span></span><span class="kobospan" id="kobo.781.1"> specification. </span><span class="kobospan" id="kobo.781.2">Sometimes, we’ll need to use a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.782.1">{name!conversion}</span></span></span></span><span class="kobospan" id="kobo.783.1"> specification. </span><span class="kobospan" id="kobo.783.2">There are only three conversions available:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.784.1">{name!r}</span></span></span></span><span class="kobospan" id="kobo.785.1"> shows the representation that would be produced by </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.786.1">repr(name)</span></span></span></span><span class="kobospan" id="kobo.787.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.788.1">{name!s}</span></span></span></span><span class="kobospan" id="kobo.789.1"> shows the string value that would be produced by </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.790.1">str(name)</span></span></span></span><span class="kobospan" id="kobo.791.1">; this is the default behavior if you don’t specify any conversion. </span><span class="kobospan" id="kobo.791.2">Using </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.792.1">!s</span></span></span></span><span class="kobospan" id="kobo.793.1"> explicitly lets you add string-type format specifiers.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.794.1">{name!a}</span></span></span></span><span class="kobospan" id="kobo.795.1"> shows the ASCII value that would be produced by </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.796.1">ascii(name)</span></span></span></span><span class="kobospan" id="kobo.797.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.798.1">Additionally, there’s a handy debugging format specifier available. </span><span class="kobospan" id="kobo.798.2">We can include a trailing equals sign, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.799.1">=</span></span></span></span><span class="kobospan" id="kobo.800.1">, to get a handy dump of a variable or expression. </span><span class="kobospan" id="kobo.800.2">The following example uses both forms:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.801.1">&gt;&gt;&gt; value = 2**12-1 
 
&gt;&gt;&gt; f’{value=} {2**7+1=}’ 
 
’value=4095 2**7+1=129’
     </span></code></pre></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.802.1">The f-string showed the value of the variable</span><span id="dx1-44010"/><span class="kobospan" id="kobo.803.1"> named </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.804.1">value</span></span></span></span><span class="kobospan" id="kobo.805.1"> and the result</span><span id="dx1-44011"/><span class="kobospan" id="kobo.806.1"> of an expression, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.807.1">2**7+1</span></span></span></span><span class="kobospan" id="kobo.808.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.809.1">In </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.810.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.811.1"> </span></span><a href="ch011_split_000.xhtml#x1-3760007" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.812.1">7</span></span></a><span class="kobospan" id="kobo.813.1">, we’ll leverage the idea of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.814.1">{name!r}</span></span></span></span><span class="kobospan" id="kobo.815.1"> format specification to simplify displaying information about related objects. </span><span id="x1-44012r79"/></p>
</section>
<section data-number="0.4.4.4" id="theres-more...-2">
<h2 class="likechapterhead" data-number="0.4.4.4"><span><span class="kobospan" id="kobo.816.1">1.4.4 </span></span> <span id="x1-450004"/><span class="kobospan" id="kobo.817.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.818.1">The f-string processing relies on the string </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.819.1">format()</span></span></span></span><span class="kobospan" id="kobo.820.1"> method. </span><span class="kobospan" id="kobo.820.2">We can leverage this method and the related </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.821.1">format_map()</span></span></span></span><span class="kobospan" id="kobo.822.1"> method for cases where we have more complex data structures.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.823.1">Looking forward to </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.824.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.825.1"> </span></span><a href="ch009.xhtml#x1-2890005" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.826.1">5</span></span></a><span class="kobospan" id="kobo.827.1">, we might have a dictionary where the keys are simple strings</span><span id="dx1-45001"/><span class="kobospan" id="kobo.828.1"> that fit with the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.829.1">format_map()</span></span></span></span><span class="kobospan" id="kobo.830.1"> rules:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.831.1">&gt;&gt;&gt; data = dict( 
 
... </span><span class="kobospan" id="kobo.831.2">id=id, location=location, max_temp=max_temp, 
 
... </span><span class="kobospan" id="kobo.831.3">min_temp=min_temp, precipitation=precipitation 
 
... </span><span class="kobospan" id="kobo.831.4">) 
 
&gt;&gt;&gt; ’{id:3s} : {location:19s} : {max_temp:3d} / {min_temp:3d} / {precipitation:5.2f}’.format_map(data) 
 
’IAD : Dulles Intl Airport :  32 /  13 /  0.40’</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.832.1">We’ve created a dictionary object, data, that contains a number of values with keys that are valid Python identifiers: </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.833.1">id</span></span></span></span><span class="kobospan" id="kobo.834.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.835.1">location</span></span></span></span><span class="kobospan" id="kobo.836.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.837.1">max_temp</span></span></span></span><span class="kobospan" id="kobo.838.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.839.1">min_temp</span></span></span></span><span class="kobospan" id="kobo.840.1">, and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.841.1">precipitation</span></span></span></span><span class="kobospan" id="kobo.842.1">. </span><span class="kobospan" id="kobo.842.2">We can then use this dictionary with the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.843.1">format_map()</span></span></span></span><span class="kobospan" id="kobo.844.1"> method to extract values from the dictionary using the keys.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.845.1">Note that the formatting template here is </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.846.1">not </span></span><span class="kobospan" id="kobo.847.1">an f-string. </span><span class="kobospan" id="kobo.847.2">It doesn’t have the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.848.1">f"</span></span></span></span><span class="kobospan" id="kobo.849.1"> prefix. </span><span class="kobospan" id="kobo.849.2">Instead of using the automatic formatting features of an f-string, we’ve done the interpolation ”the hard way” using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.850.1">format_map()</span></span></span></span><span class="kobospan" id="kobo.851.1"> method of an f-string. </span><span id="x1-45009r81"/></p>
</section>
<section data-number="0.4.4.5" id="see-also-3">
<h2 class="likechapterhead" data-number="0.4.4.5"><span><span class="kobospan" id="kobo.852.1">1.4.5 </span></span> <span id="x1-460005"/><span class="kobospan" id="kobo.853.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.854.1">More details can be found</span><span id="dx1-46001"/><span class="kobospan" id="kobo.855.1"> in the </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.856.1">Formatted string literals </span></span><span class="kobospan" id="kobo.857.1">section of the </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.858.1">Python Standard Library</span></span><span class="kobospan" id="kobo.859.1">: </span><a class="url" href="https://docs.python.org/3/reference/lexical_analysis.html#formatted-string-literals"><span class="url1"><span class="kobospan" id="kobo.860.1">https://docs.python.org/3/reference/lexical_analysis.html#formatted-string-literals</span></span></a><span class="kobospan" id="kobo.861.1">.</span></p></li>
</ul>
<p class="normal1"><span id="x1-46002r72"/></p>
</section>
</section>
<section data-number="0.4.5" id="building-complicated-strings-from-lists-of-strings">
<h1 class="unnumbered" data-number="0.4.5"><span><span class="kobospan" id="kobo.862.1">1.5 </span></span> <span id="x1-470005"/><span class="kobospan" id="kobo.863.1">Building complicated strings from lists of strings</span></h1>
<p class="normal"><span class="kobospan" id="kobo.864.1">How can we make complicated</span><span id="dx1-47001"/><span class="kobospan" id="kobo.865.1"> changes to an immutable</span><span id="dx1-47002"/><span class="kobospan" id="kobo.866.1"> string? </span><span class="kobospan" id="kobo.866.2">Can we assemble a string from individual characters?</span></p>
<p class="normal1"><span class="kobospan" id="kobo.867.1">In most cases, the recipes we’ve already seen give us a number of tools for creating and modifying strings. </span><span class="kobospan" id="kobo.867.2">There are yet more ways in which we can tackle the string manipulation problem. </span><span class="kobospan" id="kobo.867.3">In this recipe, we’ll look at using a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.868.1">list</span></span></span></span><span class="kobospan" id="kobo.869.1"> object as a way to decompose and rebuild a string. </span><span class="kobospan" id="kobo.869.2">This will dovetail with some of the recipes in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.870.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.871.1"> </span></span><a href="ch008_split_000.xhtml#x1-2240004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.872.1">4</span></span></a><span class="kobospan" id="kobo.873.1">. </span><span id="x1-47003r83"/></p>
<section data-number="0.4.5.1" id="getting-ready-4">
<h2 class="likechapterhead" data-number="0.4.5.1"><span><span class="kobospan" id="kobo.874.1">1.5.1 </span></span> <span id="x1-480001"/><span class="kobospan" id="kobo.875.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.876.1">Here’s a string that we’d like to rearrange:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.877.1">&gt;&gt;&gt; title = "Recipe 5: Rewriting an Immutable String"</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.878.1">We’d like to do two transformations:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.879.1">Remove the part before </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.880.1">:</span></span></span></span><span class="kobospan" id="kobo.881.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.882.1">Replace the punctuation with </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.883.1">_</span></span></span></span><span class="kobospan" id="kobo.884.1"> and make all the characters lowercase.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.885.1">We’ll make use of the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.886.1">string</span></span></span></span><span class="kobospan" id="kobo.887.1"> module:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.888.1">&gt;&gt;&gt; from string import whitespace, punctuation</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.889.1">This has two important constants:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.890.1">string.whitespace</span></span></span></span><span class="kobospan" id="kobo.891.1"> lists all of the whitespace characters that are also part of ASCII, including space and tab.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.892.1">string.punctuation</span></span></span></span><span class="kobospan" id="kobo.893.1"> lists punctuation marks that are also part of ASCII. </span><span class="kobospan" id="kobo.893.2">Unicode has a large domain of punctuation marks. </span><span class="kobospan" id="kobo.893.3">This is a widely used subset.</span></p></li>
</ul>
<p class="normal1"><span id="x1-48005r85"/></p>
</section>
</section>
</section>


<section data-number="0.4" id="chapter-1-numbers-strings-and-tuples">
<section data-number="0.4.5" id="building-complicated-strings-from-lists-of-strings">
<section data-number="0.4.5.2" id="how-to-do-it...-4">
<h2 class="likechapterhead" data-number="0.4.5.2"><span><span class="kobospan" id="kobo.894.1">1.5.2 </span></span> <span id="x1-490002"/><span class="kobospan" id="kobo.895.1">How to do it...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.896.1">We can work with a string</span><span id="dx1-49001"/><span class="kobospan" id="kobo.897.1"> exploded into a list. </span><span class="kobospan" id="kobo.897.2">We’ll look at lists</span><span id="dx1-49002"/><span class="kobospan" id="kobo.898.1"> in more depth in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.899.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.900.1"> </span></span><a href="ch008_split_000.xhtml#x1-2240004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.901.1">4</span></span></a><span class="kobospan" id="kobo.902.1">:</span></p>
<ol class="calibre4">
<li class="calibre7"><div id="x1-49004x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.903.1">Explode the string into a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.904.1">list</span></span></span></span><span class="kobospan" id="kobo.905.1"> object:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.906.1">&gt;&gt;&gt; title_list = list(title)</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-49008x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.907.1">Find the partition character. </span><span class="kobospan" id="kobo.907.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.908.1">index()</span></span></span></span><span class="kobospan" id="kobo.909.1"> method for a list has the same semantics as the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.910.1">index()</span></span></span></span><span class="kobospan" id="kobo.911.1"> method has for a string. </span><span class="kobospan" id="kobo.911.2">It locates the position with the given value:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.912.1">&gt;&gt;&gt; colon_position = title_list.index(’:’)</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-49012x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.913.1">Delete the characters that are no longer needed. </span><span class="kobospan" id="kobo.913.2">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.914.1">del</span></span></span></span><span class="kobospan" id="kobo.915.1"> statement can remove items from a list. </span><span class="kobospan" id="kobo.915.2">Unlike strings, lists are mutable data structures:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.916.1">&gt;&gt;&gt; del title_list[:colon_position+1]</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-49016x4" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.917.1">Replace punctuation by stepping through each position. </span><span class="kobospan" id="kobo.917.2">In this case, we’ll use a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.918.1">for</span></span></span></span><span class="kobospan" id="kobo.919.1"> statement to visit every index in the string:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.920.1">&gt;&gt;&gt; for position in range(len(title_list)): 
 
... </span><span class="kobospan" id="kobo.920.2">    if title_list[position] in whitespace+punctuation: 
 
... </span><span class="kobospan" id="kobo.920.3">        title_list[position]= ’_’</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-49022x5" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.921.1">The expression </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.922.1">range(len(title_list))</span></span></span></span><span class="kobospan" id="kobo.923.1"> generates all of the values between 0 and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.924.1">len(title_list)-1</span></span></span></span><span class="kobospan" id="kobo.925.1">. </span><span class="kobospan" id="kobo.925.2">This assures us that the value of position will be each value index in the list. </span><span class="kobospan" id="kobo.925.3">Join the list of characters to create a new string. </span><span class="kobospan" id="kobo.925.4">It seems a little odd to use a zero-length string, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.926.1">’’</span></span></span></span><span class="kobospan" id="kobo.927.1">, as a separator when concatenating strings together. </span><span class="kobospan" id="kobo.927.2">However, it works perfectly:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.928.1">&gt;&gt;&gt; title = ’’.join(title_list) 
 
&gt;&gt;&gt; title 
 
’_Rewriting_an_Immutable_String’</span></code></pre>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.929.1">We assigned the resulting string back to the original variable. </span><span class="kobospan" id="kobo.929.2">The original string object, which had been referred to by that variable, is no longer needed: it’s automatically removed from</span><span id="dx1-49027"/><span class="kobospan" id="kobo.930.1"> memory (this is known as </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.931.1">garbage collection</span></span><span class="kobospan" id="kobo.932.1">). </span><span class="kobospan" id="kobo.932.2">The new string object replaces the value of the variable. </span><span id="x1-49028r88"/></p>
</section>
<section data-number="0.4.5.3" id="how-it-works...-4">
<h2 class="likechapterhead" data-number="0.4.5.3"><span><span class="kobospan" id="kobo.933.1">1.5.3 </span></span> <span id="x1-500003"/><span class="kobospan" id="kobo.934.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.935.1">This is a change in representation trick. </span><span class="kobospan" id="kobo.935.2">Since a string is immutable, we can’t update it. </span><span class="kobospan" id="kobo.935.3">We can, however, convert it into a mutable form; in this case, a list. </span><span class="kobospan" id="kobo.935.4">We can make whatever changes are required to the mutable list object. </span><span class="kobospan" id="kobo.935.5">When we’re done, we can change the representation from a list back to a string and replace the original value of the variable.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.936.1">Lists provide some features that strings don’t have. </span><span class="kobospan" id="kobo.936.2">Conversely, strings provide a number of features lists don’t have. </span><span class="kobospan" id="kobo.936.3">As an example, we can’t convert a list into lowercase the way we can convert a string.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.937.1">There’s an important trade-off here:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.938.1">Strings are immutable, which makes them very fast. </span><span class="kobospan" id="kobo.938.2">Strings are focused on Unicode characters. </span><span class="kobospan" id="kobo.938.3">When we look at mappings and sets, we can use strings as keys for mappings and items in sets because the value is immutable.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.939.1">Lists are mutable. </span><span class="kobospan" id="kobo.939.2">Operations are slower. </span><span class="kobospan" id="kobo.939.3">Lists can hold any kind of item. </span><span class="kobospan" id="kobo.939.4">We can’t use a list as a key for a mapping or an item in a set because the list value could change.</span></p></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.940.1">Strings and lists are both specialized kinds of sequences. </span><span class="kobospan" id="kobo.940.2">Consequently, they have a number of common features. </span><span class="kobospan" id="kobo.940.3">The basic item indexing and slicing features are shared. </span><span class="kobospan" id="kobo.940.4">Similarly, a list uses the same kind of negative</span><span id="dx1-50001"/><span class="kobospan" id="kobo.941.1"> index values</span><span id="dx1-50002"/><span class="kobospan" id="kobo.942.1"> that a string does: the expression </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.943.1">list[-1]</span></span></span></span><span class="kobospan" id="kobo.944.1"> is the last item in a list object.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.945.1">We’ll return to mutable data structures in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.946.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.947.1"> </span></span><a href="ch008_split_000.xhtml#x1-2240004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.948.1">4</span></span></a><span class="kobospan" id="kobo.949.1">. </span><span id="x1-50003r94"/></p>
</section>
<section data-number="0.4.5.4" id="see-also-4">
<h2 class="likechapterhead" data-number="0.4.5.4"><span><span class="kobospan" id="kobo.950.1">1.5.4 </span></span> <span id="x1-510004"/><span class="kobospan" id="kobo.951.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.952.1">Sometimes, we need to build a string, and then convert it into bytes. </span><span class="kobospan" id="kobo.952.2">See the </span><a href="ch005_split_001.xhtml#x1-570007" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.953.1">Encoding strings – creating ASCII and UTF-8 bytes</span></span></a><span class="kobospan" id="kobo.954.1"> recipe for how we can do this.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.955.1">Other times, we’ll need to convert bytes into a string. </span><span class="kobospan" id="kobo.955.2">See the </span><a href="ch005_split_001.xhtml#x1-620008" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.956.1">Decoding</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.957.1">bytes – how to get proper characters from some bytes</span></span></a><span class="kobospan" id="kobo.958.1"> recipe for more information.</span></p></li>
</ul>
<p class="normal1"><span id="x1-51001r84"/></p>
</section>
</section>
<section data-number="0.4.6" id="using-the-unicode-characters-that-arent-on-our-keyboards">
<h1 class="unnumbered" data-number="0.4.6"><span><span class="kobospan" id="kobo.959.1">1.6 </span></span> <span id="x1-520006"/><span class="kobospan" id="kobo.960.1">Using the Unicode characters that aren’t on our keyboards</span></h1>
<p class="normal"><span class="kobospan" id="kobo.961.1">A big keyboard might</span><span id="dx1-52001"/><span class="kobospan" id="kobo.962.1"> have almost 100 individual keys. </span><span class="kobospan" id="kobo.962.2">Often, fewer than 50 of these keys are letters, numbers, and punctuation. </span><span class="kobospan" id="kobo.962.3">At least a dozen are </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.963.1">function</span></span><span class="kobospan" id="kobo.964.1"> keys that do things other than simply </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.965.1">insert </span></span><span class="kobospan" id="kobo.966.1">letters into a document. </span><span class="kobospan" id="kobo.966.2">Some of the keys are different kinds of </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.967.1">modifiers </span></span><span class="kobospan" id="kobo.968.1">that are meant to be used in conjunction with another key—for example, we might have </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.969.1">Shift</span></span><span class="kobospan" id="kobo.970.1">, </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.971.1">Ctrl</span></span><span class="kobospan" id="kobo.972.1">, </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.973.1">Option</span></span><span class="kobospan" id="kobo.974.1">, and </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.975.1">Command</span></span><span class="kobospan" id="kobo.976.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.977.1">Most operating systems will accept simple key combinations that create about 100 or so characters. </span><span class="kobospan" id="kobo.977.2">More elaborate key combinations may create another 100 or so less popular characters. </span><span class="kobospan" id="kobo.977.3">This isn’t even close to covering the vast domain of characters from the world’s alphabets. </span><span class="kobospan" id="kobo.977.4">And there are icons, emojis, and dingbats galore in our computer fonts. </span><span class="kobospan" id="kobo.977.5">How do we get to all of those glyphs? </span><span id="x1-52002r95"/></p>
<section data-number="0.4.6.1" id="getting-ready-5">
<h2 class="likechapterhead" data-number="0.4.6.1"><span><span class="kobospan" id="kobo.978.1">1.6.1 </span></span> <span id="x1-530001"/><span class="kobospan" id="kobo.979.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.980.1">Python works in Unicode. </span><span class="kobospan" id="kobo.980.2">There are thousands of individual Unicode characters available.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.981.1">We can see all the available</span><span id="dx1-53001"/><span class="kobospan" id="kobo.982.1"> characters at </span><a class="url" href="https://en.wikipedia.org/wiki/List_of_Unicode_characters"><span class="url1"><span class="kobospan" id="kobo.983.1">https://en.wikipedia.org/wiki/List_of_Unicode_characters</span></span></a><span class="kobospan" id="kobo.984.1">, as well as at </span><a class="url" href="http://www.unicode.org/charts/"><span class="url1"><span class="kobospan" id="kobo.985.1">http://www.unicode.org/charts/</span></span></a><span class="kobospan" id="kobo.986.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.987.1">We’ll need the Unicode character number. </span><span class="kobospan" id="kobo.987.2">We may also want the Unicode character name.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.988.1">A given font on our computer may not be designed to provide glyphs for all of those characters. </span><span class="kobospan" id="kobo.988.2">In particular, Windows computer fonts may have trouble displaying some of these characters. </span><span class="kobospan" id="kobo.988.3">Using the following Windows command to change to code page 65001 is sometimes necessary:</span></p>
<pre class="programlisting" id="listing-6"><code class="calibre13"><span class="kobospan" id="kobo.989.1">chcp 65001</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.990.1">Linux and macOS rarely have problems with Unicode characters. </span><span id="x1-53003r97"/></p>
</section>
<section data-number="0.4.6.2" id="how-to-do-it...-5">
<h2 class="likechapterhead" data-number="0.4.6.2"><span><span class="kobospan" id="kobo.991.1">1.6.2 </span></span> <span id="x1-540002"/><span class="kobospan" id="kobo.992.1">How to do it...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.993.1">Python uses </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.994.1">escape sequences </span></span><span class="kobospan" id="kobo.995.1">to extend the ordinary characters</span><span id="dx1-54001"/><span class="kobospan" id="kobo.996.1"> we can type</span><span id="dx1-54002"/><span class="kobospan" id="kobo.997.1"> to cover the vast space of Unicode characters. </span><span class="kobospan" id="kobo.997.2">Each escape sequence starts with a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.998.1">\</span></span></span></span><span class="kobospan" id="kobo.999.1"> character. </span><span class="kobospan" id="kobo.999.2">The next character tells us exactly which of the Unicode characters to create. </span><span class="kobospan" id="kobo.999.3">Locate the character that’s needed. </span><span class="kobospan" id="kobo.999.4">Get the name or the number. </span><span class="kobospan" id="kobo.999.5">The numbers are always given as hexadecimal, base 16. </span><span class="kobospan" id="kobo.999.6">Websites describing Unicode often write the character as </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1000.1">U+2680</span></span></span></span><span class="kobospan" id="kobo.1001.1">. </span><span class="kobospan" id="kobo.1001.2">The name might be </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1002.1">DIE</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1003.1"> FACE-1</span></span></span></span><span class="kobospan" id="kobo.1004.1">. </span><span class="kobospan" id="kobo.1004.2">Use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1005.1">\unnnn</span></span></span></span><span class="kobospan" id="kobo.1006.1"> with up to a four-digit number, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1007.1">nnnn</span></span></span></span><span class="kobospan" id="kobo.1008.1">. </span><span class="kobospan" id="kobo.1008.2">Or, use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1009.1">\N{name}</span></span></span></span><span class="kobospan" id="kobo.1010.1"> with the spelled-out name. </span><span class="kobospan" id="kobo.1010.2">If the number is more than four digits, use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1011.1">\Unnnnnnnn</span></span></span></span><span class="kobospan" id="kobo.1012.1"> with the number padded out to exactly eight digits:</span></p>
<pre class="programlisting" id="listing-7"><code class="calibre13"><span class="kobospan" id="kobo.1013.1">&gt;&gt;&gt; ’You Rolled \u2680’ 
 
’You Rolled ’ 
 &gt;&gt;&gt; ’You drew \U0001F000’ 
 
’You drew ’ 
 &gt;&gt;&gt; ’Discard \N{MAHJONG TILE RED DRAGON}’ 
 
’Discard ’</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1014.1">Yes, we can include a wide variety of characters in Python output. </span><span class="kobospan" id="kobo.1014.2">To place a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1015.1">\</span></span></span></span><span class="kobospan" id="kobo.1016.1"> in the string without the following characters being part of an escape sequence, we need to use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1017.1">\\</span></span></span></span><span class="kobospan" id="kobo.1018.1">. </span><span class="kobospan" id="kobo.1018.2">For example, we might need this for Windows file paths. </span><span id="x1-54011r98"/></p>
</section>
<section data-number="0.4.6.3" id="how-it-works...-5">
<h2 class="likechapterhead" data-number="0.4.6.3"><span><span class="kobospan" id="kobo.1019.1">1.6.3 </span></span> <span id="x1-550003"/><span class="kobospan" id="kobo.1020.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1021.1">Python uses Unicode internally. </span><span class="kobospan" id="kobo.1021.2">The 128 or so characters we can type directly using the keyboard all have handy internal Unicode numbers.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1022.1">When we write:</span></p>
<pre class="programlisting" id="listing-8"><code class="calibre13"><span class="kobospan" id="kobo.1023.1">’HELLO’</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1024.1">Python treats it as shorthand for this:</span></p>
<pre class="programlisting" id="listing-9"><code class="calibre13"><span class="kobospan" id="kobo.1025.1">’\u0048\u0045\u004c\u004c\u004f’</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1026.1">Once we get beyond the characters on our keyboards, the remaining thousands of characters are identified only by their number.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1027.1">When the string is being compiled by Python, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1028.1">\uxxxx</span></span></span></span><span class="kobospan" id="kobo.1029.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1030.1">\Uxxxxxxxx</span></span></span></span><span class="kobospan" id="kobo.1031.1">, and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1032.1">\N{name}</span></span></span></span><span class="kobospan" id="kobo.1033.1"> are all replaced by the proper Unicode character. </span><span class="kobospan" id="kobo.1033.2">If we have something syntactically wrong—for example, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1034.1">\N{name</span></span></span></span><span class="kobospan" id="kobo.1035.1"> with no closing </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1036.1">}</span></span></span></span><span class="kobospan" id="kobo.1037.1">—we’ll get an immediate error from Python’s internal syntax checking.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1038.1">Regular expressions use a lot of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1039.1">\</span></span></span></span><span class="kobospan" id="kobo.1040.1"> characters</span><span id="dx1-55003"/><span class="kobospan" id="kobo.1041.1"> and that we specifically do not want Python’s normal compiler to touch them; we used the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1042.1">r’</span></span></span></span><span class="kobospan" id="kobo.1043.1"> prefix on a regular expression string to prevent </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1044.1">\</span></span></span></span><span class="kobospan" id="kobo.1045.1"> from being treated as an escape and possibly converted into something else. </span><span class="kobospan" id="kobo.1045.2">To use the full domain of Unicode characters, we cannot avoid using </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1046.1">\</span></span></span></span><span class="kobospan" id="kobo.1047.1"> as an escape.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1048.1">What if we need to use Unicode in a regular expression? </span><span class="kobospan" id="kobo.1048.2">We’ll need to use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1049.1">\\</span></span></span></span><span class="kobospan" id="kobo.1050.1"> all over the place in the regular expression. </span><span class="kobospan" id="kobo.1050.2">We might see something like this: </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1051.1">’\\w+[\u2680\u2681\u2682\u2683\u2684\u2685]\\d+’</span></span></span></span><span class="kobospan" id="kobo.1052.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1053.1">We couldn’t use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1054.1">r’</span></span></span></span><span class="kobospan" id="kobo.1055.1"> prefix on the string because we needed to have the Unicode escapes processed. </span><span class="kobospan" id="kobo.1055.2">This forced us to use </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1056.1">\\</span></span></span></span><span class="kobospan" id="kobo.1057.1"> for elements of the regular expression. </span><span class="kobospan" id="kobo.1057.2">We used </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1058.1">\uxxxx</span></span></span></span><span class="kobospan" id="kobo.1059.1"> for the Unicode characters that are part of the pattern. </span><span class="kobospan" id="kobo.1059.2">Python’s internal compiler will replace </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1060.1">\uxxxx</span></span></span></span><span class="kobospan" id="kobo.1061.1"> with Unicode characters and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1062.1">\\w</span></span></span></span><span class="kobospan" id="kobo.1063.1"> will become the required </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1064.1">\w</span></span></span></span><span class="kobospan" id="kobo.1065.1"> internally.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1066.1">When we look at a string at the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1067.1">&gt;&gt;&gt;</span></span></span></span><span class="kobospan" id="kobo.1068.1"> prompt, Python will display the string in its canonical form. </span><span class="kobospan" id="kobo.1068.2">Python prefers to display strings with </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1069.1">’</span></span></span></span><span class="kobospan" id="kobo.1070.1"> as a delimiter, using </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1071.1">"</span></span></span></span><span class="kobospan" id="kobo.1072.1"> when the string contains a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1073.1">’</span></span></span></span><span class="kobospan" id="kobo.1074.1">. </span><span class="kobospan" id="kobo.1074.2">We can use either </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1075.1">’</span></span></span></span><span class="kobospan" id="kobo.1076.1"> or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1077.1">"</span></span></span></span><span class="kobospan" id="kobo.1078.1"> for a string delimiter when writing code. </span><span class="kobospan" id="kobo.1078.2">Python doesn’t generally display raw strings; instead, it puts all of the necessary escape sequences back into the string:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1079.1">&gt;&gt;&gt; r"\w+" 
 
’\\w+’</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1080.1">We provided a string</span><span id="dx1-55007"/><span class="kobospan" id="kobo.1081.1"> in raw form. </span><span class="kobospan" id="kobo.1081.2">Python displayed it in canonical form. </span><span id="x1-55008r99"/></p>
</section>
<section data-number="0.4.6.4" id="see-also-5">
<h2 class="likechapterhead" data-number="0.4.6.4"><span><span class="kobospan" id="kobo.1082.1">1.6.4 </span></span> <span id="x1-560004"/><span class="kobospan" id="kobo.1083.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.1084.1">In the </span><a href="ch005_split_001.xhtml#x1-570007" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1085.1">Encoding strings – creating ASCII and UTF-8 bytes</span></span></a><span class="kobospan" id="kobo.1086.1"> and the </span><a href="ch005_split_001.xhtml#x1-620008" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1087.1">Decoding bytes – how to get proper characters from some bytes</span></span></a><span class="kobospan" id="kobo.1088.1"> recipes, we’ll look at how Unicode characters are converted into sequences of bytes so we can write them to a file. </span><span class="kobospan" id="kobo.1088.2">We’ll look at how bytes from a file (or downloaded from a website) are turned into Unicode characters so they can be processed.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1089.1">If you’re interested in history, you can read</span><span id="dx1-56001"/><span class="kobospan" id="kobo.1090.1"> up on ASCII and EBCDIC and other old-fashioned character codes here: </span><a class="url" href="http://www.unicode.org/charts/"><span class="url1"><span class="kobospan" id="kobo.1091.1">http://www.unicode.org/charts/</span></span></a><span class="kobospan" id="kobo.1092.1">.</span></p></li>
</ul>
<p class="normal1"><span id="x1-56002r96"/></p>
</section>
</section>
<section data-number="0.4.7" id="encoding-strings-creating-ascii-and-utf-8-bytes">
<h1 class="unnumbered" data-number="0.4.7"><span><span class="kobospan" id="kobo.1093.1">1.7 </span></span> <span id="x1-570007"/><span class="kobospan" id="kobo.1094.1">Encoding strings – creating ASCII and UTF-8 bytes</span></h1>
<p class="normal"><span class="kobospan" id="kobo.1095.1">Our computer files are bytes. </span><span class="kobospan" id="kobo.1095.2">When we upload or download from</span><span id="dx1-57001"/><span class="kobospan" id="kobo.1096.1"> the internet, the communication works</span><span id="dx1-57002"/><span class="kobospan" id="kobo.1097.1"> in bytes. </span><span class="kobospan" id="kobo.1097.2">A byte only has 256 distinct values. </span><span class="kobospan" id="kobo.1097.3">Our Python characters are Unicode. </span><span class="kobospan" id="kobo.1097.4">There are a lot more than 256 Unicode characters.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1098.1">How do we map Unicode characters to bytes to write to a file or for transmission? </span><span id="x1-57003r101"/></p>
<section data-number="0.4.7.1" id="getting-ready-6">
<h2 class="likechapterhead" data-number="0.4.7.1"><span><span class="kobospan" id="kobo.1099.1">1.7.1 </span></span> <span id="x1-580001"/><span class="kobospan" id="kobo.1100.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1101.1">Historically, a character occupied 1 byte. </span><span class="kobospan" id="kobo.1101.2">Python leverages the old ASCII encoding scheme for bytes; this sometimes leads to confusion between bytes and text strings of Unicode characters.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1102.1">Unicode characters are encoded into sequences of bytes. </span><span class="kobospan" id="kobo.1102.2">There are a number of standardized encodings and a number of non-standard encodings.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1103.1">Plus, there also are some encodings that only work for a small subset of Unicode characters. </span><span class="kobospan" id="kobo.1103.2">We try to avoid these, but there are some situations where we’ll need to use a subset encoding scheme.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1104.1">Unless we have a really good reason not to, we almost always use UTF-8 encoding for Unicode characters. </span><span class="kobospan" id="kobo.1104.2">Its main advantage is that it’s a compact representation of the Latin alphabet, which is used for English and a number of European languages.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1105.1">Sometimes, an internet protocol requires ASCII characters. </span><span class="kobospan" id="kobo.1105.2">This is a special case that requires some care because the ASCII encoding can only handle a small subset of Unicode characters. </span><span id="x1-58001r103"/></p>
</section>
<section data-number="0.4.7.2" id="how-to-do-it...-6">
<h2 class="likechapterhead" data-number="0.4.7.2"><span><span class="kobospan" id="kobo.1106.1">1.7.2 </span></span> <span id="x1-590002"/><span class="kobospan" id="kobo.1107.1">How to do it...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1108.1">Python will generally use</span><span id="dx1-59001"/><span class="kobospan" id="kobo.1109.1"> our OS’s default encoding</span><span id="dx1-59002"/><span class="kobospan" id="kobo.1110.1"> for files and internet</span><span id="dx1-59003"/><span class="kobospan" id="kobo.1111.1"> traffic. </span><span class="kobospan" id="kobo.1111.2">The details are unique to each OS:</span></p>
<ol class="calibre4">
<li class="calibre7"><div id="x1-59005x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1112.1">We can make a general setting using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1113.1">PYTHONIOENCODING</span></span></span></span><span class="kobospan" id="kobo.1114.1"> environment variable. </span><span class="kobospan" id="kobo.1114.2">We set this outside of Python to ensure that a particular encoding is used everywhere. </span><span class="kobospan" id="kobo.1114.3">When using Linux or macOS, use the shell’s </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1115.1">export</span></span></span></span><span class="kobospan" id="kobo.1116.1"> statement to set the environment variable. </span><span class="kobospan" id="kobo.1116.2">For Windows, use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1117.1">set</span></span></span></span><span class="kobospan" id="kobo.1118.1"> command, or the PowerShell </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1119.1">Set-Item</span></span></span></span><span class="kobospan" id="kobo.1120.1"> cmdlet. </span><span class="kobospan" id="kobo.1120.2">For Linux, it looks like this:</span></p>
<pre class="programlisting" id="listing-10"><code class="calibre13"><span class="kobospan" id="kobo.1121.1">(cookbook3) % export PYTHONIOENCODING=UTF-8</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-59008x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1122.1">Run Python:</span></p>
<pre class="programlisting" id="listing-11"><code class="calibre13"><span class="kobospan" id="kobo.1123.1">(cookbook3) % python</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-59011x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1124.1">We sometimes need to make specific settings when we open a file inside our script. </span><span class="kobospan" id="kobo.1124.2">We’ll return to this topic in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1125.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1126.1"> </span></span><a href="ch015_split_000.xhtml#x1-61500011" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1127.1">11</span></span></a><span class="kobospan" id="kobo.1128.1">. </span><span class="kobospan" id="kobo.1128.2">Open the file with a given encoding. </span><span class="kobospan" id="kobo.1128.3">Read or write Unicode characters to the file:</span></p>
<pre class="programlisting" id="listing-12"><code class="calibre13"><span class="kobospan" id="kobo.1129.1">&gt;&gt;&gt; with open(’some_file.txt’, ’w’, encoding=’utf-8’) as output: 
 
... </span><span class="kobospan" id="kobo.1129.2">    print(’You drew \U0001F000’, file=output) 
 
&gt;&gt;&gt; with open(’some_file.txt’, ’r’, encoding=’utf-8’) as input: 
 
... </span><span class="kobospan" id="kobo.1129.3">    text = input.read() 
 
&gt;&gt;&gt; text 
 
’You drew ’</span></code></pre>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.1130.1">We can also manually encode characters, in the rare case that we need to open a file in bytes mode; if we use a mode of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1131.1">wb</span></span></span></span><span class="kobospan" id="kobo.1132.1">, we’ll also need to use manual encoding of each string:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1133.1">&gt;&gt;&gt; string_bytes = ’You drew \U0001F000’.encode(’utf-8’) 
 
&gt;&gt;&gt; string_bytes 
 
b’You drew \xf0\x9f\x80\x80’</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1134.1">We can see that a sequence of bytes (</span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1135.1">\xf0\x9f\x80\x80</span></span></span></span><span class="kobospan" id="kobo.1136.1">) was used to encode a single Unicode character, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1137.1">U+1F000</span></span></span></span><span class="kobospan" id="kobo.1138.1">, </span><span class="kobospan" id="kobo.1139.1"><img alt="PIC" src="../media/file11.png" class="calibre18"/></span><span class="kobospan" id="kobo.1140.1">. </span><span id="x1-59022r104"/></p>
</section>
<section data-number="0.4.7.3" id="how-it-works...-6">
<h2 class="likechapterhead" data-number="0.4.7.3"><span><span class="kobospan" id="kobo.1141.1">1.7.3 </span></span> <span id="x1-600003"/><span class="kobospan" id="kobo.1142.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1143.1">Unicode defines</span><span id="dx1-60001"/><span class="kobospan" id="kobo.1144.1"> a number of encoding</span><span id="dx1-60002"/><span class="kobospan" id="kobo.1145.1"> schemes. </span><span class="kobospan" id="kobo.1145.2">While UTF-8 is the most</span><span id="dx1-60003"/><span class="kobospan" id="kobo.1146.1"> popular, there is also UTF-16 and UTF-32. </span><span class="kobospan" id="kobo.1146.2">The number is the typical number of bits per character. </span><span class="kobospan" id="kobo.1146.3">A file with 1,000 characters encoded in UTF-32 would be 4,000 8-bit bytes. </span><span class="kobospan" id="kobo.1146.4">A file with 1,000 characters encoded in UTF-8 could be as few as 1,000 bytes, depending on the exact mix of characters. </span><span class="kobospan" id="kobo.1146.5">In UTF-8 encoding, characters with Unicode numbers above U+007F require multiple bytes.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1147.1">Various OSes have their own coding schemes. </span><span class="kobospan" id="kobo.1147.2">macOS files can be encoded in Mac Roman or Latin-1. </span><span class="kobospan" id="kobo.1147.3">Windows files might use CP1252 encoding.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1148.1">The point with all of these schemes is to have a sequence of bytes that can be mapped to a Unicode character and—going the other way—a way to map each Unicode character to one or more bytes. </span><span class="kobospan" id="kobo.1148.2">Ideally, all of the Unicode characters are accounted for. </span><span class="kobospan" id="kobo.1148.3">Pragmatically, some of these coding schemes are incomplete.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1149.1">The historical form of ASCII encoding can only represent about 100 of the Unicode characters as bytes. </span><span class="kobospan" id="kobo.1149.2">It’s easy to create a string that cannot be encoded using the ASCII scheme.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1150.1">Here’s what the error looks like:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1151.1">&gt;&gt;&gt; ’You drew \U0001F000’.encode(’ascii’) 
 
Traceback (most recent call last): 
 
... 
 
UnicodeEncodeError: ’ascii’ codec can’t encode character ’\U0001f000’ in position 9: ordinal not in range(128</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1152.1">We may see this kind of error when we accidentally open a file with an encoding that’s not the widely used standard of UTF-8. </span><span class="kobospan" id="kobo.1152.2">When we see this kind of error, we’ll need to change our processing to select the encoding actually used to create the file. </span><span class="kobospan" id="kobo.1152.3">It’s almost impossible to guess what encoding was used, so some research may be required to locate metadata about the file that states the encoding.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1153.1">Bytes are often displayed using printable characters. </span><span class="kobospan" id="kobo.1153.2">We’ll see </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1154.1">b’hello’</span></span></span></span><span class="kobospan" id="kobo.1155.1"> as shorthand for a five-byte value. </span><span class="kobospan" id="kobo.1155.2">The letters are chosen using the old ASCII encoding scheme, where byte values from 0x20 to 0x7F will be shown as characters, and outside this range, more complex-looking escapes will be used.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1156.1">This use of characters</span><span id="dx1-60009"/><span class="kobospan" id="kobo.1157.1"> to represent byte values</span><span id="dx1-60010"/><span class="kobospan" id="kobo.1158.1"> can be confusing. </span><span class="kobospan" id="kobo.1158.2">The prefix</span><span id="dx1-60011"/><span class="kobospan" id="kobo.1159.1"> of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1160.1">b’</span></span></span></span><span class="kobospan" id="kobo.1161.1"> is our hint that we’re looking at bytes, not proper Unicode characters. </span><span id="x1-60012r106"/></p>
</section>
<section data-number="0.4.7.4" id="see-also-6">
<h2 class="likechapterhead" data-number="0.4.7.4"><span><span class="kobospan" id="kobo.1162.1">1.7.4 </span></span> <span id="x1-610004"/><span class="kobospan" id="kobo.1163.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.1164.1">There are a number of ways to build strings of data. </span><span class="kobospan" id="kobo.1164.2">See the </span><a href="ch005_split_000.xhtml#x1-410004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1165.1">Building</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.1166.1">complicated strings with f-strings</span></span></a><span class="kobospan" id="kobo.1167.1"> and the </span><a href="ch005_split_000.xhtml#x1-470005" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1168.1">Building complicated strings</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.1169.1">from lists of strings</span></span></a><span class="kobospan" id="kobo.1170.1"> recipes for examples of creating complex strings. </span><span class="kobospan" id="kobo.1170.2">The idea is that we might have an application that builds a complex string, and then we encode it into bytes.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1171.1">For more information on UTF-8 encoding, see </span><a class="url" href="https://en.wikipedia.org/wiki/UTF-8"><span class="url1"><span class="kobospan" id="kobo.1172.1">https://en.wikipedia.org/wiki/UTF-8</span></span></a><span class="kobospan" id="kobo.1173.1">.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1174.1">For general information on Unicode encodings</span><span id="dx1-61001"/><span class="kobospan" id="kobo.1175.1">, see </span><a class="url" href="http://unicode.org/faq/utf_bom.html"><span class="url1"><span class="kobospan" id="kobo.1176.1">http://unicode.org/faq/utf_bom.html</span></span></a><span class="kobospan" id="kobo.1177.1">.</span></p></li>
</ul>
<p class="normal1"><span id="x1-61002r102"/></p>
</section>
</section>
<section data-number="0.4.8" id="decoding-bytes-how-to-get-proper-characters-from-some-bytes">
<h1 class="unnumbered" data-number="0.4.8"><span><span class="kobospan" id="kobo.1178.1">1.8 </span></span> <span id="x1-620008"/><span class="kobospan" id="kobo.1179.1">Decoding bytes – how to get proper characters from some bytes</span></h1>
<p class="normal"><span class="kobospan" id="kobo.1180.1">How can we work with files that aren’t properly</span><span id="dx1-62001"/><span class="kobospan" id="kobo.1181.1"> encoded? </span><span class="kobospan" id="kobo.1181.2">What do we do with files written in ASCII encoding?</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1182.1">A download from the internet is almost always in bytes—not characters. </span><span class="kobospan" id="kobo.1182.2">How do we decode the characters from that stream of bytes?</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1183.1">Also, when we use the subprocess module, the results of an OS command are in bytes. </span><span class="kobospan" id="kobo.1183.2">How can we recover proper characters?</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1184.1">Much of this is also relevant to the material in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1185.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1186.1"> </span></span><a href="ch015_split_000.xhtml#x1-61500011" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1187.1">11</span></span></a><span class="kobospan" id="kobo.1188.1">. </span><span class="kobospan" id="kobo.1188.2">We’ve included this recipe here because it’s the inverse of the previous recipe, </span><a href="ch005_split_001.xhtml#x1-570007" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1189.1">Encoding strings –</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.1190.1">creating ASCII and UTF-8 bytes</span></span></a><span class="kobospan" id="kobo.1191.1">. </span><span id="x1-62002r108"/></p>
<section data-number="0.4.8.1" id="getting-ready-7">
<h2 class="likechapterhead" data-number="0.4.8.1"><span><span class="kobospan" id="kobo.1192.1">1.8.1 </span></span> <span id="x1-630001"/><span class="kobospan" id="kobo.1193.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1194.1">Let’s say we’re interested in offshore marine weather forecasts. </span><span class="kobospan" id="kobo.1194.2">Perhaps this is because we are departing the </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.1195.1">Chesapeake Bay </span></span><span class="kobospan" id="kobo.1196.1">for the </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.1197.1">Caribbean</span></span><span class="kobospan" id="kobo.1198.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1199.1">Are there any special warnings coming from the </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.1200.1">National Weather Services</span></span><span class="kobospan" id="kobo.1201.1"> office in Wakefield, Virginia?</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1202.1">Here’s the</span><span id="dx1-63001"/><span class="kobospan" id="kobo.1203.1"> link: </span><a class="url" href="https://forecast.weather.gov/product.php?site=AKQ&amp;product=SMW&amp;issuedby=AKQ"><span class="url1"><span class="kobospan" id="kobo.1204.1">https://forecast.weather.gov/product.php?site=AKQ&amp;product=SMW&amp;issuedby=AKQ</span></span></a><span class="kobospan" id="kobo.1205.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1206.1">We can download this with Python’s </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1207.1">urllib</span></span></span></span><span class="kobospan" id="kobo.1208.1"> module:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1209.1">&gt;&gt;&gt; import urllib.request 
 
&gt;&gt;&gt; warnings_uri = ( 
 
... </span><span class="kobospan" id="kobo.1209.2">    ’https://forecast.weather.gov/’ 
 
... </span><span class="kobospan" id="kobo.1209.3">    ’product.php?site=AKQ&amp;product=SMW&amp;issuedby=AKQ’ 
 
... </span><span class="kobospan" id="kobo.1209.4">) 
 &gt;&gt;&gt; with urllib.request.urlopen(warnings_uri) as source: 
 
... </span><span class="kobospan" id="kobo.1209.5">    forecast_text = source.read()</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1210.1">Note that we’ve enclosed the URI string in </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1211.1">()</span></span></span></span><span class="kobospan" id="kobo.1212.1"> and broken it into two separate string literals. </span><span class="kobospan" id="kobo.1212.2">Python will concatenate these two adjacent literals into a single string. </span><span class="kobospan" id="kobo.1212.3">We’ll look at this in some depth in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1213.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1214.1"> </span></span><a href="ch006_split_000.xhtml#x1-840002" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1215.1">2</span></span></a><span class="kobospan" id="kobo.1216.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1217.1">As an alterative, we can use programs like </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1218.1">curl</span></span></span></span><span class="kobospan" id="kobo.1219.1"> or </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1220.1">wget</span></span></span></span><span class="kobospan" id="kobo.1221.1"> to get this. </span><span class="kobospan" id="kobo.1221.2">At the OS Terminal prompt, we might run the following (long) command:</span></p>
<pre class="programlisting" id="listing-13"><code class="calibre13"><span class="kobospan" id="kobo.1222.1">(cookbook3) % curl ’https://forecast.weather.gov/product.php?site=AKQ&amp;product=SMW&amp;issuedby=AKQ’ -o AKQ.html</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1223.1">Typesetting this book tends to break</span><span id="dx1-63012"/><span class="kobospan" id="kobo.1224.1"> the command onto many lines. </span><span class="kobospan" id="kobo.1224.2">It’s really one very long line.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1225.1">The code repository includes a sample file, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1226.1">ch01/Text</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1227.1"> Products</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1228.1"> for</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1229.1"> SMW</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1230.1"> Issued</span></span></span></span> <span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1231.1">by</span></span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1232.1"> AKQ.html</span></span></span></span><span class="kobospan" id="kobo.1233.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1234.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1235.1">forecast_text</span></span></span></span><span class="kobospan" id="kobo.1236.1"> value is a stream of bytes. </span><span class="kobospan" id="kobo.1236.2">It’s not a proper string. </span><span class="kobospan" id="kobo.1236.3">We can tell because it starts like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1237.1">&gt;&gt;&gt; forecast_text[:80] 
 
b’&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/x’</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1238.1">The data goes on for a while, providing details from the web page. </span><span class="kobospan" id="kobo.1238.2">Because the displayed value starts with </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1239.1">b’</span></span></span></span><span class="kobospan" id="kobo.1240.1">, it’s bytes, not proper Unicode characters. </span><span class="kobospan" id="kobo.1240.2">It was probably encoded with UTF-8, which means some characters could have weird-looking </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1241.1">\xnn</span></span></span></span><span class="kobospan" id="kobo.1242.1"> escape sequences instead of proper characters. </span><span class="kobospan" id="kobo.1242.2">We want to have the proper characters.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1243.1">While this data has many easy-to-read characters, the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1244.1">b’</span></span></span></span><span class="kobospan" id="kobo.1245.1"> prefix shows that it’s a collection of byte values, not proper text. </span><span class="kobospan" id="kobo.1245.2">Generally, a bytes object behaves somewhat like a string object. </span><span class="kobospan" id="kobo.1245.3">Sometimes, we can work with bytes directly. </span><span class="kobospan" id="kobo.1245.4">Most of the time, we’ll want to decode the bytes and create proper Unicode characters from them. </span><span id="x1-63016r110"/></p>
</section>
<section data-number="0.4.8.2" id="how-to-do-it...-7">
<h2 class="likechapterhead" data-number="0.4.8.2"><span><span class="kobospan" id="kobo.1246.1">1.8.2 </span></span> <span id="x1-640002"/><span class="kobospan" id="kobo.1247.1">How to do it...</span></h2>
<ol class="calibre2">
<li class="calibre7"><div id="x1-64002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1248.1">Determine the coding scheme if possible. </span><span class="kobospan" id="kobo.1248.2">In order to decode bytes to create proper Unicode characters, we need to know what encoding scheme was used. </span><span class="kobospan" id="kobo.1248.3">When we read XML documents, there’s a big hint provided within the document:</span></p>
<pre class="programlisting" id="listing-14"><code class="calibre13"><span class="kobospan" id="kobo.1249.1">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1250.1">When browsing web pages, there’s often a header containing this information:</span></p>
<pre class="programlisting" id="listing-15"><code class="calibre13"><span class="kobospan" id="kobo.1251.1">Content-Type: text/html; charset=ISO-8859-4</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1252.1">Sometimes, an HTML page may include this as part of the header:</span></p>
<pre class="programlisting" id="listing-16"><code class="calibre13"><span class="kobospan" id="kobo.1253.1">&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1254.1">In other cases, we’re left to guess. </span><span class="kobospan" id="kobo.1254.2">In the case of US weather</span><span id="dx1-64006"/><span class="kobospan" id="kobo.1255.1"> data, a good first guess is UTF-8. </span><span class="kobospan" id="kobo.1255.2">Another good guess is ISO-8859-1. </span><span class="kobospan" id="kobo.1255.3">In some cases, the guess will depend on the language.</span></p>
</div></li>
<li class="calibre7"><div id="x1-64008x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1256.1">The </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1257.1">codecs — Codec registry and base classes </span></span><span class="kobospan" id="kobo.1258.1">section of the </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1259.1">Python</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.1260.1">Standard Library </span></span><span class="kobospan" id="kobo.1261.1">lists the standard encodings available. </span><span class="kobospan" id="kobo.1261.2">Decode the data:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1262.1">&gt;&gt;&gt; document = forecast_text.decode("UTF-8") 
 
&gt;&gt;&gt; document[:80] 
 
’&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/x’</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1263.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1264.1">b’</span></span></span></span><span class="kobospan" id="kobo.1265.1"> prefix is no longer used to show that these are bytes. </span><span class="kobospan" id="kobo.1265.2">We’ve created a proper string of Unicode characters from the stream of bytes.</span></p>
</div></li>
<li class="calibre7"><div id="x1-64014x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1266.1">If this step fails with an exception, we guessed wrong about the encoding. </span><span class="kobospan" id="kobo.1266.2">We need to try another encoding in order to parse the resulting document.</span></p>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.1267.1">Since this is an HTML document, we should</span><span id="dx1-64015"/><span class="kobospan" id="kobo.1268.1"> use </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.1269.1">Beautiful Soup </span></span><span class="kobospan" id="kobo.1270.1">to extract the</span><span id="dx1-64016"/><span class="kobospan" id="kobo.1271.1"> data. </span><span class="kobospan" id="kobo.1271.2">See </span><a class="url" href="http://www.crummy.com/software/BeautifulSoup/"><span class="url1"><span class="kobospan" id="kobo.1272.1">http://www.crummy.com/software/BeautifulSoup/</span></span></a><span class="kobospan" id="kobo.1273.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1274.1">We can, however, extract one nugget of information from this document without completely parsing the HTML:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1275.1">&gt;&gt;&gt; import re 
 
&gt;&gt;&gt; content_pattern = re.compile(r"// CONTENT STARTS(.*?)// CONTENT ENDS", re.MULTILINE | re.DOTALL) 
 
&gt;&gt;&gt; content_pattern.search(document) 
 
&lt;re.Match object; span=(8530, 9113), match=’// CONTENT STARTS HERE --&gt;\n\n&lt;span style="font-s&gt;</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1276.1">This tells us what we need to know: there are no warnings at this time. </span><span class="kobospan" id="kobo.1276.2">This doesn’t mean smooth sailing, but it does mean that there aren’t any major weather systems that could cause catastrophes. </span><span id="x1-64022r113"/></p>
</section>
<section data-number="0.4.8.3" id="how-it-works...-7">
<h2 class="likechapterhead" data-number="0.4.8.3"><span><span class="kobospan" id="kobo.1277.1">1.8.3 </span></span> <span id="x1-650003"/><span class="kobospan" id="kobo.1278.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1279.1">See the </span><a href="ch005_split_001.xhtml#x1-570007" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1280.1">Encoding strings – creating ASCII and UTF-8 bytes</span></span></a><span class="kobospan" id="kobo.1281.1"> recipe</span><span id="dx1-65001"/><span class="kobospan" id="kobo.1282.1"> for more information on Unicode and the different ways that Unicode characters can be encoded into streams of bytes.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1283.1">At the foundation of the OS, files and network connections are built up from bytes. </span><span class="kobospan" id="kobo.1283.2">It’s our software that decodes the bytes to discover the content. </span><span class="kobospan" id="kobo.1283.3">It might be characters, images, or sounds. </span><span class="kobospan" id="kobo.1283.4">In some cases, the default assumptions are wrong and we need to do our own decoding. </span><span id="x1-65002r116"/></p>
</section>
<section data-number="0.4.8.4" id="see-also-7">
<h2 class="likechapterhead" data-number="0.4.8.4"><span><span class="kobospan" id="kobo.1284.1">1.8.4 </span></span> <span id="x1-660004"/><span class="kobospan" id="kobo.1285.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.1286.1">Once we’ve recovered the string data, we have a number of ways of parsing or rewriting it. </span><span class="kobospan" id="kobo.1286.2">See the </span><a href="ch005_split_000.xhtml#x1-350003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1287.1">String parsing with regular expressions</span></span></a><span class="kobospan" id="kobo.1288.1"> recipe for examples of parsing a complex string.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1289.1">For more information</span><span id="dx1-66001"/><span class="kobospan" id="kobo.1290.1"> on encodings, see </span><a class="url" href="https://en.wikipedia.org/wiki/UTF-8"><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1291.1">https://en.wikipedia.org/wiki/UTF-8</span></span></a><span class="kobospan" id="kobo.1292.1"> and </span><a class="url" href="http://unicode.org/faq/utf_bom.html"><span class="url1"><span class="kobospan" id="kobo.1293.1">http://unicode.org/faq/utf_bom.html</span></span></a><span class="kobospan" id="kobo.1294.1">.</span></p></li>
</ul>
<p class="normal1"><span id="x1-66002r109"/></p>
</section>
</section>
<section data-number="0.4.9" id="using-tuples-of-items">
<h1 class="unnumbered" data-number="0.4.9"><span><span class="kobospan" id="kobo.1295.1">1.9 </span></span> <span id="x1-670009"/><span class="kobospan" id="kobo.1296.1">Using tuples of items</span></h1>
<p class="normal"><span class="kobospan" id="kobo.1297.1">What’s the best way to represent</span><span id="dx1-67001"/><span class="kobospan" id="kobo.1298.1"> simple (</span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1299.1">x,y</span></span><span class="kobospan" id="kobo.1300.1">) and (</span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1301.1">r,g,b</span></span><span class="kobospan" id="kobo.1302.1">) groups of values? </span><span class="kobospan" id="kobo.1302.2">How can we keep things that are pairs, such as latitude and longitude, together? </span><span id="x1-67002r117"/></p>
<section data-number="0.4.9.1" id="getting-ready-8">
<h2 class="likechapterhead" data-number="0.4.9.1"><span><span class="kobospan" id="kobo.1303.1">1.9.1 </span></span> <span id="x1-680001"/><span class="kobospan" id="kobo.1304.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1305.1">In the </span><a href="ch005_split_000.xhtml#x1-350003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1306.1">String parsing with regular expressions</span></span></a><span class="kobospan" id="kobo.1307.1"> recipe, we skipped over an interesting data structure.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1308.1">We had data that looked like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1309.1">&gt;&gt;&gt; ingredient = "Kumquat: 2 cups"</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1310.1">We parsed this into meaningful data using a regular expression, like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1311.1">&gt;&gt;&gt; import re 
 
&gt;&gt;&gt; ingredient_pattern = re.compile(r’(?P&lt;ingredient&gt;\w+):\s+(?P&lt;amount&gt;\d+)\s+(?P&lt;unit&gt;\w+)’) 
 
&gt;&gt;&gt; match = ingredient_pattern.match(ingredient) 
 
&gt;&gt;&gt; match.groups() 
 
(’Kumquat’, ’2’, ’cups’)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1312.1">The result is a tuple object with three pieces of data. </span><span class="kobospan" id="kobo.1312.2">There are lots of places where this kind of grouped data can come in handy. </span><span id="x1-68009r119"/></p>
</section>
<section data-number="0.4.9.2" id="how-to-do-it...-8">
<h2 class="likechapterhead" data-number="0.4.9.2"><span><span class="kobospan" id="kobo.1313.1">1.9.2 </span></span> <span id="x1-690002"/><span class="kobospan" id="kobo.1314.1">How to do it...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1315.1">We’ll look at two aspects to this: putting things into tuples</span><span id="dx1-69001"/><span class="kobospan" id="kobo.1316.1"> and getting things out of tuples.</span></p>
<section data-number="0.4.9.2.1" id="creating-tuples">
<h3 class="likesubsubsectionhead" data-number="0.4.9.2.1"><span id="x1-700002"/><span class="kobospan" id="kobo.1317.1">Creating tuples</span></h3>
<p class="normal"><span class="kobospan" id="kobo.1318.1">There are lots of places where Python</span><span id="dx1-70001"/><span class="kobospan" id="kobo.1319.1"> creates tuples of data for us. </span><span class="kobospan" id="kobo.1319.2">In the </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1320.1">Getting</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.1321.1">ready </span></span><span class="kobospan" id="kobo.1322.1">section of the </span><a href="ch005_split_000.xhtml#x1-350003" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1323.1">String parsing with regular expressions</span></span></a><span class="kobospan" id="kobo.1324.1"> recipe, we showed you how a regular expression </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1325.1">match</span></span></span></span><span class="kobospan" id="kobo.1326.1"> object will create a tuple of text that was parsed from a string.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1327.1">We can create our own tuples, too. </span><span class="kobospan" id="kobo.1327.2">Here are the steps:</span></p>
<ol class="calibre4">
<li class="calibre7"><div id="x1-70003x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1328.1">Enclose the data in </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1329.1">()</span></span></span></span><span class="kobospan" id="kobo.1330.1">.</span></p>
</div></li>
<li class="calibre7"><div id="x1-70005x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1331.1">Separate the items with </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1332.1">,</span></span></span></span><span class="kobospan" id="kobo.1333.1">.</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1334.1">&gt;&gt;&gt; from fractions import Fraction 
 
&gt;&gt;&gt; my_data = (’Rice’, Fraction(1/4), ’cups’)</span></code></pre>
</div></li>
</ol>
<p class="normal1"><span class="kobospan" id="kobo.1335.1">There’s an important special case for the one-tuple, or singleton. </span><span class="kobospan" id="kobo.1335.2">We have to include the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1336.1">,</span></span></span></span><span class="kobospan" id="kobo.1337.1"> even when there’s only one item in the tuple:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1338.1">&gt;&gt;&gt; one_tuple = (’item’, ) 
 
&gt;&gt;&gt; len(one_tuple) 
 
1</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1339.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1340.1">()</span></span></span></span><span class="kobospan" id="kobo.1341.1"> characters aren’t always required. </span><span class="kobospan" id="kobo.1341.2">There are a few times where we can omit them. </span><span class="kobospan" id="kobo.1341.3">It’s not a good idea to omit them.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1342.1">It’s the comma that creates a tuple of values. </span><span class="kobospan" id="kobo.1342.2">This means we can see funny things when we have an extra comma:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1343.1">&gt;&gt;&gt; 355, 
 
(355,)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1344.1">The comma after 355 turns the value into a singleton tuple.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1345.1">We can also create a tuple by conversion</span><span id="dx1-70016"/><span class="kobospan" id="kobo.1346.1"> from another sequence. </span><span class="kobospan" id="kobo.1346.2">For example, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1347.1">tuple([355])</span></span></span></span><span class="kobospan" id="kobo.1348.1"> creates a singleton tuple from a singleton list.</span></p>
</section>
<section data-number="0.4.9.2.2" id="extracting-items-from-a-tuple">
<h3 class="likesubsubsectionhead" data-number="0.4.9.2.2"><span id="x1-710002"/><span class="kobospan" id="kobo.1349.1">Extracting items from a tuple</span></h3>
<p class="normal"><span class="kobospan" id="kobo.1350.1">The idea of a tuple is to be a container</span><span id="dx1-71001"/><span class="kobospan" id="kobo.1351.1"> with a number of items</span><span id="dx1-71002"/><span class="kobospan" id="kobo.1352.1"> that’s fixed by the problem domain: for example, for (red, green, blue) color numbers, the number of items is always three.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1353.1">In our example, we’ve got an ingredient, and amount, and</span><span id="dx1-71003"/><span class="kobospan" id="kobo.1354.1"> units. </span><span class="kobospan" id="kobo.1354.2">This must be a three-item collection. </span><span class="kobospan" id="kobo.1354.3">We can look at the individual items in two ways:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.1355.1">By index position; that is, positions are numbered starting with zero from the left:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1356.1">&gt;&gt;&gt; my_data[1] 
 
Fraction(1, 4)</span></code></pre></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1357.1">Using multiple assignment:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1358.1">&gt;&gt;&gt; ingredient, amount, unit =  my_data 
 
&gt;&gt;&gt; ingredient 
 
’Rice’ 
 
&gt;&gt;&gt; unit 
 
’cups’</span></code></pre></li>
</ul>
<p class="normal1"><span class="kobospan" id="kobo.1359.1">Tuples—like strings—are immutable. </span><span class="kobospan" id="kobo.1359.2">We can’t change</span><span id="dx1-71013"/><span class="kobospan" id="kobo.1360.1"> the individual items</span><span id="dx1-71014"/><span class="kobospan" id="kobo.1361.1"> inside a tuple. </span><span class="kobospan" id="kobo.1361.2">We use tuples when we want to keep the data together. </span><span id="x1-71015r122"/></p>
</section>
</section>
<section data-number="0.4.9.3" id="how-it-works...-8">
<h2 class="likechapterhead" data-number="0.4.9.3"><span><span class="kobospan" id="kobo.1362.1">1.9.3 </span></span> <span id="x1-720003"/><span class="kobospan" id="kobo.1363.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1364.1">Tuples are one example of the more general</span><span id="dx1-72001"/> <span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1365.1">Sequence</span></span></span></span><span class="kobospan" id="kobo.1366.1"> class. </span><span class="kobospan" id="kobo.1366.2">We can do a few things with sequences.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1367.1">Here’s an example tuple that we can work with:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1368.1">&gt;&gt;&gt; t = (’Kumquat’, ’2’, ’cups’)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1369.1">Here are some operations we can perform on this tuple:</span></p>
<ul class="calibre11">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.1370.1">How many items in </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1371.1">t</span></span></span></span><span class="kobospan" id="kobo.1372.1">?</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1373.1">&gt;&gt;&gt; len(t) 
 
3</span></code></pre></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1374.1">How many times does a particular value appear in </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1375.1">t</span></span></span></span><span class="kobospan" id="kobo.1376.1">?</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1377.1">&gt;&gt;&gt; t.count(’2’) 
 
1</span></code></pre></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1378.1">Which position has a particular value?</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1379.1">&gt;&gt;&gt; t.index(’cups’) 
 
2 
 
&gt;&gt;&gt; t[2] 
 
’cups’</span></code></pre></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1380.1">When an item doesn’t exist, we’ll get an exception:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1381.1">&gt;&gt;&gt; t.index(’Rice’) 
 
Traceback (most recent call last): 
 
... 
 
ValueError: tuple.index(x): x not in tuple</span></code></pre></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1382.1">Does a particular</span><span id="dx1-72020"/><span class="kobospan" id="kobo.1383.1"> value exist?</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1384.1">&gt;&gt;&gt; ’Rice’ in t 
 
False</span></code></pre></li>
</ul>
<p class="normal1"><span id="x1-72024r130"/></p>
</section>
<section data-number="0.4.9.4" id="theres-more...-3">
<h2 class="likechapterhead" data-number="0.4.9.4"><span><span class="kobospan" id="kobo.1385.1">1.9.4 </span></span> <span id="x1-730004"/><span class="kobospan" id="kobo.1386.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1387.1">A tuple, like a string, is a sequence of items. </span><span class="kobospan" id="kobo.1387.2">In the case of a string, it’s a sequence of characters. </span><span class="kobospan" id="kobo.1387.3">In the case of a tuple, it’s a sequence of many things. </span><span class="kobospan" id="kobo.1387.4">Because they’re both sequences, they have some common features. </span><span class="kobospan" id="kobo.1387.5">We’ve noted that we can pluck out individual items by their index position. </span><span class="kobospan" id="kobo.1387.6">We can use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1388.1">index()</span></span></span></span><span class="kobospan" id="kobo.1389.1"> method to locate the position of an item.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1390.1">The similarities end there. </span><span class="kobospan" id="kobo.1390.2">A string has many methods it can use to create a new string that’s a transformation of a string, plus methods to parse strings, plus methods to determine the content of the strings. </span><span class="kobospan" id="kobo.1390.3">A tuple doesn’t have any of these bonus features. </span><span class="kobospan" id="kobo.1390.4">It’s—perhaps—the simplest possible data structure. </span><span id="x1-73001r137"/></p>
</section>
<section data-number="0.4.9.5" id="see-also-8">
<h2 class="likechapterhead" data-number="0.4.9.5"><span><span class="kobospan" id="kobo.1391.1">1.9.5 </span></span> <span id="x1-740005"/><span class="kobospan" id="kobo.1392.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.1393.1">We looked at one other sequence, the list, in the </span><a href="ch005_split_000.xhtml#x1-470005" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1394.1">Building complicated</span></span> <span class="cmti-10x-x"><span class="kobospan" id="kobo.1395.1">strings from lists of strings</span></span></a><span class="kobospan" id="kobo.1396.1"> recipe.</span></p></li>
<li class="calibre7"><p class="normal2"><span class="kobospan" id="kobo.1397.1">We’ll also look at sequences in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1398.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1399.1"> </span></span><a href="ch008_split_000.xhtml#x1-2240004" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1400.1">4</span></span></a><span class="kobospan" id="kobo.1401.1">.</span></p></li>
</ul>
<p class="normal1"><span id="x1-74001r118"/></p>
</section>
</section>
<section data-number="0.4.10" id="using-namedtuples-to-simplify-item-access-in-tuples">
<h1 class="unnumbered" data-number="0.4.10"><span><span class="kobospan" id="kobo.1402.1">1.10 </span></span> <span id="x1-7500010"/><span class="kobospan" id="kobo.1403.1">Using NamedTuples to simplify item access in tuples</span></h1>
<p class="normal"><span class="kobospan" id="kobo.1404.1">When we worked with tuples, we had to remember</span><span id="dx1-75001"/><span class="kobospan" id="kobo.1405.1"> the positions</span><span id="dx1-75002"/><span class="kobospan" id="kobo.1406.1"> as numbers. </span><span class="kobospan" id="kobo.1406.2">When we use a (</span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1407.1">r,g,b</span></span><span class="kobospan" id="kobo.1408.1">) tuple to represent a color, can we use ”red” instead of zero, ”green” instead of 1, and ”blue” instead of 2? </span><span id="x1-75003r138"/></p>
<section data-number="0.4.10.1" id="getting-ready-9">
<h2 class="likechapterhead" data-number="0.4.10.1"><span><span class="kobospan" id="kobo.1409.1">1.10.1 </span></span> <span id="x1-760001"/><span class="kobospan" id="kobo.1410.1">Getting ready</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1411.1">Let’s continue looking at items in recipes. </span><span class="kobospan" id="kobo.1411.2">The regular expression for parsing the string had three attributes: </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1412.1">ingredient</span></span></span></span><span class="kobospan" id="kobo.1413.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1414.1">amount</span></span></span></span><span class="kobospan" id="kobo.1415.1">, and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1416.1">unit</span></span></span></span><span class="kobospan" id="kobo.1417.1">. </span><span class="kobospan" id="kobo.1417.2">We used the following pattern with names for the various substrings:</span></p>
<pre class="programlisting" id="listing-17"><code class="calibre13"><span class="kobospan" id="kobo.1418.1">r’(?P&lt;ingredient&gt;\w+):\s+(?P&lt;amount&gt;\d+)\s+(?P&lt;unit&gt;\w+)’)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1419.1">The resulting data</span><span id="dx1-76002"/><span class="kobospan" id="kobo.1420.1"> tuple looked</span><span id="dx1-76003"/><span class="kobospan" id="kobo.1421.1"> like this:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1422.1">&gt;&gt;&gt; item = match.groups() 
 
&gt;&gt;&gt; item 
 
(’Kumquat’, ’2’, ’cups’)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1423.1">While the matching between </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1424.1">ingredient</span></span></span></span><span class="kobospan" id="kobo.1425.1">, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1426.1">amount</span></span></span></span><span class="kobospan" id="kobo.1427.1">, and </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1428.1">unit</span></span></span></span><span class="kobospan" id="kobo.1429.1"> is pretty clear, using something like the following isn’t ideal. </span><span class="kobospan" id="kobo.1429.2">What does </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1430.1">1</span></span></span></span><span class="kobospan" id="kobo.1431.1"> mean? </span><span class="kobospan" id="kobo.1431.2">Is it really the quantity?</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1432.1">&gt;&gt;&gt; from fractions import Fraction 
 
&gt;&gt;&gt; Fraction(item[1]) 
 
Fraction(2, 1)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1433.1">We want to define tuples with names, as well as positions. </span><span id="x1-76012r140"/></p>
</section>
<section data-number="0.4.10.2" id="how-to-do-it...-9">
<h2 class="likechapterhead" data-number="0.4.10.2"><span><span class="kobospan" id="kobo.1434.1">1.10.2 </span></span> <span id="x1-770002"/><span class="kobospan" id="kobo.1435.1">How to do it...</span></h2>
<ol class="calibre2">
<li class="calibre7"><div id="x1-77002x1" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1436.1">We’ll use the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1437.1">NamedTuple</span></span></span></span><span class="kobospan" id="kobo.1438.1"> class definition from the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1439.1">typing</span></span></span></span><span class="kobospan" id="kobo.1440.1"> package:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1441.1">&gt;&gt;&gt; from typing import NamedTuple</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-77006x2" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1442.1">With this base class definition, we can define our own unique tuples, with names for the items:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1443.1">&gt;&gt;&gt; class Ingredient(NamedTuple): 
 
... </span><span class="kobospan" id="kobo.1443.2">    ingredient: str 
 
... </span><span class="kobospan" id="kobo.1443.3">    amount: str 
 
... </span><span class="kobospan" id="kobo.1443.4">    unit: str</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-77013x3" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1444.1">Now, we can create an instance of this unique kind of tuple by using the classname:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1445.1">&gt;&gt;&gt; item_2 = Ingredient(’Kumquat’, ’2’, ’cups’)</span></code></pre>
</div></li>
<li class="calibre7"><div id="x1-77017x4" class="calibre14">
<p class="normal2"><span class="kobospan" id="kobo.1446.1">When we want a value from the tuple, we can use a name instead of the position:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1447.1">&gt;&gt;&gt; Fraction(item_2.amount) 
 
Fraction(2, 1) 
 
&gt;&gt;&gt; f"Use {item_2.amount} {item_2.unit} fresh {item_2.ingredient}" 
 
’Use 2 cups fresh Kumquat’</span></code></pre>
</div></li>
</ol>
<p class="normal1"><span id="x1-77023r143"/></p>
</section>
<section data-number="0.4.10.3" id="how-it-works...-9">
<h2 class="likechapterhead" data-number="0.4.10.3"><span><span class="kobospan" id="kobo.1448.1">1.10.3 </span></span> <span id="x1-780003"/><span class="kobospan" id="kobo.1449.1">How it works...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1450.1">The </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1451.1">NamedTuple</span></span></span></span><span class="kobospan" id="kobo.1452.1"> class definition introduces a core concept from </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1453.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1454.1"> </span></span><a href="ch011_split_000.xhtml#x1-3760007" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1455.1">7</span></span></a><span class="kobospan" id="kobo.1456.1">. </span><span class="kobospan" id="kobo.1456.2">We’ve extended the base class definition to add unique features for our application. </span><span class="kobospan" id="kobo.1456.3">In this case, we’ve named the three attributes each </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1457.1">Ingredient</span></span></span></span><span class="kobospan" id="kobo.1458.1"> tuple must contain.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1459.1">Because a subclass of </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1460.1">NamedTuple</span></span></span></span><span class="kobospan" id="kobo.1461.1"> class is a tuple, the order of the attribute names is fixed. </span><span class="kobospan" id="kobo.1461.2">We can use a reference like the expression </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1462.1">item_2[0]</span></span></span></span><span class="kobospan" id="kobo.1463.1"> as well as the expression </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1464.1">item_2.ingredient</span></span></span></span><span class="kobospan" id="kobo.1465.1">. </span><span class="kobospan" id="kobo.1465.2">Both names refer to the item in index 0 of the tuple, </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1466.1">item_2</span></span></span></span><span class="kobospan" id="kobo.1467.1">.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1468.1">The core tuple types</span><span id="dx1-78001"/><span class="kobospan" id="kobo.1469.1"> can be</span><span id="dx1-78002"/><span class="kobospan" id="kobo.1470.1"> called ”anonymous tuples” or maybe ”index-only tuples.” </span><span class="kobospan" id="kobo.1470.2">This can help to distinguish them from the more sophisticated ”named tuples” introduced through the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1471.1">typing</span></span></span></span><span class="kobospan" id="kobo.1472.1"> module.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1473.1">Tuples are very useful as tiny containers of closely related data. </span><span class="kobospan" id="kobo.1473.2">Using the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1474.1">NamedTuple</span></span></span></span><span class="kobospan" id="kobo.1475.1"> class definition makes</span><span id="dx1-78003"/><span class="kobospan" id="kobo.1476.1"> them even easier</span><span id="dx1-78004"/><span class="kobospan" id="kobo.1477.1"> to work with. </span><span id="x1-78005r148"/></p>
</section>
<section data-number="0.4.10.4" id="theres-more...-4">
<h2 class="likechapterhead" data-number="0.4.10.4"><span><span class="kobospan" id="kobo.1478.1">1.10.4 </span></span> <span id="x1-790004"/><span class="kobospan" id="kobo.1479.1">There’s more...</span></h2>
<p class="normal"><span class="kobospan" id="kobo.1480.1">We can have a mixed collection of values in a tuple or a named tuple. </span><span class="kobospan" id="kobo.1480.2">We need to perform conversion before we can build the tuple. </span><span class="kobospan" id="kobo.1480.3">It’s important to remember that a tuple cannot ever be changed. </span><span class="kobospan" id="kobo.1480.4">It’s an immutable object, similar in many ways to the way strings and numbers are immutable.</span></p>
<p class="normal1"><span class="kobospan" id="kobo.1481.1">For example, we might want to work with amounts that are exact fractions. </span><span class="kobospan" id="kobo.1481.2">Here’s a more sophisticated definition:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1482.1">&gt;&gt;&gt; from typing import NamedTuple 
 
&gt;&gt;&gt; from fractions import Fraction 
 
&gt;&gt;&gt; class IngredientF(NamedTuple): 
 
... </span><span class="kobospan" id="kobo.1482.2">    ingredient: str 
 
... </span><span class="kobospan" id="kobo.1482.3">    amount: Fraction 
 
... </span><span class="kobospan" id="kobo.1482.4">    unit: str</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1483.1">These objects require some care to create. </span><span class="kobospan" id="kobo.1483.2">If we’re using a bunch of strings, we can’t simply build this object from three string values; we need to convert the amount into a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1484.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.1485.1"> instance. </span><span class="kobospan" id="kobo.1485.2">Here’s an example of creating an item using a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1486.1">Fraction</span></span></span></span><span class="kobospan" id="kobo.1487.1"> conversion:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1488.1">&gt;&gt;&gt; item_3 = IngredientF(’Kumquat’, Fraction(’2’), ’cups’)</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1489.1">This tuple has a more useful value for the amount of each ingredient. </span><span class="kobospan" id="kobo.1489.2">We can now do mathematical operations on the amounts:</span></p>
<pre class="programlisting"><code class="calibre13"><span class="kobospan" id="kobo.1490.1">&gt;&gt;&gt; f’{item_3.ingredient} doubled: {item_3.amount * 2}’ 
 
’Kumquat doubled: 4’</span></code></pre>
<p class="normal1"><span class="kobospan" id="kobo.1491.1">It’s very handy to explicitly state the data type within the </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1492.1">NamedTuple</span></span></span></span><span class="kobospan" id="kobo.1493.1"> class definition. </span><span class="kobospan" id="kobo.1493.2">It turns out Python doesn’t use the type information directly. </span><span class="kobospan" id="kobo.1493.3">Other tools, for example, </span><span class="cmbx-10x-x"><span class="kobospan" id="kobo.1494.1">mypy</span></span><span class="kobospan" id="kobo.1495.1">, can check the type hints</span><span id="dx1-79013"/><span class="kobospan" id="kobo.1496.1"> in a </span><span class="obeylines-h"><span><span class="cmtt-10x-x"><span class="kobospan" id="kobo.1497.1">NamedTuple</span></span></span></span><span class="kobospan" id="kobo.1498.1"> against the operations in the rest of the code to be sure they agree. </span><span id="x1-79014r149"/></p>
</section>
<section data-number="0.4.10.5" id="see-also-9">
<h2 class="likechapterhead" data-number="0.4.10.5"><span><span class="kobospan" id="kobo.1499.1">1.10.5 </span></span> <span id="x1-800005"/><span class="kobospan" id="kobo.1500.1">See also</span></h2>
<ul class="calibre16">
<li class="calibre12"><p class="normal2"><span class="kobospan" id="kobo.1501.1">We’ll look at class definitions in </span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1502.1">Chapter</span></span><span class="cmti-10x-x"><span class="kobospan" id="kobo.1503.1"> </span></span><a href="ch011_split_000.xhtml#x1-3760007" class="url"><span class="cmti-10x-x"><span class="kobospan" id="kobo.1504.1">7</span></span></a><span class="kobospan" id="kobo.1505.1">.</span></p></li>
</ul>
<p class="normal1"><span id="x1-80001r139"/></p>
</section>
</section>
<section data-number="0.4.13" id="join-our-community-discord-space-1">
<h1 class="unnumbered" data-number="0.4.13"><span id="x1-8300012"/><span class="kobospan" id="kobo.1506.1">Join our community Discord space</span></h1>
<p class="normal"><span class="kobospan" id="kobo.1507.1">Join our Python Discord workspace to discuss and find out more about the book: </span><a href="https://packt.link/dHrHU" class="url"><span class="url1"><span class="kobospan" id="kobo.1508.1">https://packt.link/dHrHU</span></span></a></p>
<p class="normal1"><span class="kobospan" id="kobo.1509.1"><img alt="PIC" src="../media/file1.png" class="calibre9"/></span> <span id="x1-83001r17"/></p>
</section>
</section>
</body></html>