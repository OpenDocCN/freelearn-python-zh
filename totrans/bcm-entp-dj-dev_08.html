<html><head></head><body>
		<div><h1 id="_idParaDest-169"><em class="italic"><a id="_idTextAnchor190"/>Chapter 6</em>: Exploring the Django Admin Site</h1>
			<p>This chapter will introduce the Django admin site, which is a feature allowing developers to register certain models into a model-centric interface where only permitted users can manage database content. This feature is designed to read the metadata related to models as well as the fields and field constraints set on those models to build a set of pages that search, sort, filter, create, edit, and delete records found in those tables.</p>
			<p>The admin site is an optional feature of the Django framework that can be used in projects. It allows us to use user-based roles and permission settings that are built into the Django framework, allowing only permitted users to edit, add, or delete objects. User roles can be modified to only grant permission to edit certain models and can even be set to a granular level, such as only letting a user edit or view data but not add or delete data. This feature can be deactivated if it is not desired or needed in a project.</p>
			<p>Models that are not specifically registered in the Django admin site will not be accessible via that interface, giving developers the option to create tables that store data that no users at all can control. By the end of this chapter, we will have registered the models that we created in <a href="B17243_03_ePub.xhtml#_idTextAnchor077"><em class="italic">Chapter 3</em></a>, <em class="italic">Models, Relations, and Inheritance</em>. Those models will serve as the foundation for most of the exercises provided throughout this chapter. </p>
			<p>In this chapter, we will cover the following topics:</p>
			<ul>
				<li>Using the Django admin site</li>
				<li>Configuring <code>admin</code> class options</li>
				<li>Adding <code>admin</code> class methods</li>
				<li>Writing custom <code>admin form classes</code></li>
				<li>Using the Django authentication system</li>
			</ul>
			<h1 id="_idParaDest-170"><a id="_idTextAnchor191"/>Technical requirements</h1>
			<p>To work with the code in this chapter, the following tools will need to be installed on your local machine:</p>
			<ul>
				<li>Python version 3.9 – used as the underlying programming language for the project</li>
				<li>Django version 4.0 – used as the backend framework of the project</li>
				<li>pip package manager – used to manage third-party Python/Django packages </li>
			</ul>
			<p>We will continue to work with the solution created in <a href="B17243_02_ePub.xhtml#_idTextAnchor037"><em class="italic">Chapter 2</em></a>, <em class="italic">Project Configuration</em>. However, it is not necessary to use the Visual Studio IDE. The main project itself can be run using another IDE or run independently using a terminal or command-line window from within the project root folder, which is where the <code>manage.py</code> file resides. Whatever editor or IDE you are using, a virtual environment will also be needed to work with the Django project. Instructions for how to create a project and virtual environment can be found in <a href="B17243_02_ePub.xhtml#_idTextAnchor037"><em class="italic">Chapter 2</em></a>, <em class="italic">Project Configuration</em>. You will need a database to store the data contained in your project. PostgreSQL was chosen for the examples in the previous chapter; however, any database type that you chose for your project can be used to work with the examples in this chapter.</p>
			<p>We will also be using data that is in the form of a Django fixture, provided previously in <a href="B17243_03_ePub.xhtml#_idTextAnchor077"><em class="italic">Chapter 3</em></a>, <em class="italic">Models, Relations, and Inheritance</em>, in the sub-section titled <em class="italic">Loading the chapter_3 data fixture</em>. Make sure the <code>chapter_3</code> fixture is loaded into your database. If this has already been done, then you may skip the next command. If you have already created the tables found in <a href="B17243_03_ePub.xhtml#_idTextAnchor077"><em class="italic">Chapter 3</em></a>, <em class="italic">Models, Relations, and Inheritance</em>, and have not loaded that fixture yet, then run the following command, after activating your virtual environment:</p>
			<pre>(virtual_env) PS &gt; python manage.py loaddata chapter_3</pre>
			<p>All of the code created in this chapter can be found in the GitHub repository for this book at <a href="https://github.com/PacktPublishing/Becoming-an-Enterprise-Django-Developer">https://github.com/PacktPublishing/Becoming-an-Enterprise-Django-Developer</a>. The bulk of the code depicted in this chapter can be found in the <code>/becoming_a_django_entdev/becoming_a_django_entdev/chapter_6/</code> directory.</p>
			<p>Check out the following video to see the <em class="italic">Code in Action</em>: <a href="https://bit.ly/3ODUaAW">https://bit.ly/3ODUaAW</a>.</p>
			<h2 id="_idParaDest-171"><a id="_idTextAnchor192"/>Preparing for this chapter</h2>
			<p>Start by creating a new app in your project called <code>chapter_6</code> by following the steps discussed in <a href="B17243_02_ePub.xhtml#_idTextAnchor037"><em class="italic">Chapter 2</em></a>, <em class="italic">Project Configuration</em>, in the subsection titled <em class="italic">Creating a Django app</em>. As discussed in that section, don't forget to change the value of your <code>name =</code> variable for your app class found in the <code>/becoming_a_django_entdev/becoming_a_django_entdev/chapter_6/apps.py</code> file to now point to the path where you installed your app. Be sure to also include this app in your <code>INSTALLED_APPS</code> variable found in the <code>settings.py</code> file as well.</p>
			<p>In the main <code>urls.py</code> file of the site, add the following path, which points to the URL patterns of this chapter that we will be creating:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/urls.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">urlpatterns = [</pre>
			<pre class="source-code">    <strong class="bold">path('', include('becoming_a_django_entdev.chapter_6.urls'))</strong>,</pre>
			<pre class="source-code">]</pre>
			<p>Now that we have created the app for this chapter, let's begin using the Django admin site to manage the models created in <a href="B17243_03_ePub.xhtml#_idTextAnchor077"><em class="italic">Chapter 3</em></a>, <em class="italic">Models, Relations, and Inheritance</em>.</p>
			<h1 id="_idParaDest-172"><a id="_idTextAnchor193"/>Using the Django admin site</h1>
			<p>Django makes it easy to <a id="_idIndexMarker846"/>use the admin site right out of the box. In order to use this feature, we need to add an app to the <code>settings.py</code> file and register a URL pattern to handle any project's admin links. By default, these settings should already exist in the code when a project is created using the <code>startproject</code> command or by using the IDE. However, some tools and versions may generate code slightly differently and so it is always good to just double-check that these settings are configured in this way.</p>
			<h2 id="_idParaDest-173"><a id="_idTextAnchor194"/>Activating the Django admin site</h2>
			<p>To make sure the Django admin site is <a id="_idIndexMarker847"/>activated in your project, follow these steps:</p>
			<ol>
				<li>In the main <code>settings.py</code> file, add the following app to the <code>INSTALLED_APPS</code> variable and make sure this is at the top of the list:<pre><strong class="bold"># /becoming_a_django_entdev/settings.py</strong>
...
INSTALLED_APPS = [
    <strong class="bold">'django.contrib.admin'</strong>,
    ...
]</pre></li>
				<li>If the <code>/chapter_6/urls.py</code> file does not exist yet, create that file and include the following URL pattern:<pre><strong class="bold"># /becoming_a_django_entdev/chapter_6/urls.py</strong>
...
from django.contrib 
import admin
urlpatterns = [
    <strong class="bold">path('admin/', admin.site.urls),</strong>
]</pre></li>
			</ol>
			<p>To deactivate the Django admin site, remove the settings described in this section. Template and static files related to the Django admin site can also be overridden to create your own look and feel. You are not restricted to the user interface that is provided right out of the box. Due to the limited space in this book, we will not demonstrate how to override Django admin site templates; however, you can refer to <a href="B17243_04_ePub.xhtml#_idTextAnchor116"><em class="italic">Chapter 4</em></a>, <em class="italic">URLs, Views, and Templates</em>, to learn more about overriding third-party templates.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Because Django is designed to do all of the heavy lifting, this is the only URL pattern that we need to create in order to activate all <a id="_idIndexMarker848"/>URL patterns related to the Django admin site.</p>
			<h2 id="_idParaDest-174"><a id="_idTextAnchor195"/>Logging into the Django admin site</h2>
			<p>The Django admin site should now be <a id="_idIndexMarker849"/>active and if we navigate to the URL <code>http://localhost:8000/admin/</code>, we should see<a id="_idIndexMarker850"/> the standard Django admin login screen, as depicted in the following screenshot:</p>
			<div><div><img src="img/Figure_6.01_B17243.jpg" alt="Figure 6.1 – Django admin site login&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.1 – Django admin site login</p>
			<p>Use the username and password that were provided when the <code>createsuperuser</code> command was executed in <a href="B17243_02_ePub.xhtml#_idTextAnchor037"><em class="italic">Chapter 2</em></a>, <em class="italic">Project Configuration</em>. You can log in with those superuser credentials or, if you wish to use the superuser provided with the <code>chapter_3</code> data fixture, then use the following credentials instead:</p>
			<ul>
				<li><code>admin</code></li>
				<li><code>mynewpassword</code></li>
			</ul>
			<p>Once you are logged in, you should see two main sections, titled <strong class="bold">AUTHENTICATION AND AUTHORIZATION</strong> and <strong class="bold">CHAPTER_3</strong>, and to the right, a <strong class="bold">Recent actions</strong> side-nav section is displayed on your dashboard, as depicted in the following screenshot:</p>
			<div><div><img src="img/Figure_6.02_B17243.jpg" alt="Figure 6.2 – Django admin site dashboard&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.2 – Django admin site dashboard</p>
			<p>If you installed the <code>django-address</code> package in <a href="B17243_03_ePub.xhtml#_idTextAnchor077"><em class="italic">Chapter 3</em></a>, <em class="italic">Models, Relations, and Inheritance</em>, you will see an additional <code>address</code> app in the <code>INSTALLED_APPS</code> variable of the <code>settings.py</code> file, then that section would not appear within the admin dashboard. </p>
			<p>The <strong class="bold">Recent actions</strong> panel shows us information that tracks when a user created, changed, or deleted a particular object that is registered in the admin site when any of those actions is performed. </p>
			<p>In the section titled <code>User</code> model in <a href="B17243_03_ePub.xhtml#_idTextAnchor077"><em class="italic">Chapter 3</em></a>, <em class="italic">Models, Relations, and Inheritance</em>, using the <code>AUTH_USER_MODEL</code> variable in the <code>settings.py</code> file to point to the custom <code>Seller</code> class that we created, we will have to register the <code>Seller</code> model in the admin site in order for it to appear. </p>
			<p>Next, let's register that <code>Seller</code> model to get it to appear on the dashboard. </p>
			<h2 id="_idParaDest-175"><a id="_idTextAnchor196"/>Writing admin classes</h2>
			<p>Here, we will discuss writing a <a id="_idIndexMarker852"/>standard <code>ModelAdmin</code> class found in the <code>django.contrib.admin</code> library. We will also provide an example using the <code>UserAdmin</code> class, because we extended the <code>User</code> model in <a href="B17243_03_ePub.xhtml#_idTextAnchor077"><em class="italic">Chapter 3</em></a>, <em class="italic">Models, Relations, and Inheritance</em>.</p>
			<h3>Class – ModelAdmin</h3>
			<p><code>ModelAdmin</code> is the class provided by Django that does all the heavy lifting for us, in regard to models that are not <a id="_idIndexMarker853"/>user based. Before a model can be registered, an admin class using the <code>ModelAdmin</code> class will need to be created in order to link a model to the admin interface.</p>
			<p>In the <code>/chapter_6/admin.py</code> file, include the following code:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">from django.contrib.admin </pre>
			<pre class="source-code">import <strong class="bold">ModelAdmin</strong></pre>
			<pre class="source-code"><strong class="bold">class SellerAdmin(ModelAdmin):</strong></pre>
			<pre class="source-code">    pass</pre>
			<p>In the preceding code, the <code>SellerAdmin</code> class is constructed using the Django <code>contrib</code> class called <code>ModelAdmin</code>. Django makes it easy for us by doing a lot of the heavy lifting. Django will automatically configure everything that we do not specify in this class, such as the options we will discuss soon in this chapter. This means if we include the <code>pass</code> statement in this class, we will not have to write anything else and Django will create the admin site for that model based on default parameters. Go ahead and write this class another three times for the remaining vehicle model objects, including the <code>pass</code> statement for each class as you write them. Name these classes <code>VehicleAdmin</code>, <code>VehicleModelAdmin</code>, and <code>EngineAdmin</code>. </p>
			<p class="callout-heading">Note </p>
			<p class="callout">Each of the class names ends with the word <code>Admin</code>. Follow the naming convention of <code>ModelNameAdmin</code> when naming future admin classes of your own.</p>
			<h3>Class – UserAdmin</h3>
			<p><code>UserAdmin</code> is a special class provided by Django that lets us link a user-based model to the admin interface. The <code>UserAdmin</code> class is an<a id="_idIndexMarker854"/> extension of the <code>ModelAdmin</code> class. Next, we will create the <code>SellerAdmin</code> class, which will import all of the functionality available in the Django <code>UserAdmin</code> class. We will write the admin class the exact same way as we did in the previous exercise with the <code>pass</code> statement. All of the other vehicle-related admin classes will continue to use the standard <code>ModelAdmin</code> class. </p>
			<p>The following code shows us how the <code>SellerAdmin</code> class should look now:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">from django.contrib.auth.admin </pre>
			<pre class="source-code">import <strong class="bold">UserAdmin</strong></pre>
			<pre class="source-code">class SellerAdmin(<strong class="bold">UserAdmin</strong>):</pre>
			<pre class="source-code">    pass</pre>
			<p>Now that we have written the <a id="_idIndexMarker855"/>admin classes, let's register them next.</p>
			<h2 id="_idParaDest-176"><a id="_idTextAnchor197"/>Registering models</h2>
			<p>We need to write a register <a id="_idIndexMarker856"/>statement that will link an admin class to its corresponding model and automatically create the URL patterns that will pertain<a id="_idIndexMarker857"/> to that model. There are two ways to do this and they both do the exact same thing: </p>
			<ul>
				<li>The first is with a single statement that is written at the bottom of the document, placed right after any admin classes that have been written. </li>
				<li>The second is to wrap each admin class in a register decorator function. </li>
			</ul>
			<p>Both will be demonstrated in the following examples but choose only the one that you like the most. Implementing both at the same time may cause errors.</p>
			<h3>Using a statement</h3>
			<p>Using a statement is easy; first we <a id="_idIndexMarker858"/>write the admin classes and then, at the bottom of the same <code>admin.py</code> file, write the register statement just like we have done for <code>Seller</code> in the following code block:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">from django.contrib </pre>
			<pre class="source-code">import admin</pre>
			<pre class="source-code">from django.contrib.auth.admin </pre>
			<pre class="source-code">import UserAdmin</pre>
			<pre class="source-code">from ..chapter_3.models </pre>
			<pre class="source-code">import <strong class="bold">Seller</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    pass</pre>
			<pre class="source-code"><strong class="bold">admin.site.register(Seller, SellerAdmin)</strong></pre>
			<p>Here, we use the <code>admin.site.register(Model, ModelAdmin)</code> statement to register the admin classes. Write three <a id="_idIndexMarker859"/>more statements to register the <code>Vehicle</code>, <code>VehicleModel</code>, and <code>Engine</code> model classes to their corresponding admin classes.</p>
			<h3>Using a decorator</h3>
			<p>Using a decorator<a id="_idIndexMarker860"/> works just like when we used the <code>@property</code> model method decorator introduced in <a href="B17243_03_ePub.xhtml#_idTextAnchor077"><em class="italic">Chapter 3</em></a>, <em class="italic">Models, Relations, and Inheritance</em>. Decorators wrap classes, written on the line before the class is declared, as is done on the <code>SellerAdmin</code> class here:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">from django.contrib </pre>
			<pre class="source-code">import admin</pre>
			<pre class="source-code">from ..chapter_3.models import (</pre>
			<pre class="source-code">    <strong class="bold">Engine</strong>,</pre>
			<pre class="source-code">    <strong class="bold">Seller</strong>,</pre>
			<pre class="source-code">    <strong class="bold">Vehicle</strong>,</pre>
			<pre class="source-code">    <strong class="bold">VehicleModel</strong></pre>
			<pre class="source-code">)</pre>
			<pre class="source-code">@admin.register(<strong class="bold">Seller</strong>)</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    pass</pre>
			<p>Here, we are using the <code>@admin.register(Model)</code> decorator provided by Django. When used this way, this function takes in only one positional argument and that is the name of the model class we wish to link to that admin class. The admin class is derived from the class name that the <a id="_idIndexMarker861"/>decorator is being used on, in this case, the <code>SellerAdmin</code> class. Add this decorator to the three remaining admin classes and adjust the related model accordingly for each decorator.</p>
			<p>Now that we have these models registered, when accessing the Django admin dashboard, you should now see a fourth section titled <strong class="bold">CHAPTER_3</strong> containing four items, as shown in the following screenshot:</p>
			<div><div><img src="img/Figure_6.03_B17243.jpg" alt="Figure 6.3 – Django – registering models&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.3 – Django – registering models</p>
			<p>Clicking any one of these will take you to <a id="_idIndexMarker862"/>what is called a <strong class="bold">changelist view</strong>, where a list or collection of all those objects is displayed. Clicking on any of those items would then take you to <a id="_idIndexMarker863"/>what is called a <strong class="bold">change view</strong>. Clicking on the <strong class="bold">Add</strong> button found on the changelist view page will take the user to what is called an <strong class="bold">add view</strong>, which is a form that <a id="_idIndexMarker864"/>creates a new instance of that model rather than editing an existing one. Similarly, deleting an object will take the user to what is<a id="_idIndexMarker865"/> called a <strong class="bold">delete view</strong> page for that object. Similar to how models and forms are each controlled using the fields and methods written in those classes, we can control admin classes the same way by defining certain variables <a id="_idIndexMarker866"/>known as options and custom methods. Let's discuss what those options are next.</p>
			<h1 id="_idParaDest-177"><a id="_idTextAnchor198"/>Configuring admin class options</h1>
			<p>Django provides admin class options<a id="_idIndexMarker867"/> for customizing the Django admin site interface directly. In this section, we will go through some of the most important and widely used options and provide examples of how to use them. We don't have enough room to discuss them all in great detail. </p>
			<p>For a complete breakdown of how to use any of the options available, visit the official Django documentation, found here: <a href="https://docs.djangoproject.com/en/4.0/ref/contrib/admin/#modeladmin-options">https://docs.djangoproject.com/en/4.0/ref/contrib/admin/#modeladmin-options</a>. </p>
			<p>The following options have been broken down into categories based on what view type they relate to (changelist view, change or add view, and just the add view).</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Before adding any of the options to your admin classes, remember to remove the <code>pass</code> statement that was previously written for that class as a placeholder.</p>
			<h2 id="_idParaDest-178"><a id="_idTextAnchor199"/>Changelist view-related options</h2>
			<p>These options relate to an <a id="_idIndexMarker868"/>admin class on the changelist view<a id="_idIndexMarker869"/> page, such as those listed here:</p>
			<ul>
				<li><code>http://localhost:8000/admin/chapter_3/engine/</code>  </li>
				<li><code>http://localhost:8000/admin/chapter_3/seller/</code></li>
				<li><code>http://localhost:8000/admin/chapter_3/vehicle_model/</code></li>
				<li><code>http://localhost:8000/admin/chapter_3/vehicle/</code></li>
			</ul>
			<h3>Option – actions</h3>
			<p>The <code>actions</code> option relates to the checkbox that is <a id="_idIndexMarker870"/>found to the left of every item on a changelist view page. By default, Django automatically provides at least one action for every model that is created and registered; that action is the delete action. For example, navigate to the <code>Sellers</code> changelist view page at <code>http://localhost:8000/admin/chapter_3/seller/</code>, select the dropdown next to the <strong class="bold">Action</strong> label, and you will see only one option, the delete option, as shown in the following screenshot:</p>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_6.04_B17243.jpg" alt="Figure 6.4 – Django – actions admin option&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.4 – Django – actions admin option</p>
			<p>If we had 20 sellers in this list, we could delete all 20 of them at once by using this action, instead of having to do a lot of needless clicking around. Additional actions can be created for custom use. An example of where this can be used is if you have a set of pages, which can have a published or unpublished state, stored in a field within your table. A custom action could be created that can publish or unpublish all of the selected objects. </p>
			<p>We won't be creating a custom action in these exercises because it would be a complicated task to discuss and goes beyond the scope of this book. Additionally, some of the actions that you might be thinking of, such as editing a field, can also be done using the <code>list_editable</code> option, which we will be discussing in the <em class="italic">Option – list_editable section</em>. </p>
			<p>Django provides full documentation on how to create custom actions here: <a href="https://docs.djangoproject.com/en/4.0/ref/contrib/admin/actions/">https://docs.djangoproject.com/en/4.0/ref/contrib/admin/actions/</a>.</p>
			<h3>Option – actions_on_bottom</h3>
			<p>The <code>actions_on_bottom</code> option is used to display the <code>False</code>. If set to <code>True</code>, as is done to the <code>SellerAdmin</code> class in the following example, the <strong class="bold">Action</strong> dropdown will appear <a id="_idIndexMarker871"/>below the changelist results:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    <strong class="bold">actions_on_bottom = True</strong></pre>
			<h3>Option – actions_on_top</h3>
			<p>Similar to the <code>actions_on_bottom</code> option, the <code>actions_on_top</code> option will display the <code>True</code>. We only need to write this if we wish to disable it above the changelist, but we can set it to <code>True</code> in the <code>SellerAdmin</code> class using the following example without triggering errors as well:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    <strong class="bold">actions_on_top = True</strong></pre>
			<p>If both this option and the <code>actions_on_bottom</code> option are set to <code>True</code>, the <strong class="bold">Action</strong> dropdown will appear both above and below the changelist results.</p>
			<h3>Option – actions_selection_counter</h3>
			<p>The <code>actions_selection_counter</code> relates to the <a id="_idIndexMarker873"/>counter displayed to the right of the <strong class="bold">Action</strong> drop-down box. This option controls whether or not it should appear next to <strong class="bold">Action</strong>, as depicted in the following screenshot:</p>
			<div><div><img src="img/Figure_6.05_B17243.jpg" alt="Figure 6.5 – Django – actions_selection_counter admin option&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.5 – Django – actions_selection_counter admin option</p>
			<p>By default, Django will set this value to <code>True</code>. There is no need to write this option unless you want to disable this feature by setting its value to <code>False</code>. However, there is no harm in including this option <a id="_idIndexMarker874"/>with a value of <code>True</code>, as is done in the following example:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    <strong class="bold">actions_selection_counter = True</strong></pre>
			<h3>Option – list_display</h3>
			<p>The <code>list_display</code> option is used to<a id="_idIndexMarker875"/> show vertical columns on the changelist view page of a model. For example, navigate to the URL <code>http://localhost:8000/admin/chapter_3/seller/</code> and you'll see that the five columns that currently exist are <code>username</code>, <code>email</code>, <code>first_name</code>, <code>last_name</code>, and <code>is_staff</code>. Django will display the value of each field for each row that exists in that table. </p>
			<p>If we want to adjust this list to display the custom fields that we added to the <code>Seller</code> model that do not exist in the <code>User</code> model, such as the <code>SellerAdmin</code> class would look as in the following example:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    <strong class="bold">list_display</strong> = (</pre>
			<pre class="source-code">        'username',</pre>
			<pre class="source-code">        'email',</pre>
			<pre class="source-code">        'first_name',</pre>
			<pre class="source-code">        'last_name',</pre>
			<pre class="source-code">        <strong class="bold">'name',</strong></pre>
			<pre class="source-code">        'is_staff',</pre>
			<pre class="source-code">        <strong class="bold">'is_superuser',</strong></pre>
			<pre class="source-code">    )</pre>
			<p>The five columns that existed before were already defined in the <code>list_display</code> option found in the <code>UserAdmin</code> class, which was used to construct the <code>SellerAdmin</code> class. Navigate back to the same URL at <code>http://localhost:8000/admin/chapter_3/seller/</code> and you should now see the <strong class="bold">Business Name</strong> column third from last on the page and the <strong class="bold">Superuser Status</strong> column as the last column on the page because that is how they are positioned in the preceding list.</p>
			<p>The <code>list_display</code> option can also be used in the form of a callable function, allowing you to write a method <a id="_idIndexMarker876"/>within that admin class to format the data displayed in that column. Just add the name of the custom method to this list just like any other field name when using a callable for this option.</p>
			<h3>Option – list_display_links</h3>
			<p>The <code>list_display_links</code> option is <a id="_idIndexMarker877"/>used to control which columns in the changelist results will navigate the user to the change view page of that object when clicked. By default, Django will make only the first column in this list clickable. If you want to make other columns editable, use this option. </p>
			<p>On the <code>SellerAdmin</code> class, add the option as follows:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    list_display_links = (</pre>
			<pre class="source-code">        <strong class="bold">'username'</strong>,</pre>
			<pre class="source-code">        <strong class="bold">'name'</strong>,</pre>
			<pre class="source-code">    )</pre>
			<p>When using the <code>list_display_links</code> option, the <code>list_display</code> option must also be used. Only fields added to the <code>list_display</code> option can be added to this option. Also, if the <code>list_display_links</code> option is defined, Django will no longer make the first column clickable. For example, if we want to keep the first column clickable, that is, the <code>username</code> and <code>name</code> fields in this option. Also, they must be in the order in which they appear in the <code>list_display</code> option. </p>
			<p class="callout-heading">Note</p>
			<p class="callout">If you are using the <code>list_editable</code> option, which we are about to discuss, those fields cannot be used in the <code>list_display_links</code> option, such as the <code>first_name</code> and <code>last_name</code> fields, which we will reserve for the <code>list_editable</code> example next.</p>
			<h3>Option – list_editable</h3>
			<p>The <code>list_editable</code> option is an option that allows us to specify what fields on the changelist view page will be editable from<a id="_idIndexMarker879"/> that page. This prevents the need to open up the change view for that particular object just to edit a single field. Additionally, only fields found in the <code>list_display</code> option can be included in the <code>list_editable</code> option. This is because the column must exist before we can edit it.</p>
			<p>For example, if we want to make the <code>first_name</code> and <code>last_name</code> fields editable on the changelist view page, the <code>SellerAdmin</code> class would be written as follows:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">from django.contrib.auth.admin </pre>
			<pre class="source-code">import UserAdmin</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    <strong class="bold">list_editable = (</strong></pre>
			<pre class="source-code">        <strong class="bold">'first_name',</strong></pre>
			<pre class="source-code">        <strong class="bold">'last_name',</strong></pre>
			<pre class="source-code">    <strong class="bold">)</strong></pre>
			<p>Now, navigate to the changelist view found at <code>http://localhost:8000/admin/chapter_3/seller/</code>. We can see the <code>first_name</code> and <code>last_name</code> fields now appear as an input <a id="_idIndexMarker880"/>box with a save button at the bottom of that list, as depicted in the following screenshot:</p>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_6.06_B17243.jpg" alt="Figure 6.6 – Django – list_editable admin option&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.6 – Django – list_editable admin option</p>
			<h3>Option – list_filter</h3>
			<p>The <code>list_filter</code> option is a powerful<a id="_idIndexMarker881"/> tool that creates a box with a label titled <strong class="bold">Filter</strong> just to the right of the results on a changelist view page. The fields that are added to this option will tell Django to create a filter with a set of related choices derived from the values found in that QuerySet of results.</p>
			<p>For example, if we want to override the default <code>list_filter</code> option that is found in the <code>UserAdmin</code> class and add the <code>Seller</code> model field called <code>name</code> as a filter, then we would write the <code>SellerAdmin</code> class as in the<a id="_idIndexMarker882"/> following example:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    <strong class="bold">list_filter</strong> = (</pre>
			<pre class="source-code">        'is_staff',</pre>
			<pre class="source-code">        'is_superuser',</pre>
			<pre class="source-code">        'is_active',</pre>
			<pre class="source-code">        <strong class="bold">'name',</strong></pre>
			<pre class="source-code">        'groups'</pre>
			<pre class="source-code">    )</pre>
			<p>In the previous example, we just copied the <code>list_filter</code> option found in the <code>UserAdmin</code> class, located in the <code>django.contrib.auth.admin</code> library of Django. Then, we just modified that value to the desired value. </p>
			<p>Now when we navigate back to the URL <code>http://localhost:8000/admin/chapter_3/seller/</code>, we see the <strong class="bold">By Business Name</strong> filter, as depicted in the following screenshot:</p>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_6.07_B17243.jpg" alt="Figure 6.7 – Django – list_filter admin option&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.7 – Django – list_filter admin option</p>
			<h3>Option – list_per_page</h3>
			<p>The <code>list_per_page</code> option designates the number of items that we want to appear on a changelist view page. By default, Django will set this value to <code>100</code>. This can sometimes be too much for a <a id="_idIndexMarker883"/>user and so let's go ahead and practice setting this to a much more friendly number of, say, <code>20</code> on the <code>SellerAdmin</code> class by using the following example:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    <strong class="bold">list_per_page = 20</strong></pre>
			<p>If you add more than 20 items to your tables, you will see a set of pagination buttons appear at the bottom of your changelist view page. When there are fewer than 20 items in total, no pagination buttons will appear since there is only one page of results.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">If you are using a third-party package or custom class instead of the default <code>django.core.paginator.Paginator</code> class used in Django, you can implement that custom paginator class by using the <code>paginator</code> admin option. Instructions on how this is done can be found here: <a href="https://docs.djangoproject.com/en/4.0/ref/contrib/admin/#django.contrib.admin.ModelAdmin.paginator/">https://docs.djangoproject.com/en/4.0/ref/contrib/admin/#django.contrib.admin.ModelAdmin.paginator/</a>. </p>
			<h3>Option – ordering</h3>
			<p>The <code>ordering</code> option is done the same<a id="_idIndexMarker884"/> way as the <code>ordering</code> option in a model <code>Meta</code> class. This option accepts a list of fields that are ordered by the field specified when the page first loads.</p>
			<p>For example, the default ordering option in the <code>UserAdmin</code> class is set to order by <code>username</code> in ascending order. Go ahead and add that to the <code>SellerAdmin</code> class by using the following example:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    <strong class="bold">ordering = ('username',)</strong></pre>
			<p>Here, we can add the subtract symbol, such as in <code>('-username',)</code>, to make it order in descending order, just like the model <code>Meta</code> class <code>ordering</code> option. Multiple fields can be added and Django will sort by the items in the order that they appear in this options list. Also, once the page loads, the user can opt to unsort or sort by another column if they press the action buttons in the table heading of those columns.</p>
			<h3>Option – preserve_filters</h3>
			<p>The <code>preserve_filters</code> option relates to <a id="_idIndexMarker885"/>how filters are applied when the user visits the changelist view page. By default, when a user decides to create, change, or edit an object for a model, when they are brought back to the changelist view page, the filters will be preserved. The only time we would actually have to use this option is when we want to disable this feature, making all filters reset whenever an add, change, or delete action has been performed.</p>
			<p>To disable this feature, set the <code>preserve_filters</code> value to <code>False</code>, as is done in the following example:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    preserve_filters = False</pre>
			<h3>Option – search_fields</h3>
			<p>The <code>search_fields</code> option enables a <a id="_idIndexMarker886"/>search bar on the changelist view page. One should already appear on the <code>Sellers</code> list because the <code>UserAdmin</code> class already defines this option for us. However, fields such as <code>name</code> are not currently searchable. Navigate to <code>http://localhost:8000/admin/chapter_3/seller/</code> and search for the <strong class="bold">Biz</strong> keyword and you should get no results.</p>
			<p>Now, add the following code block to the <code>SellerAdmin</code> class, making the field labeled <strong class="bold">Business Name</strong> searchable:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    <strong class="bold">search_fields</strong> = (</pre>
			<pre class="source-code">        'username',</pre>
			<pre class="source-code">        'first_name',</pre>
			<pre class="source-code">        'last_name',</pre>
			<pre class="source-code">        <strong class="bold">'name',</strong></pre>
			<pre class="source-code">        'email'</pre>
			<pre class="source-code">    )</pre>
			<p>Now, refresh the page and search for the same <code>Seller</code> with a <code>chapter_3</code> fixture.</p>
			<h2 id="_idParaDest-179"><a id="_idTextAnchor200"/>Change/add view-related options</h2>
			<p>These options pertain to an<a id="_idIndexMarker887"/> admin class on the add or change view <a id="_idIndexMarker888"/>pages, such as those listed here:</p>
			<ul>
				<li><code>http://localhost:8000/admin/chapter_3/engine/add/</code> </li>
				<li><code>http://localhost:8000/admin/chapter_3/engine/1/change/</code> </li>
				<li><code>http://localhost:8000/admin/chapter_3/seller/add/</code></li>
				<li><code>http://localhost:8000/admin/chapter_3/seller/1/change/</code></li>
				<li><code>http://localhost:8000/admin/chapter_3/vehicle_model/add/</code></li>
				<li><code>http://localhost:8000/admin/chapter_3/vehicle_model/1/change/</code></li>
				<li><code>http://localhost:8000/admin/chapter_3/vehicle/add/</code></li>
				<li><code>http://localhost:8000/admin/chapter_3/vehicle/1/change/</code> </li>
			</ul>
			<h3>Option – exclude</h3>
			<p>The <code>exclude</code> option can be thought of as the reverse of the <code>fields</code> option. This option will accept a list of fields that we <a id="_idIndexMarker889"/>wish to exclude from appearing on the form on the Django admin site. The fields added to the <code>exclude</code> option should not appear anywhere in the <code>fieldsets</code> or <code>add_fieldsets</code> option; otherwise, an error will be triggered. If a field exists in both the <code>fields</code> and <code>exclude</code> options, the field will be excluded.</p>
			<p>For example, if we want to exclude the <code>first_name</code> field using the following code, we would also have to remove the <code>first_name</code> field everywhere it appears in the <code>fieldsets</code>, <code>add_fieldsets</code>, <code>list_display</code>, <code>list_editable</code>, <code>search_fields</code>, and <code>prepopulated_fields</code> options, as they have been written in previous and future examples:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    exclude = (<strong class="bold">'first_name'</strong>,)</pre>
			<p>You may now remove this setting <a id="_idIndexMarker890"/>and reset the <code>first_name</code> field to its previous usage.</p>
			<h3>Option – fields</h3>
			<p>The <code>fields</code> option lets us <a id="_idIndexMarker891"/>explicitly state what fields to include in the admin form. Without declaring this field, Django will automatically include every field that exists for the model specified. However, the <code>'__all__'</code> value can also be used to explicitly state that all fields that exist in a related model shall be included.</p>
			<p>We will not be including this option since we want all fields included in these forms. However, if we did want to specify only certain fields, that would be done using a list, where the name of each field in the model is separated by a comma:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    fields = ('username', 'password', 'first_name', 'last_name',)</pre>
			<p>In this example, only these four fields would appear on the change view page for the <code>Seller</code> object.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The <code>fields</code> option cannot be combined with the <code>fieldsets</code> or <code>add_fieldsets</code> option and doing so will result in an error. However, the <code>fieldsets</code> and <code>add_fieldsets</code> options can be used together. On the <code>SellerAdmin</code> class, we can only use the <code>fieldsets</code> and <code>add_fieldsets</code> options because the <code>UserAdmin</code> parent class that was used to construct the <code>SellerAdmin</code> class already uses those options. In this case, the <code>exclude</code> option would be best used if we did not want to include specific fields. Also, if a field is not included in an admin class and is specified in any of the class options, then an error will be <a id="_idIndexMarker892"/>triggered.</p>
			<h3>Option – fieldsets</h3>
			<p>The <code>fieldsets</code> option is similar to the <code>fields</code> option in that it relates to customizing fields but it will group like fields together into designated categories that we create. Django will add HTML and special <a id="_idIndexMarker893"/>formatting to group these fields on the change and add view pages.</p>
			<p>For example, because we extended the Django <code>User</code> model in <a href="B17243_03_ePub.xhtml#_idTextAnchor077"><em class="italic">Chapter 3</em></a>, <em class="italic">Models, Relations, and Inheritance</em>, and are now using the <code>UserAdmin</code> class to construct the <code>SellerAdmin</code> class, we will need to write our own <code>fieldsets</code> option. We have to do this because Django will be using the <code>fieldsets</code> option as it was written in the <code>UserAdmin</code> class, which currently does not include the additional fields we created called <code>name</code> and <code>vehicles</code>. In order for the <code>name</code> and <code>vehicles</code> fields to appear on the change and add view pages, we need to add them to any fieldset group; otherwise, only the original <code>User</code> fields will appear.</p>
			<p>Start by copying the original <code>fieldsets</code> option found in the <code>django.contrib.auth.admin</code> library of Django into your <code>SellerAdmin</code> class and modify the groups to now include the <code>name</code> and <code>vehicles</code> fields, as shown: </p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    fieldsets = (</pre>
			<pre class="source-code">        (<strong class="bold">None</strong>, {</pre>
			<pre class="source-code">            <strong class="bold">'classes'</strong>: ('wide',),</pre>
			<pre class="source-code">            <strong class="bold">'fields'</strong>: (</pre>
			<pre class="source-code">                'username',</pre>
			<pre class="source-code">                'password',</pre>
			<pre class="source-code">            ),</pre>
			<pre class="source-code">        }),</pre>
			<pre class="source-code">        (('<strong class="bold">Personal Info</strong>'), {'fields': (</pre>
			<pre class="source-code">            'first_name',</pre>
			<pre class="source-code">            'last_name',</pre>
			<pre class="source-code">            <strong class="bold">'name',</strong></pre>
			<pre class="source-code">            'email',</pre>
			<pre class="source-code">        )}),</pre>
			<pre class="source-code">        (('<strong class="bold">Permissions</strong>'), {'fields': (</pre>
			<pre class="source-code">            'is_active',</pre>
			<pre class="source-code">            'is_staff',</pre>
			<pre class="source-code">            'is_superuser',</pre>
			<pre class="source-code">            'groups',</pre>
			<pre class="source-code">            'user_permissions',</pre>
			<pre class="source-code">        )}),</pre>
			<pre class="source-code">        (('<strong class="bold">Important Dates</strong>'), {'fields': (</pre>
			<pre class="source-code">             'last_login',</pre>
			<pre class="source-code">             'date_joined',</pre>
			<pre class="source-code">        )}),</pre>
			<pre class="source-code">        (('<strong class="bold">Vehicles</strong>'), {</pre>
			<pre class="source-code">            <strong class="bold">'description'</strong>: ('Vehicles that this user is selling.'),</pre>
			<pre class="source-code">            'fields': (</pre>
			<pre class="source-code">                <strong class="bold">'vehicles'</strong>,</pre>
			<pre class="source-code">            ),</pre>
			<pre class="source-code">        }),</pre>
			<pre class="source-code">    )</pre>
			<p>This option accepts a list of tuples. Each tuple contains two items, the label of that fieldset or the value of <code>None</code> to display no label at all, as depicted in the first group previously. The second<a id="_idIndexMarker894"/> item is another list of tuples where that tuple either defines one or all of three available keys: <code>fields</code>, <code>description</code>, and <code>classes</code>. The <code>classes</code> key is used to give the container of that fieldset an HTML class name, as depicted in <code>'classes': ('wide',)</code>. The <code>description</code> key will add an optional description that is rendered above a field in the admin form as a <code>&lt;p&gt;&lt;/p&gt;</code> HTML object, as shown in the <code>Vehicles</code> group previously. The <code>fields</code> key will accept a list of fields separated by a comma to add the fields desired to that fieldset group. This is the one mandatory key.</p>
			<p>Visit the change view for the seller named <code>admin</code> using the link <code>http://localhost:8000/admin/chapter_3/seller/1/change/</code>, and you should see five sections. The first section is not labeled and the other four are named in the order listed here:</p>
			<ul>
				<li><em class="italic">No label displayed</em></li>
				<li><strong class="bold">Personal Info</strong></li>
				<li><strong class="bold">Permissions</strong></li>
				<li><strong class="bold">Important Dates</strong></li>
				<li><strong class="bold">Vehicles</strong></li>
			</ul>
			<p>The new fields are the ones labeled <code>name</code> field in the <code>vehicles</code> field its own group.</p>
			<h3>Option – filter_horizontal</h3>
			<p>The <code>filter_horizontal</code> option<a id="_idIndexMarker895"/> relates to the <code>ManyToMany</code> field called <code>vehicles</code>, which was created for the <code>Seller</code> model. Navigate to the change view page for any seller in the database, such as <code>http://localhost:8000/admin/chapter_3/seller/1/change/</code>, and you'll see the field labeled <code>&lt;select multiple=""&gt;</code> HTML object. This can actually be difficult for some users to interact with, especially with the need to use the keyboard by either pressing the <em class="italic">Ctrl</em> button on Windows or the <em class="italic">Command</em> button on Mac to select multiple items for submission. Django provides a slick JavaScript-based user interface that can be applied to any <code>ManyToMany</code> fields.</p>
			<p>For example, go ahead and apply the<a id="_idIndexMarker896"/> following option to the <code>SellerAdmin</code> class, converting the <code>vehicles</code> field to now using the horizontal JavaScript user interfaces:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    filter_horizontal = ('vehicles',)</pre>
			<p>Next, refresh the same change view page and you will see the vehicles now look as in the following screenshot, where the boxes are stacked side by side horizontally from one another:</p>
			<div><div><img src="img/Figure_6.08_B17243.jpg" alt="Figure 6.8 – Django – filter_horizontal admin option&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.8 – Django – filter_horizontal admin option</p>
			<p>Now, the user has more than one method of interacting with this field. They could still use the keyboard to do everything, they could use the mouse to do everything, or they could use a combination of both. Visually it is much more appealing and easier to see what is and is not selected. This even provides a search field to help filter results and trim the fat if there are too many available choices. The two boxes are used for selecting what is available on the left and moving it to the selected box on the right with controls that move items in either <a id="_idIndexMarker897"/>direction. Additional controls allow the user to select and move all items found in one box to the other box.</p>
			<h3>Option – filter_vertical</h3>
			<p>The <code>filter_vertical</code> option is exactly the same as the <code>filter_horizontal</code> option except it will stack the boxes<a id="_idIndexMarker898"/> vertically instead of horizontally next to each other. The top box will be the items available and the bottom box is used for the items selected.</p>
			<h3>Option – form</h3>
			<p>When creating a custom admin form, which<a id="_idIndexMarker899"/> we will do later in this chapter, the <code>form</code> option is used to point to the form class that we wish to use. If we don't use this setting, Django will dynamically create a <code>ModelForm</code> for the model that you have registered with that admin class. </p>
			<p>Preparing ourselves for the section titled <em class="italic">Writing custom admin form classes</em> of this chapter, add the following option to the <code>EngineAdmin</code> class:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">EngineAdmin</strong>(<strong class="bold">ModelAdmin</strong>):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    <strong class="bold">form = EngineForm</strong></pre>
			<p>This option will link the admin class to an admin form that we will later call <code>EngineForm</code>.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Until we actually create the <code>EngineForm</code> form, you may run into errors. To prevent those errors, you can either comment out this line of code and leave the <code>pass</code> statement under the <code>EngineAdmin</code> class or create the <code>EngineForm</code> class now and add the <code>pass</code> statement to that <code>EngineForm</code> class until we actually add code to it later in this chapter.</p>
			<h3>Option – inlines</h3>
			<p>The <code>inlines</code> option is an advanced feature allowing us to make child models editable from within the parent model's change <a id="_idIndexMarker900"/>view page as an inline formset display. This feature is considered advanced in that we need to write separate<a id="_idIndexMarker901"/> classes just to use and implement this option. These classes can be edited with options that customize the look and feel of those formsets. Each inline object starts with an <code>InlineModelAdmin</code> class. The two <code>InlineModelAdmin</code> subclasses that are used to render an inline formset are <code>StackedInline</code> and <code>TabularInline</code>. These two classes perform the same actions as the <code>InlineModelAdmin</code> class except that they render a different HTML template for each class. Additional form classes can even be created and used with these inline classes. Refer to the documentation found at <a href="https://docs.djangoproject.com/en/4.0/ref/contrib/admin/#inlinemodeladmin-objects">https://docs.djangoproject.com/en/4.0/ref/contrib/admin/#inlinemodeladmin-objects</a>, as well as the concepts provided in <a href="B17243_05_ePub.xhtml#_idTextAnchor152"><em class="italic">Chapter 5</em></a>, <em class="italic">Django Forms</em>. </p>
			<p>Both the <code>StackedInline</code> and <code>TabularInline</code> classes are used for the model to which a <code>ForeignKey</code> field is linked. In the vehicle objects, we can apply the inline option to the <code>EngineAdmin</code> and <code>VehicleModelAdmin</code> classes. For any <code>ManyToMany</code> fields, we will have to link them in a slightly different way.</p>
			<p>Next, we will go over each of these classes and discuss briefly how they are used.</p>
			<h4>Class – InlineModelAdmin</h4>
			<p>The <code>InlineModelAdmin</code> class is the<a id="_idIndexMarker902"/> parent class that the two classes used to render inline formsets are constructed from. Every option and method of this class is available in those two child classes.</p>
			<p>Many of the options and methods available to the <code>ModelAdmin</code> class are also available in the <code>InlineModelAdmin</code> class. Here is a full list of what is provided in the <code>InlineModelAdmin</code> class:</p>
			<div><div><img src="img/Table_6.01_B17243.jpg" alt=""/>
				</div>
			</div>
			<p>A common option that we will be adding<a id="_idIndexMarker903"/> to all of the inline classes is <code>extra = 1</code>, which sets this value to <code>1</code> in order to show only one additional blank formset, allowing the user to dynamically add objects when they want to. If this value were set to, say <code>10</code>, then 10 additional blank formsets would appear. The default value is <code>3</code> and this is why we are going to override the default value in all of our classes to the value of <code>1</code>, providing a better user experience.</p>
			<p>For a complete breakdown of how to use <a id="_idIndexMarker904"/>these options and methods, visit <a href="https://docs.djangoproject.com/en/4.0/ref/contrib/admin/#inlinemodeladmin-options">https://docs.djangoproject.com/en/4.0/ref/contrib/admin/#inlinemodeladmin-options</a>. </p>
			<h4>Class – StackedInline</h4>
			<p>The <code>StackedInline</code> class is used to <a id="_idIndexMarker905"/>render inline formsets using the <code>/admin/edit_inline/stacked.html</code> template.</p>
			<p>To practice using this option on the <code>EngineAdmin</code> class, add the following class to the <code>/chapter_6/admin.py</code> file, preferably placing all inline formset classes at the top of this document:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">from django.contrib.admin </pre>
			<pre class="source-code">import ..., <strong class="bold">StackedInline</strong></pre>
			<pre class="source-code">class <strong class="bold">VehicleInline</strong>(<strong class="bold">StackedInline</strong>):</pre>
			<pre class="source-code">    model = <strong class="bold">Vehicle</strong></pre>
			<pre class="source-code">    <strong class="bold">extra = 1</strong></pre>
			<p>Next, add the following option to the <code>EngineAdmin</code> class, placed below all inline formset classes:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">EngineAdmin</strong>(ModelAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    inlines = [<strong class="bold">VehicleInline</strong>,]</pre>
			<p>Now, navigate to the change view page of any of the engine objects, such as <code>http://localhost:8000/admin/chapter_3/engine/1/change/</code>. We can see that each vehicle that uses that particular engine can be edited from the edit engine page, as shown in the following <a id="_idIndexMarker906"/>screenshot:</p>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_6.09_B17243.jpg" alt="Figure 6.9 – Django – inlines admin option – StackedInline&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.9 – Django – inlines admin option – StackedInline</p>
			<p>The <code>StackedInline</code> class will display each field stacked one on top of the other, vertically, as shown in the previous screenshot.</p>
			<h4>Class – TabularInline</h4>
			<p>The <code>TabularInline</code> class is written <a id="_idIndexMarker907"/>and implemented in the exact same way as the previous <code>StackedInline</code> example except that the <code>VehicleInline</code> class is used, as shown in the following example:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">from django.contrib.admin </pre>
			<pre class="source-code">import ..., <strong class="bold">TabularInline</strong></pre>
			<pre class="source-code">class VehicleInline(<strong class="bold">TabularInline</strong>):</pre>
			<pre class="source-code">    model = Vehicle</pre>
			<pre class="source-code">    <strong class="bold">extra = 1</strong></pre>
			<p>Now, refresh the same page, <code>http://localhost:8000/admin/chapter_3/engine/1/change/</code>, and when rendered to the page, the fields will now display<a id="_idIndexMarker908"/> horizontally in neatly organized columns, as shown in the following screenshot:</p>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_6.10_B17243.jpg" alt="Figure 6.10 – Django – inlines admin option – TabularInline&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.10 – Django – inlines admin option – TabularInline</p>
			<h4>ManyToMany field inlines</h4>
			<p>What would be the most useful and also <a id="_idIndexMarker909"/>make the most sense in the vehicle relations would be to link all of the vehicles that a seller is selling on the <code>Seller</code> change view page. If we write an inline class the same way we wrote an inline class for a <code>ForeignKey</code> field, now for a <code>ManyToMany</code> field relation, we would wind up getting an error. To prevent that error, write your inline class almost the same way that you implemented inline classes for related <code>ForeignKey</code> fields except now, you will add a <code>through</code> statement.</p>
			<p>Create the following class, to be used on the <code>SellerAdmin</code> class, using either a <code>TabularInline</code> or <code>StackedInline</code> class as its constructor, and for the model, use the following <code>through</code> statement:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">from django.contrib.admin </pre>
			<pre class="source-code">import ..., TabularInline</pre>
			<pre class="source-code">class VehiclesInline(TabularInline):</pre>
			<pre class="source-code">    model = <strong class="bold">Seller.vehicles.through</strong></pre>
			<pre class="source-code">    <strong class="bold">extra = 1</strong></pre>
			<p>Here, we are naming this class the plural <code>VehiclesInline</code>, with an <em class="italic">s</em>, instead of the first class that we wrote, called <code>VehicleInline</code>, as the naming convention. We are doing this to indicate that one is related to a <code>ManyToMany</code> field and the other is not. This naming convention<a id="_idIndexMarker910"/> is not mandatory; your naming convention can be anything you would like it to be, but this is helpful. We are linking the <code>model</code> option directly to the <code>Seller</code> model by the <code>vehicles</code> field, which is the <code>ManyToMany</code> field, using the <code>through</code> attribute.</p>
			<p>In the <code>SellerAdmin</code> class, add the following <code>inlines</code> option:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    inlines = [<strong class="bold">VehiclesInline</strong>,]</pre>
			<p>Now, navigate to the change view page for a seller at <code>http://localhost:8000/admin/chapter_3/seller/1/change/</code>, and we can see that the vehicles this seller is selling are now rendered the same as the previous inline formset exercises. One difference in using the <code>ManyToMany</code> fields is that they will render as related objects. They can be edited by clicking the pencil icon next to each item, where a pop-up window will appear, allowing the user to edit that item. </p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Remove the <code>vehicles</code> field from the <code>fieldsets</code>, <code>filter_horizontal</code>, and <code>filter_vertical</code> options for best results when implementing the vehicle inline fieldset.</p>
			<h3>Option – radio_fields</h3>
			<p>The <code>radio_fields</code> option is used on <code>ForeignKey</code>, <code>OneToOne</code> fields, and any <code>CharField</code> that is using a list of<a id="_idIndexMarker911"/> choices. By default, Django will render these fields as a <code>&lt;select&gt;</code> HTML object, where the user can select a single option from a drop-down list of choices. By adding a field to the <code>radio_fields</code> option, Django will render the choices as a set of HTML radio buttons, where the user has all the choices visually presented to them when they view this page. For fields with dozens or even hundreds of choices, this might not be the best option and is the reason why Django will default to a <code>&lt;select&gt;</code> box.</p>
			<p>Go ahead and add the <code>radio_fields</code> to the <code>VehicleAdmin</code> class, where we have two <code>ForeignKey</code> fields to play with. Apply this option to just one of those fields, the <code>engine</code> field, and leave the <code>vehicle_model</code> field as it is, just like in the following example. This way, when we view it on the page, we can see the differences between the two:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">from django.contrib </pre>
			<pre class="source-code">import admin</pre>
			<pre class="source-code">from django.contrib.admin </pre>
			<pre class="source-code">import ModelAdmin</pre>
			<pre class="source-code">class VehicleAdmin(ModelAdmin):</pre>
			<pre class="source-code">    radio_fields = {<strong class="bold">'engine': admin.HORIZONTAL</strong>,}</pre>
			<p>In the previous example, each key in the <code>radio_fields</code> option relates to the name of the field that we are converting from a <code>&lt;select&gt;</code> to a radio button. The value of that key takes in one of two choices, <code>admin.VERTICAL</code> or <code>admin.HORIZONTAL</code>. This value is used to display the radio button choices either vertically or horizontally on the page.</p>
			<p>Now, navigate to the change view page for any of the vehicles, such as <code>http://localhost:8000/admin/chapter_3/vehicle/1/change/</code>, and see how the <code>vehicle_model</code> and <code>engine</code> fields<a id="_idIndexMarker912"/> differ, as depicted in the following screenshot, with a select box and radio button choices:</p>
			<p class="figure-caption"> </p>
			<div><div><img src="img/Figure_6.11_B17243.jpg" alt="Figure 6.11 – Django – radio_fields admin option&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.11 – Django – radio_fields admin option</p>
			<h3>Option – save_on_top</h3>
			<p>The <code>save_on_top</code> option is used to <a id="_idIndexMarker913"/>display a set of action buttons at the top of the change or add view pages. This is not the same as the <code>actions_on_bottom</code> or <code>actions_on_top</code> options, which only relate to the changelist view page. By default, Django sets this value to <code>False</code>, showing only action buttons at the bottom of the page. Setting this value to <code>True</code> means the buttons will appear both at the top and at the bottom of those pages.</p>
			<p>For example, add the following option to the <code>SellerAdmin</code> class to show those buttons at the top and bottom of the change and add view pages:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    <strong class="bold">save_on_top = True</strong></pre>
			<p>Now, navigate to any of the change or add view pages, such as <code>http://localhost:8000/admin/chapter_3/seller/1/change/</code>, and we will see the action buttons appear both at the top <a id="_idIndexMarker914"/>and the bottom of this page.</p>
			<h2 id="_idParaDest-180"><a id="_idTextAnchor201"/>Add view-related options</h2>
			<p>These options override the<a id="_idIndexMarker915"/> behavior of admin classes that only pertain to the add view and not the change view pages, such as those listed here:</p>
			<ul>
				<li><code>http://localhost:8000/admin/chapter_3/engine/add/</code> </li>
				<li><code>http://localhost:8000/admin/chapter_3/seller/add/</code></li>
				<li><code>http://localhost:8000/admin/chapter_3/vehicle_model/add/</code></li>
				<li><code>http://localhost:8000/admin/chapter_3/vehicle/add/</code></li>
			</ul>
			<h3>Option – add_fieldsets</h3>
			<p>The <code>add_fieldsets</code> option does<a id="_idIndexMarker916"/> exactly what the <code>fieldsets</code> option does except these are fields that relate only to the add/create view form rather than the change view form. For example, navigate to <code>http://localhost:8000/admin/chapter_3/seller/add/</code> and you'll see that the Django <code>UserAdmin</code> class that the <code>SellerAdmin</code> class is constructed from only provides three fields, and then the remaining fields appear after we have created a new <code>Seller</code> object. </p>
			<p>If we wanted to provide the <code>first_name</code>, <code>last_name</code>, <code>name</code>, and <code>email</code> fields, we would modify the <code>add_fieldsets</code> variable of the <code>SellerAdmin</code> class to look like the following example:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    <strong class="bold">add_fieldsets</strong> = (</pre>
			<pre class="source-code">        (None, {</pre>
			<pre class="source-code">            'classes': ('wide',),</pre>
			<pre class="source-code">            'fields': (</pre>
			<pre class="source-code">                'username',</pre>
			<pre class="source-code">                'password1',</pre>
			<pre class="source-code">                'password2',</pre>
			<pre class="source-code">            ),</pre>
			<pre class="source-code">        }),</pre>
			<pre class="source-code">        <strong class="bold">(('Personal Info'), {'fields': (</strong></pre>
			<pre class="source-code">            <strong class="bold">'first_name',</strong></pre>
			<pre class="source-code">            <strong class="bold">'last_name',</strong></pre>
			<pre class="source-code">            <strong class="bold">'name',</strong></pre>
			<pre class="source-code">            <strong class="bold">'email',</strong></pre>
			<pre class="source-code">        <strong class="bold">)}),</strong></pre>
			<pre class="source-code">    )</pre>
			<p>In the preceding example, we see that writing and grouping fieldsets are written exactly the same as the <code>fieldsets</code> example was written earlier. Now, when we visit the same add <code>Seller</code> URL as before, <code>http://localhost:8000/admin/chapter_3/seller/add/</code>, we can see four additional<a id="_idIndexMarker917"/> fields, the four we included in the <strong class="bold">Personal Info</strong> fieldset previously.</p>
			<h3>Option – prepopulated_fields</h3>
			<p>The <code>prepopulated_fields</code> option tells <a id="_idIndexMarker918"/>a field(s) to listen for an event when the target field's value has changed and then updates those field values with the value of the target field. This is handy in situations where the user changes the value of a <code>title</code> field as the <code>slug</code> field will automatically populate with the same value. For example, in the <code>Seller</code> model, let's wire this up to listen for when the <code>first_name</code> and <code>last_name</code> fields change and then populate the <code>username</code> field value with a value derived from both of the <code>first_name</code> and <code>last_name</code> values. </p>
			<p>For this example, apply the following option to the <code>SellerAdmin</code> class:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">SellerAdmin</strong>(UserAdmin):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    <strong class="bold">prepopulated_fields</strong> = {</pre>
			<pre class="source-code">        <strong class="bold">'username': ('first_name', 'last_name',)</strong></pre>
			<pre class="source-code">    }</pre>
			<p>In the preceding code, we can also apply additional fields just as we did with the <code>first_name</code> and <code>last_name</code> fields. Navigate to the add view page for the <code>Seller</code> model at <code>http://localhost:8000/admin/chapter_3/seller/add/</code> and begin typing within the <code>first_name</code> or <code>last_name</code> fields. You will see the <code>username</code> field auto-populate with the values that are <a id="_idIndexMarker919"/>typed. Spaces will be replaced with a dash and the value of the fields will display in the order in which they were written in the <code>prepopulated_fields</code> option. For example, <code>first_name</code> will appear before the <code>last_name</code> value based on how we wrote it previously.</p>
			<p>Now that we have learned all about the different options and applied many of them to our admin classes, let's dive into the various admin class methods tha<a id="_idTextAnchor202"/>t we can use.</p>
			<h1 id="_idParaDest-181"><a id="_idTextAnchor203"/>Adding admin class methods</h1>
			<p>Admin class methods allow us to add <a id="_idIndexMarker920"/>or change the default behavior of a <code>ModelAdmin</code> or <code>UserAdmin</code> class. Any of the options available in an admin class can have its value dynamically calculated by writing a method. Those methods use the <code>get_</code> naming convention and then the name of the option, as in <code>get_ordering()</code> or <code>get_form()</code>. Django also provides many built-in methods that add extra actions when something happens, such as when an object is saved or deleted using the <code>save_model()</code> or <code>delete_model()</code> methods. </p>
			<p>Next, we will explore just some of these methods and also provide a demonstration using a dynamic value, specifically for the <code>form</code> option. That will prepare us to use a separate form class later in this chapter. </p>
			<p>For a complete breakdown <a id="_idIndexMarker921"/>of how to use Django admin class methods, visit the official Django documentation here: <a href="https://docs.djangoproject.com/en/4.0/ref/contrib/admin/#modeladmin-methods">https://docs.djangoproject.com/en/4.0/ref/contrib/admin/#modeladmin-methods</a>.</p>
			<h2 id="_idParaDest-182"><a id="_idTextAnchor204"/>Method – get_form()</h2>
			<p>The <code>get_form()</code> method is used to get the form class that will be used within an admin class. For example, in the <a id="_idIndexMarker922"/>following two exercises, one will check to see whether an object exists, then based on the result of that condition, we <a id="_idIndexMarker923"/>will serve one form class for the change view and another form class for the add view. In the other exercise, we will demonstrate showing one form for a superuser and another for a regular user.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">We have not created the <code>EngineForm</code>, <code>EngineSuperUserForm</code>, or <code>AddEngineForm</code> classes yet. Go ahead and create these classes with at least the <code>pass</code> statement in the <code>/chapter_6/forms.py</code> file to allow pages other than the engine change and add view ones to load without errors. After completing these exercises, your engine change and add view pages will error out even with the <code>pass</code> statement included. Please wait to load/reload the engine change or add view pages until we have completed the section titled <em class="italic">Writing custom admin form classes</em> of this chapter, which will add the necessary components to prevent errors when loading those pages.</p>
			<h3>Change/add view condition </h3>
			<p>In the <code>EngineAdmin</code> class, add the<a id="_idIndexMarker924"/> following <code>get_form()</code> method and remove or comment out the previous <code>form</code> option that we wrote earlier for this class, as depicted here:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">from .forms </pre>
			<pre class="source-code">import <strong class="bold">AddEngineForm</strong>, <strong class="bold">EngineForm</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">EngineAdmin</strong>(<strong class="bold">ModelAdmin</strong>):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    <strong class="bold">#</strong>form = EngineForm</pre>
			<pre class="source-code">    </pre>
			<pre class="source-code">    def <strong class="bold">get_form</strong>(self, request, <strong class="bold">obj=None</strong>, **kwargs):</pre>
			<pre class="source-code">        <strong class="bold">if obj:</strong></pre>
			<pre class="source-code">            return <strong class="bold">EngineForm</strong></pre>
			<pre class="source-code">        <strong class="bold">else:</strong></pre>
			<pre class="source-code">            return <strong class="bold">AddEngineForm</strong></pre>
			<pre class="source-code">        return super(EngineAdmin, self).get_form(request, obj, **kwargs)</pre>
			<p>As we can see in the preceding example, we replaced <code>form = EngineForm</code> with a method that performs a little bit of logic to serve up one of two different forms now. Using the pound symbol, we<a id="_idIndexMarker925"/> commented out the <code>form = EngineForm</code> line.</p>
			<h3>Superuser condition</h3>
			<p>Another use of this method is serving <a id="_idIndexMarker926"/>up one form if a user has superuser status and another if they do not, using the conditional statement shown here:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">from .forms </pre>
			<pre class="source-code">import ..., <strong class="bold">EngineSuperUserForm</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">EngineAdmin</strong>(<strong class="bold">ModelAdmin</strong>):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    def <strong class="bold">get_form</strong>(self, request, <strong class="bold">obj=None</strong>, **kwargs):</pre>
			<pre class="source-code">        if obj:</pre>
			<pre class="source-code">            <strong class="bold">if request.user.is_superuser:</strong></pre>
			<pre class="source-code">                return <strong class="bold">EngineSuperUserForm</strong></pre>
			<pre class="source-code">            else:</pre>
			<pre class="source-code">                return EngineForm</pre>
			<pre class="source-code">        else:</pre>
			<pre class="source-code">            return AddEngineForm</pre>
			<p>The idea here is that we grant the superuser additional fields that a regular user cannot edit, such as permission rights and <a id="_idIndexMarker927"/>permission group settings.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Even though we extended the Django <code>User</code> model as a seller, the currently logged-in seller will appear in the <code>request</code> dictionary as a <code>user</code> key, as in <code>request.user</code> shown in the previous code block.</p>
			<h2 id="_idParaDest-183"><a id="_idTextAnchor205"/>Method – save_model()</h2>
			<p>The <code>save_model()</code> method is used to add<a id="_idIndexMarker928"/> actions before and/or after the object is saved in a change or add view. To add this method to the <code>EngineAdmin</code> class, include the code shown here:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">…</pre>
			<pre class="source-code">class <strong class="bold">EngineAdmin</strong>(<strong class="bold">ModelAdmin</strong>):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    def <strong class="bold">save_model</strong>(self, request, obj, form, change):</pre>
			<pre class="source-code">        print(obj.__dict__)</pre>
			<pre class="source-code">        # Code actions before save here</pre>
			<pre class="source-code">        <strong class="bold">super().save_model(request, obj, form, change)</strong></pre>
			<pre class="source-code">        # Code actions after save here</pre>
			<p>Here, we create the <code>save_model()</code> method with five positional arguments, those being <code>self</code>, <code>request</code>, <code>obj</code>, <code>form</code>, and <code>change</code>, in that order. These five arguments make relevant data available to use when writing logic within that method. The <code>change</code> argument has a value of either <code>True</code> or <code>False</code>. If the object being saved is from the add view page, the <code>change</code> value will be <code>False</code>; if the object is on the change view page, the <code>change</code> value will be <code>True</code>. The <code>super().save_model(request, obj, form, change)</code> line is what actually saves the object and this is the same as using a <code>Model.save()</code> operation. Actions above this line will take place before the <a id="_idIndexMarker929"/>object is saved. Actions written after this line take place after the object has been saved, actions such as sending an email or triggering a notification alert.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Using the <code>__dict__</code> property within the <code>print</code> statement shown previously will display a dictionary of keys and values available within that <code>obj</code>.</p>
			<h2 id="_idParaDest-184"><a id="_idTextAnchor206"/>Method – delete_model()</h2>
			<p>The <code>delete_model()</code> method is<a id="_idIndexMarker930"/> used just like the <code>save_model()</code> method except for when an object is deleted and not saved. In the same <code>EngineAdmin</code> class, add the method shown here:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/admin.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">class <strong class="bold">EngineAdmin</strong>(<strong class="bold">ModelAdmin</strong>):</pre>
			<pre class="source-code">    ...</pre>
			<pre class="source-code">    def <strong class="bold">delete_model</strong>(self, request, obj):</pre>
			<pre class="source-code">        print(obj.__dict__)</pre>
			<pre class="source-code">        # Code actions before delete here</pre>
			<pre class="source-code">        <strong class="bold">super().delete_model(request, obj)</strong></pre>
			<pre class="source-code">        # Code actions after delete here</pre>
			<p>Next, we will create and modify the custom admin form classes that we spoke about earlier in this chapter, in the <a id="_idIndexMarker931"/>subsection titled <em class="italic">Method – get_form()</em>.</p>
			<h1 id="_idParaDest-185"><a id="_idTextAnchor207"/>Writing custom admin form classes</h1>
			<p>Admin forms can be created and used<a id="_idIndexMarker932"/> just like the standard form classes we discussed in <a href="B17243_05_ePub.xhtml#_idTextAnchor152"><em class="italic">Chapter 5</em></a>, <em class="italic">Django Forms</em>. For admin form classes, we need to use the Django <code>ModelForm</code> class instead of the standard <code>Form</code> class found in the <code>django.forms</code> library, because the fields in these forms will link to model classes. Refer to the examples found in <a href="B17243_05_ePub.xhtml#_idTextAnchor152"><em class="italic">Chapter 5</em></a>, <em class="italic">Django Forms</em>, to learn more about how to customize and change your form class behavior, for either a <code>Form</code> or <code>ModelForm</code> class. Here, we will demonstrate just initializing your admin forms and enabling all fields that exist, to allow any of the engine change and add view pages to load without the errors mentioned earlier.</p>
			<h2 id="_idParaDest-186"><a id="_idTextAnchor208"/>Initializing an admin form</h2>
			<p>If you have not already done so, in the <code>chapter_6</code> app folder, create a file called <code>forms.py</code>. We need to create the <a id="_idIndexMarker933"/>three different form classes used in the previous examples of this chapter and call them <code>EngineForm</code>, <code>AddEngineForm</code>, and <code>EngineSuperUserForm</code>. Create them using the example provided here, except change the name <code>EngineForm</code> to the name of the class that you are writing and change the related model class for all three of the classes as well:</p>
			<pre class="source-code"><strong class="bold"># /becoming_a_django_entdev/chapter_6/forms.py</strong></pre>
			<pre class="source-code">...</pre>
			<pre class="source-code">from django.forms </pre>
			<pre class="source-code">import ..., <strong class="bold">ModelForm</strong></pre>
			<pre class="source-code">from ..chapter_3.models </pre>
			<pre class="source-code">import <strong class="bold">Engine</strong></pre>
			<pre class="source-code">class <strong class="bold">EngineForm</strong>(<strong class="bold">ModelForm</strong>):</pre>
			<pre class="source-code">    def __init__(self, *args, **kwargs):</pre>
			<pre class="source-code">        print('<strong class="bold">EngineForm</strong> Initialized')</pre>
			<pre class="source-code">        super(<strong class="bold">EngineForm</strong>, self).__init__(*args, **kwargs)</pre>
			<pre class="source-code">    class <strong class="bold">Meta</strong>:</pre>
			<pre class="source-code">        model = <strong class="bold">Engine</strong></pre>
			<pre class="source-code">        fields = <strong class="bold">'__all__'</strong></pre>
			<p>The least amount of code that is needed for a <code>ModelForm</code> class to work within admin classes can be achieved by providing the <code>__init__</code> method, initializing the form. In addition, we will need the <code>Meta</code> subclass with the <code>model</code> and <code>fields</code> options. On all three of these classes (<code>EngineForm</code>, <code>AddEngineForm</code>, and <code>EngineSuperUserForm</code>), give the <code>model</code> option a value of <code>Engine</code>, linking them all to the <code>Engine</code> model. For the <code>fields</code> option, provide a value of <code>'__all__'</code> to let Django create the fields for you based on the fields that have <a id="_idIndexMarker934"/>been written in the <code>Engine</code> model class. Unlike the admin classes that we wrote, we actually have to tell Django to use all or some fields in this class.</p>
			<p>You are welcome to adjust the fields and/or add other options in order to customize the look and feel of each of these forms, allowing us to see how they differ from one another when they are rendered. Alternatively, you can use <code>print</code> statements in each form's <code>__init__</code> method, as was done previously, to let you know that the logic is working properly. If you visit any of the engine change or add view pages with the options provided in the <em class="italic">Configuring admin class options</em> section of this chapter, the page should now load without errors. </p>
			<p>The engine change and add pages are listed here:</p>
			<ul>
				<li>Engine add view – <code>http://localhost:8000/admin/chapter_3/engine/add/</code> </li>
				<li>Engine change view – <code>http://localhost:8000/admin/chapter_3/engine/1/change/</code> </li>
			</ul>
			<p>Next, let's discuss configuring user permissions within the Django admin site.</p>
			<h1 id="_idParaDest-187"><a id="_idTextAnchor209"/>Using the Django authentication system</h1>
			<p>Django provides a very<a id="_idIndexMarker935"/> powerful authentication system to grant permission rights to users. By default, a superuser has the authority to do everything, which is why we had to create at least one superuser in <a href="B17243_02_ePub.xhtml#_idTextAnchor037"><em class="italic">Chapter 2</em></a>, <em class="italic">Project Configuration</em>. That superuser is needed at all times within the Django system to maintain control of your site and your data. The superuser granted us the ability to take control of our system and establish user roles and groups for every other user in the system. Creating a user and superuser can be done via the command line using a Django management command or through the IDE, just like when we explored those subjects in <a href="B17243_02_ePub.xhtml#_idTextAnchor037"><em class="italic">Chapter 2</em></a>, <em class="italic">Project Configuration</em>. It can also be done through the Django shell, as we did in <a href="B17243_03_ePub.xhtml#_idTextAnchor077"><em class="italic">Chapter 3</em></a>, <em class="italic">Models, Relations, and Inheritance</em>, when we created and saved models using the Django shell. <code>user</code> and <code>Seller</code> are just other model objects that we create and save. Now that we have access to the Django admin site, we can also add users, or in our case, sellers, and edit their permissions using this interface.</p>
			<p>Next, let's add a regular user to the system so that we can have at least one regular user and one superuser to compare and contrast their roles.</p>
			<h2 id="_idParaDest-188"><a id="_idTextAnchor210"/>Adding a seller</h2>
			<p>Here, we will activate the <a id="_idIndexMarker936"/>Django shell, import the <code>Seller</code> model from the <code>chapter_3</code> app, and then proceed to create the new <code>Seller</code> object, which is a standard user:</p>
			<ol>
				<li value="1">Activate the Django shell in any terminal or command-line window, just as we did in <a href="B17243_03_ePub.xhtml#_idTextAnchor077"><em class="italic">Chapter 3</em></a>, <em class="italic">Models, Relations, and Inheritance</em>. Once activated, import the <code>Seller</code> object, as shown:<pre><strong class="bold">(virtual_env) PS &gt; python3 manage.py shell</strong>
<strong class="bold">&gt;&gt;&gt; from becoming_a_django_entdev.chapter_3.models import Seller </strong></pre></li>
			</ol>
			<p>Django includes, in the <code>User</code> model, a <code>create_user()</code> method, used for easily creating a new user that does not have superuser rights. This method does the heavy lifting of encrypting the password for us, so all we have to do is provide the unencrypted password as a string. </p>
			<ol>
				<li value="2">Since we extended the Django <code>User</code> model into a <code>Seller</code> in <a href="B17243_03_ePub.xhtml#_idTextAnchor077"><em class="italic">Chapter 3</em></a>, <em class="italic">Models, Relations, and Inheritance</em>, we will have to use the <code>create_user()</code> method on the <code>Seller</code> model, as is shown in the following code. Execute the following<a id="_idIndexMarker937"/> command, remembering the password that you used as you will need it to log into the Django admin site with that user:<pre><strong class="bold">&gt;&gt;&gt; seller = Seller.objects.create_user('test', 'testing@example.com', 'testpassword', is_staff=True)</strong></pre></li>
				<li>Now, exit the Django shell by executing the <code>exit()</code> command and run the project again by executing the <code>runserver</code> command, as shown:<pre><strong class="bold">&gt;&gt;&gt; exit()</strong>
<strong class="bold">(virtual_env) PS &gt; python3 manage.py runserver</strong></pre></li>
			</ol>
			<p>Now, visit the <code>Seller</code> changelist view page here: http://localhost:8000/admin/chapter_3/seller/. You should see at least two results, as shown in the following screenshot: </p>
			<div><div><img src="img/Figure_6.12_B17243.jpg" alt="Figure 6.12 – Django – Seller's changelist view&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.12 – Django – Seller's changelist view</p>
			<p>As is depicted in the preceding screenshot, one result has a superuser status and the other, the one that we just created, does not. The <code>is_staff</code> value is set to <code>False</code> when using the <code>create_user()</code> method. This is why we had to explicitly set it to <code>True</code> in the preceding code example.</p>
			<p>Now, log out of the admin site and then log back in, with the username as <code>test</code> and password as <code>testpassword</code>, and you should now see a message on your dashboard indicating that you do not have permission to view anything yet, as shown in the following screenshot:</p>
			<div><div><img src="img/Figure_6.13_B17243.jpg" alt="Figure 6.13 – Django – admin site test for Seller&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.13 – Django – admin site test for Seller</p>
			<p>This is expected behavior<a id="_idIndexMarker938"/> because we have not granted this user any permissions yet. Next, let's grant this user some permissions.</p>
			<h2 id="_idParaDest-189"><a id="_idTextAnchor211"/>Granting permissions</h2>
			<p>To grant users permissions, we<a id="_idIndexMarker939"/> will be using the admin interface this time. Log out again and then log back in with the <code>admin</code> user or whatever name you may have given your superuser. Navigate to the change view of your <code>test</code> user at <code>http://localhost:8000/admin/chapter_3/seller/2/change/</code>, which should be ID number <code>2</code>, unless you created more users on your own, then find the change view of the user ID that you are currently working with.</p>
			<p>On this page, grant the <code>test</code> user the ability to change everything in the <code>chapter_3</code> app and leave everything else unselected, as shown:</p>
			<div><div><img src="img/Figure_6.14_B17243.jpg" alt="Figure 6.14 – Django – user permissions&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.14 – Django – user permissions</p>
			<p>Using the <code>chapter_3</code> to show only the relevant <a id="_idIndexMarker940"/>permissions for this task. Don't forget to save this user before proceeding. Log out and then log back in again, this time with the <code>test</code> user credentials. Now, we should see the models related to our vehicles, as depicted in the following screenshot:</p>
			<div><div><img src="img/Figure_6.15_B17243.jpg" alt="Figure 6.15 – Django – admin site test for Seller 2&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 6.15 – Django – admin site test for Seller 2</p>
			<p>Permissions can be granted on a per-group basis instead of navigating to each user and granting permissions one at a time.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">The <code>Sellers</code> object is now available to the <code>test</code> user. Navigating to the change view of any of the <code>Sellers</code> that exists while logged in as a standard user will show the permissions fields. To prevent this from happening, you can either limit only superusers to view and edit the <code>Seller</code> model objects or follow the steps depicted in the <em class="italic">Method – get_form()</em> subsection of this chapter to then add your own logic to the <code>SellerAdmin</code> class. That will only show the permission-related fields to superusers.</p>
			<h2 id="_idParaDest-190"><a id="_idTextAnchor212"/>Permission groups</h2>
			<p>Permission groups are a way to add or remove users to or from a group by defining a set of permissions. A system with thousands of<a id="_idIndexMarker941"/> users would prove tedious to manage, not to mention how many inconsistencies it could result in, as we factor in human error. </p>
			<p>Now, make sure you are logged out of the <code>test</code> user account, then log back in with the <code>admin</code> user account and navigate to the group add view page here: <code>http://localhost:8000/admin/auth/group/add/</code>. Then, create a new group called <code>test_group</code> and grant the same permissions to this group that were given to the <code>test</code> user in the previous exercise. Next, go back to the change view page of that <code>test</code> user, remove all the user permissions from before, and assign them to the <code>test_group</code> group instead. This <code>test</code> user will be given the same permissions as before. With this, you can create as many groups as you would like, assign users to each group as you desire, and customize rights to the needs of your project. Additional permissions can be given to users on an ad hoc basis by assigning them to a group and then giving them extra user-based permissions in addition to that group assignment.</p>
			<h1 id="_idParaDest-191"><a id="_idTextAnchor213"/>Summary</h1>
			<p>We activated and customized the Django admin site for a project, otherwise known as the admin panel. This powerful tool helps us to get up and running with search, filter, sort, create, edit, and delete capabilities for all of the models that we choose to register on this site. With the concepts provided in this chapter, you should be able to make your admin panel a very useful tool that your users will enjoy. </p>
			<p>With the authentication system that Django provides, many different types of users can all access and use the same site but have very different roles and uses. Each type of user could even be given entirely different templates and flows if we venture down the road of extending templates or building onto that templating system using the concepts provided in previous chapters.</p>
			<p>In the next chapter, we will discuss sending emails, creating custom email templates, as well as creating PDF reports using the Django template language.</p>
		</div>
	</body></html>