<html><head></head><body>
  <div><div><div><div><div><h1 class="title"><a id="ch09"/>Chapter 9. Exchanging Inkscape SVG Drawings with Tkinter Shapes</h1></div></div></div><p>In this chapter, we will cover:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Inkscape as a tool for acquiring Tkinter line shapes (paths)</li><li class="listitem" style="list-style-type: disc">Finding and installing Inkscape</li><li class="listitem" style="list-style-type: disc">Where to find SVG clipart</li><li class="listitem" style="list-style-type: disc">Getting Tkinter paths from raster images</li><li class="listitem" style="list-style-type: disc">Converting path data from SVG images into other formats</li><li class="listitem" style="list-style-type: disc">Using Inkscape as a graphic tool for Tkinter paths</li></ul></div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec01"/>Introduction</h1></div></div></div><p>In this chapter, we explore alternate ways and means of getting graphic-shaped data into Tkinter programs. Probably the most widespread vector-graphic format is the one designed to work on web pages. This is known as<strong> SVG</strong>, which is short-form for<strong> Scaled Vector Graphics</strong>. It is the official standard specification defined by the World Wide Web Consortium and has been around since 1999.<a id="id243" class="indexterm"/>
</p><p>Our interest in SVG comes from the practical use it has for us in creating drawn shapes in Python with the Tkinter module.</p><p>Professional vector-drawing packages like Inkscape and some of the proprietary-drawing packages allow us, aided by some Python code, to acquire lists of coordinates that can be used directly in the<code class="literal"> create_line(x0,y0 …)</code> functions of Tkinter.<a id="id244" class="indexterm"/>
</p><p>There are growing libraries of copyright-free SVG pictures available on the web. With tools like Inkscape, we can dismantle existing images and use parts of them for our own graphic work and Python programs. One such site is<a class="ulink" href="http://www.openclipart.org/"> www.openclipart.org/</a> which allows and encourages anyone to copy the thousands of images stored there in SVG format.<a id="id245" class="indexterm"/>
</p><p>SVG drawings encode lines in more than one way. One way is to represent a line as a series of x-y coordinate points on a canvas. Each point is defined as a pair of numbers referred to the zero position of the canvas which is the North-West corner (top-right). The second way is to represent each point as a relative shift from the previous point.<a id="id246" class="indexterm"/>
</p></div></div></div>


  <div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec02"/>The structure of an SVG drawing</h1></div></div></div><p>We shall examine how Inkscape encodes drawings so that we may interpret them for use in Python. What we will do is:<a id="id247" class="indexterm"/>
</p><div><ol class="orderedlist"><li class="listitem">Draw some simple objects in Inkscape and save them somewhere as "Plain SVG" format files.</li><li class="listitem">Then we open the files in a text editor and inspect the contents so that we can recognize the lines we are interested in.</li><li class="listitem">Finally we write code that will convert the SVG lines of interest into Tkinter lists which we can use directly in our Python programs.</li></ol></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec01"/>Getting ready</h2></div></div></div><p>The first thing we need to do now is acquire and install a copy of Inkscape onto our computer. We will find this at<a class="ulink" href="http://www.inkscape.org/download/"> www.inkscape.org/download/</a> where there are versions for Linux and Microsoft Windows.<a id="id248" class="indexterm"/>
</p><p>The on-line documentation and tutorials for Inkscape are excellent. However, we want to use the minimum amount of Inkscape so this recipe is just that a few pointers to get the minimum task done.</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec02"/>How to do it...</h2></div></div></div><p>The only tool we need to use in Inkscape is the line-drawing pen as shown in the following screenshot. We drew a "Z" shape with this tool and saved the file as<code class="literal"> z_inkscape.svg</code>.<a id="id249" class="indexterm"/>
</p><p>The code produced, displayed in a text editor is shown after the screenshot:</p><div><img src="img/3845_09_01.jpg" width="186" alt="How to do it..."/></div><div><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
&lt;!-- Created with Inkscape (http://www.inkscape.org/) --&gt;
&lt;svg


version="1.1"
width="744.09448"
height="1052.3622"
id="svg3741"&gt;
&lt;defs
id="defs3743" /&gt;
&lt;g
id="layer1"&gt;
&lt;path
d="m 122.85714,89.50504 280,0 -280,45.71429 271.42857,0 "
id="path3751"
style="fill:none;stroke:#000000;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /&gt;
&lt;/g&gt;
&lt;/svg&gt;
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec03"/>How it works...</h2></div></div></div><p>Most of the preceding code is of no interest to us. It is the XML code that a web browser interprets in order to display a web page. Embedded within it, however, are SVG paths which we somehow want to transfer to Python so Tkinter can display it as a drawn shape.<a id="id250" class="indexterm"/>
</p><p>The portion we are interested in is the paragraph starting with<code class="literal">&lt;path</code> as this is the SVG format description of the "Z" shape that was drawn with the pen tool. This is the section of code:</p><div><pre class="programlisting">&lt;path
d="m 122.85714,89.50504 280,0 -280,45.71429 271.42857,0 " id="path3751"
style="fill:none;stroke:#000000;stroke-width:1px;stroke- linecap:butt;stroke-linejoin:miter;stroke-opacity:1" /&gt;
</pre></div><p>This is the whole SVG description of the 'Zorro' sign and the following line, has been slightly simplified, by removing the decimal fractions, to improve readability:</p><div><pre class="programlisting">d="m 122, 89 280,0 -280,45 271,0"
</pre></div><p>This line is the equivalent of a group of Tkinter instructions that could be written:</p><div><pre class="programlisting">x0 = 122
y0 = 89
canvas.create_line(x0,y0, x0+280,y0+0, x0-280,y0+45, x0+271,y0,+0 )
</pre></div><p>The 'm' symbol is the SVG instruction "move-to" where the number of pixels moved are increments added to the coordinates of the previous point in the line except for the first point 122,89 which tells the pen where to begin.</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec04"/>There's more...</h2></div></div></div><p>We do not want to become SVG experts. We only want to know enough to be able to recognize graphic data which we can use in Python. In this spirit, a summary of a few of the most common SVG directives is given here.</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">m x,y</code> is the "move-to" instruction which moves the pen to the point<code class="literal"> x,y</code> without drawing a line.<a id="id251" class="indexterm"/></li><li class="listitem" style="list-style-type: disc"><code class="literal">m x0,y0 x1,y1 x2,y2</code> will draw a line from<code class="literal"> x0,y0</code> to<code class="literal"> x1,y1</code> and then another segment from<code class="literal"> x1,y1</code> to<code class="literal"> x2, y2</code>. Note that the SVG interpreter only interprets the first point<code class="literal"> x0,y0</code> as a "move-to" but interprets subsequent pairs of points as "line-to". "line-to" is an instruction to put the tip of the pen onto the surface and draw.</li><li class="listitem" style="list-style-type: disc"><code class="literal">m x0,y0 x1,y1 x2,y2</code> will draw a line from<code class="literal"> x0,y0</code> to<code class="literal"> x0+x1,y0+y1</code> and then another segment from<code class="literal"> x0+x1,y0+y1</code> to<code class="literal"> x0+x2,y0+y2</code>.<p>The point to note is that the use of lower case is significant and is telling the SVG interpreter to calculate the coordinates as increment values that must be added to the previous location. As with the m directive the pen moves to the first point x0,y0 without drawing anything, but all subsequent points are drawn as segments joining adjacent points.
</p></li><li class="listitem" style="list-style-type: disc"><code class="literal">l x,y</code> commands the pen to draw a line from wherever the pen happens to be now to the point<code class="literal"> x,y</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">l x,y</code> commands the pen to draw a line from the current pen position (x0,y0 for instance) to the point<code class="literal"> x0 + x, y0 + y</code>.</li><li class="listitem" style="list-style-type: disc"><code class="literal">z</code> at the end of a list of path coordinates will close the path by drawing a line from the current point back to the start point.</li></ul></div><div><div><div><div><h3 class="title"><a id="ch09lvl3sec01"/>SVG code for separate paths</h3></div></div></div><p>Separate paths each get their own<code class="literal">&lt;path innards-of the path /&gt;</code> code.</p><p>Thus the SVG code for three separate paths could be as follows:</p><div><pre class="programlisting">&lt;path
d="M 125,100 340,149 340,100"
id="path3000"
style="style-descriptors" /&gt;
&lt;path
d="m 128,258 0,137 148,0 0,-145 -148,8 z"
id="path3001"
style="style-descriptors" /&gt;
&lt;path
d="m 114,629 0,-134 0,122 102,0 0,-134 105,0 0,120 82,0 0,-114"
id="path3002"
style="style-descriptors " /&gt;
</pre></div><p>Our interest is in the three lines starting from<code class="literal"> d=</code> because these give the strings of<code class="literal"> x,y</code> pairs that give the location of points on a drawn shape. The high degree of arithmetic precision is redundant because Tkinter will only use the integer part. However, if we needed to scale the picture up by multiplying each number by an amplification factor then the high arithmetic precision would avoid a small amount of distortion of the shape.<a id="id252" class="indexterm"/>
</p></div></div></div></div>


  <div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec03"/>Tracing the shape of an image in Inkscape</h1></div></div></div><p>We want to use Inkscape to capture a complex series of shapes ones that would be tedious and difficult to draw with pencil and paper. A practical example of the use of this could be that you may want to paint a picture of an elephant and you need some reliable guidelines, based on a magazine picture or photograph, for the outlines of the limbs and body. One way is to draw a grid on the picture with a pencil and ruler, then repeat a scaled version of the grid on blank canvas and finally to draw the outlines with a lead pencil. An alternative method is to pull a<code class="literal"> JPG, GIF, PNG, BMP</code>, or<code class="literal"> TIFF</code> image of the elephant into Inkscape and trace a series of lines over it using the pen tool. These outlines can be printed and traced onto your canvas. These same shapes can be used in Python with Tkinter.<a id="id253" class="indexterm"/>
</p><p>There are other ways of converting raster images to SVG paths but they require a fair amount of pre-conditioning of the images such as color separation and converting continuous grey scales into pure black and white. The method shown below allows us to decide exactly what path our line must follow even when the original image presents many subtle and ambiguous choices.</p><div><div><div><div><h2 class="title"><a id="ch09lvl2sec05"/>Getting ready</h2></div></div></div><p>Place the image we are going to work on in a convenient folder. We use<code class="literal"> /constr/pics1</code> in this recipe.</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec06"/>How to do it...</h2></div></div></div><div><ol class="orderedlist"><li class="listitem">Open Inkscape and select<strong> File</strong> |<strong> Open</strong>.<a id="id254" class="indexterm"/><div><img src="img/3845_09_02.jpg" width="168" alt="How to do it..."/></div></li><li class="listitem">Select the image you want to work on.<div><img src="img/3845_09_03.jpg" height="220" alt="How to do it..."/></div></li><li class="listitem">Add a new layer. This allows us to draw lines on one layer without interfering with the background layer that contains the photographic image.<div><img src="img/3845_09_04.jpg" width="300" alt="How to do it..."/></div></li><li class="listitem">Magnify the image to make it easier to see where to place the pen tool. This also improves the accuracy of the traced path we will make.<a id="id255" class="indexterm"/><p>We do this by clicking on the magnifying glass icon on the left border toolbar and then clicking on the zoom-in magnifying glass with the plus symbol inside it. This is in the toolbar that appears on the top border.
</p><div><img src="img/3845_09_05.jpg" height="185" alt="How to do it..."/></div></li><li class="listitem">Click on the pen tool on the left border toolbar and follow the path on the picture that we want to capture, save, and eventually convert to a Tkinter form.<div><img src="img/3845_09_06.jpg" width="276" alt="How to do it..."/></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: none">Note that Inkscape allows us to shift the picture around and zoom in or out without interrupting the action of tracing a line. Then we can start clicking on points along a selected path in the image and move the mouse pointer across to a scroll bar or a zoom icon and move or click on them. Tkinter temporarily suspends the actions of the pen tool while the pointer is outside the drawing area.<p>Another convenient feature is that if we mistakenly click the mouse in the wrong position, we can wipe out this mistake by hitting the Delete key ("del") on the keyboard once. This will undo the last click position on the line being traced.
<a id="id256" class="indexterm"/>
</p><p>If we wish to re-position any of the points on a completed line, this can be done using the point-editing tool which is the second from the top along the left border toolbar.
</p></li></ul></div><div><img src="img/3845_09_07.jpg" width="126" alt="How to do it..."/></div></li><li class="listitem">At the final point of each separate path, the pen tool must be double-clicked. This ends the drawing of that particular path and puts the pen away. For the next line, we need to click on the pen icon in the toolbar once again.</li><li class="listitem">A full set of traces of the lines of interest is shown in the following screenshot:<div><img src="img/3845_09_08.jpg" width="255" alt="How to do it..."/></div></li><li class="listitem">Now we save our work as a SVG format file.<a id="id257" class="indexterm"/><p>To extract the SVG paths for conversion to Tkinter lines, we just open a text editor, and then open the SVG format file we have just saved in the editor. This file is an XML text file with some SVG code inside it as explained in the first recipe of this chapter. The pieces we are interested in are lines that start as follows:
</p><div><pre class="programlisting">d="m 1 ...
</pre></div><p>The next recipe gives the Python code to convert the SVG paths into Tkinter lines and display them for confirmation.
</p></li></ol></div></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec07"/>How often do we need to click the mouse?</h2></div></div></div><p>As soon as we start the activity of tracing a line, we discover that we have to exercise discretion about how often to left-click the mouse to create a new point. You will get best accuracy with many points and the least fidelity with the fewest of points. We will be surprised at how only a few numbers of points are needed to represent our shapes with acceptable fidelity.</p><p>This is due to the magic of the<code class="literal"> smooth='true'</code> attribute in the Tkinter smooth line function:canvas_1.create_line(Q,<code class="literal"> fill='green', smooth='true')</code> as shown in the next recipe.</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec08"/>Another way to get SVG paths from raster images</h2></div></div></div><p>Another way to get SVG vector code from raster images is to use the trace path and path-simplify tools of Inkscape.</p></div></div></div>


  <div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec04"/>Converting an SVG path into a Tkinter Line</h1></div></div></div><p>We take long and complex Inkscape-traced paths that are SVG encoded and convert them into Tkinter lines that can be displayed using methods like<code class="literal"> canvas.create_line(x0,y0, x1,y1, x2,y2, ...)</code>.<a id="id258" class="indexterm"/>
</p><p>The following program takes a slightly edited form of a SVG path and transforms it into a form usable in a<code class="literal"> Tkintercreate_line()</code> function.<a id="id259" class="indexterm"/>
</p><p>To do this we need to exchange the single space characters that separate pairs of coordinates and replace them with commas.</p><p>At the same time, we want to convert the incremental coordinate values used by the SVG path into absolute values by adding the increment value to the corresponding previous value.</p><div><div><div><div><h2 class="title"><a id="ch09lvl2sec09"/>Getting ready</h2></div></div></div><p>A typical SVG path for a 5-point line is shown below:</p><p>
<code class="literal">d="m 128,258 0,137 148,0 0,-145 -148,8 z"</code>
</p><p>In a text editor, it is easy to make some substitutions to convert it to the form of a list<code class="literal"> a = "[128,258 0,137 148,0 0,-145 -148,8] "</code>
</p><p>These lists of numbers can be hundreds of lines long so we want to automate the tedious and error-prone job of exchanging each space with a comma and followed by the arithmetic of replacing the incremental values with absolute ones. That is what the code does.</p><p>This program uses one of the previous traced lines from Inkscape and inserts the commas and does the arithmetic to get the list of coordinates needed for<code class="literal"> canvas.create_line(x0,y0, x1,y1, x2,y2, ...)</code>.</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec10"/>How to do it...</h2></div></div></div><p>Execute the code below in the usual way.</p><div><pre class="programlisting"># spaces_for_commas_svg2tkinter_1.py
# &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
fromTkinter import *
root = Tk()
root.title("Conversion of SVG paths to Tkintercreate_line()")
cw = 1000 # canvas width.
ch = 800 # canvas height.
canvas_1 = Canvas(root, width=cw, height=ch, background="white")
canvas_1.grid(row=0, column=1)
tkint_line = []
svg_line_coords = '1551.2964,83.663208 -92.9426,0 -64.2149,28.727712 -13.5189,32.10744\
37.177,43.9365 65.9048,27.03785 82.8034,5.06959 82.8034,-11.82906\
45.6264,-30.41757 -3.3798,-38.86691 -72.6642,-42.246629 -59.1453,-11.829058'
# replace each space with a comma. b is a string
Tkinter LineSVG path, converting tob = svg_line_coords.replace(' ', ',')
# separates string b, at each comma, into a list.
c = b.split(',')
# Convert string elements into a floating point number list.
p= len(c)
for i in range(0,p):
tkint_line.append(float(c[i]))
# Add incremental coordinates to the previous value
for i in range(0, p-2):
# Add the increment to the value two positions back
# because two positions separate each x and each y.
tkint_line[i +2] = tkint_line[i +2] + tkint_line[i]
# Scale it to a convenient size
for i in range(0,len(tkint_line)):
tkint_line[i] =int((tkint_line[i]+1)/ 2)
canvas_1.create_line(tkint_line, fill='green', smooth='true')
root.mainloop()
</pre></div></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec11"/>How it works...</h2></div></div></div><p>To keep the code simple and short, we placed the slightly edited form of the SVG path into the Python code as shown in the line beginning:<a id="id261" class="indexterm"/>
</p><p>
<code class="literal">a ='1551.2964,83.663208 ...</code>.</p><p>The code does four essential things:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">It places commas wherever it finds a space in the SVG path string.</li><li class="listitem" style="list-style-type: disc">It splits a single string, at every comma, into a list of separate string elements.</li><li class="listitem" style="list-style-type: disc">It converts each element into a floating point number.</li><li class="listitem" style="list-style-type: disc">It does the arithmetic of adding each element to the one preceding it by two positions. The x-coordinates alternate with y-coordinates so to add an x-value to the previous x-value; we need to skip over the y-values in between.</li></ul></div><p>The modified SVG path is transformed into a Python list that can be used directly in the line:<code class="literal"> canvas_1.create_line(Q, fill='green', smooth='true')</code>, to draw it on the canvas.</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec12"/>There's more...</h2></div></div></div><p>When the other seven Inkscaped-lines from<code class="literal"> table_glass_vase_inkscape.svg</code> are transformed in the same way, we get the results as shown in the following screenshot:</p><div><img src="img/3845_09_09.jpg" height="186" alt="There's more..."/></div><div><div><div><div><h3 class="title"><a id="ch09lvl3sec02"/>How far should we go with image conversion code?</h3></div></div></div><p>We have tried to keep the code simple and brief. We could have put a lot more effort into automating the slight editing that we did in a text editor to remove the<code class="literal"> m</code> and place square brackets just inside the quotation marks.</p></div><div><div><div><div><h3 class="title"><a id="ch09lvl3sec03"/>Another way to get SVG paths from raster images</h3></div></div></div><p>Another method of extracting SVG paths from raster images is to use the Path, Trace Bitmap tool followed by the Path, and simplify tools in Inkscape. This method does not work well with complex images such as the one of the transparent glass vase we have used here. It works best with simple black and white images. The Inkscape tool is based on another tool called<strong> potrace</strong> which has its own interface called<strong> potracegui</strong>. The problem with the potrace tool is you first have to convert your image into bitmap-type formats. The method we have used in this chapter allows us to make very specific choices about which particular lines we want to use no matter how complex the<a id="id262" class="indexterm"/>
</p></div></div></div></div>
</body></html>