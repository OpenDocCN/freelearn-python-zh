<html><head></head><body>
  <div class="Basic-Text-Frame" id="_idContainer209">
   <h1 class="chapterNumber">
    <span class="koboSpan" id="kobo.1.1">
     13
    </span>
   </h1>
   <h1 class="chapterTitle" id="_idParaDest-330">
    <span class="koboSpan" id="kobo.2.1">
     Data Science in Brief
    </span>
   </h1>
   <blockquote class="packt_quote">
    <p class="quote">
     <span class="koboSpan" id="kobo.3.1">
      ”If we have data, let’s look at data.
     </span>
     <span class="koboSpan" id="kobo.3.2">
      If all we have are opinions, let’s go with mine.”
     </span>
    </p>
    <p class="cite">
     <span class="koboSpan" id="kobo.4.1">
      — Jim Barksdale, former Netscape CEO
     </span>
    </p>
   </blockquote>
   <p class="normal">
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.5.1">
      Data science
     </span>
    </strong>
    <span class="koboSpan" id="kobo.6.1">
     is a
    </span>
    <a id="_idIndexMarker1125">
    </a>
    <span class="koboSpan" id="kobo.7.1">
     broad term that can have different meanings depending on the context, understanding, and tools, amongst other factors.
    </span>
    <span class="koboSpan" id="kobo.7.2">
     To do proper data science, you need to, at the very least, know mathematics and statistics.
    </span>
    <span class="koboSpan" id="kobo.7.3">
     Then, you may want to dig into other subjects, such as pattern recognition and machine learning, and, of course, there is a plethora of languages and tools you can use.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.8.1">
     We will not be able to talk about everything here.
    </span>
    <span class="koboSpan" id="kobo.8.2">
     Therefore, to render this chapter meaningful, we are going to work on a project together instead.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.9.1">
     Around 2012/2013, Fabrizio was working for a top-tier social media company in London.
    </span>
    <span class="koboSpan" id="kobo.9.2">
     He stayed there for two years and was privileged to work with several very brilliant people.
    </span>
    <span class="koboSpan" id="kobo.9.3">
     The company was the first in the world to have access to the Twitter Ads API, and they were partners with Facebook as well.
    </span>
    <span class="koboSpan" id="kobo.9.4">
     That means a lot of data.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.10.1">
     Their analysts were dealing with a vast number of campaigns, and they were struggling with the amount of work they had to do, so the development team Fabrizio was a part of tried to help by introducing them to Python and to the tools Python gives us to deal with data.
    </span>
    <span class="koboSpan" id="kobo.10.2">
     It was an interesting journey that led him to mentor several people in the company, eventually taking him to Manila, where he gave a two-week intensive training course in Python and data science to the analysts over there.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.11.1">
     The project we are going to do in this chapter is a lightweight version of the final example Fabrizio presented to his students in Manila.
    </span>
    <span class="koboSpan" id="kobo.11.2">
     We have rewritten it to a size that will fit this chapter and made a few adjustments here and there for teaching purposes, but all the main concepts are there, so it should be fun and instructional for you.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.12.1">
     Specifically, we are going to explore the following:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.13.1">
      The Jupyter Notebook and JupyterLab
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.14.1">
      pandas and NumPy: the main libraries for data science in Python
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.15.1">
      A few concepts around pandas’s
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.16.1">
       DataFrame
      </span>
     </code>
     <span class="koboSpan" id="kobo.17.1">
      class
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.18.1">
      Creating and manipulating a dataset
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.19.1">
     Let us start by talking about Roman gods.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-331">
    <span class="koboSpan" id="kobo.20.1">
     IPython and Jupyter Notebook
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.21.1">
     In 2001, Fernando Perez was a graduate student in physics at CU Boulder and was trying to improve the Python shell so that he could have the niceties he was used to when working with tools such as Mathematica and Maple.
    </span>
    <span class="koboSpan" id="kobo.21.2">
     The result of these efforts
    </span>
    <a id="_idIndexMarker1126">
    </a>
    <span class="koboSpan" id="kobo.22.1">
     took the name
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.23.1">
      IPython
     </span>
    </strong>
    <span class="koboSpan" id="kobo.24.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.25.1">
     That small script began as an enhanced version of the Python shell and, through the efforts of other coders and eventually with funding from several different companies, it became the successful project it is today.
    </span>
    <span class="koboSpan" id="kobo.25.2">
     Some 10 years after its birth, a Notebook environment was created, powered by technologies such as WebSockets, the Tornado web server, jQuery, CodeMirror, and MathJax.
    </span>
    <span class="koboSpan" id="kobo.25.3">
     The ZeroMQ library was also used to handle the messages between the Notebook interface and the Python core that lies behind it.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.26.1">
     The IPython Notebook became so popular and widely used that, over time, numerous features were added to it.
    </span>
    <span class="koboSpan" id="kobo.26.2">
     It can handle widgets, parallel computing, various media formats, and much more.
    </span>
    <span class="koboSpan" id="kobo.26.3">
     Moreover, at some point, it became possible to code in languages other than Python from within the Notebook.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.27.1">
     Eventually, the project was split into two: IPython has been stripped down to focus more on the kernel and the shell, while the Notebook has become a new project called
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.28.1">
      Jupyter
     </span>
    </strong>
    <span class="koboSpan" id="kobo.29.1">
     .
    </span>
    <span class="koboSpan" id="kobo.29.2">
     Jupyter
    </span>
    <a id="_idIndexMarker1127">
    </a>
    <span class="koboSpan" id="kobo.30.1">
     allows interactive scientific computations to be done in more than 40 languages.
    </span>
    <span class="koboSpan" id="kobo.30.2">
     More recently, the Jupyter project has
    </span>
    <a id="_idIndexMarker1128">
    </a>
    <span class="koboSpan" id="kobo.31.1">
     created
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.32.1">
      JupyterLab
     </span>
    </strong>
    <span class="koboSpan" id="kobo.33.1">
     , a web-based
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.34.1">
      IDE
     </span>
    </strong>
    <span class="koboSpan" id="kobo.35.1">
     incorporating Jupyter notebooks, interactive consoles, a code editor, and more.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.36.1">
     This chapter’s project
    </span>
    <a id="_idIndexMarker1129">
    </a>
    <span class="koboSpan" id="kobo.37.1">
     will all be coded and run in a Jupyter Notebook, so let us briefly explain what a Notebook is.
    </span>
    <span class="koboSpan" id="kobo.37.2">
     A Notebook environment is a web page that exposes a simple menu and cells in which you can run Python code.
    </span>
    <span class="koboSpan" id="kobo.37.3">
     Even though the cells are separate entities that you can run individually, they all share the same Python kernel.
    </span>
    <span class="koboSpan" id="kobo.37.4">
     This means that all the names that you define in one cell (the variables, functions, and so on) will be available in any other cell.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.38.1">
      Simply put, a Python kernel is a process in which Python is running.
     </span>
     <span class="koboSpan" id="kobo.38.2">
      The Notebook web page is an interface exposed to the user for driving this kernel.
     </span>
     <span class="koboSpan" id="kobo.38.3">
      The web page communicates with it using a fast messaging system.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.39.1">
     Apart from all the graphical advantages, the beauty of having such an environment lies in the ability to run a Python script in chunks, and this can be a tremendous advantage.
    </span>
    <span class="koboSpan" id="kobo.39.2">
     Take a script that connects to a database to fetch data and then manipulates that data.
    </span>
    <span class="koboSpan" id="kobo.39.3">
     If you do it in the conventional way, with a Python script, you have to fetch the data every time you want to experiment with it.
    </span>
    <span class="koboSpan" id="kobo.39.4">
     Within a Notebook environment, you can fetch the data in one cell and then manipulate and experiment with it in other cells, so fetching it every time is not necessary.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.40.1">
     The Notebook environment is also helpful for data science because it allows for the step-by-step inspection of results.
    </span>
    <span class="koboSpan" id="kobo.40.2">
     You do one chunk of work and then verify it.
    </span>
    <span class="koboSpan" id="kobo.40.3">
     You then do another chunk and verify again, and so on.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.41.1">
     It is also invaluable
    </span>
    <a id="_idIndexMarker1130">
    </a>
    <span class="koboSpan" id="kobo.42.1">
     for prototyping because the results are there, right in front of your eyes, immediately available.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.43.1">
     If you would like to know more about these tools, please check out
    </span>
    <a href="http://ipython.org">
     <span class="url">
      <span class="koboSpan" id="kobo.44.1">
       ipython.org
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.45.1">
     and
    </span>
    <a href="http://jupyter.org">
     <span class="url">
      <span class="koboSpan" id="kobo.46.1">
       jupyter.org
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.47.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.48.1">
     We have created a simple example Notebook with a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.49.1">
      fibonacci()
     </span>
    </code>
    <span class="koboSpan" id="kobo.50.1">
     function that gives you a list of all the Fibonacci numbers smaller than a given
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.51.1">
      N
     </span>
    </code>
    <span class="koboSpan" id="kobo.52.1">
     .
    </span>
    <span class="koboSpan" id="kobo.52.2">
     It looks like this:
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.53.1">
     <img alt="img" src="../Images/B30992_13_01.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.54.1">
     Figure 13.1: A Jupyter Notebook
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.55.1">
     Every cell has a label in square brackets, like
    </span>
    <strong class="screenText">
     <span class="koboSpan" id="kobo.56.1">
      [1]
     </span>
    </strong>
    <span class="koboSpan" id="kobo.57.1">
     .
    </span>
    <span class="koboSpan" id="kobo.57.2">
     If there is nothing between the brackets, it means that the cell has never been executed.
    </span>
    <span class="koboSpan" id="kobo.57.3">
     If there is a number, it means that the cell has been executed, and the number represents the order in which the cell was executed.
    </span>
    <span class="koboSpan" id="kobo.57.4">
     An asterisk, like
    </span>
    <strong class="screenText">
     <span class="koboSpan" id="kobo.58.1">
      *
     </span>
    </strong>
    <span class="koboSpan" id="kobo.59.1">
     , means that the cell is currently being executed.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.60.1">
     You can see in the screenshot that in the first cell we have defined the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.61.1">
      fibonacci()
     </span>
    </code>
    <span class="koboSpan" id="kobo.62.1">
     function and executed it.
    </span>
    <span class="koboSpan" id="kobo.62.2">
     This has the effect of placing the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.63.1">
      fibonacci
     </span>
    </code>
    <span class="koboSpan" id="kobo.64.1">
     name in the global scope associated with the Notebook, and therefore the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.65.1">
      fibonacci()
     </span>
    </code>
    <span class="koboSpan" id="kobo.66.1">
     function is now available to the other cells as well.
    </span>
    <span class="koboSpan" id="kobo.66.2">
     In fact, in the second cell, we can run
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.67.1">
      list(fibonacci(100))
     </span>
    </code>
    <span class="koboSpan" id="kobo.68.1">
     and see the results output below cell
    </span>
    <strong class="screenText">
     <span class="koboSpan" id="kobo.69.1">
      [2]
     </span>
    </strong>
    <span class="koboSpan" id="kobo.70.1">
     (the output for each cell is labeled with the same number as the cell itself).
    </span>
    <span class="koboSpan" id="kobo.70.2">
     In the third cell, we have
    </span>
    <a id="_idIndexMarker1131">
    </a>
    <span class="koboSpan" id="kobo.71.1">
     shown you one of the several “magic” functions you can find in a Notebook:
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.72.1">
      %timeit
     </span>
    </code>
    <span class="koboSpan" id="kobo.73.1">
     runs the code several times and provides you with a benchmark for it (this is implemented using the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.74.1">
      timeit
     </span>
    </code>
    <span class="koboSpan" id="kobo.75.1">
     module, which we briefly introduced in
    </span>
    <em class="chapterRef">
     <span class="koboSpan" id="kobo.76.1">
      Chapter 11, Debugging and Profiling
     </span>
    </em>
    <span class="koboSpan" id="kobo.77.1">
     ).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.78.1">
     You can execute a cell as many times as you want and change the order in which you run them.
    </span>
    <span class="koboSpan" id="kobo.78.2">
     Cells are very versatile: you can also have Raw cells, which contain plain text, or Markdown cells, which are useful for adding formatted textual explanations or headings.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.79.1">
       Markdown
      </span>
     </strong>
     <span class="koboSpan" id="kobo.80.1">
      is a
     </span>
     <a id="_idIndexMarker1132">
     </a>
     <span class="koboSpan" id="kobo.81.1">
      lightweight markup language with plain text formatting syntax designed so that it can be converted to HTML and many other formats.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.82.1">
     Another useful feature is that whatever you place in the last line of a cell will automatically be printed for you.
    </span>
    <span class="koboSpan" id="kobo.82.2">
     This means you are not forced to explicitly write
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.83.1">
      print(…)
     </span>
    </code>
    <span class="koboSpan" id="kobo.84.1">
     every time you want to inspect a value.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-332">
    <span class="koboSpan" id="kobo.85.1">
     Using Anaconda
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.86.1">
     As usual, you
    </span>
    <a id="_idIndexMarker1133">
    </a>
    <span class="koboSpan" id="kobo.87.1">
     can install the libraries required for this chapter using the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.88.1">
      requirements.txt
     </span>
    </code>
    <span class="koboSpan" id="kobo.89.1">
     file in the source code for the chapter.
    </span>
    <span class="koboSpan" id="kobo.89.2">
     Sometimes, however, installing data science libraries can be quite painful.
    </span>
    <span class="koboSpan" id="kobo.89.3">
     If you are struggling to install the libraries for this chapter in your virtual environment, you could install Anaconda instead.
    </span>
    <span class="koboSpan" id="kobo.89.4">
     Anaconda is a free and open-source distribution of the Python and R programming languages for data science and machine learning-related applications, which aims to simplify package management and deployment.
    </span>
    <span class="koboSpan" id="kobo.89.5">
     You can download it from the
    </span>
    <a href="http://anaconda.org">
     <span class="url">
      <span class="koboSpan" id="kobo.90.1">
       anaconda.org
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.91.1">
     website.
    </span>
    <span class="koboSpan" id="kobo.91.2">
     Once you have installed it, you can use the Anaconda interface to create a virtual environment and install the
    </span>
    <a id="_idIndexMarker1134">
    </a>
    <span class="koboSpan" id="kobo.92.1">
     packages listed in the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.93.1">
      requirements.in
     </span>
    </code>
    <span class="koboSpan" id="kobo.94.1">
     file, which you can also find in the source code for the chapter.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-333">
    <span class="koboSpan" id="kobo.95.1">
     Starting a Notebook
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.96.1">
     Once
    </span>
    <a id="_idIndexMarker1135">
    </a>
    <span class="koboSpan" id="kobo.97.1">
     you have all the required libraries installed, you can start a Notebook with the following command:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.98.1">$ jupyter notebook
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.99.1">
     If you install the requirements via Anaconda, you can also launch the Notebook from the Anaconda interface.
    </span>
    <span class="koboSpan" id="kobo.99.2">
     In either case, you will have an open page in your web browser at this address (the port might be different):
    </span>
    <a href="http://localhost:8888/">
     <span class="url">
      <span class="koboSpan" id="kobo.100.1">
       http://localhost:8888/
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.101.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.102.1">
     You can also launch JupyterLab from Anaconda, or with the following command:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.103.1">$ jupyter lab
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.104.1">
     It will also open as a new page in your web browser.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.105.1">
     Explore both interfaces.
    </span>
    <span class="koboSpan" id="kobo.105.2">
     Create a new Notebook or open the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.106.1">
      example.ipynb
     </span>
    </code>
    <span class="koboSpan" id="kobo.107.1">
     Notebook we showed you above.
    </span>
    <span class="koboSpan" id="kobo.107.2">
     See which interface you prefer and get comfortable with it before proceeding with the rest of the chapter.
    </span>
    <span class="koboSpan" id="kobo.107.3">
     We have included a saved JupyterLab workspace containing the Notebooks used in the rest of this chapter in the source code for the chapter (the file is called
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.108.1">
      ch13.jupyterlab-workspace
     </span>
    </code>
    <span class="koboSpan" id="kobo.109.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.109.2">
     You can use that to follow along in JupyterLab or stick to the classic Notebook interface if you prefer.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.110.1">
     Alternatively, if you use a modern IDE to follow the chapter’s example, it’s likely you will be able to install a plugin to work with a notebook directly from inside the IDE.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.111.1">
     To help you follow along, we will tag each code example in this chapter with the Notebook cell number it belongs to.
    </span>
   </p>
   <div class="packt_tip">
    <p class="normal">
     <span class="koboSpan" id="kobo.112.1">
      If you familiarize yourself with the keyboard shortcuts (look in the classic Notebook
     </span>
     <strong class="screenText">
      <span class="koboSpan" id="kobo.113.1">
       Help
      </span>
     </strong>
     <span class="koboSpan" id="kobo.114.1">
      menu or the
     </span>
     <strong class="screenText">
      <span class="koboSpan" id="kobo.115.1">
       Settings Editor
      </span>
     </strong>
     <span class="koboSpan" id="kobo.116.1">
      in JupyterLab), you will be able to move between cells and handle their content without having to reach for the mouse.
     </span>
     <span class="koboSpan" id="kobo.116.2">
      This will make you much faster when you work in a Notebook.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.117.1">
     Let us now
    </span>
    <a id="_idIndexMarker1136">
    </a>
    <span class="koboSpan" id="kobo.118.1">
     move on and talk about the most interesting part of this chapter: data.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-334">
    <span class="koboSpan" id="kobo.119.1">
     Dealing with data
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.120.1">
     Typically, when
    </span>
    <a id="_idIndexMarker1137">
    </a>
    <span class="koboSpan" id="kobo.121.1">
     you deal with data, this is the path you go through: you fetch it; you clean and manipulate it; and then you analyze it and present results as values, spreadsheets, graphs, and so on.
    </span>
    <span class="koboSpan" id="kobo.121.2">
     We want you to be able to perform all three steps of the process without having any external dependency on a data provider, so we are going to do the following:
    </span>
   </p>
   <ol>
    <li class="numberedList" value="1">
     <span class="koboSpan" id="kobo.122.1">
      Create the data, simulating that it comes in a format that is not perfect or ready to be worked on.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.123.1">
      Clean it and feed it to the main tool we will use in the project, which is a
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.124.1">
       DataFrame
      </span>
     </code>
     <span class="koboSpan" id="kobo.125.1">
      from the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.126.1">
       pandas
      </span>
     </code>
     <span class="koboSpan" id="kobo.127.1">
      library.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.128.1">
      Manipulate the data in a
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.129.1">
       DataFrame
      </span>
     </code>
     <span class="koboSpan" id="kobo.130.1">
      .
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.131.1">
      Save a
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.132.1">
       DataFrame
      </span>
     </code>
     <span class="koboSpan" id="kobo.133.1">
      to a file in different formats.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.134.1">
      Analyze the data and get some results out of it.
     </span>
    </li>
   </ol>
   <h2 class="heading-2" id="_idParaDest-335">
    <span class="koboSpan" id="kobo.135.1">
     Setting up the Notebook
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.136.1">
     First, let
    </span>
    <a id="_idIndexMarker1138">
    </a>
    <span class="koboSpan" id="kobo.137.1">
     us produce the data.
    </span>
    <span class="koboSpan" id="kobo.137.2">
     We start from the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.138.1">
      ch13-dataprep
     </span>
    </code>
    <span class="koboSpan" id="kobo.139.1">
     Notebook.
    </span>
    <span class="koboSpan" id="kobo.139.2">
     Cell
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.140.1">
      #1
     </span>
    </code>
    <span class="koboSpan" id="kobo.141.1">
     takes care of the imports:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.142.1">#1</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.143.1">import</span></span><span class="koboSpan" id="kobo.144.1"> json
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.145.1">import</span></span><span class="koboSpan" id="kobo.146.1"> random
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.147.1">from</span></span><span class="koboSpan" id="kobo.148.1"> datetime </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.149.1">import</span></span><span class="koboSpan" id="kobo.150.1"> date, timedelta
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.151.1">import</span></span><span class="koboSpan" id="kobo.152.1"> faker
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.153.1">
     The only modules we have not already encountered are
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.154.1">
      random
     </span>
    </code>
    <span class="koboSpan" id="kobo.155.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.156.1">
      faker
     </span>
    </code>
    <span class="koboSpan" id="kobo.157.1">
     .
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.158.1">
      random
     </span>
    </code>
    <span class="koboSpan" id="kobo.159.1">
     is a standard library module for generating pseudo-random numbers.
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.160.1">
      faker
     </span>
    </code>
    <span class="koboSpan" id="kobo.161.1">
     is a third-party module for generating fake data.
    </span>
    <span class="koboSpan" id="kobo.161.2">
     It is particularly useful in tests, when you
    </span>
    <a id="_idIndexMarker1139">
    </a>
    <span class="koboSpan" id="kobo.162.1">
     prepare your fixtures, to get all sorts of things such as names, email addresses, phone numbers, and credit card details.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-336">
    <span class="koboSpan" id="kobo.163.1">
     Preparing the data
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.164.1">
     We want to
    </span>
    <a id="_idIndexMarker1140">
    </a>
    <span class="koboSpan" id="kobo.165.1">
     achieve the following data structure: we are going to have a list of user objects.
    </span>
    <span class="koboSpan" id="kobo.165.2">
     Each user object will be linked to several campaign objects.
    </span>
    <span class="koboSpan" id="kobo.165.3">
     In Python, everything is an object, so we are using this term in a generic way.
    </span>
    <span class="koboSpan" id="kobo.165.4">
     The user object may be a string, a dictionary, or something else.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.166.1">
     A
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.167.1">
      campaign
     </span>
    </strong>
    <span class="koboSpan" id="kobo.168.1">
     in
    </span>
    <a id="_idIndexMarker1141">
    </a>
    <span class="koboSpan" id="kobo.169.1">
     the social media world is a promotional campaign that a media agency runs on social media networks on behalf of a client.
    </span>
    <span class="koboSpan" id="kobo.169.2">
     Remember that we are going to prepare this data so that it is not in perfect shape.
    </span>
    <span class="koboSpan" id="kobo.169.3">
     Firstly, we instantiate the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.170.1">
      Faker
     </span>
    </code>
    <span class="koboSpan" id="kobo.171.1">
     that we will use to create the data:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.172.1">#2</span></span><span class="koboSpan" id="kobo.173.1">
fake = faker.Faker()
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.174.1">
     This will internally keep track of values that have been generated and only yield unique values.
    </span>
    <span class="koboSpan" id="kobo.174.2">
     We use a list comprehension to generate 1,000 unique usernames.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.175.1">
     Next, we create a list of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.176.1">
      users
     </span>
    </code>
    <span class="koboSpan" id="kobo.177.1">
     .
    </span>
    <span class="koboSpan" id="kobo.177.2">
     We will generate 1,000
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.178.1">
      user
     </span>
    </code>
    <span class="koboSpan" id="kobo.179.1">
     dictionaries with details such as
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.180.1">
      username
     </span>
    </code>
    <span class="koboSpan" id="kobo.181.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.182.1">
      name
     </span>
    </code>
    <span class="koboSpan" id="kobo.183.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.184.1">
      gender
     </span>
    </code>
    <span class="koboSpan" id="kobo.185.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.186.1">
      email
     </span>
    </code>
    <span class="koboSpan" id="kobo.187.1">
     .
    </span>
    <span class="koboSpan" id="kobo.187.2">
     Each
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.188.1">
      user
     </span>
    </code>
    <span class="koboSpan" id="kobo.189.1">
     dictionary is then dumped to JSON and added to the list.
    </span>
    <span class="koboSpan" id="kobo.189.2">
     This data structure is not optimal, of course, but we are simulating a scenario where users come to us like that.
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.190.1">#3</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.191.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.192.1">get_users</span></span><span class="koboSpan" id="kobo.193.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.194.1">no_of_users</span></span><span class="koboSpan" id="kobo.195.1">):
    usernames = (
        fake.unique.user_name() </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.196.1">for</span></span><span class="koboSpan" id="kobo.197.1"> i </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.198.1">in</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.199.1">range</span></span><span class="koboSpan" id="kobo.200.1">(usernames_no)
    )
    genders = random.choices(
        [</span><span class="hljs-string"><span class="koboSpan" id="kobo.201.1">"M"</span></span><span class="koboSpan" id="kobo.202.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.203.1">"F"</span></span><span class="koboSpan" id="kobo.204.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.205.1">"O"</span></span><span class="koboSpan" id="kobo.206.1">], weights=[</span><span class="hljs-number"><span class="koboSpan" id="kobo.207.1">0.43</span></span><span class="koboSpan" id="kobo.208.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.209.1">0.47</span></span><span class="koboSpan" id="kobo.210.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.211.1">0.1</span></span><span class="koboSpan" id="kobo.212.1">], k=no_of_users
    )
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.213.1">for</span></span><span class="koboSpan" id="kobo.214.1"> username, gender </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.215.1">in</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.216.1">zip</span></span><span class="koboSpan" id="kobo.217.1">(usernames, genders):
        name = get_random_name(gender)
        user = {
            </span><span class="hljs-string"><span class="koboSpan" id="kobo.218.1">"username"</span></span><span class="koboSpan" id="kobo.219.1">: username,
            </span><span class="hljs-string"><span class="koboSpan" id="kobo.220.1">"name"</span></span><span class="koboSpan" id="kobo.221.1">: name,
            </span><span class="hljs-string"><span class="koboSpan" id="kobo.222.1">"gender"</span></span><span class="koboSpan" id="kobo.223.1">: gender,
            </span><span class="hljs-string"><span class="koboSpan" id="kobo.224.1">"email"</span></span><span class="koboSpan" id="kobo.225.1">: fake.email(),
            </span><span class="hljs-string"><span class="koboSpan" id="kobo.226.1">"age"</span></span><span class="koboSpan" id="kobo.227.1">: fake.random_int(</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.228.1">min</span></span><span class="koboSpan" id="kobo.229.1">=</span><span class="hljs-number"><span class="koboSpan" id="kobo.230.1">18</span></span><span class="koboSpan" id="kobo.231.1">, </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.232.1">max</span></span><span class="koboSpan" id="kobo.233.1">=</span><span class="hljs-number"><span class="koboSpan" id="kobo.234.1">90</span></span><span class="koboSpan" id="kobo.235.1">),
            </span><span class="hljs-string"><span class="koboSpan" id="kobo.236.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.237.1">address"</span></span><span class="koboSpan" id="kobo.238.1">: fake.address(),
        }
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.239.1">yield</span></span><span class="koboSpan" id="kobo.240.1"> json.dumps(user)
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.241.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.242.1">get_random_name</span></span><span class="koboSpan" id="kobo.243.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.244.1">gender</span></span><span class="koboSpan" id="kobo.245.1">):
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.246.1">match</span></span><span class="koboSpan" id="kobo.247.1"> gender:
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.248.1">case</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.249.1">"F"</span></span><span class="koboSpan" id="kobo.250.1">:
            name = fake.name_female()
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.251.1">case</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.252.1">"M"</span></span><span class="koboSpan" id="kobo.253.1">:
            name = fake.name_male()
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.254.1">case</span></span><span class="koboSpan" id="kobo.255.1"> _:
            name = fake.name_nonbinary()
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.256.1">return</span></span><span class="koboSpan" id="kobo.257.1"> name
users = get_users(</span><span class="hljs-number"><span class="koboSpan" id="kobo.258.1">1000</span></span><span class="koboSpan" id="kobo.259.1">)
users[:</span><span class="hljs-number"><span class="koboSpan" id="kobo.260.1">3</span></span><span class="koboSpan" id="kobo.261.1">]
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.262.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.263.1">
      get_users()
     </span>
    </code>
    <span class="koboSpan" id="kobo.264.1">
     generator
    </span>
    <a id="_idIndexMarker1142">
    </a>
    <span class="koboSpan" id="kobo.265.1">
     function takes the number of users to create as a parameter.
    </span>
    <span class="koboSpan" id="kobo.265.2">
     We use
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.266.1">
      fake.unique.user_name()
     </span>
    </code>
    <span class="koboSpan" id="kobo.267.1">
     in a generator expression to generate unique usernames.
    </span>
    <span class="koboSpan" id="kobo.267.2">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.268.1">
      fake.unique
     </span>
    </code>
    <span class="koboSpan" id="kobo.269.1">
     property keeps track of values that have been generated and yields only unique values.
    </span>
    <span class="koboSpan" id="kobo.269.2">
     Next, we call
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.270.1">
      random.choices()
     </span>
    </code>
    <span class="koboSpan" id="kobo.271.1">
     to generate a list of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.272.1">
      no_of_users
     </span>
    </code>
    <span class="koboSpan" id="kobo.273.1">
     random elements from the list
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.274.1">
      ["M", "F", "O"]
     </span>
    </code>
    <span class="koboSpan" id="kobo.275.1">
     (to represent male, female, or other genders).
    </span>
    <span class="koboSpan" id="kobo.275.2">
     The weights 0.43, 0.47, and 0.1 will ensure that roughly 43% of our users will be male, 47% female, and 10% will not identify as either male or female.
    </span>
    <span class="koboSpan" id="kobo.275.3">
     We use
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.276.1">
      zip()
     </span>
    </code>
    <span class="koboSpan" id="kobo.277.1">
     to iterate over the usernames and genders.
    </span>
    <span class="koboSpan" id="kobo.277.2">
     For each user, we call
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.278.1">
      get_random_name()
     </span>
    </code>
    <span class="koboSpan" id="kobo.279.1">
     , which uses a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.280.1">
      match
     </span>
    </code>
    <span class="koboSpan" id="kobo.281.1">
     statement to generate a gender-appropriate name, and then generate a fake email address, age, and address.
    </span>
    <span class="koboSpan" id="kobo.281.2">
     We dump the user data in a JSON string and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.282.1">
      yield
     </span>
    </code>
    <span class="koboSpan" id="kobo.283.1">
     it.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.284.1">
     Also note the last line in the cell.
    </span>
    <span class="koboSpan" id="kobo.284.2">
     Each cell automatically prints what is on the last line; therefore, the output of #3 is a list with the first three users:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.285.1"> [</span><span class="hljs-string"><span class="koboSpan" id="kobo.286.1">'{"username": "epennington", "name": "Stephanie Gonzalez", ...}'</span></span><span class="koboSpan" id="kobo.287.1">,
 </span><span class="hljs-string"><span class="koboSpan" id="kobo.288.1">'{"username": "joshua61", "name": "Diana Richards", ...}'</span></span><span class="koboSpan" id="kobo.289.1">,
 </span><span class="hljs-string"><span class="koboSpan" id="kobo.290.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.291.1">{"username": "dmoore", "name": "Erin Rose", "gender": "F",...}'</span></span><span class="koboSpan" id="kobo.292.1">]
</span></code></pre>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.293.1">
      We hope you are following along with your own Notebook.
     </span>
     <span class="koboSpan" id="kobo.293.2">
      If you are, please note that all data is generated using random functions and values; therefore, you will see different results.
     </span>
     <span class="koboSpan" id="kobo.293.3">
      They will change every time you execute the Notebook.
     </span>
     <span class="koboSpan" id="kobo.293.4">
      Also note that we have had to trim most of the output in this chapter to fit onto the page, so you will see a lot more output in your Notebook than we have reproduced here.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.294.1">
     Analysts use
    </span>
    <a id="_idIndexMarker1143">
    </a>
    <span class="koboSpan" id="kobo.295.1">
     spreadsheets all the time, and they create all sorts of coding techniques to compress as much information as possible into the campaign names.
    </span>
    <span class="koboSpan" id="kobo.295.2">
     The format we have chosen is a simple example of that technique—there is a code that tells us the campaign type, then the start and end dates, then the target
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.296.1">
      age
     </span>
    </code>
    <span class="koboSpan" id="kobo.297.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.298.1">
      gender
     </span>
    </code>
    <span class="koboSpan" id="kobo.299.1">
     (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.300.1">
      "M"
     </span>
    </code>
    <span class="koboSpan" id="kobo.301.1">
     for male,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.302.1">
      "F"
     </span>
    </code>
    <span class="koboSpan" id="kobo.303.1">
     for female, or
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.304.1">
      "A"
     </span>
    </code>
    <span class="koboSpan" id="kobo.305.1">
     for any), and finally the currency.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.306.1">
     All values are separated by an underscore.
    </span>
    <span class="koboSpan" id="kobo.306.2">
     The code to generate these campaign names can be found in cell
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.307.1">
      #4
     </span>
    </code>
    <span class="koboSpan" id="kobo.308.1">
     :
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.309.1">#4</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.310.1"># campaign name format:</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.311.1"># InternalType_StartDate_EndDate_TargetAge_TargetGender_Currency</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.312.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.313.1">get_type</span></span><span class="koboSpan" id="kobo.314.1">():
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.315.1"># just some meaningless example codes</span></span><span class="koboSpan" id="kobo.316.1">
    types = [</span><span class="hljs-string"><span class="koboSpan" id="kobo.317.1">"AKX"</span></span><span class="koboSpan" id="kobo.318.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.319.1">"BYU"</span></span><span class="koboSpan" id="kobo.320.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.321.1">"GRZ"</span></span><span class="koboSpan" id="kobo.322.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.323.1">"KTR"</span></span><span class="koboSpan" id="kobo.324.1">]
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.325.1">return</span></span><span class="koboSpan" id="kobo.326.1"> random.choice(types)
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.327.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.328.1">get_start_end_dates</span></span><span class="koboSpan" id="kobo.329.1">():
    duration = random.randint(</span><span class="hljs-number"><span class="koboSpan" id="kobo.330.1">1</span></span><span class="koboSpan" id="kobo.331.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.332.1">2</span></span><span class="koboSpan" id="kobo.333.1"> * </span><span class="hljs-number"><span class="koboSpan" id="kobo.334.1">365</span></span><span class="koboSpan" id="kobo.335.1">)
    offset = random.randint(-</span><span class="hljs-number"><span class="koboSpan" id="kobo.336.1">365</span></span><span class="koboSpan" id="kobo.337.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.338.1">365</span></span><span class="koboSpan" id="kobo.339.1">)
    start = date.today() - timedelta(days=offset)
    end = start + timedelta(days=duration)
   
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.340.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.341.1">_format_date</span></span><span class="koboSpan" id="kobo.342.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.343.1">date_</span></span><span class="koboSpan" id="kobo.344.1">):
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.345.1">return</span></span><span class="koboSpan" id="kobo.346.1"> date_.strftime(</span><span class="hljs-string"><span class="koboSpan" id="kobo.347.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.348.1">%Y%m%d"</span></span><span class="koboSpan" id="kobo.349.1">)
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.350.1">return</span></span><span class="koboSpan" id="kobo.351.1"> _format_date(start), _format_date(end)
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.352.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.353.1">get_age_range</span></span><span class="koboSpan" id="kobo.354.1">():
    age = random.randrange(</span><span class="hljs-number"><span class="koboSpan" id="kobo.355.1">20</span></span><span class="koboSpan" id="kobo.356.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.357.1">46</span></span><span class="koboSpan" id="kobo.358.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.359.1">5</span></span><span class="koboSpan" id="kobo.360.1">)
    diff = random.randrange(</span><span class="hljs-number"><span class="koboSpan" id="kobo.361.1">5</span></span><span class="koboSpan" id="kobo.362.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.363.1">26</span></span><span class="koboSpan" id="kobo.364.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.365.1">5</span></span><span class="koboSpan" id="kobo.366.1">)
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.367.1">return</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.368.1">"{}-{}"</span></span><span class="koboSpan" id="kobo.369.1">.</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.370.1">format</span></span><span class="koboSpan" id="kobo.371.1">(age, age + diff)
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.372.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.373.1">get_gender</span></span><span class="koboSpan" id="kobo.374.1">():
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.375.1">return</span></span><span class="koboSpan" id="kobo.376.1"> random.choice((</span><span class="hljs-string"><span class="koboSpan" id="kobo.377.1">"M"</span></span><span class="koboSpan" id="kobo.378.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.379.1">"F"</span></span><span class="koboSpan" id="kobo.380.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.381.1">"A"</span></span><span class="koboSpan" id="kobo.382.1">))
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.383.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.384.1">get_currency</span></span><span class="koboSpan" id="kobo.385.1">():
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.386.1">return</span></span><span class="koboSpan" id="kobo.387.1"> random.choice((</span><span class="hljs-string"><span class="koboSpan" id="kobo.388.1">"GBP"</span></span><span class="koboSpan" id="kobo.389.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.390.1">"EUR"</span></span><span class="koboSpan" id="kobo.391.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.392.1">"USD"</span></span><span class="koboSpan" id="kobo.393.1">))
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.394.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.395.1">get_campaign_name</span></span><span class="koboSpan" id="kobo.396.1">():
    separator = </span><span class="hljs-string"><span class="koboSpan" id="kobo.397.1">"_"</span></span><span class="koboSpan" id="kobo.398.1">
    type_ = get_type()
    start, end = get_start_end_dates()
    age_range = get_age_range()
    gender = get_gender()
    currency = get_currency()
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.399.1">return</span></span><span class="koboSpan" id="kobo.400.1"> separator.join(
        (type_, start, end, age_range, gender, currency)
    )
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.401.1">
     In
    </span>
    <a id="_idIndexMarker1144">
    </a>
    <span class="koboSpan" id="kobo.402.1">
     the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.403.1">
      get_type()
     </span>
    </code>
    <span class="koboSpan" id="kobo.404.1">
     function, we use
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.405.1">
      random.choice()
     </span>
    </code>
    <span class="koboSpan" id="kobo.406.1">
     to get one value randomly out of a collection.
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.407.1">
      get_start_end_dates()
     </span>
    </code>
    <span class="koboSpan" id="kobo.408.1">
     is a bit more interesting.
    </span>
    <span class="koboSpan" id="kobo.408.2">
     We compute two random integers: the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.409.1">
      duration
     </span>
    </code>
    <span class="koboSpan" id="kobo.410.1">
     of the campaign in days (between one day and two years) and an
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.411.1">
      offset
     </span>
    </code>
    <span class="koboSpan" id="kobo.412.1">
     (a number of days between –365 and 365).
    </span>
    <span class="koboSpan" id="kobo.412.2">
     We subtract
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.413.1">
      offset
     </span>
    </code>
    <span class="koboSpan" id="kobo.414.1">
     (as a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.415.1">
      timedelta
     </span>
    </code>
    <span class="koboSpan" id="kobo.416.1">
     ) from today’s date to get the start date and add the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.417.1">
      duration
     </span>
    </code>
    <span class="koboSpan" id="kobo.418.1">
     to get the end date.
    </span>
    <span class="koboSpan" id="kobo.418.2">
     Finally, we return string representations of both dates.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.419.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.420.1">
      get_age_range()
     </span>
    </code>
    <span class="koboSpan" id="kobo.421.1">
     function generates a random target age range, where both endpoints are multiples of five.
    </span>
    <span class="koboSpan" id="kobo.421.2">
     We use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.422.1">
      random.randrange()
     </span>
    </code>
    <span class="koboSpan" id="kobo.423.1">
     function, which returns a random number from a range defined by
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.424.1">
      start
     </span>
    </code>
    <span class="koboSpan" id="kobo.425.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.426.1">
      stop
     </span>
    </code>
    <span class="koboSpan" id="kobo.427.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.428.1">
      step
     </span>
    </code>
    <span class="koboSpan" id="kobo.429.1">
     parameters (these parameters have the same meaning as for the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.430.1">
      range
     </span>
    </code>
    <span class="koboSpan" id="kobo.431.1">
     object that we first encountered in
    </span>
    <em class="chapterRef">
     <span class="koboSpan" id="kobo.432.1">
      Chapter 3, Conditionals and Iteration
     </span>
    </em>
    <span class="koboSpan" id="kobo.433.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.433.2">
     We generate random numbers
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.434.1">
      age
     </span>
    </code>
    <span class="koboSpan" id="kobo.435.1">
     (a multiple of 5 between 20 and 46) and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.436.1">
      diff
     </span>
    </code>
    <span class="koboSpan" id="kobo.437.1">
     (a multiple of 5 between 5 and 26).
    </span>
    <span class="koboSpan" id="kobo.437.2">
     We add
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.438.1">
      diff
     </span>
    </code>
    <span class="koboSpan" id="kobo.439.1">
     to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.440.1">
      age
     </span>
    </code>
    <span class="koboSpan" id="kobo.441.1">
     to get the upper limit of our age range and return a string representation of the age range.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.442.1">
     The rest
    </span>
    <a id="_idIndexMarker1145">
    </a>
    <span class="koboSpan" id="kobo.443.1">
     of the functions are just some applications of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.444.1">
      random.choice()
     </span>
    </code>
    <span class="koboSpan" id="kobo.445.1">
     and the last one,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.446.1">
      get_campaign_name()
     </span>
    </code>
    <span class="koboSpan" id="kobo.447.1">
     , assembles all the pieces and returns the final campaign name.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.448.1">
     In
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.449.1">
      #5
     </span>
    </code>
    <span class="koboSpan" id="kobo.450.1">
     , we write a function that creates a complete campaign object:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.451.1">#5</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.452.1"># campaign data:</span></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.453.1"># name, budget, spent, clicks, impressions</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.454.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.455.1">get_campaign_data</span></span><span class="koboSpan" id="kobo.456.1">():
    name = get_campaign_name()
    budget = random.randint(</span><span class="hljs-number"><span class="koboSpan" id="kobo.457.1">10</span></span><span class="koboSpan" id="kobo.458.1">**</span><span class="hljs-number"><span class="koboSpan" id="kobo.459.1">3</span></span><span class="koboSpan" id="kobo.460.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.461.1">10</span></span><span class="koboSpan" id="kobo.462.1">**</span><span class="hljs-number"><span class="koboSpan" id="kobo.463.1">6</span></span><span class="koboSpan" id="kobo.464.1">)
    spent = random.randint(</span><span class="hljs-number"><span class="koboSpan" id="kobo.465.1">10</span></span><span class="koboSpan" id="kobo.466.1">**</span><span class="hljs-number"><span class="koboSpan" id="kobo.467.1">2</span></span><span class="koboSpan" id="kobo.468.1">, budget)
    clicks = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.469.1">int</span></span><span class="koboSpan" id="kobo.470.1">(random.triangular(</span><span class="hljs-number"><span class="koboSpan" id="kobo.471.1">10</span></span><span class="koboSpan" id="kobo.472.1">**</span><span class="hljs-number"><span class="koboSpan" id="kobo.473.1">2</span></span><span class="koboSpan" id="kobo.474.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.475.1">10</span></span><span class="koboSpan" id="kobo.476.1">**</span><span class="hljs-number"><span class="koboSpan" id="kobo.477.1">5</span></span><span class="koboSpan" id="kobo.478.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.479.1">0.2</span></span><span class="koboSpan" id="kobo.480.1"> * </span><span class="hljs-number"><span class="koboSpan" id="kobo.481.1">10</span></span><span class="koboSpan" id="kobo.482.1">**</span><span class="hljs-number"><span class="koboSpan" id="kobo.483.1">5</span></span><span class="koboSpan" id="kobo.484.1">))
    impressions = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.485.1">int</span></span><span class="koboSpan" id="kobo.486.1">(random.gauss(</span><span class="hljs-number"><span class="koboSpan" id="kobo.487.1">0.5</span></span><span class="koboSpan" id="kobo.488.1"> * </span><span class="hljs-number"><span class="koboSpan" id="kobo.489.1">10</span></span><span class="koboSpan" id="kobo.490.1">**</span><span class="hljs-number"><span class="koboSpan" id="kobo.491.1">6</span></span><span class="koboSpan" id="kobo.492.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.493.1">2</span></span><span class="koboSpan" id="kobo.494.1">))
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.495.1">return</span></span><span class="koboSpan" id="kobo.496.1"> {
        </span><span class="hljs-string"><span class="koboSpan" id="kobo.497.1">"cmp_name"</span></span><span class="koboSpan" id="kobo.498.1">: name,
        </span><span class="hljs-string"><span class="koboSpan" id="kobo.499.1">"cmp_bgt"</span></span><span class="koboSpan" id="kobo.500.1">: budget,
        </span><span class="hljs-string"><span class="koboSpan" id="kobo.501.1">"cmp_spent"</span></span><span class="koboSpan" id="kobo.502.1">: spent,
        </span><span class="hljs-string"><span class="koboSpan" id="kobo.503.1">"cmp_clicks"</span></span><span class="koboSpan" id="kobo.504.1">: clicks,
        </span><span class="hljs-string"><span class="koboSpan" id="kobo.505.1">"cmp_impr"</span></span><span class="koboSpan" id="kobo.506.1">: impressions,
    }
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.507.1">
     We used a few functions from the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.508.1">
      random
     </span>
    </code>
    <span class="koboSpan" id="kobo.509.1">
     module.
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.510.1">
      random.randint()
     </span>
    </code>
    <span class="koboSpan" id="kobo.511.1">
     gives you an integer between two extremes.
    </span>
    <span class="koboSpan" id="kobo.511.2">
     It follows a uniform probability distribution, which means that any number in the interval has the same probability of coming up.
    </span>
    <span class="koboSpan" id="kobo.511.3">
     To avoid having all our data look similar, we chose to use
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.512.1">
      triangular()
     </span>
    </code>
    <span class="koboSpan" id="kobo.513.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.514.1">
      gauss()
     </span>
    </code>
    <span class="koboSpan" id="kobo.515.1">
     , for
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.516.1">
      clicks
     </span>
    </code>
    <span class="koboSpan" id="kobo.517.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.518.1">
      impressions
     </span>
    </code>
    <span class="koboSpan" id="kobo.519.1">
     .
    </span>
    <span class="koboSpan" id="kobo.519.2">
     They use different probability distributions so that we will have something more interesting to see in the end.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.520.1">
     Just to make sure we are on the same page with the terminology:
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.521.1">
      clicks
     </span>
    </code>
    <span class="koboSpan" id="kobo.522.1">
     represents the number of clicks on a campaign advertisement,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.523.1">
      budget
     </span>
    </code>
    <span class="koboSpan" id="kobo.524.1">
     is the total amount of money allocated for the campaign,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.525.1">
      spent
     </span>
    </code>
    <span class="koboSpan" id="kobo.526.1">
     is how much of that money has already been spent, and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.527.1">
      impressions
     </span>
    </code>
    <span class="koboSpan" id="kobo.528.1">
     is the number of times the campaign has been
    </span>
    <a id="_idIndexMarker1146">
    </a>
    <span class="koboSpan" id="kobo.529.1">
     displayed, regardless of the number of clicks that were performed on the campaign.
    </span>
    <span class="koboSpan" id="kobo.529.2">
     Normally, the number of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.530.1">
      impressions
     </span>
    </code>
    <span class="koboSpan" id="kobo.531.1">
     is greater than the number of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.532.1">
      clicks
     </span>
    </code>
    <span class="koboSpan" id="kobo.533.1">
     because an advertisement is often viewed without being clicked on.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.534.1">
     Now that we have the data, we can put it all together:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.535.1">#6</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.536.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.537.1">get_data</span></span><span class="koboSpan" id="kobo.538.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.539.1">users</span></span><span class="koboSpan" id="kobo.540.1">):
    data = []
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.541.1">for</span></span><span class="koboSpan" id="kobo.542.1"> user </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.543.1">in</span></span><span class="koboSpan" id="kobo.544.1"> users:
        campaigns = [
            get_campaign_data()
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.545.1">for</span></span><span class="koboSpan" id="kobo.546.1"> _ </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.547.1">in</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.548.1">range</span></span><span class="koboSpan" id="kobo.549.1">(random.randint(</span><span class="hljs-number"><span class="koboSpan" id="kobo.550.1">2</span></span><span class="koboSpan" id="kobo.551.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.552.1">8</span></span><span class="koboSpan" id="kobo.553.1">))
        ]
        data.append({</span><span class="hljs-string"><span class="koboSpan" id="kobo.554.1">"user"</span></span><span class="koboSpan" id="kobo.555.1">: user, </span><span class="hljs-string"><span class="koboSpan" id="kobo.556.1">"campaigns"</span></span><span class="koboSpan" id="kobo.557.1">: campaigns})
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.558.1">return</span></span><span class="koboSpan" id="kobo.559.1"> data
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.560.1">
     As you can see, each item in
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.561.1">
      data
     </span>
    </code>
    <span class="koboSpan" id="kobo.562.1">
     is a dictionary with a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.563.1">
      user
     </span>
    </code>
    <span class="koboSpan" id="kobo.564.1">
     and a list of campaigns that are associated with that
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.565.1">
      user
     </span>
    </code>
    <span class="koboSpan" id="kobo.566.1">
     .
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-337">
    <span class="koboSpan" id="kobo.567.1">
     Cleaning the data
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.568.1">
     Next, we
    </span>
    <a id="_idIndexMarker1147">
    </a>
    <span class="koboSpan" id="kobo.569.1">
     can start cleaning the data:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.570.1">#7</span></span><span class="koboSpan" id="kobo.571.1">
rough_data = get_data(users)
rough_data[:</span><span class="hljs-number"><span class="koboSpan" id="kobo.572.1">2</span></span><span class="koboSpan" id="kobo.573.1">]  </span><span class="hljs-comment"><span class="koboSpan" id="kobo.574.1"># let us take a peek</span></span>
</code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.575.1">
     We simulate fetching the data from a source and then inspect it.
    </span>
    <span class="koboSpan" id="kobo.575.2">
     The Notebook is the perfect tool for inspecting your steps.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.576.1">
     You can vary the granularity to suit your needs.
    </span>
    <span class="koboSpan" id="kobo.576.2">
     The first item in
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.577.1">
      rough_data
     </span>
    </code>
    <span class="koboSpan" id="kobo.578.1">
     looks like this:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.579.1"> {</span><span class="hljs-string"><span class="koboSpan" id="kobo.580.1">'user'</span></span><span class="koboSpan" id="kobo.581.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.582.1">'{"username": "epennington", "name": ...}'</span></span><span class="koboSpan" id="kobo.583.1">,
  </span><span class="hljs-string"><span class="koboSpan" id="kobo.584.1">'campaigns'</span></span><span class="koboSpan" id="kobo.585.1">: [{</span><span class="hljs-string"><span class="koboSpan" id="kobo.586.1">'cmp_name'</span></span><span class="koboSpan" id="kobo.587.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.588.1">'KTR_20250404_20250916_35-50_A_EUR'</span></span><span class="koboSpan" id="kobo.589.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.590.1">'cmp_bgt'</span></span><span class="koboSpan" id="kobo.591.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.592.1">964496</span></span><span class="koboSpan" id="kobo.593.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.594.1">'cmp_spent'</span></span><span class="koboSpan" id="kobo.595.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.596.1">29586</span></span><span class="koboSpan" id="kobo.597.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.598.1">'cmp_clicks'</span></span><span class="koboSpan" id="kobo.599.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.600.1">36632</span></span><span class="koboSpan" id="kobo.601.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.602.1">'cmp_impr'</span></span><span class="koboSpan" id="kobo.603.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.604.1">500001</span></span><span class="koboSpan" id="kobo.605.1">},
   {</span><span class="hljs-string"><span class="koboSpan" id="kobo.606.1">'cmp_name'</span></span><span class="koboSpan" id="kobo.607.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.608.1">'AKX_20240130_20241017_20-25_M_GBP'</span></span><span class="koboSpan" id="kobo.609.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.610.1">'cmp_bgt'</span></span><span class="koboSpan" id="kobo.611.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.612.1">344739</span></span><span class="koboSpan" id="kobo.613.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.614.1">'cmp_spent'</span></span><span class="koboSpan" id="kobo.615.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.616.1">166010</span></span><span class="koboSpan" id="kobo.617.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.618.1">'cmp_clicks'</span></span><span class="koboSpan" id="kobo.619.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.620.1">67325</span></span><span class="koboSpan" id="kobo.621.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.622.1">'cmp_impr'</span></span><span class="koboSpan" id="kobo.623.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.624.1">499999</span></span><span class="koboSpan" id="kobo.625.1">}]}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.626.1">
     Now we
    </span>
    <a id="_idIndexMarker1148">
    </a>
    <span class="koboSpan" id="kobo.627.1">
     can start working on the data.
    </span>
    <span class="koboSpan" id="kobo.627.2">
     The first thing we need to do to be able to work with this
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.628.1">
      data
     </span>
    </code>
    <span class="koboSpan" id="kobo.629.1">
     is to denormalize it.
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.630.1">
      Denormalization
     </span>
    </strong>
    <span class="koboSpan" id="kobo.631.1">
     is a
    </span>
    <a id="_idIndexMarker1149">
    </a>
    <span class="koboSpan" id="kobo.632.1">
     process of restructuring data into a single table.
    </span>
    <span class="koboSpan" id="kobo.632.2">
     This involves merging data from multiple tables or flattening out nested data structures.
    </span>
    <span class="koboSpan" id="kobo.632.3">
     It usually introduces some duplication of data; however, it simplifies data analysis by eliminating the need to deal with nested structures or to look related data up across multiple tables.
    </span>
    <span class="koboSpan" id="kobo.632.4">
     In our case, this means transforming
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.633.1">
      data
     </span>
    </code>
    <span class="koboSpan" id="kobo.634.1">
     into a list whose items are campaign dictionaries, augmented with their relative
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.635.1">
      user
     </span>
    </code>
    <span class="koboSpan" id="kobo.636.1">
     dictionary.
    </span>
    <span class="koboSpan" id="kobo.636.2">
     Users will be duplicated in each campaign they are associated with:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.637.1">#8</span></span><span class="koboSpan" id="kobo.638.1">
data = []
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.639.1">for</span></span><span class="koboSpan" id="kobo.640.1"> datum </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.641.1">in</span></span><span class="koboSpan" id="kobo.642.1"> rough_data:
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.643.1">for</span></span><span class="koboSpan" id="kobo.644.1"> campaign </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.645.1">in</span></span><span class="koboSpan" id="kobo.646.1"> datum[</span><span class="hljs-string"><span class="koboSpan" id="kobo.647.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.648.1">campaigns"</span></span><span class="koboSpan" id="kobo.649.1">]:
        campaign.update({</span><span class="hljs-string"><span class="koboSpan" id="kobo.650.1">"user"</span></span><span class="koboSpan" id="kobo.651.1">: datum[</span><span class="hljs-string"><span class="koboSpan" id="kobo.652.1">"user"</span></span><span class="koboSpan" id="kobo.653.1">]})
        data.append(campaign)
data[:</span><span class="hljs-number"><span class="koboSpan" id="kobo.654.1">2</span></span><span class="koboSpan" id="kobo.655.1">]  </span><span class="hljs-comment"><span class="koboSpan" id="kobo.656.1"># let us take another peek</span></span>
</code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.657.1">
     The first item in
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.658.1">
      data
     </span>
    </code>
    <span class="koboSpan" id="kobo.659.1">
     now looks like this:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.660.1"> {</span><span class="hljs-string"><span class="koboSpan" id="kobo.661.1">'cmp_name'</span></span><span class="koboSpan" id="kobo.662.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.663.1">'KTR_20250404_20250916_35-50_A_EUR'</span></span><span class="koboSpan" id="kobo.664.1">,
 </span><span class="hljs-string"><span class="koboSpan" id="kobo.665.1">'cmp_bgt'</span></span><span class="koboSpan" id="kobo.666.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.667.1">964496</span></span><span class="koboSpan" id="kobo.668.1">,
 </span><span class="hljs-string"><span class="koboSpan" id="kobo.669.1">'cmp_spent'</span></span><span class="koboSpan" id="kobo.670.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.671.1">29586</span></span><span class="koboSpan" id="kobo.672.1">,
 </span><span class="hljs-string"><span class="koboSpan" id="kobo.673.1">'cmp_clicks'</span></span><span class="koboSpan" id="kobo.674.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.675.1">36632</span></span><span class="koboSpan" id="kobo.676.1">,
 </span><span class="hljs-string"><span class="koboSpan" id="kobo.677.1">'cmp_impr'</span></span><span class="koboSpan" id="kobo.678.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.679.1">500001</span></span><span class="koboSpan" id="kobo.680.1">,
 </span><span class="hljs-string"><span class="koboSpan" id="kobo.681.1">'user'</span></span><span class="koboSpan" id="kobo.682.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.683.1">'{"username": "epennington", ...}'</span></span><span class="koboSpan" id="kobo.684.1">},
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.685.1">
     Now, we would like to help you and offer a deterministic second part of the chapter, so we are going to save the data we generated here so that we (and you, too) will be able to load it from the next Notebook, and we should then have the same results:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.686.1">#9</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.687.1">with</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.688.1">open</span></span><span class="koboSpan" id="kobo.689.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.690.1">"data.json"</span></span><span class="koboSpan" id="kobo.691.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.692.1">"w"</span></span><span class="koboSpan" id="kobo.693.1">) </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.694.1">as</span></span><span class="koboSpan" id="kobo.695.1"> stream:
    stream.write(json.dumps(data))
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.696.1">
     You should
    </span>
    <a id="_idIndexMarker1150">
    </a>
    <span class="koboSpan" id="kobo.697.1">
     find the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.698.1">
      data.json
     </span>
    </code>
    <span class="koboSpan" id="kobo.699.1">
     file in the source code for the book.
    </span>
    <span class="koboSpan" id="kobo.699.2">
     Now, we are done with
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.700.1">
      ch13-dataprep
     </span>
    </code>
    <span class="koboSpan" id="kobo.701.1">
     , so we can close it and open the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.702.1">
      ch13
     </span>
    </code>
    <span class="koboSpan" id="kobo.703.1">
     notebook.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-338">
    <span class="koboSpan" id="kobo.704.1">
     Creating the DataFrame
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.705.1">
     Now that
    </span>
    <a id="_idIndexMarker1151">
    </a>
    <span class="koboSpan" id="kobo.706.1">
     we have prepared our data, we can start analyzing it.
    </span>
    <span class="koboSpan" id="kobo.706.2">
     First, we have another round of imports:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.707.1">#1</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.708.1">import</span></span><span class="koboSpan" id="kobo.709.1"> json
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.710.1">import</span></span><span class="koboSpan" id="kobo.711.1"> arrow
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.712.1">import</span></span><span class="koboSpan" id="kobo.713.1"> pandas </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.714.1">as</span></span><span class="koboSpan" id="kobo.715.1"> pd
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.716.1">from</span></span><span class="koboSpan" id="kobo.717.1"> pandas </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.718.1">import</span></span><span class="koboSpan" id="kobo.719.1"> DataFrame
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.720.1">
     We have already seen the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.721.1">
      json
     </span>
    </code>
    <span class="koboSpan" id="kobo.722.1">
     module in
    </span>
    <em class="chapterRef">
     <span class="koboSpan" id="kobo.723.1">
      Chapter 8, Files and Data Persistence
     </span>
    </em>
    <span class="koboSpan" id="kobo.724.1">
     .
    </span>
    <span class="koboSpan" id="kobo.724.2">
     We also briefly introduced
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.725.1">
      arrow
     </span>
    </code>
    <span class="koboSpan" id="kobo.726.1">
     in
    </span>
    <em class="chapterRef">
     <span class="koboSpan" id="kobo.727.1">
      Chapter 2, Built-In Data Types
     </span>
    </em>
    <span class="koboSpan" id="kobo.728.1">
     .
    </span>
    <span class="koboSpan" id="kobo.728.2">
     It is a very useful third-party library that makes working with dates and times a lot easier.
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.729.1">
      pandas
     </span>
    </code>
    <span class="koboSpan" id="kobo.730.1">
     is the core
    </span>
    <a id="_idIndexMarker1152">
    </a>
    <span class="koboSpan" id="kobo.731.1">
     upon which the whole project is based.
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.732.1">
      pandas
     </span>
    </strong>
    <span class="koboSpan" id="kobo.733.1">
     stands for
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.734.1">
      Python Data Analysis Library
     </span>
    </strong>
    <span class="koboSpan" id="kobo.735.1">
     .
    </span>
    <span class="koboSpan" id="kobo.735.2">
     Among
    </span>
    <a id="_idIndexMarker1153">
    </a>
    <span class="koboSpan" id="kobo.736.1">
     many other things, it provides the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.737.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.738.1">
     , a matrix-like data structure with advanced processing capabilities.
    </span>
    <span class="koboSpan" id="kobo.738.2">
     It is customary to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.739.1">
      import pandas as pd
     </span>
    </code>
    <span class="koboSpan" id="kobo.740.1">
     and also import
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.741.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.742.1">
     separately
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.743.1">
      .
     </span>
    </strong>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.744.1">
     After the imports, we load our data into a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.745.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.746.1">
     using the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.747.1">
      pandas.read_json()
     </span>
    </code>
    <span class="koboSpan" id="kobo.748.1">
     function:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.749.1">#2</span></span><span class="koboSpan" id="kobo.750.1">
df = pd.read_json(</span><span class="hljs-string"><span class="koboSpan" id="kobo.751.1">"data.json"</span></span><span class="koboSpan" id="kobo.752.1">)
df.head()
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.753.1">
     We inspect the first five rows using the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.754.1">
      head()
     </span>
    </code>
    <span class="koboSpan" id="kobo.755.1">
     method of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.756.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.757.1">
     .
    </span>
    <span class="koboSpan" id="kobo.757.2">
     You should see something like this:
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.758.1">
     <img alt="img" src="../Images/B30992_13_02.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.759.1">
     Figure 13.2: The first few rows of the DataFrame
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.760.1">
     Jupyter
    </span>
    <a id="_idIndexMarker1154">
    </a>
    <span class="koboSpan" id="kobo.761.1">
     automatically renders the output of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.762.1">
      df.head()
     </span>
    </code>
    <span class="koboSpan" id="kobo.763.1">
     call as HTML.
    </span>
    <span class="koboSpan" id="kobo.763.2">
     To get a plain text representation, you can wrap
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.764.1">
      df.head()
     </span>
    </code>
    <span class="koboSpan" id="kobo.765.1">
     in a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.766.1">
      print
     </span>
    </code>
    <span class="koboSpan" id="kobo.767.1">
     call.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.768.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.769.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.770.1">
     structure allows you to perform various operations on its contents.
    </span>
    <span class="koboSpan" id="kobo.770.2">
     You can filter by rows or columns, aggregate data, and so on.
    </span>
    <span class="koboSpan" id="kobo.770.3">
     You can operate on entire rows or columns without suffering the time penalty you would have to pay if you were working on data with pure Python.
    </span>
    <span class="koboSpan" id="kobo.770.4">
     This is possible because, under the hood,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.771.1">
      pandas
     </span>
    </code>
    <span class="koboSpan" id="kobo.772.1">
     harnesses the power
    </span>
    <a id="_idIndexMarker1155">
    </a>
    <span class="koboSpan" id="kobo.773.1">
     of the
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.774.1">
      NumPy
     </span>
    </strong>
    <span class="koboSpan" id="kobo.775.1">
     library, which itself draws its incredible speed from the low-level implementation of its core.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.776.1">
      NumPy stands for Numeric Python.
     </span>
     <span class="koboSpan" id="kobo.776.2">
      It is one of the most widely used libraries in the data science environment.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.777.1">
     Using
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.778.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.779.1">
     allows us to couple the power of NumPy with spreadsheet-like capabilities so that we can work on our data in a way that is similar to what an analyst would normally do, only we do it with code.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.780.1">
     Let us see two ways to quickly get an overview of the data:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.781.1">#3</span></span><span class="koboSpan" id="kobo.782.1">
df.count()
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.783.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.784.1">
      count()
     </span>
    </code>
    <span class="koboSpan" id="kobo.785.1">
     method returns a count of all the non-empty cells in each column.
    </span>
    <span class="koboSpan" id="kobo.785.2">
     This is useful to help you understand how sparse your data is.
    </span>
    <span class="koboSpan" id="kobo.785.3">
     In our case, we have no missing
    </span>
    <a id="_idIndexMarker1156">
    </a>
    <span class="koboSpan" id="kobo.786.1">
     values, so the output is:
    </span>
   </p>
   <table class="table-container" id="table001-1">
    <tbody>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.787.1">
          cmp_name
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.788.1">
         5065
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.789.1">
          cmp_bgt
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.790.1">
         5065
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.791.1">
          cmp_spent
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.792.1">
         5065
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.793.1">
          cmp_clicks
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.794.1">
         5065
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.795.1">
          cmp_impr
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.796.1">
         5065
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.797.1">
          user
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.798.1">
         5065
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.799.1">
          dtype: int64
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
      </td>
     </tr>
    </tbody>
   </table>
   <p class="normal">
    <span class="koboSpan" id="kobo.800.1">
     We have 5,065 rows.
    </span>
    <span class="koboSpan" id="kobo.800.2">
     Given that we have 1,000 users and the number of campaigns per user is a random number between 2 and 8, that is in line with what we would expect.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.801.1">
      The
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.802.1">
       dtype: int64
      </span>
     </code>
     <span class="koboSpan" id="kobo.803.1">
      line at the end of the output indicates that the values returned by
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.804.1">
       df.count()
      </span>
     </code>
     <span class="koboSpan" id="kobo.805.1">
      are NumPy
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.806.1">
       int64
      </span>
     </code>
     <span class="koboSpan" id="kobo.807.1">
      objects.
     </span>
     <span class="koboSpan" id="kobo.807.2">
      Here,
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.808.1">
       dtype
      </span>
     </code>
     <span class="koboSpan" id="kobo.809.1">
      stands for “data type” and
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.810.1">
       int64
      </span>
     </code>
     <span class="koboSpan" id="kobo.811.1">
      means 64-bit integers.
     </span>
     <span class="koboSpan" id="kobo.811.2">
      NumPy is largely implemented in C and, instead of using Python’s built-in numeric types, it uses its own types, which are closely related to C language data types.
     </span>
     <span class="koboSpan" id="kobo.811.3">
      This allows it to perform numerical operations much more quickly than pure Python.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.812.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.813.1">
      describe
     </span>
    </code>
    <span class="koboSpan" id="kobo.814.1">
     method is useful to quickly obtain a statistical summary of our data:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.815.1">#4</span></span><span class="koboSpan" id="kobo.816.1">
df.describe()
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.817.1">
     As shown in the output below, it gives us several measures, such as
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.818.1">
      count
     </span>
    </code>
    <span class="koboSpan" id="kobo.819.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.820.1">
      mean
     </span>
    </code>
    <span class="koboSpan" id="kobo.821.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.822.1">
      std
     </span>
    </code>
    <span class="koboSpan" id="kobo.823.1">
     (standard deviation),
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.824.1">
      min
     </span>
    </code>
    <span class="koboSpan" id="kobo.825.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.826.1">
      max
     </span>
    </code>
    <span class="koboSpan" id="kobo.827.1">
     , and shows how data is distributed in the various quartiles.
    </span>
    <span class="koboSpan" id="kobo.827.2">
     Thanks to this method, we already have an idea of how our data is structured:
    </span>
   </p>
   <table class="table-container" id="table002">
    <tbody>
     <tr>
      <td class="table-cell">
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.828.1">
          cmp_bgt
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.829.1">
          cmp_spent
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.830.1">
          cmp_clicks
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.831.1">
          cmp_impr
         </span>
        </strong>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.832.1">
          count
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.833.1">
         5065.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.834.1">
         5065.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.835.1">
         5065.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.836.1">
         5065.000000
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.837.1">
          mean
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.838.1">
         502965.054097
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.839.1">
         253389.854689
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.840.1">
         40265.781639
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.841.1">
         499999.474630
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.842.1">
          std
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.843.1">
         290468.998656
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.844.1">
         222774.897138
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.845.1">
         21840.783154
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.846.1">
         2.023801
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.847.1">
          min
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.848.1">
         1764.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.849.1">
         107.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.850.1">
         899.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.851.1">
         499992.000000
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.852.1">
          25%
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.853.1">
         251171.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.854.1">
         67071.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.855.1">
         22575.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.856.1">
         499998.000000
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.857.1">
          50%
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.858.1">
         500694.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.859.1">
         187743.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.860.1">
         36746.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.861.1">
         499999.000000
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.862.1">
          75%
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.863.1">
         756850.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.864.1">
         391790.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.865.1">
         55817.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.866.1">
         500001.000000
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.867.1">
          max
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.868.1">
         999565.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.869.1">
         984705.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.870.1">
         98379.000000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.871.1">
         500007.000000
        </span>
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <p class="normal">
    <span class="koboSpan" id="kobo.872.1">
     We can use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.873.1">
      sort_values()
     </span>
    </code>
    <span class="koboSpan" id="kobo.874.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.875.1">
      head()
     </span>
    </code>
    <span class="koboSpan" id="kobo.876.1">
     methods to see the campaigns with the highest budgets:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.877.1">#5</span></span><span class="koboSpan" id="kobo.878.1">
df.sort_values(by=[</span><span class="hljs-string"><span class="koboSpan" id="kobo.879.1">"cmp_bgt"</span></span><span class="koboSpan" id="kobo.880.1">], ascending=</span><span class="hljs-literal"><span class="koboSpan" id="kobo.881.1">False</span></span><span class="koboSpan" id="kobo.882.1">).head(</span><span class="hljs-number"><span class="koboSpan" id="kobo.883.1">3</span></span><span class="koboSpan" id="kobo.884.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.885.1">
     This gives
    </span>
    <a id="_idIndexMarker1157">
    </a>
    <span class="koboSpan" id="kobo.886.1">
     the following output (we have omitted some columns to fit the output on the page):
    </span>
   </p>
   <table class="table-container" id="table003">
    <tbody>
     <tr>
      <td class="table-cell">
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.887.1">
          cmp_name
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.888.1">
          cmp_bgt
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.889.1">
          cmp_clicks
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.890.1">
          cmp_impr
         </span>
        </strong>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.891.1">
          3186
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.892.1">
          GRZ_20230914_20230929_40-60_A_EUR
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.893.1">
         999565
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.894.1">
         63869
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.895.1">
         499998
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.896.1">
          3168
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.897.1">
          KTR_20250315_20260507_25-40_M_USD
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.898.1">
         999487
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.899.1">
         21097
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.900.1">
         500000
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.901.1">
          3624
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.902.1">
          GRZ_20250227_20250617_30-45_F_USD
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.903.1">
         999482
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.904.1">
         3435
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.905.1">
         499998
        </span>
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <p class="normal">
    <span class="koboSpan" id="kobo.906.1">
     Calling
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.907.1">
      tail()
     </span>
    </code>
    <span class="koboSpan" id="kobo.908.1">
     instead of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.909.1">
      head()
     </span>
    </code>
    <span class="koboSpan" id="kobo.910.1">
     shows
    </span>
    <a id="_idIndexMarker1158">
    </a>
    <span class="koboSpan" id="kobo.911.1">
     us the campaigns with the lowest budgets:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.912.1">#6</span></span><span class="koboSpan" id="kobo.913.1">
df.sort_values(by=[</span><span class="hljs-string"><span class="koboSpan" id="kobo.914.1">"cmp_bgt"</span></span><span class="koboSpan" id="kobo.915.1">], ascending=</span><span class="hljs-literal"><span class="koboSpan" id="kobo.916.1">False</span></span><span class="koboSpan" id="kobo.917.1">).tail(</span><span class="hljs-number"><span class="koboSpan" id="kobo.918.1">3</span></span><span class="koboSpan" id="kobo.919.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.920.1">
     Next, we will take on some more complex tasks.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-339">
    <span class="koboSpan" id="kobo.921.1">
     Unpacking the campaign name
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.922.1">
     Firstly, we
    </span>
    <a id="_idIndexMarker1159">
    </a>
    <span class="koboSpan" id="kobo.923.1">
     want to get rid of the campaign name column (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.924.1">
      cmp_name
     </span>
    </code>
    <span class="koboSpan" id="kobo.925.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.925.2">
     We need to explode it into parts and put each part in its own dedicated column.
    </span>
    <span class="koboSpan" id="kobo.925.3">
     We will use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.926.1">
      apply()
     </span>
    </code>
    <span class="koboSpan" id="kobo.927.1">
     method of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.928.1">
      Series
     </span>
    </code>
    <span class="koboSpan" id="kobo.929.1">
     object to do this.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.930.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.931.1">
      pandas.core.series.Series
     </span>
    </code>
    <span class="koboSpan" id="kobo.932.1">
     class
    </span>
    <a id="_idIndexMarker1160">
    </a>
    <span class="koboSpan" id="kobo.933.1">
     is a powerful wrapper around an array (think of it as a list with augmented capabilities).
    </span>
    <span class="koboSpan" id="kobo.933.2">
     We can extract a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.934.1">
      Series
     </span>
    </code>
    <span class="koboSpan" id="kobo.935.1">
     object from
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.936.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.937.1">
     by accessing it in the same way we do with a key in a dictionary.
    </span>
    <span class="koboSpan" id="kobo.937.2">
     We will then use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.938.1">
      apply()
     </span>
    </code>
    <span class="koboSpan" id="kobo.939.1">
     method of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.940.1">
      Series
     </span>
    </code>
    <span class="koboSpan" id="kobo.941.1">
     object to call a function on each item in the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.942.1">
      Series
     </span>
    </code>
    <span class="koboSpan" id="kobo.943.1">
     and obtain a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.944.1">
      Series
     </span>
    </code>
    <span class="koboSpan" id="kobo.945.1">
     with the results.
    </span>
    <span class="koboSpan" id="kobo.945.2">
     Finally, we compose the result into a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.946.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.947.1">
     , and then join that
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.948.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.949.1">
     with
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.950.1">
      df
     </span>
    </code>
    <span class="koboSpan" id="kobo.951.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.952.1">
     We start by defining a function to split a campaign name into a tuple containing the type, start and end dates, target age, target gender, and currency.
    </span>
    <span class="koboSpan" id="kobo.952.2">
     Note that we use
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.953.1">
      arrow.get()
     </span>
    </code>
    <span class="koboSpan" id="kobo.954.1">
     to convert the start and end date strings to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.955.1">
      date
     </span>
    </code>
    <span class="koboSpan" id="kobo.956.1">
     objects.
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.957.1">#7</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.958.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.959.1">unpack_campaign_name</span></span><span class="koboSpan" id="kobo.960.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.961.1">name</span></span><span class="koboSpan" id="kobo.962.1">):
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.963.1"># very optimistic method, assumes data in campaign name</span></span>
    <span class="hljs-comment"><span class="koboSpan" id="kobo.964.1"># is always in good state</span></span><span class="koboSpan" id="kobo.965.1">
    type_, start, end, age, gender, currency = name.split(</span><span class="hljs-string"><span class="koboSpan" id="kobo.966.1">"_"</span></span><span class="koboSpan" id="kobo.967.1">)
    start = arrow.get(start, </span><span class="hljs-string"><span class="koboSpan" id="kobo.968.1">"YYYYMMDD"</span></span><span class="koboSpan" id="kobo.969.1">).date()
    end = arrow.get(end, </span><span class="hljs-string"><span class="koboSpan" id="kobo.970.1">"YYYYMMDD"</span></span><span class="koboSpan" id="kobo.971.1">).date()
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.972.1">return</span></span><span class="koboSpan" id="kobo.973.1"> type_, start, end, age, gender, currency
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.974.1">
     Next, we
    </span>
    <a id="_idIndexMarker1161">
    </a>
    <span class="koboSpan" id="kobo.975.1">
     extract the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.976.1">
      Series
     </span>
    </code>
    <span class="koboSpan" id="kobo.977.1">
     with the campaign names from
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.978.1">
      df
     </span>
    </code>
    <span class="koboSpan" id="kobo.979.1">
     and apply the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.980.1">
      unpack_campaign_name()
     </span>
    </code>
    <span class="koboSpan" id="kobo.981.1">
     function to each name.
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.982.1">#8</span></span><span class="koboSpan" id="kobo.983.1">
campaign_data = df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.984.1">"cmp_name"</span></span><span class="koboSpan" id="kobo.985.1">].apply(unpack_campaign_name)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.986.1">
     Now we can construct a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.987.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.988.1">
     from the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.989.1">
      campaign_data
     </span>
    </code>
    <span class="koboSpan" id="kobo.990.1">
     :
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.991.1">#9</span></span><span class="koboSpan" id="kobo.992.1">
campaign_cols = [
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.993.1">"Type"</span></span><span class="koboSpan" id="kobo.994.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.995.1">"Start"</span></span><span class="koboSpan" id="kobo.996.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.997.1">"End"</span></span><span class="koboSpan" id="kobo.998.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.999.1">"Target Age"</span></span><span class="koboSpan" id="kobo.1000.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1001.1">"Target Gender"</span></span><span class="koboSpan" id="kobo.1002.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1003.1">"Currency"</span></span><span class="koboSpan" id="kobo.1004.1">,
]
campaign_df = DataFrame.from_records(
    campaign_data, columns=campaign_cols, index=df.index
)
campaign_df.head(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1005.1">3</span></span><span class="koboSpan" id="kobo.1006.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1007.1">
     A quick peek at the first three rows reveals:
    </span>
   </p>
   <table class="table-container" id="table004">
    <thead>
     <tr>
      <td class="table-cell">
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1008.1">
          Type
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1009.1">
          Start
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1010.1">
          End
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1011.1">
          Target Age
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1012.1">
          Target Gender
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1013.1">
          Currency
         </span>
        </strong>
       </p>
      </td>
     </tr>
    </thead>
    <tbody>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1014.1">
         0
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1015.1">
          KTR
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1016.1">
          2025-04-04
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1017.1">
          2025-09-16
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1018.1">
          35-50
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1019.1">
          A
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1020.1">
          EUR
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1021.1">
         1
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1022.1">
          AKX
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1023.1">
          2024-01-30
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1024.1">
          2024-10-17
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1025.1">
          20-25
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1026.1">
          M
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1027.1">
          GBP
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1028.1">
         2
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1029.1">
          BYU
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1030.1">
          2023-08-28
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1031.1">
          2025-01-15
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1032.1">
          25-45
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1033.1">
          M
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1034.1">
          GBP
         </span>
        </code>
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <p class="normal">
    <span class="koboSpan" id="kobo.1035.1">
     That looks better.
    </span>
    <span class="koboSpan" id="kobo.1035.2">
     Now, we can more easily work with the data represented by the
    </span>
    <a id="_idIndexMarker1162">
    </a>
    <span class="koboSpan" id="kobo.1036.1">
     column names.
    </span>
    <span class="koboSpan" id="kobo.1036.2">
     One important thing to remember: even if the dates are printed as strings, they are just the representation of the real
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1037.1">
      date
     </span>
    </code>
    <span class="koboSpan" id="kobo.1038.1">
     objects that are stored in
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1039.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1040.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1041.1">
     Finally, we can join the original
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1042.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1043.1">
     (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1044.1">
      df
     </span>
    </code>
    <span class="koboSpan" id="kobo.1045.1">
     ) and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1046.1">
      campaign_df
     </span>
    </code>
    <span class="koboSpan" id="kobo.1047.1">
     into a single
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1048.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1049.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1049.2">
     When joining two
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1050.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1051.1">
     instances, it is imperative that they have the same
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1052.1">
      index
     </span>
    </code>
    <span class="koboSpan" id="kobo.1053.1">
     , otherwise
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1054.1">
      pandas
     </span>
    </code>
    <span class="koboSpan" id="kobo.1055.1">
     will not be able to match up the rows.
    </span>
    <span class="koboSpan" id="kobo.1055.2">
     We took care of this by explicitly using the index from
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1056.1">
      df
     </span>
    </code>
    <span class="koboSpan" id="kobo.1057.1">
     when creating
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1058.1">
      campaign_df.
     </span>
    </code>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1059.1">#10</span></span><span class="koboSpan" id="kobo.1060.1">
df = df.join(campaign_df)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1061.1">
     Let us inspect the data to verify that everything matches correctly:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1062.1">#11</span></span><span class="koboSpan" id="kobo.1063.1">
df[[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1064.1">"cmp_name"</span></span><span class="koboSpan" id="kobo.1065.1">] + campaign_cols].head(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1066.1">3</span></span><span class="koboSpan" id="kobo.1067.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1068.1">
     The first few columns of the output are as follows:
    </span>
   </p>
   <table class="table-container" id="table005">
    <thead>
     <tr>
      <td class="table-cell">
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1069.1">
          cmp_name
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1070.1">
          Type
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1071.1">
          Start
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1072.1">
          End
         </span>
        </strong>
       </p>
      </td>
     </tr>
    </thead>
    <tbody>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1073.1">
         0
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1074.1">
          KTR_20250404_20250916_35-50_A_EUR
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1075.1">
          KTR
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1076.1">
          2025-04-04
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1077.1">
          2025-09-16
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1078.1">
         1
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1079.1">
          AKX_20240130_20241017_20-25_M_GBP
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1080.1">
          AKX
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1081.1">
          2024-01-30
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1082.1">
          2024-10-17
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1083.1">
         2
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1084.1">
          BYU_20230828_20250115_25-45_M_GBP
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1085.1">
          BYU
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1086.1">
          2023-08-28
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1087.1">
          2025-01-15
         </span>
        </code>
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <p class="normal">
    <span class="koboSpan" id="kobo.1088.1">
     As you can see,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1089.1">
      join()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1090.1">
     was successful; the campaign name and the separated columns represent the same data.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1091.1">
     Note how we access the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1092.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1093.1">
     using the square brackets syntax, passing a list of column names.
    </span>
    <span class="koboSpan" id="kobo.1093.2">
     This
    </span>
    <a id="_idIndexMarker1163">
    </a>
    <span class="koboSpan" id="kobo.1094.1">
     will produce a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1095.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1096.1">
     , with those columns (in the same order), on which we then call the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1097.1">
      head()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1098.1">
     method.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-340">
    <span class="koboSpan" id="kobo.1099.1">
     Unpacking the user data
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.1100.1">
     We
    </span>
    <a id="_idIndexMarker1164">
    </a>
    <span class="koboSpan" id="kobo.1101.1">
     now do the same thing for each piece of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1102.1">
      user
     </span>
    </code>
    <span class="koboSpan" id="kobo.1103.1">
     JSON data.
    </span>
    <span class="koboSpan" id="kobo.1103.2">
     We call
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1104.1">
      apply()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1105.1">
     on the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1106.1">
      user
     </span>
    </code>
    <span class="koboSpan" id="kobo.1107.1">
     series, running the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1108.1">
      unpack_user_json()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1109.1">
     function, which takes a JSON
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1110.1">
      user
     </span>
    </code>
    <span class="koboSpan" id="kobo.1111.1">
     object and transforms it into a list of its fields.
    </span>
    <span class="koboSpan" id="kobo.1111.2">
     We create a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1112.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1113.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1114.1">
      user_df
     </span>
    </code>
    <span class="koboSpan" id="kobo.1115.1">
     , with this data:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1116.1">#12</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1117.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1118.1">unpack_user_json</span></span><span class="koboSpan" id="kobo.1119.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1120.1">user</span></span><span class="koboSpan" id="kobo.1121.1">):
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1122.1"># very optimistic as well, expects user objects</span></span>
    <span class="hljs-comment"><span class="koboSpan" id="kobo.1123.1"># to have all attributes</span></span><span class="koboSpan" id="kobo.1124.1">
    user = json.loads(user.strip())
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1125.1">return</span></span><span class="koboSpan" id="kobo.1126.1"> [
        user[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1127.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1128.1">username"</span></span><span class="koboSpan" id="kobo.1129.1">],
        user[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1130.1">"email"</span></span><span class="koboSpan" id="kobo.1131.1">],
        user[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1132.1">"name"</span></span><span class="koboSpan" id="kobo.1133.1">],
        user[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1134.1">"gender"</span></span><span class="koboSpan" id="kobo.1135.1">],
        user[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1136.1">"age"</span></span><span class="koboSpan" id="kobo.1137.1">],
        user[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1138.1">"address"</span></span><span class="koboSpan" id="kobo.1139.1">],
    ]
user_data = df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1140.1">"user"</span></span><span class="koboSpan" id="kobo.1141.1">].apply(unpack_user_json)
user_cols = [
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1142.1">"username"</span></span><span class="koboSpan" id="kobo.1143.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1144.1">"email"</span></span><span class="koboSpan" id="kobo.1145.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1146.1">"name"</span></span><span class="koboSpan" id="kobo.1147.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1148.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1149.1">gender"</span></span><span class="koboSpan" id="kobo.1150.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1151.1">"age"</span></span><span class="koboSpan" id="kobo.1152.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1153.1">"address"</span></span><span class="koboSpan" id="kobo.1154.1">,
]
user_df = DataFrame.from_records(
    user_data, columns=user_cols, index=df.index
)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1155.1">
     Next, we join
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1156.1">
      user_df
     </span>
    </code>
    <span class="koboSpan" id="kobo.1157.1">
     back with
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1158.1">
      df
     </span>
    </code>
    <span class="koboSpan" id="kobo.1159.1">
     (like we did with
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1160.1">
      campaign_df
     </span>
    </code>
    <span class="koboSpan" id="kobo.1161.1">
     ), and inspect the result:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1162.1">#13</span></span><span class="koboSpan" id="kobo.1163.1">
df = df.join(user_df)
df[[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1164.1">"user"</span></span><span class="koboSpan" id="kobo.1165.1">] + user_cols].head(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1166.1">2</span></span><span class="koboSpan" id="kobo.1167.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1168.1">
     The output
    </span>
    <a id="_idIndexMarker1165">
    </a>
    <span class="koboSpan" id="kobo.1169.1">
     shows us that everything went well.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-341">
    <span class="koboSpan" id="kobo.1170.1">
     Renaming columns
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.1171.1">
     If you
    </span>
    <a id="_idIndexMarker1166">
    </a>
    <span class="koboSpan" id="kobo.1172.1">
     evaluate
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1173.1">
      df.columns
     </span>
    </code>
    <span class="koboSpan" id="kobo.1174.1">
     in a cell, you will see that we still have ugly names for our columns.
    </span>
    <span class="koboSpan" id="kobo.1174.2">
     Let us change that:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1175.1">#14</span></span><span class="koboSpan" id="kobo.1176.1">
new_column_names = {
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1177.1">"cmp_bgt"</span></span><span class="koboSpan" id="kobo.1178.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1179.1">"Budget"</span></span><span class="koboSpan" id="kobo.1180.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1181.1">"cmp_spent"</span></span><span class="koboSpan" id="kobo.1182.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1183.1">"Spent"</span></span><span class="koboSpan" id="kobo.1184.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1185.1">"cmp_clicks"</span></span><span class="koboSpan" id="kobo.1186.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1187.1">"Clicks"</span></span><span class="koboSpan" id="kobo.1188.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1189.1">"cmp_impr"</span></span><span class="koboSpan" id="kobo.1190.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1191.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1192.1">Impressions"</span></span><span class="koboSpan" id="kobo.1193.1">,
}
df.rename(columns=new_column_names, inplace=</span><span class="hljs-literal"><span class="koboSpan" id="kobo.1194.1">True</span></span><span class="koboSpan" id="kobo.1195.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1196.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1197.1">
      rename()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1198.1">
     method can be used to change the column (or row) labels.
    </span>
    <span class="koboSpan" id="kobo.1198.2">
     We have given it a dictionary mapping old column names to our preferred names.
    </span>
    <span class="koboSpan" id="kobo.1198.3">
     Any column that is not mentioned in the dictionary will remain unchanged.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-342">
    <span class="koboSpan" id="kobo.1199.1">
     Computing some metrics
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.1200.1">
     Our
    </span>
    <a id="_idIndexMarker1167">
    </a>
    <span class="koboSpan" id="kobo.1201.1">
     next step will be to add some additional columns.
    </span>
    <span class="koboSpan" id="kobo.1201.2">
     For each campaign, we have the number of clicks and impressions, and we have the amounts spent.
    </span>
    <span class="koboSpan" id="kobo.1201.3">
     This allows us to introduce three measurement ratios:
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1202.1">
      CTR
     </span>
    </code>
    <span class="koboSpan" id="kobo.1203.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1204.1">
      CPC
     </span>
    </code>
    <span class="koboSpan" id="kobo.1205.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1206.1">
      CPI
     </span>
    </code>
    <span class="koboSpan" id="kobo.1207.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1207.2">
     They stand for
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1208.1">
      Click Through Rate
     </span>
    </em>
    <span class="koboSpan" id="kobo.1209.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1210.1">
      Cost Per Click
     </span>
    </em>
    <span class="koboSpan" id="kobo.1211.1">
     , and
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1212.1">
      Cost Per Impression
     </span>
    </em>
    <span class="koboSpan" id="kobo.1213.1">
     , respectively.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1214.1">
     The last two are straightforward, but
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1215.1">
      CTR
     </span>
    </code>
    <span class="koboSpan" id="kobo.1216.1">
     is not.
    </span>
    <span class="koboSpan" id="kobo.1216.2">
     Suffice it to say that it is the ratio between clicks and impressions.
    </span>
    <span class="koboSpan" id="kobo.1216.3">
     It gives you a measure of how many clicks were performed on a campaign advertisement per impression—the higher this number, the more successful the advertisement is in attracting users to click on it.
    </span>
    <span class="koboSpan" id="kobo.1216.4">
     Let us write a
    </span>
    <a id="_idIndexMarker1168">
    </a>
    <span class="koboSpan" id="kobo.1217.1">
     function that calculates all three ratios and adds them to the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1218.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1219.1">
     :
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1220.1">#15</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1221.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1222.1">calculate_metrics</span></span><span class="koboSpan" id="kobo.1223.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1224.1">df</span></span><span class="koboSpan" id="kobo.1225.1">):
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1226.1"># Click Through Rate</span></span><span class="koboSpan" id="kobo.1227.1">
    df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1228.1">"CTR"</span></span><span class="koboSpan" id="kobo.1229.1">] = df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1230.1">"Clicks"</span></span><span class="koboSpan" id="kobo.1231.1">] / df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1232.1">"Impressions"</span></span><span class="koboSpan" id="kobo.1233.1">]
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1234.1"># Cost Per Click</span></span><span class="koboSpan" id="kobo.1235.1">
    df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1236.1">"CPC"</span></span><span class="koboSpan" id="kobo.1237.1">] = df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1238.1">"Spent"</span></span><span class="koboSpan" id="kobo.1239.1">] / df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1240.1">"Clicks"</span></span><span class="koboSpan" id="kobo.1241.1">]
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1242.1"># Cost Per Impression</span></span><span class="koboSpan" id="kobo.1243.1">
    df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1244.1">"CPI"</span></span><span class="koboSpan" id="kobo.1245.1">] = df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1246.1">"Spent"</span></span><span class="koboSpan" id="kobo.1247.1">] / df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1248.1">"Impressions"</span></span><span class="koboSpan" id="kobo.1249.1">]
calculate_metrics(df)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1250.1">
     Notice that we are adding those three columns with one line of code each, but the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1251.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1252.1">
     applies the operation automatically (the division, in this case) to each pair of cells from the appropriate columns.
    </span>
    <span class="koboSpan" id="kobo.1252.2">
     So, even though it looks like we are only doing three divisions, there are actually
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1253.1">
      5,140 * 3
     </span>
    </em>
    <span class="koboSpan" id="kobo.1254.1">
     divisions because they are performed for each row.
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1255.1">
      pandas
     </span>
    </code>
    <span class="koboSpan" id="kobo.1256.1">
     does a lot of work for us while hiding much of the complexity of it.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1257.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1258.1">
      calculate_metrics()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1259.1">
     function takes a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1260.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1261.1">
     (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1262.1">
      df
     </span>
    </code>
    <span class="koboSpan" id="kobo.1263.1">
     ) and works directly on it.
    </span>
    <span class="koboSpan" id="kobo.1263.2">
     This
    </span>
    <a id="_idIndexMarker1169">
    </a>
    <span class="koboSpan" id="kobo.1264.1">
     mode of operation is called
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.1265.1">
      in-place
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1266.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1266.2">
     This is similar to how the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1267.1">
      list.sort()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1268.1">
     method sorts a list.
    </span>
    <span class="koboSpan" id="kobo.1268.2">
     You could also say that this function is not pure, which means it has side effects, as it modifies the mutable object it is passed as an argument.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1269.1">
     We can take a look at the results by filtering on the relevant columns and calling
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1270.1">
      head()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1271.1">
     :
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1272.1">#16</span></span><span class="koboSpan" id="kobo.1273.1">
df[[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1274.1">"Spent"</span></span><span class="koboSpan" id="kobo.1275.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1276.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1277.1">Clicks"</span></span><span class="koboSpan" id="kobo.1278.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1279.1">"Impressions"</span></span><span class="koboSpan" id="kobo.1280.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1281.1">"CTR"</span></span><span class="koboSpan" id="kobo.1282.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1283.1">"CPC"</span></span><span class="koboSpan" id="kobo.1284.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1285.1">"CPI"</span></span><span class="koboSpan" id="kobo.1286.1">]].head(
    </span><span class="hljs-number"><span class="koboSpan" id="kobo.1287.1">3</span></span><span class="koboSpan" id="kobo.1288.1">
)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1289.1">
     This shows us that the calculations were performed correctly on each row:
    </span>
   </p>
   <table class="table-container" id="table006">
    <tbody>
     <tr>
      <td class="table-cell">
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1290.1">
          Spent
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1291.1">
          Clicks
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1292.1">
          Impressions
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1293.1">
          CTR
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1294.1">
          CPC
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1295.1">
          CPI
         </span>
        </strong>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1296.1">
         0
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1297.1">
         29586
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1298.1">
         36632
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1299.1">
         500001
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1300.1">
         0.073264
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1301.1">
         0.807655
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1302.1">
         0.059172
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1303.1">
         1
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1304.1">
         166010
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1305.1">
         67325
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1306.1">
         499999
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1307.1">
         0.134650
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1308.1">
         2.465800
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1309.1">
         0.332021
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1310.1">
         2
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1311.1">
         125738
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1312.1">
         29989
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1313.1">
         499997
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1314.1">
         0.059978
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1315.1">
         4.192804
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1316.1">
         0.251478
        </span>
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <p class="normal">
    <span class="koboSpan" id="kobo.1317.1">
     We can also
    </span>
    <a id="_idIndexMarker1170">
    </a>
    <span class="koboSpan" id="kobo.1318.1">
     verify the accuracy of the results manually for the first row:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1319.1">#17</span></span><span class="koboSpan" id="kobo.1320.1">
clicks = df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1321.1">"Clicks"</span></span><span class="koboSpan" id="kobo.1322.1">][</span><span class="hljs-number"><span class="koboSpan" id="kobo.1323.1">0</span></span><span class="koboSpan" id="kobo.1324.1">]
impressions = df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1325.1">"Impressions"</span></span><span class="koboSpan" id="kobo.1326.1">][</span><span class="hljs-number"><span class="koboSpan" id="kobo.1327.1">0</span></span><span class="koboSpan" id="kobo.1328.1">]
spent = df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1329.1">"Spent"</span></span><span class="koboSpan" id="kobo.1330.1">][</span><span class="hljs-number"><span class="koboSpan" id="kobo.1331.1">0</span></span><span class="koboSpan" id="kobo.1332.1">]
CTR = df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1333.1">"CTR"</span></span><span class="koboSpan" id="kobo.1334.1">][</span><span class="hljs-number"><span class="koboSpan" id="kobo.1335.1">0</span></span><span class="koboSpan" id="kobo.1336.1">]
CPC = df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1337.1">"CPC"</span></span><span class="koboSpan" id="kobo.1338.1">][</span><span class="hljs-number"><span class="koboSpan" id="kobo.1339.1">0</span></span><span class="koboSpan" id="kobo.1340.1">]
CPI = df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1341.1">"CPI"</span></span><span class="koboSpan" id="kobo.1342.1">][</span><span class="hljs-number"><span class="koboSpan" id="kobo.1343.1">0</span></span><span class="koboSpan" id="kobo.1344.1">]
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1345.1">print</span></span><span class="koboSpan" id="kobo.1346.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1347.1">"CTR:"</span></span><span class="koboSpan" id="kobo.1348.1">, CTR, clicks / impressions)
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1349.1">print</span></span><span class="koboSpan" id="kobo.1350.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1351.1">"CPC:"</span></span><span class="koboSpan" id="kobo.1352.1">, CPC, spent / clicks)
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1353.1">print</span></span><span class="koboSpan" id="kobo.1354.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1355.1">"CPI:"</span></span><span class="koboSpan" id="kobo.1356.1">, CPI, spent / impressions)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1357.1">
     This yields the following output:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1358.1">CTR: </span><span class="hljs-number"><span class="koboSpan" id="kobo.1359.1">0.07326385347229306 0.07326385347229306</span></span><span class="koboSpan" id="kobo.1360.1">
CPC: </span><span class="hljs-number"><span class="koboSpan" id="kobo.1361.1">0.8076545097182791 0.8076545097182791</span></span><span class="koboSpan" id="kobo.1362.1">
CPI: </span><span class="hljs-number"><span class="koboSpan" id="kobo.1363.1">0.059171881656236686 0.059171881656236686</span></span>
</code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1364.1">
     The values match, confirming that our computations are correct.
    </span>
    <span class="koboSpan" id="kobo.1364.2">
     Of course, we would not normally need to do this, but we wanted to show you how can you perform such calculations.
    </span>
    <span class="koboSpan" id="kobo.1364.3">
     You can access a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1365.1">
      Series
     </span>
    </code>
    <span class="koboSpan" id="kobo.1366.1">
     (a column) by passing its name to the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1367.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1368.1">
     in square brackets (this is similar to looking up a key in a dictionary).
    </span>
    <span class="koboSpan" id="kobo.1368.2">
     You can then access each row in the column by its position, exactly as you would with a regular list or tuple.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1369.1">
     We are almost done with our
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1370.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1371.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1371.2">
     All we are missing now is a column that tells us the duration of the campaign and a column that tells us which day of the week each
    </span>
    <a id="_idIndexMarker1171">
    </a>
    <span class="koboSpan" id="kobo.1372.1">
     campaign started on.
    </span>
    <span class="koboSpan" id="kobo.1372.2">
     The duration is important to have, since it allows us to relate data such as the amount spent or number of impressions to the duration of the campaign (we may expect longer-running campaigns to cost more and have more impressions).
    </span>
    <span class="koboSpan" id="kobo.1372.3">
     The day of the week can also be useful; for example, some campaigns may be tied to events that happen on particular days of the week (such as sports events that take place on weekends).
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1373.1">#18</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1374.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1375.1">get_day_of_the_week</span></span><span class="koboSpan" id="kobo.1376.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1377.1">day</span></span><span class="koboSpan" id="kobo.1378.1">):
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1379.1">return</span></span><span class="koboSpan" id="kobo.1380.1"> day.strftime(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1381.1">"%A"</span></span><span class="koboSpan" id="kobo.1382.1">)
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1383.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1384.1">get_duration</span></span><span class="koboSpan" id="kobo.1385.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1386.1">row</span></span><span class="koboSpan" id="kobo.1387.1">):
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1388.1">return</span></span><span class="koboSpan" id="kobo.1389.1"> (row[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1390.1">"End"</span></span><span class="koboSpan" id="kobo.1391.1">] - row[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1392.1">"Start"</span></span><span class="koboSpan" id="kobo.1393.1">]).days
df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1394.1">"Day of Week"</span></span><span class="koboSpan" id="kobo.1395.1">] = df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1396.1">"Start"</span></span><span class="koboSpan" id="kobo.1397.1">].apply(get_day_of_the_week)
df[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1398.1">"Duration"</span></span><span class="koboSpan" id="kobo.1399.1">] = df.apply(get_duration, axis=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1400.1">"columns"</span></span><span class="koboSpan" id="kobo.1401.1">)
</span></code></pre>
   <p class="normal">
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1402.1">
      get_day_of_the_week()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1403.1">
     takes a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1404.1">
      date
     </span>
    </code>
    <span class="koboSpan" id="kobo.1405.1">
     object and formats it as a string that only contains the name of the corresponding day of the week.
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1406.1">
      get_duration()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1407.1">
     is more interesting.
    </span>
    <span class="koboSpan" id="kobo.1407.2">
     First, notice that it takes an entire row, not just a single value.
    </span>
    <span class="koboSpan" id="kobo.1407.3">
     This function subtracts a campaign’s start date from the end date.
    </span>
    <span class="koboSpan" id="kobo.1407.4">
     When you subtract
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1408.1">
      date
     </span>
    </code>
    <span class="koboSpan" id="kobo.1409.1">
     objects, the result is a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1410.1">
      timedelta
     </span>
    </code>
    <span class="koboSpan" id="kobo.1411.1">
     object, which represents a given amount of time.
    </span>
    <span class="koboSpan" id="kobo.1411.2">
     We take the value of its
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1412.1">
      .days
     </span>
    </code>
    <span class="koboSpan" id="kobo.1413.1">
     property to get the duration in days.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1414.1">
     We calculate the starting day of the week for each campaign by applying
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1415.1">
      get_day_of_the_week()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1416.1">
     to the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1417.1">
      Start
     </span>
    </code>
    <span class="koboSpan" id="kobo.1418.1">
     column (as a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1419.1">
      Series
     </span>
    </code>
    <span class="koboSpan" id="kobo.1420.1">
     object); this is similar to what we did with
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1421.1">
      "user"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1422.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1423.1">
      "cmp_name"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1424.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1424.2">
     Next, we apply
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1425.1">
      get_duration()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1426.1">
     to the whole
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1427.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1428.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1428.2">
     Note that we instruct
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1429.1">
      pandas
     </span>
    </code>
    <span class="koboSpan" id="kobo.1430.1">
     to operate on the rows by passing
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1431.1">
      axis="columns"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1432.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1432.2">
     This may seem counter-intuitive but think of it as passing all the columns to each call of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1433.1">
      get_duration()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1434.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1435.1">
     We can verify the results as shown in the next cell:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1436.1">#19</span></span><span class="koboSpan" id="kobo.1437.1">
df[[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1438.1">"Start"</span></span><span class="koboSpan" id="kobo.1439.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1440.1">"End"</span></span><span class="koboSpan" id="kobo.1441.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1442.1">"Duration"</span></span><span class="koboSpan" id="kobo.1443.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1444.1">"Day of Week"</span></span><span class="koboSpan" id="kobo.1445.1">]].head(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1446.1">3</span></span><span class="koboSpan" id="kobo.1447.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1448.1">
     This gives the following output:
    </span>
   </p>
   <table class="table-container" id="table007">
    <tbody>
     <tr>
      <td class="table-cell">
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1449.1">
          Start
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1450.1">
          End
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1451.1">
          Duration
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1452.1">
          Day of Week
         </span>
        </strong>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1453.1">
          0
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1454.1">
          2025-04-04
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1455.1">
          2025-09-16
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1456.1">
         165
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1457.1">
          Friday
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1458.1">
          1
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1459.1">
          2024-01-30
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1460.1">
          2024-10-17
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1461.1">
         261
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1462.1">
          Tuesday
         </span>
        </code>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1463.1">
          2
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1464.1">
          2023-08-28
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1465.1">
          2025-01-15
         </span>
        </code>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1466.1">
         506
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <code class="inlineCode">
         <span class="koboSpan" id="kobo.1467.1">
          Monday
         </span>
        </code>
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <p class="normal">
    <span class="koboSpan" id="kobo.1468.1">
     So, we now
    </span>
    <a id="_idIndexMarker1172">
    </a>
    <span class="koboSpan" id="kobo.1469.1">
     know that there are 165 days between the 4th of April, 2025, and the 16th of September, 2025, and that the 15th of January, 2025, is a Monday.
    </span>
   </p>
   <h3 class="heading-3" id="_idParaDest-343">
    <span class="koboSpan" id="kobo.1470.1">
     Cleaning everything up
    </span>
   </h3>
   <p class="normal">
    <span class="koboSpan" id="kobo.1471.1">
     Now that
    </span>
    <a id="_idIndexMarker1173">
    </a>
    <span class="koboSpan" id="kobo.1472.1">
     we have everything we want, it is time to do the final cleaning; remember we still have the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1473.1">
      "cmp_name"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1474.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1475.1">
      "user"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1476.1">
     columns.
    </span>
    <span class="koboSpan" id="kobo.1476.2">
     Those are no longer needed, so we will remove them.
    </span>
    <span class="koboSpan" id="kobo.1476.3">
     We also want to reorder the columns in our
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1477.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1478.1">
     so that they are more relevant to the data it now contains.
    </span>
    <span class="koboSpan" id="kobo.1478.2">
     We can accomplish this by filtering
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1479.1">
      df
     </span>
    </code>
    <span class="koboSpan" id="kobo.1480.1">
     on the column list we want.
    </span>
    <span class="koboSpan" id="kobo.1480.2">
     The result is a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1481.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1482.1">
     that we can reassign to the name
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1483.1">
      df
     </span>
    </code>
    <span class="koboSpan" id="kobo.1484.1">
     :
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1485.1">#19</span></span><span class="koboSpan" id="kobo.1486.1">
final_columns = [
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1487.1">"Type"</span></span><span class="koboSpan" id="kobo.1488.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1489.1">"Start"</span></span><span class="koboSpan" id="kobo.1490.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1491.1">"End"</span></span><span class="koboSpan" id="kobo.1492.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1493.1">"Duration"</span></span><span class="koboSpan" id="kobo.1494.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1495.1">"Day of Week"</span></span><span class="koboSpan" id="kobo.1496.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1497.1">"Budget"</span></span><span class="koboSpan" id="kobo.1498.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1499.1">"Currency"</span></span><span class="koboSpan" id="kobo.1500.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1501.1">"Clicks"</span></span><span class="koboSpan" id="kobo.1502.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1503.1">"Impressions"</span></span><span class="koboSpan" id="kobo.1504.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1505.1">"Spent"</span></span><span class="koboSpan" id="kobo.1506.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1507.1">"CTR"</span></span><span class="koboSpan" id="kobo.1508.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1509.1">"CPC"</span></span><span class="koboSpan" id="kobo.1510.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1511.1">"CPI"</span></span><span class="koboSpan" id="kobo.1512.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1513.1">"Target Age"</span></span><span class="koboSpan" id="kobo.1514.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1515.1">"Target Gender"</span></span><span class="koboSpan" id="kobo.1516.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1517.1">"Username"</span></span><span class="koboSpan" id="kobo.1518.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1519.1">"Email"</span></span><span class="koboSpan" id="kobo.1520.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1521.1">"Name"</span></span><span class="koboSpan" id="kobo.1522.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1523.1">"Gender"</span></span><span class="koboSpan" id="kobo.1524.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1525.1">"Age"</span></span><span class="koboSpan" id="kobo.1526.1">,
]
df = df[final_columns]
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1527.1">
     We have
    </span>
    <a id="_idIndexMarker1174">
    </a>
    <span class="koboSpan" id="kobo.1528.1">
     grouped the campaign information at the beginning, then the measurements, and finally the user data at the end.
    </span>
    <span class="koboSpan" id="kobo.1528.2">
     Now our
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1529.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1530.1">
     is clean and ready for us to inspect.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1531.1">
     Before we start creating some graphs, we want to take a snapshot of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1532.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1533.1">
     so that we can easily reconstruct it from a file without needing to redo all the steps we did to get here.
    </span>
    <span class="koboSpan" id="kobo.1533.2">
     Some analysts may want to have it in spreadsheet form, to do a different kind of analysis, so let us see how to save a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1534.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1535.1">
     to a file.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-344">
    <span class="koboSpan" id="kobo.1536.1">
     Saving the DataFrame to a file
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.1537.1">
     We can
    </span>
    <a id="_idIndexMarker1175">
    </a>
    <span class="koboSpan" id="kobo.1538.1">
     save a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1539.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1540.1">
     in several formats.
    </span>
    <span class="koboSpan" id="kobo.1540.2">
     You can type
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1541.1">
      df.to_
     </span>
    </code>
    <span class="koboSpan" id="kobo.1542.1">
     and then press
    </span>
    <em class="keystroke">
     <span class="koboSpan" id="kobo.1543.1">
      Tab
     </span>
    </em>
    <span class="koboSpan" id="kobo.1544.1">
     to make autocompletion pop up, so you can see all the options.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1545.1">
     We are going to save our
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1546.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1547.1">
     in three different formats.
    </span>
    <span class="koboSpan" id="kobo.1547.2">
     First, CSV:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1548.1">#20</span></span><span class="koboSpan" id="kobo.1549.1">
df.to_csv(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1550.1">"df.csv"</span></span><span class="koboSpan" id="kobo.1551.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1552.1">
     Then JSON:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1553.1">#21</span></span><span class="koboSpan" id="kobo.1554.1">
df.to_json(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1555.1">"df.json"</span></span><span class="koboSpan" id="kobo.1556.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1557.1">
     And finally, in an Excel spreadsheet:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1558.1">#22</span></span><span class="koboSpan" id="kobo.1559.1">
df.to_excel(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1560.1">"df.xlsx"</span></span><span class="koboSpan" id="kobo.1561.1">)
</span></code></pre>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.1562.1">
      The
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1563.1">
       to_excel()
      </span>
     </code>
     <span class="koboSpan" id="kobo.1564.1">
      method requires the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1565.1">
       openpyxl
      </span>
     </code>
     <span class="koboSpan" id="kobo.1566.1">
      package to be installed.
     </span>
     <span class="koboSpan" id="kobo.1566.2">
      It is included in the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1567.1">
       requirements.txt
      </span>
     </code>
     <span class="koboSpan" id="kobo.1568.1">
      file for this chapter, so if you used that to install the requirements, you should have it in your virtual environment.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.1569.1">
     As you
    </span>
    <a id="_idIndexMarker1176">
    </a>
    <span class="koboSpan" id="kobo.1570.1">
     can see, it is easy to save a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1571.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1572.1">
     in many different formats.
    </span>
    <span class="koboSpan" id="kobo.1572.2">
     The good news is that the reverse is also true: it’s equally easy to load a spreadsheet into a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1573.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1574.1">
     (just use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1575.1">
      pandas read_csv()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1576.1">
     or
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1577.1">
      read_excel()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1578.1">
     functions).
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-345">
    <span class="koboSpan" id="kobo.1579.1">
     Visualizing the results
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.1580.1">
     In this section, we
    </span>
    <a id="_idIndexMarker1177">
    </a>
    <span class="koboSpan" id="kobo.1581.1">
     are going to visualize some results.
    </span>
    <span class="koboSpan" id="kobo.1581.2">
     From a data science perspective, we are not going to attempt an in-depth analysis of the data or try to draw any conclusions from it.
    </span>
    <span class="koboSpan" id="kobo.1581.3">
     It would not make much sense because the data is completely random.
    </span>
    <span class="koboSpan" id="kobo.1581.4">
     However, this example should still be enough to get you started with graphs and other features.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1582.1">
     One lesson that we have learned the hard way is that appearance makes a difference in how people perceive your work.
    </span>
    <span class="koboSpan" id="kobo.1582.2">
     If you want to be taken seriously, think carefully about how you present your data and try to make your graphs and tables look appealing.
    </span>
   </p>
   <p class="normal">
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1583.1">
      pandas
     </span>
    </code>
    <span class="koboSpan" id="kobo.1584.1">
     uses the Matplotlib plotting library to draw graphs.
    </span>
    <span class="koboSpan" id="kobo.1584.2">
     We will not be using it directly, except to configure the plot style and save plots to disk.
    </span>
    <span class="koboSpan" id="kobo.1584.3">
     You can learn more about this versatile
    </span>
    <a id="_idIndexMarker1178">
    </a>
    <span class="koboSpan" id="kobo.1585.1">
     plotting library at
    </span>
    <a href="https://matplotlib.org/">
     <span class="url">
      <span class="koboSpan" id="kobo.1586.1">
       https://matplotlib.org/
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.1587.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1588.1">
     First, we will configure the Notebook to render Matplotlib graphs as interactive widgets in the cell output frame.
    </span>
    <span class="koboSpan" id="kobo.1588.2">
     We do it with the following:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1589.1">#23</span></span><span class="koboSpan" id="kobo.1590.1">
%matplotlib widget
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1591.1">
     This will allow you to pan and zoom the figure and save a (low-resolution) snapshot to disk.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.1592.1">
      By default (without
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1593.1">
       %matplotlib widget
      </span>
     </code>
     <span class="koboSpan" id="kobo.1594.1">
      ), figures will be rendered as static images in the cell output frame.
     </span>
     <span class="koboSpan" id="kobo.1594.2">
      Using the interactive widget mode requires the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1595.1">
       ipympl
      </span>
     </code>
     <span class="koboSpan" id="kobo.1596.1">
      package to be installed.
     </span>
     <span class="koboSpan" id="kobo.1596.2">
      It is included in the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1597.1">
       requirements.txt
      </span>
     </code>
     <span class="koboSpan" id="kobo.1598.1">
      file for this chapter, so if you used that to install the requirements, you should have it in your virtual environment.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.1599.1">
     Then, we set up some styling for our plots:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1600.1">#24</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1601.1">import</span></span><span class="koboSpan" id="kobo.1602.1"> matplotlib.pyplot </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1603.1">as</span></span><span class="koboSpan" id="kobo.1604.1"> plt
plt.style.use([</span><span class="hljs-string"><span class="koboSpan" id="kobo.1605.1">"classic"</span></span><span class="koboSpan" id="kobo.1606.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1607.1">"ggplot"</span></span><span class="koboSpan" id="kobo.1608.1">])
plt.rc(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1609.1">"font"</span></span><span class="koboSpan" id="kobo.1610.1">, family=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1611.1">"serif"</span></span><span class="koboSpan" id="kobo.1612.1">})
plt.rc(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1613.1">"savefig"</span></span><span class="koboSpan" id="kobo.1614.1">, dpi=</span><span class="hljs-number"><span class="koboSpan" id="kobo.1615.1">300</span></span><span class="koboSpan" id="kobo.1616.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1617.1">
     We
    </span>
    <a id="_idIndexMarker1179">
    </a>
    <span class="koboSpan" id="kobo.1618.1">
     use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1619.1">
      matplotlib.pyplot
     </span>
    </code>
    <span class="koboSpan" id="kobo.1620.1">
     interface to set the plot style.
    </span>
    <span class="koboSpan" id="kobo.1620.2">
     We have chosen to use a combination of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1621.1">
      classic
     </span>
    </code>
    <span class="koboSpan" id="kobo.1622.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1623.1">
      ggplot
     </span>
    </code>
    <span class="koboSpan" id="kobo.1624.1">
     style sheets.
    </span>
    <span class="koboSpan" id="kobo.1624.2">
     Style sheets are applied from left to right, so here
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1625.1">
      ggplot
     </span>
    </code>
    <span class="koboSpan" id="kobo.1626.1">
     will override the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1627.1">
      classic
     </span>
    </code>
    <span class="koboSpan" id="kobo.1628.1">
     style for any style items that are defined in both.
    </span>
    <span class="koboSpan" id="kobo.1628.2">
     We also set the font family used in the plots to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1629.1">
      serif
     </span>
    </code>
    <span class="koboSpan" id="kobo.1630.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1630.2">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1631.1">
      plt.rc("savefig", dpi=300)
     </span>
    </code>
    <span class="koboSpan" id="kobo.1632.1">
     call, configures the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1633.1">
      savefig()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1634.1">
     method to generate high-resolution image files that are suitable for printing.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1635.1">
     Before we generate any graphs, let us run
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1636.1">
      df.describe()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1637.1">
     (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1638.1">
      #26
     </span>
    </code>
    <span class="koboSpan" id="kobo.1639.1">
     ) again.
    </span>
    <span class="koboSpan" id="kobo.1639.2">
     The results should look like this:
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.1640.1">
     <img alt="img" src="../Images/B30992_13_03.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.1641.1">
     Figure 13.3: Some statistics for our cleaned-up data
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1642.1">
     This kind of quick result is perfect for satisfying those managers who have 20 seconds to dedicate to you and just want rough numbers.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.1643.1">
      Once again, please keep in mind that our campaigns have different currencies, so these numbers are meaningless.
     </span>
     <span class="koboSpan" id="kobo.1643.2">
      The point here is to demonstrate the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1644.1">
       DataFrame
      </span>
     </code>
     <span class="koboSpan" id="kobo.1645.1">
      capabilities, not to perform a correct or detailed analysis of real data.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.1646.1">
     Alternatively, a
    </span>
    <a id="_idIndexMarker1180">
    </a>
    <span class="koboSpan" id="kobo.1647.1">
     graph is usually much better than a table with numbers because it is much easier to read, and it gives you immediate feedback.
    </span>
    <span class="koboSpan" id="kobo.1647.2">
     So, let us plot the four pieces of information we have on each campaign:
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1648.1">
      "Budget"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1649.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1650.1">
      "Spent"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1651.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1652.1">
      "Clicks"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1653.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1654.1">
      "Impressions"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1655.1">
     :
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1656.1">#27</span></span><span class="koboSpan" id="kobo.1657.1">
df[[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1658.1">"Budget"</span></span><span class="koboSpan" id="kobo.1659.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1660.1">"Spent"</span></span><span class="koboSpan" id="kobo.1661.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1662.1">"Clicks"</span></span><span class="koboSpan" id="kobo.1663.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1664.1">"Impressions"</span></span><span class="koboSpan" id="kobo.1665.1">]].hist(
    bins=</span><span class="hljs-number"><span class="koboSpan" id="kobo.1666.1">16</span></span><span class="koboSpan" id="kobo.1667.1">, figsize=(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1668.1">16</span></span><span class="koboSpan" id="kobo.1669.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.1670.1">6</span></span><span class="koboSpan" id="kobo.1671.1">)
)
plt.savefig(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1672.1">"Figure13.4.png"</span></span><span class="koboSpan" id="kobo.1673.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1674.1">
     We extract those four columns (this will give us another
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1675.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1676.1">
     made with only those columns) and call the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1677.1">
      hist()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1678.1">
     method to get a histogram plot.
    </span>
    <span class="koboSpan" id="kobo.1678.2">
     We give some arguments to specify the number of bins and figure sizes, and everything else is done automatically.
    </span>
    <span class="koboSpan" id="kobo.1678.3">
     The result looks as follows:
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.1679.1">
     <img alt="img" src="../Images/B30992_13_04.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.1680.1">
     Figure 13.4: Histogram plots of the campaign data
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1681.1">
     We
    </span>
    <a id="_idIndexMarker1181">
    </a>
    <span class="koboSpan" id="kobo.1682.1">
     also call
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1683.1">
      plt.savefig("Figure13.4.png")
     </span>
    </code>
    <span class="koboSpan" id="kobo.1684.1">
     to save the image to a file named
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1685.1">
      Figure13.4.png
     </span>
    </code>
    <span class="koboSpan" id="kobo.1686.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1686.2">
     This will use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1687.1">
      300dpi
     </span>
    </code>
    <span class="koboSpan" id="kobo.1688.1">
     setting we configured previously to generate a high-resolution image.
    </span>
    <span class="koboSpan" id="kobo.1688.2">
     Note that
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1689.1">
      plt.savefig()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1690.1">
     will save the most recent image generated by Matplotlib.
    </span>
    <span class="koboSpan" id="kobo.1690.2">
     Calling it from the same cell where we generate the plot ensures that we save the correct image to the correct filename.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1691.1">
     Although it is meaningless to try to interpret plots of random data, we can at least verify that what we see matches what we might expect, given how the data was generated.
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <em class="italic">
      <span class="koboSpan" id="kobo.1692.1">
       Budget
      </span>
     </em>
     <span class="koboSpan" id="kobo.1693.1">
      is selected randomly from an interval, so we expect a uniform distribution.
     </span>
     <span class="koboSpan" id="kobo.1693.2">
      Looking at the graph, that is indeed what we see.
     </span>
    </li>
    <li class="bulletList">
     <em class="italic">
      <span class="koboSpan" id="kobo.1694.1">
       Spent
      </span>
     </em>
     <span class="koboSpan" id="kobo.1695.1">
      is also uniformly distributed, but its upper limit is the budget, which is not constant.
     </span>
     <span class="koboSpan" id="kobo.1695.2">
      This means we should expect a logarithmic curve that decreases from left to right.
     </span>
     <span class="koboSpan" id="kobo.1695.3">
      Again, that matches what the graph shows.
     </span>
    </li>
    <li class="bulletList">
     <em class="italic">
      <span class="koboSpan" id="kobo.1696.1">
       Clicks
      </span>
     </em>
     <span class="koboSpan" id="kobo.1697.1">
      was generated with a triangular distribution with a mean 20% of the interval size, and you can see that the peak is right there, at about 20% to the left.
     </span>
    </li>
    <li class="bulletList">
     <em class="italic">
      <span class="koboSpan" id="kobo.1698.1">
       Impressions
      </span>
     </em>
     <span class="koboSpan" id="kobo.1699.1">
      was a Gaussian distribution, which assumes the famous bell shape.
     </span>
     <span class="koboSpan" id="kobo.1699.2">
      The mean was exactly in the middle and we had a standard deviation of 2.
     </span>
     <span class="koboSpan" id="kobo.1699.3">
      You can see that the graph matches those parameters.
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.1700.1">
     Let us also
    </span>
    <a id="_idIndexMarker1182">
    </a>
    <span class="koboSpan" id="kobo.1701.1">
     plot the metrics we calculated:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1702.1">#28</span></span><span class="koboSpan" id="kobo.1703.1">
df[[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1704.1">"CTR"</span></span><span class="koboSpan" id="kobo.1705.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1706.1">"CPC"</span></span><span class="koboSpan" id="kobo.1707.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1708.1">"CPI"</span></span><span class="koboSpan" id="kobo.1709.1">]].hist(bins=</span><span class="hljs-number"><span class="koboSpan" id="kobo.1710.1">20</span></span><span class="koboSpan" id="kobo.1711.1">, figsize=(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1712.1">16</span></span><span class="koboSpan" id="kobo.1713.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.1714.1">6</span></span><span class="koboSpan" id="kobo.1715.1">))
plt.savefig(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1716.1">"Figure13.5.png"</span></span><span class="koboSpan" id="kobo.1717.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1718.1">
     Here is the plot representation:
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.1719.1">
     <img alt="img" src="../Images/B30992_13_05.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.1720.1">
     Figure 13.5: Histogram plots of computed measures
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1721.1">
     We can see that the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1722.1">
      CPC
     </span>
    </em>
    <span class="koboSpan" id="kobo.1723.1">
     is highly skewed to the left, meaning that most of the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1724.1">
      CPC
     </span>
    </em>
    <span class="koboSpan" id="kobo.1725.1">
     values are low.
    </span>
    <span class="koboSpan" id="kobo.1725.2">
     The
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1726.1">
      CPI
     </span>
    </em>
    <span class="koboSpan" id="kobo.1727.1">
     has a similar shape but is less extreme.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1728.1">
     Now, suppose you want to analyze only a particular segment of the data.
    </span>
    <span class="koboSpan" id="kobo.1728.2">
     We can apply a mask to the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1729.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1730.1">
     so that we get a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1731.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1732.1">
     with only the rows that satisfy the mask condition.
    </span>
    <span class="koboSpan" id="kobo.1732.2">
     It is like applying a global, row-wise
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1733.1">
      if
     </span>
    </code>
    <span class="koboSpan" id="kobo.1734.1">
     clause:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1735.1">#29</span></span><span class="koboSpan" id="kobo.1736.1">
selector = df.Spent &gt; df.Budget * </span><span class="hljs-number"><span class="koboSpan" id="kobo.1737.1">0.75</span></span><span class="koboSpan" id="kobo.1738.1">
df[selector][[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1739.1">"Budget"</span></span><span class="koboSpan" id="kobo.1740.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1741.1">"Spent"</span></span><span class="koboSpan" id="kobo.1742.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1743.1">"Clicks"</span></span><span class="koboSpan" id="kobo.1744.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1745.1">"Impressions"</span></span><span class="koboSpan" id="kobo.1746.1">]].hist(
    bins=</span><span class="hljs-number"><span class="koboSpan" id="kobo.1747.1">15</span></span><span class="koboSpan" id="kobo.1748.1">, figsize=(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1749.1">16</span></span><span class="koboSpan" id="kobo.1750.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.1751.1">6</span></span><span class="koboSpan" id="kobo.1752.1">), color=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1753.1">"green"</span></span><span class="koboSpan" id="kobo.1754.1">
)
plt.savefig(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1755.1">"Figure13.6.png"</span></span><span class="koboSpan" id="kobo.1756.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1757.1">
     In this case, we prepared
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1758.1">
      selector
     </span>
    </code>
    <span class="koboSpan" id="kobo.1759.1">
     to filter out all the rows for which the amount spent is less
    </span>
    <a id="_idIndexMarker1183">
    </a>
    <span class="koboSpan" id="kobo.1760.1">
     than or equal to 75% of the budget.
    </span>
    <span class="koboSpan" id="kobo.1760.2">
     In other words, we will include only those campaigns for which we have spent at least three-quarters of the budget.
    </span>
    <span class="koboSpan" id="kobo.1760.3">
     Notice that in
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1761.1">
      selector
     </span>
    </code>
    <span class="koboSpan" id="kobo.1762.1">
     , we are showing you an alternative way of asking for a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1763.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1764.1">
     column, by using direct property access (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1765.1">
      object.property_name
     </span>
    </code>
    <span class="koboSpan" id="kobo.1766.1">
     ), instead of dictionary-like access (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1767.1">
      object['property_name']
     </span>
    </code>
    <span class="koboSpan" id="kobo.1768.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.1768.2">
     If
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1769.1">
      property_name
     </span>
    </code>
    <span class="koboSpan" id="kobo.1770.1">
     is a valid Python name, you can use both ways interchangeably.
    </span>
   </p>
   <p class="normal">
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1771.1">
      selector
     </span>
    </code>
    <span class="koboSpan" id="kobo.1772.1">
     is applied in the same way that we access a dictionary with a key.
    </span>
    <span class="koboSpan" id="kobo.1772.2">
     When we apply
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1773.1">
      selector
     </span>
    </code>
    <span class="koboSpan" id="kobo.1774.1">
     to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1775.1">
      df
     </span>
    </code>
    <span class="koboSpan" id="kobo.1776.1">
     , we get a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1777.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1778.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1778.2">
     We select only the relevant columns from this and call
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1779.1">
      hist()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1780.1">
     again.
    </span>
    <span class="koboSpan" id="kobo.1780.2">
     This time, we set
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1781.1">
      color
     </span>
    </code>
    <span class="koboSpan" id="kobo.1782.1">
     to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1783.1">
      green
     </span>
    </code>
    <span class="koboSpan" id="kobo.1784.1">
     , just to show how that can be done.
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.1785.1">
     <img alt="img" src="../Images/B30992_13_06.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.1786.1">
     Figure 13.6: Histogram plots of campaign data where at least 75% of the budget was spent
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1787.1">
     Note that the shapes of the graphs have not changed much, apart from the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1788.1">
      Spent
     </span>
    </em>
    <span class="koboSpan" id="kobo.1789.1">
     graph, which is quite different.
    </span>
    <span class="koboSpan" id="kobo.1789.2">
     This is because we have selected only the rows where the amount spent is at least 75% of the budget.
    </span>
    <span class="koboSpan" id="kobo.1789.3">
     This means that we are including only the rows where the amount spent is close to the budget.
    </span>
    <span class="koboSpan" id="kobo.1789.4">
     The budget numbers come from a uniform distribution.
    </span>
    <span class="koboSpan" id="kobo.1789.5">
     Therefore, the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1790.1">
      Spent
     </span>
    </em>
    <span class="koboSpan" id="kobo.1791.1">
     graph is now assuming that kind of shape.
    </span>
    <span class="koboSpan" id="kobo.1791.2">
     If you make the boundary even tighter and ask for 85% or more, you will see the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1792.1">
      Spent
     </span>
    </em>
    <span class="koboSpan" id="kobo.1793.1">
     graph become increasingly similar to
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1794.1">
      Budget
     </span>
    </em>
    <span class="koboSpan" id="kobo.1795.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1796.1">
     Let us also
    </span>
    <a id="_idIndexMarker1184">
    </a>
    <span class="koboSpan" id="kobo.1797.1">
     look at a different kind of plot.
    </span>
    <span class="koboSpan" id="kobo.1797.2">
     We will plot the sums of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1798.1">
      "Spent"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1799.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1800.1">
      "Clicks"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1801.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1802.1">
      "
     </span>
    </code>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1803.1">
      Impressions"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1804.1">
     for each day of the week.
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1805.1">#30</span></span><span class="koboSpan" id="kobo.1806.1">
df_weekday = df.groupby([</span><span class="hljs-string"><span class="koboSpan" id="kobo.1807.1">"Day of Week"</span></span><span class="koboSpan" id="kobo.1808.1">]).</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1809.1">sum</span></span><span class="koboSpan" id="kobo.1810.1">(numeric_only=</span><span class="hljs-literal"><span class="koboSpan" id="kobo.1811.1">True</span></span><span class="koboSpan" id="kobo.1812.1">)
df_weekday[[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1813.1">"Impressions"</span></span><span class="koboSpan" id="kobo.1814.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1815.1">"Spent"</span></span><span class="koboSpan" id="kobo.1816.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1817.1">"Clicks"</span></span><span class="koboSpan" id="kobo.1818.1">]].plot(
    figsize=(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1819.1">16</span></span><span class="koboSpan" id="kobo.1820.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.1821.1">6</span></span><span class="koboSpan" id="kobo.1822.1">), subplots=</span><span class="hljs-literal"><span class="koboSpan" id="kobo.1823.1">True</span></span><span class="koboSpan" id="kobo.1824.1">
)
plt.savefig(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1825.1">"Figure13.7.png"</span></span><span class="koboSpan" id="kobo.1826.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1827.1">
     The first line creates a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1828.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.1829.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1830.1">
      df_weekday
     </span>
    </code>
    <span class="koboSpan" id="kobo.1831.1">
     , by asking for a grouping by
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1832.1">
      "Day of Week"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1833.1">
     on
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1834.1">
      df
     </span>
    </code>
    <span class="koboSpan" id="kobo.1835.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1835.2">
     We then aggregate, by computing the sum within each group.
    </span>
    <span class="koboSpan" id="kobo.1835.3">
     Note that we must pass
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1836.1">
      numeric_only=True
     </span>
    </code>
    <span class="koboSpan" id="kobo.1837.1">
     to avoid errors when attempting to sum columns with non-numeric data.
    </span>
    <span class="koboSpan" id="kobo.1837.2">
     We could also have taken a different approach by selecting only the columns we need (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1838.1">
      "Day of Week"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1839.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1840.1">
      "Impressions"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1841.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1842.1">
      "Spent"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1843.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1844.1">
      "Clicks"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1845.1">
     ) before grouping and summing.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1846.1">
     Note that this time we call
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1847.1">
      plot()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1848.1">
     instead of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1849.1">
      hist()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1850.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1850.2">
     This will draw a line graph instead of a histogram.
    </span>
    <span class="koboSpan" id="kobo.1850.3">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1851.1">
      subplots=True
     </span>
    </code>
    <span class="koboSpan" id="kobo.1852.1">
     option makes
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1853.1">
      plot
     </span>
    </code>
    <span class="koboSpan" id="kobo.1854.1">
     draw three separate graphs:
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.1855.1">
     <img alt="img" src="../Images/B30992_13_07.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.1856.1">
     Figure 13.7: Plots of campaign data aggregated by day of the week
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1857.1">
     These
    </span>
    <a id="_idIndexMarker1185">
    </a>
    <span class="koboSpan" id="kobo.1858.1">
     plots show that campaigns that started on Thursdays got the most clicks and impressions, while campaigns that started on Saturdays spent the least money.
    </span>
    <span class="koboSpan" id="kobo.1858.2">
     If this were real data, this would potentially be important information to give to our clients.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1859.1">
     Note that the days are sorted alphabetically, which makes the graph difficult to read.
    </span>
    <span class="koboSpan" id="kobo.1859.2">
     We will leave it to you as an exercise to find a way to fix this.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1860.1">
     Let us finish this presentation section with a couple more things.
    </span>
    <span class="koboSpan" id="kobo.1860.2">
     First, a simple aggregation.
    </span>
    <span class="koboSpan" id="kobo.1860.3">
     We want to group by
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1861.1">
      "Target Gender"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1862.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1863.1">
      "Target Age"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1864.1">
     , and compute the mean and the standard deviation
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1865.1">
      ("std")
     </span>
    </code>
    <span class="koboSpan" id="kobo.1866.1">
     of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1867.1">
      "Impressions"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1868.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1869.1">
      "Spent"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1870.1">
     within each grouping.
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1871.1">#31</span></span><span class="koboSpan" id="kobo.1872.1">
agg_config = {
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1873.1">"Impressions"</span></span><span class="koboSpan" id="kobo.1874.1">: [</span><span class="hljs-string"><span class="koboSpan" id="kobo.1875.1">"mean"</span></span><span class="koboSpan" id="kobo.1876.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1877.1">"std"</span></span><span class="koboSpan" id="kobo.1878.1">],
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1879.1">"Spent"</span></span><span class="koboSpan" id="kobo.1880.1">: [</span><span class="hljs-string"><span class="koboSpan" id="kobo.1881.1">"mean"</span></span><span class="koboSpan" id="kobo.1882.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1883.1">"std"</span></span><span class="koboSpan" id="kobo.1884.1">],
}
df.groupby([</span><span class="hljs-string"><span class="koboSpan" id="kobo.1885.1">"Target Gender"</span></span><span class="koboSpan" id="kobo.1886.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1887.1">"Target Age"</span></span><span class="koboSpan" id="kobo.1888.1">]).agg(agg_config)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1889.1">
     We prepare a dictionary to use as the configuration.
    </span>
    <span class="koboSpan" id="kobo.1889.2">
     Then, we perform a grouping on the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1890.1">
      "Target Gender"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1891.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1892.1">
      "Target Age"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1893.1">
     columns, and we pass our configuration dictionary to the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1894.1">
      agg()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1895.1">
     method.
    </span>
    <span class="koboSpan" id="kobo.1895.2">
     The output looks like this:
    </span>
   </p>
   <table class="table-container" id="table008">
    <tbody>
     <tr>
      <td class="table-cell">
      </td>
      <td class="table-cell">
      </td>
      <td class="table-cell" colspan="2">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1896.1">
          Impressions
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell" colspan="2">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1897.1">
          Spent
         </span>
        </strong>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
      </td>
      <td class="table-cell">
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1898.1">
          mean
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1899.1">
          std
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1900.1">
          mean
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1901.1">
          std
         </span>
        </strong>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1902.1">
          Target Gender
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1903.1">
          Target Age
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
      </td>
      <td class="table-cell">
      </td>
      <td class="table-cell">
      </td>
      <td class="table-cell">
      </td>
     </tr>
     <tr>
      <td class="table-cell" rowspan="5">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1904.1">
          A
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1905.1">
         20-25
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1906.1">
         499999.245614
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1907.1">
         2.189918
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1908.1">
         217330.771930
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1909.1">
         204518.652595
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1910.1">
         20-30
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1911.1">
         499999.465517
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1912.1">
         2.210148
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1913.1">
         252261.637931
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1914.1">
         228932.088945
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1915.1">
         20-35
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1916.1">
         499998.564103
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1917.1">
         1.774006
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1918.1">
         218726.410256
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1919.1">
         215060.976707
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1920.1">
         20-40
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1921.1">
         499999.459016
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1922.1">
         1.971241
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1923.1">
         255598.213115
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1924.1">
         222697.755231
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1925.1">
         20-45
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1926.1">
         499999.574074
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1927.1">
         2.245346
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1928.1">
         216527.666667
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1929.1">
         190345.252888
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1930.1">
          ...
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1931.1">
         ...
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1932.1">
         ...
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1933.1">
         ...
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1934.1">
         ...
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1935.1">
         ...
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell" rowspan="5">
       <p class="normal">
        <strong class="keyWord">
         <span class="koboSpan" id="kobo.1936.1">
          M
         </span>
        </strong>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1937.1">
         45-50
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1938.1">
         499999.480769
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1939.1">
         2.128153
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1940.1">
         276112.557692
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1941.1">
         226975.008137
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1942.1">
         45-55
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1943.1">
         499999.306122
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1944.1">
         2.053494
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1945.1">
         267137.938776
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1946.1">
         239249.474145
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1947.1">
         45-60
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1948.1">
         499999.500000
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1949.1">
         1.984063
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1950.1">
         236623.312500
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1951.1">
         223464.578371
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1952.1">
         45-65
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1953.1">
         499999.679245
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1954.1">
         1.503503
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1955.1">
         215634.528302
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1956.1">
         223308.046968
        </span>
       </p>
      </td>
     </tr>
     <tr>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1957.1">
         45-70
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1958.1">
         499998.870370
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1959.1">
         1.822773
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1960.1">
         310267.944444
        </span>
       </p>
      </td>
      <td class="table-cell">
       <p class="normal">
        <span class="koboSpan" id="kobo.1961.1">
         242353.980346
        </span>
       </p>
      </td>
     </tr>
    </tbody>
   </table>
   <p class="normal">
    <span class="koboSpan" id="kobo.1962.1">
     Let us do one
    </span>
    <a id="_idIndexMarker1186">
    </a>
    <span class="koboSpan" id="kobo.1963.1">
     more thing before we wrap this chapter up.
    </span>
    <span class="koboSpan" id="kobo.1963.2">
     We want to show you something
    </span>
    <a id="_idIndexMarker1187">
    </a>
    <span class="koboSpan" id="kobo.1964.1">
     called a
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.1965.1">
      pivot table
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1966.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1966.2">
     A pivot table is a way of grouping data, computing an aggregate value for each group, and displaying the result in table form.
    </span>
    <span class="koboSpan" id="kobo.1966.3">
     The pivot table is an essential tool for data analysis, so let us see a simple example:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1967.1">#31</span></span><span class="koboSpan" id="kobo.1968.1">
df.pivot_table(
    values=[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1969.1">"Impressions"</span></span><span class="koboSpan" id="kobo.1970.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1971.1">"Clicks"</span></span><span class="koboSpan" id="kobo.1972.1">, </span><span class="hljs-string"><span class="koboSpan" id="kobo.1973.1">"Spent"</span></span><span class="koboSpan" id="kobo.1974.1">],
    index=[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1975.1">"Target Age"</span></span><span class="koboSpan" id="kobo.1976.1">],
    columns=[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1977.1">"Target Gender"</span></span><span class="koboSpan" id="kobo.1978.1">],
    aggfunc=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1979.1">"sum"</span></span><span class="koboSpan" id="kobo.1980.1">
)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1981.1">
     We create
    </span>
    <a id="_idIndexMarker1188">
    </a>
    <span class="koboSpan" id="kobo.1982.1">
     a pivot table that shows us the correlation between
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1983.1">
      "Target Age"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1984.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1985.1">
      "Impressions"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1986.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1987.1">
      "Clicks"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1988.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1989.1">
      "Spent"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1990.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1990.2">
     These last three will be subdivided according to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1991.1">
      "
     </span>
    </code>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1992.1">
      Target Gender"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1993.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1993.2">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1994.1">
      aggfunc
     </span>
    </code>
    <span class="koboSpan" id="kobo.1995.1">
     argument specifies the aggregation function to use, it can be a function object, the name of a function, a list of functions, or a dictionary that maps column names to functions.
    </span>
    <span class="koboSpan" id="kobo.1995.2">
     In this case, we use
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1996.1">
      "sum"
     </span>
    </code>
    <span class="koboSpan" id="kobo.1997.1">
     (the default, if no function is specified is to compute the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1998.1">
      mean
     </span>
    </code>
    <span class="koboSpan" id="kobo.1999.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.1999.2">
     The result is a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2000.1">
      DataFrame
     </span>
    </code>
    <span class="koboSpan" id="kobo.2001.1">
     containing the pivot table:
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2002.1">
     <img alt="img" src="../Images/B30992_13_08.png"/>
    </span>
   </p>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.2003.1">
     Figure 13.8: A pivot table
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2004.1">
     That brings us to the end of our data analysis project.
    </span>
    <span class="koboSpan" id="kobo.2004.2">
     We will leave you to discover more about the wonderful world of IPython, Jupyter, and data science.
    </span>
    <span class="koboSpan" id="kobo.2004.3">
     We strongly encourage you to get comfortable with the Notebook environment.
    </span>
    <span class="koboSpan" id="kobo.2004.4">
     It is much better than a console, it is practical and fun to use, and you can even create slides and documents with it.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-346">
    <span class="koboSpan" id="kobo.2005.1">
     Where do we go from here?
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.2006.1">
     Data science is indeed a fascinating subject.
    </span>
    <span class="koboSpan" id="kobo.2006.2">
     As we said in the introduction, those who want to delve into its meanders need to have a solid foundation in mathematics and statistics.
    </span>
    <span class="koboSpan" id="kobo.2006.3">
     Working with data that has been interpolated incorrectly renders any result about it useless.
    </span>
    <span class="koboSpan" id="kobo.2006.4">
     The same goes for data that has been extrapolated incorrectly or sampled with the wrong frequency.
    </span>
    <span class="koboSpan" id="kobo.2006.5">
     To give you an example, imagine a population of individuals that are aligned in a queue.
    </span>
    <span class="koboSpan" id="kobo.2006.6">
     If, for some reason, the gender of that population alternated between male and female, the queue would look something like this: F-M-F-M-F-M-F-M-F...
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2007.1">
     If you sampled it, taking only the even elements, you would draw the conclusion that the population was made up only of males, while sampling the odd ones would tell you exactly the opposite.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2008.1">
     Of course, this was just a silly example, but it is easy to make mistakes in this field, especially when dealing with big datasets where sampling is mandatory and, therefore, the quality of your analysis depends, first and foremost, on the quality of the sampling itself.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2009.1">
     When it comes to data science and Python, these are the main tools you want to look at:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.2010.1">
       NumPy
      </span>
     </strong>
     <span class="koboSpan" id="kobo.2011.1">
      (
     </span>
     <a href="https://www.numpy.org/">
      <span class="url">
       <span class="koboSpan" id="kobo.2012.1">
        https://www.numpy.org/
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.2013.1">
      ): This is the main package for scientific computing with Python.
     </span>
     <span class="koboSpan" id="kobo.2013.2">
      It
     </span>
     <a id="_idIndexMarker1189">
     </a>
     <span class="koboSpan" id="kobo.2014.1">
      contains a powerful N-dimensional array object, sophisticated (broadcasting) functions, tools for integrating C/C++ and Fortran code, useful linear algebra, the Fourier transform, random number capabilities, and much more.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.2015.1">
       scikit-learn
      </span>
     </strong>
     <span class="koboSpan" id="kobo.2016.1">
      (
     </span>
     <a href="https://scikit-learn.org/">
      <span class="url">
       <span class="koboSpan" id="kobo.2017.1">
        https://scikit-learn.org/
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.2018.1">
      ): This is one of the most popular
     </span>
     <a id="_idIndexMarker1190">
     </a>
     <span class="koboSpan" id="kobo.2019.1">
      machine learning libraries in Python.
     </span>
     <span class="koboSpan" id="kobo.2019.2">
      It has simple and efficient tools for data mining and data analysis, is accessible to
     </span>
     <a id="_idIndexMarker1191">
     </a>
     <span class="koboSpan" id="kobo.2020.1">
      everybody, and is reusable in various contexts.
     </span>
     <span class="koboSpan" id="kobo.2020.2">
      It is built on NumPy, SciPy, and Matplotlib.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.2021.1">
       pandas
      </span>
     </strong>
     <span class="koboSpan" id="kobo.2022.1">
      (
     </span>
     <a href="https://pandas.pydata.org/">
      <span class="url">
       <span class="koboSpan" id="kobo.2023.1">
        https://pandas.pydata.org/
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.2024.1">
      ): This is an open-source, BSD-licensed
     </span>
     <a id="_idIndexMarker1192">
     </a>
     <span class="koboSpan" id="kobo.2025.1">
      library providing high-performance, easy-to-use data structures and data analysis tools.
     </span>
     <span class="koboSpan" id="kobo.2025.2">
      We have used it throughout this chapter.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.2026.1">
       IPython
      </span>
     </strong>
     <span class="koboSpan" id="kobo.2027.1">
      (
     </span>
     <a href="https://ipython.org/">
      <span class="url">
       <span class="koboSpan" id="kobo.2028.1">
        https://ipython.org/
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.2029.1">
      )/
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.2030.1">
       Jupyter
      </span>
     </strong>
     <span class="koboSpan" id="kobo.2031.1">
      (
     </span>
     <a href="https://jupyter.org/">
      <span class="url">
       <span class="koboSpan" id="kobo.2032.1">
        https://jupyter.org/
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.2033.1">
      ): These
     </span>
     <a id="_idIndexMarker1193">
     </a>
     <span class="koboSpan" id="kobo.2034.1">
      provide
     </span>
     <a id="_idIndexMarker1194">
     </a>
     <span class="koboSpan" id="kobo.2035.1">
      a rich architecture for interactive computing.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.2036.1">
       Matplotlib
      </span>
     </strong>
     <span class="koboSpan" id="kobo.2037.1">
      (
     </span>
     <a href="https://matplotlib.org/">
      <span class="url">
       <span class="koboSpan" id="kobo.2038.1">
        https://matplotlib.org/
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.2039.1">
      ): This is a Python 2D plotting library
     </span>
     <a id="_idIndexMarker1195">
     </a>
     <span class="koboSpan" id="kobo.2040.1">
      that produces publication-quality figures in a variety of hard-copy formats and interactive environments across platforms.
     </span>
     <span class="koboSpan" id="kobo.2040.2">
      Matplotlib can be used in Python scripts, the Python and IPython shell, a Jupyter Notebook, web application servers, and several graphical user interface toolkits.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.2041.1">
       Seaborn
      </span>
     </strong>
     <span class="koboSpan" id="kobo.2042.1">
      (
     </span>
     <a href="https://seaborn.pydata.org/">
      <span class="url">
       <span class="koboSpan" id="kobo.2043.1">
        https://seaborn.pydata.org/
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.2044.1">
      ): This is a Python data visualization
     </span>
     <a id="_idIndexMarker1196">
     </a>
     <span class="koboSpan" id="kobo.2045.1">
      library based on Matplotlib.
     </span>
     <span class="koboSpan" id="kobo.2045.2">
      It provides a high-level interface for drawing attractive and informative statistical graphics.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.2046.1">
       Numba
      </span>
     </strong>
     <span class="koboSpan" id="kobo.2047.1">
      (
     </span>
     <a href="https://numba.pydata.org/">
      <span class="url">
       <span class="koboSpan" id="kobo.2048.1">
        https://numba.pydata.org/
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.2049.1">
      ): This gives you the power to speed up
     </span>
     <a id="_idIndexMarker1197">
     </a>
     <span class="koboSpan" id="kobo.2050.1">
      your applications with high-performance functions written directly in Python.
     </span>
     <span class="koboSpan" id="kobo.2050.2">
      With a few annotations, array-oriented and math-heavy Python code can be just-in-time compiled to native machine instructions, similar in performance to C, C++, and Fortran, without having to switch languages or Python interpreters.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.2051.1">
       Bokeh
      </span>
     </strong>
     <span class="koboSpan" id="kobo.2052.1">
      (
     </span>
     <a href="https://bokeh.pydata.org/">
      <span class="url">
       <span class="koboSpan" id="kobo.2053.1">
        https://bokeh.pydata.org/
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.2054.1">
      ): This is a Python-interactive visualization
     </span>
     <a id="_idIndexMarker1198">
     </a>
     <span class="koboSpan" id="kobo.2055.1">
      library that targets modern web browsers for presentation.
     </span>
     <span class="koboSpan" id="kobo.2055.2">
      Its goal is to provide elegant, concise construction of novel graphics in the style of D3.js, but also deliver this capability with high-performance interactivity over large or streaming datasets.
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.2056.1">
     Other than these single libraries, you can also find ecosystems, such
    </span>
    <a id="_idIndexMarker1199">
    </a>
    <span class="koboSpan" id="kobo.2057.1">
     as
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.2058.1">
      SciPy
     </span>
    </strong>
    <span class="koboSpan" id="kobo.2059.1">
     (
    </span>
    <a href="https://scipy.org/">
     <span class="url">
      <span class="koboSpan" id="kobo.2060.1">
       https://scipy.org/
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.2061.1">
     ) and the aforementioned
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.2062.1">
      Anaconda
     </span>
    </strong>
    <span class="koboSpan" id="kobo.2063.1">
     (
    </span>
    <a href="https://anaconda.org/">
     <span class="url">
      <span class="koboSpan" id="kobo.2064.1">
       https://anaconda.org/
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.2065.1">
     ), that
    </span>
    <a id="_idIndexMarker1200">
    </a>
    <span class="koboSpan" id="kobo.2066.1">
     bundle several different packages to give you something that just works in an “out-of-the-box” fashion.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2067.1">
     Installing all these tools and their several dependencies is hard on some systems, so we suggest that you try out ecosystems as well to see whether you are comfortable with them.
    </span>
    <span class="koboSpan" id="kobo.2067.2">
     It may be worth it.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-347">
    <span class="koboSpan" id="kobo.2068.1">
     Summary
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.2069.1">
     In this chapter, we talked about data science.
    </span>
    <span class="koboSpan" id="kobo.2069.2">
     Rather than attempting to explain anything about this broad subject, we delved into a project.
    </span>
    <span class="koboSpan" id="kobo.2069.3">
     We familiarized ourselves with the Jupyter Notebook, and with different libraries, such as
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2070.1">
      pandas
     </span>
    </code>
    <span class="koboSpan" id="kobo.2071.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2072.1">
      Matplotlib
     </span>
    </code>
    <span class="koboSpan" id="kobo.2073.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2074.1">
      NumPy
     </span>
    </code>
    <span class="koboSpan" id="kobo.2075.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2076.1">
     Of course, having to compress all this information into one single chapter means we could only touch briefly on the subjects we presented.
    </span>
    <span class="koboSpan" id="kobo.2076.2">
     We hope the project we have worked through together has been comprehensive enough to give you an idea of the workflow to follow when working in this field.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2077.1">
     The next chapter is dedicated to API development.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-348">
    <span class="koboSpan" id="kobo.2078.1">
     Join our community on Discord
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.2079.1">
     Join our community’s Discord space for discussions with the authors and other readers:
    </span>
   </p>
   <p class="normal">
    <a href="Chapter_13.xhtml">
     <span class="url">
      <span class="koboSpan" id="kobo.2080.1">
       https://discord.com/invite/uaKmaz7FEC
      </span>
     </span>
    </a>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2081.1">
     <img alt="img" src="../Images/QR_Code119001106417026468.png"/>
    </span>
   </p>
  </div>
 </body></html>