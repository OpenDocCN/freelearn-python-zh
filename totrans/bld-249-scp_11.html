<html><head></head><body><div><div><div><div><h1 class="title"><a id="appB"/>Appendix B. Common Pitfalls</h1></div></div></div><div><div><div><div><h1 class="title"><a id="ch10lvl1sec81"/>Read the API documents</h1></div></div></div><a class="indexterm" id="id701"/><p>It may sound pedantic but it is not an exaggeration to say that many Python-related questions asked on Blender forums can simply be answered by reading the API docs thoroughly. </p><p>Of course, these are not the easiest documents to read as they cover many topics and often it might not be clear where to start, so it might be a good idea to read them at least once in their entirety from start to finish. Not only will it give you some idea about the vast scope of the Blender API but it will also help you find specific subjects later on.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch10lvl1sec82"/>The trouble with import</h1></div></div></div><a class="indexterm" id="id702"/><a class="indexterm" id="id703"/><p>One of the questions that regularly pops up is why the <code class="literal">import</code> statement isn't working as expected. The problem here is that you have to know what to expect. Blender has augmented the standard import behavior of Python to make it possible to import from the text files residing within a <code class="literal">.blend</code> file. This is a great boon because it allows you to modularize your code without the need to distribute separate files. However, the behavior of the part that imports these internal files should be absolutely clear to spare you nasty surprises but it is, at the moment, not very well-documented.</p><p>This is what happens when an <code class="literal">import</code> statement such as <code class="literal">import</code> <code class="literal">foo</code> is executed:</p><div><ol class="orderedlist arabic"><li class="listitem">Check whether <code class="literal">foo.pyc</code> or <code class="literal">foo.py</code> exists in any of the directories in <code class="literal">sys.path</code></li><li class="listitem">If one of them exists: <div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">if <code class="literal">foo.py</code> is newer<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">compile <code class="literal">foo.pyfoo.pyc</code></li></ul></div></li><li class="listitem" style="list-style-type: disc">use <code class="literal">foo.pyc</code></li></ul></div></li><li class="listitem">Else, if <code class="literal">foo.py</code> exists as an internal text file:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">if it is not compiled already:<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">compile internal text file</li></ul></div></li><li class="listitem" style="list-style-type: disc">use compiled version</li></ul></div></li><li class="listitem">Else<div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">raise an exception</li></ul></div></li></ol></div><p>The first part is Python's regular behavior (it is a bit simplified from what really happens as we don't mention packages or <code class="literal">.pyo</code> files here) and the second part is what Blender adds to it if the required module does not exist as an external file. There are two important things to note here: if an external file exists with the same name as an internal file, the external file (or its compiled version) takes precedence. This can be annoying because many people save an external copy of an internal file with the same name. If these two are out of sync unexpected things may happen. Fortunately, Blender's internal editor reminds you of this situation by showing an <strong>Out</strong> <strong>of</strong> <strong>Sync</strong> button next to the name of the internal file. Still, if you haven't opened the text editor on that specific file, you may not notice it.</p><a class="indexterm" id="id704"/><p>Furthermore, if you take a close look at the previous outline you will notice that if Blender is looking for an internal file it checks if this internal file is already compiled but does not check if the source might be newer. This means that any changes in the source code of an internal file that are to be imported will not be seen by the main program. To remedy this situation, you may force Python to compile the module by using the built-in <code class="literal">reload()</code> function<a class="indexterm" id="id705"/>. This is less efficient when running a program, but it saves a lot of headaches when developing. Once your script is production-ready you might drop the <code class="literal">reload()</code>.</p><p>So suppose you have two internal files, <code class="literal">main.py</code> and <code class="literal">mymodule.py</code>, and you want to make sure changes in <code class="literal">module.py</code>, will always be visible once <code class="literal">main.py</code> is executed, then each file might look like this:</p><div><pre class="programlisting"># main.py

import mymodule
<strong>reload(mymodule)</strong>

mymodule.myfunction()

# mymodule.py

def myfunction():
   print "myfunction called"</pre></div><p>The highlighted line shows the all important <code class="literal">reload()</code>.</p></div>
<div><div><div><div><h1 class="title"><a id="ch10lvl1sec83"/>Installing a full Python distribution</h1></div></div></div><a class="indexterm" id="id706"/><p>Two specific issues come up frequently: either a standard Python module seems to be missing (an <code class="literal">import</code> statement raises an exception telling you it can't find the requested module) or Blender warns that it cannot find the Python distribution with a version equal to the compiled version.</p><p>Both issues were addressed in <a class="link" href="ch01.html" title="Chapter 1. Extending Blender with Python">Chapter 1</a>, <em>Extending Blender with Python</em> and for additional information refer to: <a class="ulink" href="http://wiki.blender.org/index.php/Doc:Manual/Introduction/Installing_Blender/Python">http://wiki.blender.org/index.php/Doc:Manual/Introduction/Installing_Blender/Python</a>.</p></div></body></html>