<html><head></head><body><div class="chapter" title="Chapter&#xA0;6.&#xA0;Presentations and More"><div class="titlepage"><div><div><h1 class="title"><a id="ch06"/>Chapter 6. Presentations and More</h1></div></div></div><p>Oh, one more presentation to the boss today! Can I simply not run a program and generate a presentation instead of doing it manually all over again? Worry no more; this chapter might just resolve all your worries. We look at various ways you can create presentations of your own in an automated way using Python.</p><p>In this chapter, we will cover the following recipes:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Reading PowerPoint presentations</li><li class="listitem" style="list-style-type: disc">Creating and updating presentations, and adding slides</li><li class="listitem" style="list-style-type: disc">Playing with layouts, placeholders, and textboxes</li><li class="listitem" style="list-style-type: disc">Working with different shapes and adding tables</li><li class="listitem" style="list-style-type: disc">Visual treat with pictures and charts</li><li class="listitem" style="list-style-type: disc">Automating weekly sales reports</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec54"/>Introduction</h1></div></div></div><p>When it comes to reporting data or work management status or presenting an idea, PowerPoint presentations are one of your best bets. PowerPoint allows you to make interactive multimedia slides to present information. Ask a few of your friends from the business world; professionals almost think in presentations, meaning that the thought process gets structured around the slides of <span class="strong"><strong>PowerPoint</strong></span> presentation (in short, <span class="strong"><strong>PPT</strong></span>).</p><p>In this chapter, we discuss the generation of custom PowerPoint presentations with Python. You learn about reading, writing, and manipulating PPT files. PPTs offer capabilities of adding tables, hosting images, and presenting charts, among others; we will learn to work with all these interesting features using Python.</p><p>Throughout the chapter, we will work with a binary file format: <code class="literal">.pptx</code>. PPTX presentations are different from PPT versions, in that they use Microsoft Open XML format that was introduced in Microsoft Office 2007.</p><p>The recipes in this chapter will focus on Python modules that help us perform multiple operations on PPTX files; specifically, we will focus on the following Python modules in this chapter:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">python-pptx</code> (<a class="ulink" href="https://python-pptx.readthedocs.io/en/latest/index.html">https://python-pptx.readthedocs.io/en/latest/index.html</a>)</li><li class="listitem" style="list-style-type: disc"><code class="literal">pandas</code> (<a class="ulink" href="http://pandas.pydata.org/">http://pandas.pydata.org/</a>)</li></ul></div><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note18"/>Note</h3><p>Note that while we try to cover all the major operations that can be done with respect to PowerPoint presentations, there is always the possibility to do more. So, I highly encourage playing around and learning multiple tricks with Python.</p><p>You could also use Win32 COM APIs from Windows to work on PPTs in the Windows operating system instead of using the <code class="literal">python-pptx</code> module (which we will use in this chapter).</p></div></div></div></div>
<div class="section" title="Reading PowerPoint presentations"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec55"/>Reading PowerPoint presentations</h1></div></div></div><p>Based on our experience with PowerPoint presentations, we know a PPT file contains slides, with each slide containing details that need to be presented to the audience. This recipe will show you how to extract information from PPTX files with the <code class="literal">python-pptx</code> module.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec157"/>Getting ready</h2></div></div></div><p>To step through this recipe, we will need to install the <code class="literal">python-pptx</code> module. Let's install the module with Python <code class="literal">pip</code>:</p><pre class="programlisting">
<span class="strong"><strong>chetans-MacBookPro:ch08 Chetan$ sudo pip install python-pptx &#13;
Password: &#13;
Downloading/unpacking python-pptx &#13;
  Downloading python-pptx-0.6.0.tar.gz (6.3MB): 6.3MB downloaded &#13;
  Running setup.py (path:/private/tmp/pip_build_root/python-pptx/setup.py) egg_info for package python-pptx &#13;
     &#13;
Requirement already satisfied (use --upgrade to upgrade): lxml&gt;=3.1.0 in /Library/Python/2.7/site-packages (from python-pptx) &#13;
Requirement already satisfied (use --upgrade to upgrade): Pillow&gt;=2.6.1 in /Library/Python/2.7/site-packages (from python-pptx) &#13;
Requirement already satisfied (use --upgrade to upgrade): XlsxWriter&gt;=0.5.7 in /Library/Python/2.7/site-packages (from python-pptx) &#13;
Installing collected packages: python-pptx &#13;
  Running setup.py install for python-pptx &#13;
     &#13;
Successfully installed python-pptx &#13;
Cleaning up...</strong></span>
</pre><p>Installed the module, already? Let's get started!</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec158"/>How to do it...</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">We start by creating a PPTX file with Microsoft PowerPoint 2013. We'll use this file as a sample to learn how to read and extract data from the presentations. You'll also get the file if you download the code samples for this book. We call this file as <code class="literal">myprofile.pptx</code>; it contains information about the author of the book with two slides in it. The following screenshot shows the file contents:<p>
</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_07_001.jpg"/></div><p>
</p></li><li class="listitem">If you look at the presentation, the first slide has two text items: the headline item is <span class="strong"><strong>Chetan Giridhar</strong></span> and the subtitle is <span class="strong"><strong>World is full of knowledge..</strong></span>.. The second slide has more data; it has a different layout, and the title of the slide is <span class="strong"><strong>He wishes to</strong></span>, containing all the four wishes of the author and a circular shape with the content, <span class="strong"><strong>This is circle of life</strong></span>. Interesting!</li><li class="listitem">On your computer, go to Terminal and use <code class="literal">vim</code> or choose your favorite editor. To read the PPT file, let's first use Python code to create a presentation object for <code class="literal">myprofile.pptx</code>:<pre class="programlisting">        from pptx import Presentation &#13;
        path_to_presentation = 'myprofile.pptx' &#13;
        prs = Presentation(path_to_presentation) &#13;
        print "Presentation object for myprofile file: ", prs &#13;
</pre><p>The output of the preceding code snippet is as follows:</p><pre class="programlisting">        Presentation object for myprofile file:  &#13;
        &lt;pptx.presentation.Presentation object at 0x10e56e550&gt; &#13;
</pre></li><li class="listitem">That's good; now that we have the presentation object, let's use it to get the slide objects. We know the presentation has two slides. The following code gets us the slide objects. Slides are represented as a Python list in the <code class="literal">slide</code> object and can be iterated over in a for loop:<pre class="programlisting">        print "Slides are:" &#13;
        for slide in prs.slides: &#13;
            print "Slide object:", slide &#13;
</pre></li><li class="listitem">The preceding code snippet uses the presentation object, <code class="literal">prs</code>, to retrieve the slide objects. The output of the code snippet is as follows:<pre class="programlisting">
<span class="strong"><strong>        Slides are: &#13;
        Slide object: &lt;pptx.slide.Slide object at 0x10e59f500&gt; &#13;
        Slide object: &lt;pptx.slide.Slide object at 0x10e59f460&gt;</strong></span>
</pre></li><li class="listitem">OK, that's neat! Let's go one level deeper and look at some of the attributes of the <code class="literal">slides</code> object. The following code prints a few attributes of the <code class="literal">slide</code> object:<pre class="programlisting">        print "Slide has following objects:" &#13;
        slide1, slide2 = prs.slides[0], prs.slides[1] &#13;
        print "Slide Ids: \n", slide1.slide_id, ",", slide2.slide_id &#13;
        print "Slide Open XML elements: \n", slide1.element, ",", &#13;
               slide2.element &#13;
        print "Slide layouts: \n", slide1.slide_layout.name, ",",&#13;
               slide2.slide_layout.name &#13;
</pre></li><li class="listitem">Observe that the first slide's layout is <span class="strong"><strong>Title Slide</strong></span> and the next slide is <span class="strong"><strong>Title and Content</strong></span>, which is indeed the case. We also print the <code class="literal">Slide Ids</code> and the <code class="literal">Open XML elements</code>:<pre class="programlisting">
<span class="strong"><strong>Slide has following objects:</strong></span>
<span class="strong"><strong>Slide Ids: </strong></span>
<span class="strong"><strong>256, 257</strong></span>
<span class="strong"><strong>Slide Open XML elements: </strong></span>
<span class="strong"><strong>&lt;Element {http://schemas.openxmlformats.org/&#13;
                  presentationml/2006/main}sld at 0x109fc2d60&gt;, &#13;
        &lt;Element {http://schemas.openxmlformats.org/&#13;
                  presentationml/2006/main}sld at 0x109fc23c0&gt;</strong></span>
<span class="strong"><strong>Slide layouts: </strong></span>
<span class="strong"><strong>Title Slide, Title and Content</strong></span>
</pre></li><li class="listitem">Now, every slide contains a few shapes. For instance, the first slide has two text placeholders, the title and the subtitle. In the second slide, we have two placeholders but have a circular shape as well. The following code prints this information:<pre class="programlisting">        print "Shapes in the slides" &#13;
        i=1 &#13;
        for slide in prs.slides: &#13;
            print 'Slide', i &#13;
            for shape in slide.shapes: &#13;
                print "Shape: ", shape.shape_type &#13;
            i +=1 &#13;
</pre><p>The output of the preceding code snippet is as follows. You can observe that the first slide contains text frames, but the second slide also has an auto shape:</p><pre class="programlisting">        Shapes in the slides &#13;
        Slide 1 &#13;
        Shape:  PLACEHOLDER (14) &#13;
        Shape:  PLACEHOLDER (14) &#13;
 &#13;
        Slide 2 &#13;
        Shape:  PLACEHOLDER (14) &#13;
        Shape:  PLACEHOLDER (14) &#13;
        Shape:  AUTO_SHAPE (1) &#13;
</pre></li><li class="listitem">OK, so now we have the slides, the slide layout, and the slide shapes. Let's try to get the text content from both the slides and all the shapes. The following code does exactly what we need:<pre class="programlisting">        text_runs = [] &#13;
        for slide in prs.slides: &#13;
 &#13;
            for shape in slide.shapes: &#13;
                if not shape.has_text_frame: &#13;
                continue &#13;
            for paragraph in shape.text_frame.paragraphs: &#13;
                for run in paragraph.runs: &#13;
                    text_runs.append(run.text) &#13;
 &#13;
        print "Text is: ", text_runs &#13;
</pre></li></ol></div><p>The output of the code example is as follows. It contains all the text from both the slides. These are termed as <span class="strong"><strong>text runs</strong></span> in the <code class="literal">python-pptx</code> world:</p><pre class="programlisting">Text is:  [u'Chetan Giridhar', u'World is full of knowledge..', u'He wishes to', u'Travel round the world', u'Build apps', u'Have fun', u'Die peacefully', u'This is circle of life'] &#13;
</pre></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec159"/>How it works...</h2></div></div></div><p>In this recipe, we read the complete presentation and got the contents of both the slides.</p><p>We started by manually creating a PPTX file with Microsoft PowerPoint 2013 and used the <code class="literal">Presentation</code> class from the PPTX module to create an object of the <code class="literal">myprofilepptx</code> file, <code class="literal">prs</code>. Using this object, we got access to both the slides with the <code class="literal">prs.slides</code> method of the <code class="literal">presentation</code> object.</p><p>Next, we used the <code class="literal">slides</code> object to get all the available shapes in both the slides with <code class="literal">slides.shapes</code>. Iterating over this object helped us to get the shapes such as <code class="literal">PLACEHOLDER</code> and <code class="literal">AUTO_SHAPE</code> from the slides. We will learn more about slides and shapes in the latter part of the chapter.</p><p>We then used the <code class="literal">shape.has_text_frame</code> attribute to check whether the shape has a text frame and, if available, has got the <code class="literal">paragraphs</code> object from the text frame. The paragraph object's <code class="literal">runs</code> attribute contained the list of the actual text data, which was then stored in the array, <code class="literal">text_runs</code>.</p></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec160"/>There's more...</h2></div></div></div><p>Cool! So, we learnt many things in one recipe: presentation object, slides, layouts, shapes, text frames, and paragraphs. With this, we're in a great position to read the PPTX files.</p><p>All this is great, but hey, we'd like to create new PPTX files, right? And hopefully automate creating presentations? So, let's go ahead and see how that can be achieved in Python.</p></div></div>
<div class="section" title="Creating and updating presentations, and adding slides"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec56"/>Creating and updating presentations, and adding slides</h1></div></div></div><p>We continue using the <code class="literal">python-pptx</code> module for the recipes in this section. So, we don't have to install any new modules. We will learn how to create a blank presentation and add slides to it and, of course, some content on it.</p><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec161"/>How to do it...</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Let's start with a very simple example of creating a new PPT with <span class="strong"><strong>Yo! Python</strong></span> written on it. The following code helps us create the presentation:<pre class="programlisting">        from pptx import Presentation &#13;
 &#13;
        prs = Presentation() &#13;
        slide = prs.slides.add_slide(prs.slide_layouts[0]) &#13;
        slide.shapes.title.text = "Yo, Python!" &#13;
        slide.placeholders[1].text = "Yes it is really awesome" &#13;
 &#13;
        prs.save('yoPython.pptx') &#13;
</pre><p>If we run the preceding piece of code, it will create a PPTX file with the title as <span class="strong"><strong>Yo, Python!</strong></span> and sub title as <span class="strong"><strong>Yes it is really awesome</strong></span>. The following screenshot shows the contents of the slide:</p><p>
</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_07_003.jpg"/></div><p>
</p><p>Also, observe that the slide layout is that of the <span class="strong"><strong>Title Slide</strong></span>.</p></li><li class="listitem">We can also create a new presentation from an existing presentation. In the next code example, we take a PowerPoint template, create a new PPT, and add a slide to it with text content. We use the following template for this example:<p>
</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_07_004.jpg"/></div><p>
</p><p>If we run the following program on the template presentation, we get a new PPT, as shown in the next screenshot:</p><pre class="programlisting">        from pptx import Presentation &#13;
        prs = Presentation('sample_ppt.pptx') &#13;
 &#13;
        first_slide = prs.slides[0] &#13;
        first_slide.shapes[0].text_frame.paragraphs[0]&#13;
                             .text = "Hello!" &#13;
 &#13;
        slide = prs.slides.add_slide(prs.slide_layouts[1]) &#13;
        text_frame = slide.shapes[0].text_frame &#13;
        p = text_frame.paragraphs[0] &#13;
        p.text = "This is a paragraph" &#13;
 &#13;
        prs.save('new_ppt.pptx')</pre></li><li class="listitem">Slide one is updated with a title text, <span class="strong"><strong>Hello!</strong></span>, and a new slide with the layout, title, and content is added with the text, <span class="strong"><strong>This is a paragraph</strong></span>. The following screenshot shows the newly created presentation, <code class="literal">new_ppt.pptx</code>:<p>
</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_07_005.jpg"/></div><p>
</p></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec162"/>How it works...</h2></div></div></div><p>In this section, we learnt how to create presentations with Python. We achieved three different things in the preceding code snippets.</p><p>First, we used the default template to create a <span class="strong"><strong>Title Slide</strong></span> and added title text and subtitle text to it. We achieved this with the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Created a presentation object, <code class="literal">prs</code>, using the <code class="literal">Presentation</code> class of the <code class="literal">pptx</code> module.</li><li class="listitem">The <code class="literal">prs</code> object was then utilized to add a new slide with the help of the <code class="literal">add_slide()</code> method. Layout <code class="literal">0</code> was passed as an argument to <code class="literal">add_slide()</code>, which indicated that the new slide was of type <code class="literal">Title</code> and was referenced by variable <code class="literal">slide</code>.</li><li class="listitem">Title layout typically contains a title and subtitle. The contents of the title text were added with the <code class="literal">slide.shape.title.text</code> attribute, while the contents of the subtitle were added with the help of <code class="literal">slide.placeholders.text</code> attribute.</li></ol></div><p>Next, we created a new presentation from an existing PPT template. The template was stored in the <code class="literal">sample_ppt.pptx</code> file and already contained a blank layout slide. This is what we achieved in this recipe:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">We created a presentation object <code class="literal">prs</code> from the template PPT. We then used the presentation object to reference the first slide, <code class="literal">prs.slides[0]</code>, which was stored in the variable, <code class="literal">first_slide</code>.</li><li class="listitem">The <code class="literal">first_slide</code> object was then used to access the first shape, which is the title text. Title text was then updated to content <span class="strong"><strong>Hello!</strong></span></li><li class="listitem">Later, we added a new slide with <span class="strong"><strong>Layout</strong></span> one (<span class="strong"><strong>Title and Content</strong></span>) and referenced it with the <code class="literal">slide</code> variable. The newly created slide's first shape was a text frame to which the content <span class="strong"><strong>This is a paragraph</strong></span> was added.</li><li class="listitem">In the end, we saved the newly created presentation under the name <code class="literal">new_ppt.pptx</code>.</li></ol></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec163"/>There's more...</h2></div></div></div><p>Cool! So, we learnt how to create new presentations from scratch, update an existing template, add new content to it and create a presentation, and lastly, create presentations with different types of layout and bullet data. In the next recipe, let's look at what else we can do with presentations using Python.</p></div></div>
<div class="section" title="Playing with layouts, placeholders, and textboxes"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec57"/>Playing with layouts, placeholders, and textboxes</h1></div></div></div><p>Now, let's move on to do some interesting operations on PPTs. Importantly, we'll discuss operations that are most frequently used.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec164"/>Getting ready</h2></div></div></div><p>No specific modules are required for this recipe; we would use the <code class="literal">python-pptx</code> module that was installed for the earlier recipes. In this recipe, we will work with different slide layouts and play with shapes and text.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec165"/>How to do it...</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Let's go further and use a different type of slide layout, along with bulleted content in it. The following code snippet does what we need:<pre class="programlisting">        from pptx import Presentation&#13;
&#13;
        prs = Presentation()&#13;
        two_content_slide_layout = prs.slide_layouts[3]&#13;
        slide = prs.slides.add_slide(two_content_slide_layout)&#13;
        shapes = slide.shapes&#13;
&#13;
        title_shape = shapes.title&#13;
        title_shape.text = 'Adding a Two Content Slide'&#13;
&#13;
        body_shape = shapes.placeholders[1] &#13;
        tf = body_shape.text_frame &#13;
        tf.text = 'This is line 1.' &#13;
 &#13;
        p = tf.add_paragraph() &#13;
        p.text = 'Again a Line 2..' &#13;
        p.level = 1 &#13;
 &#13;
        p = tf.add_paragraph() &#13;
        p.text = 'And this is line 3...' &#13;
        p.level = 2 &#13;
 &#13;
        prs.save('two_content.pptx') &#13;
</pre><p>When we run the preceding Python code, we get a new PPT with a <span class="emphasis"><em>two content</em></span> slide with bulleted content added to it. The following screenshot shows the output of the new presentation that was created. Nice, right? We can add bulleted content to the placeholders on the left-hand side of the slide:</p><p>
</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_07_006.jpg"/></div><p>
</p></li><li class="listitem">Now, let's get creative and add another type of shape to our slide, that is, the textbox. The following code snippet adds a textbox to our slide:<pre class="programlisting">        from pptx import Presentation &#13;
        from pptx.util import Inches, Pt &#13;
        prs = Presentation() &#13;
        blank_slide_layout = prs.slide_layouts[6] &#13;
        slide = prs.slides.add_slide(blank_slide_layout) &#13;
 &#13;
        txBox = slide.shapes.add_textbox(Inches(2), &#13;
                Inches(2), Inches(5), Inches(1)) &#13;
        tf = txBox.text_frame &#13;
        tf.text = "Wow! I'm inside a textbox" &#13;
 &#13;
        p = tf.add_paragraph() &#13;
        p.text = "Adding a new text" &#13;
        p.font.bold = True &#13;
        p.font.italic = True &#13;
        p.font.size = Pt(30) &#13;
 &#13;
        prs.save('textBox.pptx')</pre><p>The following screenshot shows how the newly created PPTX file looks. If you carefully look at it, you'll notice that we added a text box and the second text inside the textbox is in bold, italics, and the font size is 30.</p><p>
</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_07_007.jpg"/></div><p>
</p></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec166"/>How it works...</h2></div></div></div><p>In this recipe, we used the blank template to add a two-content layout slide. Let's see what else we did on top of it:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In the code, we used <code class="literal">prs.slide_layouts[3]</code> to convey the presentation object, <code class="literal">prs</code>, to add a slide with the two content layout. The two-content layout also has a title text, which was updated to <span class="strong"><strong>Adding a Two Content Slide</strong></span> by using the <code class="literal">shapes.title</code> attribute.</li><li class="listitem">Next, we looked at the <span class="emphasis"><em>placeholders</em></span>. A placeholder is a preformatted container to which content can be added. Placeholders are categories of shape, which means multiple shapes can have placeholders. For instance, an autoshape (circle, as seen in the first recipe) is a placeholder; a picture or graphic frame can be a placeholder. We have two placeholders, one on the left and one on the right, in a two-content slide. We targeted the left one with <code class="literal">shapes.placeholders[1]</code> and added a first line <span class="strong"><strong>This is line 1.</strong></span> to the text frame referenced by <code class="literal">shapes.placeholders[1].text_frame</code>.</li><li class="listitem">We then added bulleted lines by adding a paragraph to <code class="literal">text_frame</code> with the <code class="literal">add_paragraph()</code> method and added the text <span class="strong"><strong>Again a line 2...</strong></span> at level one and <span class="strong"><strong>And this is line 3...</strong></span> at level two.</li><li class="listitem">Basically, not all shapes contain text, but finding if a shape supports text can be done using the <code class="literal">shape.has_text_frame</code> attribute. In this recipe, we know our shape contains a placeholder that can handle text content. So, we used the <code class="literal">text_frame</code> attribute to add the first line of text. Similarly, we used the <code class="literal">add_paragraph()</code> method to add the subsequent lines in bulleted fashion using the <code class="literal">level</code> attribute.</li><li class="listitem">In the end, we saved the new presentation under the name, <code class="literal">two_content.pptx</code>. If you look at the screenshot, we see the bulleted look on the text added to the left text frame on the slide.</li></ol></div><p>Next, we added a textbox to our presentation. Textboxes are very commonly used in presentations. People use textboxes to highlight points and use the resizing and moving capabilities of textboxes to good effect. Here's what we did in our recipe:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">We first created a blank slide with layout six and added it to the presentation with the <code class="literal">add_slide()</code> method.</li><li class="listitem">Next, we created a textbox with the appropriate dimensions. We used <code class="literal">Inches(2)</code> for the left and top coordinates and then managed the width and height with <code class="literal">Inches(5)</code> and <code class="literal">Inches(1)</code> respectively. Inches here map to the same real world entity where <span class="emphasis"><em>1 inch = 2.54 cm</em></span>. We added this textbox to the slide with the <code class="literal">add_textbox()</code> method.</li><li class="listitem">Using the textbox object, we added a text frame object <code class="literal">tf</code> with the <code class="literal">text_frame</code> attribute.</li><li class="listitem">As seen in the previous recipe also, we added the text <span class="strong"><strong>Wow! I'm inside a textbox</strong></span> to the text frame.</li><li class="listitem">We followed it up by adding a paragraph with the <code class="literal">add_paragraph()</code> method and adding the text <span class="strong"><strong>Adding a new text</strong></span> to this paragraph and making the text bold, italics, and increasing its font to <code class="literal">30</code>.</li><li class="listitem">In the end, we saved the file as <code class="literal">textBox.pptx</code>.</li></ol></div><p>You learned about placeholders and text frames. You learnt how to add text to our slides using text frames and paragraphs. You also learnt about adding a textbox of the required dimensions to our slide deck.</p></div></div>
<div class="section" title="Working with different shapes and adding tables"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec58"/>Working with different shapes and adding tables</h1></div></div></div><p>OK, let's go ahead and make our presentations more interesting by adding different shapes, tables, or even pictures! Why wait? Let's quickly get into action.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec167"/>Getting ready</h2></div></div></div><p>No specific modules are required for this recipe; we will use the <code class="literal">python-pptx</code> module that was installed for the earlier recipes.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec168"/>How to do it...</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In this recipe, we will add a few shapes to our presentation. Shapes are very useful in presentations as they can represent real world objects, can indicate relations, and provide great visual feedback to the audience (who are listening to the presentation). In this recipe, we add a <span class="strong"><strong>Home</strong></span> button and then a <span class="strong"><strong>Rectangular Callout</strong></span> to show where our <span class="strong"><strong>Home</strong></span> button is. We'll also fill custom color into our <code class="literal">Callout</code> element. The following code adds the shapes to the presentation:<pre class="programlisting">        from pptx import Presentation &#13;
        from pptx.enum.shapes import MSO_SHAPE &#13;
        from pptx.util import Inches &#13;
        from pptx.dml.color import RGBColor &#13;
 &#13;
        prs = Presentation() &#13;
        title_only_slide_layout = prs.slide_layouts[5] &#13;
        slide = prs.slides.add_slide(title_only_slide_layout) &#13;
        shapes = slide.shapes &#13;
        shapes.title.text = 'Adding Shapes' &#13;
 &#13;
        shape1 = shapes.add_shape(MSO_SHAPE.RECTANGULAR_CALLOUT,&#13;
        Inches(3.5), Inches(2), Inches(2), Inches(2)) &#13;
        shape1.fill.solid() &#13;
        shape1.fill.fore_color.rgb = RGBColor(0x1E, 0x90, 0xFF) &#13;
        shape1.fill.fore_color.brightness = 0.4 &#13;
 &#13;
        shape1.text = 'See! There is home!' &#13;
 &#13;
        shape2 = shapes.add_shape(MSO_SHAPE.ACTION_BUTTON_HOME,&#13;
        Inches(3.5), Inches(5), Inches(2), Inches(2)) &#13;
        shape2.text = 'Home' &#13;
 &#13;
        prs.save('shapes.pptx') &#13;
</pre><p>After running the preceding code, we get a new presentation, <code class="literal">shapes.pptx</code>, which looks like the following screenshot:</p><p>
</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_07_008.jpg"/></div><p>
</p></li><li class="listitem">That was neat! Now let's see if we can add a table to our presentation. Again, tables are used in presentations to manifest data and make informed decisions. Speakers (persons responsible for making the presentation) often bring out facts about certain projects through tables and solicit discussions or feedback from audiences. Adding tables in presentations is trivial with Python; refer to the following code. In this, we add a table containing the student information for three students:<pre class="programlisting">        from pptx import Presentation &#13;
        from pptx.util import Inches &#13;
 &#13;
        prs = Presentation() &#13;
        title_only_slide_layout = prs.slide_layouts[5] &#13;
        slide = prs.slides.add_slide(title_only_slide_layout) &#13;
        shapes = slide.shapes &#13;
        shapes.title.text = 'Students Data' &#13;
 &#13;
        rows = 4; cols = 3 &#13;
        left = top = Inches(2.0) &#13;
        width = Inches(6.0) &#13;
        height = Inches(1.2) &#13;
 &#13;
        table = shapes.add_table(rows, cols, left, top,&#13;
                                 width, height).table &#13;
        table.columns[0].width = Inches(2.0) &#13;
        table.columns[1].width = Inches(2.0) &#13;
        table.columns[2].width = Inches(2.0) &#13;
 &#13;
        table.cell(0, 0).text = 'Sr. No.' &#13;
        table.cell(0, 1).text = 'Student Name' &#13;
        table.cell(0, 2).text = 'Student Id' &#13;
 &#13;
        students = { &#13;
            1: ["John", 115], &#13;
            2: ["Mary", 119], &#13;
            3: ["Alice", 101] &#13;
        } &#13;
 &#13;
        for i in range(len(students)): &#13;
            table.cell(i+1, 0).text = str(i+1) &#13;
            table.cell(i+1, 1).text = str(students[i+1][0]) &#13;
            table.cell(i+1, 2).text = str(students[i+1][1]) &#13;
 &#13;
        prs.save('table.pptx')</pre><p>If we run this code snippet, you'll see a table generated in the presentation containing all the student data. Refer to the following screenshot:</p><p>
</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_07_009.jpg"/></div><p>
</p></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec169"/>How it works...</h2></div></div></div><p>In the first code snippet, we added a couple of shapes to our presentation by performing the following operations:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">We added shapes with the help of the <code class="literal">add_shapes()</code> method, which takes the type of shape as input.</li><li class="listitem">In our code, we take the help of the <code class="literal">MSO_SHAPE</code> enumeration (this has all the shapes listed) and pick up two shapes, namely, <code class="literal">MSO_SHAPE.RECTANGULAR_CALLOUT</code> and <code class="literal">MSO_SHAPE.ACTION_BUTTON_HOME</code>. Just like in the case of a textbox, the <code class="literal">add_shapes()</code> method also needs the size of the shape defined with the <code class="literal">Inches()</code> method.</li><li class="listitem">We also managed to define the custom color for the callout shape with the help of the <code class="literal">fill</code> method from the <code class="literal">SlideShape</code> class. The <code class="literal">shape.fill.fore_color.rgb</code> attribute was used to set the color of the callout shape. The RGB color used was <code class="literal">1E90FF</code>, which is light blue color, as seen in the screenshot. We also set the color brightness with the help of the <code class="literal">shape.fill.fore_color.brightness</code> attribute.</li><li class="listitem">Of course, we added text to both the shapes by setting the <code class="literal">shape.text</code> attribute. In the end, we saved the file as <code class="literal">shapes.pptx</code>.</li></ol></div><p>In the second example, we added a nice table to our presentation with the help of Python code. This is how we did it:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">We created a presentation with <span class="strong"><strong>Title only</strong></span> layout and added a single slide to it using the <code class="literal">add_slide()</code> method. We also defined the title of the slide as <span class="strong"><strong>Students Data</strong></span>.</li><li class="listitem">Adding the table is as simple as adding shapes. We used the method <code class="literal">add_table()</code> to add a table to the presentation. As expected, the <code class="literal">add_table()</code> method expects a number of rows and columns as input, and at the same time, expects the size of the table. In our example, we have set the rows to <code class="literal">4</code> and columns to be <code class="literal">3</code> and the size of the table with coordinates <code class="literal">Inches(2)</code>, <code class="literal">Inches(2)</code>, <code class="literal">Inches(6)</code>, and <code class="literal">Inches(8)</code>, which means the table is located 2 inches from the left, 2 inches below the top of slide, the width of the table is 6 inches, and the height is 1.2 inches (15.3cm x 3.1cm).</li><li class="listitem">We defined our table to have three columns; the width of each of those is set to 2 inches. We set that using the <code class="literal">table.columns.width</code> attribute. We also set the text of the column headings to <span class="strong"><strong>Sr. No</strong></span>, <span class="strong"><strong>Student Name</strong></span>, and <span class="strong"><strong>Student Id</strong></span>, with the help of <code class="literal">table.cell(row, column).text</code> attribute. Note that here, the row value is always <code class="literal">0</code>, which indicates the first row or the title row, and the column varies from <code class="literal">0</code> to <code class="literal">2</code>, indicating three columns.</li><li class="listitem">For the purpose of this example, we used a predefined dictionary, <code class="literal">students</code>, which has information such as student name and student ID. We iterate through all the student information and update the cells of the table to fill in the table with the appropriate information, hence the table with all the student data, as observed in the screenshot.</li><li class="listitem">In the end, we saved the presentation as <code class="literal">table.pptx</code>.</li></ol></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec170"/>There's more...</h2></div></div></div><p>Nice! What else can we do with presentations using Python, you'd ask? Or a few of you are already expecting me to get graphical and talk about charts or pictures, aren't you? Oh yes, we'll get that covered as well. Let's get graphical, so to speak!</p></div></div>
<div class="section" title="Visual treat with pictures and charts"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec59"/>Visual treat with pictures and charts</h1></div></div></div><p>Yes, it's time. In this section, we will look at adding pictures and charts to your presentations. They say that a picture speaks a thousand words, and truly, you must have seen presentations with a lot of pictures and graphs in them. They are there for a reason. You can convey as much information as possible in one slide. Both charts and pictures have this power, and without learning about them, this chapter remains incomplete. So, let's jump in!</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec171"/>Getting ready</h2></div></div></div><p>No specific modules are required for this recipe; we will use the <code class="literal">python-pptx</code> module that was installed for the earlier recipes.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec172"/>How to do it...</h2></div></div></div><p>We divide this recipe into two parts. First, we will cover the adding of pictures to our slide, and in the next, we'll deal with charts.</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">The following code snippet helps us add pictures to our slide:<pre class="programlisting">        from pptx import Presentation &#13;
        from pptx.util import Inches &#13;
 &#13;
        img_path = 'python.png' &#13;
        img_path2 = 'learn_python.jpeg' &#13;
        prs = Presentation() &#13;
        blank_slide_layout = prs.slide_layouts[6] &#13;
        slide = prs.slides.add_slide(blank_slide_layout) &#13;
 &#13;
        left = top = Inches(2) &#13;
        pic = slide.shapes.add_picture(img_path, left,&#13;
              top, height=Inches(2), width=Inches(3)) &#13;
 &#13;
        left = Inches(2) &#13;
        top = Inches(5) &#13;
        height = Inches(2) &#13;
        pic = slide.shapes.add_picture(img_path2, left,&#13;
                                       top, height=height) &#13;
 &#13;
        prs.save('picture.pptx') &#13;
</pre><p>When we run the preceding program, we get a slide with two pictures on it, as shown in the following screenshot:</p><p>
</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_07_010.jpg"/></div><p>
</p></li><li class="listitem">Now let's see if we can write Python code to add a chart to our slide. The <code class="literal">python-pptx</code> module supports multiple types of charts, such as line chart, bar chart, and bubble chart, but my favorite chart always has been a pie chart. How about adding one in our recipe? Yes, the following code adds a pie chart to the presentation:<pre class="programlisting">        from pptx import Presentation &#13;
        from pptx.chart.data import ChartData &#13;
        from pptx.enum.chart import XL_CHART_TYPE &#13;
        from pptx.enum.chart import XL_LABEL_POSITION,&#13;
                                    XL_LEGEND_POSITION &#13;
        from pptx.util import Inches &#13;
 &#13;
        prs = Presentation() &#13;
        slide = prs.slides.add_slide(prs.slide_layouts[5]) &#13;
        slide.shapes.title.text = 'Data based on regions' &#13;
 &#13;
        chart_data = ChartData() &#13;
        chart_data.categories = ['West', 'East', &#13;
                                 'North', 'South'] &#13;
        chart_data.add_series('Series 1', (0.35, &#13;
                                 0.25, 0.25, 0.15)) &#13;
 &#13;
        x, y, cx, cy = Inches(2), Inches(2), Inches(6),&#13;
                       Inches(4.5) &#13;
        chart = slide.shapes.add_chart( &#13;
            XL_CHART_TYPE.PIE, x, y, cx, cy, chart_data &#13;
        ).chart &#13;
 &#13;
        chart.has_legend = True &#13;
        chart.legend.position = XL_LEGEND_POSITION.BOTTOM &#13;
        chart.legend.include_in_layout = False &#13;
 &#13;
        chart.plots[0].has_data_labels = True &#13;
        data_labels = chart.plots[0].data_labels &#13;
        data_labels.number_format = '0%' &#13;
        data_labels.position = XL_LABEL_POSITION.OUTSIDE_END &#13;
 &#13;
        prs.save('chart.pptx') &#13;
</pre><p>The output of the preceding program is as follows:</p><p>
</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_07_011.jpg"/></div><p>
</p></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec173"/>How it works...</h2></div></div></div><p>In the first code snippet, we added two images to the slide. And how did we do it? As logical as it sounds, we used the <code class="literal">add_picture()</code> method. Isn't the library nice? Add a textbox with <code class="literal">add_textbox()</code>, add a slide with <code class="literal">add_slide()</code> and now add a picture with <code class="literal">add_picture()</code>. Let's take a deeper look at what we did in the first part of the recipe:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">As expected, <code class="literal">add_picture()</code> expects the path from where the image needs to be added to the presentation, and just like other methods, the coordinates and size of the picture. In our example, we added two pictures. The first picture is <code class="literal">python.org</code> and we configured it to show up 2 inches from the left and 2 inches from the top. We also configured the size of the picture to have a width of 3 inches and height of 2 inches.</li><li class="listitem">The second picture we added was <code class="literal">learn_python.jpeg</code>; it was configured to be 2 inches from left, 5 inches from the top, with a height of 2 inches and width to be same as the width of the image.</li><li class="listitem">In our example, we created a new slide with a blank slide layout and added both the pictures, and in the end, we saved the file as <code class="literal">picture.pptx</code>.</li></ol></div><p>In the second part, we added a pie chart to our slide deck. We did this in the following way:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">We added a slide and set the title text to <span class="strong"><strong>Data based on regions</strong></span>.</li><li class="listitem">We then created an object of the class, <code class="literal">ChartData()</code>, and named it <code class="literal">chart_data</code>. We defined the categories for our pie chart with the <code class="literal">chart_data.categories</code> attribute and set it to an array of regions <code class="literal">['West', 'East', 'North', 'South']</code>. We also configured the <code class="literal">chart_data</code> object with data for all the regions; we did that with the <code class="literal">add_series()</code> method.</li><li class="listitem">How did we add this chart on the presentation slide? Yes, you guessed it: the <code class="literal">add_chart()</code> method does that for us. The <code class="literal">add_chart()</code> method expects the type of chart as one of the arguments, and like other methods, it expects the dimensions. In our code, we also set the attributes <code class="literal">has_legend</code>, <code class="literal">number_format</code>, and data labels to make the pie chart look great!</li></ol></div></div><div class="section" title="There's more..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec174"/>There's more...</h2></div></div></div><p>Cool! So we learnt many interesting things in this chapter. But what better fun than applying this knowledge to solve a real world use case. Did you hear Alex has some issues with his weekly sales report?</p></div></div>
<div class="section" title="Automating weekly sales reports"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec60"/>Automating weekly sales reports</h1></div></div></div><p>Alex is the director of sales at Innova 8 Inc that sells laptops and business software. He has a bunch of sales managers reporting to him. He is responsible for measuring the success of his subordinates and reporting this to the VP of sales on a weekly basis. Alex's boss is majorly interested in two things: the revenue generated from business accounts and the performance of his sales managers. Alex needs to report these numbers in the weekly staff meeting. He uses PowerPoint as a tool to collate and represent the data to the VP of sales on a weekly basis.</p><p>However, Alex has a few problems. The data that he gets from his sales managers is often in an Excel sheet. Also, the data is so dynamic that it changes till the last moment based on whether the customer paid just before the meeting. It becomes difficult for Alex to create the presentation in advance for the meeting due to this variability. Also, it is tedious for Alex to analyze the data and come up with charts--a completely manual process.</p><p>Can you help Alex with what you learnt in this chapter?</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec175"/>Getting ready</h2></div></div></div><p>If you analyze the problems, we can automate the complete process for Alex. Alex's data is in an Excel sheet; we can easily read this data with the <code class="literal">pandas</code> module of Python. Also, we can create a new presentation with the <code class="literal">python-pptx</code> module.</p><p>The following steps can help solve Alex's problem:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Read the contents of the Excel sheet and get the required data.</li><li class="listitem">Create a new PowerPoint presentation and add two slides to it.</li><li class="listitem">On the first slide, create a pie chart that shows the revenue figures for different accounts and compare them based on percentages.</li><li class="listitem">On the second slide, add a bar chart comparing the performance of sales managers based on revenue.</li></ol></div><p>For this recipe, let's install the <code class="literal">pandas</code> module. We do that with our favorite utility Python <code class="literal">pip</code>. We use the following command for installing <code class="literal">pandas</code>:</p><pre class="programlisting">
<span class="strong"><strong>pip install pandas</strong></span>
</pre><div class="note" style="" title="Note"><div class="inner"><h3 class="title"><a id="note19"/>Note</h3><p>This is a trivial example of working with Excel sheets using <code class="literal">pandas</code>. The <code class="literal">pandas</code> module has comprehensive set of APIs that can be used for data analysis, filtering, and aggregation. We talk about all this and much more in the chapter that deals with data analysis and visualizations.</p></div></div><p>Now that we're ready, let's look at the code that will help Alex automate this process.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec176"/>How to do it...</h2></div></div></div><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Let's start by looking at the Excel sheet that has the weekly sales data. We call this file as <code class="literal">Sales_Data.xlsx</code> and it looks like the following screenshot:<p>
</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_07_012.jpg"/></div><p>
</p></li><li class="listitem">Now, let's look at the code snippet that will help Alex read this data and generate the exact presentation he needs:<pre class="programlisting">        from pptx import Presentation &#13;
        from pptx.chart.data import ChartData &#13;
        from pptx.enum.chart import XL_CHART_TYPE &#13;
        from pptx.enum.chart import XL_LABEL_POSITION, &#13;
                                    XL_LEGEND_POSITION &#13;
        from pptx.util import Inches &#13;
        from datetime import datetime &#13;
        import pandas as pd &#13;
 &#13;
        xls_file = pd.ExcelFile('Sales_Data.xlsx') &#13;
 &#13;
 &#13;
        prs = Presentation('sample_ppt.pptx') &#13;
 &#13;
        first_slide = prs.slides[0] &#13;
        first_slide.shapes[0].text_frame.paragraphs[0]&#13;
                   .text = "Weekly Sales Report %s" \ &#13;
                        % datetime.now().strftime('%D') &#13;
       first_slide.placeholders[1].text = &#13;
                          "Author: Alex, alex@innova8" &#13;
       blank_slide_layout = prs.slide_layouts[6] &#13;
       slide = prs.slides.add_slide(blank_slide_layout) &#13;
       slide.shapes.title.text = '% Revenue for Accounts' &#13;
       df = xls_file.parse('Sales') &#13;
       df['total'] = df['Items'] * df['UnitPrice'] &#13;
       plot = df.groupby('Account')['total']&#13;
                .sum().plot(kind='pie', \ &#13;
                autopct='%.2f', fontsize=20) &#13;
       f=plot.get_figure() &#13;
       f.savefig("result.png", bbox_inches='tight',&#13;
                                            dpi=400) &#13;
       left = Inches(2.5);  top = Inches(3) &#13;
       pic = slide.shapes.add_picture("result.png", left, top,&#13;
       height=Inches(4), width=Inches(5)) &#13;
 &#13;
       slide = prs.slides.add_slide(prs.slide_layouts[6]) &#13;
       slide.shapes.title.text = 'Sales Manager Performance' &#13;
       df = xls_file.parse('Sales') &#13;
       df['total'] = df['Items'] * df['UnitPrice'] &#13;
       mgr_data = df.groupby(['Manager'])['total'].sum() &#13;
       managers = mgr_data.index.values.tolist() &#13;
       sales = [] &#13;
       for mgr in managers:  &#13;
           sales.append(mgr_data.loc[mgr])  &#13;
 &#13;
       chart_data = ChartData() &#13;
       chart_data.categories = managers &#13;
       chart_data.add_series('Series 1', tuple(sales)) &#13;
       x, y, cx, cy = Inches(2), Inches(3), Inches(6),&#13;
                      Inches(4) &#13;
       chart = slide.shapes.add_chart( &#13;
       XL_CHART_TYPE.COLUMN_CLUSTERED, x, y, cx, cy, &#13;
                                          chart_data &#13;
       ).chart &#13;
 &#13;
       chart.has_legend = True &#13;
       chart.legend.position = XL_LEGEND_POSITION.BOTTOM &#13;
       chart.legend.include_in_layout = False &#13;
 &#13;
       prs.save('sales.pptx') &#13;
</pre></li><li class="listitem">Now, if we run the preceding piece of code, we get a PowerPoint presentation with all the necessary charts and data points that Alex needs in his weekly sales report. Look at the screenshots for all the slides of the presentation. Exactly what the doctor ordered for Alex! The first slide is the title slide of the presentation and is titled as <span class="strong"><strong>Weekly Sales Report &lt;Date&gt;</strong></span>. It also mentions Alex's name and e-mail address as the author of this presentation:<p>
</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_07_013.jpg"/></div><p>
</p><p>The second slide shows the revenue distribution across accounts with the help of a pie chart:</p><p>
</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_07_014.jpg"/></div><p>
</p><p>And finally, the last slide compares the performance of all sales managers with the help of a bar chart. Cool, huh?</p><p>
</p><div class="mediaobject"><img alt="How to do it..." src="graphics/image_07_015.jpg"/></div><p>
</p></li></ol></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec177"/>How it works...</h2></div></div></div><p>In the preceding example, we started by creating a reader object for the Excel sheet, <code class="literal">Sales_Data.xlsx</code> containing all the sales data. We achieved this by using the <code class="literal">ExcelFile()</code> method of the <code class="literal">pandas</code> module.</p><p>Next, we created a new presentation by utilizing the <code class="literal">sample_ppt.pptx</code> file. If you recollect, our sample presentation has a title slide without any text on it. So, in our code snippet, we updated this title slide by setting the title to <span class="strong"><strong>Weekly Status Report &lt;YYYY</strong></span>
<span class="strong"><strong>-</strong></span>
<span class="strong"><strong>MM</strong></span>
<span class="strong"><strong>-</strong></span>
<span class="strong"><strong>YY&gt;</strong></span>. We also added a subtitle that contained the name of the author, in this case <span class="strong"><strong>Author: Alex alex@innova8</strong></span>. We set these titles with the help of placeholders on the text frame.</p><p>Next, we added a new blank slide with layout six to our new presentation. We used this slide to add the revenue data for the accounts. We achieved this with the help of the <code class="literal">prs.slides.add_slide()</code> method. However, our data is in an Excel sheet, and hence, we use the <code class="literal">reader</code> object of the Excel sheet to read the <span class="strong"><strong>Sales</strong></span> worksheet. The <span class="strong"><strong>Sales</strong></span> worksheet has all the data Alex uses for his analysis. The pandas module reads Excel data in the form of a data frame (data stored in the matrix format). If you look at the Excel sheet screenshot, we have two columns, <code class="literal">Price</code> and <code class="literal">Quantity</code>, which indicates the quantity of laptops or software licenses sold and the price per unit. So, in our code, we first multiply these values to get the revenue for each entry in the Excel record and store it in the data frame with the column name <code class="literal">total</code>. Now, we don't just need the total revenue figure; we also need to categorize it based on the account. With data frames, getting this information is really trivial; it's like running an SQL query. If you look at the code, we have grouped the data frame by <code class="literal">Account</code> and summed all the <code class="literal">total</code> data (obtained from quantity * price) and used these data points to plot a pie chart so that its easier for Alex to compare the revenue for every account as a percentage of the total revenue. For grouping the data, we used the <code class="literal">groupby()</code> method and then totaled the revenue with the <code class="literal">sum()</code> method and plotted the pie chart with the <code class="literal">plot()</code> method. Again, it's not useful if the chart is available in <code class="literal">pandas</code> and not in PowerPoint, so we save the chart as a PNG file in <code class="literal">result.png</code>; we did that with the <code class="literal">savefig()</code> method of <code class="literal">pandas</code>. In the end, we added this picture file to our presentation using the <code class="literal">add_picture()</code> method and managed the coordinates and size of the picture so that it is visible and looks great.</p><p>Alex also needs to plot the performance of all his sales managers. For this, we used the same method to read the Excel sheet data and stored it in the form of data frames. For this problem though, we grouped the data by sales managers and got the total revenue attributed to each of them. Here too, we used the <code class="literal">groupby()</code> method but on the <code class="literal">Manager</code> column of the Excel data. We stored the names of all the sales managers in the array <code class="literal">managers</code>, iterated through all the records for each sales manager, got the sales figures for each of them, and added it to a list, <code class="literal">sales</code>. We then converted this list to a tuple to be used later. Just like we saw in the previous recipe, we created a chart data object using the <code class="literal">ChartData()</code> method, created a clustered bar chart with the 'sales' tuple as input, and added the chart to the second slide of the presentation with the <code class="literal">add_chart()</code> method.</p><p>In the end, we saved this newly created presentation as <code class="literal">sales.pptx</code>, which acts as a weekly sales report for Alex. That's it!</p><p>I hope you enjoyed the recipes in this chapter, the examples and the use cases we discussed. I'm sure your hands are itching to automate your presentations as well. When do I drop by your desk to appreciate your work?</p></div></div></body></html>