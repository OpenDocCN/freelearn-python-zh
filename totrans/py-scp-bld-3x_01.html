<html><head></head><body>
<div><div><h1 class="chapter-number" id="_idParaDest-15"><a id="_idTextAnchor014"/>1</h1>
<h1 id="_idParaDest-16"><a id="_idTextAnchor015"/>Python’s Integration with Blender</h1>
<p>Blender accepts code instructions in the same way as it interacts: via a graphical user interface.. That allows artists and studios to implement their own features and automation.</p>
<p>Python, a highly extensible <a id="_idIndexMarker000"/>programming language with low barriers to entry, is widely used in computer graphics.</p>
<p>Though Blender’s core is written in C and C++, menus and graphic elements use Python. That allows custom and factory functionalities to share the same look and feel.</p>
<p>In this chapter, we’ll learn how to run Python commands in Blender and where to look for their outcome. We will also see where a history of past instructions is found and how to use that to our advantage. Lastly, we will introduce a code editor and a version control system and see how they help make our work easier.</p>
<p>By the end of this chapter, you will understand how a programmer works and why it is not so different from using software in the first place.</p>
<p>In this chapter, we will cover the following main topics:</p>
<ul>
<li>The scripting workspace</li>
<li>Python execution</li>
<li>Version control</li>
</ul>
<h1 id="_idParaDest-17"><a id="_idTextAnchor016"/>Technical requirements</h1>
<p>Besides Blender 3.3+ or in this case, Blender 3.3 <a id="_idTextAnchor017"/>(<a href="https://www.blender.org/download/lts/3-3">https://www.blender.org/download/lts/3-3</a>), you will require the following free tools:</p>
<ul>
<li>Visual Studio Code, available at <a href="https://code.visualstudio.com/Download">https://code.visualstudio.com/Download</a>. Version 1.66 is used in this book, and is available at <a href="https://code.visualstudio.com/updates/v1_66">https://code.visualstudio.com/updates/v1_66</a></li>
<li>Git (optional), found at <a href="https://git-scm.com/downloads">https://git-scm.com/downloads</a><a href="https://git-scm.com/downloads%0D"/></li>
</ul>
<p>You are encouraged to write your own code; the examples for this chapter can be found at the following URL: <a href="https://github.com/PacktPublishing/Python-Scripting-in-Blender/tree/main/ch1">https://github.com/PacktPublishing/Python-Scripting-in-Blender/tree/main/ch1</a>.<a href="https://github.com/PacktPublishing/PythonScriptinginBlender/tree/main/ch1%0D"/></p>
<p>Since it is a free, open source software, there are plenty of ways to install Blender. We are going to look at the most common install solutions.</p>
<h1 id="_idParaDest-18"><a id="_idTextAnchor018"/>Installing Blender</h1>
<p>The procedure for <a id="_idIndexMarker001"/>installing Blender varies with the operating system. Like most applications, installers for <em class="italic">Microsoft Windows</em> and <em class="italic">Apple macOS</em> are provided. Also, portable versions, such as archives that can be uncompressed and executed everywhere in the system, are available for <em class="italic">Linux</em> and Windows.</p>
<p>The version of Blender used in this book, 3.3, might differ from other versions already installed on the system. In that case, we can install different versions of Blender on the same machine.</p>
<h2 id="_idParaDest-19"><a id="_idTextAnchor019"/>Installing Blender on Windows</h2>
<p>There are more ways to install a <a id="_idIndexMarker002"/>program on Microsoft <a id="_idIndexMarker003"/>Windows: Windows Installer, <em class="italic">Microsoft Store</em>, and <em class="italic">using a portable archive</em>. While most application publishers choose one of those options, all of them are available for Blender.</p>
<h3>Installing multiple versions via Windows Installer</h3>
<p>The most common <a id="_idIndexMarker004"/>way to install Blender on Windows is to download <code>.msi</code> file installs Blender. Before Blender 3.4, only one of the multiple installed versions was available in the <strong class="bold">Start</strong> menu.</p>
<p>If that is the case for you, the other versions can be accessed by navigating to the <code>Program Files</code> folder, usually <code>C:\Program Files\Blender Foundation</code>, using Windows Explorer.</p>
<p>We can execute <code>blender.exe</code> directly from the <code>Blender 3.3</code> folder or use right-click &gt; <strong class="bold">New</strong> &gt; <strong class="bold">Shortcut</strong> in Windows Explorer and create a shortcut to it:</p>
<div><div><img alt="Figure 1.1: Multiple versions of Blender in Program Files" height="343" src="img/Figure_1.1_B18375.jpg" width="814"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.1: Multiple versions of Blender in Program Files</p>
<p>Alternatively, since <a id="_idIndexMarker006"/>version 3.3 is <a id="_idIndexMarker007"/>a <em class="italic">Long-term Support</em> version, it is also available in the Microsoft Store.</p>
<h3>Installing Blender from the Microsoft Store</h3>
<p>The download <a id="_idIndexMarker008"/>page of Blender 3.3 provides a link <a id="_idIndexMarker009"/>to the Microsoft Store installer. Alternatively, we can start <code>blender</code> in the top bar. Once we get to the <strong class="bold">Blender</strong> page, we make sure that it’s published by <strong class="bold">Blender Foundation</strong> and click the <strong class="bold">Get</strong> button:</p>
<div><div><img alt="Figure 1.2: Installing Blender from the Microsoft Store" height="823" src="img/Figure_1.02_B18375.jpg" width="1202"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.2: Installing Blender from the Microsoft Store</p>
<p>That will add <a id="_idIndexMarker010"/>a Blender 3.3 entry in the <strong class="bold">Start</strong> menu:</p>
<div><div><img alt="Figure 1.3: Multiple versions in the Start menu" height="366" src="img/Figure_1.03_B18375.jpg" width="598"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.3: Multiple versions in the Start menu</p>
<p>Microsoft Store <a id="_idIndexMarker011"/>gives the advantage of always adding a shortcut for the installed version. If, for some reason, Microsoft Store is not an option, we can download a portable archive.</p>
<h3>Downloading a portable archive</h3>
<p>To avoid any application <a id="_idIndexMarker012"/>packaging, we can download a Windows portable <code>.zip</code> file, or a Linux <code>.</code><code>tar.xz</code> archive.</p>
<p>Portable versions can be used from any location of the system, even removable drives. We only need to extract the archive in a directory of choice via right-clicking -&gt; <code>blender.exe</code> or <code>blender</code> executable in the unpacked folder.</p>
<h2 id="_idParaDest-20"><a id="_idTextAnchor020"/>Installing multiple versions on macOS</h2>
<p>We can <a id="_idIndexMarker013"/>download the <code>.dmg</code> packages for <em class="italic">Apple Intel</em> or <em class="italic">Apple Silicon</em> computers. Once downloaded, double-clicking the file <a id="_idIndexMarker014"/>will open the installer window. If another version of Blender is already present in the system, a prompt dialog will ask whether we want to keep both or replace the installed version with the new one.</p>
<p>Selecting <code>Blender 3.3</code> using right-click -&gt; <strong class="bold">Rename</strong> on the <strong class="bold">Application</strong> entry in the file manager:</p>
<div><div><img alt="Figure 1.4: Installing an additional version of Blender on macOS" height="1024" src="img/Figure_1.4_B18375.jpg" width="1306"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.4: Installing an additional version of Blender on macOS</p>
<p>There are many other ways to install Blender: a link to stores such as <em class="italic">Steam</em> (Windows, macOS, or Linux) or <em class="italic">Snapcraft</em> (Linux only) is provided on the download page, not to mention the <a id="_idIndexMarker015"/>package manager of Linux <a id="_idIndexMarker016"/>distribution (<em class="italic">apt</em> on <em class="italic">Ubuntu</em>, <em class="italic">yum</em> on <em class="italic">CentOS</em>, and so on). It is worth mentioning that it is possible to build Blender from the source code, but that’s an advanced topic beyond the scope of this book.</p>
<p>While this book sticks to version 3.3, the examples should work on future releases of the 3.x series with minor corrections at worst.</p>
<p>A future major release, such as Blender 4 or 5, is almost guaranteed to break compatibility with past scripts. Still, the knowledge from this book about best practices and thought patterns will stand the test of time.</p>
<p>Now that we have installed Blender on our system, we can dive into its scripting capabilities.</p>
<h1 id="_idParaDest-21"><a id="_idTextAnchor021"/>The Scripting workspace – first steps with Python</h1>
<p>A sequence of Python <a id="_idIndexMarker017"/>instructions is often referred to as a <strong class="bold">script</strong>. Likewise, the activity of <a id="_idIndexMarker018"/>producing Python code is usually called <strong class="bold">Scripting</strong>.</p>
<p>Blender’s interface consists of different <strong class="bold">workspaces</strong>. Each of them is a tab meant for a different activity. At the time of writing, the <strong class="bold">Scripting</strong> tab is the last on the right side of the screen. Clicking on it switches to the interface designed for Python users.</p>
<p>The most <a id="_idIndexMarker019"/>significant elements are the <strong class="bold">Python console</strong>, the <strong class="bold">Info Log</strong>, and the <strong class="bold">Text Editor</strong>:</p>
<div><div><img alt="Figure 1.5: Blender scripting interface" height="669" src="img/Figure_1.05_B18375.jpg" width="1088"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.5: Blender scripting interface</p>
<p>We will start our journey in Python by typing commands in the Python console.</p>
<h2 id="_idParaDest-22"><a id="_idTextAnchor022"/>The Python console</h2>
<p>The console is an <a id="_idIndexMarker020"/>interactive terminal with a header that displays the current <a id="_idIndexMarker021"/>version of Python (<code>3.10.2</code>, at the time of writing) and a <code>&gt;&gt;&gt;</code> prompt sign to advertise that it’s waiting for interactive text. All we need to do is hover the cursor on it and type an instruction:</p>
<div><div><img alt="Figure 1.6: The Python console" height="266" src="img/Figure_1.6_B18375_New.jpg" width="1523"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.6: The Python console</p>
<h3>“Hello World!” from the console</h3>
<p>The practice <a id="_idIndexMarker022"/>called <em class="italic">Hello World!</em> is a way to familiarize yourself<a id="_idIndexMarker023"/> with a new programming language. It’s about displaying the titular phrase using a command.</p>
<p>We will use the <code>print</code> function for that. Example code for the interactive console starts with the <code>&gt;&gt;&gt;</code> prompt symbol. We don’t need to type that as well in the console: it is already there. We click on the console area and type <code>print("Hello World")</code>:</p>
<pre class="source-code">
&gt;&gt;&gt; print("Hello World")</pre>
<p>Then press <em class="italic">Enter</em>. The console output is displayed in a different color and doesn’t start with the prompt:</p>
<div><div><img alt="Figure 1.7: Displaying our output on the console" height="141" src="img/Figure_1.7_B18375.jpg" width="1143"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.7: Displaying our output on the console</p>
<p>We can use the Python console to query information about the Python version.</p>
<h3>Checking the Python release</h3>
<p>The current <a id="_idIndexMarker024"/>version of Python can be displayed anytime using the <code>sys</code> module. We need to import this module and look for its <code>version</code> attribute. That takes the following two lines:</p>
<pre class="source-code">
&gt;&gt;&gt; import sys
&gt;&gt;&gt; sys.version</pre>
<p>The console prints out verbose information about the version in use:</p>
<pre class="source-code">
'3.10.2 (main, Jan 27 2022, 08:34:43) ...'</pre>
<p>The three digits of the version number stand for <em class="italic">major</em>, <em class="italic">minor</em>, and <em class="italic">micro</em> versions. A different major release number implies heavy changes in the language syntax: <em class="italic">Python 3.0</em> is very different from any Python 2.x releases. A minor release introduces new features but doesn’t <a id="_idIndexMarker025"/>break compatibility with older code. A micro release doesn’t bring changes to the language; it consists of bug fixes and other forms of maintenance.</p>
<p>The changes brought <a id="_idIndexMarker026"/>with each new Python version are available as <em class="italic">Release Notes</em> on the download page of the <strong class="bold">Python </strong><strong class="bold">Software Foundation</strong>:</p>
<p><a href="https://www.python.org/downloads/">https://www.python.org/downloads/</a></p>
<p>If our script relies on a feature introduced with a minor release, we can check the version numbers individually using <code>version_info</code>, as seen here:</p>
<pre class="source-code">
import sys
if sys.version_info.minor &lt; 6:
    print("Warning: This script requires Python 3.6.x")</pre>
<p>Compared with other software, Blender follows the Python release cycle very tightly. This is done mostly to take advantage of the latest improvements in terms of performance and bug fixes.</p>
<h3>Checking the Blender release</h3>
<p>The current <a id="_idIndexMarker027"/>Blender release can be checked in the graphical user interface or in Python scripts.</p>
<h4>Checking the Blender release in the interface</h4>
<p>Starting from <a id="_idIndexMarker028"/>version 3.0, the most immediate place to check for the version number of Blender is in the lower-right corner of the window. In version 3.3, the version number is followed by the current time and frame set for the scene:</p>
<div><div><img alt="Figure 1.8: Blender version number in the status bar" height="400" src="img/Figure_1.08_B18375.jpg" width="1000"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.8: Blender version number in the status bar</p>
<p>Another way to <a id="_idIndexMarker029"/>display the version number is by clicking the Blender icon in the top-right corner of the menu bar and then selecting <strong class="bold">About Blender</strong> from the menu.</p>
<p>We can also get Blender’s version number via Python scripts.</p>
<h4>Checking the Blender release in Python scripts</h4>
<p>If our scripts rely <a id="_idIndexMarker030"/>on features from a specific version, they must be able to determine on which release of Blender it is running. That information is contained in the <code>bpy.app</code> module. We can display the current version by typing these lines in the console:</p>
<pre class="source-code">
&gt;&gt;&gt; import bpy
&gt;&gt;&gt; bpy.app.version</pre>
<p>In <em class="italic">Blender 3.3.2</em>, the console returns the following:</p>
<pre class="source-code">
(3, 3, 2)</pre>
<p>Unlike <code>sys.version_info</code>, <code>bpy.app.version</code> doesn’t contain names, just numbers. Nevertheless, we can store them in variables using the Python syntax:</p>
<pre class="source-code">
&gt;&gt;&gt; major, minor, micro = bpy.app.version</pre>
<p>Then, we can use <code>print</code> to display the single version numbers:</p>
<pre class="source-code">
&gt;&gt;&gt; print("Major version:", major)
Major version: 3
&gt;&gt;&gt; print("Minor version:", minor)
Minor version: 3
&gt;&gt;&gt; print("Micro version:", micro)
Micro version: 2</pre>
<p>A new major <a id="_idIndexMarker031"/>release of Blender brings drastic changes to the interface and workflow, while a minor release introduces new tools for animation or for generating images.</p>
<p>To display the information, we have used the <code>print</code> function. Since functions are the first step toward structured programming, we will have a better look at how they work and how we can change the <code>"Hello World!"</code> message to something else.</p>
<h3>Invoking functions</h3>
<p>When we use a <em class="italic">function</em>, we say that we <em class="italic">call</em> or <em class="italic">invoke</em> that function. To do that, we type its name, followed <a id="_idIndexMarker032"/>by parentheses. Between parentheses, there is the function’s <em class="italic">argument</em>, such as the input on which it operates:</p>
<div><div><img alt="Figure 1.9: Function and argument in a Python script" height="98" src="img/Figure_1.09_B18375.jpg" width="548"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.9: Function and argument in a Python script</p>
<p>When invoked, the <code>print</code> function reads the argument and displays it on a new line.</p>
<p>The <code>"Hello World!"</code> argument is a <em class="italic">string literal</em>: it can be any sequence of characters enclosed between quotation marks (<code>""</code>).</p>
<p>We can feed any other message to <code>print</code>; the output will vary accordingly:</p>
<div><div><img alt="Figure 1.10: Printing text in the Blender Python console" height="62" src="img/Figure_1.10_B18375.jpg" width="1153"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.10: Printing text in the Blender Python console</p>
<p>Now that we have gained confidence, we will look at some Blender commands.</p>
<h2 id="_idParaDest-23"><a id="_idTextAnchor023"/>The Info Log</h2>
<p>The user activity is displayed <a id="_idIndexMarker033"/>as Python commands in the log area, at the bottom left <a id="_idIndexMarker034"/>of the <strong class="bold">Scripting</strong> workspace. We can open Blender and perform the following operations:</p>
<ol>
<li>Delete the default cube in the Viewport via right-click -&gt; <strong class="bold">Delete</strong>.</li>
<li>From the Viewport top bar, click <strong class="bold">Add</strong> -&gt; <strong class="bold">Mesh</strong> -&gt; <strong class="bold">Cylinder</strong>.</li>
<li>From the Viewport top bar, click <strong class="bold">Add</strong> -&gt; <strong class="bold">Mesh</strong> -&gt; <strong class="bold">UV Sphere</strong>. We will find these three lines in the Info Log area:</li>
</ol>
<div><div><img alt="Figure 1.11: History of actions in the Info Log area" height="141" src="img/Figure_1.11_B18375.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.11: History of actions in the Info Log area</p>
<p>The entries <a id="_idIndexMarker035"/>of the Info Log are the Python commands triggered by our recent activity. We can <a id="_idIndexMarker036"/>copy those lines and use them in our scripts.</p>
<h3>Using the lines from the log</h3>
<p>Clicking or <a id="_idIndexMarker037"/>dragging with the left mouse button selects the log lines. We can copy them to the clipboard via right-click -&gt; <strong class="bold">Copy</strong>:</p>
<div><div><img alt="Figure 1.12: Copying Python commands from the Info Log" height="167" src="img/Figure_1.12_B18375.jpg" width="965"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.12: Copying Python commands from the Info Log</p>
<p>We can go back to the startup scene and paste them into the console:</p>
<ol>
<li>Restart Blender or click <strong class="bold">File</strong> -&gt; <strong class="bold">New </strong>-&gt; <strong class="bold">General</strong>.</li>
<li>Go to the <strong class="bold">Scripting</strong> workspace.</li>
<li>In the Python console, right-click -&gt; <strong class="bold">Paste</strong>, and press <em class="italic">Enter</em>.</li>
</ol>
<p>Executing those lines will delete the initial cube, then add two objects: the same steps run manually earlier. We will see how we can change their content and affect the outcome.</p>
<h3>Changing parameters</h3>
<p>Let’s not focus too much on the code for now: it will be clearer in the next chapter. Anyway, we might recognize a pattern from the <code>"Hello </code><code>World!"</code> example:</p>
<pre class="source-code">
function(arguments between parentheses)</pre>
<p>And at least <a id="_idIndexMarker038"/>one argument is self-explanatory in its purpose:</p>
<pre class="source-code">
bpy.[…]_uv_sphere_add(…, …, <strong class="bold">location=(0, 0, 0)</strong>, …)</pre>
<p><code>location=(x, y, z)</code> represents the 3D coordinates where a new object is added. We can change the last line and create our sphere just above the cylinder.</p>
<p>Let’s revert to the startup scene once more and paste our lines again, but before we press <em class="italic">Enter</em>, this time, we change the last zero to <code>2</code>:</p>
<pre class="source-code">
bpy.ops.mesh.primitive_uv_sphere_add(radius=1, enter_editmode=False, align='WORLD', <strong class="bold">location=(0, 0, 2)</strong>, scale=(1, 1, 1))</pre>
<p>We have just run our first script. It deletes the selected objects and stacks two new shapes on top of each other:</p>
<div><div><img alt="Figure 1.13: Cylinder and Sphere primitives, created via Python" height="210" src="img/Figure_1.13_B18375.jpg" width="848"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.13: Cylinder and Sphere primitives, created via Python</p>
<p>The Python console can execute code with immediacy but is not very practical for more than a few lines. We will now see how to run Python scripts as documents.</p>
<h2 id="_idParaDest-24"><a id="_idTextAnchor024"/>The Text Editor</h2>
<p>This is the largest <a id="_idIndexMarker039"/>element in the <strong class="bold">Scripting</strong> workspace. It can be used for <a id="_idIndexMarker040"/>writing text and scripts.</p>
<p>To add a new script, we click the <strong class="bold">+ New</strong> button in the top bar and create a new text:</p>
<div><div><img alt="Figure 1.14: Creating a new text object in the Text Editor" height="133" src="img/Figure_1.14_B18375.jpg" width="1374"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.14: Creating a new text object in the Text Editor</p>
<p>Let’s type some words, for instance, a more verbose version of <em class="italic">“Hello World!”</em>. Like many programmer editors, Blender displays the line numbers on the left:</p>
<div><div><img alt="" height="133" src="img/Figure_1.15_B18375.jpg" width="1374"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.15: Writing scripts in the Text Editor</p>
<p>Also, the words have <a id="_idIndexMarker041"/>different colors according to their Python meaning: white for <a id="_idIndexMarker042"/>the function, yellow for the string, and red for the parenthesis. This feature is called <strong class="bold">syntax highlighting</strong> and gives useful visual feedback: the color of the words depends <a id="_idIndexMarker043"/>on their role in the programming language.</p>
<h3>Running text documents</h3>
<p>If the current text <a id="_idIndexMarker044"/>is a Python script, we can execute it from the Text Editor:</p>
<ol>
<li>Click on <strong class="bold">Run Script</strong> from the <strong class="bold">Text</strong> menu in the Text Editor menu bar.</li>
<li>Look for the execution outcome info in the Info Log:</li>
</ol>
<div><div><img alt="Figure 1.16: Executing scripts in the Text Editor" height="476" src="img/Figure_1.16_B18375.jpg" width="1545"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.16: Executing scripts in the Text Editor</p>
<p>The Info Log confirms that something has happened:</p>
<div><div><img alt="Figure 1.17: The script execution mentioned in the Info Log" height="71" src="img/Figure_1.17_B18375.jpg" width="825"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.17: The script execution mentioned in the Info Log</p>
<p>But we might be disappointed, as the printout text is apparently nowhere to be found!</p>
<p>The reason is that the output of the Text Editor goes straight to the <strong class="bold">System Console</strong>, the <em class="italic">operating system’s</em> command line.</p>
<p>On Windows, we can display it using <strong class="bold">Window</strong> -&gt;<strong class="bold">Toggle System Console</strong> from Blender’s top bar. To <a id="_idIndexMarker045"/>read system messages on a Unix-based system (Linux or macOS), we must start Blender from a command line in the first place.</p>
<p>Once brought up, <strong class="bold">System Console</strong> displays the output printed by the Text Editor:</p>
<div><div><img alt="Figure 1.18: Displaying the System Console on Windows" height="559" src="img/Figure_1.18_B18375.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.18: Displaying the System Console on Windows</p>
<p>The default name for our text block is <code>Text</code>. It can be renamed by clicking on it. We’ll better add the <code>.py</code> suffix as an extension to make it clear that it’s a Python script:</p>
<div><div><img alt="Figure 1.19: Renaming text blocks in Blender" height="112" src="img/Figure_1.19_B18375.jpg" width="1299"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.19: Renaming text blocks in Blender</p>
<h3>Copying the Python console as script</h3>
<p>Remember the lines <a id="_idIndexMarker046"/>we entered in the Python console earlier? If we haven’t closed Blender or loaded a new scene, we can copy them to the <em class="italic">clipboard</em> at once.</p>
<ol>
<li>From the <strong class="bold">Console</strong> menu in the Python console top bar, select <strong class="bold">Copy </strong><strong class="bold">as Script</strong>.</li>
<li>Create another text block using <strong class="bold">Text</strong> &gt; <strong class="bold">New</strong> from the Text Editor menu.</li>
<li>Give the text a new name, such as <code>OurFirstScript.py</code>.</li>
<li>Paste the lines from the clipboard via right-click -&gt; <strong class="bold">Paste</strong> in the text area.</li>
</ol>
<p>Looking at <a id="_idIndexMarker047"/>the Text Editor, it turns out that the full version of the script is a little bit longer than our three lines:</p>
<div><div><img alt="Figure 1.20: The Python console input copied to the Text Editor" height="623" src="img/Figure_1.20_B18375.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.20: The Python console input copied to the Text Editor</p>
<p>The first five rows set up the console environment. They are executed behind the scenes when Blender starts.</p>
<p>Lines starting with a hash (<code>#</code>) are <em class="italic">comments</em>: they are ignored by Python and contain reminders or explanations meant for human readers.</p>
<p>Our own <a id="_idIndexMarker048"/>instructions are respectively at lines <strong class="bold">13</strong>, <strong class="bold">17</strong>, and <strong class="bold">21</strong>. This script can be executed via <strong class="bold">Text</strong> -&gt; <strong class="bold">Run Script</strong> as we did before or via the <em class="italic">Alt</em> +<em class="italic"> P</em> keys combination.</p>
<h3>Exporting text files</h3>
<p>The notepad icon <a id="_idIndexMarker049"/>lets us switch between different text blocks via a drop-down list:</p>
<div><div><img alt="Figure 1.21: Switching between text blocks in Blender" height="222" src="img/Figure_1.21_B18375.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.21: Switching between text blocks in Blender</p>
<p>Selecting <strong class="bold">Text</strong> | <strong class="bold">Save As…</strong> from the editor menu bar saves the current text to disk. A new window lets us select a folder and confirm the filename:</p>
<div><div><img alt="Figure 1.22: Saving the content of the Text Editor to file" height="573" src="img/Figure_1.22_B18375.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.22: Saving the content of the Text Editor to file</p>
<p>Blender’s Text Editor is great <a id="_idIndexMarker050"/>for quick tests, but a programmer text editor is usually preferred for more serious tasks. We are going to use <em class="italic">Visual Studio Code</em> in the next section.</p>
<h1 id="_idParaDest-25"><a id="_idTextAnchor025"/>External editor – Visual Studio Code</h1>
<p><strong class="bold">Visual Studio Code</strong> (<strong class="bold">VS Code</strong>), is a fast, multiplatform, free editor from Microsoft, available for <a id="_idIndexMarker051"/>Windows, macOS, and Linux. Using an external editor makes our code independent from a session of Blender. Also, a programmer text editor offers many utilities besides syntax highlighting.</p>
<p>VS Code 1.66 is used in this book. It is a fast, lightweight editor available for most platforms, but there are plenty of alternatives – most notably, the following:</p>
<ul>
<li><strong class="bold">Notepad++</strong>: This is a fast but <a id="_idIndexMarker052"/>powerful editor for Windows, available <a id="_idIndexMarker053"/>at <a href="https://notepad-plus-plus.org%0D">https://notepad-plus-plus.org.</a></li>
<li><strong class="bold">PyCharm</strong>: This is <a id="_idIndexMarker054"/>a Python <strong class="bold">integrated development environment</strong> (<strong class="bold">IDE</strong>) by <strong class="bold">JetBrains</strong>. A free <a id="_idIndexMarker055"/>community version can be <a id="_idIndexMarker056"/>found at <a href="https://www.jetbrains.com/pycharm%0D">https://www.jetbrains.com/pycharm.</a></li>
<li><strong class="bold">LightTable</strong>: This is an <a id="_idIndexMarker057"/>interesting open <a id="_idIndexMarker058"/>source editor, available at <a href="http://lighttable.com%0D">http://lighttable.com.</a></li>
<li><strong class="bold">Sublime</strong>: This is a <a id="_idIndexMarker059"/>commercial text <a id="_idIndexMarker060"/>editor, found at <a href="https://www.sublimetext.com%0D">https://www.sublimetext.com.</a></li>
</ul>
<p>Most Linux distributions come with at least one decent, ready-to-use, text editor. We encourage you to <a id="_idIndexMarker061"/>experiment and find the text editor of your choice.</p>
<p>In this section, we will set up VS Code for Python scripting.</p>
<p class="callout-heading">Pick the right studio!</p>
<p class="callout"><em class="italic">VS Code</em> and <em class="italic">Visual Studio</em> have a similar name but are two different products from Microsoft. While VS Code is <a id="_idIndexMarker062"/>a programmer text editor, Visual Studio is a full development environment for advanced languages such as <em class="italic">C++</em>. While C++ projects may require a specific version <a id="_idIndexMarker063"/>of the building environment, it is safe to use any version of VS Code as long as Python is a supported language.</p>
<h2 id="_idParaDest-26"><a id="_idTextAnchor026"/>Loading our scripts folder</h2>
<p>We can load the <a id="_idIndexMarker064"/>folder that contains our script files using the <code>.py</code> file opens the script for editing.</p>
<p>Additional Python support can be installed by clicking <strong class="bold">Install</strong> on the bottom-right notification:</p>
<div><div><img alt="Figure 1.23: Our Python script in VS Code" height="877" src="img/Figure_1.23_B18375.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.23: Our Python script in VS Code</p>
<h2 id="_idParaDest-27"><a id="_idTextAnchor027"/>Keeping Blender’s text blocks in sync</h2>
<p>When a <a id="_idIndexMarker065"/>text file open in Blender is changed by another application, a red question mark appears to the left of the filename:</p>
<div><div><img alt="Figure 1.24: Blender detects changes in a saved script" height="211" src="img/Figure_1.24_B18375.jpg" width="1477"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.24: Blender detects changes in a saved script</p>
<p>Clicking the question mark displays the viable actions:</p>
<ul>
<li><strong class="bold">Reload from disk</strong>: This loads and displays the up-to-date file</li>
<li><strong class="bold">Make text internal (separate copy)</strong>: The displayed text is now part of the Blender session, no longer tied to any text file on disk</li>
<li><strong class="bold">Ignore</strong>: Changes are ignored; Blender will still display the old text and keep reporting that it’s out of sync with the text saved on disk</li>
</ul>
<p>To have additional help, we can add versioning to our files. That allows us to make changes without worrying about breaking things or losing our work.</p>
<h1 id="_idParaDest-28"><a id="_idTextAnchor028"/>Version control and backup</h1>
<p><strong class="bold">Version control</strong> helps to <a id="_idIndexMarker066"/>keep track of file changes, save snapshots of the code, and roll back to older versions if necessary. <strong class="bold">Git</strong> is the most used versioning system at present; it is <a id="_idIndexMarker067"/>free and integrated into most editors. In this section, we will use version control in combination with VS Code.</p>
<h2 id="_idParaDest-29"><a id="_idTextAnchor029"/>Initializing the repository</h2>
<p>Once Git is <a id="_idIndexMarker068"/>installed, it can be used from VS Code, by activating the <strong class="bold">Source Control</strong> tab using the <em class="italic">branch</em> icon on the left column bar. The <strong class="bold">Initialize Repository</strong> button adds versioning to our folder:</p>
<div><div><img alt="Figure 1.25: Adding version control in VS Code" height="843" src="img/Figure_1.25_B18375.jpg" width="1581"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.25: Adding version control in VS Code</p>
<p>The icon will change and warn us about the presence of files. We click the <strong class="bold">+</strong> icon next to the filename to add them to versioning. In Git terminology, we are going to <strong class="bold">Stage</strong> the current changes:</p>
<div><div><img alt="Figure 1.26: Staging changes in VS Code" height="99" src="img/Figure_1.26_B18375.jpg" width="410"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.26: Staging changes in VS Code</p>
<p>The editor shows the before/after conditions of our files. We can add a message in the text field on the top <a id="_idIndexMarker069"/>left and click the <em class="italic">tick</em> icon. This will <strong class="bold">Commit</strong> our changes to the project history:</p>
<div><div><img alt="Figure 1.27: Commit changes in VS Code" height="149" src="img/Figure_1.27_B18375.jpg" width="825"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.27: Commit changes in VS Code</p>
<h2 id="_idParaDest-30"><a id="_idTextAnchor030"/>Making changes</h2>
<p>Let’s say we don’t want <a id="_idIndexMarker070"/>our script to delete the current objects. To do that, we delete line number <strong class="bold">13</strong>:</p>
<pre class="source-code">
bpy.ops.object.delete(use_global=False)</pre>
<p>When the file is saved, version control detects this change. We can stage that by clicking the <code>OurFirstScript.py</code> in the left column, VS Code highlights the current changes. We add a message for this new commit and click the <strong class="bold">tick</strong> button again:</p>
<div><div><img alt="Figure 1.28: Displaying changes in VS Code" height="547" src="img/Figure_1.28_B18375.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.28: Displaying changes in VS Code</p>
<p>If we go back to the <strong class="bold">Explorer</strong> tab and select our script, we will see that a section called <strong class="bold">Timeline</strong> can be expanded: it contains a list of our commit messages. Selecting a commit displays the related changes, allowing us to restore old lines of code. Every change that is not committed can be easily undone using the <em class="italic">Revert</em> function.</p>
<h3>Reverting uncommitted changes</h3>
<p>Let’s add some <a id="_idIndexMarker071"/>incorrect text at line <strong class="bold">7</strong> and save. If, for any reason, we cannot undo that, we can right-click our file in the <strong class="bold">Version Control</strong> tab and select <strong class="bold">Discard Changes</strong>:</p>
<div><div><img alt="Figure 1.29: Discarding uncommitted changes in VS Code" height="504" src="img/Figure_1.29_B18375.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 1.29: Discarding uncommitted changes in VS Code</p>
<p>The importance of <a id="_idIndexMarker072"/>version control can be underestimated at first but becomes vital in more complex projects. It’s a wide topic that goes beyond the scope of this book, but it’s important to grasp at least the basics of it.</p>
<h1 id="_idParaDest-31"><a id="_idTextAnchor031"/>Summary</h1>
<p>In this chapter, we gained confidence with <em class="italic">scripting</em> and introduced the fundamental tools for Python programming. You learned how to look for Python commands in the Blender log and execute them in different contexts, and how to set up a coding environment. We also learned how to keep track of our code and edits.</p>
<p>In <a href="B18375_02.xhtml#_idTextAnchor033"><em class="italic">Chapter 2</em></a>, we will refine our knowledge of Python. We will meet the most common entities and learn how to use the programming logic to write more useful scripts.</p>
<h1 id="_idParaDest-32"><a id="_idTextAnchor032"/>Questions</h1>
<ol>
<li>How do we display the sections of Blender that accept Python input?</li>
<li>How can we read the output and printout from Python execution?</li>
<li>Does Blender use Python to carry on the user actions?</li>
<li>How can we look at Blender’s Python activity log?</li>
<li>How do we write scripts in Blender? Can we edit them in other applications?</li>
<li>How and in which tab can we initialize version control in VS Code?</li>
<li>How can we access a script’s timeline in VS Code?</li>
</ol>
</div>
</div></body></html>