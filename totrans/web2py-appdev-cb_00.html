<html><head></head><body>
  <div><div><div><div><div><h1 class="title"><a id="pre05"/>Preface</h1></div></div></div><p>we2py is a framework for rapid development of secure database-driven Internet applications. It is written in and is programmable in Python. It comprises libraries, applications, and reusable examples.</p><p>Created in 2007,web2py has grown, evolved, and improved tremendously, thanks to the work of many developers who have been using the framework. We thank them all.</p><p>web2py has evolved rapidly in the last two years, so much so that it has been difficult to keep the official documentation current. Although web2py is always backwards-compatible, new APIs have been created, providing new ways to solve old problems.</p><p>A large body of knowledge has accumulated in third-party websites, such as wikis, blogs, and mailing lists. Two resources, in particular, have been very valuable to web2py users: the web2py Google Group and the<a class="ulink" href="http://www.web2pyslices.com/website"> http://www.web2pyslices.com/website</a>. Yet the quality of the information provided there varies, as some of the recipes have become outdated.</p><p>This book started from the need to collect that information, clean it up, update it, and separate the important and recurrent problems that users try to solve from other issues, which do not represent the general interest.</p><p>The most recurrent problems encountered by users include deploying web2py in a production-ready configuration, building complex applications using reusable components, generating PDF reports, customizing forms and authentication, using third-party libraries (jQuery plugins in particular), and interfacing with third-party web services.</p><p>Collecting this information and organizing it in this book has taken us more than a year. More people than the listed authors have knowingly and unknowingly contributed. Some of the code used here is, in fact, based on code already published online, although that code has been refactored, tested, and documented better here.</p><p>The code in this book is released under the BSD license, unless otherwise specified, and is available online on a dedicated GitHub repository listed below. Python code should follow a style convention called PEP 8. We have followed that convention for the code posted online, but we have compressed the listings in the printed book in order to follow the Packt style guide, and reduce the need for wrapping long lines.</p><p>We trust this book will be a valuable resource for both new web2py developers and experienced ones. Our goal is still to make the web a more open and accessible place. We contribute by providing web2py and its documentation to enable anyone to build new infrastructure and services with agility and efficiency.</p><div><div><div><div><h1 class="title"><a id="ch00lvl1sec02"/>What this book covers</h1></div></div></div><p>
<a class="link" href="ch01.html" title="Chapter 1. Deploying web2py">Chapter 1</a>,<em> Deploying web2py</em>. In this chapter, we discuss how to configure various web servers to work with web2py. This is a necessary setup for a production environment. We consider the most popular servers, such as Apache, Cherokee, Lighttpd, Nginx, CGI, and IIS. The corresponding recipes provide examples of usage of the different adapters, such as<code class="literal"> mod_wsgi, FastCGI, uWSGI</code>, and<code class="literal"> ISAPI</code>. Therefore, they can easily be extended to many other web servers. Using a production web server guarantees speedier serving of static files, better concurrency, and enhanced logging capabilities.</p><p>
<a class="link" href="ch02.html" title="Chapter 2. Building Your First Application">Chapter 2</a>,<em> Building Your First Application</em>. We guide the reader through the process of creating a few non-trivial applications, including a<code class="literal"> Contacts</code> application, a<code class="literal"> Reddit</code> clone, and a<code class="literal"> Facebook</code> clone. Each of these applications provides user authentication, multiple tables connected by relations, and Ajax functionality. In the second part of the chapter, we discuss further customization of generic web2py applications, such as building a plugin to serve flat pages, adding a logo to the header, customizing the menu, and allowing users to select their preferred language. The main focus of this chapter is on modularity and reusability.</p><p>
<a class="link" href="ch03.html" title="Chapter 3. Database Abstraction Layer">Chapter 3</a>,<em> Database Abstraction Layer</em>. The DAL is arguably the most important component of web2py. In this chapter, we discuss various ways to import models and data from existing sources (csv files,<code class="literal"> mysql</code>, and<code class="literal"> postgresql</code> databases), and how to create new models. We deal with recurrent situations, such as tagging data and efficiently searching the database using tags. We implement a tree representation using the pre-order tree traversal method. We demonstrate how to work around some of the limitations of the Google App Engine platform.</p><p>
<a class="link" href="ch04.html" title="Chapter 4. Advanced Forms">Chapter 4</a>,<em> Advanced Forms</em>. One of the strengths of web2py is its ability to automatically generate forms from the data representation. Yet, inevitably, the most demanding users feel the need to customize these forms. In this chapter, we provide examples of typical customizations, such as adding buttons, adding an upload progress bar, adding tooltips, and adding thumbnails for uploaded images. We also show how to create wizard forms and add multiple forms on one page.</p><p>
<a class="link" href="ch05.html" title="Chapter 5. Adding Ajax Effects">Chapter 5</a>,<em> Adding Ajax Effects</em>. This chapter is an extension of the previous one. Here we further enhance forms and tables, using various jQuery plugins to make them more interactive using Ajax.</p><p>
<a class="link" href="ch06.html" title="Chapter 6. Using Third-party Libraries">Chapter 6</a>,<em> Using Third-party Libraries</em>. web2py can use any Python third-party library. In this chapter we give some examples by using libraries that ship with web2py (feedparser,<code class="literal"> rss)</code> as well as libraries that do not (matplotlib). We also provide a recipe that allows customized logging at the application-level, and an application that can retrieve and display Twitter feeds.</p><p>
<a class="link" href="ch07.html" title="Chapter 7. Web Services">Chapter 7</a>,<em> Web Services. Computers can talk to each other through protocols, such as JSON, JSONRPC, XMLRPC , and SOAP</em>. In this chapter, we provide recipes that allow web2py to both create services based on these protocols and consume services provided by others. In particular, we provide example of integration with Flex, Paypal, Flickr , and GIS.</p><p>
<a class="link" href="ch08.html" title="Chapter 8. Authentication and Authorization">Chapter 8</a>,<em> Authentication and Authorization</em>. web2py has a built-in Auth module that deals with authentication and authorization. In this chapter, we show various ways to customize it, including adding CAPTCHA to registration and login forms, adding Globally Recognized Avatars (gravatars) for representing users, and integrating with services using OAuth 2.0 (for example Facebook). We also show how to utilize the<code class="literal"> teacher/students</code> mode.</p><p>
<a class="link" href="ch09.html" title="Chapter 9. Routing Recipes">Chapter 9</a>,<em> Routing Recipes</em>. This chapter includes recipes for exposing web2py actions using shorten, cleaner, and legacy URLs. For example, adding a prefix to, or omitting the application name from the URLs. We also show advanced uses of the web2py router mechanism to handle special characters in the URL, use the URL to specify a preferred language, and map special files, such as<code class="literal"> favicons.ico</code> and<code class="literal"> robots.txt</code>.</p><p>
<a class="link" href="ch10.html" title="Chapter 10. Reporting Recipes">Chapter 10</a>,<em> Reporting Recipes</em>. There are many ways to create reports in web2py using standard Python libraries, such as<code class="literal"> reportlab</code> or<code class="literal"> latex</code>. Yet for the convenience of the users web2py ships with<code class="literal"> pyfpdf</code>, a library created by<em> Mariano Reingart</em> to convert HTML directly to PDF. This chapter presents recipes to create PDF reports, listings, labels, badges, and invoices using the web2py template system and the<code class="literal"> pyfpdf</code> library.</p><p>
<a class="link" href="ch11.html" title="Chapter 11. Other Tips and Tricks">Chapter 11</a>,<em> Other Tips and Tricks</em>. Here we look at those recipes that did not fit into any other chapter, and yet were considered important by typical web2py users. An example is how to use web2py with Eclipse, a very popular Java IDE that works with Python. Other examples include how to develop applications that are mobile-friendly, and how to develop standalone applications that use a wxPython  GUI.</p></div><div><div><div><div><h1 class="title"><a id="ch00lvl1sec03"/>What you need for this book</h1></div></div></div><p>The only software required is web2py, which is common to all recipes. web2py comes in source version, and binary versions for Mac and Windows. It can be downloaded from<a class="ulink" href="http://web2py.com"> http://web2py.com</a>.</p><p>We do recommend running web2py from source, and in this case, users should also install the most recent Python 2.7 interpreted, which can be downloaded from<a class="ulink" href="http://python.org"> http://python.org</a>.</p><p>When a recipe has additional requirements, it is stated explicitly in the recipe (for example some require Windows, some require IIS, and some require additional Python modules or jQuery plugins).</p></div><div><div><div><div><h1 class="title"><a id="ch00lvl1sec04"/>Who this book is for</h1></div></div></div><p>This book is aimed at Python developers with a basic knowledge of web2py, who want to master this framework.</p></div><div><div><div><div><h1 class="title"><a id="ch00lvl1sec05"/>Conventions</h1></div></div></div><p>In this book, you will find a number of styles of text that distinguish between different kinds of information. Here are some examples of these styles, and an explanation of their meaning.</p><p>Code words in text are shown as follows: "Running web2py with<code class="literal"> Lighttpd."</code>
</p><p>A block of code is set as follows:</p><div><pre class="programlisting">
from gluon.storage import Storage

settings = Storage()

settings.production = False
if settings.production:
	settings.db_uri = 'sqlite://production.sqlite'
	settings.migrate = False
else:
	settings.db_uri = 'sqlite://development.sqlite'
	settings.migrate = True
</pre></div><p>When we wish to draw your attention to a particular part of a code block, the relevant lines or items are set in bold:</p><div><pre class="programlisting">
{{extend 'layout.html'}}
&lt;h2&gt;Companies&lt;/h2&gt;
&lt;table&gt;
	{{for company in companies:}}
<strong>
&lt;tr&gt;
	&lt;td&gt;
		{{=A(company.name, _href=URL('contacts', args=company.id))}} &lt;/td&gt;
	&lt;td&gt;
		{{=A('edit', _href=URL('company_edit', args=company.id))}} &lt;/td&gt;
	&lt;/tr&gt;
		{{pass}}
&lt;tr&gt;</strong>
&lt;td&gt;{{=A('add company', _href=URL('company_create'))}}&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
</pre></div><p>Any command-line input or output is written as follows:</p><div><pre class="programlisting"><strong>python web2py.py -i 127.0.0.1 -p 8000 -a mypassword --nogui</strong>
</pre></div><p>
<strong>Newterms</strong> and<strong> importantwords</strong> are shown in bold. Words that you see on the screen, in menus or dialog boxes for example, appear in the text like this: "Once the site is created, double-click the<strong> URLRewrite</strong> as shown in the following screenshot:".</p><div><h3 class="title"><a id="note01"/>Note</h3><p>Warnings or important notes appear in a box like this.</p></div><div><h3 class="title"><a id="tip01"/>Note</h3><p>Tips and tricks appear like this.</p></div></div><div><div><div><div><h1 class="title"><a id="ch00lvl1sec06"/>Reader feedback</h1></div></div></div><p>Feedback from our readers is always welcome. Let us know what you think about this book&amp;mdash;what you liked or may have disliked. Reader feedback is important for us to develop titles that you really get the most out of.</p><p>To send us general feedback, simply send an e-mail to<a class="email" href="mailto:feedback@packtpub.com">feedback@packtpub.com</a>, and mention the book title via the subject of your message.</p><p>If there is a book that you need and would like to see us publish, please send us a note in the<strong> SUGGEST A TITLE</strong> form on<a class="ulink" href="http://www.packtpub.com"> www.packtpub.com</a> or e-mail<a class="email" href="mailto:suggest@packtpub.com">suggest@packtpub.com</a>.</p><p>If there is a topic that you have expertise in and you are interested in either writing or contributing to a book, see our author guide on<a class="ulink" href="http://www.packtpub.com/authors"> www.packtpub.com/authors</a>.</p></div><div><div><div><div><h1 class="title"><a id="ch00lvl1sec07"/>Customer support</h1></div></div></div><p>Now that you are the proud owner of a Packt book, we have a number of things to help you to get the most from your purchase.</p><div><div><div><div><h2 class="title"><a id="ch00lvl2sec03"/>Downloading the example code</h2></div></div></div><p>You can download the example code files for all Packt books you have purchased from your account at<a class="ulink" href="http://www.PacktPub.com"> http://www.PacktPub.com</a>. If you purchased this book elsewhere, you can visit<a class="ulink" href="http://www.PacktPub.com/support"> http://www.PacktPub.com/support</a>, and register to have the files e-mailed directly to you. The code files are also uploaded at the following repository:<a class="ulink" href="http://https://github.com/mdipierro/web2py-recipes-source"> https://github.com/mdipierro/web2py-recipes-source</a>.</p><p>All the code is released under the BSD license (<a class="ulink" href="http://www.opensource.org/licenses/bsd-license.php">http://www.opensource.org/licenses/bsd-license.php</a>) unless otherwise stated in the source file.</p></div><div><div><div><div><h2 class="title"><a id="ch00lvl2sec04"/>Errata</h2></div></div></div><p>Although we have taken every care to ensure the accuracy of our content, mistakes do happen. If you find a mistake in one of our books&amp;mdash;maybe a mistake in the text or the code&amp;mdash;we would be grateful if you would report this to us. By doing so, you can save other readers from frustration and help us improve subsequent versions of this book. If you find any errata, please report them by visiting<a class="ulink" href="http://www.packtpub.com/support"> http://www.packtpub.com/support</a>, selecting your book, clicking on the<strong> errata submission form</strong> link, and entering the details of your errata. Once your errata are verified, your submission will be accepted and the errata will be uploaded on our website, or added to any list of existing errata, under the Errata section of that title. Any existing errata can be viewed by selecting your title from<a class="ulink" href="http://www.packtpub.com/support"> http://www.packtpub.com/support</a>.</p></div><div><div><div><div><h2 class="title"><a id="ch00lvl2sec05"/>Piracy</h2></div></div></div><p>Piracy of copyright material on the Internet is an ongoing problem across all media. At Packt, we take the protection of our copyright and licenses very seriously. If you come across any illegal copies of our works, in any form, on the Internet, please provide us with the location address or website name immediately so that we can pursue a remedy.</p><p>Please contact us at<a class="email" href="mailto:copyright@packtpub.com">copyright@packtpub.com</a> with a link to the suspected pirated material.</p><p>We appreciate your help in protecting our authors, and our ability to bring you valuable content.</p></div><div><div><div><div><h2 class="title"><a id="ch00lvl2sec06"/>Questions</h2></div></div></div><p>You can contact us at<a class="email" href="mailto:questions@packtpub.com">questions@packtpub.com</a> if you are having a problem with any aspect of the book, and we will do our best to address it.</p></div></div></div></div>
</body></html>