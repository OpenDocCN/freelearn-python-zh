<html><head></head><body>
<div id="_idContainer325">
<h1 class="chapter-number" id="_idParaDest-239"><a id="_idTextAnchor243"/><span class="koboSpan" id="kobo.1.1">10</span></h1>
<h1 id="_idParaDest-240"><a id="_idTextAnchor244"/><span class="koboSpan" id="kobo.2.1">More Full Stack Frameworks – Django and Pyramid</span></h1>
<p><span class="koboSpan" id="kobo.3.1">The web frameworks we’ve covered so far were exemplary in the way they work. </span><span class="koboSpan" id="kobo.3.2">Flask is an unopinionated micro-framework. </span><span class="koboSpan" id="kobo.3.3">By this we mean Flask only handles endpoint routing and optionally, serving templated page content. </span><span class="koboSpan" id="kobo.3.4">FastAPI features a framework specifically for building RESTful APIs rather than serving content beyond data. </span><span class="koboSpan" id="kobo.3.5">It also features an asynchronous programming model reminiscent of modern JavaScript frameworks running </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">in NodeJS.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">There are two more frameworks you’ll find on the </span><strong class="bold"><span class="koboSpan" id="kobo.6.1">New Project</span></strong><span class="koboSpan" id="kobo.7.1"> menu in PyCharm Professional, and we’re going to cover them here. </span><strong class="bold"><span class="koboSpan" id="kobo.8.1">Django</span></strong><span class="koboSpan" id="kobo.9.1"> is a very popular framework that is, philosophically speaking, the diametric opposite of Flask. </span><span class="koboSpan" id="kobo.9.2">Django is a highly opinionated framework that attempts to make all your platform and framework choices </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">for you.</span></span></p>
<p><span class="koboSpan" id="kobo.11.1">The final framework we’ll talk about is </span><strong class="bold"><span class="koboSpan" id="kobo.12.1">Pyramid</span></strong><span class="koboSpan" id="kobo.13.1">. </span><span class="koboSpan" id="kobo.13.2">Pyramid aims for the middle ground between Flask and Django offering more bundled features than Flask, but more flexibility </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">than Django.</span></span></p>
<p><span class="koboSpan" id="kobo.15.1">In this chapter, you will learn </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.17.1">How to generate a Django project using PyCharm Professional’s new </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">project template</span></span></li>
<li><span class="koboSpan" id="kobo.19.1">How to identify the major files and folders present in the templated project generated </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">by PyCharm</span></span></li>
<li><span class="koboSpan" id="kobo.21.1">How to use Django-specific tooling in PyCharm for </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.22.1">manage.py</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.23.1"> tasks</span></span></li>
<li><span class="koboSpan" id="kobo.24.1">How to create a Pyramid project in </span><span class="No-Break"><span class="koboSpan" id="kobo.25.1">PyCharm Professional</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.26.1">We’ve already covered a lot of theory on how web applications work in earlier chapters, so let’s get straight into developing these two frameworks using PyCharm. </span><span class="koboSpan" id="kobo.26.2">As with other web development frameworks, these features are only available in the Professional edition </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">of PyCharm.</span></span></p>
<h1 id="_idParaDest-241"><a id="_idTextAnchor245"/><span class="koboSpan" id="kobo.28.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.29.1">In order to proceed through this chapter, and indeed the rest of the book, you will need </span><span class="No-Break"><span class="koboSpan" id="kobo.30.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.31.1">An installed and working Python interpreter. </span><span class="koboSpan" id="kobo.31.2">I’ll be using the latest </span><span class="No-Break"><span class="koboSpan" id="kobo.32.1">from </span></span><a href="https://python.org"><span class="No-Break"><span class="koboSpan" id="kobo.33.1">https://python.org</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.34.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.35.1">Installed copies of </span><strong class="source-inline"><span class="koboSpan" id="kobo.36.1">pip</span></strong><span class="koboSpan" id="kobo.37.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.38.1">virtualenv</span></strong><span class="koboSpan" id="kobo.39.1">. </span><span class="koboSpan" id="kobo.39.2">You get these automatically when you install Python on Windows, and macOS has them included on every system. </span><span class="koboSpan" id="kobo.39.3">If you are using Linux, you need to install the package managers such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.40.1">pip</span></strong><span class="koboSpan" id="kobo.41.1"> and virtual environment tools such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.42.1">virtualenv</span></strong><span class="koboSpan" id="kobo.43.1"> separately. </span><span class="koboSpan" id="kobo.43.2">Our examples will use </span><strong class="source-inline"><span class="koboSpan" id="kobo.44.1">pip</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.45.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.46.1">virtualenv</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.48.1">An installed and working copy of PyCharm. </span><span class="koboSpan" id="kobo.48.2">Installation was covered in </span><a href="B19644_02.xhtml#_idTextAnchor028"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.49.1">Chapter 2</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.50.1">, Installation and Configuration</span></em><span class="koboSpan" id="kobo.51.1">, in case you are jumping into the middle of the book. </span><span class="koboSpan" id="kobo.51.2">I am using build PyCharm Professional 2023.1 (build #PY-231.8109.197) with the new UI </span><span class="No-Break"><span class="koboSpan" id="kobo.52.1">turned on.</span></span></li>
<li><span class="koboSpan" id="kobo.53.1">This book’s sample source code from GitHub. </span><span class="koboSpan" id="kobo.53.2">We covered cloning the code in </span><a href="B19644_02.xhtml#_idTextAnchor028"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.54.1">Chapter 2</span></em></span></a><em class="italic"><span class="koboSpan" id="kobo.55.1">, Installation and Configuration</span></em><span class="koboSpan" id="kobo.56.1">. </span><span class="koboSpan" id="kobo.56.2">You’ll find this chapter’s relevant code </span><span class="No-Break"><span class="koboSpan" id="kobo.57.1">at </span></span><a href="https://github.com/PacktPublishing/Hands-On-Application-Development-with-PyCharm---Second-Edition/tree/main/chapter-10"><span class="No-Break"><span class="koboSpan" id="kobo.58.1">https://github.com/PacktPublishing/Hands-On-Application-Development-with-PyCharm---Second-Edition/tree/main/chapter-10</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.59.1">.</span></span></li>
</ul>
<h1 id="_idParaDest-242"><a id="_idTextAnchor246"/><span class="koboSpan" id="kobo.60.1">What’s all this fuss about Django?</span></h1>
<p><span class="koboSpan" id="kobo.61.1">If you ask most Python developers which framework they prefer, I’ll wager it is an even split between Flask and Django. </span><span class="koboSpan" id="kobo.61.2">I’ll also </span><a id="_idIndexMarker827"/><span class="koboSpan" id="kobo.62.1">wager that the Django crowd are raving fans of Django while Flask seems more like a thing you use to get stuff done. </span><span class="koboSpan" id="kobo.62.2">It’s like getting excited about a screwdriver. </span><span class="koboSpan" id="kobo.62.3">Django is a lot more opinionated, and as such, a lot more “in your face." </span><span class="koboSpan" id="kobo.62.4">You barely notice Flask because it’s just a piece of the puzzle. </span><span class="koboSpan" id="kobo.62.5">Django is all the pieces in one box, plus that glue you use to make puzzles into a picture, plus an expensive frame for the completed glued puzzle, plus a beach house so you have a place to hang your puzzle. </span><span class="koboSpan" id="kobo.62.6">There might even be little mints on the pillows in the beach house, but I make </span><span class="No-Break"><span class="koboSpan" id="kobo.63.1">no promises.</span></span></p>
<p><span class="koboSpan" id="kobo.64.1">Django, on the other hand, promises to be a web framework that handles the heavy lifting and repetitive aspects of web application development. </span><span class="koboSpan" id="kobo.64.2">Web developers are freed up to focus on the specific logic of their applications. </span><span class="koboSpan" id="kobo.64.3">Web frameworks usually implement common design patterns and good practices into their structure, so that a web application developed with a</span><a id="_idIndexMarker828"/><span class="koboSpan" id="kobo.65.1"> framework will be up to common standards by default, without its developer having to manually integrate those standards into </span><span class="No-Break"><span class="koboSpan" id="kobo.66.1">the application.</span></span></p>
<p><span class="koboSpan" id="kobo.67.1">Django aims to have everything you need to develop a web application baked into the framework. </span><span class="koboSpan" id="kobo.67.2">Since that is true, you shouldn’t have to think about your stack at all. </span><span class="koboSpan" id="kobo.67.3">Django becomes more than a framework; it becomes an ethos. </span><span class="koboSpan" id="kobo.67.4">You become a fan of Django’s way. </span><span class="koboSpan" id="kobo.67.5">You might even say </span><em class="italic"><span class="koboSpan" id="kobo.68.1">“This is the way,”</span></em><span class="koboSpan" id="kobo.69.1"> and Django might say it back. </span><span class="koboSpan" id="kobo.69.2">Here are some things Django is </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">good at:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.71.1">Speed</span></strong><span class="koboSpan" id="kobo.72.1">: Similar to Python itself, Django emphasizes the ease of developing and translating ideas into actual </span><a id="_idIndexMarker829"/><span class="koboSpan" id="kobo.73.1">code. </span><span class="koboSpan" id="kobo.73.2">With straightforward yet extensive APIs, Django aims to accommodate a wide range of web applications </span><span class="No-Break"><span class="koboSpan" id="kobo.74.1">and features.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.75.1">Security</span></strong><span class="koboSpan" id="kobo.76.1">: Web development is one of the topics in programming in which security is the highest priority. </span><span class="koboSpan" id="kobo.76.2">The Django framework offers features that navigate web developers, beginners, and experts alike, away from security flaws in </span><span class="No-Break"><span class="koboSpan" id="kobo.77.1">their applications.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.78.1">Scalability</span></strong><span class="koboSpan" id="kobo.79.1">: When a website gains more clients, scalability becomes more and more important. </span><span class="koboSpan" id="kobo.79.2">Scalability in Django can be achieved in flexible and intuitive ways; in fact, some of the largest sites on the internet (Bitbucket, Instagram, Pinterest, and so on) are built with Django for </span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">that reason.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.81.1">None of these are specifically addressed by Flask. </span><span class="koboSpan" id="kobo.81.2">In fact, Flask is not normally used for large web applications because it is relatively slow. </span><span class="koboSpan" id="kobo.81.3">Personally, I’ve moved all my product backend code away from Flask and into FastAPI because the performance is </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">noticeably better.</span></span></p>
<p><span class="koboSpan" id="kobo.83.1">So far, Django sounds much better than anything else we’ve talked about so far. </span><span class="koboSpan" id="kobo.83.2">Despite being a popular and powerful web framework, Django, like any technology, has its detractors. </span><span class="koboSpan" id="kobo.83.3">Some of the common criticisms and concerns raised about Django include </span><span class="No-Break"><span class="koboSpan" id="kobo.84.1">the following:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.85.1">Steep learning curve</span></strong><span class="koboSpan" id="kobo.86.1">: Some developers </span><a id="_idIndexMarker830"/><span class="koboSpan" id="kobo.87.1">find Django’s learning curve to be relatively steep, especially for beginners with limited experience in Python or web development. </span><span class="koboSpan" id="kobo.87.2">Its extensive</span><a id="_idIndexMarker831"/><span class="koboSpan" id="kobo.88.1"> feature set and comprehensive nature can be overwhelming </span><span class="No-Break"><span class="koboSpan" id="kobo.89.1">for newcomers.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.90.1">Magic and abstraction</span></strong><span class="koboSpan" id="kobo.91.1">: Django’s emphasis on “batteries included” and abstraction can be a double-edged sword. </span><span class="koboSpan" id="kobo.91.2">While it saves development time, some developers argue that it can obscure the underlying mechanisms, making it harder to understand and troubleshoot </span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">complex issues.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.93.1">Overhead for small projects</span></strong><span class="koboSpan" id="kobo.94.1">: For small projects or simple websites, some developers feel that Django’s feature richness and structure can be overkill, adding unnecessary overhead </span><span class="No-Break"><span class="koboSpan" id="kobo.95.1">and complexity.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.96.1">Monolithic nature</span></strong><span class="koboSpan" id="kobo.97.1">: Critics argue that Django is a monolithic framework, and it may not be the best fit for microservices architectures or highly specialized applications where a lightweight framework might be </span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">more suitable.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.99.1">Flexibility versus opinionated</span></strong><span class="koboSpan" id="kobo.100.1">: Django follows a particular design philosophy and enforces certain patterns, which some developers see as overly opinionated. </span><span class="koboSpan" id="kobo.100.2">This can lead to debates over the “Django way” of doing things versus </span><span class="No-Break"><span class="koboSpan" id="kobo.101.1">alternative approaches.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.102.1">Performance</span></strong><span class="koboSpan" id="kobo.103.1">: Although Django is reasonably performant, some developers claim that it may not be as fast as certain micro-frameworks or specialized tools. </span><span class="koboSpan" id="kobo.103.2">Performance-critical projects may require additional </span><span class="No-Break"><span class="koboSpan" id="kobo.104.1">optimization efforts.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.105.1">ORM limitations</span></strong><span class="koboSpan" id="kobo.106.1">: While Django’s ORM is powerful and easy to use, it may not cover all edge cases or offer the same level of control as writing raw SQL queries. </span><span class="koboSpan" id="kobo.106.2">In certain scenarios, developers may prefer using other ORMs or </span><span class="No-Break"><span class="koboSpan" id="kobo.107.1">query builders.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.108.1">Version upgrades</span></strong><span class="koboSpan" id="kobo.109.1">: Upgrading between major versions of Django can sometimes be challenging, especially for older projects heavily reliant on deprecated features. </span><span class="koboSpan" id="kobo.109.2">This can lead to maintenance issues and additional </span><span class="No-Break"><span class="koboSpan" id="kobo.110.1">development efforts.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.111.1">Customization complexity</span></strong><span class="koboSpan" id="kobo.112.1">: While </span><a id="_idIndexMarker832"/><span class="koboSpan" id="kobo.113.1">Django offers flexibility, some developers find it challenging to customize certain built-in components, such as the admin interface, to fit specific </span><span class="No-Break"><span class="koboSpan" id="kobo.114.1">design requirements.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.115.1">Community and ecosystem</span></strong><span class="koboSpan" id="kobo.116.1">: Although Django has a large and active community, it may not have as extensive an ecosystem or as many third-party packages available as some other </span><span class="No-Break"><span class="koboSpan" id="kobo.117.1">web frameworks.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.118.1">It’s important to note that while</span><a id="_idIndexMarker833"/><span class="koboSpan" id="kobo.119.1"> these criticisms exist, Django has an extensive user base, and many developers appreciate its productivity, stability, and comprehensive feature set. </span><span class="koboSpan" id="kobo.119.2">Ultimately, the choice of a web framework depends on the specific needs and preferences of the project and </span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">development team.</span></span></p>
<h2 id="_idParaDest-243"><a id="_idTextAnchor247"/><span class="koboSpan" id="kobo.121.1">Django framework components</span></h2>
<p><span class="koboSpan" id="kobo.122.1">Django includes an inclusive set of components that</span><a id="_idIndexMarker834"/><span class="koboSpan" id="kobo.123.1"> make it a comprehensive and feature-rich framework for web development. </span><span class="koboSpan" id="kobo.123.2">Here are some of the </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">key components:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.125.1">URL dispatching (routing)</span></strong><span class="koboSpan" id="kobo.126.1">: Django uses a URL dispatcher to route incoming HTTP requests to the appropriate view functions or class-based views. </span><span class="koboSpan" id="kobo.126.2">This enables clean and logical URL patterns for your </span><span class="No-Break"><span class="koboSpan" id="kobo.127.1">web application.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.128.1">View functions and class-based views</span></strong><span class="koboSpan" id="kobo.129.1">: Views in Django are responsible for processing user requests and returning HTTP responses. </span><span class="koboSpan" id="kobo.129.2">You can use simple functions as views or use Django’s class-based views for more organized and </span><span class="No-Break"><span class="koboSpan" id="kobo.130.1">reusable code.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.131.1">Templates</span></strong><span class="koboSpan" id="kobo.132.1">: Django’s template system allows you to define the structure and layout of your web pages using HTML templates with placeholders for dynamic content. </span><span class="koboSpan" id="kobo.132.2">This separation of concerns (logic and presentation) makes it easier to maintain and scale your </span><span class="No-Break"><span class="koboSpan" id="kobo.133.1">web application.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.134.1">Model-View-Template (MVT) architecture</span></strong><span class="koboSpan" id="kobo.135.1">: Similar to the </span><strong class="bold"><span class="koboSpan" id="kobo.136.1">Model-View-Controller</span></strong><span class="koboSpan" id="kobo.137.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.138.1">MVC</span></strong><span class="koboSpan" id="kobo.139.1">) pattern, Django follows the MVT </span><a id="_idIndexMarker835"/><span class="koboSpan" id="kobo.140.1">pattern. </span><span class="koboSpan" id="kobo.140.2">Models represent the data structures and the database schema, views handle the logic and processing, and templates take care of rendering </span><span class="No-Break"><span class="koboSpan" id="kobo.141.1">the output.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.142.1">Object-Relational Mapping (ORM)</span></strong><span class="koboSpan" id="kobo.143.1">: Django’s ORM is one of its defining features. </span><span class="koboSpan" id="kobo.143.2">It provides a high-level, Pythonic way to interact with databases without having to write raw SQL</span><a id="_idIndexMarker836"/><span class="koboSpan" id="kobo.144.1"> queries. </span><span class="koboSpan" id="kobo.144.2">It allows you to define models as Python classes, and the ORM handles the mapping of these models to the </span><span class="No-Break"><span class="koboSpan" id="kobo.145.1">database tables.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.146.1">Forms</span></strong><span class="koboSpan" id="kobo.147.1">: Django includes a form-handling system that simplifies form creation, data validation, and handling user input. </span><span class="koboSpan" id="kobo.147.2">It helps in processing HTML forms and converting user-submitted data into Python </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">data types.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.149.1">Admin interface</span></strong><span class="koboSpan" id="kobo.150.1">: Django’s admin interface is an automatic admin interface that can be used to manage your application’s data models. </span><span class="koboSpan" id="kobo.150.2">It provides an out-of-the-box solution for managing model data and is customizable to fit your </span><span class="No-Break"><span class="koboSpan" id="kobo.151.1">specific needs.</span></span></li>
<li> <strong class="bold"><span class="koboSpan" id="kobo.152.1">Middleware</span></strong><span class="koboSpan" id="kobo.153.1">: Middleware components in Django are hooks that allow you to process requests and responses globally before they reach the view or after they leave the view. </span><span class="koboSpan" id="kobo.153.2">It enables features including authentication, security checks, and </span><span class="No-Break"><span class="koboSpan" id="kobo.154.1">request/response modification.</span></span></li>
<li> <strong class="bold"><span class="koboSpan" id="kobo.155.1">Static files</span></strong><span class="koboSpan" id="kobo.156.1">: Django has built-in support for managing static files such as CSS, JavaScript, and images. </span><span class="koboSpan" id="kobo.156.2">It simplifies the process of serving static content during development </span><span class="No-Break"><span class="koboSpan" id="kobo.157.1">and deployment.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.158.1">Authentication and authorization</span></strong><span class="koboSpan" id="kobo.159.1">: Django provides a robust authentication system for managing user accounts, permissions, and groups. </span><span class="koboSpan" id="kobo.159.2">It makes it easy to add user registration, login, and password management functionalities to </span><span class="No-Break"><span class="koboSpan" id="kobo.160.1">your application.</span></span></li>
<li><span class="koboSpan" id="kobo.161.1">I</span><strong class="bold"><span class="koboSpan" id="kobo.162.1">nternationalization and localization</span></strong><span class="koboSpan" id="kobo.163.1">: Django supports internationalization and localization, allowing you to create applications that can be translated into multiple languages and adapted to </span><span class="No-Break"><span class="koboSpan" id="kobo.164.1">various regions.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.165.1">Testing framework</span></strong><span class="koboSpan" id="kobo.166.1">: Django comes with a testing framework that facilitates unit testing and integration testing </span><a id="_idIndexMarker837"/><span class="koboSpan" id="kobo.167.1">of your application. </span><span class="koboSpan" id="kobo.167.2">You can write test cases to ensure that your code works as expected and </span><span class="No-Break"><span class="koboSpan" id="kobo.168.1">avoid regressions.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.169.1">With all that overhead, it’s a good thing we have such a capable tool in PyCharm. </span><span class="koboSpan" id="kobo.169.2">Let’s dive into creating a </span><span class="No-Break"><span class="koboSpan" id="kobo.170.1">Django application.</span></span></p>
<h1 id="_idParaDest-244"><a id="_idTextAnchor248"/><span class="koboSpan" id="kobo.171.1">Creating a Django project</span></h1>
<p><span class="koboSpan" id="kobo.172.1">The process is no different than</span><a id="_idIndexMarker838"/><span class="koboSpan" id="kobo.173.1"> most other projects. </span><span class="koboSpan" id="kobo.173.2">Click </span><strong class="bold"><span class="koboSpan" id="kobo.174.1">File | New Project</span></strong><span class="koboSpan" id="kobo.175.1"> then click the </span><strong class="bold"><span class="koboSpan" id="kobo.176.1">Django</span></strong><span class="koboSpan" id="kobo.177.1"> option as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.178.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.179.1">.1</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer302">
<span class="koboSpan" id="kobo.181.1"><img alt="Figure 10.1: Creating a new Django project is much like any other project" src="image/B19644_10_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.182.1">Figure 10.1: Creating a new Django project is much like any other project</span></p>
<p><span class="koboSpan" id="kobo.183.1">Be sure to twirl down the </span><strong class="bold"><span class="koboSpan" id="kobo.184.1">More Settings</span></strong><span class="koboSpan" id="kobo.185.1"> section. </span><span class="koboSpan" id="kobo.185.2">Here you can set the template language. </span><span class="koboSpan" id="kobo.185.3">You can use</span><a id="_idIndexMarker839"/><span class="koboSpan" id="kobo.186.1"> either the </span><strong class="bold"><span class="koboSpan" id="kobo.187.1">Django templating language</span></strong><span class="koboSpan" id="kobo.188.1"> or </span><strong class="bold"><span class="koboSpan" id="kobo.189.1">Jinja2</span></strong><span class="koboSpan" id="kobo.190.1">, which was what we used in </span><a href="B19644_09.xhtml#_idTextAnchor223"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.191.1">Chapter 9</span></em></span></a><span class="koboSpan" id="kobo.192.1">, </span><em class="italic"><span class="koboSpan" id="kobo.193.1">Building a Dynamic Web Application with Flask</span></em><span class="koboSpan" id="kobo.194.1">. </span><span class="koboSpan" id="kobo.194.2">Since we covered Jinja2 already, let’s</span><a id="_idIndexMarker840"/><span class="koboSpan" id="kobo.195.1"> stick with Django. </span><span class="koboSpan" id="kobo.195.2">You can set the name of the folder you’ll use for templates, and you absolutely should set a value for the </span><strong class="bold"><span class="koboSpan" id="kobo.196.1">Application name</span></strong><span class="koboSpan" id="kobo.197.1"> field as shown at the bottom of </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.198.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.199.1">.1</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.200.1">.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.201.1">Don’t skip the application name</span></p>
<p class="callout"><span class="koboSpan" id="kobo.202.1">If you skip the </span><strong class="bold"><span class="koboSpan" id="kobo.203.1">Application name</span></strong><span class="koboSpan" id="kobo.204.1"> setting at the bottom of </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.205.1">Figure 10</span></em></span><em class="italic"><span class="koboSpan" id="kobo.206.1">.1</span></em><span class="koboSpan" id="kobo.207.1">, PyCharm will assume you want a Django project without any applications. </span><span class="koboSpan" id="kobo.207.2">Of course, you can add additional applications later using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.208.1">manage.py</span></strong><span class="koboSpan" id="kobo.209.1"> tooling we’ll cover later, but that’s probably not what you want most of the time when you are creating a new project. </span><span class="koboSpan" id="kobo.209.2">Furthermore, you should not name the application the same as the PyCharm project as it can cause confusion in PyCharm’s indexing, not to mention for the humans working on </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">the project.</span></span></p>
<p><span class="koboSpan" id="kobo.211.1">Django projects often have multiple applications within them, and the </span><strong class="bold"><span class="koboSpan" id="kobo.212.1">Application name</span></strong><span class="koboSpan" id="kobo.213.1"> setting here is used to create and name the first application within the project. </span><span class="koboSpan" id="kobo.213.2">We’re going to be building a single library </span><a id="_idIndexMarker841"/><span class="koboSpan" id="kobo.214.1">application in our project. </span><span class="koboSpan" id="kobo.214.2">Since the term </span><em class="italic"><span class="koboSpan" id="kobo.215.1">library</span></em><span class="koboSpan" id="kobo.216.1"> is ambiguous in a programming book, I’ll clarify the name of the application so we understand the </span><em class="italic"><span class="koboSpan" id="kobo.217.1">library</span></em><span class="koboSpan" id="kobo.218.1"> is a place that serves books rather than a </span><span class="No-Break"><span class="koboSpan" id="kobo.219.1">programming library.</span></span></p>
<p><span class="koboSpan" id="kobo.220.1">The resulting newly created project is shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.221.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.222.1">.2</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.223.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer303">
<span class="koboSpan" id="kobo.224.1"><img alt="Figure 10.2: The Django project has been created and PyCharm opens the urls.py and settings.py files as a starting point" src="image/B19644_10_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.225.1">Figure 10.2: The Django project has been created and PyCharm opens the urls.py and settings.py files as a starting point</span></p>
<p><span class="koboSpan" id="kobo.226.1">Given the super long list of components, it is a little surprising how few files were created. </span><span class="koboSpan" id="kobo.226.2">PyCharm has automatically opened two as a starting point: </span><strong class="source-inline"><span class="koboSpan" id="kobo.227.1">urls.py</span></strong><span class="koboSpan" id="kobo.228.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.229.1">settings.py</span></strong><span class="koboSpan" id="kobo.230.1">. </span><span class="koboSpan" id="kobo.230.2">Let’s take a look at what these and the rest of the files and folders are for in our newly </span><span class="No-Break"><span class="koboSpan" id="kobo.231.1">created application.</span></span></p>
<h1 id="_idParaDest-245"><a id="_idTextAnchor249"/><span class="koboSpan" id="kobo.232.1">Structure of a Django project</span></h1>
<p><span class="koboSpan" id="kobo.233.1">The first thing you might notice is the project, which I just called </span><strong class="source-inline"><span class="koboSpan" id="kobo.234.1">djangoProject</span></strong><span class="koboSpan" id="kobo.235.1">, has its own set of files distinct from the </span><a id="_idIndexMarker842"/><span class="koboSpan" id="kobo.236.1">application, which is in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.237.1">TheGreatBookery</span></strong><span class="koboSpan" id="kobo.238.1"> folder. </span><span class="koboSpan" id="kobo.238.2">All of the files inside of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.239.1">djangoProject</span></strong><span class="koboSpan" id="kobo.240.1"> folder are used in the deployment of your application to production, as well as to run the built-in </span><span class="No-Break"><span class="koboSpan" id="kobo.241.1">development server.</span></span></p>
<p><span class="koboSpan" id="kobo.242.1">Inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.243.1">TheGreatBookery</span></strong><span class="koboSpan" id="kobo.244.1"> folder, we have a folder for database migrations. </span><span class="koboSpan" id="kobo.244.2">This is common for applications that use ORMs. </span><span class="koboSpan" id="kobo.244.3">You need a way to make changes to the production database as you roll new releases into production. </span><span class="koboSpan" id="kobo.244.4">You can’t simply drop the database and rebuild it since that would erase all your application’s data. </span><span class="koboSpan" id="kobo.244.5">There needs to be a system to migrate schema changes to the existing database while maintaining your existing production data. </span><span class="koboSpan" id="kobo.244.6">Django’s system for migrations utilizes migration scripts stored in </span><span class="No-Break"><span class="koboSpan" id="kobo.245.1">this folder.</span></span></p>
<p><span class="koboSpan" id="kobo.246.1">The templates folder, which is technically outside the application’s folder, is where we keep our </span><span class="No-Break"><span class="koboSpan" id="kobo.247.1">HTML templates.</span></span></p>
<p><span class="koboSpan" id="kobo.248.1">You might be able to guess the functions of the remaining files by </span><span class="No-Break"><span class="koboSpan" id="kobo.249.1">their names:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.250.1">admin.py</span></strong><span class="koboSpan" id="kobo.251.1"> is used to register modules, data models, and perhaps most obviously from the name, to control the admin </span><span class="No-Break"><span class="koboSpan" id="kobo.252.1">user interface.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.253.1">apps.py</span></strong><span class="koboSpan" id="kobo.254.1"> provides a central place to customize and configure the behavior of your application within the Django project. </span><span class="koboSpan" id="kobo.254.2">It allows you to specify various settings and metadata for your application, such as the human-readable name, default app configuration, </span><span class="No-Break"><span class="koboSpan" id="kobo.255.1">and signals.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.256.1">models.py</span></strong><span class="koboSpan" id="kobo.257.1"> will contain your data model, which is affected by </span><span class="No-Break"><span class="koboSpan" id="kobo.258.1">the ORM.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.259.1">tests.py</span></strong><span class="koboSpan" id="kobo.260.1"> will house your application’s unit tests, which run using Django’s own </span><span class="No-Break"><span class="koboSpan" id="kobo.261.1">testing framework.</span></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.262.1">views.py</span></strong><span class="koboSpan" id="kobo.263.1"> will contain view functions. </span><span class="koboSpan" id="kobo.263.2">These are Python functions that take an HTTP request as an argument and return an HTTP response. </span><span class="koboSpan" id="kobo.263.3">Within these functions, you can handle the request, process data from the models or other sources, and generate an appropriate HTTP response, often by rendering a template with </span><span class="No-Break"><span class="koboSpan" id="kobo.264.1">dynamic data.</span></span></li>
</ul>
<h2 id="_idParaDest-246"><a id="_idTextAnchor250"/><span class="koboSpan" id="kobo.265.1">Initial configuration</span></h2>
<p><span class="koboSpan" id="kobo.266.1">While this is not a book on Django, I would be remiss if I didn’t point out a few things in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.267.1">settings.py</span></strong><span class="koboSpan" id="kobo.268.1"> file. </span><span class="koboSpan" id="kobo.268.2">Like Flask, Django has a built-in development web server that is not designed to be used in production. </span><span class="koboSpan" id="kobo.268.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.269.1">settings.py</span></strong><span class="koboSpan" id="kobo.270.1"> file has some dangerous settings in it as hardcoded values</span><a id="_idIndexMarker843"/><span class="koboSpan" id="kobo.271.1"> that are appropriate for local development only. </span><span class="koboSpan" id="kobo.271.2">Open up </span><strong class="source-inline"><span class="koboSpan" id="kobo.272.1">settings.py</span></strong><span class="koboSpan" id="kobo.273.1"> and locate </span><span class="No-Break"><span class="koboSpan" id="kobo.274.1">these lines:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.275.1">
# SECURITY WARNING: keep the secret key used in production secret!
</span><span class="koboSpan" id="kobo.275.2">SECRET_KEY = 'django-insecure-39u&amp;w+cgs2t4*jwe3nuz4y4j^s!s65^xb7eqtb_a3bl!a_s%tn'
# SECURITY WARNING: don't run with debug turned on in production!
</span><span class="koboSpan" id="kobo.275.3">DEBUG = True</span></pre> <p><span class="koboSpan" id="kobo.276.1">Something you should do early is make sure to draw these values from outside your code. </span><span class="koboSpan" id="kobo.276.2">You should never hardcode a secret in your application code, and you should never commit secrets to a revision control system! </span><span class="koboSpan" id="kobo.276.3">You can externalize these values using environment variables, </span><strong class="source-inline"><span class="koboSpan" id="kobo.277.1">.ini</span></strong><span class="koboSpan" id="kobo.278.1"> files, or </span><strong class="source-inline"><span class="koboSpan" id="kobo.279.1">.env</span></strong><span class="koboSpan" id="kobo.280.1"> files using libraries from </span><strong class="source-inline"><span class="koboSpan" id="kobo.281.1">PyPi.org</span></strong><span class="koboSpan" id="kobo.282.1">. </span><span class="koboSpan" id="kobo.282.2">Leaving the </span><strong class="source-inline"><span class="koboSpan" id="kobo.283.1">DEBUG</span></strong><span class="koboSpan" id="kobo.284.1"> setting hardcoded can be dangerous because errors thrown may be plainly visible along with the stack trace and other details that bad actors might be able </span><span class="No-Break"><span class="koboSpan" id="kobo.285.1">to exploit.</span></span></p>
<p><span class="koboSpan" id="kobo.286.1">Another setting you might want to review is the database engine. </span><span class="koboSpan" id="kobo.286.2">You’ll find these lines toward the bottom </span><span class="No-Break"><span class="koboSpan" id="kobo.287.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.288.1">settings.py</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.289.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.290.1">
# Database
# https://docs.djangoproject.com/en/4.2/ref/settings/#databases
DATABASES = {
  'default': {
    'ENGINE': 'django.db.backends.sqlite3',
    'NAME': BASE_DIR / 'db.sqlite3',
  }
}</span></pre> <p><span class="koboSpan" id="kobo.291.1">PyCharm has defaulted us to SQLite3, which is not really suitable for a production application. </span><span class="koboSpan" id="kobo.291.2">SQLite3 is a file-based database, and using it for local development is advantageous because it doesn’t require the installation of a server. </span><span class="koboSpan" id="kobo.291.3">You shouldn’t serve a production app with SQLite3, and in my opinion, you should develop using the same database you’ll use </span><span class="No-Break"><span class="koboSpan" id="kobo.292.1">in production.</span></span></p>
<p><span class="koboSpan" id="kobo.293.1">That said, we won’t be taking this app to production so I’m going to leave the settings as they are. </span><span class="koboSpan" id="kobo.293.2">Your database will appear in the project directory as a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.294.1">db.sqlite3</span></strong><span class="koboSpan" id="kobo.295.1">. </span><span class="koboSpan" id="kobo.295.2">We will learn about PyCharm’s database capabilities in </span><a href="B19644_11.xhtml#_idTextAnchor266"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.296.1">Chapter 11</span></em></span></a><span class="koboSpan" id="kobo.297.1">. </span><span class="koboSpan" id="kobo.297.2">Know that PyCharm has a rich set of tools for viewing and working with databases, including SQLite3, which can</span><a id="_idIndexMarker844"/><span class="koboSpan" id="kobo.298.1"> help </span><span class="No-Break"><span class="koboSpan" id="kobo.299.1">during development.</span></span></p>
<h2 id="_idParaDest-247"><a id="_idTextAnchor251"/><span class="koboSpan" id="kobo.300.1">Running the Django project</span></h2>
<p><span class="koboSpan" id="kobo.301.1">When we created the project, PyCharm created a run configuration for us. </span><span class="koboSpan" id="kobo.301.2">We covered run configurations</span><a id="_idIndexMarker845"/><span class="koboSpan" id="kobo.302.1"> extensively in </span><a href="B19644_06.xhtml#_idTextAnchor145"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.303.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.304.1">. </span><span class="koboSpan" id="kobo.304.2">We simply want to run the one PyCharm generated, so simply click the green </span><strong class="bold"><span class="koboSpan" id="kobo.305.1">Run</span></strong><span class="koboSpan" id="kobo.306.1"> button shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.307.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.308.1">.3</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.309.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer304">
<span class="koboSpan" id="kobo.310.1"><img alt="Figure 10.3: The Run button will start the development server" src="image/B19644_10_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.311.1">Figure 10.3: The Run button will start the development server</span></p>
<p><span class="koboSpan" id="kobo.312.1">Running the project will open the </span><strong class="bold"><span class="koboSpan" id="kobo.313.1">Run</span></strong><span class="koboSpan" id="kobo.314.1"> panel at the bottom of the IDE window, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.315.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.316.1">.4</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.317.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer305">
<span class="koboSpan" id="kobo.318.1"><img alt="Figure 10.4: Our project is running and being served on localhost port 8000" src="image/B19644_10_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.319.1">Figure 10.4: Our project is running and being served on localhost port 8000</span></p>
<p><span class="koboSpan" id="kobo.320.1">We can see our project is </span><a id="_idIndexMarker846"/><span class="koboSpan" id="kobo.321.1">running on port </span><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">8000</span></strong><span class="koboSpan" id="kobo.323.1">, and there’s a handy link that will open our default browser to the running app, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.324.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.325.1">.5</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer306">
<span class="koboSpan" id="kobo.327.1"><img alt="Figure 10.5: Clicking the link opens the browser and displays a nice message letting you know everything is working" src="image/B19644_10_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.328.1">Figure 10.5: Clicking the link opens the browser and displays a nice message letting you know everything is working</span></p>
<p><span class="koboSpan" id="kobo.329.1">PyCharm has effectively created a minimal working application for us. </span><span class="koboSpan" id="kobo.329.2">In a real projects, this is usually where I address deployment via </span><strong class="bold"><span class="koboSpan" id="kobo.330.1">continuous integration</span></strong><span class="koboSpan" id="kobo.331.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.332.1">CI</span></strong><span class="koboSpan" id="kobo.333.1">) and </span><strong class="bold"><span class="koboSpan" id="kobo.334.1">continuous delivery </span></strong><span class="koboSpan" id="kobo.335.1">(</span><strong class="bold"><span class="koboSpan" id="kobo.336.1">CD</span></strong><span class="koboSpan" id="kobo.337.1">). </span><span class="koboSpan" id="kobo.337.2">One piece</span><a id="_idIndexMarker847"/><span class="koboSpan" id="kobo.338.1"> of advice I always give new web</span><a id="_idIndexMarker848"/><span class="koboSpan" id="kobo.339.1"> developers is to get the production mechanics in place as early as possible. </span><span class="koboSpan" id="kobo.339.2">If you do it right, you won’t have to mess with them</span><a id="_idIndexMarker849"/><span class="koboSpan" id="kobo.340.1"> again for quite </span><span class="No-Break"><span class="koboSpan" id="kobo.341.1">a while.</span></span></p>
<p><span class="koboSpan" id="kobo.342.1">JetBrains has a very good CI/CD server called TeamCity. </span><span class="koboSpan" id="kobo.342.2">I used it exclusively for the last 10 years, having only last year switched begrudgingly to Microsoft Azure DevOps. </span><span class="koboSpan" id="kobo.342.3">TeamCity is a much better system and its definitely worth your time and trouble if you’re looking for a CI/CD server. </span><span class="koboSpan" id="kobo.342.4">JetBrains even offers plugins for PyCharm that allow you to control and monitor builds right from </span><span class="No-Break"><span class="koboSpan" id="kobo.343.1">the IDE.</span></span></p>
<p><span class="koboSpan" id="kobo.344.1">This, though, is a chapter on Django, so let’s keep the party rolling and move on to working with </span><span class="No-Break"><span class="koboSpan" id="kobo.345.1">data models.</span></span></p>
<h1 id="_idParaDest-248"><a id="_idTextAnchor252"/><span class="koboSpan" id="kobo.346.1">Creating Django models</span></h1>
<p><span class="koboSpan" id="kobo.347.1">In a Django application, models play</span><a id="_idIndexMarker850"/><span class="koboSpan" id="kobo.348.1"> a central and crucial role. </span><span class="koboSpan" id="kobo.348.2">They are the backbone of the application’s data structure and are responsible for defining the database schema and handling data operations. </span><span class="koboSpan" id="kobo.348.3">Models allow developers to interact with the underlying database in an object-oriented manner, making it easier to manage and </span><span class="No-Break"><span class="koboSpan" id="kobo.349.1">manipulate data.</span></span></p>
<p><span class="koboSpan" id="kobo.350.1">Models serve as an interface between the application and the database. </span><span class="koboSpan" id="kobo.350.2">They abstract away the complexities of SQL queries and provide a high-level API to perform </span><strong class="bold"><span class="koboSpan" id="kobo.351.1">Create, Read, Update, Delete</span></strong><span class="koboSpan" id="kobo.352.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.353.1">CRUD</span></strong><span class="koboSpan" id="kobo.354.1">) operations. </span><span class="koboSpan" id="kobo.354.2">By</span><a id="_idIndexMarker851"/><span class="koboSpan" id="kobo.355.1"> using model methods and querysets, developers can interact with the database without having to write raw SQL code. </span><span class="koboSpan" id="kobo.355.2">Everything related to the database driving the application (including the things a lot of developers usually leave out, such as validation and constraints) can be found rolled into a </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">Django model.</span></span></p>
<p><span class="koboSpan" id="kobo.357.1">A prevalent anti-pattern that sometimes pops up with projects that forgo using ORMs is the use of the database to encapsulate business logic. </span><span class="koboSpan" id="kobo.357.2">The justification for this is usually that changing the database is quick, easy, and doesn’t require a new compilation or a new deployment. </span><span class="koboSpan" id="kobo.357.3">This is a foolish economy, and in a modern era that requires governance and documented</span><a id="_idIndexMarker852"/><span class="koboSpan" id="kobo.358.1"> change control, it becomes anathema. </span><span class="koboSpan" id="kobo.358.2">The senior database developer on my team, who is also a technical reviewer for </span><a href="B19644_11.xhtml#_idTextAnchor266"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.359.1">Chapter 11</span></em></span></a><span class="koboSpan" id="kobo.360.1">, describes this practice as changing the tires on a semi-truck while it is traveling down the highway at 100 mph. </span><span class="koboSpan" id="kobo.360.2">Django models, though, since they are technically objects, are able to handle business logic effectively and without taboo. </span><span class="koboSpan" id="kobo.360.3">This is because only the structure of the data model is translated into the database while the logic remains within </span><span class="No-Break"><span class="koboSpan" id="kobo.361.1">the object.</span></span></p>
<p><span class="koboSpan" id="kobo.362.1">The thing you need to remember about using an ORM, which is what we’re doing when we create and manipulate models, is that we are working with an abstraction of our database. </span><span class="koboSpan" id="kobo.362.2">When we manipulate instances of our models we are altering data in the database. </span><span class="koboSpan" id="kobo.362.3">Likewise, when we change the structure of our classes, we are altering the structure of the database. </span><span class="koboSpan" id="kobo.362.4">There are differences between the way data types in your programming language work and the way they work in the database. </span><span class="koboSpan" id="kobo.362.5">We’ll see this in action later, but right now I want you to think about the fact that Python is a dynamic language that uses duck typing. </span><span class="koboSpan" id="kobo.362.6">In Python, I can alter any structure or type in any way that suits me. </span><span class="koboSpan" id="kobo.362.7">Databases on the other hand are static and strongly typed. </span><span class="koboSpan" id="kobo.362.8">Django’s ORM has its work cut out for it given the differences in paradigm between the way Python works with classes, types, and variables versus the way the database works </span><span class="No-Break"><span class="koboSpan" id="kobo.363.1">with tables.</span></span></p>
<p><span class="koboSpan" id="kobo.364.1">Let’s look at creating an easy model. </span><span class="koboSpan" id="kobo.364.2">Locate the </span><strong class="source-inline"><span class="koboSpan" id="kobo.365.1">models.py</span></strong><span class="koboSpan" id="kobo.366.1"> file. </span><span class="koboSpan" id="kobo.366.2">You can find it displayed in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.367.1">Figure 10</span></em></span><em class="italic"><span class="koboSpan" id="kobo.368.1">.6</span></em><span class="koboSpan" id="kobo.369.1">, or you can use the navigation features in PyCharm by pressing </span><em class="italic"><span class="koboSpan" id="kobo.370.1">Ctrl</span></em><span class="koboSpan" id="kobo.371.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.372.1">Shift</span></em><span class="koboSpan" id="kobo.373.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.374.1">N</span></em><span class="koboSpan" id="kobo.375.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.376.1">Navigate</span></strong><span class="koboSpan" id="kobo.377.1"> | </span><strong class="bold"><span class="koboSpan" id="kobo.378.1">File</span></strong><span class="koboSpan" id="kobo.379.1"> in the menu) and typing in the </span><span class="No-Break"><span class="koboSpan" id="kobo.380.1">filename </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.381.1">models.py</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.382.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer307">
<span class="koboSpan" id="kobo.383.1"><img alt="Figure 10.6: Open the models.py file so we can add a model" src="image/B19644_10_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.384.1">Figure 10.6: Open the models.py file so we can add a model</span></p>
<p><span class="koboSpan" id="kobo.385.1">The generated code within will look </span><span class="No-Break"><span class="koboSpan" id="kobo.386.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.387.1">
from django.db import models
# Create your models here.</span></pre> <p><span class="koboSpan" id="kobo.388.1">We’re going to create two </span><a id="_idIndexMarker853"/><span class="koboSpan" id="kobo.389.1">models for our Bookery application: </span><strong class="source-inline"><span class="koboSpan" id="kobo.390.1">author</span></strong><span class="koboSpan" id="kobo.391.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.392.1">book</span></strong><span class="koboSpan" id="kobo.393.1">. </span><span class="koboSpan" id="kobo.393.2">To do this, let’s alter the code in </span><strong class="source-inline"><span class="koboSpan" id="kobo.394.1">models.py</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.395.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.396.1">
from django.db import models
import datetime
from django.utils import timezone</span></pre> <p><span class="koboSpan" id="kobo.397.1">Here, we’ve added two imports</span><a id="_idIndexMarker854"/><span class="koboSpan" id="kobo.398.1"> both related to time and dates. </span><span class="koboSpan" id="kobo.398.2">We’re going to use these libraries in some business logic that we will attach to the book model. </span><span class="koboSpan" id="kobo.398.3">Let’s not get ahead of ourselves, though. </span><span class="koboSpan" id="kobo.398.4">Let’s make a simple model to represent </span><span class="No-Break"><span class="koboSpan" id="kobo.399.1">book authors:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.400.1">
# Create your models here.
</span><span class="koboSpan" id="kobo.400.2">class Author(models.Model):
  first_name = models.CharField(max_length=100)
  last_name = models.CharField(max_length=100)
  def __str__(self):
    return f'{self.last_name}, {self.first_name}'</span></pre> <p><span class="koboSpan" id="kobo.401.1">The class is hopefully straightforward enough. </span><span class="koboSpan" id="kobo.401.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.402.1">Author</span></strong><span class="koboSpan" id="kobo.403.1"> class inherits from Django’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.404.1">model.Model</span></strong><span class="koboSpan" id="kobo.405.1"> class. </span><span class="koboSpan" id="kobo.405.2">There are two fields for the author’s first and last name and use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.406.1">models.CharField</span></strong><span class="koboSpan" id="kobo.407.1"> type to represent what would be varchars in the database. </span><span class="koboSpan" id="kobo.407.2">Relational databases require to declare a strong type, and in the case of a varchar (a variable-length character field), we have to supply a maximum length. </span><span class="koboSpan" id="kobo.407.3">The dunder string method simply gives us a nice format should we request the contents of the model as a string. </span><span class="koboSpan" id="kobo.407.4">Here, we’ve elected to format the author’s name as last name, comma, space, and </span><span class="No-Break"><span class="koboSpan" id="kobo.408.1">first name.</span></span></p>
<p><span class="koboSpan" id="kobo.409.1">Every ORM, regardless of platform, works the same way. </span><span class="koboSpan" id="kobo.409.2">Its aim is to allow developers to work only with native language objects. </span><span class="koboSpan" id="kobo.409.3">With that said, they usually need their own type system to allow the ORM to translate between the type system of the language (Python) and the database. </span><span class="koboSpan" id="kobo.409.4">You’ll learn in </span><a href="B19644_11.xhtml#_idTextAnchor266"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.410.1">Chapter 11</span></em></span></a><span class="koboSpan" id="kobo.411.1"> that database data types are not the same as in their programming language counterparts. </span><span class="koboSpan" id="kobo.411.2">At a minimum, differences such as calling strings as varchars are apparent, and types including int and float exist in both contexts. </span><span class="koboSpan" id="kobo.411.3">Sometimes they are even different between database platforms. </span><span class="koboSpan" id="kobo.411.4">There are datatypes in SQLite3 that are not present in MySQL, and </span><span class="No-Break"><span class="koboSpan" id="kobo.412.1">vice versa.</span></span></p>
<p><span class="koboSpan" id="kobo.413.1">An ORM has to work everywhere, so having its own type system for models allows for a single type system for the developer that can be adapted to any database platform. </span><span class="koboSpan" id="kobo.413.2">It is a classic implementation of the</span><a id="_idIndexMarker855"/><span class="koboSpan" id="kobo.414.1"> Gang of Four’s </span><strong class="bold"><span class="koboSpan" id="kobo.415.1">adapter pattern</span></strong><span class="koboSpan" id="kobo.416.1">, which I cover in</span><a id="_idIndexMarker856"/><span class="koboSpan" id="kobo.417.1"> my book </span><em class="italic"><span class="koboSpan" id="kobo.418.1">Real-World Implementation of C# Design Patterns</span></em><span class="koboSpan" id="kobo.419.1">, published </span><span class="No-Break"><span class="koboSpan" id="kobo.420.1">by Packt.</span></span></p>
<p><span class="koboSpan" id="kobo.421.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.422.1">author</span></strong><span class="koboSpan" id="kobo.423.1"> class is not very fancy. </span><span class="koboSpan" id="kobo.423.2">Let’s do some more interesting code in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.424.1">Book</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.425.1">model code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.426.1">
class Book(models.Model):
  title = models.CharField(max_length=200)
  author = models.ForeignKey(Author, on_delete=models.CASCADE,)
  pub_date = models.DateTimeField('date published')</span></pre> <p><span class="koboSpan" id="kobo.427.1">So far we have a </span><strong class="source-inline"><span class="koboSpan" id="kobo.428.1">Book</span></strong><span class="koboSpan" id="kobo.429.1"> class inheriting from </span><strong class="source-inline"><span class="koboSpan" id="kobo.430.1">models.Model</span></strong><span class="koboSpan" id="kobo.431.1"> as before. </span><span class="koboSpan" id="kobo.431.2">We have a title field with a maximum length of 200 characters. </span><span class="koboSpan" id="kobo.431.3">There is an </span><strong class="source-inline"><span class="koboSpan" id="kobo.432.1">author</span></strong><span class="koboSpan" id="kobo.433.1"> field, but rather than make this a string, we used the </span><strong class="source-inline"><span class="koboSpan" id="kobo.434.1">Author</span></strong><span class="koboSpan" id="kobo.435.1"> class to </span><a id="_idIndexMarker857"/><span class="koboSpan" id="kobo.436.1">set up a </span><strong class="bold"><span class="koboSpan" id="kobo.437.1">foreign key</span></strong><span class="koboSpan" id="kobo.438.1">. </span><span class="koboSpan" id="kobo.438.2">In database parlance, this means the data for the authors is represented in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.439.1">authors</span></strong><span class="koboSpan" id="kobo.440.1"> table, which is controlled by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.441.1">Author</span></strong><span class="koboSpan" id="kobo.442.1"> class we made a minute ago. </span><span class="koboSpan" id="kobo.442.2">A foreign key relationship specifies that any </span><strong class="source-inline"><span class="koboSpan" id="kobo.443.1">Book</span></strong><span class="koboSpan" id="kobo.444.1"> we add to the database must contain a related (it’s a relational database) database to an existing author. </span><span class="koboSpan" id="kobo.444.2">Operationally, this means we have to make sure the author exists in the database before we can add the author’s books to </span><span class="No-Break"><span class="koboSpan" id="kobo.445.1">the database.</span></span></p>
<p><span class="koboSpan" id="kobo.446.1">Foreign key constraints serve as a form of built-in data validation but they also help maintain data integrity in the database by enforcing rules. </span><span class="koboSpan" id="kobo.446.2">If I were to add an author to the database, and then add a bunch of books written by that author, we would have a nice relationship going on between the two tables. </span><span class="koboSpan" id="kobo.446.3">If I were to then delete the author from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.447.1">authors</span></strong><span class="koboSpan" id="kobo.448.1"> table, we’d still have a bunch of book records without a related author. </span><span class="koboSpan" id="kobo.448.2">They would be orphan records. </span><span class="koboSpan" id="kobo.448.3">Orphan records are bad because they take up space in the database, and they break the integrity of the relationship between authors </span><span class="No-Break"><span class="koboSpan" id="kobo.449.1">and books.</span></span></p>
<p><span class="koboSpan" id="kobo.450.1">In this class, when we define the </span><strong class="source-inline"><span class="koboSpan" id="kobo.451.1">author</span></strong><span class="koboSpan" id="kobo.452.1"> field, we are defining it with a foreign key constraint with an actual rule covering what happens when you delete an author. </span><span class="koboSpan" id="kobo.452.2">The code that says </span><strong class="source-inline"><span class="koboSpan" id="kobo.453.1">on_delete=models.CASCADE</span></strong><span class="koboSpan" id="kobo.454.1"> tells the ORM that when an author is deleted, so are the records of the books they’ve written. </span><span class="koboSpan" id="kobo.454.2">It is called a cascading delete because the delete cascades from the author to the book records, which could in turn cascade to other tables that might have similar relationships to books. </span><span class="koboSpan" id="kobo.454.3">A well-constructed database can keep itself clean and devoid of orphan records regardless of how complex the database</span><a id="_idIndexMarker858"/><span class="koboSpan" id="kobo.455.1"> structure </span><span class="No-Break"><span class="koboSpan" id="kobo.456.1">might be.</span></span></p>
<p><span class="koboSpan" id="kobo.457.1">Lastly, we have a date to contain the </span><span class="No-Break"><span class="koboSpan" id="kobo.458.1">publication date:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.459.1">
pub_date = models.DateTimeField('date published')</span></pre> <p><span class="koboSpan" id="kobo.460.1">If the </span><strong class="source-inline"><span class="koboSpan" id="kobo.461.1">foreign key</span></strong><span class="koboSpan" id="kobo.462.1"> field didn’t add enough spice for you, let’s add one more thing. </span><span class="koboSpan" id="kobo.462.2">Since we are dealing with an object, and since objects can contain both data and functional logic, let’s add a function to our </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.463.1">Book</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.464.1"> model:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.465.1">
  def was_published_recently(self):
    now = timezone.now()
    return now - datetime.timedelta(days=1) &lt;= self.pub_date &lt;= now</span></pre> <p><span class="koboSpan" id="kobo.466.1">This adds a field to our model, but rather than this data being stored in the database, it is computed at the time the method is called. </span><span class="koboSpan" id="kobo.466.2">We’re taking the static field for the publication date and computing the difference (delta) of the time to the current date. </span><span class="koboSpan" id="kobo.466.3">We’re taking into account the time zone and we’re presenting it as the number of days since the book was published. </span><span class="koboSpan" id="kobo.466.4">This allows us to show our users how old the book is in days, which might be used to prompt authors to produce new and updated editions of </span><span class="No-Break"><span class="koboSpan" id="kobo.467.1">their books.</span></span></p>
<h1 id="_idParaDest-249"><a id="_idTextAnchor253"/><span class="koboSpan" id="kobo.468.1">Performing migrations using manage.py</span></h1>
<p><span class="koboSpan" id="kobo.469.1">One of the files generated</span><a id="_idIndexMarker859"/><span class="koboSpan" id="kobo.470.1"> for your Django project is </span><strong class="source-inline"><span class="koboSpan" id="kobo.471.1">manage.py</span></strong><span class="koboSpan" id="kobo.472.1">. </span><span class="koboSpan" id="kobo.472.2">You can see it in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.473.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.474.1">.7</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.475.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer308">
<span class="koboSpan" id="kobo.476.1"><img alt="Figure 10.7: The manage.py file provides utilities for working with your Django project so you don’t have to type in long commands or remember full paths" src="image/B19644_10_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.477.1">Figure 10.7: The manage.py file provides utilities for working with your Django project so you don’t have to type in long commands or remember full paths</span></p>
<p><span class="koboSpan" id="kobo.478.1">The purpose of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.479.1">manage.py</span></strong><span class="koboSpan" id="kobo.480.1"> task is to</span><a id="_idIndexMarker860"/><span class="koboSpan" id="kobo.481.1"> allow you to run Django-specific commands from the command line without having to remember the full path to your Django project or manually set up the Python environment. </span><span class="koboSpan" id="kobo.481.2">By using </span><strong class="source-inline"><span class="koboSpan" id="kobo.482.1">manage.py</span></strong><span class="koboSpan" id="kobo.483.1">, you ensure that the commands are executed within the correct Django </span><span class="No-Break"><span class="koboSpan" id="kobo.484.1">project context.</span></span></p>
<p><span class="koboSpan" id="kobo.485.1">Some common tasks you can perform with </span><strong class="source-inline"><span class="koboSpan" id="kobo.486.1">manage.py</span></strong><span class="koboSpan" id="kobo.487.1"> include </span><span class="No-Break"><span class="koboSpan" id="kobo.488.1">the following:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.489.1">Running the development server</span></strong><span class="koboSpan" id="kobo.490.1">: You can start the Django development server using </span><strong class="source-inline"><span class="koboSpan" id="kobo.491.1">manage.py runserver</span></strong><span class="koboSpan" id="kobo.492.1">. </span><span class="koboSpan" id="kobo.492.2">This allows you to test your application locally during development. </span><span class="koboSpan" id="kobo.492.3">Earlier, we ran the Django project using the generated run configuration. </span><span class="koboSpan" id="kobo.492.4">We could have also used </span><strong class="source-inline"><span class="koboSpan" id="kobo.493.1">manage.py</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.494.1">for this.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.495.1">Creating and applying database migrations</span></strong><span class="koboSpan" id="kobo.496.1">: With </span><strong class="source-inline"><span class="koboSpan" id="kobo.497.1">manage.py makemigrations</span></strong><span class="koboSpan" id="kobo.498.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.499.1">manage.py migrate</span></strong><span class="koboSpan" id="kobo.500.1">, you can create and apply database migrations, respectively. </span><span class="koboSpan" id="kobo.500.2">This helps you manage changes to your models and keep your database schema up </span><span class="No-Break"><span class="koboSpan" id="kobo.501.1">to date.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.502.1">Creating a superuser</span></strong><span class="koboSpan" id="kobo.503.1">: You can create a superuser for the Django admin interface using </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.504.1">manage.py createsuperuser</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.505.1">.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.506.1">Running tests</span></strong><span class="koboSpan" id="kobo.507.1">: You can execute your</span><a id="_idIndexMarker861"/><span class="koboSpan" id="kobo.508.1"> test suite using </span><strong class="source-inline"><span class="koboSpan" id="kobo.509.1">manage.py test</span></strong><span class="koboSpan" id="kobo.510.1"> to ensure that your application functions </span><span class="No-Break"><span class="koboSpan" id="kobo.511.1">as expected.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.512.1">Managing static files</span></strong><span class="koboSpan" id="kobo.513.1">: You can collect and manage static files using </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.514.1">manage.py collectstatic</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.515.1">.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.516.1">Managing translations</span></strong><span class="koboSpan" id="kobo.517.1">: For internationalization and localization, you can use </span><strong class="source-inline"><span class="koboSpan" id="kobo.518.1">manage.py makemessages</span></strong><span class="koboSpan" id="kobo.519.1"> and </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.520.1">manage.py compilemessages</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.521.1">.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.522.1">This is just a short list. </span><span class="koboSpan" id="kobo.522.2">There are many more utilities in </span><strong class="source-inline"><span class="koboSpan" id="kobo.523.1">manage.py</span></strong><span class="koboSpan" id="kobo.524.1">. </span><span class="koboSpan" id="kobo.524.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.525.1">manage.py</span></strong><span class="koboSpan" id="kobo.526.1"> file serves as an entry point to Django management commands, making it easy to perform administrative tasks without leaving your development environment. </span><span class="koboSpan" id="kobo.526.2">Before you head down to the terminal button in PyCharm, there is actually an easier way to work with </span><strong class="source-inline"><span class="koboSpan" id="kobo.527.1">manage.py</span></strong><span class="koboSpan" id="kobo.528.1">. </span><span class="koboSpan" id="kobo.528.2">Click </span><strong class="bold"><span class="koboSpan" id="kobo.529.1">Tools | Run manage.py task...</span></strong><span class="koboSpan" id="kobo.530.1"> as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.531.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.532.1">.8</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.533.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer309">
<span class="koboSpan" id="kobo.534.1"><img alt="Figure 10.8: PyCharm has a dedicated tool panel for working with manage.py" src="image/B19644_10_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.535.1">Figure 10.8: PyCharm has a dedicated tool panel for working with manage.py</span></p>
<p><span class="koboSpan" id="kobo.536.1">This gives you a new panel, </span><a id="_idIndexMarker862"/><span class="koboSpan" id="kobo.537.1">as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.538.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.539.1">.9</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.540.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer310">
<span class="koboSpan" id="kobo.541.1"><img alt="Figure 10.9: The Run manage.py task panel is a dedicated command-line interface that lets you easily invoke commands specific to Django’s manage.py file" src="image/B19644_10_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.542.1">Figure 10.9: The Run manage.py task panel is a dedicated command-line interface that lets you easily invoke commands specific to Django’s manage.py file</span></p>
<p><span class="koboSpan" id="kobo.543.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.544.1">manage.py</span></strong><span class="koboSpan" id="kobo.545.1"> panel opens at the bottom of the IDE as many do. </span><span class="koboSpan" id="kobo.545.2">At first glance, it looks like a terminal window, but this one is specific to Django and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.546.1">manage.py</span></strong><span class="koboSpan" id="kobo.547.1"> file. </span><span class="koboSpan" id="kobo.547.2">As you can see, the panel provides auto-completion to help with </span><span class="No-Break"><span class="koboSpan" id="kobo.548.1">the commands.</span></span></p>
<p><span class="koboSpan" id="kobo.549.1">In order to create our migrations, you should type this command into </span><span class="No-Break"><span class="koboSpan" id="kobo.550.1">the panel:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.551.1">
makemigrations TheGreatBookery</span></pre> <p><span class="koboSpan" id="kobo.552.1">The result will resemble </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.553.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.554.1">.10</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.555.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer311">
<span class="koboSpan" id="kobo.556.1"><img alt="Figure 10.10: The result of the makemigrations command" src="image/B19644_10_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.557.1">Figure 10.10: The result of the makemigrations command</span></p>
<p><span class="koboSpan" id="kobo.558.1">You’ll find some messages in the </span><a id="_idIndexMarker863"/><strong class="source-inline"><span class="koboSpan" id="kobo.559.1">manage.py</span></strong><span class="koboSpan" id="kobo.560.1"> panel as well as a new file in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.561.1">migrations</span></strong><span class="koboSpan" id="kobo.562.1"> folder called something like </span><strong class="source-inline"><span class="koboSpan" id="kobo.563.1">0001_initial.py</span></strong><span class="koboSpan" id="kobo.564.1">. </span><span class="koboSpan" id="kobo.564.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.565.1">makemigrations</span></strong><span class="koboSpan" id="kobo.566.1"> command generated the code needed for the migration, but it hasn’t performed the migration yet. </span><span class="koboSpan" id="kobo.566.2">Performing the migration is what affects the changes to the database. </span><span class="koboSpan" id="kobo.566.3">In order to run the migration, type this into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.567.1">manage.py</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.568.1">task panel:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.569.1">
sqlmigrate TheGreatBookery 0001</span></pre> <p><span class="koboSpan" id="kobo.570.1">The output from the command, shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.571.1">Figure 10</span></em></span><em class="italic"><span class="koboSpan" id="kobo.572.1">.11</span></em><span class="koboSpan" id="kobo.573.1">, indicates the database structure has been updated to</span><a id="_idIndexMarker864"/><span class="koboSpan" id="kobo.574.1"> match </span><span class="No-Break"><span class="koboSpan" id="kobo.575.1">the models.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer312">
<span class="koboSpan" id="kobo.576.1"><img alt="Figure 10.11: The result of the migration is a set of messages and the appearance of our database file" src="image/B19644_10_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.577.1">Figure 10.11: The result of the migration is a set of messages and the appearance of our database file</span></p>
<p><span class="koboSpan" id="kobo.578.1">We see a bunch of SQL statements that were generated to bring the database structure up to match the structure of the models. </span><span class="koboSpan" id="kobo.578.2">We also see a new file for our database. </span><span class="koboSpan" id="kobo.578.3">If you remember, we saw earlier that the name and path of this file were set in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.579.1">settings.py</span></strong><span class="koboSpan" id="kobo.580.1"> file. </span><span class="koboSpan" id="kobo.580.2">Since SQLite3 is a file database, this is the actual database itself. </span><span class="koboSpan" id="kobo.580.3">This is the kind of thing you might want to exclude from revision control on a </span><span class="No-Break"><span class="koboSpan" id="kobo.581.1">real project.</span></span></p>
<h1 id="_idParaDest-250"><a id="_idTextAnchor254"/><span class="koboSpan" id="kobo.582.1">The Django admin interface</span></h1>
<p><span class="koboSpan" id="kobo.583.1">This is one of the killer </span><a id="_idIndexMarker865"/><span class="koboSpan" id="kobo.584.1">features of Django: it creates a web-based administrative panel for you. </span><span class="koboSpan" id="kobo.584.2">This means you don’t have to build an interface for dealing with users, handling logins, or creating screens for simple data entry into your model structure. </span><span class="koboSpan" id="kobo.584.3">The first thing every app needs is an administrative user or superuser. </span><span class="koboSpan" id="kobo.584.4">It is common for applications to have role-based user access, and the super-user is the user who can do everything, including adding new users. </span><span class="koboSpan" id="kobo.584.5">This kind of thing might take a developer two or</span><a id="_idIndexMarker866"/><span class="koboSpan" id="kobo.585.1"> three days to get working, but with Django, it’s </span><span class="No-Break"><span class="koboSpan" id="kobo.586.1">already done.</span></span></p>
<h2 id="_idParaDest-251"><a id="_idTextAnchor255"/><span class="koboSpan" id="kobo.587.1">Creating a superuser and logging in</span></h2>
<p><span class="koboSpan" id="kobo.588.1">Before users, logins, or any </span><a id="_idIndexMarker867"/><span class="koboSpan" id="kobo.589.1">of the other goodies we’re talking about here work, you </span><a id="_idIndexMarker868"/><span class="koboSpan" id="kobo.590.1">need to apply a migration that was generated for you when you created </span><span class="No-Break"><span class="koboSpan" id="kobo.591.1">the project.</span></span></p>
<p><span class="koboSpan" id="kobo.592.1">Let’s head back to our </span><strong class="source-inline"><span class="koboSpan" id="kobo.593.1">manage.py</span></strong><span class="koboSpan" id="kobo.594.1"> task panel and type </span><span class="No-Break"><span class="koboSpan" id="kobo.595.1">this command:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.596.1">
migrate</span></pre> <p><span class="koboSpan" id="kobo.597.1">Just like that, by itself. </span><span class="koboSpan" id="kobo.597.2">This adds all the base tables for the application. </span><span class="koboSpan" id="kobo.597.3">We probably should have done this first, but I didn’t want to break the flow of what we were working on. </span><span class="koboSpan" id="kobo.597.4">OK, really I forgot, but it sounded better the </span><span class="No-Break"><span class="koboSpan" id="kobo.598.1">other way.</span></span></p>
<p><span class="koboSpan" id="kobo.599.1">With that migration run we now have all the tables and structures in the database to support Django’s login and user administration feature. </span><span class="koboSpan" id="kobo.599.2">Next, let’s create the superuser. </span><span class="koboSpan" id="kobo.599.3">In the panel, type </span><span class="No-Break"><span class="koboSpan" id="kobo.600.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.601.1">
createsuperuser</span></pre> <p><span class="koboSpan" id="kobo.602.1">You are asked a set of questions designed to create a superuser for your application as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.603.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.604.1">.12</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.605.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer313">
<span class="koboSpan" id="kobo.606.1"><img alt="Figure 10.12: The manage.py panel interaction for creating a superuser" src="image/B19644_10_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.607.1">Figure 10.12: The manage.py panel interaction for creating a superuser</span></p>
<p><span class="koboSpan" id="kobo.608.1">Let’s try out the management interface! </span><span class="koboSpan" id="kobo.608.2">While you could just use the run configuration, let’s see what it is like to run it from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.609.1">manage.py</span></strong><span class="koboSpan" id="kobo.610.1"> task panel. </span><span class="koboSpan" id="kobo.610.2">Type </span><span class="No-Break"><span class="koboSpan" id="kobo.611.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.612.1">
runserver</span></pre> <p><span class="koboSpan" id="kobo.613.1">Then click the link in the panel message shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.614.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.615.1">.13</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.616.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer314">
<span class="koboSpan" id="kobo.617.1"><img alt="Figure 10.13: This time, let’s run from the panel!" src="image/B19644_10_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.618.1">Figure 10.13: This time, let’s run from the panel!</span></p>
<p><span class="koboSpan" id="kobo.619.1">In truth, it is the exact same thing you would have gotten by clicking the green run button as we did the first time we </span><a id="_idIndexMarker869"/><span class="koboSpan" id="kobo.620.1">ran the app. </span><span class="koboSpan" id="kobo.620.2">After clicking the link, your browser opens to the same page we saw before. </span><span class="koboSpan" id="kobo.620.3">Change the URL in the </span><a id="_idIndexMarker870"/><span class="koboSpan" id="kobo.621.1">browser to </span><a href="http://127.0.0.1:8000/admin"><span class="koboSpan" id="kobo.622.1">http://127.0.0.1:8000/admin</span></a><span class="koboSpan" id="kobo.623.1">. </span><span class="koboSpan" id="kobo.623.2">This will take you to the administrative login page shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.624.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.625.1">.14</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.626.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer315">
<span class="koboSpan" id="kobo.627.1"><img alt="Figure 10.14: The best kind of login system is the one you didn’t have to make yourself!" src="image/B19644_10_14.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.628.1">Figure 10.14: The best kind of login system is the one you didn’t have to make yourself!</span></p>
<p><span class="koboSpan" id="kobo.629.1">Type in the superuser user name and password you specified in the task panel. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.630.1">Figure</span></em></span><span class="No-Break"> </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.631.1">10</span></em></span><em class="italic"><span class="koboSpan" id="kobo.632.1">.15 </span></em><span class="koboSpan" id="kobo.633.1">shows the admin screen that </span><span class="No-Break"><span class="koboSpan" id="kobo.634.1">should appear.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer316">
<span class="koboSpan" id="kobo.635.1"><img alt="Figure 10.15: Without writing any code, we can add users and groups to the application" src="image/B19644_10_15.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.636.1">Figure 10.15: Without writing any code, we can add users and groups to the application</span></p>
<p><span class="koboSpan" id="kobo.637.1">Click around to see everything Django has generated for us. </span><span class="koboSpan" id="kobo.637.2">You can add users and groups to the application despite not having</span><a id="_idIndexMarker871"/><span class="koboSpan" id="kobo.638.1"> written any code for this – Django handled it for us. </span><span class="koboSpan" id="kobo.638.2">The downside here is that it was </span><a id="_idIndexMarker872"/><span class="koboSpan" id="kobo.639.1">generated based on the Django project’s ideas on what an admin panel should look like and how it should work. </span><span class="koboSpan" id="kobo.639.2">While it is possible to customize some of this functionality, remember that I keep saying that Django is </span><em class="italic"><span class="koboSpan" id="kobo.640.1">opinionated</span></em><span class="koboSpan" id="kobo.641.1">. </span><span class="koboSpan" id="kobo.641.2">It has assumptions baked in. </span><span class="koboSpan" id="kobo.641.3">Less opinionated frameworks would require you to build this or use a plugin, but you would be in total control over how this feature </span><span class="No-Break"><span class="koboSpan" id="kobo.642.1">was implemented.</span></span></p>
<h2 id="_idParaDest-252"><a id="_idTextAnchor256"/><span class="koboSpan" id="kobo.643.1">Adding the Author and Book models to the admin interface</span></h2>
<p><span class="koboSpan" id="kobo.644.1">While you get users and </span><a id="_idIndexMarker873"/><span class="koboSpan" id="kobo.645.1">groups for free, you do have to do a tiny bit of work to get authors and books to show up in the admin interface. </span><span class="koboSpan" id="kobo.645.2">Let’s start with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.646.1">Author</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.647.1"> model.</span></span></p>
<p><span class="koboSpan" id="kobo.648.1">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.649.1">admin.py</span></strong><span class="koboSpan" id="kobo.650.1"> file in </span><strong class="source-inline"><span class="koboSpan" id="kobo.651.1">TheGreatBookery</span></strong><span class="koboSpan" id="kobo.652.1"> folder and find a comment that says </span><strong class="source-inline"><span class="koboSpan" id="kobo.653.1"># Register your models here</span></strong><span class="koboSpan" id="kobo.654.1">. </span><span class="koboSpan" id="kobo.654.2">Add the </span><span class="No-Break"><span class="koboSpan" id="kobo.655.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.656.1">
# Register your models here.
</span><span class="koboSpan" id="kobo.656.2">from .models import Author
admin.site.register(Author)</span></pre> <p><span class="koboSpan" id="kobo.657.1">If your app stopped or crashed, go ahead and restart it, then navigate to the admin page as before. </span><span class="koboSpan" id="kobo.657.2">You should now see </span><strong class="bold"><span class="koboSpan" id="kobo.658.1">Authors</span></strong><span class="koboSpan" id="kobo.659.1"> appear on the admin page, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.660.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.661.1">.16</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.662.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer317">
<span class="koboSpan" id="kobo.663.1"><img alt="Figure 10.16: With very little effort, we can now add, edit, and delete authors" src="image/B19644_10_16.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.664.1">Figure 10.16: With very little effort, we can now add, edit, and delete authors</span></p>
<p><span class="koboSpan" id="kobo.665.1">We have the Author model; let’s add </span><strong class="source-inline"><span class="koboSpan" id="kobo.666.1">Book</span></strong><span class="koboSpan" id="kobo.667.1">. </span><span class="koboSpan" id="kobo.667.2">This one is a little fancier. </span><span class="koboSpan" id="kobo.667.3">Remember, there is a relationship between Book and Author. </span><span class="koboSpan" id="kobo.667.4">Each Author can be related to many Books, or inversely, many Books are related to </span><span class="No-Break"><span class="koboSpan" id="kobo.668.1">one Author.</span></span></p>
<p><span class="koboSpan" id="kobo.669.1">Since this is so, we want the</span><a id="_idIndexMarker874"/><span class="koboSpan" id="kobo.670.1"> admin interface to not only reflect this relationship but enforce it at the UI layer. </span><span class="koboSpan" id="kobo.670.2">You can just slap an import for the book model in and expect it to </span><span class="No-Break"><span class="koboSpan" id="kobo.671.1">work perfectly.</span></span></p>
<p><span class="koboSpan" id="kobo.672.1">Go back to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.673.1">admin.py</span></strong><span class="koboSpan" id="kobo.674.1"> file and add </span><span class="No-Break"><span class="koboSpan" id="kobo.675.1">this code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.676.1">
from django.contrib import admin
# Register your models here.
</span><strong class="bold"><span class="koboSpan" id="kobo.677.1">from .models import Author, Book</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.678.1">class BookInLine(admin.TabularInline):</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.679.1">  model = Book</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.680.1">  extra = 1</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.681.1">  fieldsets = [</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.682.1">    (None, {'fields': ['title']}),</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.683.1">    </span></strong><strong class="bold"><span class="koboSpan" id="kobo.684.1">('Date information', {'fields': ['pub_date']})</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.685.1">  ]</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.686.1">class AuthorAdmin(admin.ModelAdmin):</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.687.1">  inlines = [BookInLine]</span></strong><span class="koboSpan" id="kobo.688.1">
admin.site.register(Author, AuthorAdmin)</span></pre> <p><span class="koboSpan" id="kobo.689.1">This code creates an addition to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.690.1">Author</span></strong><span class="koboSpan" id="kobo.691.1"> UI that allows you to add books inline which is to say when you add an author, you will then have the opportunity to add books. </span><span class="koboSpan" id="kobo.691.2">You can’t have books</span><a id="_idIndexMarker875"/><span class="koboSpan" id="kobo.692.1"> without first adding authors. </span><span class="koboSpan" id="kobo.692.2">Because we defined the relationship and the UI this way, the ability to add and edit books is part of administering the author. </span><span class="koboSpan" id="kobo.692.3">You’ll never even have the chance to mess up by adding books before authors, or by somehow disassociating a book from </span><span class="No-Break"><span class="koboSpan" id="kobo.693.1">an author.</span></span></p>
<p><span class="koboSpan" id="kobo.694.1">Restart your server, and refresh your browser. </span><span class="koboSpan" id="kobo.694.2">Nothing changed! </span><span class="koboSpan" id="kobo.694.3">Hang on, that’s OK. </span><span class="koboSpan" id="kobo.694.4">We haven’t tried to add an author yet. </span><span class="koboSpan" id="kobo.694.5">Click </span><strong class="bold"><span class="koboSpan" id="kobo.695.1">Authors</span></strong><span class="koboSpan" id="kobo.696.1"> and then click </span><strong class="bold"><span class="koboSpan" id="kobo.697.1">Add</span></strong><span class="koboSpan" id="kobo.698.1">, and you’ll find the interface shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.699.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.700.1">.17</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.701.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer318">
<span class="koboSpan" id="kobo.702.1"><img alt="Figure 10.17: Our code added inline books to the UI for managing authors" src="image/B19644_10_17.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.703.1">Figure 10.17: Our code added inline books to the UI for managing authors</span></p>
<p><span class="koboSpan" id="kobo.704.1">As you can see, the form for adding books is now attached inline to the form for working </span><span class="No-Break"><span class="koboSpan" id="kobo.705.1">with authors.</span></span></p>
<h1 id="_idParaDest-253"><a id="_idTextAnchor257"/><span class="koboSpan" id="kobo.706.1">Creating Django views</span></h1>
<p><span class="koboSpan" id="kobo.707.1">The admin UI is pretty magical, but it is really only designed to create simple screens for managing data in </span><a id="_idIndexMarker876"/><span class="koboSpan" id="kobo.708.1">a database. </span><span class="koboSpan" id="kobo.708.2">Sooner or later, you’re going to have to actually make some real screens for the </span><span class="No-Break"><span class="koboSpan" id="kobo.709.1">app itself.</span></span></p>
<p><span class="koboSpan" id="kobo.710.1">We need to be careful about terminology here because the word </span><em class="italic"><span class="koboSpan" id="kobo.711.1">views</span></em><span class="koboSpan" id="kobo.712.1"> doesn’t mean what you might expect if you are versed in more conventional web development design patterns. </span><span class="koboSpan" id="kobo.712.2">The prevailing industry pattern is called </span><strong class="bold"><span class="koboSpan" id="kobo.713.1">Model-View-Controller </span></strong><span class="koboSpan" id="kobo.714.1">(</span><strong class="bold"><span class="koboSpan" id="kobo.715.1">MVC</span></strong><span class="koboSpan" id="kobo.716.1">). </span><span class="koboSpan" id="kobo.716.2">The pattern employed by Django is called </span><strong class="bold"><span class="koboSpan" id="kobo.717.1">Model-View-Template </span></strong><span class="koboSpan" id="kobo.718.1">(</span><strong class="bold"><span class="koboSpan" id="kobo.719.1">MVT</span></strong><span class="koboSpan" id="kobo.720.1">). </span><em class="italic"><span class="koboSpan" id="kobo.721.1">View</span></em><span class="koboSpan" id="kobo.722.1"> doesn’t mean the same thing between the two patterns. </span><span class="koboSpan" id="kobo.722.2">Let’s compare </span><span class="No-Break"><span class="koboSpan" id="kobo.723.1">the two.</span></span></p>
<table class="No-Table-Style _idGenTablePara-1" id="table001-3">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.724.1">MVC</span></strong></span></p>
</td>
<td class="No-Table-Style">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.725.1">MVT</span></strong></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.726.1">Model refers to the data structure, usually from </span><span class="No-Break"><span class="koboSpan" id="kobo.727.1">a database.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.728.1">Model means the same thing as it does </span><span class="No-Break"><span class="koboSpan" id="kobo.729.1">in MVC.</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.730.1">View refers to the visual elements which is usually the </span><span class="No-Break"><span class="koboSpan" id="kobo.731.1">user interface.</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.732.1">View refers to the controller layer, which accepts incoming requests, performs logic, and returns content </span><span class="No-Break"><span class="koboSpan" id="kobo.733.1">or data.</span></span></p>
</td>
</tr>
<tr class="No-Table-Style">
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.734.1">Controller refers to a layer that accepts incoming requests, performs logic, and returns content </span><span class="No-Break"><span class="koboSpan" id="kobo.735.1">or data</span></span></p>
</td>
<td class="No-Table-Style">
<p><span class="koboSpan" id="kobo.736.1">Template refers to the View in MVC, which is the HTML or user interface elements in </span><span class="No-Break"><span class="koboSpan" id="kobo.737.1">the application.</span></span></p>
</td>
</tr>
</tbody>
</table>
<p><span class="koboSpan" id="kobo.738.1">In summary, the Django View is</span><a id="_idIndexMarker877"/><span class="koboSpan" id="kobo.739.1"> really the Controller, and the</span><a id="_idIndexMarker878"/><span class="koboSpan" id="kobo.740.1"> Django Template would be the View in an MVC app. </span><span class="koboSpan" id="kobo.740.2">So here, when we are about to make the View, we’re talking about the part of the app </span><a id="_idIndexMarker879"/><span class="koboSpan" id="kobo.741.1">that receives requests, does something, then returns </span><span class="No-Break"><span class="koboSpan" id="kobo.742.1">the response.</span></span></p>
<p><span class="koboSpan" id="kobo.743.1">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.744.1">views.py</span></strong><span class="koboSpan" id="kobo.745.1"> file in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.746.1">TheGreatBookery</span></strong><span class="koboSpan" id="kobo.747.1"> folder. </span><span class="koboSpan" id="kobo.747.2">Change the code </span><span class="No-Break"><span class="koboSpan" id="kobo.748.1">to this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.749.1">
from django.shortcuts import render
</span><strong class="bold"><span class="koboSpan" id="kobo.750.1">from .models import Book</span></strong><span class="koboSpan" id="kobo.751.1">
# Create your views here.
</span><strong class="bold"><span class="koboSpan" id="kobo.752.1">def index(request):</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.753.1">  latest_books = Book.objects.order_by('-pub_date')[:5]</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.754.1">  context = {'latest_books': latest_books}</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.755.1">  return render(request, 'TheGreatBookery/index.html', context)</span></strong></pre> <p><span class="koboSpan" id="kobo.756.1">Here, we’ve imported the </span><strong class="source-inline"><span class="koboSpan" id="kobo.757.1">Book</span></strong><span class="koboSpan" id="kobo.758.1"> model, then defined a method designed to accept a request, retrieve all the books in the database, and order them by the </span><strong class="source-inline"><span class="koboSpan" id="kobo.759.1">pub_date</span></strong><span class="koboSpan" id="kobo.760.1"> field in descending order indicated by the minus sign next to </span><strong class="source-inline"><span class="koboSpan" id="kobo.761.1">pub_date</span></strong><span class="koboSpan" id="kobo.762.1">. </span><span class="koboSpan" id="kobo.762.2">We’re only going to display the first five books we find as indicated by the </span><span class="No-Break"><span class="koboSpan" id="kobo.763.1">slice </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.764.1">[:5]</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.765.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.766.1">Next, we create a variable called context ,which becomes a dictionary that will be used to pass data to the template during rendering. </span><span class="koboSpan" id="kobo.766.2">In this case, it creates a key-value pair where the key is </span><strong class="source-inline"><span class="koboSpan" id="kobo.767.1">latest_books</span></strong><span class="koboSpan" id="kobo.768.1"> and the value is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.769.1">QuerySet</span></strong><span class="koboSpan" id="kobo.770.1"> of the latest books retrieved in the </span><span class="No-Break"><span class="koboSpan" id="kobo.771.1">previous step.</span></span></p>
<p><span class="koboSpan" id="kobo.772.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.773.1">return</span></strong><span class="koboSpan" id="kobo.774.1"> line calls the </span><strong class="source-inline"><span class="koboSpan" id="kobo.775.1">render</span></strong><span class="koboSpan" id="kobo.776.1"> method imported at the top of the file. </span><span class="koboSpan" id="kobo.776.2">It passes the </span><strong class="source-inline"><span class="koboSpan" id="kobo.777.1">request</span></strong><span class="koboSpan" id="kobo.778.1"> object, a path to the template (which we have yet to create), and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.779.1">context</span></strong><span class="koboSpan" id="kobo.780.1"> dictionary variable we </span><span class="No-Break"><span class="koboSpan" id="kobo.781.1">just created.</span></span></p>
<p><span class="koboSpan" id="kobo.782.1">This view function won’t do all the </span><a id="_idIndexMarker880"/><span class="koboSpan" id="kobo.783.1">work by itself. </span><span class="koboSpan" id="kobo.783.2">Before it can be used, it must be registered in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.784.1">urls.py</span></strong><span class="koboSpan" id="kobo.785.1"> file so we have a route to employ </span><span class="No-Break"><span class="koboSpan" id="kobo.786.1">this function.</span></span></p>
<p><span class="koboSpan" id="kobo.787.1">Open </span><strong class="source-inline"><span class="koboSpan" id="kobo.788.1">urls.py</span></strong><span class="koboSpan" id="kobo.789.1"> and change the code </span><span class="No-Break"><span class="koboSpan" id="kobo.790.1">to this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.791.1">
from django.contrib import admin
from django.urls import path
</span><strong class="bold"><span class="koboSpan" id="kobo.792.1">from TheGreatBookery.views import index</span></strong><span class="koboSpan" id="kobo.793.1">
urlpatterns = [
 path('admin/', admin.site.urls),
 </span><strong class="bold"><span class="koboSpan" id="kobo.794.1">path('', index, name='index')</span></strong><span class="koboSpan" id="kobo.795.1">
]</span></pre> <p><span class="koboSpan" id="kobo.796.1">We added an import to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.797.1">index</span></strong><span class="koboSpan" id="kobo.798.1"> function we just created in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.799.1">views.py</span></strong><span class="koboSpan" id="kobo.800.1"> file. </span><span class="koboSpan" id="kobo.800.2">Next, we added by way of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.801.1">path</span></strong><span class="koboSpan" id="kobo.802.1"> function an empty string, which will map the root route for the app, a reference to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.803.1">index</span></strong><span class="koboSpan" id="kobo.804.1"> function that will execute in response to requests at the root route, and a </span><span class="No-Break"><span class="koboSpan" id="kobo.805.1">friendly name.</span></span></p>
<p><span class="koboSpan" id="kobo.806.1">We’re almost done. </span><span class="koboSpan" id="kobo.806.2">There’s just one more thing. </span><span class="koboSpan" id="kobo.806.3">Go back to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.807.1">view.py</span></strong><span class="koboSpan" id="kobo.808.1"> file and you’ll see some problematic yellow highlighting. </span><span class="koboSpan" id="kobo.808.2">See </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.809.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.810.1">.18</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.811.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer319">
<span class="koboSpan" id="kobo.812.1"><img alt="Figure 10.18: We have a view and a URL mapped, but we haven’t made the template yet" src="image/B19644_10_18.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.813.1">Figure 10.18: We have a view and a URL mapped, but we haven’t made the template yet</span></p>
<p><span class="koboSpan" id="kobo.814.1">Hover your mouse over </span><strong class="source-inline"><span class="koboSpan" id="kobo.815.1">index.html</span></strong><span class="koboSpan" id="kobo.816.1"> and </span><a id="_idIndexMarker881"/><span class="koboSpan" id="kobo.817.1">note that the tooltip has an action available to create the template for us. </span><span class="koboSpan" id="kobo.817.2">Either click the blue link text in the tool-tip window or use </span><em class="italic"><span class="koboSpan" id="kobo.818.1">Alt</span></em><span class="koboSpan" id="kobo.819.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.820.1">Shift</span></em><span class="koboSpan" id="kobo.821.1"> + </span><em class="italic"><span class="koboSpan" id="kobo.822.1">Enter</span></em><span class="koboSpan" id="kobo.823.1"> as indicated. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.824.1">Figure 10</span></em></span><em class="italic"><span class="koboSpan" id="kobo.825.1">.19</span></em><span class="koboSpan" id="kobo.826.1"> shows the </span><span class="No-Break"><span class="koboSpan" id="kobo.827.1">ensuing dialog.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer320">
<span class="koboSpan" id="kobo.828.1"><img alt="Figure 10.19: The dialog you get when you use the in-line action to create the missing template is automatically filled in based on some obvious assumptions" src="image/B19644_10_19.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.829.1">Figure 10.19: The dialog you get when you use the in-line action to create the missing template is automatically filled in based on some obvious assumptions</span></p>
<p><span class="koboSpan" id="kobo.830.1">When you click </span><strong class="bold"><span class="koboSpan" id="kobo.831.1">OK</span></strong><span class="koboSpan" id="kobo.832.1">, you are prompted to create a folder in </span><strong class="source-inline"><span class="koboSpan" id="kobo.833.1">Templates</span></strong><span class="koboSpan" id="kobo.834.1"> called </span><strong class="source-inline"><span class="koboSpan" id="kobo.835.1">TheGreatBookery</span></strong><span class="koboSpan" id="kobo.836.1">. </span><span class="koboSpan" id="kobo.836.2">It is possible to have multiple apps in your Django project. </span><span class="koboSpan" id="kobo.836.3">Since that is the case, you might want to segregate your templates. </span><span class="koboSpan" id="kobo.836.4">Go ahead and let PyCharm create the folder for you. </span><span class="koboSpan" id="kobo.836.5">After it does, you get an empty file </span><span class="No-Break"><span class="koboSpan" id="kobo.837.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.838.1">index.html</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.839.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.840.1">This isn’t a book on web page design, so we aren’t even going to try to make this pretty. </span><span class="koboSpan" id="kobo.840.2">Enter this code into your </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.841.1">index.html</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.842.1"> page:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.843.1">
{% if latest_books %}
  &lt;ul&gt;
    {% for book in latest_books %}
      &lt;li&gt;{{ book.title }} by {{ book.author }}&lt;/li&gt;
    {% endfor %}
  &lt;/ul&gt;
{% else %}
  &lt;p&gt;No books available.&lt;/p&gt;
{% endif %}</span></pre> <p><span class="koboSpan" id="kobo.844.1">This looks a lot like Jinja2 code we saw in </span><a href="B19644_08.xhtml#_idTextAnchor203"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.845.1">Chapter 8</span></em></span></a><span class="koboSpan" id="kobo.846.1"> with Flask. </span><span class="koboSpan" id="kobo.846.2">It is very similar. </span><span class="koboSpan" id="kobo.846.3">All this code does is check whether or not a dictionary key called </span><strong class="source-inline"><span class="koboSpan" id="kobo.847.1">latest_books</span></strong><span class="koboSpan" id="kobo.848.1"> exists on the data context that was passed in. </span><span class="koboSpan" id="kobo.848.2">If </span><a id="_idIndexMarker882"/><span class="koboSpan" id="kobo.849.1">you go back and look at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.850.1">render</span></strong><span class="koboSpan" id="kobo.851.1"> function we called in the view, it’s passing </span><span class="No-Break"><span class="koboSpan" id="kobo.852.1">this in.</span></span></p>
<p><span class="koboSpan" id="kobo.853.1">If the key is there, we render the contents using the templates for loop syntax. </span><span class="koboSpan" id="kobo.853.2">This isn’t exactly an amazing UI. </span><span class="koboSpan" id="kobo.853.3">It is just going to render an unordered list with each book as a list item. </span><span class="koboSpan" id="kobo.853.4">If the key were not there, then we’ll be rendering a paragraph that says </span><strong class="bold"><span class="koboSpan" id="kobo.854.1">No </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.855.1">books available</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.856.1">.</span></span></p>
<h2 id="_idParaDest-254"><a id="_idTextAnchor258"/><span class="koboSpan" id="kobo.857.1">What’s with the weird Python icon in the template gutter?</span></h2>
<p><span class="koboSpan" id="kobo.858.1">You might have noticed a big, juicy Python icon in the gutter of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.859.1">index.html</span></strong><span class="koboSpan" id="kobo.860.1"> file. </span><span class="koboSpan" id="kobo.860.2">Check out </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.861.1">Figure 18</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.862.1">.20</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.863.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer321">
<span class="koboSpan" id="kobo.864.1"><img alt="Figure 10.20: Look at that icon up there just begging to be clicked!" src="image/B19644_10_20.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.865.1">Figure 10.20: Look at that icon up there just begging to be clicked!</span></p>
<p><span class="koboSpan" id="kobo.866.1">That Python icon is actually called </span><span class="No-Break"><span class="koboSpan" id="kobo.867.1">a </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.868.1">Pythicon</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.869.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.870.1">OK, no it isn’t, I just made that up. </span><span class="koboSpan" id="kobo.870.2">Still, you really want to</span><a id="_idIndexMarker883"/><span class="koboSpan" id="kobo.871.1"> click it, don’t you? </span><span class="koboSpan" id="kobo.871.2">Go ahead, click it! </span><span class="koboSpan" id="kobo.871.3">It takes you to the Python code in </span><strong class="source-inline"><span class="koboSpan" id="kobo.872.1">views.py</span></strong><span class="koboSpan" id="kobo.873.1"> where we invoke it. </span><span class="koboSpan" id="kobo.873.2">Travel works both ways. </span><span class="koboSpan" id="kobo.873.3">In </span><strong class="source-inline"><span class="koboSpan" id="kobo.874.1">views.py</span></strong><span class="koboSpan" id="kobo.875.1">, you’ll notice</span><a id="_idIndexMarker884"/><span class="koboSpan" id="kobo.876.1"> a more subtle icon in the gutter where the template is invoked. </span><span class="koboSpan" id="kobo.876.2">See </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.877.1">Figure 18</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.878.1">.21</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.879.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer322">
<span class="koboSpan" id="kobo.880.1"><img alt="Figure 10.21: Click the HTML icon to navigate to the template" src="image/B19644_10_21.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.881.1">Figure 10.21: Click the HTML icon to navigate to the template</span></p>
<p><span class="koboSpan" id="kobo.882.1">Again, just click the html icon, er, I mean HTML icon, to go to the template. </span><span class="koboSpan" id="kobo.882.2">I wouldn’t blame you for clicking back and forth between the two while saying, </span><em class="italic"><span class="koboSpan" id="kobo.883.1">“Take that, vi </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.884.1">and emacs!”</span></em></span></p>
<h2 id="_idParaDest-255"><a id="_idTextAnchor259"/><span class="koboSpan" id="kobo.885.1">Run it!</span></h2>
<p><span class="koboSpan" id="kobo.886.1">Start or restart your server </span><a id="_idIndexMarker885"/><span class="koboSpan" id="kobo.887.1">and check the results as seen in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.888.1">Figure 18</span></em></span><em class="italic"><span class="koboSpan" id="kobo.889.1">.22</span></em><span class="koboSpan" id="kobo.890.1">. </span></p>
<div>
<div class="IMG---Figure" id="_idContainer323">
<span class="koboSpan" id="kobo.891.1"><img alt="Figure 10.22: This might be the best website ever!" src="image/B19644_10_22.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.892.1">Figure 10.22: This might be the best website ever!</span></p>
<p><span class="koboSpan" id="kobo.893.1">If you direct your browser to </span><a href="http://localhost:8000/"><span class="koboSpan" id="kobo.894.1">http://localhost:8000/</span></a><span class="koboSpan" id="kobo.895.1"> you should see either some books or a message stating there are no books. </span><span class="koboSpan" id="kobo.895.2">I added some obvious reading choices and so my run looks </span><span class="No-Break"><span class="koboSpan" id="kobo.896.1">absolutely glorious!</span></span></p>
<p><span class="koboSpan" id="kobo.897.1">Clearly, you could leverage the HTML tooling we learned in </span><a href="B19644_07.xhtml#_idTextAnchor172"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.898.1">Chapter 7</span></em></span></a><span class="koboSpan" id="kobo.899.1"> to make this nicer, but we still have more ground to cover, so I’ll leave that up </span><span class="No-Break"><span class="koboSpan" id="kobo.900.1">to you.</span></span></p>
<h1 id="_idParaDest-256"><a id="_idTextAnchor260"/><span class="koboSpan" id="kobo.901.1">Building Pyramid applications with PyCharm</span></h1>
<p><span class="koboSpan" id="kobo.902.1">We’ve seen three popular web frameworks so far. </span><span class="koboSpan" id="kobo.902.2">There is one left that is listed in PyCharm’s </span><strong class="bold"><span class="koboSpan" id="kobo.903.1">New Project</span></strong><span class="koboSpan" id="kobo.904.1"> menu: </span><strong class="bold"><span class="koboSpan" id="kobo.905.1">Pyramid</span></strong><span class="koboSpan" id="kobo.906.1">. </span><span class="koboSpan" id="kobo.906.2">You can find details on Pyramid </span><span class="No-Break"><span class="koboSpan" id="kobo.907.1">at </span></span><a href="https://trypyramid.com/"><span class="No-Break"><span class="koboSpan" id="kobo.908.1">https://trypyramid.com/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.909.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.910.1">The organization behind Pyramid bills it as a </span><a id="_idIndexMarker886"/><span class="koboSpan" id="kobo.911.1">framework that allows you to start small, finish big, and stay finished. </span><span class="koboSpan" id="kobo.911.2">To my mind, this might be a little bit of a dig at its main competitors. </span><span class="koboSpan" id="kobo.911.3">Django is criticized as being overly opinionated, and for being overkill for small projects. </span><span class="koboSpan" id="kobo.911.4">This fits with the “start small” idea in Pyramid. </span><span class="koboSpan" id="kobo.911.5">You have more leeway in choosing the components for your application, and you can leave out what you don’t need. </span><span class="koboSpan" id="kobo.911.6">For example, you can choose from a couple of ORM libraries, or simply choose not to use one. </span><span class="koboSpan" id="kobo.911.7">Django really wants you to </span><span class="No-Break"><span class="koboSpan" id="kobo.912.1">use theirs.</span></span></p>
<p><span class="koboSpan" id="kobo.913.1">Flask, in contrast, doesn’t come with an ORM or anything really, besides Jinja2 for templating. </span><span class="koboSpan" id="kobo.913.2">Flask is criticized for not being performant in large applications. </span><span class="koboSpan" id="kobo.913.3">The “finish big” concept seems to speak to this criticism. </span><span class="koboSpan" id="kobo.913.4">I’m not sure what, if anything, the “stay finished” directive is criticizing. </span><span class="koboSpan" id="kobo.913.5">I think that’s something we </span><span class="No-Break"><span class="koboSpan" id="kobo.914.1">all want.</span></span></p>
<p><span class="koboSpan" id="kobo.915.1">Having seen the first-rate tooling for Django, switching to Pyramid now is going to seem underwhelming. </span><span class="koboSpan" id="kobo.915.2">Django is a good candidate for custom tooling because it is complex, and it makes a lot of technical decisions for you. </span><span class="koboSpan" id="kobo.915.3">We can consider the </span><strong class="source-inline"><span class="koboSpan" id="kobo.916.1">manage.py</span></strong><span class="koboSpan" id="kobo.917.1"> task panel as an example. </span><span class="koboSpan" id="kobo.917.2">There are tons of commands in </span><strong class="source-inline"><span class="koboSpan" id="kobo.918.1">manage.py</span></strong><span class="koboSpan" id="kobo.919.1">, so having its own panel makes sense. </span><span class="koboSpan" id="kobo.919.2">It also helps that Django is wildly popular. </span><span class="koboSpan" id="kobo.919.3">Pyramid isn’t. </span><span class="koboSpan" id="kobo.919.4">So from a PyCharm perspective, this is a much simpler proposition in terms </span><span class="No-Break"><span class="koboSpan" id="kobo.920.1">of tooling.</span></span></p>
<h2 id="_idParaDest-257"><a id="_idTextAnchor261"/><span class="koboSpan" id="kobo.921.1">Creating a Pyramid project</span></h2>
<p><span class="koboSpan" id="kobo.922.1">Creating a Pyramid project is no</span><a id="_idIndexMarker887"/><span class="koboSpan" id="kobo.923.1"> different from any other. </span><span class="koboSpan" id="kobo.923.2">Just use </span><strong class="bold"><span class="koboSpan" id="kobo.924.1">File | New Project</span></strong><span class="koboSpan" id="kobo.925.1">, and pick the </span><strong class="bold"><span class="koboSpan" id="kobo.926.1">Pyramid</span></strong><span class="koboSpan" id="kobo.927.1"> template, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.928.1">Figure 10</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.929.1">.23</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.930.1">.</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer324">
<span class="koboSpan" id="kobo.931.1"><img alt="Figure 10.23: PyCharm has a project template for Pyramid" src="image/B19644_10_23.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.932.1">Figure 10.23: PyCharm has a project template for Pyramid</span></p>
<p><span class="koboSpan" id="kobo.933.1">As with Django, you should twirl </span><a id="_idIndexMarker888"/><span class="koboSpan" id="kobo.934.1">down the advanced settings, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.935.1">Figure 10</span></em></span><em class="italic"><span class="koboSpan" id="kobo.936.1">.23</span></em><span class="koboSpan" id="kobo.937.1">. </span><span class="koboSpan" id="kobo.937.2">You are able to set a project name, as you were in Django. </span><span class="koboSpan" id="kobo.937.3">Be careful with </span><span class="No-Break"><span class="koboSpan" id="kobo.938.1">this setting!</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.939.1">Pyramid project name</span></p>
<p class="callout"><span class="koboSpan" id="kobo.940.1">Make sure the project name is different than the PyCharm project name entered in the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.941.1">Location</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.942.1"> box.</span></span></p>
<p><span class="koboSpan" id="kobo.943.1">When working with Pyramid, it’s a best practice to have a PyCharm project name that is different from the project name you define within Pyramid. </span><span class="koboSpan" id="kobo.943.2">This separation of names is recommended to avoid potential conflicts and confusion between the two namespaced systems: PyCharm, an IDE, and Pyramid, a Python </span><span class="No-Break"><span class="koboSpan" id="kobo.944.1">web framework.</span></span></p>
<p><span class="koboSpan" id="kobo.945.1">Here’s why it’s advisable to keep </span><span class="No-Break"><span class="koboSpan" id="kobo.946.1">them different:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.947.1">Namespace clashes</span></strong><span class="koboSpan" id="kobo.948.1">: If your PyCharm project name matches your Pyramid project name exactly, you may encounter namespace clashes or naming conflicts. </span><span class="koboSpan" id="kobo.948.2">These conflicts can make it challenging for PyCharm to distinguish between project-specific settings, configurations, and files, and the Pyramid framework-specific files and </span><a id="_idIndexMarker889"/><span class="koboSpan" id="kobo.949.1">configurations. </span><span class="koboSpan" id="kobo.949.2">This can lead to confusion and potential errors in your </span><span class="No-Break"><span class="koboSpan" id="kobo.950.1">development process.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.951.1">PyCharm project settings</span></strong><span class="koboSpan" id="kobo.952.1">: PyCharm uses the project name for its internal settings and configurations, including virtual environments, code analysis, and project-specific settings. </span><span class="koboSpan" id="kobo.952.2">If your PyCharm project name is the same as your Pyramid project name, PyCharm might overwrite or interfere with Pyramid-specific configurations </span><span class="No-Break"><span class="koboSpan" id="kobo.953.1">and settings.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.954.1">Clarity and maintainability</span></strong><span class="koboSpan" id="kobo.955.1">: Keeping distinct names for your PyCharm project and Pyramid project helps maintain clarity and organization in your development environment. </span><span class="koboSpan" id="kobo.955.2">It makes it easier to understand which aspects of your development are controlled by PyCharm and which are specific to your Pyramid </span><span class="No-Break"><span class="koboSpan" id="kobo.956.1">web application.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.957.1">Flexibility</span></strong><span class="koboSpan" id="kobo.958.1">: Having different names provides flexibility, especially if you work on multiple projects with Pyramid or use PyCharm for various other Python projects. </span><span class="koboSpan" id="kobo.958.2">It prevents potential conflicts when switching </span><span class="No-Break"><span class="koboSpan" id="kobo.959.1">between projects.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.960.1">I’m going to name my imaginary project </span><strong class="source-inline"><span class="koboSpan" id="kobo.961.1">giza_application</span></strong><span class="koboSpan" id="kobo.962.1">, a nod to the location of the Great Pyramids </span><span class="No-Break"><span class="koboSpan" id="kobo.963.1">of Egypt.</span></span></p>
<p><span class="koboSpan" id="kobo.964.1">Having set the project name, you can select from two template engines: </span><strong class="bold"><span class="koboSpan" id="kobo.965.1">Jinja2</span></strong><span class="koboSpan" id="kobo.966.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.967.1">Chameleon</span></strong><span class="koboSpan" id="kobo.968.1">. </span><span class="koboSpan" id="kobo.968.2">Finally, you have settings for the ORM, which here is specified as </span><strong class="bold"><span class="koboSpan" id="kobo.969.1">Backend</span></strong><span class="koboSpan" id="kobo.970.1">. </span><span class="koboSpan" id="kobo.970.2">The two choices are </span><strong class="bold"><span class="koboSpan" id="kobo.971.1">SQLAlchemy</span></strong><span class="koboSpan" id="kobo.972.1">, which is very popular, and </span><strong class="bold"><span class="koboSpan" id="kobo.973.1">ZODB</span></strong><span class="koboSpan" id="kobo.974.1">, which is </span><span class="No-Break"><span class="koboSpan" id="kobo.975.1">somewhat exotic.</span></span></p>
<p><span class="koboSpan" id="kobo.976.1">SQL Alchemy is a straightforward ORM used for working with relational databases. </span><span class="koboSpan" id="kobo.976.2">You create models as we did with Django’s ORM, and through a migration process, you can apply your database schema changes to a new or </span><span class="No-Break"><span class="koboSpan" id="kobo.977.1">existing database.</span></span></p>
<p><span class="koboSpan" id="kobo.978.1">ZODB refers to the Zope database. </span><span class="koboSpan" id="kobo.978.2">Generally speaking, Zope is an open source web application server written in Python. </span><span class="koboSpan" id="kobo.978.3">Less generally speaking, it is used as a content management system similar to WordPress. </span><span class="koboSpan" id="kobo.978.4">The database component, ZODB, has some interesting features that distinguish it from typical relational databases. </span><span class="koboSpan" id="kobo.978.5">It’s a powerful tool that can be used in conjunction with the Pyramid web framework to manage data in a more Pythonic way. </span><span class="koboSpan" id="kobo.978.6">Here’s how ZODB</span><a id="_idIndexMarker890"/><span class="koboSpan" id="kobo.979.1"> integrates into a Pyramid project and some of </span><span class="No-Break"><span class="koboSpan" id="kobo.980.1">its features:</span></span></p>
<ul>
<li><strong class="bold"><span class="koboSpan" id="kobo.981.1">Python native</span></strong><span class="koboSpan" id="kobo.982.1">: ZODB lets you store Python objects without needing to serialize them into a different format. </span><span class="koboSpan" id="kobo.982.2">You can work with complex data structures directly, without having to </span><a id="_idIndexMarker891"/><span class="koboSpan" id="kobo.983.1">map them to a relational </span><span class="No-Break"><span class="koboSpan" id="kobo.984.1">database schema.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.985.1">ACID transactions</span></strong><span class="koboSpan" id="kobo.986.1">: ZODB supports </span><strong class="bold"><span class="koboSpan" id="kobo.987.1">Atomicity, Consistency, Isolation, Durability</span></strong><span class="koboSpan" id="kobo.988.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.989.1">ACID</span></strong><span class="koboSpan" id="kobo.990.1">) transactions. </span><span class="koboSpan" id="kobo.990.2">This ensures that </span><a id="_idIndexMarker892"/><span class="koboSpan" id="kobo.991.1">your data remains consistent, even if something goes wrong during </span><span class="No-Break"><span class="koboSpan" id="kobo.992.1">a transaction.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.993.1">Integration with Pyramid</span></strong><span class="koboSpan" id="kobo.994.1">: ZODB can be easily integrated with Pyramid using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.995.1">pyramid_zodbconn</span></strong><span class="koboSpan" id="kobo.996.1"> package. </span><span class="koboSpan" id="kobo.996.2">This provides a smooth way to get a ZODB connection within Pyramid’s </span><span class="No-Break"><span class="koboSpan" id="kobo.997.1">request handling.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.998.1">Hierarchical storage</span></strong><span class="koboSpan" id="kobo.999.1">: ZODB allows you to organize your data in a tree-like structure. </span><span class="koboSpan" id="kobo.999.2">This can be particularly useful in a Pyramid application using traversal, where the URL structure often mirrors a hierarchical </span><span class="No-Break"><span class="koboSpan" id="kobo.1000.1">data structure.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.1001.1">Scalability</span></strong><span class="koboSpan" id="kobo.1002.1">: ZODB can be scaled across multiple machines, allowing for more extensive and </span><span class="No-Break"><span class="koboSpan" id="kobo.1003.1">complex applications.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.1004.1">Versioning</span></strong><span class="koboSpan" id="kobo.1005.1">: ZODB supports object versioning, allowing you to keep track of changes to objects over time. </span><span class="koboSpan" id="kobo.1005.2">This can be useful for implementing features such </span><span class="No-Break"><span class="koboSpan" id="kobo.1006.1">as undo/redo.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.1007.1">Querying</span></strong><span class="koboSpan" id="kobo.1008.1">: While ZODB does not provide a query language such as SQL, it offers ways to index and search objects using tools including the BTrees module or third-party packages such </span><span class="No-Break"><span class="koboSpan" id="kobo.1009.1">as </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1010.1">repoze.catalog</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1011.1">.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.1012.1">No schema required</span></strong><span class="koboSpan" id="kobo.1013.1">: Unlike relational databases, ZODB doesn’t require a fixed schema, offering flexibility in data modeling. </span><span class="koboSpan" id="kobo.1013.2">You can modify the Python classes used for storage without needing to </span><span class="No-Break"><span class="koboSpan" id="kobo.1014.1">migrate data.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.1015.1">Blob support</span></strong><span class="koboSpan" id="kobo.1016.1">: ZODB supports the storage of large binary objects (BLOBs), such as images or videos, alongside </span><span class="No-Break"><span class="koboSpan" id="kobo.1017.1">regular objects.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.1018.1">Persistence</span></strong><span class="koboSpan" id="kobo.1019.1">: ZODB provides a straightforward persistence model. </span><span class="koboSpan" id="kobo.1019.2">Any changes to persistent objects within a transaction are automatically saved to the database when the transaction </span><span class="No-Break"><span class="koboSpan" id="kobo.1020.1">is committed.</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.1021.1">Compatibility</span></strong><span class="koboSpan" id="kobo.1022.1">: ZODB works well with various WSGI servers and can be integrated into a Pyramid application running on </span><span class="No-Break"><span class="koboSpan" id="kobo.1023.1">different platforms.</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.1024.1">ZODB can be a compelling choice for Pyramid</span><a id="_idIndexMarker893"/><span class="koboSpan" id="kobo.1025.1"> developers looking for a database that aligns closely with Python’s object-oriented paradigm. </span><span class="koboSpan" id="kobo.1025.2">Its integration into a Pyramid project allows for intuitive data management without the need for complex SQL queries or ORM mapping, making it an attractive option for certain types of applications. </span><span class="koboSpan" id="kobo.1025.3">If the hierarchical, object-oriented nature of ZODB fits the data model of your Pyramid application, it may be an excellent choice. </span><span class="koboSpan" id="kobo.1025.4">From a PyCharm perspective though, there is no special tooling for </span><span class="No-Break"><span class="koboSpan" id="kobo.1026.1">this database.</span></span></p>
<p><span class="koboSpan" id="kobo.1027.1">Clicking the </span><strong class="bold"><span class="koboSpan" id="kobo.1028.1">OK</span></strong><span class="koboSpan" id="kobo.1029.1"> button will generate the project structure and the </span><span class="No-Break"><span class="koboSpan" id="kobo.1030.1">run configuration.</span></span></p>
<p><span class="koboSpan" id="kobo.1031.1">I really wish there was more to say here, but in truth, besides Djano, any other framework that could have been covered last would have the same problem. </span><span class="koboSpan" id="kobo.1031.2">We’ve already covered PyCharm’s tools for developing web applications in an unopinionated framework. </span><span class="koboSpan" id="kobo.1031.3">We have seen the support for Jinja2 templates, working with an ORM, and obviously general Python </span><span class="No-Break"><span class="koboSpan" id="kobo.1032.1">project work.</span></span></p>
<h1 id="_idParaDest-258"><a id="_idTextAnchor262"/><span class="koboSpan" id="kobo.1033.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.1034.1">In this chapter, we examined various PyCharm features regarding supporting and automating tasks in the process of web development with Django. </span><span class="koboSpan" id="kobo.1034.2">While this list of features is in no way exhaustive, I hope it can offer you a solid starting point to continue discovering other powerful features for your web </span><span class="No-Break"><span class="koboSpan" id="kobo.1035.1">development process.</span></span></p>
<p><span class="koboSpan" id="kobo.1036.1">First, we see that, by specifying the PyCharm project type as Django, an extensive project skeleton will be generated with convenient boilerplate code already filled out. </span><span class="koboSpan" id="kobo.1036.2">With the implementation of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1037.1">manage.py</span></strong><span class="koboSpan" id="kobo.1038.1"> panel inside the project window as well as its run/debug configuration, PyCharm additionally allows for a higher level of development, with various tasks traditionally achieved via the command line, such as running the server or making migrations. </span><span class="koboSpan" id="kobo.1038.2">Finally, by acknowledging integrated views and templates in Django, PyCharm makes it as easy as possible for developers to work with them in the editor—be it generating a missing template, code completion even in HTML and Jinja, or even dynamically switching between views </span><span class="No-Break"><span class="koboSpan" id="kobo.1039.1">and templates.</span></span></p>
<p><span class="koboSpan" id="kobo.1040.1">We concluded with a short coverage of Pyramid. </span><span class="koboSpan" id="kobo.1040.2">Pyramid is a framework that aims to be more flexible than Django but packs more features than Flask. </span><span class="koboSpan" id="kobo.1040.3">It’s a happy medium between the two. </span><span class="koboSpan" id="kobo.1040.4">Unfortunately for Pyramid, we covered it last. </span><span class="koboSpan" id="kobo.1040.5">PyCharm doesn’t have any special tooling for Pyramid beyond the project template that creates the project structure. </span><span class="koboSpan" id="kobo.1040.6">To be fair, if Flask had gone last, it would have suffered the same fate because most of PyCharm’s web development tools are useful regardless of which framework you choose. </span><span class="koboSpan" id="kobo.1040.7">Pyramid has some great features and is worthy of consideration for </span><span class="No-Break"><span class="koboSpan" id="kobo.1041.1">any project.</span></span></p>
<p><span class="koboSpan" id="kobo.1042.1">In the next chapter, we will tackle the last major component of any web application: the database. </span><span class="koboSpan" id="kobo.1042.2">Buckle up, because the tooling for databases in PyCharm </span><span class="No-Break"><span class="koboSpan" id="kobo.1043.1">is </span><a id="_idTextAnchor263"/><span class="koboSpan" id="kobo.1044.1">extensive!</span></span></p>
<h1 id="_idParaDest-259"><a id="_idTextAnchor264"/><span class="koboSpan" id="kobo.1045.1">Questions</span></h1>
<ol>
<li><span class="koboSpan" id="kobo.1046.1">What are the major characteristics of Django, and how do they set Django apart from another popular Python web </span><span class="No-Break"><span class="koboSpan" id="kobo.1047.1">framework, Flask?</span></span></li>
<li><span class="koboSpan" id="kobo.1048.1">What is the purpose of the PyCharm </span><strong class="source-inline"><span class="koboSpan" id="kobo.1049.1">manage.py</span></strong><span class="koboSpan" id="kobo.1050.1"> panel in a Django project, and how does one open and </span><span class="No-Break"><span class="koboSpan" id="kobo.1051.1">utilize it?</span></span></li>
<li><span class="koboSpan" id="kobo.1052.1">What is the purpose of the Django admin interface? </span><span class="koboSpan" id="kobo.1052.2">How does one create an instance of a model (that is, a new entry in a database table) in this interface? </span><span class="koboSpan" id="kobo.1052.3">How does the process change if the model references </span><span class="No-Break"><span class="koboSpan" id="kobo.1053.1">another model?</span></span></li>
<li><span class="koboSpan" id="kobo.1054.1">What is the purpose of the run/debug configuration in PyCharm in the context of running a </span><span class="No-Break"><span class="koboSpan" id="kobo.1055.1">Django server?</span></span></li>
<li><span class="koboSpan" id="kobo.1056.1">Does PyCharm’s code completion logic only apply to Python code in </span><span class="No-Break"><span class="koboSpan" id="kobo.1057.1">Django projects?</span></span></li>
<li><span class="koboSpan" id="kobo.1058.1">What is the significance of being able to switch between Django views and corresponding templates </span><span class="No-Break"><span class="koboSpan" id="kobo.1059.1">in PyCharm?</span></span></li>
<li><span class="koboSpan" id="kobo.1060.1">Describe the PyCharm tooling available for the </span><span class="No-Break"><span class="koboSpan" id="kobo.1061.1">Pyramid framework.</span></span></li>
</ol>
<h1 id="_idParaDest-260"><a id="_idTextAnchor265"/><span class="koboSpan" id="kobo.1062.1">Further reading</span></h1>
<p><span class="koboSpan" id="kobo.1063.1">Be sure to check out the companion website for the book </span><span class="No-Break"><span class="koboSpan" id="kobo.1064.1">at </span></span><a href="https://www.pycharm-book.com"><span class="No-Break"><span class="koboSpan" id="kobo.1065.1">https://www.pycharm-book.com</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.1066.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1067.1">Check the following resources to expand on what was covered in </span><span class="No-Break"><span class="koboSpan" id="kobo.1068.1">this chapter:</span></span></p>
<ul>
<li><em class="italic"><span class="koboSpan" id="kobo.1069.1">Web Development with Django, </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1070.1">Second Edition</span></em></span></li>
<li><em class="italic"><span class="koboSpan" id="kobo.1071.1">Hands-On RESTful Python Web Services, </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1072.1">Second Edition</span></em></span></li>
</ul>
</div>
</body></html>