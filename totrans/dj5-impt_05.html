<html><head></head><body>
		<div><h1 id="_idParaDest-84" class="chapter-number"><a id="_idTextAnchor088"/><a id="_idTextAnchor089"/><st c="0">5</st></h1>
			<h1 id="_idParaDest-85"><a id="_idTextAnchor090"/><st c="2">Working with Models</st></h1>
			<p><st c="21">Storing data in a database is a common practice in most web applications. </st><st c="96">In a Django project, it involves working with Django models. </st><st c="157">In this chapter, we will create a database model (for example, a movie) and Django will turn this model into a database table for us. </st><st c="291">We will also explore a powerful built-in admin interface that provides a visual way of managing all aspects of a Django project, such as users and making changes to </st><st c="456">model data.</st></p>
			<p><st c="467">In this chapter, we will cover the </st><st c="503">following topics:</st></p>
			<ul>
				<li><st c="520">Creating our </st><st c="534">first model</st></li>
				<li><st c="545">Installing Pillow</st></li>
				<li><st c="563">Managing migrations</st></li>
				<li><st c="583">Accessing the Django </st><st c="605">admin interface</st></li>
				<li><st c="620">Configuring </st><st c="633">image upload</st></li>
				<li><st c="645">Serving </st><st c="654">stored images</st></li>
				<li><st c="667">Adding a movie model </st><st c="689">to admin</st></li>
			</ul>
			<h1 id="_idParaDest-86"><a id="_idTextAnchor091"/><st c="697">Technical requirements</st></h1>
			<p><st c="720">In this chapter, we will be using Python 3.10+. </st><st c="769">Additionally, we will be using the </st><strong class="bold"><st c="804">VS Code</st></strong><st c="811"> editor in this book, which you can download </st><st c="856">from </st><a href="https://code.visualstudio.com/"><st c="861">https://code.visualstudio.com/</st></a><st c="891">.</st></p>
			<p><st c="892">The code for this chapter is located </st><st c="930">at </st><a href="https://github.com/PacktPublishing/Django-5-for-the-Impatient-Second-Edition/tree/main/Chapter05/moviesstore"><st c="933">https://github.com/PacktPublishing/Django-5-for-the-Impatient-Second-Edition/tree/main/Chapter05/moviesstore</st></a><st c="1041">.</st></p>
			<p><st c="1042">The CiA video for this chapter can be found </st><st c="1087">at </st><a href="https://packt.link/HEeUM"><st c="1090">https://packt.link/HEeUM</st></a></p>
			<h1 id="_idParaDest-87"><a id="_idTextAnchor092"/><st c="1114">Creating our first model</st></h1>
			<p><st c="1139">A </st><strong class="bold"><st c="1142">Django model</st></strong><st c="1154"> is a Python class that represents a database table. </st><st c="1207">Models are used to define the structure and behavior of the data that will be stored in the database. </st><st c="1309">Each model class typically corresponds to a single database table, and each instance of the class represents a specific row in that table. </st><st c="1448">More information about Django models</st><a id="_idIndexMarker153"/><st c="1484"> can be found </st><st c="1498">here: </st><a href="https://docs.djangoproject.com/en/5.0/topics/db/models/"><st c="1504">https://docs.djangoproject.com/en/5.0/topics/db/models/.</st></a></p>
			<p><st c="1560">We can create models such as Movie, Review, and Order, and Django turns these models into a database table </st><st c="1668">for us.</st></p>
			<p><st c="1675">Here are the Django</st><a id="_idIndexMarker154"/> <st c="1695">model basics:</st></p>
			<ul>
				<li><st c="1709">Each model is a class that </st><st c="1737">extends </st><code><st c="1745">django.db.models.Model</st></code></li>
				<li><st c="1767">Each model attribute represents a </st><st c="1802">database column</st></li>
				<li><st c="1817">With all of this, Django provides us </st><a id="_idIndexMarker155"/><st c="1855">with a set of useful methods to </st><strong class="bold"><st c="1887">create, update, read, and delete</st></strong><st c="1919"> (</st><strong class="bold"><st c="1921">CRUD</st></strong><st c="1925">) model information from </st><st c="1951">a database</st></li>
			</ul>
			<h2 id="_idParaDest-88"><a id="_idTextAnchor093"/><st c="1961">Creating a Movie model</st></h2>
			<p><st c="1984">Our first model will be a Movie. </st><st c="2018">We can create models in each of the project apps. </st><st c="2068">Movie seems to be more related to the </st><code><st c="2106">movies</st></code><st c="2112"> app, so we will create the </st><code><st c="2140">Movie</st></code><st c="2145"> model there. </st><st c="2159">In </st><code><st c="2162">/movies</st></code><st c="2169">, we </st><a id="_idIndexMarker156"/><st c="2174">have the </st><code><st c="2183">models.py</st></code><st c="2192"> file, where we create our models for the </st><code><st c="2234">movies</st></code><st c="2240"> app. </st><st c="2246">Open that file and place the following lines </st><st c="2291">of code:</st></p>
			<pre class="source-code"><st c="2299">
from django.db import models
class Movie(models.Model):
    id = models.AutoField(primary_key=True)
    name = models.CharField(max_length=255)
    price = models.IntegerField()
    description = models.TextField()
    image = models.ImageField(upload_to='movie_images/')
    def __str__(self):
        return str(self.id) + ' - ' + self.name</st></pre>			<p><st c="2610">Let’s explain the </st><st c="2629">previous code:</st></p>
			<ul>
				<li><st c="2643">First, we import</st><a id="_idIndexMarker157"/><st c="2660"> the </st><code><st c="2665">models</st></code><st c="2671"> module, which provides various classes and utilities for defining </st><st c="2738">database models.</st></li>
				<li><st c="2754">Next, we define a Python class named </st><code><st c="2792">Movie</st></code><st c="2797">, which inherits from </st><code><st c="2819">models.Model</st></code><st c="2831">. This means that </st><code><st c="2849">Movie</st></code><st c="2854"> is a Django </st><st c="2867">model class.</st></li>
				<li><st c="2879">Inside the </st><code><st c="2891">Movie</st></code><st c="2896"> class, we define </st><st c="2914">several fields:</st><ul><li><code><st c="2929">id</st></code><st c="2932">: This is an </st><code><st c="2946">AutoField</st></code><st c="2955"> value that automatically increments its value for each new record that’s added to the database. </st><st c="3052">The </st><code><st c="3056">primary_key=True</st></code><st c="3072"> parameter specifies that this field is the primary key for the table, uniquely identifying </st><st c="3164">each record.</st></li><li><code><st c="3176">name</st></code><st c="3181">: This is a </st><code><st c="3194">CharField</st></code><st c="3203"> value that represents a string field with a maximum length of 255 characters. </st><st c="3282">It stores the name of </st><st c="3304">the movie.</st></li><li><code><st c="3314">price</st></code><st c="3320">: This is an </st><code><st c="3334">IntegerField</st></code><st c="3346"> value that stores integer values. </st><st c="3381">It represents the price of </st><st c="3408">the movie.</st></li><li><code><st c="3418">description</st></code><st c="3430">: This is a </st><code><st c="3443">TextField</st></code><st c="3452"> value that represents a text field with no specified maximum length. </st><st c="3522">It stores a textual description of </st><st c="3557">the movie.</st></li><li><code><st c="3567">image</st></code><st c="3573">: This is an </st><code><st c="3587">ImageField</st></code><st c="3597"> value that stores image files. </st><st c="3629">The </st><code><st c="3633">upload_to</st></code><st c="3642"> parameter specifies the directory where uploaded images will be stored. </st><st c="3715">In this case, uploaded images will be stored in the </st><code><st c="3767">movie_images/</st></code><st c="3780"> directory within the media directory of the Django project. </st><st c="3841">The media directory is used to store user-uploaded files, such as images, documents, or other media files. </st><st c="3948">This directory is specified in your Django project’s settings (we will configure it later in </st><st c="4041">this chapter).</st></li></ul></li>
				<li><code><st c="4055">__str__</st></code><st c="4063">: This is a special method in Python classes that returns a string representation of an object. </st><st c="4160">It concatenates the movie’s </st><code><st c="4188">id</st></code><st c="4190"> value (converted into a string) with a hyphen and the movie’s name. </st><st c="4259">This method will be useful when we display movies in the Django admin </st><st c="4329">panel later.</st></li>
			</ul>
			<p class="callout-heading"><st c="4341">Note</st></p>
			<p class="callout"><st c="4346">Django provides many other model</st><a id="_idIndexMarker158"/><st c="4379"> fields to support common types, such as dates, integers, and emails. </st><st c="4449">To have complete documentation of the kinds of types and how</st><a id="_idIndexMarker159"/><st c="4509"> to use them, refer to the </st><code><st c="4536">Model</st></code><st c="4541"> field reference in the Django </st><st c="4572">documentation (</st><a href="https://docs.djangoproject.com/en/5.0/ref/models/fields/"><st c="4587">https://docs.djangoproject.com/en/5.0/ref/models/fields/</st></a><st c="4644">).</st></p>
			<h1 id="_idParaDest-89"><a id="_idTextAnchor094"/><st c="4647">Installing Pillow</st></h1>
			<p><st c="4665">Because we’re using </st><a id="_idIndexMarker160"/><st c="4686">images, we need</st><a id="_idIndexMarker161"/><st c="4701"> to install Pillow (</st><a href="https://pypi.org/project/pillow/"><st c="4721">https://pypi.org/project/pillow/</st></a><st c="4754">), which adds image-processing capabilities to our </st><st c="4806">Python interpreter.</st></p>
			<p><st c="4825">In the Terminal, stop the server and do </st><st c="4866">the following:</st></p>
			<ul>
				<li><st c="4880">For macOS, run the </st><st c="4900">following command:</st><pre class="source-code">
<strong class="bold"><st c="4918">pip3 install pillow</st></strong></pre></li>				<li><st c="4938">For Windows, run the </st><st c="4960">following command:</st><pre class="source-code">
<strong class="bold"><st c="4978">pip install pillow</st></strong></pre></li>			</ul>
			<p><st c="4997">Now that Pillow has been installed, let’s learn how to manage </st><st c="5060">Django migrations.</st></p>
			<h1 id="_idParaDest-90"><a id="_idTextAnchor095"/><st c="5078">Managing migrations</st></h1>
			<p><strong class="bold"><st c="5098">Django migrations</st></strong><st c="5116"> is a feature of Django that allows</st><a id="_idIndexMarker162"/><st c="5151"> you to manage changes to your database schema – that is, changes to the structure of your database tables and the data within them – over time, as your Django </st><st c="5311">project evolves.</st></p>
			<p><st c="5327">When you define models in Django, you’re essentially defining the structure of your database tables. </st><st c="5429">However, as your project grows and changes, you might need to make alterations to these models, such as adding new fields, removing fields, or modifying existing fields. </st><st c="5599">Django migrations provide a way to propagate these changes to your database schema in a controlled and consistent manner (as a version </st><st c="5734">control system).</st></p>
			<p><st c="5750">To work with migrations, we must apply</st><a id="_idIndexMarker163"/><st c="5789"> the default migrations, create custom migrations, and apply </st><st c="5850">custom migrations.</st></p>
			<h2 id="_idParaDest-91"><a id="_idTextAnchor096"/><st c="5868">Applying the default migrations</st></h2>
			<p><st c="5900">Currently, note a message</st><a id="_idIndexMarker164"/><st c="5926"> in the Terminal when you run </st><st c="5956">the server:</st></p>
			<pre class="console"><st c="5967">
You have 18 unapplied migration(s). </st><st c="6004">Your project may not work properly until you apply the migrations for app(s): admin, auth, contenttypes, sessions.
</st><st c="6119">Run 'python manage.py migrate' to apply them.</st></pre>			<p><st c="6164">As per the message instructions, stop the server and do the following (remember to be located in the </st><code><st c="6266">moviesstore</st></code><st c="6277"> folder that contains the </st><code><st c="6303">manage.py</st></code><st c="6312"> file):</st></p>
			<ul>
				<li><st c="6319">For macOS, run the </st><st c="6339">following command:</st><pre class="source-code">
<strong class="bold"><st c="6357">python3 manage.py migrate</st></strong></pre></li>				<li><st c="6383">For Windows, run the </st><st c="6405">following command:</st><pre class="source-code">
<strong class="bold"><st c="6423">python manage.py migrate</st></strong></pre></li>			</ul>
			<p><st c="6448">The </st><code><st c="6453">migrate</st></code><st c="6460"> command creates an initial database based on Django’s default settings. </st><st c="6533">Note that there is a </st><code><st c="6554">db.sqlite3</st></code><st c="6564"> file in the project root folder. </st><st c="6598">This file represents our SQLite database. </st><st c="6640">It’s created the first time we run </st><code><st c="6675">migrate</st></code> <st c="6682">or </st><code><st c="6686">runserver</st></code><st c="6695">.</st></p>
			<p><st c="6696">In the previous case, the </st><code><st c="6723">migrate</st></code><st c="6730"> command applied 18 default migrations (as shown in </st><em class="italic"><st c="6782">Figure 5</st></em><em class="italic"><st c="6790">.1</st></em><st c="6792">). </st><st c="6796">Those migrations were defined by some default Django apps – </st><code><st c="6856">admin</st></code><st c="6861">, </st><code><st c="6863">auth</st></code><st c="6867">, </st><code><st c="6869">contenttypes</st></code><st c="6881">, and </st><code><st c="6887">sessions</st></code><st c="6895">. These apps are loaded in the </st><code><st c="6926">INSTALLED_APPS</st></code><st c="6940"> variable in the </st><code><st c="6957">moviesstore/settings.py</st></code><st c="6980"> file.</st></p>
			<p><st c="6986">So, the </st><code><st c="6995">migrate</st></code><st c="7002"> command runs the migrations of all the installed apps. </st><st c="7058">Note that </st><code><st c="7068">INSTALLED_APPS</st></code><st c="7082"> also loads the </st><code><st c="7098">movies</st></code><st c="7104"> app. </st><st c="7110">However, no migrations were applied for the </st><code><st c="7154">movies</st></code><st c="7160"> app. </st><st c="7166">This is because we haven’t generated the migrations for the </st><code><st c="7226">movies</st></code><st c="7232"> app:</st></p>
			<div><div><img src="img/B22457_05_01.jpg" alt="Figure 5.1 – Applying default Django migrations"/><st c="7237"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="7850">Figure 5.1 – Applying default Django migrations</st></p>
			<h2 id="_idParaDest-92"><a id="_idTextAnchor097"/><st c="7897">Creating custom migrations</st></h2>
			<p><st c="7924">Currently, we’ve defined</st><a id="_idIndexMarker165"/><st c="7949"> a </st><code><st c="7952">Movie</st></code><st c="7957"> model inside the </st><code><st c="7975">movies</st></code><st c="7981"> app. </st><st c="7987">Based on that model, we can create our own migrations. </st><st c="8042">To create the migrations for the </st><code><st c="8075">movies</st></code><st c="8081"> app, we need to run the </st><code><st c="8106">makemigrations</st></code><st c="8120"> command in </st><st c="8132">the terminal:</st></p>
			<ul>
				<li><st c="8145">For macOS, run the </st><st c="8165">following command:</st><pre class="source-code">
<strong class="bold"><st c="8183">python3 manage.py makemigrations</st></strong></pre></li>				<li><st c="8216">For Windows, run the </st><st c="8238">following command:</st><pre class="source-code">
<strong class="bold"><st c="8256">python manage.py makemigrations</st></strong></pre></li>			</ul>
			<p><st c="8288">The previous command creates migration files based on the models that we’ve defined in our Django apps (see </st><em class="italic"><st c="8397">Figure 5</st></em><em class="italic"><st c="8405">.2</st></em><st c="8407">):</st></p>
			<div><div><img src="img/B22457_05_02.jpg" alt="Figure 5.2 – Executing the makemigrations command"/><st c="8410"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="8462">Figure 5.2 – Executing the makemigrations command</st></p>
			<p><st c="8511">The migrations are stored in the corresponding app-level </st><code><st c="8569">migrations</st></code><st c="8579"> folder. </st><st c="8588">For now, we have only defined the </st><code><st c="8622">Movie</st></code><st c="8627"> model inside the </st><code><st c="8645">movies</st></code><st c="8651"> app. </st><st c="8657">So, this command generates the migration file for the </st><code><st c="8711">Movie</st></code><st c="8716"> model inside the </st><code><st c="8734">movies/migrations/</st></code><st c="8752"> folder (see </st><em class="italic"><st c="8765">Figure 5</st></em><em class="italic"><st c="8773">.3</st></em><st c="8775">):</st></p>
			<div><div><img src="img/B22457_05_03.jpg" alt="Figure 5.3 – Generated migrations for the movies app"/><st c="8778"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="8883">Figure 5.3 – Generated migrations for the movies app</st></p>
			<p><st c="8935">If we change the </st><code><st c="8953">Movie</st></code><st c="8958"> model or create new models, we need to execute the </st><code><st c="9010">makemigrations</st></code><st c="9024"> command again. </st><st c="9040">This command will create new migration files that will serve as a version control</st><a id="_idIndexMarker166"/><st c="9121"> of our </st><st c="9129">database schema.</st></p>
			<p><st c="9145">Note that the migration file was created, but the database hasn’t been </st><st c="9217">updated yet.</st></p>
			<h2 id="_idParaDest-93"><a id="_idTextAnchor098"/><st c="9229">Applying custom migrations</st></h2>
			<p><st c="9256">After running </st><code><st c="9271">makemigrations</st></code><st c="9285">, you typically need</st><a id="_idIndexMarker167"/><st c="9305"> to run </st><code><st c="9313">migrate</st></code><st c="9320"> to apply those migrations to the database and make the corresponding changes. </st><st c="9399">Now, execute the following in </st><st c="9429">the Terminal:</st></p>
			<ul>
				<li><st c="9442">For macOS, run the </st><st c="9462">following command:</st><pre class="source-code">
<strong class="bold"><st c="9480">python3 manage.py migrate</st></strong></pre></li>				<li><st c="9506">For Windows, run the </st><st c="9528">following command:</st><pre class="source-code">
<strong class="bold"><st c="9546">python manage.py migrate</st></strong></pre></li>			</ul>
			<p><st c="9571">As shown in </st><em class="italic"><st c="9584">Figure 5</st></em><em class="italic"><st c="9592">.4</st></em><st c="9594">, we applied the </st><code><st c="9611">movies</st></code> <st c="9617">app migrations:</st></p>
			<div><div><img src="img/B22457_05_04.jpg" alt="Figure 5.4 – Applying the movies app migrations"/><st c="9633"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="9778">Figure 5.4 – Applying the movies app migrations</st></p>
			<p><st c="9825">In summary, each time you make changes to a model file, you have to do </st><st c="9897">the following:</st></p>
			<ul>
				<li><st c="9911">For macOS, run the </st><st c="9931">following command:</st><pre class="source-code">
<strong class="bold"><st c="9949">python3 manage.py makemigrations</st></strong>
<strong class="bold"><st c="9982">python3 manage.py migrate</st></strong></pre></li>				<li><st c="10008">For Windows, run the </st><st c="10030">following command:</st><pre class="source-code">
<strong class="bold"><st c="10048">python manage.py makemigrations</st></strong>
<strong class="bold"><st c="10080">python manage.py migrate</st></strong></pre></li>			</ul>
			<p><st c="10105">But how do we access our database</st><a id="_idIndexMarker168"/><st c="10139"> and view what’s inside? </st><st c="10164">For that, we use a powerful tool in Django called the admin interface. </st><st c="10235">We’ll discuss this in the </st><st c="10261">next section.</st></p>
			<h1 id="_idParaDest-94"><a id="_idTextAnchor099"/><st c="10274">Accessing the Django admin interface</st></h1>
			<p><st c="10311">To access </st><a id="_idIndexMarker169"/><st c="10322">our database, we have to go into the Django admin interface. </st><st c="10383">Remember that there is an </st><code><st c="10409">admin</st></code><st c="10414"> path </st><st c="10420">in </st><code><st c="10423">/moviesstore/urls.py</st></code></p>
			<pre class="source-code"><st c="10443">
…
urlpatterns = [
    </st><strong class="bold"><st c="10461">path('admin/', admin.site.urls),</st></strong><st c="10493">
    path('', include('home.urls')),
    path('movies/', include('movies.urls')),
]</st></pre>			<p><st c="10568">If you go to </st><code><st c="10582">localhost:8000/admin</st></code><st c="10602">, you’ll be taken to the admin site, as shown in </st><em class="italic"><st c="10651">Figure 5</st></em><em class="italic"><st c="10659">.5</st></em><st c="10661">:</st></p>
			<div><div><img src="img/B22457_05_05.jpg" alt="Figure 5.5 – Admin page"/><st c="10663"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="10768">Figure 5.5 – Admin page</st></p>
			<p><st c="10791">Django has a powerful built-in admin interface that provides a visual way of managing all aspects of a Django project – for example, users, movies, </st><st c="10940">and more.</st></p>
			<p><st c="10949">With what username</st><a id="_idIndexMarker170"/><st c="10968"> and password do we log in to the admin interface? </st><st c="11019">For this, we have to create a superuser in </st><st c="11062">the Terminal.</st></p>
			<h2 id="_idParaDest-95"><a id="_idTextAnchor100"/><st c="11075">Creating a superuser</st></h2>
			<p><st c="11096">Let’s create a superuser</st><a id="_idIndexMarker171"/><st c="11121"> to access the admin panel. </st><st c="11149">In the Terminal, stop the server and do </st><st c="11189">the following:</st></p>
			<ul>
				<li><st c="11203">For macOS, run the </st><st c="11223">following command:</st><pre class="source-code">
<strong class="bold"><st c="11241">python3 manage.py createsuperuser</st></strong></pre></li>				<li><st c="11275">For Windows, run the </st><st c="11297">following command:</st><pre class="source-code">
<strong class="bold"><st c="11315">python manage.py createsuperuser</st></strong></pre></li>			</ul>
			<p><st c="11348">You will then be asked to specify a username, email, and password. </st><st c="11416">Note that anyone can access the admin path on your site, so make sure that your password is something secure. </st><st c="11526">After creating</st><a id="_idIndexMarker172"/><st c="11540"> the superuser, you should get a message like this from </st><st c="11596">the Terminal:</st></p>
			<pre class="console"><st c="11609">
Superuser created successfully.</st></pre>			<h2 id="_idParaDest-96"><a id="_idTextAnchor101"/><st c="11641">Restoring your superuser password</st></h2>
			<p><st c="11675">If you wish to change your password</st><a id="_idIndexMarker173"/><st c="11711"> later, you can run the </st><st c="11735">following commands:</st></p>
			<ul>
				<li><st c="11754">Here’s the command </st><st c="11774">for macOS:</st><pre class="source-code">
<strong class="bold"><st c="11784">python3 manage.py changepassword &lt;username&gt;</st></strong></pre></li>				<li><st c="11828">Here’s the command </st><st c="11848">for Windows:</st><pre class="source-code">
<strong class="bold"><st c="11860">python manage.py changepassword &lt;username&gt;</st></strong></pre></li>			</ul>
			<h2 id="_idParaDest-97"><a id="_idTextAnchor102"/><st c="11903">Accessing the admin panel</st></h2>
			<p><st c="11929">Now, start the server again and log in to admin</st><a id="_idIndexMarker174"/><st c="11977"> with the username you just created, as shown in </st><em class="italic"><st c="12026">Figure 5</st></em><em class="italic"><st c="12034">.6</st></em><st c="12036">:</st></p>
			<div><div><img src="img/B22457_05_06.jpg" alt="Figure 5.6 – Site administration page"/><st c="12038"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="12280">Figure 5.6 – Site administration page</st></p>
			<p><st c="12317">Under </st><strong class="bold"><st c="12324">Users</st></strong><st c="12329">, you’ll see the user you’ve just created, as shown in </st><em class="italic"><st c="12384">Figure 5</st></em><em class="italic"><st c="12392">.7</st></em><st c="12394">:</st></p>
			<div><div><img src="img/B22457_05_07.jpg" alt="Figure 5.7 – The Users admin page"/><st c="12396"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="12681">Figure 5.7 – The Users admin page</st></p>
			<p><st c="12714">You can add </st><a id="_idIndexMarker175"/><st c="12727">additional user accounts here for </st><st c="12761">your team.</st></p>
			<p><st c="12771">Currently, our </st><code><st c="12787">Movie</st></code><st c="12792"> model doesn’t show up in admin. </st><st c="12825">We need to explicitly tell Django what to display in it. </st><st c="12882">Before adding our </st><code><st c="12900">Movie</st></code><st c="12905"> model in admin, let’s configure our project so that images can </st><st c="12969">be uploaded.</st></p>
			<h1 id="_idParaDest-98"><a id="_idTextAnchor103"/><st c="12981">Configuring image upload</st></h1>
			<p><st c="13006">We have to configure</st><a id="_idIndexMarker176"/><st c="13027"> where we wish to store our images when we add them. </st><st c="13080">First, in </st><code><st c="13090">/moviesstore/settings.py</st></code><st c="13114">, add the following in bold at the end of </st><st c="13156">the file:</st></p>
			<pre class="source-code"><st c="13165">
…
</st><strong class="bold"><st c="13167">MEDIA_ROOT = os.path.join(BASE_DIR, 'media')</st></strong>
<strong class="bold"><st c="13211">MEDIA_URL = '/media/'</st></strong></pre>			<p><st c="13233">Let’s explain the </st><st c="13252">previous code:</st></p>
			<ul>
				<li><code><st c="13266">MEDIA_ROOT</st></code><st c="13277">: This variable specifies the filesystem path to the directory where uploaded media files will be stored. </st><st c="13384">Here, </st><code><st c="13390">BASE_DIR</st></code><st c="13398"> is a variable that represents the base directory of the Django project, and </st><code><st c="13475">'media'</st></code><st c="13482"> is the subdirectory within </st><code><st c="13510">BASE_DIR</st></code><st c="13518"> where media files will be stored. </st><st c="13553">So, </st><code><st c="13557">MEDIA_ROOT</st></code><st c="13567"> will be set to a path </st><st c="13590">like </st><code><st c="13595">/your_project_folder/media</st></code><st c="13621">.</st></li>
				<li><code><st c="13622">MEDIA_URL</st></code><st c="13632">: This variable specifies the URL prefix that will be used to serve media files from the web server. </st><st c="13734">In this code, it’s set to </st><code><st c="13760">'/media/'</st></code><st c="13769">, meaning that media files uploaded to the Django application will be accessible via URLs starting with </st><code><st c="13873">/media/</st></code><st c="13880">. For example, if you upload an image named </st><code><st c="13924">example.jpg</st></code><st c="13935">, it might be accessible at a URL </st><st c="13969">like </st><st c="13974">http://localhost:8000/media/example.jpg</st><st c="14013">.</st></li>
			</ul>
			<p><st c="14014">With that, the server has been configured</st><a id="_idIndexMarker177"/><st c="14056"> for image upload. </st><st c="14075">So, let’s learn how to serve </st><st c="14104">those images.</st></p>
			<h1 id="_idParaDest-99"><a id="_idTextAnchor104"/><st c="14117">Serving the stored images</st></h1>
			<p><st c="14143">Next, to enable the </st><a id="_idIndexMarker178"/><st c="14164">server to serve the stored images, we have to modify the </st><code><st c="14221">/moviesstore/urls.py</st></code><st c="14241"> file and add the following </st><st c="14269">in bold:</st></p>
			<pre class="source-code"><st c="14277">
…
</st><strong class="bold"><st c="14279">from django.conf.urls.static import static</st></strong>
<strong class="bold"><st c="14321">from django.conf import settings</st></strong><st c="14354">
urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('home.urls')),
    path('movies/', include('movies.urls')),
]
</st><strong class="bold"><st c="14479">urlpatterns += static(settings.MEDIA_URL,</st></strong>
<code><st c="14611">MEDIA_ROOT</st></code><st c="14621"> directory when the </st><code><st c="14641">MEDIA_URL</st></code><st c="14650"> URL prefix </st><st c="14662">is accessed.</st></p>
			<p class="callout-heading"><st c="14674">Note</st></p>
			<p class="callout"><st c="14679">It’s important to stop the server and run the server again to apply the </st><st c="14752">previous changes.</st></p>
			<p><st c="14769">Now that the image configuration is done, let’s add movies to the </st><st c="14836">admin panel.</st></p>
			<h1 id="_idParaDest-100"><a id="_idTextAnchor105"/><st c="14848">Adding a movie model to the admin panel</st></h1>
			<p><st c="14888">We are now ready to create movies from the admin panel and store the images in our Django project. </st><st c="14988">We will add the </st><code><st c="15004">Movie</st></code><st c="15009"> model to the admin panel, and we will </st><st c="15048">create movies.</st></p>
			<h2 id="_idParaDest-101"><a id="_idTextAnchor106"/><st c="15062">Adding the Movie model to the admin panel</st></h2>
			<p><st c="15104">To add the </st><code><st c="15116">Movie</st></code><st c="15121"> model to the admin panel, go back to </st><code><st c="15159">/movies/admin.py</st></code><st c="15175"> and </st><a id="_idIndexMarker180"/><st c="15180">register our model</st><a id="_idIndexMarker181"/><st c="15198"> by adding the following </st><st c="15223">in </st><strong class="bold"><st c="15226">bold</st></strong><st c="15230">:</st></p>
			<pre class="source-code"><st c="15232">
from django.contrib import admin
</st><strong class="bold"><st c="15266">from .models import Movie</st></strong>
<code><st c="15392">/admin</st></code><st c="15398">. The </st><code><st c="15404">Movie</st></code><st c="15409"> model will now appear (as shown in </st><em class="italic"><st c="15445">Figure 5</st></em><em class="italic"><st c="15453">.8</st></em><st c="15455">):</st></p>
			<div><div><img src="img/B22457_05_08.jpg" alt="Figure 5.8 – Admin page with movies available"/><st c="15458"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="15629">Figure 5.8 – Admin page with movies available</st></p>
			<p><st c="15674">Try adding a </st><code><st c="15688">movie</st></code><st c="15693"> object by clicking </st><strong class="bold"><st c="15713">+Add</st></strong><st c="15717">. You</st><a id="_idIndexMarker182"/><st c="15722"> will be brought</st><a id="_idIndexMarker183"/><st c="15738"> to the </st><strong class="bold"><st c="15746">Add movie</st></strong><st c="15755"> form, as shown in </st><em class="italic"><st c="15774">Figure 5</st></em><em class="italic"><st c="15782">.9</st></em><st c="15784">:</st></p>
			<div><div><img src="img/B22457_05_09.jpg" alt="Figure 5.9 – The Add movie form"/><st c="15786"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="16083">Figure 5.9 – The Add movie form</st></p>
			<p><st c="16114">Try adding a movie and hit </st><strong class="bold"><st c="16142">Save</st></strong><st c="16146">. Your movie object will be saved to the database and reflected in the admin page, as shown in </st><em class="italic"><st c="16241">Figure 5</st></em><em class="italic"><st c="16249">.10</st></em><st c="16252">:</st></p>
			<div><div><img src="img/B22457_05_10.jpg" alt="Figure 5.10 – Movies admin page"/><st c="16254"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="16399">Figure 5.10 – Movies admin page</st></p>
			<p><st c="16430">Note that the admin panel shows the movie’s information as a combination of the movie’s ID with a hyphen and the movie’s name. </st><st c="16558">That’s because we defined the </st><code><st c="16588">Movie</st></code><st c="16593"> model’s </st><code><st c="16602">__str__</st></code><st c="16609"> method to work </st><st c="16625">like that.</st></p>
			<p><st c="16635">You can also see</st><a id="_idIndexMarker184"/><st c="16652"> the movie</st><a id="_idIndexMarker185"/><st c="16662"> image in </st><code><st c="16672">/moviesstore/media/movie_images/&lt;image file&gt;.jpg</st></code><st c="16720">. </st><em class="italic"><st c="16722">Figure 5</st></em><em class="italic"><st c="16730">.11</st></em><st c="16733"> shows an image called </st><code><st c="16756">inception.jpg</st></code><st c="16769"> stored in the </st><st c="16784">previous folder:</st></p>
			<div><div><img src="img/B22457_05_11.jpg" alt="Figure 5.11 – Location of stored movie images"/><st c="16800"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="16917">Figure 5.11 – Location of stored movie images</st></p>
			<p><st c="16962">Whenever you upload a movie image, it will be stored in the previous folder. </st><st c="17040">With that, we’ve configured</st><a id="_idIndexMarker186"/><st c="17067"> our project so that it can store</st><a id="_idIndexMarker187"/><st c="17100"> and </st><st c="17105">serve images.</st></p>
			<h1 id="_idParaDest-102"><a id="_idTextAnchor107"/><st c="17118">Summary</st></h1>
			<p><st c="17126">Models are essential for working with databases in Django. </st><st c="17186">In this chapter, we learned about the fundamentals of Django models and created a </st><code><st c="17268">Movie</st></code><st c="17273"> model. </st><st c="17281">We also learned how to use the Django admin interface and how to create movies. </st><st c="17361">In the next chapter, we’ll learn how to extract and display the movies stored in our database on </st><st c="17458">our site.</st></p>
		</div>
	<div></body></html>