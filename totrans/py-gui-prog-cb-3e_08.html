<html><head></head><body><div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Internationalization and Testing</h1>
                </header>
            
            <article>
                
<p>In this chapter, we will <em>internationalize</em> our GUI by displaying text on labels, buttons, tabs, and other widgets, in different languages. We will start simply and then explore how we can prepare our GUI for internationalization at the design level.</p>
<p>We will also <em>localize</em> the GUI, which is slightly different from internationalization.</p>
<div class="packt_infobox">As these words are long, they have been abbreviated to use the first character of the word, followed by the total number of characters in between the first and last character, followed by the last character of the word. So, <strong>internationalization</strong> becomes <strong>I18N</strong>, and <strong>localization</strong> becomes <strong>L10N</strong>.</div>
<p><span>We will also test our GUI code, write unit tests, and explore the value unit tests can provide in our development efforts, which will lead us to the best practice of refactoring our code.</span></p>
<div class="packt_tip packt_infobox">There are no additional Python packages to install. We write our own code in Python and the unit testing framework is shipped with Python, so we can simply import it.</div>
<p>Knowing how to both internationalize and test our code is an essential skill every programmer needs to know. </p>
<p>In this chapter, you will acquire the valuable skills of testing, refactoring, and internationalization.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>Here is an overview of the Python modules for this chapter:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/7f041c29-7d58-4cef-9e94-ac5800a8bd3a.png" style="width:13.42em;height:19.50em;" width="188" height="273"/></div>
<p>We will internationalize and test our Python GUI, covering the following recipes:</p>
<ul>
<li>Displaying widget text in different languages</li>
<li>Changing the entire GUI language all at once</li>
<li>Localizing the GUI</li>
<li>Preparing the GUI for internationalization</li>
<li>How to design a GUI in an agile fashion</li>
<li>Do we need to test the GUI code?</li>
<li>Setting debug watches</li>
<li>Configuring different debug output levels</li>
<li>Creating self-testing code using Python's <kbd>__main__</kbd> section</li>
<li>Creating robust GUIs using unit tests</li>
<li>How to write unit tests using the Eclipse PyDev <strong>Integrated Development Environment</strong> (<strong>IDE</strong>)</li>
</ul>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Displaying widget text in different languages</h1>
                </header>
            
            <article>
                
<p>The easiest way to internationalize text strings in Python is by moving them into a separate Python module and then selecting the language to be displayed in our GUI by passing in an argument to this module.</p>
<p class="mce-root"/>
<p>While this approach, according to online search results, is not highly recommended, depending on the specific requirements of the application you are developing, it may still be the most pragmatic and fastest to implement.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>We will reuse the Python GUI we created earlier in <a href="3fc59cd5-cbab-4621-b4bb-73e359e0e8e3.xhtml">Chapter 7</a>, <em>Storing Data in Our MySQL Database via Our GUI</em>. We will comment out one line of Python code that creates the MySQL tab because we do not interact with a MySQL database in this chapter.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will start the I18N of our GUI by changing the window's title from English to another language.</p>
<p>As the name <em>GUI</em> is the same in other languages, we will first expand the name that enables us to see the visual effects of our changes. Let's now see the steps in detail:</p>
<ol>
<li>Open <kbd>GUI_MySQL.py</kbd> from the previous chapter (<a href="3fc59cd5-cbab-4621-b4bb-73e359e0e8e3.xhtml">Chapter 7</a><span>, </span><em>Storing Data in Our MySQL Database via Our GUI</em>) and save it as <kbd>GUI.py</kbd>.</li>
</ol>
<p style="padding-left: 60px">The following was our previous line of code:</p>
<pre style="padding-left: 60px">self.win.title("Python GUI")</pre>
<ol start="2">
<li>Let's change this to the following code. Also, comment out the creation of the MySQL tab:</li>
</ol>
<pre style="padding-left: 60px">self.win.title("Python Graphical User Interface")     # new window title <br/># self.mySQL = MySQL()                                # comment this line out</pre>
<ol start="3">
<li>The preceding code change results in the following title for our GUI program:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/b43f000a-c0ef-4dd7-8a05-94e08d5038b1.png" style="width:22.83em;height:4.92em;" width="362" height="78"/></p>
<p style="padding-left: 60px">Please note that, in this chapter, we will use English and German to exemplify the principle of internationalizing our Python GUI.</p>
<ol start="4">
<li>Let's create a new Python module and name it <kbd>LanguageResources.py</kbd>. Let's next move the English string of our GUI title into this module and also create a German version.</li>
<li>Add the following code:</li>
</ol>
<pre style="padding-left: 60px">class I18N(): <br/>    '''Internationalization''' <br/>    def __init__(self, language): <br/>        if    language == 'en': self.resourceLanguageEnglish() <br/>        elif  language == 'de': self.resourceLanguageGerman() <br/>        else: raise NotImplementedError('Unsupported language.') <br/><br/>    def resourceLanguageEnglish(self): <br/>        self.title = "Python Graphical User Interface" <br/><br/>    def resourceLanguageGerman(self): <br/>        self.title = 'Python Grafische Benutzeroberflaeche'</pre>
<ol start="6">
<li>Import the <kbd>I18N</kbd> class and change the language to <kbd>'de'</kbd>:</li>
</ol>
<pre style="padding-left: 60px">from Ch08_Code.LanguageResources import I18N <br/>class OOP(): <br/>    def __init__(self, language='en'):  <br/>        self.win = tk.Tk()                # Create instance <br/>        self.i18n = I18N('de')            # Select different language <br/>        self.win.title(self.i18n.title)   # Add a title using self.i18n</pre>
<ol start="7">
<li>Running the preceding code, we now get the following internationalized result:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/1791aa33-d031-499b-9a45-1dbfa640a7ff.png" style="width:28.17em;height:6.92em;" width="387" height="95"/></p>
<p><span>Let's now go behind the scenes to understand the code better.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p>Starting from s<em>tep 4</em>, we break out the hardcoded strings that are part of our GUI into their own separate module, <kbd>LanguageResources.py</kbd>. Within the class's <kbd>__init__()</kbd> method, we select which language our GUI will display, depending on the passed-in language argument. We then import the <kbd>LanguageResources.py</kbd> module into our OOP class module.</p>
<p>We set the default language to <kbd>'en'</kbd>, which means English.</p>
<p>Within <kbd>GUI.py</kbd>, we are creating an instance of the <kbd>I18N</kbd> class. This class resides in <kbd>LanguageResources.py</kbd>, so the name of our class is shorter and different to the name of the Python module. We save the selected language in a class instance attribute, <kbd>self.i18n</kbd>, and use it to display the title. We are separating the GUI from the languages it displays, which is an OOP design principle.</p>
<p>We can further modularize our code by separating the internationalized strings into separate files, potentially in XML or another format. We could also read them from a MySQL database.</p>
<p>This is a <strong>separation of concerns</strong> (<strong>SoC</strong>) coding approach, which is at the heart of OOP programming.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Changing the entire GUI language all at once</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will change all of the GUI display names, all at once, by refactoring all the previously hardcoded English strings into a separate Python module and then internationalizing those strings.</p>
<p>This recipe shows that it is a good design principle to avoid hardcoding any strings, that our GUI displays, but to separate the GUI code from the text that is displayed by the GUI.</p>
<p>Designing our GUI in a modular way makes internationalizing it much easier.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>We will continue to use the GUI from the previous recipe, <kbd>GUI.py</kbd>. In that recipe, we had already internationalized the title of the GUI. We will enhance the <kbd>LanguageResources.py</kbd> module from the previous recipe as well by adding more internationalized strings.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>In order to internationalize the text displayed in all of our GUI widgets, we have to move all hardcoded strings into a separate Python module, and this is what we'll do next:</p>
<ol>
<li>Open the <kbd>LanguageResources.py</kbd> module.</li>
<li>Add the following code for the English internationalized strings:</li>
</ol>
<pre style="padding-left: 60px">class I18N(): <br/>'''Internationalization''' <br/>    def __init__(self, language): <br/>        if   language == 'en': self.resourceLanguageEnglish() <br/>        elif language == 'de': self.resourceLanguageGerman() <br/>        else: raiseNotImplementedError('Unsupported language.') <br/><br/>    def resourceLanguageEnglish(self): <br/>        self.title = "Python Graphical User Interface" <br/><br/>        self.file  = "File" <br/>        self.new   = "New" <br/>        self.exit  = "Exit" <br/>        self.help  = "Help" <br/>        self.about = "About" <br/><br/>        self.WIDGET_LABEL = ' Widgets Frame ' <br/><br/>        self.disabled  = "Disabled" <br/>        self.unChecked = "UnChecked" <br/>        self.toggle    = "Toggle" <br/><br/>        # Radiobutton list <br/>        self.colors   = ["Blue", "Gold", "Red"] <br/>        self.colorsIn = ["in Blue", "in Gold", "in Red"] <br/><br/>        self.labelsFrame  = ' Labels within a Frame ' <br/>        self.chooseNumber = "Choose a number:" <br/>        self.label2       = "Label 2" <br/><br/>        self.mgrFiles = ' Manage Files ' <br/><br/>        self.browseTo = "Browse to File..." <br/>        self.copyTo   = "Copy File To :   "</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<ol start="3">
<li>In the Python <kbd>GUI.py</kbd> module, replace all the hardcoded strings with an instance of our new <kbd>I18N</kbd> class, for example, <kbd>self.i18n.colorsIn</kbd>:</li>
</ol>
<pre style="padding-left: 60px">from Ch08_Code.LanguageResources import I18N<br/>class OOP(): <br/>    def __init__(self, language='en'):  <br/>        self.win = tk.Tk()              # Create instance <br/>        self.i18n = I18N('de')          # Select language <br/>        self.win.title(self.i18n.title) # Add a title <br/><br/>    # Radiobutton callback function <br/>    def radCall(self): <br/>        radSel = self.radVar.get() <br/>        if   radSel == 0: self.widgetFrame.configure(text=<br/>                          self.i18n.WIDGET_LABEL + <br/>                          self.i18n.colorsIn[0]) <br/>        elif radSel == 1: self.widgetFrame.configure(text=<br/>                          self.i18n.WIDGET_LABEL + <br/>                          self.i18n.colorsIn[1]) <br/>        elif radSel == 2: self.widgetFrame.configure(text=<br/>                          self.i18n.WIDGET_LABEL + <br/>                          self.i18n.colorsIn[2])</pre>
<p style="padding-left: 60px">We can now implement the translation to German by simply filling in the variable names with the corresponding words.</p>
<ol start="4">
<li>Add the following code to <kbd>LanguageResources.py</kbd>:</li>
</ol>
<pre style="padding-left: 60px">class I18N(): <br/>    '''Internationalization''' <br/>    def __init__(self, language):       <br/>        if   language == 'en': self.resourceLanguageEnglish() <br/>        elif language == 'de': self.resourceLanguageGerman() <br/>        else: raise NotImplementedError('Unsupported language.') <br/><br/>    def resourceLanguageGerman(self): <br/>        self.file  = "Datei" <br/>        self.new   = "Neu" <br/>        self.exit  = "Schliessen" <br/>        self.help  = "Hilfe" <br/>        self.about = "Ueber" <br/><br/>        self.WIDGET_LABEL = ' Widgets Rahmen ' <br/><br/>        self.disabled  = "Deaktiviert" <br/>        self.unChecked = "Nicht Markiert" <br/>        self.toggle    = "Markieren" <br/><br/>        # Radiobutton list <br/>        self.colors   = ["Blau", "Gold", "Rot"]     <br/>        self.colorsIn = ["in Blau", "in Gold", "in Rot"]   <br/><br/>        self.labelsFrame  = ' Etiketten im Rahmen ' <br/>        self.chooseNumber = "Waehle eine Nummer:" <br/>        self.label2       = "Etikette 2" <br/><br/>        self.mgrFiles = ' Dateien Organisieren ' <br/><br/>        self.browseTo = "Waehle eine Datei... " <br/>        self.copyTo   = "Kopiere Datei zu :   "</pre>
<ol start="5">
<li>In our GUI code, we can now change the entire GUI display language in one line of Python code:</li>
</ol>
<pre style="padding-left: 60px">classOOP(): <br/>    def __init__(self, language='en'):  <br/>        self.win = tk.Tk()        # Create instance <br/>        self.i18n = I18N('de')    # Pass in language</pre>
<ol start="6">
<li>Running the preceding code creates the following internationalized GUI:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/878bc719-1be8-48da-86c6-8d1f4444aad9.png" style="width:24.75em;height:25.75em;" width="387" height="402"/></p>
<p><span>Let's now see how this recipe works!</span></p>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p>In order to internationalize our GUI, we refactored hardcoded strings into a separate module and then used the same class instance attributes to internationalize our GUI by passing in a string to the initializer of our <kbd>I18N</kbd> class, effectively controlling the language our GUI displays.</p>
<p>Note how all of the previously hardcoded English strings have been replaced by calls to the instance of our new <kbd>I18N</kbd> class. One example is <kbd>self.win.title(self.i18n.title)</kbd>.</p>
<p>What this gives us is the ability to internationalize our GUI. We simply have to use the same variable names and combine them by passing in a parameter to select the language we wish to display.</p>
<p>We could change languages on the fly as part of the GUI as well, or we could read the local PC settings and decide which language our GUI text should display according to those settings. An example of how to read the local settings is covered in the next recipe, <em>Localizing the GUI</em>.</p>
<p>Previously, every single string of every widget, including the title of our GUI, the tab control names, and so on, were all hardcoded and intermixed with the code that creates the GUI.</p>
<p>It is a good idea to think about how we can best internationalize our GUI at the design phase of our GUI software development process.</p>
<p>In this recipe, we internationalized all strings displayed in our GUI widgets. We are not internationalizing the text entered into our GUI, because this depends on the local settings on your PC.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Localizing the GUI</h1>
                </header>
            
            <article>
                
<p>After the first step of internationalizing our GUI, the next step is to <em>localize</em> it. Why would we wish to do this?</p>
<p>Well, here in the United States of America, we are all cowboys and we live in different time zones.</p>
<p>While we are internationalized to the US, our horses do wake up in different time zones (and do expect to be fed according to their own inner horse time zone schedule).</p>
<p>This is where <em>localization</em> comes in.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>We are extending the GUI we developed in the previous recipe by localizing it.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>Let's see how to perform this recipe:</p>
<ol>
<li>We start by first installing the Python <kbd>pytz</kbd> time zone module, using <kbd>pip</kbd>. </li>
<li>Next, open Command Prompt and type the following command:</li>
</ol>
<pre style="padding-left: 60px"><strong>pip install pytz</strong></pre>
<ol start="3">
<li>When the installation is successful, we get the following result:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/faed9de8-a4c7-4a82-8742-d82e0d1639ee.png" style="width:32.08em;height:12.50em;" width="531" height="207"/></p>
<ol start="4">
<li>Next, we add a new <kbd>Button</kbd> widget to <kbd>GUI.py</kbd>. We can list all the existing time zones by running the following code, which will display the time zones in our <kbd>ScrolledText</kbd> widget by adding the <kbd>allTimeZones</kbd> method as follows: </li>
</ol>
<pre style="padding-left: 60px">import pytz <br/>class OOP():  <br/>    # TZ Button callback <br/>    def allTimeZones(self): <br/>        for tz in pytz.all_timezones: <br/>            self.scr.insert(tk.INSERT, tz + '\n') <br/><br/>    def createWidgets(self): <br/>        # Adding a TZ Button <br/>        self.allTZs = ttk.Button(self.widgetFrame,  <br/>                                 text=self.i18n.timeZones,  <br/>                                 command=self.allTimeZones) <br/>        self.allTZs.grid(column=0, row=9, sticky='WE')</pre>
<p class="mce-root"/>
<ol start="5">
<li>Clicking our new <kbd>Button</kbd> widget results in the following output:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/5795c9c0-45fa-49c0-97dc-d050e45f18a3.png" style="width:26.42em;height:6.58em;" width="361" height="90"/></div>
<ol start="6">
<li>Install the <kbd>tzlocal</kbd> Python module using <kbd>pip</kbd>, and then we can display our current locale by adding the <kbd>localZone</kbd> method and connecting it to a new <kbd>Button</kbd> command:</li>
</ol>
<pre style="padding-left: 60px"># TZ Local Button callback <br/>def localZone(self):    <br/>    from tzlocal import get_localzone <br/>    self.scr.insert(tk.INSERT, get_localzone()) <br/><br/>def createWidgets(self): <br/>    # Adding local TZ Button <br/>    self.localTZ = ttk.Button(self.widgetFrame, <br/>    text=self.i18n.localZone, command=self.localZone <br/>    self.localTZ.grid(column=1, row=9, sticky='WE')</pre>
<p style="padding-left: 60px">We internationalize the strings of our two new buttons in <kbd>LanguageResources.py</kbd>.</p>
<p style="padding-left: 60px">The English version is as follows:</p>
<pre style="padding-left: 60px">self.timeZones = "All Time Zones" <br/>self.localZone = "Local Zone"</pre>
<p style="padding-left: 60px">The German version <span>is as follows</span>:</p>
<pre style="padding-left: 60px">self.timeZones = "Alle Zeitzonen" <br/>self.localZone = "Lokale Zone"</pre>
<p style="padding-left: 60px">Clicking our new button now tells us which time zone we are in (hey, we didn't know that, did we…):</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/2547fc31-bbac-4de3-986c-7947309aca10.png" style="width:24.92em;height:6.08em;" width="356" height="87"/></div>
<ol start="7">
<li>We can now change our local time to US EST by first converting it to <strong>Coordinated Universal Time</strong> (<strong>UTC</strong>) and then applying the time zone function from the imported <kbd>pytz</kbd> module. Next, add the following code to <kbd>GUI.py</kbd>:</li>
</ol>
<pre style="padding-left: 60px">import pytz <br/>class OOP(): <br/>    # Format local US time with TimeZone info <br/>    def getDateTime(self): <br/>        fmtStrZone = "%Y-%m-%d %H:%M:%S %Z%z" <br/>        # Get Coordinated Universal Time <br/>        utc = datetime.now(timezone('UTC')) <br/>        print(utc.strftime(fmtStrZone)) <br/><br/>        # Convert UTC datetime object to Los Angeles TimeZone <br/>        la = utc.astimezone(timezone('America/Los_Angeles')) <br/>        print(la.strftime(fmtStrZone)) <br/><br/>        # Convert UTC datetime object to New York TimeZone <br/>        ny = utc.astimezone(timezone('America/New_York')) <br/>        print(ny.strftime(fmtStrZone)) <br/><br/>        # update GUI label with NY Time and Zone <br/>        self.lbl2.set(ny.strftime(fmtStrZone))        # &lt;-- set Label 2</pre>
<ol start="8">
<li>Clicking the button, now renamed as <span class="packt_screen">New York</span>, results in the following output in label 2 in the top-<span>left</span> corner of the GUI:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/7a32db2f-5e9e-4857-88f4-6c09206c8dc0.png" style="width:22.08em;height:9.00em;" width="361" height="147"/></div>
<ol start="9">
<li>Notice the following output in the console:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/6db51bd4-1ec8-4e0f-aec2-6dd2f658d0c8.png" style="width:14.75em;height:7.00em;" width="213" height="101"/></div>
<p><span>Let's learn about this recipe in the next section.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p>First, we installed the Python <kbd>pytz</kbd> module using <kbd>pip</kbd>.</p>
<div class="packt_tip">In this book, we are using Python 3.7, which comes with the <kbd>pip</kbd> module built in. If you are using an older version of Python, then you may have to install the <kbd>pip</kbd> module first.</div>
<p>The screenshot in s<em>tep 2</em> shows that the <kbd>pip</kbd> command downloaded the <kbd>.whl</kbd> format. If you have not done so, you might have to install the Python wheel module as well.</p>
<p>This installed the Python <kbd>pytz</kbd> module into the <kbd>site-packages</kbd> folder, so now we can import this module from our Python GUI code.</p>
<p>In order to localize date and time information, we first need to convert our local time to UTC time. We then apply the time zone information and use the <kbd>astimezone</kbd> function from the <kbd>pytz</kbd> Python time zone module to convert to any time zone across the globe!</p>
<p>We installed the Python <kbd>tzlocal</kbd> module using <kbd>pip</kbd>, and now we can translate our local time to a different time zone. We used US EST as an example.</p>
<p>In s<em>tep 8</em>, we converted the local time of the US west coast to UTC and then displayed the US east coast time in label 2 (<kbd>self.lbl2</kbd>) of our GUI.</p>
<p>At the same time, we are printing the UTC times of the cities Los Angeles and New York with their respective time zone conversions, relative to the UTC time to the console, using a US date formatting string.</p>
<div class="packt_infobox">UTC never observes <strong>Daylight Saving Time</strong> (<strong>DST</strong>). During <strong>Eastern Daylight Time</strong> (<strong>EDT</strong>), UTC is four hours ahead and, during standard time (EST), it is five hours ahead of the local time.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Preparing the GUI for internationalization</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will prepare our GUI for internationalization by realizing that not all is as easy as could be expected when translating English into foreign languages.</p>
<p class="mce-root"/>
<p>We still have one problem to solve, which is how to properly display non-English Unicode characters from foreign languages.</p>
<p>You might expect that displaying the German ä, ö, and ü Unicode umlaut characters would be handled by Python 3.7 automatically, but this is not the case.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>We will continue to use the Python GUI we developed in recent chapters. First, we will change the default language to German in the <kbd>GUI.py</kbd> initialization code.</p>
<p>This recipe might be specific to the Eclipse PyDev IDE, but it is good to see this as an example.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>Before diving deep into the recipe, we should know that when we change the word "Ueber" to the correct German word "Űber" using the umlaut character, the Eclipse PyDev plugin is not too happy.</p>
<p>Let's now see the steps of this recipe sequentially:</p>
<ol>
<li>Open <kbd>GUI.py</kbd>.</li>
<li>Uncomment the line <kbd>self.i18n = I18N('de')</kbd> in order to use German.</li>
<li>Run <kbd>GUI.py</kbd>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/7db6e6a2-67d4-481d-be0b-cd12f02cdda0.png" style="width:37.42em;height:16.00em;" width="547" height="234"/></div>
<ol start="4">
<li>We get an error message, which is a little bit confusing because, when we run the same line of code from within the Eclipse <span class="packt_screen">PyDev Console</span>, we get the expected result:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/0ce0803b-2443-428a-9e4a-71e4e96dacdc.png" style="width:13.92em;height:6.83em;" width="201" height="99"/></div>
<ol start="5">
<li>When we ask for the Python default encoding, we get the expected result, which is <span class="packt_screen">utf-8</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/9b0b1388-5f90-4bb9-9d76-29ca5c88d6bf.png" style="width:16.33em;height:10.08em;" width="292" height="181"/></div>
<ol start="6">
<li>Using Windows built-in character map, we can find the Unicode representation of the umlaut character, which is <strong>U+00DC</strong> for the capital <strong>U</strong> with an umlaut:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/5dcb6c70-1228-4ae2-bac5-a78a1a9dfa3b.png" style="width:24.58em;height:21.17em;" width="473" height="407"/></p>
<p class="mce-root"/>
<p class="mce-root"/>
<ol start="7">
<li>While this workaround is truly ugly, it does the trick. Instead of typing in the literal character <strong>Ü</strong>, we can pass in the Unicode of <strong>U+00DC</strong> to get this character correctly displayed in our GUI:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/6ee94ee9-f13a-4c38-93c1-f9aba869c65a.png" style="width:18.42em;height:9.83em;" width="255" height="136"/></div>
<ol start="8">
<li>We can also just accept the change in the default encoding from Cp1252 to UTF-8 using PyDev with Eclipse, but we may not always get the prompt to do so.</li>
</ol>
<p style="padding-left: 60px">Instead, we might see the following error message displayed:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/a4a6bd90-76d4-4a73-98c1-b77a931e44b1.png" style="width:24.00em;height:9.25em;" width="424" height="163"/></p>
<ol start="9">
<li>The way to solve this problem is to change the PyDev project's <span class="packt_screen">Text file encoding</span> setting to <span class="packt_screen">UTF-8</span>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/c39c62ca-7cdc-42df-adc0-78147a745aab.png" style="width:53.67em;height:28.42em;" width="817" height="433"/></div>
<ol start="10">
<li>After changing the PyDev default encoding, we now can display those German umlaut characters. We also updated the title to use the correct German ä character, <kbd>GUI_.py</kbd>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/15aac6be-ccc7-49ac-9ca3-77f0240eb7ca.png" style="width:27.00em;height:10.25em;" width="400" height="152"/></div>
<p><span>Let's now go behind the scenes to understand the code better.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p>Internationalization and working with foreign language Unicode characters is often not as straightforward as we would wish.</p>
<p>Sometimes, we have to find workarounds, and expressing Unicode characters via Python by using the direct representation by prepending <kbd>\u</kbd> can do the trick.</p>
<p>The Windows built-in character map shows us <kbd>"U+00DC"</kbd>, which we translate into Python as <kbd>"\u00DC"</kbd>.</p>
<p>We can always resort to the direct representation of Unicode.</p>
<p>At other times, we just have to find the settings of our development environment to adjust. We saw an example of how to do this using the Eclipse IDE.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to design a GUI in an agile fashion</h1>
                </header>
            
            <article>
                
<p>The modern agile software development approach to design and coding came out of the lessons learned by software professionals. This method applies to a GUI as much as to any other code. One of the main keys of agile software development is the continuously applied process of refactoring.</p>
<p>One practical example of how refactoring our code can help us in our software development work is by first implementing some simple functionality using functions.</p>
<p>As our code grows in complexity, we might want to refactor our functions into methods of a class. This approach would enable us to remove global variables and also to be more flexible about where we place the methods inside the class.</p>
<p>While the functionality of our code has not changed, the structure has.</p>
<p>In this process, we code, test, refactor, and then test again. We do this in short cycles and often start with the minimum code required to get some functionality to work.</p>
<div class="packt_infobox">Test-driven software development is one particular style of the agile development methodology.</div>
<p>While our GUI is working nicely, our main <kbd>GUI.py</kbd> code has been ever-increasing in complexity, and it has started to get a little bit harder to maintain an overview of our code. This means that we need to refactor our code.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>We will refactor the GUI we created in previous chapters. We will use the English version of the GUI.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>We have already broken out all the names our GUI displays when we internationalized it in the previous recipe. That was an excellent start to refactoring our code:</p>
<ol>
<li>Let's rename our <kbd>GUI.py</kbd> file as <kbd>GUI_Refactored.py</kbd>.</li>
<li>Group the <kbd>import</kbd> statements as follows:</li>
</ol>
<pre style="padding-left: 60px">#====================== <br/># imports <br/>#====================== <br/>import tkinter as tk <br/>from tkinter import ttk, scrolledtext, Menu, Spinbox, filedialog as fd, messagebox as mBox<br/>from queue import Queue <br/>from os import path  <br/>from Ch08_Code.ToolTip import ToolTip <br/>from Ch08_Code.LanguageResources import I18N<br/>from Ch08_Code.Logger import Logger, LogLevel <br/><br/># Module level GLOBALS <br/>GLOBAL_CONST = 42</pre>
<p style="padding-left: 60px">We can refactor our code <span>further </span>by breaking out the callback methods into their own module.</p>
<ol start="3">
<li>Create a new module, <kbd>Callbacks_Refactored.py</kbd>.</li>
<li>In <kbd>GUI_Refactored.py</kbd>, import the <kbd>Callbacks</kbd> class.</li>
<li>In <kbd>Callbacks_Refactored.py</kbd>, add <kbd>self.callBacks = Callbacks(self)</kbd>:</li>
</ol>
<pre style="padding-left: 60px">#====================== <br/># imports <br/>#====================== <br/>import tkinter as tk <br/>from tkinter import ttk, scrolledtext, Menu, Spinbox, <br/>                    filedialog as fd, messagebox as mBox <br/>from queue import Queue <br/>from os import path  <br/>import Ch08_Code.ToolTip as tt <br/>from Ch08_Code.LanguageResources import I18N <br/>from Ch08_Code.Logger import Logger, LogLevel<br/>from Ch08_Code.Callbacks_Refactored import Callbacks     # &lt;-- import the class<br/><br/># Module level GLOBALS <br/>GLOBAL_CONST = 42 <br/><br/>class OOP(): <br/>    def __init__(self):  <br/>        # Callback methods now in different module <br/>        self.callBacks = Callbacks(self)                 # &lt;-- pass in self</pre>
<ol start="6">
<li>Add the following code to the <kbd>Callbacks</kbd> class:</li>
</ol>
<pre style="padding-left: 60px">#====================== <br/># imports <br/>#====================== <br/>import tkinter as tk <br/>from time import sleep <br/>from threading import Thread <br/>from pytz import all_timezones, timezone <br/>from datetime import datetime <br/><br/>class Callbacks(): <br/>    def __init__(self, oop): <br/>        self.oop = oop <br/><br/>    def defaultFileEntries(self):  <br/>        self.oop.fileEntry.delete(0, tk.END) <br/>        self.oop.fileEntry.insert(0, 'Z:')          # bogus path <br/>        self.oop.fileEntry.config(state='readonly')          <br/>        self.oop.netwEntry.delete(0, tk.END) <br/>        self.oop.netwEntry.insert(0, 'Z:Backup')    # bogus path <br/><br/>    # Combobox callback  <br/>    def _combo(self, val=0): <br/>        value = self.oop.combo.get() <br/>        self.oop.scr.insert(tk.INSERT, value + '\n')<br/><br/>    ...</pre>
<p>Let's now see how this recipe works!</p>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p>We have first improved the readability of our code by grouping the related <kbd>import</kbd> statements. </p>
<p>By simply grouping related imports, we can reduce the number of lines of code, which improves the readability of our imports, making them appear less overwhelming.</p>
<p>We next broke out the callback methods into their own class and module, <kbd><span>Callbacks_Refactored.py</span></kbd>, in order to reduce the complexity of our code <span>further</span>.</p>
<p>In the initializer of our new class, the passed-in GUI instance is saved under the name <kbd>self.oop</kbd> and used throughout this new Python class module.</p>
<p>Running the refactored GUI code still works as before. We have only increased its readability and reduced the complexity of our code in preparation for further development work.</p>
<p>We had already taken the same OOP approach by having the <kbd>ToolTip</kbd> class reside in its own module, and by internationalizing all GUI strings in the previous recipes. In this recipe, we went one step further in refactoring by passing our own instance into the callback method's class that our GUI relies upon. This enables us to use all of our GUI widgets.</p>
<p>Now that we better understand the value of a modular approach to software development, we will most likely start with this approach in our future software designs.</p>
<div class="packt_infobox">Refactoring is the process of improving the structure, readability, and maintainability of the existing code. We are not adding new functionality.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Do we need to test the GUI code?</h1>
                </header>
            
            <article>
                
<p>Testing our software is an important activity during the coding phase as well as when releasing service packs or bug fixes.</p>
<p>There are different levels of testing. The first level is developer testing, which often starts with the compiler or interpreter not letting us run buggy code, forcing us to test small parts of our code on the level of individual methods.</p>
<p>This is the first level of defense.</p>
<p class="mce-root"/>
<p>A second level of coding defensively is when our source code control system tells us about some conflicts to be resolved and does not let us check our modified code.</p>
<p>This is very useful and absolutely necessary when we work professionally in a team of developers. The source code control system is our friend and points out changes that have been committed to a particular branch or top-of-tree, either by ourselves or by our other developers, and tells us that our local version of the code is both outdated and has some conflicts that need to be resolved before we can submit our code to the repository.</p>
<p>This part assumes you use a source control system to manage and store your code. Examples include Git, Mercurial, SVN, and several others. Git is a very popular source control.</p>
<p>A third level is the level of APIs where we encapsulate potential future changes to our code by only allowing interactions with our code via published interfaces.</p>
<p>Another level of testing is integration testing, when half of the bridge we built meets the other half that the other development teams created, and the two don't meet at the same height (say, one half ended up two meters or yards higher than the other half…).</p>
<p>Then, there is end user testing. While we built what they specified, it is not really what they wanted.</p>
<p>All of the preceding examples are valid reasons why we need to test our code both in the design and implementation stages.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>We will test the GUI we created in recent recipes and chapters. We will also show some simple examples of what can go wrong and why we need to keep testing our code and the code we call via APIs.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>Let's examine this recipe in detail.</p>
<p>In Python GUI programming, one of the first things that can go wrong is missing out on importing required modules.</p>
<p class="mce-root"/>
<p>Here is a simple example:</p>
<ol>
<li>Open <kbd>GUI.py</kbd> and comment out the <kbd>import</kbd> statement, <kbd># import tkinter as tk</kbd>.</li>
<li>Run the code and observe the following output:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/ef061b3b-a6e6-49ee-9486-aff6b7eeaf07.png" style="width:18.33em;height:14.58em;" width="362" height="287"/></div>
<ol start="3">
<li>Add the <kbd>import</kbd> statement to the top to solve this error as follows:</li>
</ol>
<pre style="padding-left: 60px">#====================== <br/># imports <br/>#====================== <br/>import tkinter as tk</pre>
<p style="padding-left: 60px">Using an example from <a href="3fc59cd5-cbab-4621-b4bb-73e359e0e8e3.xhtml" target="_blank">Chapter 7</a>, <em>Storing Data in Our MySQL Database via Our GUI</em>, let's say we click on the <span class="packt_screen">Get Quotes</span> button and this works, but we never clicked on the <span class="packt_screen">Mody Quote</span> button. </p>
<ol start="4">
<li>Open <kbd>GUI_MySQL.py</kbd> from <a href="3fc59cd5-cbab-4621-b4bb-73e359e0e8e3.xhtml" target="_blank">Chapter 7</a>, <em>Storing Data in Our MySQL Database via Our GUI</em>, and click the <span class="packt_screen">Get Quotes</span> button:</li>
</ol>
<p class="CDPAlignCenter CDPAlign"><img src="Images/36c264a3-7561-4544-b478-260530dc6ade.png" style="width:20.75em;height:9.67em;" width="366" height="171"/></p>
<ol start="5">
<li>Next, click the <span class="packt_screen">Mody Quote</span> button, which creates the following result:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/a0ebc989-3aac-4a8b-a7f4-9a4196474431.png" style="width:51.75em;height:8.42em;" width="735" height="119"/></div>
<ol start="6">
<li>Another potential area of bugs is when a function or method suddenly no longer returns the expected result. Let's say we are calling the following function, which returns the expected result:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/5c8cfb57-70b5-4350-805c-8a100d9024ef.png" style="width:14.08em;height:10.25em;" width="255" height="186"/></div>
<ol start="7">
<li>Then, someone makes a mistake, and we no longer get the previous results.</li>
</ol>
<p style="padding-left: 60px">Change <kbd>(num * num)</kbd> to <span><kbd>(num ** num)</kbd> and run the code:</span></p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/24a26109-43d2-4c0c-8a3f-0f93d7f55f83.png" style="width:18.25em;height:14.00em;" width="255" height="196"/></div>
<p><span>Let's now go behind the scenes to understand the code better.</span></p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p>First, in <em>Steps 1</em> and <em>2</em>, we are trying to create an instance of the <kbd>tkinter</kbd> class, but things don't work as expected.</p>
<p>Well, we simply forgot to import the module and alias it as <kbd>tk</kbd>, and we can fix this by adding a line of Python code above our class creation, where the <kbd>import</kbd> statements live.</p>
<p>This is an example in which our development environment does the testing for us. We just have to do the debugging and code fixing.</p>
<p>Another example more closely related to developer testing is when we code conditionals and, during our regular development, do not exercise all branches of logic.</p>
<p><span>To demonstrate this, in <em>Steps 4</em> and <em>5</em>, we use an example from </span><a href="3fc59cd5-cbab-4621-b4bb-73e359e0e8e3.xhtml" target="_blank">Chapter 7</a><span>, <em>Storing Data in Our MySQL Database via Our GUI</em>. We click on the</span> <span class="packt_screen">Get Quotes</span> <span>button and this works, but we never clicked on the</span> <span class="packt_screen">Mody Quote</span> <span>button. The first button click creates the desired result, but the second throws an exception (because we had not yet implemented this code and probably forgot all about it).</span></p>
<p>In the next example, in <em>Steps 6</em> and <em>7</em>, instead of multiplying, we are exponentially raising by the power of the passed-in number, and the result is no longer what it used to be.</p>
<div class="packt_infobox">In software testing, this sort of bug is called <strong>regression</strong>.</div>
<p>Whenever something goes wrong in our code, we have to debug it. The first step of doing this is to set breakpoints and then step through our code, line by line, or method by method.</p>
<p>Stepping in and out of our code is a daily activity until the code runs smoothly.</p>
<p>In this recipe, we emphasized the importance of software testing during several phases of the software development life cycle by showing several examples of where the code can go wrong and introduce software defects (also known as bugs).</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Setting debug watches</h1>
                </header>
            
            <article>
                
<p>In modern IDEs, such as the PyDev plugin in Eclipse, or other IDEs such as NetBeans, we can set debug watches to monitor the state of our GUI during the execution of our code.</p>
<p>This is very similar to the Microsoft IDEs of Visual Studio and the more recent versions of Visual Studio .NET.</p>
<div class="packt_tip">Setting debug watches is a very convenient way to help our development efforts.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will reuse the Python GUI we developed in the earlier recipes. We will step through the code we had developed <span>previously</span>, and we will set debug watches.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>While this recipe applies to the PyDev plugin in the Java-based Eclipse IDE, its principles also apply to many modern IDEs.</p>
<p>Let's now see how we can sequentially proceed with this recipe:</p>
<ol>
<li>Open <kbd>GUI.py</kbd> and place a breakpoint at the line with <kbd>mainloop</kbd>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/e5fe093c-7710-4210-afcb-ca5ff2c47bdf.png" style="width:15.08em;height:7.00em;" width="213" height="99"/></div>
<ol start="2">
<li>Start a debug session as follows:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/79046081-8c6a-4c1f-a889-8993f5473f7a.png" style="width:35.92em;height:30.00em;" width="557" height="466"/></div>
<p style="padding-left: 60px">Let's place a breakpoint at the <span class="packt_screen">New York</span> button callback method, which we named <kbd>getDateTime</kbd>.</p>
<ol start="3">
<li>Open <kbd>Callbacks_Refactored.py</kbd> and place a breakpoint at the <span><kbd>getDateTime</kbd> method.</span></li>
</ol>
<ol start="4">
<li>Step through the code:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/fd64e5c5-4043-4804-b9c0-f7ca8163503a.png" style="width:30.50em;height:33.75em;" width="473" height="523"/></div>
<p><span>Let's now go behind the scenes to understand the code better.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p>The first position where we might wish to place a breakpoint is at the place where we make our GUI visible by calling the <kbd>tkinter</kbd> main event loop. We do this in <em>step 1</em>.</p>
<p>The green balloon symbol on the left is a breakpoint in PyDev/Eclipse. When we execute our code in debug mode, the execution of the code will be halted once the execution reaches the breakpoint. At this point, we can see the values of all the variables that are currently in scope. We can also type expressions into one of the debugger windows, which will execute them, showing us the results. If the result is what we want, we might decide to change our code using what we have just learned.</p>
<p class="mce-root"/>
<p>We normally step through the code by either clicking an icon in the toolbar of our IDE, or by using a keyboard shortcut (such as pressing <em>F5</em> to step into code, <em>F6</em> to step over, and <em>F7</em> to step out of the current method).</p>
<p><span>Placing the breakpoint where we did and then stepping into this code turns out to be a problem because we end up in some low-level <kbd>tkinter</kbd> code we really do not wish to debug right now. We get out of this low-level <kbd>tkinter</kbd> code by clicking the Step-Out toolbar icon (which is the third yellow arrow on the right beneath the project menu) or by pressing <em>F7</em> (assuming we are using PyDev in Eclipse).</span></p>
<p>A better idea is to place our breakpoint closer to our own code in order to watch the values of some of our own Python variables. In the event-driven world of modern GUIs, we have to place our breakpoints at code that gets invoked during events, for example, button clicks. We do this in <em>Steps 3</em> and <em>4</em>.</p>
<p>Currently, one of our main functionalities resides in a button click event. When we click the button labelled <span class="packt_screen">New York</span>, we create an event, which then results in something happening in our GUI.</p>
<div class="packt_tip"><span>If you are interested in learning how to install Eclipse with the PyDev plugin for Python, there is a great tutorial that will get you started with installing all the necessary free software and then introduce you to PyDev within Eclipse by creating a simple, working Python program: </span><a href="http://www.vogella.com/tutorials/Python/article.html">http://www.vogella.com/tutorials/Python/article.html</a>.</div>
<p>We use modern IDEs in the 21<sup>st</sup> century that are freely available to help us to create solid code.</p>
<p>This recipe showed how to set debug watches, which is a fundamental tool in every developer's skill set. Stepping through our own code even when not hunting down bugs ensures that we understand our code, and it can lead to improving our code via refactoring.</p>
<div class="packt_infobox">Debug watches help us to create solid code and this is not a waste of time.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Configuring different debug output levels</h1>
                </header>
            
            <article>
                
<p>In this recipe, we will configure different debug levels, which we can select and change at runtime. This allows us to control how much we want to drill down into our code when debugging our code.</p>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mceNonEditable"/>
<p>We will create two new Python classes and place both of them in the same module.</p>
<p>We will use four different logging levels and write our debugging output to a log file that we will create. If the logs folder does not exist, we will create it automatically as well.</p>
<p>The name of the log file is the name of the executing script, which is our refactored <kbd>GUI_Refactored.py</kbd>. We can also choose other names for our log files by passing in the full path to the initializer of our <kbd>Logger</kbd> class.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>We will continue using our refactored <kbd><span>GUI_Refactored.py</span></kbd> code from the previous recipe.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>Let's see how we shall proceed with this recipe:</p>
<ol>
<li>First, we create a new Python module into which we place two new classes. The first class is very simple and defines the logging levels. This is basically an enumeration. </li>
<li>Create a new module and name it<kbd> Logger.py</kbd>.</li>
<li>Add the code as follows:</li>
</ol>
<pre style="padding-left: 60px">class LogLevel: <br/>'''Define logging levels.''' <br/>    OFF     = 0 <br/>    MINIMUM = 1 <br/>    NORMAL  = 2 <br/>    DEBUG   = 3</pre>
<ol start="4">
<li>Add the second class to the same module, <kbd><span>Logger.py</span></kbd>:</li>
</ol>
<pre style="padding-left: 60px">import os, time<br/>from datetime import datetime<br/>class Logger:    <br/>    ''' Create a test log and write to it. '''      <br/>    #------------------------------------------------------- <br/>    def __init__(self, fullTestName, loglevel=LogLevel.DEBUG): <br/>        testName = os.path.splitext(os.path.basename(fullTestName))[0] <br/>        logName  = testName  + '.log'     <br/><br/>        logsFolder = 'logs'           <br/>        if not os.path.exists(logsFolder):                      <br/>            os.makedirs(logsFolder, exist_ok = True) <br/><br/>        self.log = os.path.join(logsFolder, logName)            <br/>        self.createLog() <br/><br/>        self.loggingLevel = loglevel <br/>        self.startTime    = time.perf_counter() <br/><br/>    #------------------------------------------------------ <br/>    def createLog(self):     <br/>        with open(self.log, mode='w', encoding='utf-8') as logFile: <br/>            logFile.write(self.getDateTime() +  <br/>                          '\t\t*** Starting Test ***\n') <br/>        logFile.close()</pre>
<ol start="5">
<li>Add the <kbd>writeToLog</kbd> method shown here:</li>
</ol>
<pre style="padding-left: 60px">#------------------------------------------------------ <br/>def writeToLog(self, msg='', loglevel=LogLevel.DEBUG):  <br/>    # control how much gets logged <br/>    if loglevel &gt; self.loggingLevel: <br/>        return <br/><br/>    # open log file in append mode  <br/>    with open(self.log, mode='a', encoding='utf-8') as logFile: <br/>        msg = str(msg) <br/>        if msg.startswith('\n'): <br/>            msg = msg[1:] <br/>        logFile.write(self.getDateTime() + '\t\t' + msg + '\n') <br/><br/>    logFile.close()</pre>
<ol start="6">
<li>Open <span><kbd>GUI_Refactored.py</kbd> and add this code:</span></li>
</ol>
<pre style="padding-left: 60px">from os import path  <br/>from Ch08_Code.Logger import Logger <br/>class OOP(): <br/>    def __init__(self):  <br/>        # create Logger instance <br/>        fullPath = path.realpath(__file__) <br/>        self.log = Logger(fullPath) <br/>        print(self.log)</pre>
<ol start="7">
<li>Run the code and observe the output:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/61cfa7f8-2617-40b1-bce0-fb02af08d67a.png" style="width:27.17em;height:11.17em;" width="443" height="182"/></div>
<p style="padding-left: 60px">The preceding screenshot shows that we created an instance of our new <kbd>Logger</kbd> class, and the following screenshot shows that both the <kbd>logs</kbd> folder as well as the log were created:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/f5ac420f-fde0-4cbb-8c34-94abb206c96b.png" style="width:15.75em;height:5.25em;" width="225" height="75"/></div>
<ol start="8">
<li>Finally, open the log file:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/c2656814-1745-4a41-9555-433d45025c8b.png" style="width:23.75em;height:4.33em;" width="345" height="63"/></div>
<p><span>Let's now go behind the scenes to understand the code better.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p>We first created a new module and used a simple class as an enumeration.</p>
<p><span>The second class creates a log file by using the passed-in full path of the filename and places this into a logs folder. On the first run, the logs folder might not exist, so the code automatically creates the folder.</span></p>
<p>In order to write to our log file, we use the <kbd>writeToLog</kbd> method. Inside the method, the first thing we do is check whether the message has a logging level higher than the limit we set our desired logging output to. If the message has a lower level, we discard it and immediately return from the method.</p>
<p class="mce-root"/>
<p>If the message has the logging level that we want to display, we then check whether it starts with a newline character, and, if it does, we discard the newline by slicing the method starting at index 1, using Python's slice operator (<kbd>msg = msg[1:]</kbd>).</p>
<p>We then write one line to our log file, consisting of the current date timestamp, two tab spaces, our message, and ending in a newline character.</p>
<p><span>We can now import our new Python module and, inside the <kbd>__init__</kbd> section of our GUI code, we create an instance of the <kbd>Logger</kbd> class.</span></p>
<p><span>We are retrieving the full path to our running GUI script via <kbd>path.realpath(__file__)</kbd> and passing this into the initializer of the <kbd>Logger</kbd> class. If the logs folder does not exist, it will automatically be created by our Python code.</span></p>
<p>We then verify that the log and folder got created.</p>
<p>In this recipe, we created our own logging class. While Python ships with a logging module, it is very easy to create our own, which gives us absolute control over our logging format. This is very useful when we combine our own logging output with MS Excel or <kbd>Matplotlib</kbd>, which we explored in the recipes of a previous chapter.</p>
<p>In the next recipe, we will use Python's built-in <kbd>__main__</kbd> functionality to use the four different logging levels we just created.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Creating self-testing code using Python's __main__ section</h1>
                </header>
            
            <article>
                
<p>Python comes with a very nice feature that enables each module to self-test. Making use of this feature is a great way of making sure that the changes to our code do not break the existing code and, additionally, the <kbd>__main__</kbd> self-testing section can serve as documentation for how each module works.</p>
<p>After a few months or years, we sometimes forget what our code is doing, so having an explanation written in the code itself is indeed of great benefit.</p>
<p>It is a good idea to always add a self-testing section to every Python module, when possible. It is sometimes not possible but, in most modules, it is possible to do so.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>We will extend the previous recipe, so in order to understand what the code in this recipe is doing, we have to first read and understand the code of the previous recipe.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>Let's see the steps of this recipe in detail:</p>
<ol start="1">
<li>First, we will explore the power of the Python <kbd>__main__</kbd> self-testing section by adding this self-testing section to our <kbd>LanguageResources.py</kbd> module. </li>
<li>Next, add the following code to <kbd><span>LanguageResources.py</span></kbd>:</li>
</ol>
<pre style="padding-left: 60px">if __name__ == '__main__': <br/>    language = 'en' <br/>    inst = I18N(language) <br/>    print(inst.title) <br/><br/>    language = 'de' <br/>    inst = I18N(language) <br/>    print(inst.title)</pre>
<ol start="3">
<li>Run the code and observe the output:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/b8d5a812-edab-4520-be62-1dd363cf1d02.png" style="width:27.33em;height:17.50em;" width="443" height="284"/></div>
<ol start="4">
<li>Add a <kbd>__main__</kbd> self-testing section to the <kbd>GUI_Refactored.py</kbd> module and run the code to see the following output:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/59dc1e7c-82f4-4aa0-af2a-3e510c192972.png" style="width:26.42em;height:16.67em;" width="393" height="249"/></div>
<ol start="5">
<li>Next, in t<span>he </span><kbd>GUI_Refactored.py</kbd><span> module, a</span>dd <kbd>oop.log.writeToLog('Test message')</kbd>:</li>
</ol>
<pre style="padding-left: 60px">if __name__ == '__main__': <br/>#====================== <br/># Start GUI <br/>#====================== <br/>    oop = OOP() <br/>    print(oop.log) <br/>    oop.log.writeToLog('Test message') <br/>    oop.win.mainloop()</pre>
<p style="padding-left: 60px">This gets written to our log file, as can be seen in the following screenshot of the log:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/b02b6fe6-f6f4-4d1f-90b7-a3243d3bdf2f.png" style="width:20.83em;height:4.92em;" width="360" height="85"/></div>
<ol start="6">
<li>In <kbd>GUI_Refactored.py</kbd>, import both new classes from our <kbd>Logger</kbd> module:</li>
</ol>
<pre style="padding-left: 60px">from Ch08_Code.Logger import Logger, LogLevel</pre>
<ol start="7">
<li>Next, create local instances of those classes:</li>
</ol>
<pre style="padding-left: 60px"># create Logger instance <br/>fullPath = path.realpath(__file__) <br/>self.log = Logger(fullPath) <br/><br/># create Log Level instance <br/>self.level = LogLevel()</pre>
<ol start="8">
<li>Use different logging levels via <kbd>self.oop.level</kbd>:</li>
</ol>
<pre style="padding-left: 60px"># Format local US time with TimeZone info <br/>def getDateTime(self): <br/>    fmtStrZone = "%Y-%m-%d %H:%M:%S %Z%z" <br/>    # Get Coordinated Universal Time <br/>    utc = datetime.now(timezone('UTC')) <br/>    self.oop.log.writeToLog(utc.strftime(fmtStrZone),  <br/>    self.oop.level.MINIMUM) <br/><br/>    # Convert UTC datetime object to Los Angeles TimeZone <br/>    la = utc.astimezone(timezone('America/Los_Angeles')) <br/>    self.oop.log.writeToLog(la.strftime(fmtStrZone),  <br/>    self.oop.level.NORMAL) <br/><br/>    # Convert UTC datetime object to New York TimeZone <br/>    ny = utc.astimezone(timezone('America/New_York')) <br/>    self.oop.log.writeToLog(ny.strftime(fmtStrZone),  <br/>    self.oop.level.DEBUG) <br/><br/>    # update GUI label with NY Time and Zone <br/>    self.oop.lbl2.set(ny.strftime(fmtStrZone))</pre>
<ol start="9">
<li>Run the code and open the log:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/df842b27-68f8-4b4b-9f93-77ac20c8fdf4.png" style="width:26.67em;height:7.58em;" width="419" height="119"/></div>
<p style="padding-left: 60px"><span>Notice the </span><span><kbd>setLoggingLevel</kbd> method of the <kbd>Logger</kbd> class:</span></p>
<pre style="padding-left: 60px">#------------------------------------------------------------------ <br/>def setLoggingLevel(self, level):   <br/>    '''change logging level in the middle of a test.'''  <br/>    self.loggingLevel = level</pre>
<p class="mce-root"/>
<p class="mce-root"/>
<p class="mce-root"/>
<ol start="10">
<li>In the <kbd>__main__</kbd> section of our GUI, change the logging level to <kbd>MINIMUM</kbd>:</li>
</ol>
<pre style="padding-left: 60px">if __name__ == '__main__': <br/>#====================== <br/># Start GUI <br/>#====================== <br/>oop = OOP() <br/>    oop.log.setLoggingLevel(oop.level.MINIMUM) <br/>    oop.log.writeToLog('Test message') <br/>    oop.win.mainloop()</pre>
<ol start="11">
<li>Open the log file:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/28cc8eb5-64e3-4ec3-a767-9f87b112011f.png" style="width:25.50em;height:5.33em;" width="407" height="85"/></div>
<p><span>Let's now go behind the scenes to understand the code better.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p>We start by adding a <span><kbd>__main__</kbd> self-testing section to <kbd>LanguageResources.py</kbd>.</span></p>
<p>Whenever we run a module that has this self-testing section located at the bottom of the module, when the module is executed by itself, this code will run.</p>
<p>When the module is imported and used from other modules, the code in the <kbd>__main__</kbd> self-testing section will not be executed.</p>
<p>We first pass English as the language to be displayed in our GUI, and then we pass German as the language our GUI will display.</p>
<p>We print out the title of our GUI to show that our Python module works as we intended it to work.</p>
<p>The next step is to use our logging capabilities, which we created in the previous recipe.</p>
<p><span>We add a <kbd>__main__</kbd> self-testing section to <kbd>GUI_Refactored.py</kbd> and then verify that we created an instance of our <kbd>Logger</kbd> class.</span></p>
<p class="mce-root"/>
<p class="mce-root"/>
<p><span>We next write to our log file by using the command shown. We have designed our logging level to default to log every message, which is the <kbd>DEBUG</kbd> level, and, because of this, we do not have to change anything. We just pass the message to be logged to the <kbd>writeToLog</kbd> method.</span></p>
<p>Now, we can control the logging by adding logging levels to our logging statements and setting the level we wish to output. We add this capability to our <span class="packt_screen">New York</span> button callback method in the <kbd>Callbacks_Refactored.py</kbd> module, which is the <kbd>getDateTime</kbd> method.</p>
<p>We change the previous print statements to log statements using different debug levels.</p>
<p><span>As we are passing an instance of the GUI class to the <kbd>Callbacks_Refactored.py</kbd> initializer, we can use logging level constraints according to the <kbd>LogLevel</kbd> class we created.</span></p>
<p><span>When we now click our <span class="packt_screen">New York</span> button, depending upon the logging level selected, we get different output written to our log file. The default logging level is <kbd>DEBUG</kbd>, which means that everything gets written to our log.</span></p>
<p>When we change the logging level, we control what gets written to our log. We do this by calling the <kbd>setLoggingLevel</kbd> method of the <kbd>Logger</kbd> class.</p>
<p><span>Setting the level to <kbd>MINIMUM</kbd> results in a reduced output written to our log file.</span></p>
<p><span>Now, our log file no longer shows the test message and only shows messages that meet the set logging level.</span></p>
<p>In this recipe, we made good use of Python's built-in <kbd>__main__</kbd> self-testing section. We introduced our own logging file and, at the same time, learned how to create different logging levels. By doing this, we have full control over what gets written to our log files.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Creating robust GUIs using unit tests</h1>
                </header>
            
            <article>
                
<p>Python comes with a built-in unit testing framework and, in this recipe, we will start using this framework to test our Python GUI code.</p>
<p>Before we start writing unit tests, we want to design our testing strategy. We could easily intermix the unit tests with the code they are testing, but a better strategy is to separate the application code from the unit test code.</p>
<p class="mce-root"/>
<div class="packt_infobox"><kbd>PyUnit</kbd> has been designed according to the principles of all the other xUnit testing frameworks.</div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>We will test the internationalized GUI we created earlier in this chapter.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>In order to use Python's built-in unit testing framework, we import the Python <kbd>unittest</kbd> module. Let's now look at the next steps:</p>
<ol>
<li>Create a new module and name it <kbd><span>UnitTestsMinimum.py</span></kbd>.</li>
<li>Add the following code:</li>
</ol>
<pre style="padding-left: 60px">import unittest <br/><br/>class GuiUnitTests(unittest.TestCase): <br/>    pass <br/><br/>if __name__ == '__main__': <br/>    unittest.main()</pre>
<ol start="3">
<li>Run <kbd>UnitTestsMinimum.py</kbd> and observe the following output:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/12dcecf3-982d-4df6-b8a3-ef73b1d6e920.png" style="width:17.50em;height:8.00em;" width="304" height="138"/></div>
<ol start="4">
<li>Create a new module, name it <kbd>UnitTests_One.py</kbd>, and then add this code:</li>
</ol>
<pre style="padding-left: 60px">import unittest <br/>from Ch08_Code.LanguageResources import I18N <br/><br/>class GuiUnitTests(unittest.TestCase): <br/><br/>    def test_TitleIsEnglish(self): <br/>        i18n = I18N('en') <br/>        self.assertEqual(i18n.title, <br/>        "Python Graphical User Interface")</pre>
<ol start="5">
<li>Run <kbd>UnitTests_One.py</kbd>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/036e99fc-3b80-4409-aedb-3744ac31d4ec.png" style="width:13.00em;height:9.92em;" width="184" height="140"/></div>
<ol start="6">
<li>Save the module as <span><kbd>UnitTestsFail.py</kbd> and then</span> copy, paste, and modify the code:</li>
</ol>
<pre style="padding-left: 60px">import unittest <br/>from Ch08_Code.LanguageResources import I18N <br/><br/>class GuiUnitTests(unittest.TestCase): <br/><br/>    def test_TitleIsEnglish(self): <br/>        i18n = I18N('en') <br/>        self.assertEqual(i18n.title, "Python Graphical User <br/>        Interface") <br/><br/>    def test_TitleIsGerman(self): <br/>        i18n = I18N('en')            <br/>        self.assertEqual(i18n.title,  <br/>        'Python Grafische Benutzeroberfl' + "u00E4" + 'che')</pre>
<ol start="7">
<li>Run <kbd><span>UnitTestsFail.py</span></kbd>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/5dcca416-976e-4aef-b0cc-fddb32e446a4.png" width="976" height="314"/></div>
<ol start="8">
<li>Correct this failure by passing in <kbd>'de'</kbd> to <kbd>I18N</kbd>:</li>
</ol>
<pre style="padding-left: 60px">def test_TitleIsGerman(self): <br/>    # i18n = I18N('en')           # &lt;= Bug in Unit Test <br/>    i18n = I18N('de')  <br/>    self.assertEqual(i18n.title, 'Python Grafische Benutzeroberfl' <br/>    + "u00E4" + 'che')</pre>
<ol start="9">
<li>Rerun <kbd>UnitTestsFail.py</kbd> with the failure corrected and observe the output:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/ac1ba1cd-76c3-48fe-9bdb-6826ef8df28f.png" style="width:19.92em;height:10.58em;" width="263" height="140"/></div>
<p><span>Let's now go behind the scenes to understand the code better.</span></p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p><span>We first import the <kbd>unittest</kbd> module, then we create our own class and, within this class, we inherit and extend the <kbd>unittest.TestCase</kbd> class. We use the minimum amount of code to get started. </span><span>The code isn't doing much yet but, when we run it, we do not get any errors, which is a good sign.</span></p>
<p class="mce-root"/>
<p class="mce-root"/>
<p>We actually do get an output written to the console stating that we successfully ran zero tests.</p>
<p>That output is a bit misleading, as all we have done so far is create a class that contains no actual testing methods.</p>
<p>We add testing methods that do the actual unit testing by following the default naming for all the test methods to start with the word <strong>test</strong>. This is an option that can be changed, but it is much easier and clearer to follow this <em>naming convention</em>.</p>
<p><span>We then add one test method that tests the title of our GUI. This will verify that, by passing the expected arguments, we get the expected result.</span></p>
<p>We are importing our <kbd>I18N</kbd> class from our <kbd>LanguageResources.py</kbd> module, passing English as the language to be displayed in our GUI. As this is our first unit test, we will print out the title result as well, just to make sure we know what we are getting back. We next use the <kbd>unittest assertEqual</kbd> method to verify that our title is correct.</p>
<p>Running this code gives us an OK, which means that the unit test passed.</p>
<p>The unit test runs and succeeds, which is indicated by one dot and the word OK. If it had failed or got an error, we would not have gotten the dot but an <em>F</em> or <em>E</em> as the output.</p>
<p>We then do the same automated unit testing check by verifying the title for the German version of our GUI. W<span>e test our internationalized GUI title in two languages. </span></p>
<p>We ran two unit tests but, instead of an OK, we got a failure. What happened?</p>
<p>Our assertion failed for the German version of our GUI.</p>
<p>While debugging our code, it turns out that in the copy, paste, and modify approach of our unit test code, we forgot to pass in German as the language.</p>
<p>After correcting the failure, <span>we reran our unit tests, and we get the expected result of all our tests passing.</span></p>
<div class="packt_infobox">Unit testing code is also code and can have bugs too.</div>
<p>While the purpose of writing unit tests is really to test our application code, we have to make sure that our tests are written correctly. One approach from the <strong>Test-Driven-Development</strong> (<strong>TDD</strong>) methodology might help us.</p>
<p class="mce-root"/>
<div class="packt_infobox">In TDD, we develop the unit tests before we actually write the application code. Now, if a test passes for a method that does not even exist, something is wrong. The next step is to create the non-existing method and make sure it will fail. After that, we can write the minimum amount of code necessary to make the unit test pass.</div>
<p>In this recipe, we started testing our Python GUI, and writing unit tests in Python. We saw that Python unit test code is just code and can contain mistakes that need to be corrected. In the next recipe, we will extend this recipe's code and use the graphical unit test runner that comes with the PyDev plugin for the Eclipse IDE.</p>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to write unit tests using the Eclipse PyDev IDE</h1>
                </header>
            
            <article>
                
<p>In the previous recipe, we started using Python's unit testing capabilities, and, in this recipe, we will ensure the quality of our GUI code by using this capability <span>further</span>.</p>
<p>We will unit test our GUI in order to make sure that the internationalized strings our GUI displays are as expected.</p>
<p>In the previous recipe, we encountered some bugs in our unit testing code but, typically, our unit tests will find regression bugs that are caused by modifying the existing application code, not the unit test code. Once we have verified that our unit testing code is correct, we do not usually change it.</p>
<div class="packt_infobox">Our unit tests also serve as a documentation of what we expect our code to do.</div>
<p>By default, Python's unit tests are executed with a textual unit test runner, and we can run this in the PyDev plugin from within the Eclipse IDE. We can also run the very same unit tests from a console window.</p>
<p>In addition to the text runner in this recipe, we will explore PyDev's graphical unit test feature, which can be used from within the Eclipse IDE.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">Getting ready</h1>
                </header>
            
            <article>
                
<p>We will extend the previous recipe in which we began using Python unit tests. The Python unit testing framework comes with what are called <strong>Test Fixtures</strong>.</p>
<p>Refer to the following URLs for a description of what a test fixture is:</p>
<ul>
<li><a href="https://docs.python.org/3.7/library/unittest.html">https://docs.python.org/3.7/library/unittest.html</a></li>
<li><a href="https://en.wikipedia.org/wiki/Test_fixture">https://en.wikipedia.org/wiki/Test_fixture</a></li>
<li><a href="http://www.boost.org/doc/libs/1_51_0/libs/test/doc/html/utf/user-guide/fixture.html">http://www.boost.org/doc/libs/1_51_0/libs/test/doc/html/utf/user-guide/fixture.html</a></li>
</ul>
<p>What this means is that we can create <kbd>setup</kbd> and <kbd>teardown</kbd> unit testing methods so that the <kbd>setup</kbd> method is called at the beginning before any single test is executed, and, at the end of every single unit test, the <kbd>teardown</kbd> method is called.</p>
<div class="packt_infobox">This test fixture capability provides us with a very controlled environment in which we can run our unit tests. </div>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How to do it…</h1>
                </header>
            
            <article>
                
<p>Now, let's see how to perform this recipe:</p>
<ol>
<li>Firstly, let's set up our unit testing environment. We will create a new testing class that focuses on the aforementioned correctness of code.</li>
<li>Create a new module, <kbd><span>UnitTestsEnglish.py</span></kbd>.</li>
<li>Add the following code:</li>
</ol>
<pre style="padding-left: 60px">import unittest<br/>from Ch08_Code.LanguageResources import I18N<br/>from Ch08_Code.GUI_Refactored import OOP as GUI<br/><br/>class GuiUnitTests(unittest.TestCase):<br/>    def test_TitleIsEnglish(self):<br/>        i18n = I18N('en')<br/>        self.assertEqual(i18n.title, <br/>        "Python Graphical User Interface")<br/><br/>    def test_TitleIsGerman(self):<br/>        # i18n = I18N('en') # &lt;= Bug in Unit Test<br/>        i18n = I18N('de') <br/>        self.assertEqual(i18n.title, <br/>        'Python Grafische Benutzeroberfl' + "u00E4" + 'che')<br/><br/>class WidgetsTestsEnglish(unittest.TestCase):<br/>    def setUp(self):<br/>        self.gui = GUI('en')<br/><br/>    def tearDown(self):<br/>        self.gui = None<br/><br/>    def test_WidgetLabels(self):<br/>        self.assertEqual(self.gui.i18n.file, "File")<br/>        self.assertEqual(self.gui.i18n.mgrFiles, ' Manage Files ')<br/>        self.assertEqual(self.gui.i18n.browseTo, <br/>        "Browse to File...")<br/><br/>#========================== <br/>if __name__ == '__main__':<br/> unittest.main()</pre>
<ol start="4">
<li>Run the code and observe the output:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/9ee00d5e-d548-4469-a558-1536c6bde418.png" style="width:22.75em;height:10.67em;" width="302" height="141"/></div>
<ol start="5">
<li>Open <span><kbd>UnitTestsEnglish.py</kbd> and save it as <kbd>UnitTests.py</kbd></span>.</li>
<li>Add the following code to the module:</li>
</ol>
<pre style="padding-left: 60px">class WidgetsTestsGerman(unittest.TestCase): <br/>    def setUp(self): <br/>        self.gui = GUI('de') <br/><br/>    def test_WidgetLabels(self): <br/>        self.assertEqual(self.gui.i18n.file, "Datei") <br/>        self.assertEqual(self.gui.i18n.mgrFiles, ' Dateien Organisieren ') <br/>        self.assertEqual(self.gui.i18n.browseTo, "Waehle eine Datei... ")                               <br/><br/>    def test_LabelFrameText(self): <br/>        labelFrameText = self.gui.widgetFrame['text'] <br/>        self.assertEqual(labelFrameText, " Widgets Rahmen ") <br/>        self.gui.radVar.set(1) <br/>        self.gui.callBacks.radCall() <br/>        labelFrameText = self.gui.widgetFrame['text'] <br/>        self.assertEqual(labelFrameText, " Widgets Rahmen in Gold")<br/><br/>    ...</pre>
<ol start="7">
<li>Run <kbd>UnitTests.py</kbd>:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/33ef01af-7821-4644-a489-da190bdcec7c.png" style="width:19.92em;height:10.33em;" width="264" height="137"/></div>
<ol start="8">
<li>Run the code from Command Prompt and observe the output as follows:</li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/77a67d45-6553-4c6e-8d4b-a750d11c87b8.png" width="992" height="112"/></div>
<ol start="9">
<li><span>Using Eclipse, we can also choose to run our unit tests, not as a simple Python script, but as a Python unit test script, which gives us some colorful output:</span></li>
</ol>
<div class="CDPAlignCenter CDPAlign"><img src="Images/f12a233f-a2ed-4ddf-a389-1ce393402a65.png" width="976" height="298"/></div>
<p class="mce-root"/>
<p class="mce-root"/>
<p><span>Let's learn about the steps in the next section.</span></p>
<p class="mce-root"/>


            </article>

            
        </section>
    </div>



  
<div id="sbo-rt-content"><section>

                            <header>
                    <h1 class="header-title">How it works…</h1>
                </header>
            
            <article>
                
<p>Firstly, we created three test methods.</p>
<div class="packt_infobox"><span><kbd>unittest.main()</kbd> runs any method that starts with the <kbd>test</kbd></span> prefix<span>, no matter how many classes we create within a given Python module.</span></div>
<p>The unit testing code shows that we can create several unit testing classes and they can all be run in the same module by calling <kbd>unittest.main()</kbd>.</p>
<p>It also shows that the <kbd>setup</kbd> method does not count as a test in the output of the unit test report (the count of tests is three) while, at the same time, it did its intended job as we can now access our <kbd>self.gui</kbd> class instance variable from within the unit test method.</p>
<p>We are interested in testing the correctness of all of our labels and, especially, catching bugs when we make changes to our code.</p>
<p>If we have copied and pasted strings from our application code to the testing code, it will catch any unintended changes with the click of a unit testing framework button.</p>
<p>We also want to test the fact that invoking any of our radio button widgets in any language results in the <kbd>LabelFrame</kbd> widget text being updated. In order to automatically test this, we have to do two things.</p>
<p>First, we have to retrieve the value of the <kbd>LabelFrame</kbd> widget and assign the value to a variable we name <kbd>labelFrameText</kbd>. We have to use the following syntax because the properties of this widget are being passed and retrieved via a dictionary data type:</p>
<pre>self.gui.widgetFrame['text']</pre>
<p><span>We can now verify the default text and then the internationalized versions after clicking one of the radio button widgets programmatically.</span></p>
<p>After verifying the default <kbd>labelFrameText</kbd>, we programmatically set the radio button to <kbd>index 1</kbd> and then invoke the radio button's callback method:</p>
<pre>self.gui.radVar.set(1) <br/>self.gui.callBacks.radCall()</pre>
<p class="mce-root"/>
<div class="packt_infobox">This is basically the same action as clicking the radio button in the GUI, but we do this button click event via code in the unit tests.</div>
<p>Then, we verify that our text in the <kbd>LabelFrame</kbd> widget has changed as intended.</p>
<div class="packt_tip">If you get a <kbd>ModuleNotFoundError</kbd>, simply add the directory where your Python code lives to the Windows <kbd>PYTHONPATH</kbd> environmental variable, as shown in the following screenshots:</div>
<p>An error gets encountered as shown:</p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/8e4e459a-23ef-4ce0-a47e-b95e3e2677a1.png" width="985" height="262"/></p>
<p class="CDPAlignLeft CDPAlign"><span>The solution to the error, if you encounter it, is shown here:</span></p>
<p class="CDPAlignCenter CDPAlign"><img src="Images/aeff779b-3908-4688-9279-9d54dba0ccf2.png" style="width:33.33em;height:15.58em;" width="613" height="287"/></p>
<p>For example, <kbd>C:\Eclipse_Oxygen_workspace_Packt_3rd_GUI_BOOK\3rd Edition Python GUI Programming Cookbook</kbd>:</p>
<div class="CDPAlignCenter CDPAlign"><img src="Images/4bfd962a-63a0-423b-8278-38cc37f9cdd5.png" style="width:38.08em;height:15.75em;" width="613" height="253"/></div>
<p class="mce-root"/>
<p>This will recognize the<span> </span><kbd>Ch08_Code</kbd><span> </span>folder as a Python package and the code will run.</p>
<p><span>When we run the unit test from the graphical runner in Eclipse, the result bar is green, which means that all our unit tests have passed. </span></p>
<p>We extended our unit testing code by testing labels, programmatically invoking <kbd>Radiobutton</kbd>, and then verifying in our unit tests that the corresponding text property of the <kbd>LabelFrame</kbd> widget has changed as expected. We tested two different languages. We then moved on to use the built-in Eclipse/PyDev graphical unit test runner.</p>


            </article>

            
        </section>
    </div>



  </body></html>