<html><head></head><body>
		<div><h1 id="_idParaDest-475" class="chapter-number"><a id="_idTextAnchor549"/>10</h1>
			<h1 id="_idParaDest-476"><a id="_idTextAnchor550"/>Security Access</h1>
			<p>Odoo is typically used by multi-user organizations. Each user has a distinct position in every organization, and they have varying access based on their function. The HR manager, for example, does not have access to the company’s accounting information. You may determine which information a user can access in Odoo using access rights and record rules. We will learn how to set access rights rules and record rules in this chapter.</p>
			<p>Such compartmentalization of access and security requires that we provide access to roles based on their permission levels. We will learn about this in this chapter.</p>
			<p>In this chapter, we will cover the following recipes:</p>
			<ul>
				<li>Creating security groups and assigning them to users</li>
				<li>Adding security access to models</li>
				<li>Limiting access to fields in models</li>
				<li>Using record rules to restrict record access</li>
				<li>Activating features with security groups</li>
				<li>Accessing recordsets as a superuser</li>
				<li>Hiding view elements and menus based on groups</li>
			</ul>
			<p>To concisely get the point across, the recipes in this chapter make small additions to an example existing module.</p>
			<h1 id="_idParaDest-477"><a id="_idTextAnchor551"/>Technical requirements</h1>
			<p>The technical requirements for this chapter include using the module that we created by following the tutorials in <a href="B20997_03.xhtml#_idTextAnchor083"><em class="italic">Chapter 3</em></a>, <em class="italic">Creating Odoo Add-On Modules</em>. To follow the examples here, you should have that module created and ready to use.</p>
			<p>All the code that will be used in this chapter can be downloaded from this book’s GitHub repository at <a href="https://github.com/PacktPublishing/Odoo-17-Development-Cookbook-Fifth-Edition/tree/main/Chapter10">https://github.com/PacktPublishing/Odoo-17-Development-Cookbook-Fifth-Edition/tree/main/Chapter10</a>.</p>
			<h1 id="_idParaDest-478"><a id="_idTextAnchor552"/>Creating security groups and assigning them to users</h1>
			<p>Security access<a id="_idIndexMarker702"/> in Odoo is configured through security groups: permissions are given to groups and then groups are assigned to users. Each functional area has base security groups<a id="_idIndexMarker703"/> provided by a central application.</p>
			<p>When add-on modules augment an existing application, they should add rights to the respective groups, as explained in the <em class="italic">Adding security access to </em><em class="italic">models</em> recipe.</p>
			<p>When add-on modules introduce a new functional area that is not yet covered by an existing core application, the associated security groups should be added. We should usually have at least user and management roles.</p>
			<p>Take the Hostel example we introduced in <a href="B20997_03.xhtml#_idTextAnchor083"><em class="italic">Chapter 3</em></a>, <em class="italic">Creating Odoo Add-On Modules</em>, as an example – it doesn’t fit neatly into any of the Odoo core apps, so we will add security groups for it.</p>
			<h2 id="_idParaDest-479"><a id="_idTextAnchor553"/>Getting ready</h2>
			<p>This tutorial assumes that you have an Odoo instance ready with <code>my_hostel</code> available, as described in <a href="B20997_03.xhtml#_idTextAnchor083"><em class="italic">Chapter 3</em></a>, <em class="italic">Creating Odoo </em><em class="italic">Add-On Modules</em>.</p>
			<h2 id="_idParaDest-480"><a id="_idTextAnchor554"/>How to do it...</h2>
			<p>To add new access security groups<a id="_idIndexMarker704"/> to a module, perform the following steps:</p>
			<ol>
				<li>Ensure that the <code>__manifest__.py</code> add-on module manifest has the <code>category</code> key defined:<pre class="source-code">
    'category': Hostel,</pre></li>				<li>Add the new <code>security/groups.xml</code> file to the manifest <code>data</code> key:<pre class="source-code">
    'data': [
        'security/groups.xml',
    ],</pre></li>				<li>Add the new XML file for the data records to the <code>security/groups.xml</code> file, starting with an empty structure:<pre class="source-code">
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;odoo&gt;
    &lt;!--  Add step 4 goes here --&gt;
&lt;/odoo&gt;</pre></li>				<li>Add<a id="_idIndexMarker705"/> the <code>&lt;record&gt;</code> tags for the two new groups inside the data XML element:<pre class="source-code">
&lt;record id="group_hostel_user" model="res.groups"&gt;
     &lt;field name="name"&gt;User&lt;/field&gt;
     &lt;field name="category_id"
            ref="base.module_category_hostel"/&gt;
     &lt;field name="implied_ids"
            eval="[(4, ref('base.group_user'))]"/&gt;
&lt;/record&gt;
&lt;record id="group_hostel_manager" model="res.groups"&gt;
    &lt;field name="name"&gt;Manager&lt;/field&gt;
    &lt;field name="category_id"
           ref="base.module_category_hostel"/&gt;
    &lt;field name="implied_ids"
           eval="[(4, ref('group_hostel_user'))]"/&gt;
    &lt;field name="users" eval="[(4, ref('base.user_admin'))]"/&gt; &lt;/record&gt;</pre></li>			</ol>
			<p>If we <a id="_idIndexMarker706"/>upgrade the add-on module, these two records will be loaded. To see these groups in the UI, you need to activate developer mode. You’ll then be able to see them through the <strong class="bold">Settings</strong> | <strong class="bold">Users</strong> | <strong class="bold">Groups</strong> menu option, like so:</p>
			<div><div><img src="img/B20997_10_1.jpg" alt="Figure 10.1 – Newly added security groups"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.1 – Newly added security groups</p>
			<p class="callout-heading">Important information</p>
			<p class="callout">When you add a new model, the admin user does not have access to that model. This implies that the admin user cannot see the menus and views that have been added for that model. To show it, you must first add access rules to that model, something we will accomplish in the Adding security access to models recipe. Note that you may access newly added models as a superuser; for more information, see the <em class="italic">Accessing Odoo as a superuser</em> recipe in <a href="B20997_03.xhtml#_idTextAnchor083"><em class="italic">Chapter 3</em></a>, <em class="italic">Creating Odoo </em><em class="italic">Add-On Modules</em>.</p>
			<h2 id="_idParaDest-481"><a id="_idTextAnchor555"/>How it works...</h2>
			<p>Add-on modules are organized into functional areas, or major <em class="italic">applications</em>, such as <em class="italic">accounting and finance</em>, <em class="italic">sales</em>, or <em class="italic">human resources</em>. These are defined by the <code>category</code> key in the manifest file.</p>
			<p>If a category name does not exist yet, it will be automatically created. For convenience, a <code>base.module_category_&lt;category_name_in_manifest&gt;</code> XML ID will also be<a id="_idIndexMarker707"/> generated for the new category name in lowercase letters, replacing the spaces with underscores. This is useful for relating security groups to application categories.</p>
			<p>In <a id="_idIndexMarker708"/>our example, we used the <code>base.module_category_hostel</code> XML identifier.</p>
			<p>By convention, data files that contain security-related elements should be placed inside a <code>security</code> subdirectory.</p>
			<p>A manifest file must also be used to register security files. The sequence in which files are specified in the module manifest’s <strong class="bold">data</strong> key<a id="_idIndexMarker709"/> is critical since you cannot utilize a reference to a security group in other views or <strong class="bold">ACL</strong> files<a id="_idIndexMarker710"/> until the group has been created. It’s advisable to put the security data file first, followed by the ACL files and other user interface data files.</p>
			<p>In our example, we created groups with the <code>&lt;record&gt;</code> tag, which will create a record of the <code>res.groups</code> model. The most important columns of the <em class="italic">res.group</em> model are as follows:</p>
			<ul>
				<li><code>name</code>: This is the group’s display name.</li>
				<li><code>category_id</code>: This is a reference to the application category and is used to organize the groups in the user’s form.</li>
				<li><code>implied_ids</code>: These are other groups to inherit permissions from.</li>
				<li><code>users</code>: This is the list of users that belong to this group. In new add-on modules, we usually want the admin user to belong to the application’s manager group.</li>
			</ul>
			<p>The first security group uses <code>implied_ids</code> as the <code>base.group_user</code> group. This is the <code>Employee</code> user group and is the basic security group all the backend users are expected to share.</p>
			<p>The second security group sets a value on the <code>users</code> field to assign it to the administrator user, which has the <code>base.user_admin</code> XML ID.</p>
			<p>Users that belong to a security group will automatically belong to its implied groups. For example, if you assign a <em class="italic">Hostel Manager</em> group to any user, that user will also be included in the <em class="italic">User</em> group. This is because the <em class="italic">Hostel Manager</em> group has the <em class="italic">User</em> group in its <code>implied_ids</code> column.</p>
			<p>Furthermore, security groups’ access rights are cumulative. A user has permission if any of the groups to which they belong (directly or indirectly) grant it to them.</p>
			<p>Some security groups are displayed as a selection box in the user form rather than distinct tick boxes. This occurs when the groups involved are in the same application category and are linearly interconnected by <code>implied_ids</code>. Group A, for example, implies Group B, while Group B implies Group C. If a group is not associated with any other groups via <code>implied_ids</code>, a checkbox will appear instead of a selection box.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">Note that the relationships that were defined in the preceding fields also have reverse relationships that can be edited in the related models, such as security groups and users.</p>
			<p>Setting <a id="_idIndexMarker711"/>values on reference fields, such as <code>category_id</code> and <code>implied_ids</code>, can be done using the related records’ XML IDs and some special syntax. This syntax was explained in detail in <a href="B20997_06.xhtml#_idTextAnchor319"><em class="italic">Chapter 6</em></a>, <em class="italic">Managing </em><em class="italic">Module Data</em>.</p>
			<h2 id="_idParaDest-482"><a id="_idTextAnchor556"/>There’s more...</h2>
			<p>The special <code>base.group_no_one</code> security group<a id="_idIndexMarker712"/> called <code>Technical Features</code> flag was activated. From version 9.0, this has changed, and the features are visible so long as <code>Developer Mode</code> is active.</p>
			<p>Security groups only provide cumulative access rights. There is no method to deny a group’s access. This implies that a manually established group used to customize rights should inherit from the nearest group with fewer permissions than intended (if any), and then add all remaining permissions required.</p>
			<p>Groups also have these additional fields available:</p>
			<ul>
				<li><code>menu_access</code><strong class="bold"> field)</strong>: These are<a id="_idIndexMarker713"/> the menu items the group has access to</li>
				<li><code>view_access</code><strong class="bold"> field)</strong>: These are the <a id="_idIndexMarker714"/>UI views the group has access to</li>
				<li><code>model_access</code><strong class="bold"> field)</strong>: This is the access it has to models, as<a id="_idIndexMarker715"/> detailed in the <em class="italic">Adding security access to </em><em class="italic">models</em> recipe</li>
				<li><code>rule_groups</code><strong class="bold"> field)</strong>: These<a id="_idIndexMarker716"/> are the record-level access rules that apply to the group, as detailed in the <em class="italic">Limiting record access using record </em><em class="italic">rules</em> recipe</li>
				<li><code>comment</code><strong class="bold"> field)</strong>: This is a<a id="_idIndexMarker717"/> description or commented piece of text for the group</li>
			</ul>
			<p>With that, we’ve learned how to build security groups and assign them via the GUI. We will utilize these groups to establish an access control list and record rules in the next few recipes.</p>
			<h2 id="_idParaDest-483"><a id="_idTextAnchor557"/>See also</h2>
			<p>To learn how to access newly added models through the <em class="italic">superuser</em>, please refer to the <em class="italic">Accessing Odoo as a superuser</em> recipe in <a href="B20997_03.xhtml#_idTextAnchor083"><em class="italic">Chapter 3</em></a>, <em class="italic">Creating Odoo </em><em class="italic">Add-On Modules</em>.</p>
			<h1 id="_idParaDest-484"><a id="_idTextAnchor558"/>Adding security access to models</h1>
			<p>It’s <a id="_idIndexMarker718"/>common for add-on modules to add new models. For example, in <a href="B20997_03.xhtml#_idTextAnchor083"><em class="italic">Chapter 3</em></a>, <em class="italic">Creating Odoo Add-On Modules</em>, we added a new Hostel model. It is easy to miss out on creating security access for new models during development, and you might find it hard to see menus and views that have been created. This is because, from <em class="italic">Odoo version 12</em>, admin users don’t get default access rights to new models. To see the <a id="_idIndexMarker719"/>views and menus for the new model, you need to add security <strong class="bold">ACLs</strong>.</p>
			<p>However, models with no ACLs will trigger a warning log message upon loading, informing the user about the missing ACL definitions:</p>
			<pre class="source-code">
<strong class="bold">WARNING The model hostel.hostel has no access rules, consider adding one example, access_hostel_hostel, access_hostel_hostel, model_hostel_hostel, base.group_user,1,0,0,0</strong></pre>			<p>You may<a id="_idIndexMarker720"/> also access freshly uploaded models as a superuser, which circumvents all security requirements. For further information, see the <em class="italic">Accessing Odoo as a superuser</em> recipe in <a href="B20997_03.xhtml#_idTextAnchor083"><em class="italic">Chapter 3</em></a>, <em class="italic">Creating Odoo Add-On Modules</em>. Administrators have access to the superuser functionality. So, for new models to be useable by non-admin users, we must establish their access control lists so that Odoo understands how to access them and what activities each user group is permitted to conduct.</p>
			<h2 id="_idParaDest-485"><a id="_idTextAnchor559"/>Getting ready</h2>
			<p>We will continue using the <code>my_hostel</code> module from the previous tutorial and add the missing ACLs to it.</p>
			<h2 id="_idParaDest-486"><a id="_idTextAnchor560"/>How to do it...</h2>
			<p><code>my_hostel</code> should already contain the <code>models/hostel.py</code> Python file that creates the <code>hostel.hostel</code> model. We will now add a data file that describes this model’s security access control by performing the following steps:</p>
			<ol>
				<li>Edit the <code>__manifest__.py</code> file to declare a new data file:<pre class="source-code">
    data: [
        # .<a id="_idTextAnchor561"/>..Security Groups
        'security/ir.model.access.csv',
        # ...Other data files
    ]</pre></li>				<li>Add a new <code>security/ir.model.access.csv</code> file to the module with the following lines:<pre class="source-code">
id,name,model_id:id,group_id:id,perm_read,perm_write,perm_c<a id="_idTextAnchor562"/>reate,perm_unlink
acl_hostel,hostel_hostel_default,model_hostel_hostel,base_group_user,1,0,0,0
acl_hostel_manager,hostel_manager,model_hostel_hostel,group_hostel_manager,1,1,1,1</pre></li>			</ol>
			<p>We should then upgrade the module so that these ACL records are added to our Odoo database. More importantly, if we sign into a demonstration database using the <code>demo</code> user, we should be able to access the <strong class="bold">My Hostel</strong> menu option without receiving any security errors.</p>
			<h2 id="_idParaDest-487"><a id="_idTextAnchor563"/>How it works...</h2>
			<p>Security ACLs<a id="_idIndexMarker721"/> are stored in the core <code>ir.model.access</code> model. We just need to add the records that describe the intended access rights for each user group.</p>
			<p>Any sort of data file will do, although the most popular is a CSV file. The file can be placed anywhere inside the add-on module directory; however, it is common to keep all <strong class="bold">security</strong>-related files under a security subfolder.</p>
			<p>This new data file is added to the manifest in the first phase of our tutorial. The next step is to include the files that explain the security access control rules. The CSV file must be named after the model into which the entries will be imported, so the name we’ve chosen isn’t simply a convention; it’s required. For further information, see <a href="B20997_06.xhtml#_idTextAnchor319"><em class="italic">Chapter 6</em></a>, <em class="italic">Managing </em><em class="italic">Module Data</em>.</p>
			<p>If the module also creates new security groups, its data file should be declared in the manifest before the ACLs’ data files, since you may want to use them for the ACLs. They must already be created when the ACL file is processed.</p>
			<p>The columns in the CSV file are as follows:</p>
			<ul>
				<li><code>id</code>: This is the internal XML ID identification for this rule. Any unique name inside the module is acceptable, but the best practice is to use <code>access_&lt;model&gt;_&lt;group&gt;</code>.</li>
				<li><code>name</code>: This is a title for the access rule. It is a common practice to use an <code>access.</code><code> &lt;</code><code>model&gt;.&lt;group&gt;</code> name.</li>
				<li><code>model_id:id</code>: This is the XML ID for the model. Odoo automatically assigns this kind of ID to models with a <code>model_&lt;name&gt;</code> format, using the model’s <code>_name</code> with underscores instead of dots. If the model was created in a different add-on module, a fully qualified XML ID that includes the module name is needed.</li>
				<li><code>group_id:id</code>: This is the XML ID for the user group. If left empty, it applies to all users. The base module provides some basic groups, such as <code>base.group_user</code> for all employees and <code>base.group_system</code> for the administration user. Other apps can add their own user groups.</li>
				<li><code>perm_read</code>: Members of the preceding group can read the model’s records. It accepts two values: <code>0</code> or <code>1</code>. Use <code>0</code> to restrict read access on the model and <code>1</code> to provide read access.</li>
				<li><code>perm_write</code>: Members of the preceding group can update the model’s records. It accepts two values: <code>0</code> or <code>1</code>. Use <code>0</code> to restrict write access on the model and <code>1</code> to provide write access.</li>
				<li><code>perm_create</code>: Members of the preceding group can add new records of this model. It accepts two values: <code>0</code> or <code>1</code>. Use <code>0</code> to restrict create access on the model and <code>1</code> to provide create access.</li>
				<li><code>perm_unlink</code>: Members of the preceding group can delete records of this model. It accepts two values: <code>0</code> or <code>1</code>. Use <code>0</code> to restrict unlink access on the model and <code>1</code> to provide unlink access.</li>
			</ul>
			<p>The CSV<a id="_idIndexMarker722"/> file we used adds read-only access to the <strong class="bold">Employees</strong> | <strong class="bold">Employee</strong> standard security group and full write access to the <strong class="bold">Administration</strong> | <strong class="bold">Settings</strong> group.</p>
			<p>The <code>base.group_user</code>, is particularly important because the user groups that are added by the Odoo standard apps inherit from it. This means that if we need a new model to be accessible by all the backend users, regardless of the specific apps they work with, we should add that permission to the <strong class="bold">Employee</strong> group.</p>
			<p>The <code>base.group_user</code>, is particularly essential since it is inherited by the user groups introduced by the Odoo standard applications. This implies that if we want a new model to be accessible to all backend users, independent of the applications they use, we need to add it to the <strong class="bold">Employee</strong> group.</p>
			<p>The resulting ACLs can be viewed from the GUI in debug mode by navigating to <strong class="bold">Settings</strong> | <strong class="bold">Technical</strong> | <strong class="bold">Security</strong> | <strong class="bold">Access Controls List</strong>, as shown in the following screenshot:</p>
			<div><div><img src="img/B20997_10_2.jpg" alt="Figure 10.2 – ACL list view"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.2 – ACL list view</p>
			<p>Some people <a id="_idIndexMarker723"/>find it easier to use this user interface to define ACLs and then use the <strong class="bold">Export</strong> feature to produce a CSV file.</p>
			<h2 id="_idParaDest-488"><a id="_idTextAnchor564"/>There’s more...</h2>
			<p>It seems reasonable to provide this access to the Hostel user and the Hostel Manager groups specified in the <em class="italic">Creating security groups and assigning them to users</em> recipe. If you went through that lesson, it’s a nice exercise to go through this one while changing the group identities to Hostel ones.</p>
			<p>It is crucial to remember that access lists given by add-on modules should not be directly customized because they will be reloaded on the next module update, erasing any modification done from the GUI.</p>
			<p>There are two methods for customizing ACLs. One option is to build new security groups that inherit from the modules and add extra rights to them, but this only enables us to add permissions and not remove them. A more adaptable way would be to uncheck the <code>&lt;field name="active" /&gt;</code> column. We may also create new ACL lines to add or alter permissions. The deactivated ACLs will not be revived after a module update, and the newly inserted ACL lines will not be impacted.</p>
			<p>It’s also worth mentioning that ACLs only apply to conventional models and aren’t required for abstract or transient models. If these are defined, they will be ignored, and a warning message will be logged in the server log.</p>
			<h2 id="_idParaDest-489"><a id="_idTextAnchor565"/>See also</h2>
			<p>You can also access newly added models through a superuser since this bypasses all security rules. To learn more about this, please refer to the <em class="italic">Accessing Odoo as a superuser</em> recipe in <a href="B20997_03.xhtml#_idTextAnchor083"><em class="italic">Chapter 3</em></a>, <em class="italic">Creating Odoo </em><em class="italic">Add-On Modules</em>.</p>
			<h1 id="_idParaDest-490"><a id="_idTextAnchor566"/>Limiting access to fields in models</h1>
			<p>In <a id="_idIndexMarker724"/>other circumstances, we may want additional fine-grained access control, as well as the ability to restrict access to individual fields in a model.</p>
			<p>Using the <code>groups</code> property, it is possible to restrict access to a field to certain security <strong class="bold">groups</strong>. This recipe will demonstrate how to add a field with restricted access to the  Hostels model.</p>
			<h2 id="_idParaDest-491"><a id="_idTextAnchor567"/>Getting ready</h2>
			<p>We will continue using the <code>my_hostel</code> module from the previous tutorial.</p>
			<h2 id="_idParaDest-492"><a id="_idTextAnchor568"/>How to do it...</h2>
			<p>To add a field with access that’s limited to specific security groups, perform the following steps:</p>
			<ol>
				<li>Edit the model file to add the field:<pre class="source-code">
is_public = fields.Boolean(groups='my_hostel.group_hostel_manager')
notes = fields.Text(groups='my_hostel.group_hostel_manager')</pre></li>				<li>Edit the view in the XML file to add the field:<pre class="source-code">
&lt;field name="is_public" /&gt;
&lt;field name="notes" /&gt;</pre></li>			</ol>
			<p>That’s it. Now, upgrade the add-on module for the changes in the model to take place. If you sign in with a user with no system configuration access, such as <code>demo</code> in a database with demonstration data, the Hostel form won’t display the field.</p>
			<h2 id="_idParaDest-493"><a id="_idTextAnchor569"/>How it works...</h2>
			<p>Fields <a id="_idIndexMarker725"/>containing the <code>groups</code> property are processed differently to determine whether the user belongs to any of the security groups specified in the attribute. If a user is not a member of a certain group, Odoo will remove the field from the UI and limit ORM operations on that field.</p>
			<p>Note that this security is not superficial. The field is not only hidden in the UI but is also made unavailable to the user in the other ORM operations, such as <code>read</code> and <code>write</code>. This is also true for <em class="italic">XML-RPC</em> or <em class="italic">JSON-RPC</em> calls.</p>
			<p>Be careful when using these fields in business logic or on-change UI events (<code>@api.onchange</code> methods); they can raise errors for users with no access to the field. One workaround for this is to use privilege elevation, such as the <code>sudo()</code> model method or the <code>compute_sudo</code> field attribute for computed fields.</p>
			<p>The <code>groups</code> value is a string that contains a comma-separated list of valid XML IDs for security groups. The simplest way to find the XML ID for a particular group is to activate developer mode and navigate to the group’s form, at <strong class="bold">Settings</strong> | <strong class="bold">Users</strong> | <strong class="bold">Groups</strong>, and then access the <strong class="bold">View Metadata</strong> option from the debug menu, as shown in the following screenshot:</p>
			<div><div><img src="img/Image96854.jpg" alt="Figure 10.3 – Menu for viewing a group’s XML ID"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.3 – Menu for viewing a group’s XML ID</p>
			<p>You may also <a id="_idIndexMarker726"/>view a security group’s XML ID through code by utilizing the <code>&lt;record&gt;</code> tag that formed the group. However, looking at the information, as shown in the preceding screenshot, is the most simple approach to figuring out a group’s XML ID.</p>
			<h2 id="_idParaDest-494"><a id="_idTextAnchor570"/>There’s more...</h2>
			<p>In some circumstances, we want a field to be available or unavailable based on specific requirements, such as the values in a field, such as <code>stage_id</code> or <code>state</code>. Typically, this is handled at the view level by utilizing characteristics such as states or attributes to dynamically display or hide the field based on particular criteria. For a more complete explanation, see <a href="B20997_09.xhtml#_idTextAnchor446"><em class="italic">Chapter 9</em></a>, <em class="italic">Backend Views</em>.</p>
			<p>Note that these techniques work at the user interface level only and don’t provide actual access security. To do this, you should add checks to the business logic layer. Either add model methods decorated with <code>@constrains</code>, implementing the specific validations intended, or extend the <code>create</code>, <code>write</code>, or <code>unlink</code> methods to add validation logic. You can get further insights into how to do this by going back to <a href="B20997_05.xhtml#_idTextAnchor238"><em class="italic">Chapter 5</em></a>, <em class="italic">Basic </em><em class="italic">Server-Side Development</em>.</p>
			<h2 id="_idParaDest-495"><a id="_idTextAnchor571"/>See also</h2>
			<p>Please see <a href="B20997_09.xhtml#_idTextAnchor446"><em class="italic">Chapter 9</em></a>, <em class="italic">Backend Views</em>, for further information on how to hide and reveal a field using criteria.</p>
			<p>For further insights into the business logic layer, please refer to <a href="B20997_05.xhtml#_idTextAnchor238"><em class="italic">Chapter 5</em></a>, <em class="italic">Basic </em><em class="italic">Server-Side Development</em>.</p>
			<h1 id="_idParaDest-496"><a id="_idTextAnchor572"/>Limiting record access using record rules</h1>
			<p>A basic requirement for every application is the ability to restrict which records are exposed to each user on a certain model.</p>
			<p>This is accomplished through<a id="_idIndexMarker727"/> the use of <strong class="bold">record rules</strong>. A record rule is a domain filter expression specified on a model that is subsequently applied to each data query performed by the impacted users.</p>
			<p>As an example, we will add a record rule to the <em class="italic">Hostel</em> model so that users in the <code>Employee</code> group will only have access to the public hostel.</p>
			<h2 id="_idParaDest-497"><a id="_idTextAnchor573"/>Getting ready</h2>
			<p>We will continue using the <code>my_hostel</code> module from the previous recipe.</p>
			<h2 id="_idParaDest-498"><a id="_idTextAnchor574"/>How to do it...</h2>
			<p>Record <a id="_idIndexMarker728"/>rules can be added using a data XML file. To do this, perform the following steps:</p>
			<ol>
				<li>Ensure that the <code>security/security_rules.xml</code> file is referenced by the manifest <code>data</code> key:<pre class="source-code">
    'data': [
        'security/security_rules.xml',
        # ...
    ],</pre></li>				<li>We should have a <code>security/security_rules.xml</code> data file with a <code>&lt;odoo&gt;</code> section that creates the security group:</li>
			</ol>
			<div><div><img src="img/B20997_10_4.jpg" alt="Figure 10.4 –  Record rule for the hostel user"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.4 –  Record rule for the hostel user</p>
			<p>Upgrading the add-on module will load the record rules inside the Odoo instance. If you are using demo data, you can test it through the default <code>demo</code> user to give hostel user rights to the demo user. If you are not using demo data, you can create a new user with hostel user rights.</p>
			<h2 id="_idParaDest-499"><a id="_idTextAnchor575"/>How it works...</h2>
			<p>Record rules<a id="_idIndexMarker729"/> are just data records that are placed in<a id="_idIndexMarker730"/> the <code>ir.rule</code> core model. While the file containing them can be located anywhere in the module, the <code>security</code> subfolder is the preferred location. A single XML file including both security groups and record rules is usual.</p>
			<p>In contrast to groups, record rules in standard modules are imported into an <code>odoo</code> section with the <code>noupdate="1"</code> property. Because certain records will not be reloaded after a module update, manually customizing them is safe and will survive further upgrades.</p>
			<p>To be consistent with the standard modules, our record rules should also be contained within an <code>&lt;odoo </code><code>noupdate="1"&gt;</code> section.</p>
			<p>Record rules can be seen from the GUI via the <strong class="bold">Settings</strong>| <strong class="bold">Technical</strong> | <strong class="bold">Security </strong>| <strong class="bold">Record Rules</strong> menu option, as shown in the following screenshot:</p>
			<div><div><img src="img/B20997_10_5.jpg" alt="Figure 10.5 – ACLs for the Hostel model"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.5 – ACLs for the Hostel model</p>
			<p>The following are the most important record rule fields that were used in this example:</p>
			<ul>
				<li><code>name</code>): A descriptive title for the rule.</li>
				<li><code>model_id</code>): A reference to the model to which the rule applies.</li>
				<li><code>groups</code>): The security groups affected by the rule. If no security group is mentioned, the rule is deemed global and is enforced differently (keep reading to understand more about these groups).</li>
				<li><code>domain</code>): A domain expression that is used to filter the records. The rule is only going to apply to these filtered records.</li>
			</ul>
			<p>The first record rule we created was for the <code>Hostel User</code> security group. It uses the <code>[('is_public', '=', True)]</code> domain expression to select only the hostel that is available publicly. Thus, users with the <code>Hostel User</code> security group will only be able to see public hostels.</p>
			<p class="callout-heading">Note</p>
			<p class="callout"><em class="italic">The domain expressions used in the record rules are executed on the server using ORM objects. As a result, dot notation may be used on the fields on the left (the first tuple member). The </em><code>[('country_id.code', '=', 'IN')]</code><em class="italic"> domain expression, for example, will only return entries containing the country </em><em class="italic">of India.</em></p>
			<p>Since record <a id="_idIndexMarker731"/>rules are mostly based on the current user, you can use the <code>user</code> recordset on the right-hand side (the third tuple element) of the domain. So, if you want to show the records for the company of the current user, you can use the <code>[('conpany_id', '=', user.company_id.id)]</code> domain. Alternatively, if you want to show the records that are created by the current user, you can use the <code>[('user_id', '=', </code><code>user.id)]</code> domain.</p>
			<p>We want the <code>Hostel Manager</code> security group to have access to all hostels, regardless of whether they are public or private. Because it is a descendant of the <code>Hostel User</code> group, it will be able to see only public hostels until we intervene.</p>
			<p>The non-global record rules are joined using the <code>OR</code> logical operator; each rule adds access and never removes this access. For the <code>Hostel Manager</code> security group to have access to all the hostels, we must add a record rule to it so that it can add access for all hostels, as follows:</p>
			<pre class="source-code">
[('is_public', 'in', [True, False])]</pre>			<p>We chose to do<a id="_idIndexMarker732"/> this differently here and use the <code>[(1, '=', 1)]</code> special rule instead to unconditionally give access to all hostel records. While this may seem redundant, remember that if we don’t do this, the <code>Hostel User</code> rule can be customized in a way that will keep some hostel out of reach from the Settings user. The domain is special because the first element of a domain tuple must be a field name; this exact case is one of two cases where that is not true. The special domain of <code>[(1,</code><code> '=', 0)]</code> is never true, but also not very useful in the case of record rules. This is because this type of rule is used to restrict access to all the records. The same thing is also possible with access lists.</p>
			<p class="callout-heading">Important information</p>
			<p class="callout">Record rules are ignored if you’ve activated <code>SUPERUSER</code> mode. When testing your record rules, ensure that you use another user for that.</p>
			<h2 id="_idParaDest-500"><a id="_idTextAnchor576"/>There’s more...</h2>
			<p>When a record rule is not assigned to a security group, it is labeled as global and treated differently from the other rules.</p>
			<p><code>AND</code> operator. They are used in standard modules to create multi-company security access so that each user may only see data from their own business.</p>
			<p>In summary, standard non-global record rules are combined with an <code>OR</code> operator, and a record is accessible if any of the rules grant that access. When using an <code>AND</code> operator, global record rules add limits to the access provided by conventional record rules. Regular record rules cannot override restrictions imposed by global record rules.</p>
			<h1 id="_idParaDest-501"><a id="_idTextAnchor577"/>Activating features with security groups</h1>
			<p>Some <a id="_idIndexMarker734"/>functions can be restricted by security groups so that they can <a id="_idIndexMarker735"/>only be accessible to people who belong to these groups. Security groups can inherit other groups, granting them permissions as well.</p>
			<p>These two features are utilized to provide a feature toggling functionality in Odoo. Security groups may also be used to activate or disable functionality for certain users or the whole Odoo instance.</p>
			<p>This recipe demonstrates how to add options to configuration settings and demonstrates the two approaches for enabling extra features: making them visible through security groups or adding them by installing an additional module.</p>
			<p>For the first case, we will make the hostel start dates an optional additional feature while for the second, as an example, we will provide an option for installing the <em class="italic">Notes</em> module.</p>
			<h2 id="_idParaDest-502"><a id="_idTextAnchor578"/>Getting ready</h2>
			<p>This tutorial uses the <code>my_hostel</code> module, which was described in <a href="B20997_03.xhtml#_idTextAnchor083"><em class="italic">Chapter 3</em></a>, <em class="italic">Creating Odoo Add-On Modules</em>. We will need security groups to work with, so you also need to have followed the <em class="italic">Adding security access to models</em> recipe in this chapter.</p>
			<p>In this recipe, some identifiers need to refer to the add-on module’s technical name. We will assume that this is <code>my_hostel</code>. If you are using a different name, replace <code>my_hostel</code> with the actual technical name of your add-on module.</p>
			<h2 id="_idParaDest-503"><a id="_idTextAnchor579"/>How to do it...</h2>
			<p>To add <a id="_idIndexMarker736"/>the configuration <a id="_idIndexMarker737"/>options, follow these steps:</p>
			<ol>
				<li>To add the necessary dependency and the new XML data files, edit the <code>__manifest__.py</code> file like this and check that it depends on <code>base_setup</code>:<pre class="source-code">
{  'name': 'Cookbook code',
    'category': 'Hostel',
    'depends': ['base_setup'],
    'data': [
        'security/ir.model.access.csv',
        'security/groups.xml',
        'views/hostel_hostel.xml',
        'views/res_config_settings.xml',
    ],
}</pre></li>				<li>To add<a id="_idIndexMarker738"/> the new security group that’s used for feature <a id="_idIndexMarker739"/>activation, edit the <code>security/groups.xml</code> file and add the following record to it:<pre class="source-code">
    &lt;record id="group_start_date" model="res.groups"&gt;
        &lt;field name="name"&gt;Hostel: Start date feature&lt;/field&gt;
        &lt;field name="category_id" ref=<a id="_idTextAnchor580"/>"base.module_category_hidden" /&gt;
    &lt;/record&gt;</pre></li>				<li>To make the hostel start date visible only when this option is enabled, edit the field definition in the <code>models/hostel.py</code> file:<pre class="source-code">
class Hoste<a id="_idTextAnchor581"/>lHostel(models.Model):
    # ...
    date_start = fields.Date(
        'Start Date',
        groups='my_hostel.group_start_date',    )</pre></li>				<li>Edit the <code>models/__init__.py</code> file to add a new Python file for the configuration settings model:<pre class="source-code">
from . import hostel
from . import res_config_settings</pre></li>				<li>To extend <a id="_idIndexMarker740"/>the core configuration wizard by<a id="_idIndexMarker741"/> adding new options to it, add the <code>models/res_config_settings.py</code> file with the following cod<a id="_idTextAnchor582"/>e:<pre class="source-code">
from odoo import models, fields
class ConfigSettings(models.TransientModel):
    _inherit = 'res.config.settings'
    group_start_date = fields.Boolean(
            "Manage Hostel Start dates",
            group='base.group_user',
            implied_group='my_hostel.group_start_dates',
    )
    module_note = f<a id="_idTextAnchor583"/>ields.Boolean("Install Notes app")</pre></li>				<li>To make the options available in the UI, add <code>views/res_config_settings.xml</code>, which extends the settings form view:<pre class="source-code">
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;odoo&gt;
    &lt;record id="view_general_config_hostel" model="ir.ui.view"&gt;
        &lt;field name="name"&gt;Configuration: add Hostel options&lt;/field&gt;
        &lt;field name="model"&gt;res.config.settings&lt;/field&gt;
        &lt;field name="inherit_id" ref="base_setup.res_config_settings_view_form" /&gt;
        &lt;field name="arch" type="xml"&gt;
            &lt;div id="business_documents" position="before"&gt;
             &lt;h2&gt;Hostel&lt;/h2&gt;
                &lt;div class="row mt16 o_settings_container"&gt;
                    &lt;!-- Add Step 7 and 8 goes here --&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/field&gt;
    &lt;/record&gt;
&lt;/odoo&gt;</pre></li>				<li>In the settings<a id="_idIndexMarker742"/> form view, add the option to add a <a id="_idIndexMarker743"/>start date feature:<pre class="source-code">
&lt;!-- Start Dates option --&gt;
&lt;div class="col-12 col-lg-6 o_setting_box"&gt;
    &lt;div class="o_setting_left_pane"&gt;
        &lt;field name="group_start_date" class="oe_inline"/&gt;
    &lt;/div&gt;
    &lt;div class="o_setting_right_pane"&gt;
        &lt;label for="group_start_date"/&gt;
        &lt;div class="text-muted"&gt;
            Enable Start date feature on hostels
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;</pre></li>				<li>In <a id="_idIndexMarker744"/>the settings form view, add the option to <a id="_idIndexMarker745"/>install the Note module:<pre class="source-code">
&lt;!-- Note module option --&gt;
&lt;div class="col-12 col-lg-6 o_setting_box"&gt;
    &lt;div class="o_setting_left_pane"&gt;
        &lt;field name="module_note" class="oe_inline"/&gt;
    &lt;/div&gt;
    &lt;div class="o_setting_right_pane"&gt;
        &lt;label for="module_note"/&gt;
        &lt;div class="text-muted"&gt;
            Install note module
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;</pre></li>			</ol>
			<p>After upgrading the add-on module, the two new configuration options should be available at <strong class="bold">Settings</strong> | <strong class="bold">General Settings</strong>. The screen should look like this:</p>
			<div><div><img src="img/B20997_10_6.jpg" alt="Figure 10.6 – Hostel config in General Settings"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 10.6 – Hostel config in General Settings</p>
			<p>As shown in the preceding screenshot, you will have new settings in the <strong class="bold">Hostel</strong> section. The first option, <strong class="bold">Manage hostel start date</strong>, will enable the start date feature for the hostel record. The second option, <strong class="bold">Install Notes app</strong>, will install Odoo’s Notes app.</p>
			<h2 id="_idParaDest-504"><a id="_idTextAnchor584"/>How it works...</h2>
			<p>The<a id="_idIndexMarker746"/> core <code>base</code> module <a id="_idIndexMarker747"/>provides the <code>res.config.settings</code> model, which provides the business logic behind the activation option. The <code>base_setup</code> add-on module uses the <code>res.config.settings</code> model to provide several basic configuration options that can be made available inside a new database. It also makes the <strong class="bold">Settings</strong> | <strong class="bold">General Settings</strong> menu available.</p>
			<p>The <code>base_setup</code> module adapts <code>res.config.settings</code> to a central management dashboard, so we need to extend it to add configuration settings.</p>
			<p>If we decide to create a specific settings form for the Hostel app, we can still inherit from the <code>res.config.settings</code> model with a different <code>_name</code> and then, for the new model, provide the menu option and form view for just those settings. We already saw this method in the <em class="italic">Adding your own settings options</em> recipe of <a href="B20997_08.xhtml#_idTextAnchor388"><em class="italic">Chapter 8</em></a>, <em class="italic">Advanced Server-Side </em><em class="italic">Development Techniques</em>.</p>
			<p>We activated these functionalities in two ways: by activating a security group and making the functionality visible to the user, and by installing an add-on module that offers this feature. The fundamental <code>res.config.settings</code> model provides the logic necessary to handle both of these scenarios.</p>
			<p>The first step in this tutorial adds the <code>base_setup</code> add-on module to the dependencies since it provides extensions to the <code>res.config.settings</code> model we want to use. It also adds an additional XML data file that we will need to add the new options to the <strong class="bold">General </strong><strong class="bold">Settings</strong> form.</p>
			<p>In the second step, we created a new security group, <strong class="bold">Hostel: start date feature</strong>. The feature that needs to be activated should only be visible to that group, so it will be hidden until the group is enabled.</p>
			<p>In our example, we want the hostel start date to only be available when the corresponding configuration option is enabled. To achieve this, we can use the <code>groups</code> attribute on the field so that it is made available only for this security group. We did this at the model level so that it is automatically applied to all the UI views where the field is used.</p>
			<p>Finally, we extended the <code>res.config.settings</code> model to add the new options. Each option is a Boolean field, and its name must begin either with <code>group_</code> or <code>module_</code>, according to what we want it to do.</p>
			<p>The <code>group_</code> option<a id="_idIndexMarker748"/> field should have an <code>implied_group</code> attribute <a id="_idIndexMarker749"/>and should be a string that contains a comma-separated list of XML IDs for the security groups to activate when it is enabled. The XML IDs must be complete, with the module name, dot, and identifier name provided; for example, <code>module_name.identifier</code>.</p>
			<p>We can also provide a <code>group</code> attribute to specify which security groups the feature will be enabled for. It will be enabled for all the Employee-based groups if no groups are defined. Thus, the related groups won’t apply to portal security groups, since these don’t inherit from the Employee base security group like the other regular security groups do.</p>
			<p>The mechanism behind the activation is quite simple: it adds the security group in the <code>group</code> attribute to <code>implied_group</code>, thus making the related feature visible to the corresponding users.</p>
			<p>The <code>module_</code> option field does not require any additional attributes. The remaining part of the field name identifies the module to be installed when this option has been activated. In our example, <code>module_note</code> will install the Note module.</p>
			<p class="callout-heading">Important information</p>
			<p class="callout">Unchecking the box will uninstall the module without warning, which can cause data loss (models or fields and module data will be removed as a consequence). To avoid unchecking the box by accident, the <code>secure_uninstall</code> community module (from <a href="https://github.com/OCA/server-tools">https://github.com/OCA/server-tools</a>) prompts the user for a password before they uninstall the add-on module.</p>
			<h2 id="_idParaDest-505"><a id="_idTextAnchor585"/>There’s more...</h2>
			<p>Configuration settings can also have fields named with the <code>default_</code> prefix. When one of these has a value, the ORM will set it as a global default. The <code>settings</code> field should have a <code>default_model</code> attribute to identify the model that’s been affected, and the field name after the <code>default_</code> prefix identifies the <code>model</code> field that will have the default value set.</p>
			<p>Additionally, fields with none of the three prefixes mentioned can be used for other settings, but you will need to implement the logic to populate their values, using the <code>get_default_</code> name prefixed methods, and have them act when their values are edited using the <code>set_</code> name prefixed methods.</p>
			<p>For those who would like to dive deeper into the details of the configuration settings, take a look at Odoo’s source code in <code>./odoo/addons/base/models/res_config.py</code>, which is extensively commented on.</p>
			<h1 id="_idParaDest-506"><a id="_idTextAnchor586"/>Accessing recordsets as a superuser</h1>
			<p>We <a id="_idIndexMarker750"/>looked at <a id="_idIndexMarker751"/>security strategies including access rules, security groups, and record rules in prior recipes. You can avoid unauthorized access by using these approaches. However, in some complicated business scenarios, you may need to view or edit records, even if the user does not have access to them. For example, suppose the public user does not have access to the leads records, but the user may produce leads records in the backend by submitting the website form.</p>
			<p>You may access recordsets as a superuser by using <code>sudo()</code>. We covered <code>sudo()</code> in <a href="B20997_08.xhtml#_idTextAnchor388"><em class="italic">Chapter 8</em></a>, <em class="italic">Advanced Server-Side Development Techniques</em>, in the <em class="italic">Changing the user that performs an action</em> recipe. We’ll see here that even if you’ve set ACL rules or assigned a security group to the field, you may still acquire access using <code>sudo()</code>.</p>
			<h2 id="_idParaDest-507"><a id="_idTextAnchor587"/>How to do it...</h2>
			<p>We will <a id="_idIndexMarker752"/>use the same <code>my_hostel</code> module from the previous<a id="_idIndexMarker753"/> tutorial. We already have an ALC rule that gives read-only access to normal users. We will add a new field with security groups so that only the Manager user has access to it. After that, we will modify the field value for the normal user. Follow these steps to achieve this:</p>
			<ol>
				<li>Add the new field to the <code>hostel.hostel</code> model:<pre class="source-code">
details_added = fields.Text(
      string="Details",
      groups='my_hostel.group_hostel_manager')</pre></li>				<li>Add the field to the form view:<pre class="source-code">
&lt;field name="details_added"/&gt;</pre></li>				<li>Add the <code>add_details()</code> method to the <code>hostel.hostel</code> model:<pre class="source-code">
    def add_details(self):
        self.ensure_one()
        message = "Details are(added by: %s)" % self.env.user.name
        self.sudo().write({
            'details_added': message
        })</pre></li>				<li>Add the button to the form view so that we can trigger our method from the user interface. This should be placed inside the <code>&lt;</code><code>header&gt;</code> tag:<pre class="source-code">
&lt;button name="add_details"
    string="Add Details"
    type="object"/&gt;</pre></li>			</ol>
			<p>Restart<a id="_idIndexMarker754"/> the server and<a id="_idIndexMarker755"/> update the module to apply these changes.</p>
			<h2 id="_idParaDest-508"><a id="_idTextAnchor588"/>How it works...</h2>
			<p>In <em class="italic">Steps 1</em> and <em class="italic">2</em>, we added a new field called <code>details_added</code> to the model and form view. Note that we put the <code>my_hostel.group_hostel_manager</code> group on the field in Python, so this field can only be accessed by the Manager user.</p>
			<p>In the next step, we added the <code>add_details()</code> method. We updated the value of the <code>details_added()</code> field inside this method’s body. Note that we used <code>sudo()</code> before calling the write method.</p>
			<p>Finally, we added a button in the form view to trigger the method from the user interface.</p>
			<p>To test this implementation, you need to log in with the non-manager user. If you have loaded the database with demonstration data, you can log in with the demo user and then click on the <code>add_details()</code> method will be called, and this will write the message into the <code>details_added</code> field, even if the user doesn’t have proper rights. You can check the value of the field through the admin user because this field will be hidden from the demo user.</p>
			<p>Upon <a id="_idIndexMarker756"/>clicking the <code>add_details()</code> method as an argument, <code>self</code>. Before we wrote the values into the hostel recordset, we used <code>self.sudo()</code>. This returns the same recordset but with superuser rights. This recordset will have the <code>su=True</code> environment attribute, and it will bypass all access rules and record rules. Because of that, the non-manager user will be able to write in the hostel record.</p>
			<h2 id="_idParaDest-509"><a id="_idTextAnchor589"/>There’s more...</h2>
			<p>You need to be extra careful when you use <code>sudo()</code> because it bypasses all access rights. If you want to access the recordset as another user, you can pass the ID of that user inside <code>sudo</code> – for example, <code>self.sudo(uid)</code>. This will return a recordset containing the environment of that user. This way, it will not bypass all the access rules and record rules, but you can perform all the actions that are allowed for that user.</p>
			<h1 id="_idParaDest-510"><a id="_idTextAnchor590"/>Hiding view elements and menus based on groups</h1>
			<p>We covered <a id="_idIndexMarker758"/>how to hide fields from some users using <a id="_idIndexMarker759"/>group parameters in the Python field declaration in previous recipes. Another method for hiding fields in the user interface is to add security groups to the XML elements in the view specification. You may also conceal security groups from a certain user by using menus.</p>
			<h2 id="_idParaDest-511"><a id="_idTextAnchor591"/>Getting ready</h2>
			<p>For this recipe, we will reuse the <code>my_hostel</code> add-on module from the previous recipe. In the previous recipe, we added a button to the <code>&lt;header&gt;</code> tag. We will hide that whole header from a few users by adding a group attribute to it.</p>
			<p>Add the model, the views, and the menus for the <code>hostel.room.category</code> model. We will hide the category menus from a user. Please refer to <a href="B20997_04.xhtml#_idTextAnchor118"><em class="italic">Chapter 4</em></a>, <em class="italic">Application Models</em>, to learn how to add model views and menus.</p>
			<h2 id="_idParaDest-512"><a id="_idTextAnchor592"/>How to do it...</h2>
			<p>Follow <a id="_idIndexMarker760"/>these steps to hide elements based on security<a id="_idIndexMarker761"/> groups:</p>
			<ol>
				<li>Add a <code>groups</code> attribute to the <code>&lt;header&gt;</code> tag to hide it from other users:<pre class="source-code">
...
&lt;header groups="my_hostel.group_hostel_manager"&gt;
...</pre></li>				<li>Add the <code>groups</code> attribute to the <code>&lt;menuitem&gt;</code> hostel category so that it’s only displayed for librarian users:<pre class="source-code">
    &lt;menuitem name="Hostel Room Categories"
        id="hostel_room_category_menu"
        parent="hostel_base_menu"
        action="hostel_room_category_action"
        groups="my_hostel.group_hostel_manager"/&gt;</pre></li>			</ol>
			<p>Restart the server and update the module to apply these changes.</p>
			<h2 id="_idParaDest-513"><a id="_idTextAnchor593"/>How it works...</h2>
			<p>In <em class="italic">Step 1</em>, we added <code>groups="my_hostel.group_hostel_manager"</code> to the <code>&lt;header&gt;</code> tag. This means that the whole header part will only be visible to hostel users and hostel managers. Normal backend users who don’t have <code>group_hostel_manager</code> will not see the header part.</p>
			<p>In <em class="italic">Step 2</em>, we added the <code>groups="my_hostel.group_hostel_manager"</code> attribute to <code>menuitem</code>. This means that this menu is only visible to hostel users.</p>
			<p>You can use the <code>groups</code> attribute almost everywhere, including <code>&lt;field&gt;</code>, <code>&lt;notebook&gt;</code>, <code>&lt;group&gt;</code>, and <code>&lt;menuitems&gt;</code>, or on any tag from the view architecture. Odoo will hide those elements if the user doesn’t have that group. You can use the same group attributes in web pages and <em class="italic">QWeb reports</em>, which will be covered in <a href="B20997_12.xhtml#_idTextAnchor628"><em class="italic">Chapter 12</em></a>, <em class="italic">Automation, Workflows, Emails, and Printing</em>, and <a href="B20997_14.xhtml#_idTextAnchor734"><em class="italic">Chapter 14</em></a>, <em class="italic">CMS </em><em class="italic">Website Development</em>.</p>
			<p>As we saw<a id="_idIndexMarker762"/> in the <em class="italic">Accessing recordsets as a superuser</em> recipe of<a id="_idIndexMarker763"/> this chapter, we can hide fields from some users using the <code>groups</code> argument in the Python field definition. Note that there is a big difference between using security groups on fields and using Python security groups in views. Security groups in Python provide real security; unauthorized users can’t even access the fields through ORM or RPC calls. However, the groups in view are just for improving usability. Fields that are hidden through groups in the XML file can still be accessed through RPC or ORM.</p>
			<h2 id="_idParaDest-514"><a id="_idTextAnchor594"/>See also</h2>
			<p>Please refer to <a href="B20997_04.xhtml#_idTextAnchor118"><em class="italic">Chapter 4</em></a>, <em class="italic">Application Models</em>, to learn how to add model views and menus.</p>
		</div>
	</body></html>