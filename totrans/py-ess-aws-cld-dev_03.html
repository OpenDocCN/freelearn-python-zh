<html><head></head><body>
<div id="sbo-rt-content"><div id="_idContainer060">
<h1 class="chapter-number" id="_idParaDest-29"><a id="_idTextAnchor002"/>3</h1>
<h1 id="_idParaDest-30">Cloud Computing with Lambda</h1>
<p>In this chapter, we are going to learn the basics of Lambda and implement a Python application to be run in AWS Lambda. For this purpose, we will use our <span class="No-Break">AWS account.</span></p>
<p>The chapter covers the <span class="No-Break">following topics:</span></p>
<ul>
<li><span class="No-Break">Cloud computing</span></li>
<li>What <span class="No-Break">is Lambda?</span></li>
<li>A sample application <span class="No-Break">with Lambda</span></li>
<li>Important configurations <span class="No-Break">in Lambda</span></li>
<li>A <span class="No-Break">Lambda skeleton</span></li>
<li>A Lambda <span class="No-Break">returning value</span></li>
<li>Logging <a id="_idTextAnchor003"/><span class="No-Break">in Lambda</span></li>
<li>Filing a metadata parser application with Lambda <span class="No-Break">and S3</span></li>
</ul>
<h1 id="_idParaDest-31">Cloud computing</h1>
<p>Cloud computing <a id="_idIndexMarker027"/>allows you to use computer resources such as disk and memory without managing an infrastructure. The concept of the cloud is important in order to free you up to focus on your application. When you use your infrastructure, you need to buy or hire a computer, install all the necessary software, wire the cables, and keep the computer safe from physical as well as soft attacks. It is clear that it takes a significant amount of time; hence, your focus will be on reducing configuration time for your application. With cloud computing, you don’t have this kind of headache. The cloud provider takes most of the responsibility and sets up and maintains the data center for you. What you need to do is carry out some configuration and deploy your application to the data center. It makes your life easier; the cloud provider focuses on the infrastructure and you focus on the application. This is the biggest advantage of <span class="No-Break">cloud computing.</span></p>
<h1 id="_idParaDest-32">What is Lambda?</h1>
<p>Lambda<a id="_idIndexMarker028"/> is a computing service that allows you to run Python, Java, Node.js, Ruby, .NET, and Go code without provisioning and managing any server. In AWS, it is one of the most used services in the AWS stack. The only thing you need to do is develop and run your code. Lambda also has some advantages in terms <span class="No-Break">of cost.</span></p>
<p>Lambda is a container that is created by AWS in order to execute your application. When you create a Lambda function, AWS creates this container for you. Hence, you don’t need to provision an instance and install the compiler in the container. The only responsibility is to run your code when <span class="No-Break">selecting Lambda.</span></p>
<h2 id="_idParaDest-33">The advantages of Lambda</h2>
<p>The advantages <a id="_idIndexMarker029"/>of Lambda are <span class="No-Break">as follows:</span></p>
<ul>
<li>There’s no need to provision <span class="No-Break">a server</span></li>
<li>It is a <span class="No-Break">pay-as-you-go model</span></li>
<li>It supports different runtimes such as Python, Java, <span class="No-Break">and C#</span></li>
<li>There’s no need to install a software development kit, since it is ready <span class="No-Break">to develop</span></li>
<li>It has scalability features – if your process needs more resources, Lambda automatically <span class="No-Break">scales it</span></li>
<li>It saves a lot of time for your <span class="No-Break">operational management</span></li>
<li>It is <a id="_idIndexMarker030"/>able to constantly monitor your <span class="No-Break">Lambda functions</span></li>
</ul>
<h2 id="_idParaDest-34">The limitations of Lambda</h2>
<p>The limitations of<a id="_idIndexMarker031"/> Lambda are <span class="No-Break">as follows:</span></p>
<ul>
<li><strong class="bold">Timeout limit</strong>: If you have long-<a id="_idIndexMarker032"/>running functions, Lambda is not the best option. For now, Lambda has a 15-minute timeout limit. If the duration exceeds 15 minutes, you will receive a <span class="No-Break">timeout error.</span></li>
<li><strong class="bold">Memory limit</strong>: When you run<a id="_idIndexMarker033"/> the function, the process needs memory allocation based on the process flow. If your process needs a massive amount of memory, you will receive an error. In addition to that, Lambda’s cost is tied to the execution time<a id="_idIndexMarker034"/> and <span class="No-Break">memory used.</span></li>
</ul>
<p>You can check the up-to-date limits on the <a id="_idIndexMarker035"/>AWS Lambda quotas <span class="No-Break">page: </span><a href="https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-limits.xhtml"><span class="No-Break">https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-limits.xhtml</span></a><span class="No-Break">.</span></p>
<p>In this section, we looked at some advantages and limitations of Lambda. It is very useful when you need to run any type of application quickly, with no need for a server or detailed installation. Now, we will implement a simple application to learn Lambda and use these advantages to <span class="No-Break">our benefit.</span></p>
<h1 id="_idParaDest-35">A sample application with Lambda</h1>
<p>We<a id="_idIndexMarker036"/> are going to execute a sample application within Lambda step by step. To run a Python application on Lambda, take the <span class="No-Break">following steps:</span></p>
<ol>
<li>Go to the AWS <span class="No-Break">Management Console.</span></li>
<li>Type <strong class="source-inline">lambda</strong> in the search box and click on the <span class="No-Break">Lambda service:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer030">
<img alt="" height="352" src="image/Figure_3.1_B19195.jpg" width="1057"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.1 – AWS Management Console</p>
<ol>
<li value="3">Click <span class="No-Break"><strong class="bold">Create function</strong></span><span class="No-Break">.</span></li>
<li>On <a id="_idIndexMarker037"/>the <strong class="bold">Create function</strong> page, select <strong class="bold">Use a blueprint</strong>, and within the blueprint, select the <span class="No-Break"><strong class="bold">hello-world-python</strong></span><span class="No-Break"> application:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer031">
<img alt="" height="847" src="image/Figure_3.2_B19195.jpg" width="1099"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.2 – Create function</p>
<ol>
<li value="5">On <a id="_idIndexMarker038"/>the next screen, enter the name of the Lambda function and select the <span class="No-Break">security settings:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer032">
<img alt="" height="619" src="image/Figure_3.3_B19195.jpg" width="1100"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.3 – Naming the function</p>
<p>When you run a Lambda function, you need to define the role that Lambda can use to be able to do some actions, which is done under <strong class="bold">Execution role</strong>. The role defines your permissions in AWS and how to access other AWS services. For example, if Lambda needs to access a database, then it should have the database access security role. In this case, Lambda will have basic permission to run a sample Python function.</p>
<p>Once you create the Lambda function, you will have basic Python code to be tested:</p>
<div>
<div class="IMG---Figure" id="_idContainer033">
<img alt="" height="493" src="image/Figure_3.4_B19195.jpg" width="1061"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.4 – A sample Lambda function</p>
<ol>
<li value="6">Click <a id="_idIndexMarker039"/>the <strong class="bold">Test</strong> button. When you click it, you can also set <span class="No-Break">the parameters:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer034">
<img alt="" height="998" src="image/Figure_3.5_B19195.jpg" width="1101"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.5 – Running the Lambda function</p>
<p>After <a id="_idIndexMarker040"/>running the test, Lambda will run, and you will be able to see the results:</p>
<div>
<div class="IMG---Figure" id="_idContainer035">
<img alt="" height="467" src="image/Figure_3.6_B19195.jpg" width="1013"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.6 – The output of the Lambda function</p>
<p>We have <a id="_idIndexMarker041"/>created a sample Lambda function. Once you implement the application, as you can see, running the application is <span class="No-Break">very easy.</span></p>
<h1 id="_idParaDest-36">Important configurations in Lambda</h1>
<p>When you create a <a id="_idIndexMarker042"/>Lambda function, there are different configurations that need to be<a id="_idIndexMarker043"/> done in order to run it in an <span class="No-Break">efficient way:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer036">
<img alt="" height="465" src="image/Figure_3.7_B19195.jpg" width="994"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.7 – The Lambda configuration</p>
<p>We will use these configurations for the next example. Before starting with the example, let’s take a look at the definitions of <span class="No-Break">the configurations:</span></p>
<ul>
<li><strong class="bold">Memory</strong>: This<a id="_idIndexMarker044"/> configuration is used to define the memory limit of the<a id="_idIndexMarker045"/> application. You need to find the feasible <a id="_idIndexMarker046"/>amount of this value. If you define a large amount that is not used, it affects the cost. On the other hand, if you define a smaller amount of memory than is used, your application gives an <span class="No-Break">out-of-memory exception.</span></li>
<li><strong class="bold">Timeout</strong>: We <a id="_idIndexMarker047"/>mentioned that the Lambda function has a limitation in<a id="_idIndexMarker048"/> terms of timeout. You can provide a duration limit under which the Lambda function is supposed <span class="No-Break">to work.</span></li>
<li><strong class="bold">Ephemeral storage</strong>: This <a id="_idIndexMarker049"/>configuration allows setting a<a id="_idIndexMarker050"/> limit for a temporary filesystem. When you run the Lambda application, the <strong class="source-inline">/tmp</strong> folder is used for temporary storage and needs to be deleted after Lambda finishes <span class="No-Break">the process.</span></li>
<li><strong class="bold">Triggers</strong>: Triggers<a id="_idIndexMarker051"/> allow you to select an AWS source that runs a<a id="_idIndexMarker052"/> Lambda function. For example, S3, an object storage mechanism in AWS, could be a trigger for a Lambda function. We can add S3 configuration in Lambda such that when an object/file is uploaded to S3, it <span class="No-Break">triggers Lambda.</span></li>
<li><strong class="bold">Permissions</strong>: Permissions <a id="_idIndexMarker053"/>define what roles the Lambda function is able <a id="_idIndexMarker054"/>to access. For example, if you need to upload a file to S3 using a Lambda function, then the Lambda function should have an S3 object <strong class="source-inline">PUT</strong> permission in the <span class="No-Break">execution role.</span></li>
<li><strong class="bold">Destinations</strong>: When<a id="_idIndexMarker055"/> Lambda finishes the process, it can send<a id="_idIndexMarker056"/> information to other services, such as <span class="No-Break">a queue.</span></li>
<li><strong class="bold">Environment variable</strong>: This <a id="_idIndexMarker057"/>allows you to add an environment variable<a id="_idIndexMarker058"/> to be used in a Lambda application. For example, you can add a database URL to this configuration. If the database URL is changed, you don’t need to change <span class="No-Break">the code.</span></li>
<li><strong class="bold">Tags</strong>: Tags <a id="_idIndexMarker059"/>allow you to<a id="_idIndexMarker060"/> add a label to your AWS services. It is a good practice for when you search for or categorize services. For example, you may have two similar Lambda functions, the first of which is deployed by <a id="_idIndexMarker061"/>the <strong class="bold">Customer Relationship Management</strong> (<strong class="bold">CRM</strong>) team and the second of which is deployed by the order management team. Hence, you can give two tags to the functions, such as <strong class="source-inline">CRM</strong> and <strong class="source-inline">Order Management</strong>, allowing you to categorize your functions and facilitate searching as well. This is also used for <span class="No-Break">cost management.</span></li>
<li><strong class="bold">Virtual Private Cloud (VPC)</strong>: A VPC<a id="_idIndexMarker062"/> allows you to create AWS services in a virtual network environment that you define. You <a id="_idIndexMarker063"/>can separate AWS services into different network settings. As you see in the following diagram, two instances can be<a id="_idIndexMarker064"/> created in <span class="No-Break">different environments:</span></li>
</ul>
<div>
<div class="IMG---Figure" id="_idContainer037">
<img alt="" height="392" src="image/Figure_3.8_B19195.jpg" width="1050"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.8 – A VPC</p>
<ul>
<li><strong class="bold">Monitoring and operations tool</strong>: Lambda <a id="_idIndexMarker065"/>collects application logs by default, and they can be monitored via CloudWatch, which helps you to monitor an application. This<a id="_idIndexMarker066"/> tool is enabled by default, but you can also <span class="No-Break">disable it.</span></li>
</ul>
<p>The configuration of Lambda is important when creating a new function. It is good to know what configuration is used for what reason, hence enabling you to use Lambda in the <span class="No-Break">right way.</span></p>
<h1 id="_idParaDest-37">A Lambda skeleton</h1>
<p>When<a id="_idIndexMarker067"/> you implement a Lambda function via Python, you need to follow some rules in order to execute the application. When a Lambda function is run, it calls the <strong class="source-inline">handler</strong> method, which is shown with the <span class="No-Break">following syntax:</span></p>
<pre class="source-code">
def lambda_handler(event, context):
    ...
    return some_value</pre>
<p>As you see, the first parameter is the <strong class="source-inline">event</strong> object. An <strong class="source-inline">event</strong> object consists of JSON in order to process data as a parameter. You can see a sample <span class="No-Break">parameter here:</span></p>
<pre class="source-code">
{
  "Temperature": 10,
  "Wind": -5
}</pre>
<p>The second parameter shows information about the Lambda runtime. You can see some of the runtime <span class="No-Break">fields here:</span></p>
<ul>
<li><strong class="source-inline">function_name</strong> (the name of <span class="No-Break">the function)</span></li>
<li><strong class="source-inline">function_version</strong> (the version of <span class="No-Break">the function)</span></li>
<li><strong class="source-inline">memory_limit_in_mb</strong> (the Lambda function <span class="No-Break">memory limit)</span></li>
</ul>
<p>We've looked at the main skeleton of the<a id="_idIndexMarker068"/> Python Lambda function. In the next section, we'll see how to return a value <span class="No-Break">from Lambda.</span></p>
<h1 id="_idParaDest-38">Lambda returning value</h1>
<p>In Lambda, you <a id="_idIndexMarker069"/>can return a value that is either a simple message or a complex event with JSON. In the following example, you can see a sample returning message <span class="No-Break">for Lambda:</span></p>
<pre class="source-code">
def handler_name(event, context):
    message = 'Weather det<a id="_idTextAnchor004"/>ails. Temperature: {} and Wind: {}!'.format(event['Temperature'], event['Wind'])
    return message</pre>
<p>In this example, Lambda takes <strong class="source-inline">Temperature</strong> and <strong class="source-inline">Wind</strong> as input and returns these parameters as a message. In the following example, you can see a more complex <span class="No-Break">return value:</span></p>
<pre class="source-code">
def handler_name(event, context):
    return {
     "statusCode": 200,
     "Temperature": 10,
     "Wind": -5
    }</pre>
<p>As you can see in this example, the return value consists of a simple object to be parsed by the invoker. For example, if Lambda is called by one of the Python applications, this object will be returned once Lambda finishes the process. In general, this parameter allows you to run a Python application with different behavior. In the next section, we'll see how to log information <span class="No-Break">in Lambda.</span></p>
<h1 id="_idParaDest-39">Logging in Lambda</h1>
<p>It is important to use<a id="_idIndexMarker070"/> logging functionality in order to trace your application. In some cases, you need to get information about an application; alternatively, you may be processing data via Lambda and you may get an exceptional result. Hence, logging is helpful to check the information to understand the real problem in <span class="No-Break">the application.</span></p>
<p>There are multiple logging libraries<a id="_idIndexMarker071"/> that you can use in Lambda, including this <span class="No-Break">one: </span><a href="https://docs.python.org/3/library/logging.xhtml"><span class="No-Break">https://docs.python.org/3/library/logging.xhtml</span></a></p>
<p>In the following example, just add a log and return <span class="No-Break">a value:</span></p>
<pre class="source-code">
import logging
logger = logging.getLogger()
logger.setLevel(logging.INFO<a id="_idTextAnchor005"/>)
def handler_name(event, context):
    logger.info('Process has finished and result will be returned')
    return {
     "statusCode": 200,
     "Temperature": 10,
     "Wind": -5
    }</pre>
<p>I always <a id="_idIndexMarker072"/>recommend adding some logs within an application; it is one of the best practices for being a good developer. In addition to that, we are going to dive deeper into CloudWatch, which is a logging and monitoring service <span class="No-Break">in AWS.</span></p>
<h1 id="_idParaDest-40">Filing a metadata parser application with Lambda and S3</h1>
<p>We are going to execute another application within Lambda. In this case, Lambda will be triggered by S3. S3<a id="_idIndexMarker073"/> is an object storage service to which you can upload different types of files, such as image, CSV, and text files. In this example, when you upload a file to S3, the service will trigger the Lambda function, which in turn will provide information about file metadata. Let’s implement the<a id="_idIndexMarker074"/> application<a id="_idIndexMarker075"/> step <span class="No-Break">by</span><span class="No-Break"><a id="_idIndexMarker076"/></span><span class="No-Break"> step:</span></p>
<ol>
<li>Log in to the AWS <span class="No-Break">Management Console.</span></li>
<li>Type <strong class="source-inline">lambda</strong> in the search box and go to the <span class="No-Break">Lambda service.</span></li>
<li>Click <span class="No-Break"><strong class="bold">Create function</strong></span><span class="No-Break">.</span></li>
<li>On the <strong class="bold">Create function</strong> page, select <strong class="bold">Author from scratch</strong> and then in the <strong class="bold">Runtime</strong> field, select <span class="No-Break"><strong class="bold">Python 3.9</strong></span><span class="No-Break">:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer038">
<img alt="" height="947" src="image/Figure_3.9_B19195.jpg" width="1102"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.9 – Create function</p>
<ol>
<li value="5">In<a id="_idIndexMarker077"/> the <strong class="bold">Permissions</strong> section, select <strong class="bold">Amazon S3 object read-only permissions</strong> under <strong class="bold">Policy templates</strong> and<a id="_idIndexMarker078"/> enter a role name. In this case, I <a id="_idIndexMarker079"/>entered <strong class="source-inline">S3TriggerLambdaReadRole</strong>. The role is required to read the file from the <span class="No-Break">S3 service:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer039">
<img alt="" height="1035" src="image/Figure_3.10_B19195.jpg" width="1194"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.10 – Permissions</p>
<ol>
<li value="6">Click<a id="_idIndexMarker080"/> the <strong class="bold">Create function</strong> button <a id="_idIndexMarker081"/>at the bottom of <span class="No-Break">the </span><span class="No-Break"><a id="_idIndexMarker082"/></span><span class="No-Break">page:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer040">
<img alt="" height="168" src="image/Figure_3.11_B19195.jpg" width="922"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.11 – Create function</p>
<ol>
<li value="7">In order to read object metadata, paste the following code snippet into the Lambda function and click the <span class="No-Break"><strong class="bold">Deploy</strong></span><span class="No-Break"> button:</span><pre class="console">
import json
import urllib.parse
import boto3
print('Loading function')
s3 = boto3.client('s3')
def lambda_handler(event, context):
    #print("Received event: " + json.dumps(event, indent=2))
    # Get the object from the event and show its content type
    bucket = event['Records'][0]['s3']['bucket']['name']
    key = urllib.parse.unquote_plus(event['Records'][0]['s3']['object']['key'], encoding='utf-8')
    try:
        response = s3.get_object(Bucket=bucket, Key=key)
        print("CONTENT TYPE: " + response['ContentType'])
        return response['ContentType']
    except Exception as e:
        print(e)
        print('Error getting object {} from bucket {}. Make sure they exist and your zbucket is in the same region as this function.'.format(key, bucket))
        raise e</pre></li>
</ol>
<p>You can also find the original code block from AWS: <a href="https://docs.aws.amazon.com/lambda/latest/dg/with-s3-example.xhtml">https://docs.aws.amazon.com/lambda/latest/dg/with-s3-example.xhtml</a>.</p>
<p><strong class="bold">Boto3</strong> is<a id="_idIndexMarker083"/> used to manage AWS services for Python. We created an S3 client to access and manage the S3 service.</p>
<p>The<a id="_idIndexMarker084"/> application is triggered <a id="_idIndexMarker085"/>when you put a file into S3. In <a id="_idIndexMarker086"/>the code snippet, the code gets the bucket information from the <strong class="source-inline">bucket</strong> variable. The <strong class="source-inline">urllib</strong> library allows you to parse an S3 key in order to retrieve an S3 object via the <strong class="source-inline">get_object</strong> method. Then, we print the content type.</p>
<p>You can also see the latest code snippet within Lambda:</p>
<div>
<div class="IMG---Figure" id="_idContainer041">
<img alt="" height="557" src="image/Figure_3.12_B19195.jpg" width="1000"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.12 – A Lambda function with code</p>
<ol>
<li value="8">It is time to create an S3 object. Type <strong class="source-inline">s3</strong> in the AWS Services <span class="No-Break">search box:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer042">
<img alt="" height="229" src="image/Figure_3.13_B19195.jpg" width="1099"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.13 – Searching S3</p>
<ol>
<li value="9">Go to<a id="_idIndexMarker087"/> the <span class="No-Break"><strong class="bold">S3</strong></span><span class="No-Break"> service.</span></li>
<li>Within<a id="_idIndexMarker088"/> the <strong class="bold">S3</strong> service, click<a id="_idIndexMarker089"/> the <strong class="bold">Create </strong><span class="No-Break"><strong class="bold">bucket</strong></span><span class="No-Break"> button:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer043">
<img alt="" height="198" src="image/Figure_3.14_B19195.jpg" width="1182"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.14 – Creating an S3 bucket</p>
<ol>
<li value="11">Give a unique name to the S3 bucket. The bucket is like a folder, and you can authorize it to upload files such as image and CSV files. Note that the bucket name should <span class="No-Break">be unique:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer044">
<img alt="" height="639" src="image/Figure_3.15_B19195.jpg" width="1101"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.15 – Entering a bucket name</p>
<p>Now, you should see a list of buckets and the bucket that you created:</p>
<div>
<div class="IMG---Figure" id="_idContainer045">
<img alt="" height="487" src="image/Figure_3.16_B19195.jpg" width="1170"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.16 – A bucket list</p>
<p>We have created an <a id="_idIndexMarker090"/>S3 bucket. Now, we <a id="_idIndexMarker091"/>need to make a small configuration that<a id="_idIndexMarker092"/> triggers a Lambda function when a file is uploaded <span class="No-Break">to S3:</span></p>
<ol>
<li>Click the bucket link. For this sample, we need to click <strong class="bold">inputforlambda123</strong>. It changes based on the creation name that the user inputted at <span class="No-Break">the beginning:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer046">
<img alt="" height="506" src="image/Figure_3.17_B19195.jpg" width="970"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.17 – The bucket list</p>
<ol>
<li value="2">Click<a id="_idIndexMarker093"/> the <span class="No-Break"><strong class="bold">Properties</strong></span><span class="No-Break"> tab:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer047">
<img alt="" height="521" src="image/Figure_3.18_B19195.jpg" width="1102"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.18 – The features of the bucket</p>
<ol>
<li value="3">At the<a id="_idIndexMarker094"/> bottom of the <strong class="bold">Properties</strong> page, find <a id="_idIndexMarker095"/>the <strong class="bold">Event </strong><span class="No-Break"><strong class="bold">notifications</strong></span><span class="No-Break"> tab.</span></li>
<li>Click the <strong class="bold">Create event </strong><span class="No-Break"><strong class="bold">notification</strong></span><span class="No-Break"> button:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer048">
<img alt="" height="252" src="image/Figure_3.19_B19195.jpg" width="1099"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.19 – The Event notifications tab</p>
<ol>
<li value="5">In the form, fill out the event name and select the event type in the <strong class="bold">Event types</strong> section. For this example, we are going to select the <strong class="bold">All object create events</strong> option. Hence, when<a id="_idIndexMarker096"/> an object<a id="_idIndexMarker097"/> is created, the Lambda function <a id="_idIndexMarker098"/>will <span class="No-Break">be triggered:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer049">
<img alt="" height="778" src="image/Figure_3.20_B19195.jpg" width="1099"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.20 – Event configuration</p>
<ol>
<li value="6">At the bottom of the page, select the Lambda function that will be triggered, under the <strong class="bold">Destination</strong> section, and click the <strong class="bold">Save </strong><span class="No-Break"><strong class="bold">changes</strong></span><span class="No-Break"> button:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer050">
<img alt="" height="817" src="image/Figure_3.21_B19195.jpg" width="1101"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.21 – The event destination</p>
<p>You <a id="_idIndexMarker099"/>should see a success message<a id="_idIndexMarker100"/> in<a id="_idIndexMarker101"/> the <span class="No-Break">AWS console:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer051">
<img alt="" height="134" src="image/Figure_3.22_B19195.jpg" width="978"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.22 – The event destination</p>
<p>You can also double-check with Lambda whether the event has been successfully created. When you click the respective Lambda function, it shows the <span class="No-Break">event source:</span></p>
<div>
<div class="IMG---Figure" id="_idContainer052">
<img alt="" height="547" src="image/Figure_3.23_B19195.jpg" width="787"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.23 – Lambda with a trigger</p>
<p>At the <a id="_idIndexMarker102"/>moment, you are able to see the<a id="_idIndexMarker103"/> Lambda function on the left side as a<a id="_idIndexMarker104"/> trigger. It is time to test our <span class="No-Break">Lambda trigger:</span></p>
<ol>
<li>Open the S3 bucket that you created and navigate to it. After that, click the <span class="No-Break"><strong class="bold">Upload</strong></span><span class="No-Break"> button:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer053">
<img alt="" height="532" src="image/Figure_3.24_B19195.jpg" width="1080"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.24 – An S3 bucket</p>
<ol>
<li value="2">Click<a id="_idIndexMarker105"/> the <strong class="bold">Add files</strong> button, which <a id="_idIndexMarker106"/>allows you to add any kind of<a id="_idIndexMarker107"/> file from your computer. For this example, we have uploaded one RTF file. You can also upload an image, PDF, or whatever <span class="No-Break">you want:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer054">
<img alt="" height="522" src="image/Figure_3.25_B19195.jpg" width="1100"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.25 – The S3 Upload page</p>
<p>The following screenshot shows that you have successfully uploaded the <strong class="source-inline">testTriggr.rtf</strong> file to S3. S3 also gives some details regarding files, such as the type, the<a id="_idIndexMarker108"/> latest modification <a id="_idIndexMarker109"/>time, as well as the size. If you have<a id="_idIndexMarker110"/> more files, you can see a file list under the <strong class="bold">Objects</strong> panel:</p>
<div>
<div class="IMG---Figure" id="_idContainer055">
<img alt="" height="222" src="image/Figure_3.26_B19195.jpg" width="1650"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.26 – The S3 file list</p>
<p>As we have uploaded a file to S3, the Lambda function should work. It is time to check whether that is the case. Navigate to the Lambda function:</p>
<div>
<div class="IMG---Figure" id="_idContainer056">
<img alt="" height="866" src="image/Figure_3.27_B19195.jpg" width="1102"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.27 – The Lambda function</p>
<ol>
<li value="3">Click <a id="_idIndexMarker111"/>the <strong class="bold">Monitor</strong> tab, and<a id="_idIndexMarker112"/> you should be able to see that the <a id="_idIndexMarker113"/>Lambda <span class="No-Break">is called:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer057">
<img alt="" height="568" src="image/Figure_3.28_B19195.jpg" width="822"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.28 — Monitor in Lambda</p>
<p>We can also check the detailed logs via CloudWatch. As we mentioned early, CloudWatch helps you to check AWS service logs.</p>
<ol>
<li value="4">On the <a id="_idIndexMarker114"/>same page, click <strong class="bold">View logs in CloudWatch</strong>. You will <a id="_idIndexMarker115"/>be redirected to the <span class="No-Break">CloudWatch</span><span class="No-Break"><a id="_idIndexMarker116"/></span><span class="No-Break"> service:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer058">
<img alt="" height="226" src="image/Figure_3.29_B19195.jpg" width="1636"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.29 – The CloudWatch service</p>
<ol>
<li value="5">When <a id="_idIndexMarker117"/>you click the link under <strong class="bold">Log stream</strong>, you<a id="_idIndexMarker118"/> will be able to see the logs<a id="_idIndexMarker119"/> that you implemented in the <span class="No-Break">Lambda function:</span></li>
</ol>
<div>
<div class="IMG---Figure" id="_idContainer059">
<img alt="" height="222" src="image/Figure_3.30_B19195.jpg" width="1100"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 3.30 – CloudWatch logs</p>
<p>You can also upload different types of files in order to test the Lambda function as well as the <span class="No-Break">CloudWatch logs.</span></p>
<p>We implemented a simple Python application integrated with S3. When you add a file to a storage mechanism, it triggers the Lambda function in order to process the file. As you saw in this example, you can test your Python code without provisioning a server and installing the Python library. Lambda comes with logging, monitoring, and object <span class="No-Break">storage capabilities.</span></p>
<h1 id="_idParaDest-41">Summary</h1>
<p>In this chapter, we dived into Lambda, which is one of the most important services in AWS. Lambda helps you to deploy and run your application without provisioning a server, which facilitates deployment time. We also touched upon the S3 service, which is used for object storage and has good integration with Lambda. In the following chapter, we will take a look at how to provision a server and run a Python application on an <span class="No-Break">AWS-based server.</span></p>
</div>
</div></body></html>