<html xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<meta charset="utf-8"/>
<meta content="pandoc" name="generator"/>
<title>ch019.xhtml</title>
<link href="../styles/stylesheet1.css" rel="stylesheet" type="text/css"/>
<!-- kobo-style -->
<style id="koboSpanStyle" type="text/css" xmlns="http://www.w3.org/1999/xhtml">.koboSpan { -webkit-text-combine: inherit; }</style>
</head>
<body epub:type="bodymatter">
<section class="level1" data-number="19" id="chapter-15-project-5.1-modeling-base-application">
<h1 data-number="19"><span class="titlemark"><span class="koboSpan" id="kobo.1.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 15</span></span><br/>
<span id="x1-32500015"/><span class="koboSpan" id="kobo.2.1" xmlns="http://www.w3.org/1999/xhtml">Project 5.1: Modeling Base Application</span></h1>
<p><span class="koboSpan" id="kobo.3.1" xmlns="http://www.w3.org/1999/xhtml">The next step in the pipeline from acquisition to clean-and-convert is the analysis and some preliminary modeling of the data. </span><span class="koboSpan" id="kobo.3.2" xmlns="http://www.w3.org/1999/xhtml">This may lead us to use the data for a more complex model or perhaps machine learning. </span><span class="koboSpan" id="kobo.3.3" xmlns="http://www.w3.org/1999/xhtml">This chapter will guide you through creating another application in the three-stage pipeline to acquire, clean, and model a collection of data. </span><span class="koboSpan" id="kobo.3.4" xmlns="http://www.w3.org/1999/xhtml">This first project will create the application with placeholders for more detailed and application-specific modeling components. </span><span class="koboSpan" id="kobo.3.5" xmlns="http://www.w3.org/1999/xhtml">This makes it easier to insert small statistical models that can be replaced with more elaborate processing if needed.</span></p>
<p><span class="koboSpan" id="kobo.4.1" xmlns="http://www.w3.org/1999/xhtml">In this chapter, we’ll look at two parts of data analysis:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.5.1" xmlns="http://www.w3.org/1999/xhtml">CLI architecture and how to design a more complex pipeline of processes for gathering and analyzing data</span></p></li>
<li><p><span class="koboSpan" id="kobo.6.1" xmlns="http://www.w3.org/1999/xhtml">The core concepts of creating a statistical model of the data</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.7.1" xmlns="http://www.w3.org/1999/xhtml">Viewed from a distance, all analytical work can be considered to be creating a simplified model of important features of some complicated processes. </span><span class="koboSpan" id="kobo.7.2" xmlns="http://www.w3.org/1999/xhtml">Even something as simple-sounding as computing an average suggests a simple model of the central tendency of a variable. </span><span class="koboSpan" id="kobo.7.3" xmlns="http://www.w3.org/1999/xhtml">Adding a standard deviation suggests an expected range for the variable’s values and – further – assigns a probability to values outside the range.</span></p>
<p><span class="koboSpan" id="kobo.8.1" xmlns="http://www.w3.org/1999/xhtml">Models, can, of course, be considerably more detailed. </span><span class="koboSpan" id="kobo.8.2" xmlns="http://www.w3.org/1999/xhtml">Our purpose is to start down the path of modeling in a way that builds flexible, extensible application software. </span><span class="koboSpan" id="kobo.8.3" xmlns="http://www.w3.org/1999/xhtml">Each application will have unique modeling requirements, depending on the nature of the data, and the nature of the questions being asked about the data. </span><span class="koboSpan" id="kobo.8.4" xmlns="http://www.w3.org/1999/xhtml">For some processes, means and standard deviations are adequate for spotting outliers. </span><span class="koboSpan" id="kobo.8.5" xmlns="http://www.w3.org/1999/xhtml">For other processes, a richer and more detailed simulation may be required to estimate the expected distribution of data.</span></p>
<p><span class="koboSpan" id="kobo.9.1" xmlns="http://www.w3.org/1999/xhtml">We’ll start the modeling by looking at variables in isolation, sometimes called </span><em><span class="koboSpan" id="kobo.10.1" xmlns="http://www.w3.org/1999/xhtml">univariate </span></em><span class="koboSpan" id="kobo.11.1" xmlns="http://www.w3.org/1999/xhtml">statistics. </span><span class="koboSpan" id="kobo.11.2" xmlns="http://www.w3.org/1999/xhtml">This will </span><span id="dx1-325001"/><span class="koboSpan" id="kobo.12.1" xmlns="http://www.w3.org/1999/xhtml">examine a variety of commonly recognized distributions of data. </span><span class="koboSpan" id="kobo.12.2" xmlns="http://www.w3.org/1999/xhtml">These distributions generally have a few parameters that can be discovered from the given data. </span><span class="koboSpan" id="kobo.12.3" xmlns="http://www.w3.org/1999/xhtml">In this chapter, we’ll also look at measures like mean, median, standard deviation, variance, and standard deviation. </span><span class="koboSpan" id="kobo.12.4" xmlns="http://www.w3.org/1999/xhtml">These can be used to describe data that has a normal or Gaussian distribution. </span><span class="koboSpan" id="kobo.12.5" xmlns="http://www.w3.org/1999/xhtml">The objective is to create create a CLI application separate from an analytic notebook used to present results. </span><span class="koboSpan" id="kobo.12.6" xmlns="http://www.w3.org/1999/xhtml">This creates a higher degree of automation for modeling. </span><span class="koboSpan" id="kobo.12.7" xmlns="http://www.w3.org/1999/xhtml">The results may then be presented in an analytical notebook.</span></p>
<p><span class="koboSpan" id="kobo.13.1" xmlns="http://www.w3.org/1999/xhtml">There is a longer-term aspect to having automated model creation. </span><span class="koboSpan" id="kobo.13.2" xmlns="http://www.w3.org/1999/xhtml">Once a data model has been created, an analyst can also look at changes to a model and what implications the changes should have on the way an enterprise operates. </span><span class="koboSpan" id="kobo.13.3" xmlns="http://www.w3.org/1999/xhtml">For example, an application may perform a monthly test to be sure new data matches the established mean, median, and standard deviation reflecting the expected normal distribution of data. </span><span class="koboSpan" id="kobo.13.4" xmlns="http://www.w3.org/1999/xhtml">In the event that a batch of data doesn’t fit the established model, further investigation is required to uncover the root cause of this change. </span><span id="x1-325002r348"/></p>
<section class="level2" data-number="19.1" id="description-21">
<h2 data-number="19.1"><span class="titlemark"><span class="koboSpan" id="kobo.14.1" xmlns="http://www.w3.org/1999/xhtml">15.1 </span></span> <span id="x1-3260001"/><span class="koboSpan" id="kobo.15.1" xmlns="http://www.w3.org/1999/xhtml">Description</span></h2>
<p><span class="koboSpan" id="kobo.16.1" xmlns="http://www.w3.org/1999/xhtml">This application will create a report on a dataset presenting a number of statistics. </span><span class="koboSpan" id="kobo.16.2" xmlns="http://www.w3.org/1999/xhtml">This automates the ongoing monitoring </span><span id="dx1-326001"/><span class="koboSpan" id="kobo.17.1" xmlns="http://www.w3.org/1999/xhtml">aspect of an Analysis Notebook, reducing the manual steps and creating reproducible results. </span><span class="koboSpan" id="kobo.17.2" xmlns="http://www.w3.org/1999/xhtml">The automated computations stem from having a statistical model for the data, often created in an analysis notebook, where alternative models are explored. </span><span class="koboSpan" id="kobo.17.3" xmlns="http://www.w3.org/1999/xhtml">This reflects variables with values in an expected range.</span></p>
<p><span class="koboSpan" id="kobo.18.1" xmlns="http://www.w3.org/1999/xhtml">For industrial monitoring, this is part of an activity called </span><strong><span class="koboSpan" id="kobo.19.1" xmlns="http://www.w3.org/1999/xhtml">Gage repeatability</span></strong> <strong><span class="koboSpan" id="kobo.20.1" xmlns="http://www.w3.org/1999/xhtml">and</span></strong> <strong><span class="koboSpan" id="kobo.21.1" xmlns="http://www.w3.org/1999/xhtml">r</span></strong><strong><span class="koboSpan" id="kobo.22.1" xmlns="http://www.w3.org/1999/xhtml">eproducibility</span></strong><span class="koboSpan" id="kobo.23.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.23.2" xmlns="http://www.w3.org/1999/xhtml">The activity seeks to confirm that measurements are repeatable and reproducible. </span><span class="koboSpan" id="kobo.23.3" xmlns="http://www.w3.org/1999/xhtml">This is described as looking at a “measurement instrument.” </span><span class="koboSpan" id="kobo.23.4" xmlns="http://www.w3.org/1999/xhtml">While we often think of an instrument as being a machine or a device, the definition is actually very broad. </span><span class="koboSpan" id="kobo.23.5" xmlns="http://www.w3.org/1999/xhtml">A survey or questionnaire is a measurement instrument focused on people’s responses to questions.</span></p>
<p><span class="koboSpan" id="kobo.24.1" xmlns="http://www.w3.org/1999/xhtml">When these computed statistics deviate from expectations, it suggests something has changed, and the analyst can use these unexpected values to investigate the root cause of the deviation. </span><span class="koboSpan" id="kobo.24.2" xmlns="http://www.w3.org/1999/xhtml">Perhaps some enterprise process has changed, leading to shifts in some metrics. </span><span class="koboSpan" id="kobo.24.3" xmlns="http://www.w3.org/1999/xhtml">Or, perhaps some enterprise software has been upgraded, leading to changes to the source data or encodings used to create the clean data. </span><span class="koboSpan" id="kobo.24.4" xmlns="http://www.w3.org/1999/xhtml">More complex still, it may be that the instrument doesn’t actually measure what we thought it measured; this new discrepancy may expose a gap in our understanding.</span></p>
<p><span class="koboSpan" id="kobo.25.1" xmlns="http://www.w3.org/1999/xhtml">The repeatability of the model’s measurements is central to the usability of the measurements. </span><span class="koboSpan" id="kobo.25.2" xmlns="http://www.w3.org/1999/xhtml">Consider a ruler that’s so worn down over years of use that it is no longer square or accurate. </span><span class="koboSpan" id="kobo.25.3" xmlns="http://www.w3.org/1999/xhtml">This single instrument will produce different results depending on what part of the worn end is used to make the measurement. </span><span class="koboSpan" id="kobo.25.4" xmlns="http://www.w3.org/1999/xhtml">This kind of measurement variability may obscure the variability in manufacturing a part. </span><span class="koboSpan" id="kobo.25.5" xmlns="http://www.w3.org/1999/xhtml">Understanding the causes of changes is challenging and can require thinking “outside the box” — challenging assumptions about the real-world process, the measurements of the process, and the model of those measurements.</span></p>
<p><span class="koboSpan" id="kobo.26.1" xmlns="http://www.w3.org/1999/xhtml">Exploratory data analysis can be challenging and exhilarating precisely because there aren’t obvious, simple answers to explain why a measurement has changed.</span></p>
<p><span class="koboSpan" id="kobo.27.1" xmlns="http://www.w3.org/1999/xhtml">The implementation of this preliminary model is through an application, separate from the previous stages in the pipeline to acquire and clean the data. </span><span class="koboSpan" id="kobo.27.2" xmlns="http://www.w3.org/1999/xhtml">With some careful design, this stage can be combined with those previous stages, creating a combined sequence of operations to acquire, clean, and create the summary statistics.</span></p>
<p><span class="koboSpan" id="kobo.28.1" xmlns="http://www.w3.org/1999/xhtml">This application will overlap with the analysis notebook and the initial inspection notebook. </span><span class="koboSpan" id="kobo.28.2" xmlns="http://www.w3.org/1999/xhtml">Some of the observations made during those earlier ad-hoc analysis stages will be turned into fixed, automated processing.</span></p>
<p><span class="koboSpan" id="kobo.29.1" xmlns="http://www.w3.org/1999/xhtml">This is the beginning of creating a </span><span id="dx1-326002"/><span class="koboSpan" id="kobo.30.1" xmlns="http://www.w3.org/1999/xhtml">more complicated machine-learning model of the data. </span><span class="koboSpan" id="kobo.30.2" xmlns="http://www.w3.org/1999/xhtml">In some cases, a statistical model using linear or logistic regression is adequate, and a more complex artificial intelligence model isn’t needed. </span><span class="koboSpan" id="kobo.30.3" xmlns="http://www.w3.org/1999/xhtml">In other cases, the inability to create a simple statistical model can point toward a need to create and tune the hyperparameters of a more complicated model.</span></p>
<p><span class="koboSpan" id="kobo.31.1" xmlns="http://www.w3.org/1999/xhtml">The objective of this application is to save a statistical summary report that can be aggregated with and compared to other summary reports. </span><span class="koboSpan" id="kobo.31.2" xmlns="http://www.w3.org/1999/xhtml">The ideal structure will be a document in an easy-to-parse notation. </span><span class="koboSpan" id="kobo.31.3" xmlns="http://www.w3.org/1999/xhtml">JSON is suggested, but other easier-to-read formats like TOML are also sensible.</span></p>
<p><span class="koboSpan" id="kobo.32.1" xmlns="http://www.w3.org/1999/xhtml">There are three key questions about data distribution:</span></p>
<ol>
<li><div id="x1-326004x1">
<p><span class="koboSpan" id="kobo.33.1" xmlns="http://www.w3.org/1999/xhtml">What is the </span><strong><span class="koboSpan" id="kobo.34.1" xmlns="http://www.w3.org/1999/xhtml">location </span></strong><span class="koboSpan" id="kobo.35.1" xmlns="http://www.w3.org/1999/xhtml">or expected value for the output being measured?</span></p>
</div></li>
<li><div id="x1-326006x2">
<p><span class="koboSpan" id="kobo.36.1" xmlns="http://www.w3.org/1999/xhtml">What is the </span><strong><span class="koboSpan" id="kobo.37.1" xmlns="http://www.w3.org/1999/xhtml">spread </span></strong><span class="koboSpan" id="kobo.38.1" xmlns="http://www.w3.org/1999/xhtml">or expected variation for this variable?</span></p>
</div></li>
<li><div id="x1-326008x3">
<p><span class="koboSpan" id="kobo.39.1" xmlns="http://www.w3.org/1999/xhtml">What is the general </span><strong><span class="koboSpan" id="kobo.40.1" xmlns="http://www.w3.org/1999/xhtml">shape</span></strong><span class="koboSpan" id="kobo.41.1" xmlns="http://www.w3.org/1999/xhtml">, e.g., is it symmetric or skewed in some way?</span></p>
</div></li>
</ol>
<p><span class="koboSpan" id="kobo.42.1" xmlns="http://www.w3.org/1999/xhtml">For more background on these questions, see </span><a class="url" href="https://www.itl.nist.gov/div898/handbook/ppc/section1/ppc131.htm"><span class="koboSpan" id="kobo.43.1" xmlns="http://www.w3.org/1999/xhtml">https://www.itl.nist.gov/div898/handbook/ppc/section1/ppc131.htm</span></a></p>
<p><span class="koboSpan" id="kobo.44.1" xmlns="http://www.w3.org/1999/xhtml">This summary processing will become part of an automated acquire, clean, and summarize operation. </span><span class="koboSpan" id="kobo.44.2" xmlns="http://www.w3.org/1999/xhtml">The </span><strong><span class="koboSpan" id="kobo.45.1" xmlns="http://www.w3.org/1999/xhtml">User Experience </span></strong><span class="koboSpan" id="kobo.46.1" xmlns="http://www.w3.org/1999/xhtml">(</span><strong><span class="koboSpan" id="kobo.47.1" xmlns="http://www.w3.org/1999/xhtml">UX</span></strong><span class="koboSpan" id="kobo.48.1" xmlns="http://www.w3.org/1999/xhtml">) will </span><span id="dx1-326009"/><span class="koboSpan" id="kobo.49.1" xmlns="http://www.w3.org/1999/xhtml">be a command-line application. </span><span class="koboSpan" id="kobo.49.2" xmlns="http://www.w3.org/1999/xhtml">Our expected command line should look something like the following:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-227">
<div class="tcolorbox-content">
<pre class="console"><span class="koboSpan" id="kobo.50.1" xmlns="http://www.w3.org/1999/xhtml">% python src/summarize.py -o summary/series_1/2023/03 data/clean/Series_1.ndj</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.51.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.52.1" xmlns="http://www.w3.org/1999/xhtml">-o</span></code><span class="koboSpan" id="kobo.53.1" xmlns="http://www.w3.org/1999/xhtml"> option specifies the path to an output sub-directory. </span><span class="koboSpan" id="kobo.53.2" xmlns="http://www.w3.org/1999/xhtml">The output filename added to this path will be derived from </span><span id="dx1-326011"/><span class="koboSpan" id="kobo.54.1" xmlns="http://www.w3.org/1999/xhtml">the source file name. </span><span class="koboSpan" id="kobo.54.2" xmlns="http://www.w3.org/1999/xhtml">The source file name often encodes information on the applicable date range for the extracted data.</span></p>
<div class="tcolorbox tipbox" id="tcolobox-228">
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.55.1" xmlns="http://www.w3.org/1999/xhtml">The Anscombe’s Quartet data doesn’t change and wouldn’t really have an “applicable date” value.</span></p>
<p><span class="koboSpan" id="kobo.56.1" xmlns="http://www.w3.org/1999/xhtml">We’ve introduced the </span><strong><span class="koboSpan" id="kobo.57.1" xmlns="http://www.w3.org/1999/xhtml">idea </span></strong><span class="koboSpan" id="kobo.58.1" xmlns="http://www.w3.org/1999/xhtml">of periodic enterprise extractions. </span><span class="koboSpan" id="kobo.58.2" xmlns="http://www.w3.org/1999/xhtml">None of the projects actually specify a data source subject to periodic change.</span></p>
<p><span class="koboSpan" id="kobo.59.1" xmlns="http://www.w3.org/1999/xhtml">Some web services like </span><a class="url" href="http://www.yelp.com"><span class="koboSpan" id="kobo.60.1" xmlns="http://www.w3.org/1999/xhtml">http://www.yelp.com</span></a><span class="koboSpan" id="kobo.61.1" xmlns="http://www.w3.org/1999/xhtml"> have health-code data for food-service businesses; this is subject to periodic change and serves as a good source of analytic data.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.62.1" xmlns="http://www.w3.org/1999/xhtml">Now that we’ve seen the expectations, we can turn to an approach to the implementation. </span><span id="x1-326012r351"/></p>
</section>
<section class="level2" data-number="19.2" id="approach-16">
<h2 data-number="19.2"><span class="titlemark"><span class="koboSpan" id="kobo.63.1" xmlns="http://www.w3.org/1999/xhtml">15.2 </span></span> <span id="x1-3270002"/><span class="koboSpan" id="kobo.64.1" xmlns="http://www.w3.org/1999/xhtml">Approach</span></h2>
<p><span class="koboSpan" id="kobo.65.1" xmlns="http://www.w3.org/1999/xhtml">We’ll take some </span><span id="dx1-327001"/><span class="koboSpan" id="kobo.66.1" xmlns="http://www.w3.org/1999/xhtml">guidance from the C4 model ( </span><a class="url" href="https://c4model.com"><span class="koboSpan" id="kobo.67.1" xmlns="http://www.w3.org/1999/xhtml">https://c4model.com</span></a><span class="koboSpan" id="kobo.68.1" xmlns="http://www.w3.org/1999/xhtml">) when looking at our approach:</span></p>
<ul>
<li><p><strong><span class="koboSpan" id="kobo.69.1" xmlns="http://www.w3.org/1999/xhtml">Context</span></strong><span class="koboSpan" id="kobo.70.1" xmlns="http://www.w3.org/1999/xhtml">: For this project, a context diagram would show a user creating analytical reports. </span><span class="koboSpan" id="kobo.70.2" xmlns="http://www.w3.org/1999/xhtml">You may find it helpful to draw this diagram.</span></p></li>
<li><p><strong><span class="koboSpan" id="kobo.71.1" xmlns="http://www.w3.org/1999/xhtml">Containers</span></strong><span class="koboSpan" id="kobo.72.1" xmlns="http://www.w3.org/1999/xhtml">: There only seems to be one container: the user’s personal computer.</span></p></li>
<li><p><strong><span class="koboSpan" id="kobo.73.1" xmlns="http://www.w3.org/1999/xhtml">Components</span></strong><span class="koboSpan" id="kobo.74.1" xmlns="http://www.w3.org/1999/xhtml">: We’ll address the components below.</span></p></li>
<li><p><strong><span class="koboSpan" id="kobo.75.1" xmlns="http://www.w3.org/1999/xhtml">Code</span></strong><span class="koboSpan" id="kobo.76.1" xmlns="http://www.w3.org/1999/xhtml">: We’ll touch on this to provide some suggested directions.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.77.1" xmlns="http://www.w3.org/1999/xhtml">The heart of this application is a module to summarize data in a way that lets us test whether it fits the expectations of a model. </span><span class="koboSpan" id="kobo.77.2" xmlns="http://www.w3.org/1999/xhtml">The statistical model is a simplified reflection of the underlying real-world processes that created the source data. </span><span class="koboSpan" id="kobo.77.3" xmlns="http://www.w3.org/1999/xhtml">The model’s simplifications include assumptions about events, measurements, internal state changes, and other details of the processing being observed.</span></p>
<p><span class="koboSpan" id="kobo.78.1" xmlns="http://www.w3.org/1999/xhtml">For very simple cases — like Anscombe’s Quartet data — there are only two variables, which leaves a single relationship in the model. </span><span class="koboSpan" id="kobo.78.2" xmlns="http://www.w3.org/1999/xhtml">Each of the four sample collections in the quartet has a distinct relationship. </span><span class="koboSpan" id="kobo.78.3" xmlns="http://www.w3.org/1999/xhtml">Many of the summary statistics, however, are the same, making the relationship often surprising.</span></p>
<p><span class="koboSpan" id="kobo.79.1" xmlns="http://www.w3.org/1999/xhtml">For other datasets, with more variables </span><span id="dx1-327002"/><span class="koboSpan" id="kobo.80.1" xmlns="http://www.w3.org/1999/xhtml">and more relationships, there are numerous choices available to the analyst. </span><span class="koboSpan" id="kobo.80.2" xmlns="http://www.w3.org/1999/xhtml">The </span><em><span class="koboSpan" id="kobo.81.1" xmlns="http://www.w3.org/1999/xhtml">NIST</span></em> <em><span class="koboSpan" id="kobo.82.1" xmlns="http://www.w3.org/1999/xhtml">Engineering Statistics Handbook </span></em><span class="koboSpan" id="kobo.83.1" xmlns="http://www.w3.org/1999/xhtml">has an approach to modeling. </span><span class="koboSpan" id="kobo.83.2" xmlns="http://www.w3.org/1999/xhtml">See </span><a class="url" href="https://www.itl.nist.gov/div898/handbook/index.htm"><span class="koboSpan" id="kobo.84.1" xmlns="http://www.w3.org/1999/xhtml">https://www.itl.nist.gov/div898/handbook/index.htm</span></a><span class="koboSpan" id="kobo.85.1" xmlns="http://www.w3.org/1999/xhtml"> for the design of a model and analysis of the results of the model.</span></p>
<p><span class="koboSpan" id="kobo.86.1" xmlns="http://www.w3.org/1999/xhtml">As part of the preliminary work, we will distinguish between two very broad categories of statistical summaries:</span></p>
<ul>
<li><p><strong><span class="koboSpan" id="kobo.87.1" xmlns="http://www.w3.org/1999/xhtml">Univariate statistics</span></strong><span class="koboSpan" id="kobo.88.1" xmlns="http://www.w3.org/1999/xhtml">: These </span><span id="dx1-327003"/><span class="koboSpan" id="kobo.89.1" xmlns="http://www.w3.org/1999/xhtml">are variables </span><span id="dx1-327004"/><span class="koboSpan" id="kobo.90.1" xmlns="http://www.w3.org/1999/xhtml">viewed in isolation.</span></p></li>
<li><p><strong><span class="koboSpan" id="kobo.91.1" xmlns="http://www.w3.org/1999/xhtml">Multivariate statistics</span></strong><span class="koboSpan" id="kobo.92.1" xmlns="http://www.w3.org/1999/xhtml">: These </span><span id="dx1-327005"/><span class="koboSpan" id="kobo.93.1" xmlns="http://www.w3.org/1999/xhtml">are variables in pairs (or higher-order groupings) with an emphasis </span><span id="dx1-327006"/><span class="koboSpan" id="kobo.94.1" xmlns="http://www.w3.org/1999/xhtml">on the relationship between the variable’s values.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.95.1" xmlns="http://www.w3.org/1999/xhtml">For univariate statistics, we need to understand the distribution of the data. </span><span class="koboSpan" id="kobo.95.2" xmlns="http://www.w3.org/1999/xhtml">This means measuring the location (the center or expected values), the spread (or scale), and the shape of the distribution. </span><span class="koboSpan" id="kobo.95.3" xmlns="http://www.w3.org/1999/xhtml">Each of these measurement areas has several well-known statistical functions that can be part of the summary application.</span></p>
<p><span class="koboSpan" id="kobo.96.1" xmlns="http://www.w3.org/1999/xhtml">We’ll look at the multivariate statistics in the next chapter. </span><span class="koboSpan" id="kobo.96.2" xmlns="http://www.w3.org/1999/xhtml">We’ll start the univariate processing by looking at the application in a general way, and then focus on the statistical measures, the inputs, and finally, the outputs. </span><span id="x1-327007r349"/></p>
<section class="level3" data-number="19.2.1" id="designing-a-summary-app">
<h3 data-number="19.2.1"><span class="titlemark"><span class="koboSpan" id="kobo.97.1" xmlns="http://www.w3.org/1999/xhtml">15.2.1 </span></span> <span id="x1-3280001"/><span class="koboSpan" id="kobo.98.1" xmlns="http://www.w3.org/1999/xhtml">Designing a summary app</span></h3>
<p><span class="koboSpan" id="kobo.99.1" xmlns="http://www.w3.org/1999/xhtml">This application </span><span id="dx1-328001"/><span class="koboSpan" id="kobo.100.1" xmlns="http://www.w3.org/1999/xhtml">has a command-line interface to create a summary from the cleaned data. </span><span class="koboSpan" id="kobo.100.2" xmlns="http://www.w3.org/1999/xhtml">The input file(s) are the samples to be summarized. </span><span class="koboSpan" id="kobo.100.3" xmlns="http://www.w3.org/1999/xhtml">The summary must be in a form that’s easy to process by subsequent software. </span><span class="koboSpan" id="kobo.100.4" xmlns="http://www.w3.org/1999/xhtml">This can be a JSON- or a TOML-formatted file with the summary data.</span></p>
<p><span class="koboSpan" id="kobo.101.1" xmlns="http://www.w3.org/1999/xhtml">The summaries will be ”measures of location,” sometimes called a ”central tendency.” </span><span class="koboSpan" id="kobo.101.2" xmlns="http://www.w3.org/1999/xhtml">See </span><a class="url" href="https://www.itl.nist.gov/div898/handbook/eda/section3/eda351.htm"><span class="koboSpan" id="kobo.102.1" xmlns="http://www.w3.org/1999/xhtml">https://www.itl.nist.gov/div898/handbook/eda/section3/eda351.htm</span></a><span class="koboSpan" id="kobo.103.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.104.1" xmlns="http://www.w3.org/1999/xhtml">The output must include enough context to understand the data source, and the variable being measured. </span><span class="koboSpan" id="kobo.104.2" xmlns="http://www.w3.org/1999/xhtml">The output also includes the measured values to a sensible number of decimal places. </span><span class="koboSpan" id="kobo.104.3" xmlns="http://www.w3.org/1999/xhtml">It’s important to </span><span id="dx1-328002"/><span class="koboSpan" id="kobo.105.1" xmlns="http://www.w3.org/1999/xhtml">avoid introducing additional digits into floating-point values when those digits are little more than noise.</span></p>
<p><span class="koboSpan" id="kobo.106.1" xmlns="http://www.w3.org/1999/xhtml">A secondary feature of this application is to create an easy-to-read presentation of the summary. </span><span class="koboSpan" id="kobo.106.2" xmlns="http://www.w3.org/1999/xhtml">This can be done by using </span><span id="dx1-328003"/><span class="koboSpan" id="kobo.107.1" xmlns="http://www.w3.org/1999/xhtml">tools like </span><strong><span class="koboSpan" id="kobo.108.1" xmlns="http://www.w3.org/1999/xhtml">Docutils </span></strong><span class="koboSpan" id="kobo.109.1" xmlns="http://www.w3.org/1999/xhtml">to transform a reStructuredText report into HTML or a PDF. </span><span class="koboSpan" id="kobo.109.2" xmlns="http://www.w3.org/1999/xhtml">A tool like </span><strong><span class="koboSpan" id="kobo.110.1" xmlns="http://www.w3.org/1999/xhtml">Pandoc </span></strong><span class="koboSpan" id="kobo.111.1" xmlns="http://www.w3.org/1999/xhtml">could </span><span id="dx1-328004"/><span class="koboSpan" id="kobo.112.1" xmlns="http://www.w3.org/1999/xhtml">also be used to convert a source report into something that isn’t simply text. </span><span class="koboSpan" id="kobo.112.2" xmlns="http://www.w3.org/1999/xhtml">The technique explored in </span><a href="ch018.xhtml#x1-31300014"><em><span class="koboSpan" id="kobo.113.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em><em><span class="koboSpan" id="kobo.114.1" xmlns="http://www.w3.org/1999/xhtml"> 14</span></em></a><span class="koboSpan" id="kobo.115.1" xmlns="http://www.w3.org/1999/xhtml">, </span><a href="ch018.xhtml#x1-31300014"><em><span class="koboSpan" id="kobo.116.1" xmlns="http://www.w3.org/1999/xhtml">Project 4.2: Creating Reports</span></em></a><span class="koboSpan" id="kobo.117.1" xmlns="http://www.w3.org/1999/xhtml"> is to use Jupyter</span><span class="cmsy-10x-x-109"><span class="koboSpan" id="kobo.118.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><span class="koboSpan" id="kobo.119.1" xmlns="http://www.w3.org/1999/xhtml">Book</span><span class="cmsy-10x-x-109"><span class="koboSpan" id="kobo.120.1" xmlns="http://www.w3.org/1999/xhtml">} </span></span><span class="koboSpan" id="kobo.121.1" xmlns="http://www.w3.org/1999/xhtml">to create a document suitable for publication.</span></p>
<p><span class="koboSpan" id="kobo.122.1" xmlns="http://www.w3.org/1999/xhtml">We’ll start by looking at some of the measures of location that need to be computed. </span><span id="x1-328005r353"/></p>
</section>
<section class="level3" data-number="19.2.2" id="describing-the-distribution">
<h3 data-number="19.2.2"><span class="titlemark"><span class="koboSpan" id="kobo.123.1" xmlns="http://www.w3.org/1999/xhtml">15.2.2 </span></span> <span id="x1-3290002"/><span class="koboSpan" id="kobo.124.1" xmlns="http://www.w3.org/1999/xhtml">Describing the distribution</span></h3>
<p><span class="koboSpan" id="kobo.125.1" xmlns="http://www.w3.org/1999/xhtml">As noted above, there are three aspects of the distribution of a variable. </span><span class="koboSpan" id="kobo.125.2" xmlns="http://www.w3.org/1999/xhtml">The data tends to scatter around a central </span><span id="dx1-329001"/><span class="koboSpan" id="kobo.126.1" xmlns="http://www.w3.org/1999/xhtml">tendency value; we’ll call this the location. </span><span class="koboSpan" id="kobo.126.2" xmlns="http://www.w3.org/1999/xhtml">There will be an expected limit on the scattering; we’ll call this the spread. </span><span class="koboSpan" id="kobo.126.3" xmlns="http://www.w3.org/1999/xhtml">There may be a shape that’s symmetric or skewed in some way. </span><span class="koboSpan" id="kobo.126.4" xmlns="http://www.w3.org/1999/xhtml">The reasons for scattering may include measurement variability, as well as variability in the process being measured.</span></p>
<p><span class="koboSpan" id="kobo.127.1" xmlns="http://www.w3.org/1999/xhtml">The NIST Handbook defines three commonly-used measures of location:</span></p>
<ul>
<li><p><strong><span class="koboSpan" id="kobo.128.1" xmlns="http://www.w3.org/1999/xhtml">mean</span></strong><span class="koboSpan" id="kobo.129.1" xmlns="http://www.w3.org/1999/xhtml">: The sum of the variable’s values divided by the count of values: </span><em><span class="koboSpan" id="kobo.130.1" xmlns="http://www.w3.org/1999/xhtml">X</span></em><span class="koboSpan" id="kobo.131.1" xmlns="http://www.w3.org/1999/xhtml"> = </span><span class="koboSpan" id="kobo.132.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="∑ --XNi" src="../media/file60.jpg"/></span><span class="koboSpan" id="kobo.133.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p></li>
<li><p><strong><span class="koboSpan" id="kobo.134.1" xmlns="http://www.w3.org/1999/xhtml">median</span></strong><span class="koboSpan" id="kobo.135.1" xmlns="http://www.w3.org/1999/xhtml">: The value of a value that is in the center of the distribution. </span><span class="koboSpan" id="kobo.135.2" xmlns="http://www.w3.org/1999/xhtml">Half the values are less than or equal to this value, and half the values are greater than or equal to this value. </span><span class="koboSpan" id="kobo.135.3" xmlns="http://www.w3.org/1999/xhtml">First, sort the values into ascending order. </span><span class="koboSpan" id="kobo.135.4" xmlns="http://www.w3.org/1999/xhtml">If there’s an odd number, it’s the value in the center. </span><span class="koboSpan" id="kobo.135.5" xmlns="http://www.w3.org/1999/xhtml">For an even number of values, split the difference between the two center-most values.</span></p></li>
<li><p><strong><span class="koboSpan" id="kobo.136.1" xmlns="http://www.w3.org/1999/xhtml">mode</span></strong><span class="koboSpan" id="kobo.137.1" xmlns="http://www.w3.org/1999/xhtml">: The most common value. </span><span class="koboSpan" id="kobo.137.2" xmlns="http://www.w3.org/1999/xhtml">For some of the Anscombe Quartet data series, this isn’t informative because all of the values are unique.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.138.1" xmlns="http://www.w3.org/1999/xhtml">These functions are first-class parts of the built-in </span><code><span class="koboSpan" id="kobo.139.1" xmlns="http://www.w3.org/1999/xhtml">statistics</span></code><span class="koboSpan" id="kobo.140.1" xmlns="http://www.w3.org/1999/xhtml"> module, making them relatively easy to compute.</span></p>
<p><span class="koboSpan" id="kobo.141.1" xmlns="http://www.w3.org/1999/xhtml">There are some alternatives that may be needed when the data is polluted by outliers. </span><span class="koboSpan" id="kobo.141.2" xmlns="http://www.w3.org/1999/xhtml">There are techniques like </span><em><span class="koboSpan" id="kobo.142.1" xmlns="http://www.w3.org/1999/xhtml">Mid-Mean </span></em><span class="koboSpan" id="kobo.143.1" xmlns="http://www.w3.org/1999/xhtml">and </span><em><span class="koboSpan" id="kobo.144.1" xmlns="http://www.w3.org/1999/xhtml">Trimmed Mean </span></em><span class="koboSpan" id="kobo.145.1" xmlns="http://www.w3.org/1999/xhtml">to discard data outside some range of percentiles.</span></p>
<p><span class="koboSpan" id="kobo.146.1" xmlns="http://www.w3.org/1999/xhtml">The question of an ”outlier” is a sensitive topic. </span><span class="koboSpan" id="kobo.146.2" xmlns="http://www.w3.org/1999/xhtml">An outlier may reflect a measurement problem. </span><span class="koboSpan" id="kobo.146.3" xmlns="http://www.w3.org/1999/xhtml">An outlier may also hint that the processing being measured is quite a bit more complicated than is revealed in a set of samples. </span><span class="koboSpan" id="kobo.146.4" xmlns="http://www.w3.org/1999/xhtml">Another, separate set of samples may reveal a different mean or a </span><span id="dx1-329002"/><span class="koboSpan" id="kobo.147.1" xmlns="http://www.w3.org/1999/xhtml">larger standard deviation. </span><span class="koboSpan" id="kobo.147.2" xmlns="http://www.w3.org/1999/xhtml">The presence of outliers may suggest more study is needed to understand the nature of these values.</span></p>
<p><span class="koboSpan" id="kobo.148.1" xmlns="http://www.w3.org/1999/xhtml">There are three commonly-used measures for the scale or spread of the data:</span></p>
<ul>
<li><p><strong><span class="koboSpan" id="kobo.149.1" xmlns="http://www.w3.org/1999/xhtml">Variance </span></strong><span class="koboSpan" id="kobo.150.1" xmlns="http://www.w3.org/1999/xhtml">and standard deviation. </span><span class="koboSpan" id="kobo.150.2" xmlns="http://www.w3.org/1999/xhtml">The variance is — essentially — the average of the squared distance of each sample from the mean: </span><em><span class="koboSpan" id="kobo.151.1" xmlns="http://www.w3.org/1999/xhtml">s</span></em><sup><span class="cmr-8"><span class="koboSpan" id="kobo.152.1" xmlns="http://www.w3.org/1999/xhtml">2</span></span></sup><span class="koboSpan" id="kobo.153.1" xmlns="http://www.w3.org/1999/xhtml"> = </span><span class="koboSpan" id="kobo.154.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="∑ Xi−X¯ -(N−1)-" src="../media/file61.jpg"/></span><span class="koboSpan" id="kobo.155.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.155.2" xmlns="http://www.w3.org/1999/xhtml">The standard deviation is the square root of the variance.</span></p></li>
<li><p><strong><span class="koboSpan" id="kobo.156.1" xmlns="http://www.w3.org/1999/xhtml">Range </span></strong><span class="koboSpan" id="kobo.157.1" xmlns="http://www.w3.org/1999/xhtml">is the difference between the largest and smallest values.</span></p></li>
<li><p><strong><span class="koboSpan" id="kobo.158.1" xmlns="http://www.w3.org/1999/xhtml">Median absolute deviation </span></strong><span class="koboSpan" id="kobo.159.1" xmlns="http://www.w3.org/1999/xhtml">is the median of the distance of each sample from the mean: MAD</span><sub><span class="cmmi-8"><span class="koboSpan" id="kobo.160.1" xmlns="http://www.w3.org/1999/xhtml">Y</span></span></sub><span class="koboSpan" id="kobo.161.1" xmlns="http://www.w3.org/1999/xhtml"> = median(</span><span class="cmsy-10x-x-109"><span class="koboSpan" id="kobo.162.1" xmlns="http://www.w3.org/1999/xhtml">|</span></span><em><span class="koboSpan" id="kobo.163.1" xmlns="http://www.w3.org/1999/xhtml">Y</span></em> <sub><span class="cmmi-8"><span class="koboSpan" id="kobo.164.1" xmlns="http://www.w3.org/1999/xhtml">i</span></span></sub> <span class="cmsy-10x-x-109"><span class="koboSpan" id="kobo.165.1" xmlns="http://www.w3.org/1999/xhtml">−</span></span><em><span class="koboSpan" id="kobo.166.1" xmlns="http://www.w3.org/1999/xhtml">Ỹ</span></em><span class="cmsy-10x-x-109"><span class="koboSpan" id="kobo.167.1" xmlns="http://www.w3.org/1999/xhtml">|</span></span><span class="koboSpan" id="kobo.168.1" xmlns="http://www.w3.org/1999/xhtml">). </span><span class="koboSpan" id="kobo.168.2" xmlns="http://www.w3.org/1999/xhtml">See </span><a href="ch011.xhtml#x1-1610007"><em><span class="koboSpan" id="kobo.169.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em><em><span class="koboSpan" id="kobo.170.1" xmlns="http://www.w3.org/1999/xhtml"> 7</span></em></a><span class="koboSpan" id="kobo.171.1" xmlns="http://www.w3.org/1999/xhtml">, </span><a href="ch011.xhtml#x1-1610007"><em><span class="koboSpan" id="kobo.172.1" xmlns="http://www.w3.org/1999/xhtml">Data Inspection Features</span></em></a><span class="koboSpan" id="kobo.173.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.174.1" xmlns="http://www.w3.org/1999/xhtml">The variance and standard deviation functions are first-class parts of the built-in </span><code><span class="koboSpan" id="kobo.175.1" xmlns="http://www.w3.org/1999/xhtml">statistics</span></code><span class="koboSpan" id="kobo.176.1" xmlns="http://www.w3.org/1999/xhtml"> module. </span><span class="koboSpan" id="kobo.176.2" xmlns="http://www.w3.org/1999/xhtml">The range can be computed using the built-in </span><code><span class="koboSpan" id="kobo.177.1" xmlns="http://www.w3.org/1999/xhtml">min()</span></code><span class="koboSpan" id="kobo.178.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.179.1" xmlns="http://www.w3.org/1999/xhtml">max()</span></code><span class="koboSpan" id="kobo.180.1" xmlns="http://www.w3.org/1999/xhtml"> functions. </span><span class="koboSpan" id="kobo.180.2" xmlns="http://www.w3.org/1999/xhtml">A median absolute deviation function can be built using functions in the </span><code><span class="koboSpan" id="kobo.181.1" xmlns="http://www.w3.org/1999/xhtml">statistics</span></code><span class="koboSpan" id="kobo.182.1" xmlns="http://www.w3.org/1999/xhtml"> module.</span></p>
<p><span class="koboSpan" id="kobo.183.1" xmlns="http://www.w3.org/1999/xhtml">There are also measures for skewness and kurtosis of a distribution. </span><span class="koboSpan" id="kobo.183.2" xmlns="http://www.w3.org/1999/xhtml">We’ll leave these as extras to add to the application once the base statistical measures are in place. </span><span id="x1-329003r354"/></p>
</section>
<section class="level3" data-number="19.2.3" id="use-cleaned-data-model">
<h3 data-number="19.2.3"><span class="titlemark"><span class="koboSpan" id="kobo.184.1" xmlns="http://www.w3.org/1999/xhtml">15.2.3 </span></span> <span id="x1-3300003"/><span class="koboSpan" id="kobo.185.1" xmlns="http://www.w3.org/1999/xhtml">Use cleaned data model</span></h3>
<p><span class="koboSpan" id="kobo.186.1" xmlns="http://www.w3.org/1999/xhtml">It’s essential to use the cleaned, normalized data for this summary processing. </span><span class="koboSpan" id="kobo.186.2" xmlns="http://www.w3.org/1999/xhtml">There is some overlap between an inspection notebook and this more detailed analysis. </span><span class="koboSpan" id="kobo.186.3" xmlns="http://www.w3.org/1999/xhtml">An initial inspection may also look at </span><span id="dx1-330001"/><span class="koboSpan" id="kobo.187.1" xmlns="http://www.w3.org/1999/xhtml">some measures of location and range to determine if the data can be used or contains errors or problems. </span><span class="koboSpan" id="kobo.187.2" xmlns="http://www.w3.org/1999/xhtml">During the inspection activities, it’s common to start creating an intuitive model of the data. </span><span class="koboSpan" id="kobo.187.3" xmlns="http://www.w3.org/1999/xhtml">This leads to formulating hypotheses about the data and considering experiments to confirm or reject those hypotheses.</span></p>
<p><span class="koboSpan" id="kobo.188.1" xmlns="http://www.w3.org/1999/xhtml">This application formalizes hypothesis testing. </span><span class="koboSpan" id="kobo.188.2" xmlns="http://www.w3.org/1999/xhtml">Some functions from an initial data inspection notebook may be refactored into a form where those functions can be used on the cleaned data. </span><span class="koboSpan" id="kobo.188.3" xmlns="http://www.w3.org/1999/xhtml">The essential algorithm may be similar to the raw data version of the function. </span><span class="koboSpan" id="kobo.188.4" xmlns="http://www.w3.org/1999/xhtml">The data being used, however, will be the cleaned data.</span></p>
<p><span class="koboSpan" id="kobo.189.1" xmlns="http://www.w3.org/1999/xhtml">This leads to a sidebar design decision. </span><span class="koboSpan" id="kobo.189.2" xmlns="http://www.w3.org/1999/xhtml">When we look back at the data inspection notebook, we’ll see some overlaps. </span><span id="x1-330002r355"/></p>
</section>
<section class="level3" data-number="19.2.4" id="rethink-the-data-inspection-functions">
<h3 data-number="19.2.4"><span class="titlemark"><span class="koboSpan" id="kobo.190.1" xmlns="http://www.w3.org/1999/xhtml">15.2.4 </span></span> <span id="x1-3310004"/><span class="koboSpan" id="kobo.191.1" xmlns="http://www.w3.org/1999/xhtml">Rethink the data inspection functions</span></h3>
<p><span class="koboSpan" id="kobo.192.1" xmlns="http://www.w3.org/1999/xhtml">Because Python programming can be generic — independent of any specific data type — it’s tempting to try to unify the raw data processing and the cleaned data processing. </span><span class="koboSpan" id="kobo.192.2" xmlns="http://www.w3.org/1999/xhtml">The desire manifests as an attempt to </span><span id="dx1-331001"/><span class="koboSpan" id="kobo.193.1" xmlns="http://www.w3.org/1999/xhtml">write exactly one version of some algorithm, like the Median Absolute Deviation function that’s usable for </span><em><span class="koboSpan" id="kobo.194.1" xmlns="http://www.w3.org/1999/xhtml">both </span></em><span class="koboSpan" id="kobo.195.1" xmlns="http://www.w3.org/1999/xhtml">raw and cleaned data.</span></p>
<p><span class="koboSpan" id="kobo.196.1" xmlns="http://www.w3.org/1999/xhtml">This is not always an achievable goal. </span><span class="koboSpan" id="kobo.196.2" xmlns="http://www.w3.org/1999/xhtml">In some situations, it may not even be desirable.</span></p>
<p><span class="koboSpan" id="kobo.197.1" xmlns="http://www.w3.org/1999/xhtml">A function to process raw data must often do some needed cleaning and filtering. </span><span class="koboSpan" id="kobo.197.2" xmlns="http://www.w3.org/1999/xhtml">These overheads are later refactored and implemented in the pipeline to create cleaned data. </span><span class="koboSpan" id="kobo.197.3" xmlns="http://www.w3.org/1999/xhtml">To be very specific, the </span><code><span class="koboSpan" id="kobo.198.1" xmlns="http://www.w3.org/1999/xhtml">if</span></code><span class="koboSpan" id="kobo.199.1" xmlns="http://www.w3.org/1999/xhtml"> conditions used to exclude bad data can be helpful during the inspection. </span><span class="koboSpan" id="kobo.199.2" xmlns="http://www.w3.org/1999/xhtml">These conditions will become part of the clean-and-convert applications. </span><span class="koboSpan" id="kobo.199.3" xmlns="http://www.w3.org/1999/xhtml">Once this is done, they are no longer relevant for working with the cleaned data.</span></p>
<p><span class="koboSpan" id="kobo.200.1" xmlns="http://www.w3.org/1999/xhtml">Because the extra data cleanups are required for inspecting raw data, but not required for analyzing cleaned data, it can be difficult to create a single process that covers both cases. </span><span class="koboSpan" id="kobo.200.2" xmlns="http://www.w3.org/1999/xhtml">The complications required to implement this don’t seem to be worth the effort.</span></p>
<p><span class="koboSpan" id="kobo.201.1" xmlns="http://www.w3.org/1999/xhtml">There are some additional considerations. </span><span class="koboSpan" id="kobo.201.2" xmlns="http://www.w3.org/1999/xhtml">One of these is the general design pattern followed by Python’s </span><code><span class="koboSpan" id="kobo.202.1" xmlns="http://www.w3.org/1999/xhtml">statistics</span></code><span class="koboSpan" id="kobo.203.1" xmlns="http://www.w3.org/1999/xhtml"> module. </span><span class="koboSpan" id="kobo.203.2" xmlns="http://www.w3.org/1999/xhtml">This module works with sequences of atomic values. </span><span class="koboSpan" id="kobo.203.3" xmlns="http://www.w3.org/1999/xhtml">Our applications will read (and write) complicated </span><code><span class="koboSpan" id="kobo.204.1" xmlns="http://www.w3.org/1999/xhtml">Sample</span></code><span class="koboSpan" id="kobo.205.1" xmlns="http://www.w3.org/1999/xhtml"> objects that are not atomic Python integer or float values. </span><span class="koboSpan" id="kobo.205.2" xmlns="http://www.w3.org/1999/xhtml">This means our applications will extract sequences of atomic values from sequences of complicated </span><code><span class="koboSpan" id="kobo.206.1" xmlns="http://www.w3.org/1999/xhtml">Sample</span></code><span class="koboSpan" id="kobo.207.1" xmlns="http://www.w3.org/1999/xhtml"> objects.</span></p>
<p><span class="koboSpan" id="kobo.208.1" xmlns="http://www.w3.org/1999/xhtml">The raw data, on the other hand, may not </span><span id="dx1-331002"/><span class="koboSpan" id="kobo.209.1" xmlns="http://www.w3.org/1999/xhtml">have a very sophisticated class definition. </span><span class="koboSpan" id="kobo.209.2" xmlns="http://www.w3.org/1999/xhtml">This means the decomposition of complicated objects isn’t part of the raw data processing.</span></p>
<p><span class="koboSpan" id="kobo.210.1" xmlns="http://www.w3.org/1999/xhtml">For some very, very large datasets the decomposition of complicated multivariate objects to individual values may happen as the data is being read. </span><span class="koboSpan" id="kobo.210.2" xmlns="http://www.w3.org/1999/xhtml">Rather than ingest millions of objects, the application may extract a single attribute for processing.</span></p>
<p><span class="koboSpan" id="kobo.211.1" xmlns="http://www.w3.org/1999/xhtml">This might lead to input processing that has the following pattern:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-229">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.212.1" xmlns="http://www.w3.org/1999/xhtml">from collections.abc import Iterator, Callable
import json
from pathlib import Path
from typing import TypeAlias

from analysis_model import Sample

Extractor: TypeAlias = Callable[[Sample], float]

def attr_iter(some_path: Path, extractor: Extractor) -&gt; Iterator[float]:
    with some_path.open() as source:
        for line in source:
            document = Sample(**json.loads(line))
            yield extractor(document)

def x_values(some_path: Path) -&gt; list[float]:
    return list(attr_iter(some_path, lambda sample: sample.x))</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.213.1" xmlns="http://www.w3.org/1999/xhtml">This example defines a generic function, </span><code><span class="koboSpan" id="kobo.214.1" xmlns="http://www.w3.org/1999/xhtml">attr_iter()</span></code><span class="koboSpan" id="kobo.215.1" xmlns="http://www.w3.org/1999/xhtml">, to read an ND JSON file to build instances of some class, </span><code><span class="koboSpan" id="kobo.216.1" xmlns="http://www.w3.org/1999/xhtml">Sample</span></code><span class="koboSpan" id="kobo.217.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.217.2" xmlns="http://www.w3.org/1999/xhtml">(The details of the </span><code><span class="koboSpan" id="kobo.218.1" xmlns="http://www.w3.org/1999/xhtml">Sample</span></code><span class="koboSpan" id="kobo.219.1" xmlns="http://www.w3.org/1999/xhtml"> class are omitted.)</span></p>
<p><span class="koboSpan" id="kobo.220.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.221.1" xmlns="http://www.w3.org/1999/xhtml">x_values()</span></code><span class="koboSpan" id="kobo.222.1" xmlns="http://www.w3.org/1999/xhtml"> function uses the generic </span><code><span class="koboSpan" id="kobo.223.1" xmlns="http://www.w3.org/1999/xhtml">attr_iter()</span></code><span class="koboSpan" id="kobo.224.1" xmlns="http://www.w3.org/1999/xhtml"> function with a concrete lambda object to extract a specific variable’s value, and </span><span id="dx1-331020"/><span class="koboSpan" id="kobo.225.1" xmlns="http://www.w3.org/1999/xhtml">create a list object. </span><span class="koboSpan" id="kobo.225.2" xmlns="http://www.w3.org/1999/xhtml">This list object can then be used with various statistical functions.</span></p>
<p><span class="koboSpan" id="kobo.226.1" xmlns="http://www.w3.org/1999/xhtml">While a number of individual </span><code><span class="koboSpan" id="kobo.227.1" xmlns="http://www.w3.org/1999/xhtml">Sample</span></code><span class="koboSpan" id="kobo.228.1" xmlns="http://www.w3.org/1999/xhtml"> objects are created, they aren’t retained. </span><span class="koboSpan" id="kobo.228.2" xmlns="http://www.w3.org/1999/xhtml">Only the values of the </span><code><span class="koboSpan" id="kobo.229.1" xmlns="http://www.w3.org/1999/xhtml">x</span></code><span class="koboSpan" id="kobo.230.1" xmlns="http://www.w3.org/1999/xhtml"> attribute are saved, reducing the amount of memory used to create summary statistics from a large collection of complicated values. </span><span id="x1-331021r356"/></p>
</section>
<section class="level3" data-number="19.2.5" id="create-new-results-model">
<h3 data-number="19.2.5"><span class="titlemark"><span class="koboSpan" id="kobo.231.1" xmlns="http://www.w3.org/1999/xhtml">15.2.5 </span></span> <span id="x1-3320005"/><span class="koboSpan" id="kobo.232.1" xmlns="http://www.w3.org/1999/xhtml">Create new results model</span></h3>
<p><span class="koboSpan" id="kobo.233.1" xmlns="http://www.w3.org/1999/xhtml">The statistical summary </span><span id="dx1-332001"/><span class="koboSpan" id="kobo.234.1" xmlns="http://www.w3.org/1999/xhtml">contains three broad kinds of data:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.235.1" xmlns="http://www.w3.org/1999/xhtml">Metadata to specify what source data is used to create the summary.</span></p></li>
<li><p><span class="koboSpan" id="kobo.236.1" xmlns="http://www.w3.org/1999/xhtml">Metadata to specify what measures are being used.</span></p></li>
<li><p><span class="koboSpan" id="kobo.237.1" xmlns="http://www.w3.org/1999/xhtml">The computed values for location, shape, and spread.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.238.1" xmlns="http://www.w3.org/1999/xhtml">In some enterprise applications, source data is described by a range of dates defining the earliest and latest samples. </span><span class="koboSpan" id="kobo.238.2" xmlns="http://www.w3.org/1999/xhtml">In some cases, more details are required to describe the complete context. </span><span class="koboSpan" id="kobo.238.3" xmlns="http://www.w3.org/1999/xhtml">For example, the software to acquire raw data may have been upgraded in the past. </span><span class="koboSpan" id="kobo.238.4" xmlns="http://www.w3.org/1999/xhtml">This means older data may be incomplete. </span><span class="koboSpan" id="kobo.238.5" xmlns="http://www.w3.org/1999/xhtml">This means the context for processing data may require some additional details on software versions or releases in addition to the range of dates and data sources.</span></p>
<p><span class="koboSpan" id="kobo.239.1" xmlns="http://www.w3.org/1999/xhtml">Similarly, the measures being used may shift over time. </span><span class="koboSpan" id="kobo.239.2" xmlns="http://www.w3.org/1999/xhtml">The computation of skewness, for example, </span><span id="dx1-332002"/><span class="koboSpan" id="kobo.240.1" xmlns="http://www.w3.org/1999/xhtml">may switch from the </span><strong><span class="koboSpan" id="kobo.241.1" xmlns="http://www.w3.org/1999/xhtml">Fisher-Pearson </span></strong><span class="koboSpan" id="kobo.242.1" xmlns="http://www.w3.org/1999/xhtml">formula to the </span><strong><span class="koboSpan" id="kobo.243.1" xmlns="http://www.w3.org/1999/xhtml">adjusted Fisher-Pearson </span></strong><span class="koboSpan" id="kobo.244.1" xmlns="http://www.w3.org/1999/xhtml">formula. </span><span class="koboSpan" id="kobo.244.2" xmlns="http://www.w3.org/1999/xhtml">This suggests the version information for the summary program should also be recorded along with the results computed.</span></p>
<p><span class="koboSpan" id="kobo.245.1" xmlns="http://www.w3.org/1999/xhtml">Each of these metadata values provides necessary context and background information on the data source, the method of collection, and any computations of derived data. </span><span class="koboSpan" id="kobo.245.2" xmlns="http://www.w3.org/1999/xhtml">This context may be helpful in uncovering the root cause of changes. </span><span class="koboSpan" id="kobo.245.3" xmlns="http://www.w3.org/1999/xhtml">In some cases, the context is a way to catalog underlying assumptions about a process or a measurement instrument; seeing this context may allow an analyst to challenge assumptions and locate the root cause of a problem.</span></p>
<p><span class="koboSpan" id="kobo.246.1" xmlns="http://www.w3.org/1999/xhtml">The application must create a result document that looks something like the following example:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-230">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.247.1" xmlns="http://www.w3.org/1999/xhtml">[identification]
    date = "2023-03-27T10:04:00"
[creator]
    title = "Some Summary App"
    version = 4.2
[source]
    title = "Anscombe’s Quartet"
    path = "data/clean/Series_1.ndj"
[x.location]
    mean = 9.0
[x.spread]
    variance = 11.0
[y.location]
    mean = 7.5
[y.spread]
    variance = 4.125</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.248.1" xmlns="http://www.w3.org/1999/xhtml">This file can be parsed by the </span><code><span class="koboSpan" id="kobo.249.1" xmlns="http://www.w3.org/1999/xhtml">toml</span></code><span class="koboSpan" id="kobo.250.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.251.1" xmlns="http://www.w3.org/1999/xhtml">tomllib</span></code><span class="koboSpan" id="kobo.252.1" xmlns="http://www.w3.org/1999/xhtml"> module to create a nested collection of dictionaries. </span><span class="koboSpan" id="kobo.252.2" xmlns="http://www.w3.org/1999/xhtml">The secondary </span><span id="dx1-332019"/><span class="koboSpan" id="kobo.253.1" xmlns="http://www.w3.org/1999/xhtml">feature of the summary application is to read this file and write a report, perhaps using Markdown or ReStructuredText that provides the data in a readable format suitable for publication.</span></p>
<p><span class="koboSpan" id="kobo.254.1" xmlns="http://www.w3.org/1999/xhtml">For Python 3.11 or newer, the </span><code><span class="koboSpan" id="kobo.255.1" xmlns="http://www.w3.org/1999/xhtml">tomllib</span></code><span class="koboSpan" id="kobo.256.1" xmlns="http://www.w3.org/1999/xhtml"> module is built in. </span><span class="koboSpan" id="kobo.256.2" xmlns="http://www.w3.org/1999/xhtml">For older Python installations, the </span><code><span class="koboSpan" id="kobo.257.1" xmlns="http://www.w3.org/1999/xhtml">toml</span></code><span class="koboSpan" id="kobo.258.1" xmlns="http://www.w3.org/1999/xhtml"> module needs to be installed.</span></p>
<p><span class="koboSpan" id="kobo.259.1" xmlns="http://www.w3.org/1999/xhtml">Now that we’ve seen the overall approach, we can look at the specific deliverable files. </span><span id="x1-332020r352"/></p>
</section>
</section>
<section class="level2" data-number="19.3" id="deliverables-21">
<h2 data-number="19.3"><span class="titlemark"><span class="koboSpan" id="kobo.260.1" xmlns="http://www.w3.org/1999/xhtml">15.3 </span></span> <span id="x1-3330003"/><span class="koboSpan" id="kobo.261.1" xmlns="http://www.w3.org/1999/xhtml">Deliverables</span></h2>
<p><span class="koboSpan" id="kobo.262.1" xmlns="http://www.w3.org/1999/xhtml">This project has </span><span id="dx1-333001"/><span class="koboSpan" id="kobo.263.1" xmlns="http://www.w3.org/1999/xhtml">the following deliverables:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.264.1" xmlns="http://www.w3.org/1999/xhtml">Documentation in the </span><code><span class="koboSpan" id="kobo.265.1" xmlns="http://www.w3.org/1999/xhtml">docs</span></code><span class="koboSpan" id="kobo.266.1" xmlns="http://www.w3.org/1999/xhtml"> folder.</span></p></li>
<li><p><span class="koboSpan" id="kobo.267.1" xmlns="http://www.w3.org/1999/xhtml">Acceptance tests in the </span><code><span class="koboSpan" id="kobo.268.1" xmlns="http://www.w3.org/1999/xhtml">tests/features</span></code><span class="koboSpan" id="kobo.269.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.270.1" xmlns="http://www.w3.org/1999/xhtml">tests/steps</span></code><span class="koboSpan" id="kobo.271.1" xmlns="http://www.w3.org/1999/xhtml"> folders.</span></p></li>
<li><p><span class="koboSpan" id="kobo.272.1" xmlns="http://www.w3.org/1999/xhtml">Unit tests for model module classes in the </span><code><span class="koboSpan" id="kobo.273.1" xmlns="http://www.w3.org/1999/xhtml">tests</span></code><span class="koboSpan" id="kobo.274.1" xmlns="http://www.w3.org/1999/xhtml"> folder.</span></p></li>
<li><p><span class="koboSpan" id="kobo.275.1" xmlns="http://www.w3.org/1999/xhtml">Mock objects for the </span><code><span class="koboSpan" id="kobo.276.1" xmlns="http://www.w3.org/1999/xhtml">csv_extract</span></code><span class="koboSpan" id="kobo.277.1" xmlns="http://www.w3.org/1999/xhtml"> module tests will be part of the unit tests.</span></p></li>
<li><p><span class="koboSpan" id="kobo.278.1" xmlns="http://www.w3.org/1999/xhtml">Unit tests for the </span><code><span class="koboSpan" id="kobo.279.1" xmlns="http://www.w3.org/1999/xhtml">csv_extract</span></code><span class="koboSpan" id="kobo.280.1" xmlns="http://www.w3.org/1999/xhtml"> module components that are in the </span><code><span class="koboSpan" id="kobo.281.1" xmlns="http://www.w3.org/1999/xhtml">tests</span></code><span class="koboSpan" id="kobo.282.1" xmlns="http://www.w3.org/1999/xhtml"> folder.</span></p></li>
<li><p><span class="koboSpan" id="kobo.283.1" xmlns="http://www.w3.org/1999/xhtml">An application to summarize the cleaned data in a TOML file.</span></p></li>
<li><p><span class="koboSpan" id="kobo.284.1" xmlns="http://www.w3.org/1999/xhtml">An application secondary feature to transform the TOML file to an HTML page or PDF file with the summary.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.285.1" xmlns="http://www.w3.org/1999/xhtml">In some cases, especially for particularly complicated applications, the summary statistics may be best implemented as a separate module. </span><span class="koboSpan" id="kobo.285.2" xmlns="http://www.w3.org/1999/xhtml">This module can then be expanded and modified without making significant changes to the overall application.</span></p>
<p><span class="koboSpan" id="kobo.286.1" xmlns="http://www.w3.org/1999/xhtml">The idea is to distinguish between these aspects of this application:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.287.1" xmlns="http://www.w3.org/1999/xhtml">The CLI, which includes argument parsing and sensible handling of input and output paths.</span></p></li>
<li><p><span class="koboSpan" id="kobo.288.1" xmlns="http://www.w3.org/1999/xhtml">The statistical model, which evolves as our understanding of the problem domain and the data evolve.</span></p></li>
<li><p><span class="koboSpan" id="kobo.289.1" xmlns="http://www.w3.org/1999/xhtml">The data classes, which describe the structure of the samples, independent of any specific purpose.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.290.1" xmlns="http://www.w3.org/1999/xhtml">For some applications, these aspects do not involve a large number of classes or functions. </span><span class="koboSpan" id="kobo.290.2" xmlns="http://www.w3.org/1999/xhtml">In a case where the definitions are small, a single Python module will do nicely. </span><span class="koboSpan" id="kobo.290.3" xmlns="http://www.w3.org/1999/xhtml">For other applications, particularly those where initial assumptions turned out to be invalid and significant changes were made, having separate modules can permit more flexibility, and more agility with respect to future changes.</span></p>
<p><span class="koboSpan" id="kobo.291.1" xmlns="http://www.w3.org/1999/xhtml">We’ll look at a few of these deliverables in a little more detail. </span><span class="koboSpan" id="kobo.291.2" xmlns="http://www.w3.org/1999/xhtml">We’ll start with some suggestions for creating the acceptance tests. </span><span id="x1-333002r357"/></p>
<section class="level3" data-number="19.3.1" id="acceptance-testing">
<h3 data-number="19.3.1"><span class="titlemark"><span class="koboSpan" id="kobo.292.1" xmlns="http://www.w3.org/1999/xhtml">15.3.1 </span></span> <span id="x1-3340001"/><span class="koboSpan" id="kobo.293.1" xmlns="http://www.w3.org/1999/xhtml">Acceptance testing</span></h3>
<p><span class="koboSpan" id="kobo.294.1" xmlns="http://www.w3.org/1999/xhtml">The acceptance tests need to describe the overall application’s behavior from the user’s point of view. </span><span class="koboSpan" id="kobo.294.2" xmlns="http://www.w3.org/1999/xhtml">The scenarios </span><span id="dx1-334001"/><span class="koboSpan" id="kobo.295.1" xmlns="http://www.w3.org/1999/xhtml">will follow the UX concept of a command-line application to acquire data and write output files. </span><span class="koboSpan" id="kobo.295.2" xmlns="http://www.w3.org/1999/xhtml">Because the input data has been cleaned and converted, there are few failure modes for this application; extensive testing of potential problems isn’t as important as it was in earlier data-cleaning projects.</span></p>
<p><span class="koboSpan" id="kobo.296.1" xmlns="http://www.w3.org/1999/xhtml">For relatively simple datasets, the results of the statistical summaries are known in advance. </span><span class="koboSpan" id="kobo.296.2" xmlns="http://www.w3.org/1999/xhtml">This leads to features that might look like the following example:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-231">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.297.1" xmlns="http://www.w3.org/1999/xhtml">Feature: Summarize an Anscombe Quartet Series.

</span><span class="koboSpan" id="kobo.297.2" xmlns="http://www.w3.org/1999/xhtml">Scenario: When requested, the application creates a TOML summary of a series.
  </span><span class="koboSpan" id="kobo.297.3" xmlns="http://www.w3.org/1999/xhtml">Given the "clean/series_1.ndj" file exists
  When we run command "python src/summarize.py \
        -o summary/series_1/2023/03 data/clean/Series_\1.ndj"
  Then the "summary/series_1/2023/03/summary.toml" file exists
  And the value of "summary[’creator’][’title’]" is "Anscombe Summary App"
  And the value of "summary[’source’][’path’]" is "data/clean/Series_1.ndj"
  And the value of "summary[’x’][’location’][’mean’]" is "9.0"</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.298.1" xmlns="http://www.w3.org/1999/xhtml">We could continue the scenario with a number of additional </span><code><span class="koboSpan" id="kobo.299.1" xmlns="http://www.w3.org/1999/xhtml">Then</span></code><span class="koboSpan" id="kobo.300.1" xmlns="http://www.w3.org/1999/xhtml"> steps to validate each of the locations and the spread and shape the statistical summaries.</span></p>
<p><span class="koboSpan" id="kobo.301.1" xmlns="http://www.w3.org/1999/xhtml">The step definitions will be similar to step definitions for a number of previous projects. </span><span class="koboSpan" id="kobo.301.2" xmlns="http://www.w3.org/1999/xhtml">Specifically, the </span><code><span class="koboSpan" id="kobo.302.1" xmlns="http://www.w3.org/1999/xhtml">When</span></code><span class="koboSpan" id="kobo.303.1" xmlns="http://www.w3.org/1999/xhtml"> step will use the </span><code><span class="koboSpan" id="kobo.304.1" xmlns="http://www.w3.org/1999/xhtml">subprocess.run()</span></code><span class="koboSpan" id="kobo.305.1" xmlns="http://www.w3.org/1999/xhtml"> function to execute the given application with the required command-line arguments.</span></p>
<p><span class="koboSpan" id="kobo.306.1" xmlns="http://www.w3.org/1999/xhtml">The first of the </span><code><span class="koboSpan" id="kobo.307.1" xmlns="http://www.w3.org/1999/xhtml">Then</span></code><span class="koboSpan" id="kobo.308.1" xmlns="http://www.w3.org/1999/xhtml"> steps will need to read — and parse — the TOML file. </span><span class="koboSpan" id="kobo.308.2" xmlns="http://www.w3.org/1999/xhtml">The resulting summary object can be placed in the </span><code><span class="koboSpan" id="kobo.309.1" xmlns="http://www.w3.org/1999/xhtml">context</span></code><span class="koboSpan" id="kobo.310.1" xmlns="http://www.w3.org/1999/xhtml"> object. </span><span class="koboSpan" id="kobo.310.2" xmlns="http://www.w3.org/1999/xhtml">Subsequent </span><code><span class="koboSpan" id="kobo.311.1" xmlns="http://www.w3.org/1999/xhtml">Then</span></code><span class="koboSpan" id="kobo.312.1" xmlns="http://www.w3.org/1999/xhtml"> steps can examine the structure to locate the individual values, and confirm the values match the acceptance test expectations.</span></p>
<div class="tcolorbox tipbox" id="tcolobox-232">
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.313.1" xmlns="http://www.w3.org/1999/xhtml">It is often helpful to extract a small subset of data to use for acceptance testing. </span><span class="koboSpan" id="kobo.313.2" xmlns="http://www.w3.org/1999/xhtml">Instead of processing millions of rows, a few dozen rows are adequate to confirm the application has read and summarized data. </span><span class="koboSpan" id="kobo.313.3" xmlns="http://www.w3.org/1999/xhtml">The data only needs to be representative of the larger set of samples under consideration.</span></p>
<p><span class="koboSpan" id="kobo.314.1" xmlns="http://www.w3.org/1999/xhtml">Because the chosen subset is part of the testing suite; it rarely changes. </span><span class="koboSpan" id="kobo.314.2" xmlns="http://www.w3.org/1999/xhtml">This makes the results predictable.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.315.1" xmlns="http://www.w3.org/1999/xhtml">As the data collection process evolves, it’s common to have changes to the data sources. </span><span class="koboSpan" id="kobo.315.2" xmlns="http://www.w3.org/1999/xhtml">This will lead to changes in the data cleaning. </span><span class="koboSpan" id="kobo.315.3" xmlns="http://www.w3.org/1999/xhtml">This may, in turn, lead to changes in the summary application as new codes or </span><span id="dx1-334012"/><span class="koboSpan" id="kobo.316.1" xmlns="http://www.w3.org/1999/xhtml">new outliers must be handled properly. </span><span class="koboSpan" id="kobo.316.2" xmlns="http://www.w3.org/1999/xhtml">The evolution of the data sources implies that the test data suite will also need to evolve to expose any of the special, edge, or corner cases.</span></p>
<p><span class="koboSpan" id="kobo.317.1" xmlns="http://www.w3.org/1999/xhtml">Ideally, the test data suite is a mixture of ordinary — no surprises — data, mixed with representative examples of each of the special, atypical cases. </span><span class="koboSpan" id="kobo.317.2" xmlns="http://www.w3.org/1999/xhtml">As this test data suite evolves, the acceptance test scenario will also evolve.</span></p>
<p><span class="koboSpan" id="kobo.318.1" xmlns="http://www.w3.org/1999/xhtml">The TOML file is relatively easy to parse and verify. </span><span class="koboSpan" id="kobo.318.2" xmlns="http://www.w3.org/1999/xhtml">The secondary feature of this application — expanding on the TOML output to add extensive Markdown — also works with text files. </span><span class="koboSpan" id="kobo.318.3" xmlns="http://www.w3.org/1999/xhtml">This makes it relatively easy to confirm with test scenarios that read and write text files.</span></p>
<p><span class="koboSpan" id="kobo.319.1" xmlns="http://www.w3.org/1999/xhtml">The final publication, whether done by Pandoc or a combination of Pandoc and a LaTeX toolchain, isn’t the best subject for automated testing. </span><span class="koboSpan" id="kobo.319.2" xmlns="http://www.w3.org/1999/xhtml">A good copy editor or trusted associate needs to make sure the final document meets the stakeholder’s expectations. </span><span id="x1-334013r359"/></p>
</section>
<section class="level3" data-number="19.3.2" id="unit-testing">
<h3 data-number="19.3.2"><span class="titlemark"><span class="koboSpan" id="kobo.320.1" xmlns="http://www.w3.org/1999/xhtml">15.3.2 </span></span> <span id="x1-3350002"/><span class="koboSpan" id="kobo.321.1" xmlns="http://www.w3.org/1999/xhtml">Unit testing</span></h3>
<p><span class="koboSpan" id="kobo.322.1" xmlns="http://www.w3.org/1999/xhtml">It’s important to have unit testing for the various components that are unique to this application. </span><span class="koboSpan" id="kobo.322.2" xmlns="http://www.w3.org/1999/xhtml">The clean data </span><span id="dx1-335001"/><span class="koboSpan" id="kobo.323.1" xmlns="http://www.w3.org/1999/xhtml">class definition, for example, is created by another application, with its own test suite. </span><span class="koboSpan" id="kobo.323.2" xmlns="http://www.w3.org/1999/xhtml">The unit tests for this application don’t need to repeat those tests. </span><span class="koboSpan" id="kobo.323.3" xmlns="http://www.w3.org/1999/xhtml">Similarly, the </span><code><span class="koboSpan" id="kobo.324.1" xmlns="http://www.w3.org/1999/xhtml">statistics</span></code><span class="koboSpan" id="kobo.325.1" xmlns="http://www.w3.org/1999/xhtml"> module has extensive unit tests; this application’s unit tests do not need to replicate any of that testing.</span></p>
<p><span class="koboSpan" id="kobo.326.1" xmlns="http://www.w3.org/1999/xhtml">This further suggests that the </span><code><span class="koboSpan" id="kobo.327.1" xmlns="http://www.w3.org/1999/xhtml">statistics</span></code><span class="koboSpan" id="kobo.328.1" xmlns="http://www.w3.org/1999/xhtml"> module should be replaced with </span><code><span class="koboSpan" id="kobo.329.1" xmlns="http://www.w3.org/1999/xhtml">Mock</span></code><span class="koboSpan" id="kobo.330.1" xmlns="http://www.w3.org/1999/xhtml"> objects. </span><span class="koboSpan" id="kobo.330.2" xmlns="http://www.w3.org/1999/xhtml">Those mock objects can — generally — return </span><code><span class="koboSpan" id="kobo.331.1" xmlns="http://www.w3.org/1999/xhtml">sentinel</span></code><span class="koboSpan" id="kobo.332.1" xmlns="http://www.w3.org/1999/xhtml"> objects that will appear in the resulting TOML-format summary document.</span></p>
<p><span class="koboSpan" id="kobo.333.1" xmlns="http://www.w3.org/1999/xhtml">This suggests test </span><span id="dx1-335002"/><span class="koboSpan" id="kobo.334.1" xmlns="http://www.w3.org/1999/xhtml">cases structured like the following example:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-233">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.335.1" xmlns="http://www.w3.org/1999/xhtml">from pytest import fixture
from unittest.mock import Mock, call, sentinel
import summary_app

@fixture
def mocked_mean(monkeypatch):
    mean = Mock(
        return_value=sentinel.MEAN
    )
    monkeypatch.setattr(summary_app, ’mean’, mean)
    return mean

@fixture
def mocked_variance(monkeypatch):
    variance = Mock(
        return_value=sentinel.VARIANCE
    )
    monkeypatch.setattr(summary_app, ’variance’, variance)
    return variance

def test_var_summary(mocked_mean, mocked_variance):
    sample_data = sentinel.SAMPLE
    result = summary_app.variable_summary(sample_data)
    assert result == {
        "location": {"mean": sentinel.MEAN},
        "spread": {"variance": sentinel.VARIANCE},
    }
    assert mocked_mean.mock_calls == [call(sample_data)]
    assert mocked_variance.mock_calls == [call(sample_data)]</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.336.1" xmlns="http://www.w3.org/1999/xhtml">The two test fixtures provide mock results, using </span><code><span class="koboSpan" id="kobo.337.1" xmlns="http://www.w3.org/1999/xhtml">sentinel</span></code><span class="koboSpan" id="kobo.338.1" xmlns="http://www.w3.org/1999/xhtml"> objects. </span><span class="koboSpan" id="kobo.338.2" xmlns="http://www.w3.org/1999/xhtml">Using </span><code><span class="koboSpan" id="kobo.339.1" xmlns="http://www.w3.org/1999/xhtml">sentinel</span></code><span class="koboSpan" id="kobo.340.1" xmlns="http://www.w3.org/1999/xhtml"> objects allows easy comparison to be </span><span id="dx1-335032"/><span class="koboSpan" id="kobo.341.1" xmlns="http://www.w3.org/1999/xhtml">sure the results of the mocked functions were not manipulated unexpectedly by the application.</span></p>
<p><span class="koboSpan" id="kobo.342.1" xmlns="http://www.w3.org/1999/xhtml">The test case, </span><code><span class="koboSpan" id="kobo.343.1" xmlns="http://www.w3.org/1999/xhtml">test_var_summary()</span></code><span class="koboSpan" id="kobo.344.1" xmlns="http://www.w3.org/1999/xhtml">, provides a mocked source of data in the form of another </span><code><span class="koboSpan" id="kobo.345.1" xmlns="http://www.w3.org/1999/xhtml">sentinel</span></code><span class="koboSpan" id="kobo.346.1" xmlns="http://www.w3.org/1999/xhtml"> object. </span><span class="koboSpan" id="kobo.346.2" xmlns="http://www.w3.org/1999/xhtml">The results have the expected structure and the expected </span><code><span class="koboSpan" id="kobo.347.1" xmlns="http://www.w3.org/1999/xhtml">sentinel</span></code><span class="koboSpan" id="kobo.348.1" xmlns="http://www.w3.org/1999/xhtml"> objects.</span></p>
<p><span class="koboSpan" id="kobo.349.1" xmlns="http://www.w3.org/1999/xhtml">The final part of the test confirms the sample data — untouched — was provided to the mocked statistical functions. </span><span class="koboSpan" id="kobo.349.2" xmlns="http://www.w3.org/1999/xhtml">This confirms the application doesn’t filter or transform the data in any way. </span><span class="koboSpan" id="kobo.349.3" xmlns="http://www.w3.org/1999/xhtml">The results are the expected </span><code><span class="koboSpan" id="kobo.350.1" xmlns="http://www.w3.org/1999/xhtml">sentinel</span></code><span class="koboSpan" id="kobo.351.1" xmlns="http://www.w3.org/1999/xhtml"> objects; this confirms the module didn’t adulterate the results of the </span><code><span class="koboSpan" id="kobo.352.1" xmlns="http://www.w3.org/1999/xhtml">statistics</span></code><span class="koboSpan" id="kobo.353.1" xmlns="http://www.w3.org/1999/xhtml"> module. </span><span class="koboSpan" id="kobo.353.2" xmlns="http://www.w3.org/1999/xhtml">And the final check confirms that the mocked functions were called exactly once with the expected parameters.</span></p>
<p><span class="koboSpan" id="kobo.354.1" xmlns="http://www.w3.org/1999/xhtml">This kind of unit test, with numerous mocks, is essential for focusing the testing on the new application code, and avoiding tests of other modules or packages. </span><span id="x1-335033r360"/></p>
</section>
<section class="level3" data-number="19.3.3" id="application-secondary-feature">
<h3 data-number="19.3.3"><span class="titlemark"><span class="koboSpan" id="kobo.355.1" xmlns="http://www.w3.org/1999/xhtml">15.3.3 </span></span> <span id="x1-3360003"/><span class="koboSpan" id="kobo.356.1" xmlns="http://www.w3.org/1999/xhtml">Application secondary feature</span></h3>
<p><span class="koboSpan" id="kobo.357.1" xmlns="http://www.w3.org/1999/xhtml">A secondary feature of this application transforms the TOML summary into a more readable HTML or PDF file. </span><span class="koboSpan" id="kobo.357.2" xmlns="http://www.w3.org/1999/xhtml">This feature is a </span><span id="dx1-336001"/><span class="koboSpan" id="kobo.358.1" xmlns="http://www.w3.org/1999/xhtml">variation of the kinds of reporting done with Jupyter Lab (and associated tools like </span><strong><span class="koboSpan" id="kobo.359.1" xmlns="http://www.w3.org/1999/xhtml">Jupyter</span></strong> <span class="cmbsy-10x-x-109"><span class="koboSpan" id="kobo.360.1" xmlns="http://www.w3.org/1999/xhtml">{</span></span><strong><span class="koboSpan" id="kobo.361.1" xmlns="http://www.w3.org/1999/xhtml">Book</span></strong><span class="cmbsy-10x-x-109"><span class="koboSpan" id="kobo.362.1" xmlns="http://www.w3.org/1999/xhtml">}</span></span><span class="koboSpan" id="kobo.363.1" xmlns="http://www.w3.org/1999/xhtml">).</span></p>
<p><span class="koboSpan" id="kobo.364.1" xmlns="http://www.w3.org/1999/xhtml">There’s an important distinction between these two classes of reports:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.365.1" xmlns="http://www.w3.org/1999/xhtml">The Jupyter Lab reports involve discovery. </span><span class="koboSpan" id="kobo.365.2" xmlns="http://www.w3.org/1999/xhtml">The report content is always new.</span></p></li>
<li><p><span class="koboSpan" id="kobo.366.1" xmlns="http://www.w3.org/1999/xhtml">The summary application’s reports involve confirmation of expectations. </span><span class="koboSpan" id="kobo.366.2" xmlns="http://www.w3.org/1999/xhtml">The report content should not be new or surprising.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.367.1" xmlns="http://www.w3.org/1999/xhtml">In some cases, the report will be used to confirm (or deny) an expected trend is continuing. </span><span class="koboSpan" id="kobo.367.2" xmlns="http://www.w3.org/1999/xhtml">The application applies the trend model to the data. </span><span class="koboSpan" id="kobo.367.3" xmlns="http://www.w3.org/1999/xhtml">If the results don’t match expectations, this suggests follow-up action is required. </span><span class="koboSpan" id="kobo.367.4" xmlns="http://www.w3.org/1999/xhtml">Ideally, it means the model is incorrect, and the trend is changing. </span><span class="koboSpan" id="kobo.367.5" xmlns="http://www.w3.org/1999/xhtml">The less-than-ideal case is the observation of an unexpected change in the applications providing the source data.</span></p>
<p><span class="koboSpan" id="kobo.368.1" xmlns="http://www.w3.org/1999/xhtml">This application decomposes report writing into three distinct steps:</span></p>
<ol>
<li><div id="x1-336003x1">
<p><strong><span class="koboSpan" id="kobo.369.1" xmlns="http://www.w3.org/1999/xhtml">Content</span></strong><span class="koboSpan" id="kobo.370.1" xmlns="http://www.w3.org/1999/xhtml">: This is the TOML file with the essential statistical measures.</span></p>
</div></li>
<li><div id="x1-336005x2">
<p><strong><span class="koboSpan" id="kobo.371.1" xmlns="http://www.w3.org/1999/xhtml">Structure</span></strong><span class="koboSpan" id="kobo.372.1" xmlns="http://www.w3.org/1999/xhtml">: The secondary feature </span><span id="dx1-336006"/><span class="koboSpan" id="kobo.373.1" xmlns="http://www.w3.org/1999/xhtml">creates an intermediate markup file in Markdown or the RST format. </span><span class="koboSpan" id="kobo.373.2" xmlns="http://www.w3.org/1999/xhtml">This has an informative structure around the essential content.</span></p>
</div></li>
<li><div id="x1-336008x3">
<p><strong><span class="koboSpan" id="kobo.374.1" xmlns="http://www.w3.org/1999/xhtml">Presentation</span></strong><span class="koboSpan" id="kobo.375.1" xmlns="http://www.w3.org/1999/xhtml">: The final publication document is created from the structured markup plus any templates or style sheets that are required.</span></p>
</div></li>
</ol>
<p><span class="koboSpan" id="kobo.376.1" xmlns="http://www.w3.org/1999/xhtml">The final presentation is kept separate from the document’s content and structure.</span></p>
<div class="tcolorbox tipbox" id="tcolobox-234">
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.377.1" xmlns="http://www.w3.org/1999/xhtml">An HTML document’s final presentation is created by a browser. </span><span class="koboSpan" id="kobo.377.2" xmlns="http://www.w3.org/1999/xhtml">Using a tool like </span><strong><span class="koboSpan" id="kobo.378.1" xmlns="http://www.w3.org/1999/xhtml">Pandoc </span></strong><span class="koboSpan" id="kobo.379.1" xmlns="http://www.w3.org/1999/xhtml">to create HTML from Markdown is — properly — replacing one markup language with another markup language.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.380.1" xmlns="http://www.w3.org/1999/xhtml">Creating a PDF file is a bit more complicated. </span><span class="koboSpan" id="kobo.380.2" xmlns="http://www.w3.org/1999/xhtml">We’ll leave this in the extras section at the end of this chapter.</span></p>
<p><span class="koboSpan" id="kobo.381.1" xmlns="http://www.w3.org/1999/xhtml">The first step toward creating a nicely formatted document is to create the initial Markdown or ReStructuredText document </span><span id="dx1-336009"/><span class="koboSpan" id="kobo.382.1" xmlns="http://www.w3.org/1999/xhtml">from the summary. </span><span class="koboSpan" id="kobo.382.2" xmlns="http://www.w3.org/1999/xhtml">In many cases, this is easiest done with the </span><strong><span class="koboSpan" id="kobo.383.1" xmlns="http://www.w3.org/1999/xhtml">Jinja </span></strong><span class="koboSpan" id="kobo.384.1" xmlns="http://www.w3.org/1999/xhtml">package. </span><span class="koboSpan" id="kobo.384.2" xmlns="http://www.w3.org/1999/xhtml">See </span><a class="url" href="https://jinja.palletsprojects.com/en/3.1.x/"><span class="koboSpan" id="kobo.385.1" xmlns="http://www.w3.org/1999/xhtml">https://jinja.palletsprojects.com/en/3.1.x/</span></a></p>
<p><span class="koboSpan" id="kobo.386.1" xmlns="http://www.w3.org/1999/xhtml">One common approach is the following sequence of steps:</span></p>
<ol>
<li><div id="x1-336011x1">
<p><span class="koboSpan" id="kobo.387.1" xmlns="http://www.w3.org/1999/xhtml">Write a version of the report using Markdown (or RST).</span></p>
</div></li>
<li><div id="x1-336013x2">
<p><span class="koboSpan" id="kobo.388.1" xmlns="http://www.w3.org/1999/xhtml">Locate a template and style sheets that produce the desired HTML page when converted by the </span><strong><span class="koboSpan" id="kobo.389.1" xmlns="http://www.w3.org/1999/xhtml">Pandoc </span></strong><span class="koboSpan" id="kobo.390.1" xmlns="http://www.w3.org/1999/xhtml">or </span><strong><span class="koboSpan" id="kobo.391.1" xmlns="http://www.w3.org/1999/xhtml">Docutils </span></strong><span class="koboSpan" id="kobo.392.1" xmlns="http://www.w3.org/1999/xhtml">applications.</span></p>
</div></li>
<li><div id="x1-336015x3">
<p><span class="koboSpan" id="kobo.393.1" xmlns="http://www.w3.org/1999/xhtml">Refactor the source file to replace the content with </span><strong><span class="koboSpan" id="kobo.394.1" xmlns="http://www.w3.org/1999/xhtml">Jinja </span></strong><span class="koboSpan" id="kobo.395.1" xmlns="http://www.w3.org/1999/xhtml">placeholders. </span><span class="koboSpan" id="kobo.395.2" xmlns="http://www.w3.org/1999/xhtml">This becomes the template report.</span></p>
</div></li>
<li><div id="x1-336017x4">
<p><span class="koboSpan" id="kobo.396.1" xmlns="http://www.w3.org/1999/xhtml">Write an application to parse the TOML, then apply the TOML details to the template file.</span></p>
</div></li>
</ol>
<p><span class="koboSpan" id="kobo.397.1" xmlns="http://www.w3.org/1999/xhtml">When using </span><strong><span class="koboSpan" id="kobo.398.1" xmlns="http://www.w3.org/1999/xhtml">Jinja </span></strong><span class="koboSpan" id="kobo.399.1" xmlns="http://www.w3.org/1999/xhtml">to enable </span><span id="dx1-336018"/><span class="koboSpan" id="kobo.400.1" xmlns="http://www.w3.org/1999/xhtml">filling in the template, it must be added to the </span><code><span class="koboSpan" id="kobo.401.1" xmlns="http://www.w3.org/1999/xhtml">requirements.txt</span></code><span class="koboSpan" id="kobo.402.1" xmlns="http://www.w3.org/1999/xhtml"> file. </span><span class="koboSpan" id="kobo.402.2" xmlns="http://www.w3.org/1999/xhtml">If </span><strong><span class="koboSpan" id="kobo.403.1" xmlns="http://www.w3.org/1999/xhtml">ReStructuredText </span></strong><span class="koboSpan" id="kobo.404.1" xmlns="http://www.w3.org/1999/xhtml">(</span><strong><span class="koboSpan" id="kobo.405.1" xmlns="http://www.w3.org/1999/xhtml">RST</span></strong><span class="koboSpan" id="kobo.406.1" xmlns="http://www.w3.org/1999/xhtml">) is used, then the </span><strong><span class="koboSpan" id="kobo.407.1" xmlns="http://www.w3.org/1999/xhtml">docutils </span></strong><span class="koboSpan" id="kobo.408.1" xmlns="http://www.w3.org/1999/xhtml">project is also useful and should be added to the </span><code><span class="koboSpan" id="kobo.409.1" xmlns="http://www.w3.org/1999/xhtml">requirements.txt</span></code><span class="koboSpan" id="kobo.410.1" xmlns="http://www.w3.org/1999/xhtml"> file.</span></p>
<p><span class="koboSpan" id="kobo.411.1" xmlns="http://www.w3.org/1999/xhtml">If Markdown is used to create the report, then </span><strong><span class="koboSpan" id="kobo.412.1" xmlns="http://www.w3.org/1999/xhtml">Pandoc </span></strong><span class="koboSpan" id="kobo.413.1" xmlns="http://www.w3.org/1999/xhtml">is one way to handle the conversion from Markdown to HTML. </span><span class="koboSpan" id="kobo.413.2" xmlns="http://www.w3.org/1999/xhtml">Because </span><strong><span class="koboSpan" id="kobo.414.1" xmlns="http://www.w3.org/1999/xhtml">Pandoc </span></strong><span class="koboSpan" id="kobo.415.1" xmlns="http://www.w3.org/1999/xhtml">also converts RST to HTML, the </span><strong><span class="koboSpan" id="kobo.416.1" xmlns="http://www.w3.org/1999/xhtml">docutils </span></strong><span class="koboSpan" id="kobo.417.1" xmlns="http://www.w3.org/1999/xhtml">project is not required.</span></p>
<p><span class="koboSpan" id="kobo.418.1" xmlns="http://www.w3.org/1999/xhtml">Because the parsed TOML is a dictionary, fields can be extracted by the Jinja template. </span><span class="koboSpan" id="kobo.418.2" xmlns="http://www.w3.org/1999/xhtml">We might have a Markdown template </span><span id="dx1-336019"/><span class="koboSpan" id="kobo.419.1" xmlns="http://www.w3.org/1999/xhtml">file with a structure like the following:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-235">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.420.1" xmlns="http://www.w3.org/1999/xhtml"># Summary of {{ summary[’source’][’name’] }}

Created {{ summary[’identification’][’date’] }}

Some interesting notes about the project...

</span><span class="koboSpan" id="kobo.420.2" xmlns="http://www.w3.org/1999/xhtml">## X-Variable

Some interesting notes about this variable...

</span><span class="koboSpan" id="kobo.420.3" xmlns="http://www.w3.org/1999/xhtml">Mean = {{ summary[’x’][’location’][’mean’] }}

etc.</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.421.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.422.1" xmlns="http://www.w3.org/1999/xhtml">{{</span></code><code><span class="koboSpan" id="kobo.423.1" xmlns="http://www.w3.org/1999/xhtml"> some-expression</span></code><code><span class="koboSpan" id="kobo.424.1" xmlns="http://www.w3.org/1999/xhtml"> }}</span></code><span class="koboSpan" id="kobo.425.1" xmlns="http://www.w3.org/1999/xhtml"> constructs are placeholders. </span><span class="koboSpan" id="kobo.425.2" xmlns="http://www.w3.org/1999/xhtml">This is where Jinja will evaluate the Python expression and replace the placeholders with the resulting value. </span><span class="koboSpan" id="kobo.425.3" xmlns="http://www.w3.org/1999/xhtml">Because of Jinja’s clever implementation, a name like </span><code><span class="koboSpan" id="kobo.426.1" xmlns="http://www.w3.org/1999/xhtml">summary[’x’][’location’][’mean’]</span></code><span class="koboSpan" id="kobo.427.1" xmlns="http://www.w3.org/1999/xhtml"> can be written as </span><code><span class="koboSpan" id="kobo.428.1" xmlns="http://www.w3.org/1999/xhtml">summary.x.location.mean</span></code><span class="koboSpan" id="kobo.429.1" xmlns="http://www.w3.org/1999/xhtml">, also.</span></p>
<p><span class="koboSpan" id="kobo.430.1" xmlns="http://www.w3.org/1999/xhtml">The lines with </span><code><span class="koboSpan" id="kobo.431.1" xmlns="http://www.w3.org/1999/xhtml">#</span></code><span class="koboSpan" id="kobo.432.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.433.1" xmlns="http://www.w3.org/1999/xhtml">##</span></code><span class="koboSpan" id="kobo.434.1" xmlns="http://www.w3.org/1999/xhtml"> are the way Markdown specifies the section headings. </span><span class="koboSpan" id="kobo.434.2" xmlns="http://www.w3.org/1999/xhtml">For more information on Markdown, see </span><a class="url" href="https://daringfireball.net/projects/markdown/"><span class="koboSpan" id="kobo.435.1" xmlns="http://www.w3.org/1999/xhtml">https://daringfireball.net/projects/markdown/</span></a><span class="koboSpan" id="kobo.436.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.436.2" xmlns="http://www.w3.org/1999/xhtml">Note that there are a large number of Markdown extensions, and it’s important to be sure the rendering engine (like Pandoc) supports the extensions you’d like to use.</span></p>
<p><span class="koboSpan" id="kobo.437.1" xmlns="http://www.w3.org/1999/xhtml">The Jinja template language has numerous options for conditional and repeating document sections. </span><span class="koboSpan" id="kobo.437.2" xmlns="http://www.w3.org/1999/xhtml">This includes </span><code><span class="koboSpan" id="kobo.438.1" xmlns="http://www.w3.org/1999/xhtml">{%</span></code><code><span class="koboSpan" id="kobo.439.1" xmlns="http://www.w3.org/1999/xhtml"> for</span></code><code><span class="koboSpan" id="kobo.440.1" xmlns="http://www.w3.org/1999/xhtml"> name</span></code><code><span class="koboSpan" id="kobo.441.1" xmlns="http://www.w3.org/1999/xhtml"> in</span></code><code><span class="koboSpan" id="kobo.442.1" xmlns="http://www.w3.org/1999/xhtml"> sequence</span></code><code><span class="koboSpan" id="kobo.443.1" xmlns="http://www.w3.org/1999/xhtml"> %}</span></code><span class="koboSpan" id="kobo.444.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.445.1" xmlns="http://www.w3.org/1999/xhtml">{%</span></code><code><span class="koboSpan" id="kobo.446.1" xmlns="http://www.w3.org/1999/xhtml"> if</span></code><code><span class="koboSpan" id="kobo.447.1" xmlns="http://www.w3.org/1999/xhtml"> condition</span></code><code><span class="koboSpan" id="kobo.448.1" xmlns="http://www.w3.org/1999/xhtml"> %}</span></code><span class="koboSpan" id="kobo.449.1" xmlns="http://www.w3.org/1999/xhtml"> constructs to create extremely sophisticated templates. </span><span class="koboSpan" id="kobo.449.2" xmlns="http://www.w3.org/1999/xhtml">With these constructs, a single template can be used for a number of </span><span id="dx1-336033"/><span class="koboSpan" id="kobo.450.1" xmlns="http://www.w3.org/1999/xhtml">closely related situations with optional sections to cover special situations.</span></p>
<p><span class="koboSpan" id="kobo.451.1" xmlns="http://www.w3.org/1999/xhtml">The application program to inject values from the </span><code><span class="koboSpan" id="kobo.452.1" xmlns="http://www.w3.org/1999/xhtml">summary</span></code><span class="koboSpan" id="kobo.453.1" xmlns="http://www.w3.org/1999/xhtml"> object into the template shouldn’t be much more complicated than the examples shown on the Jinja basics page. </span><span class="koboSpan" id="kobo.453.2" xmlns="http://www.w3.org/1999/xhtml">See </span><a class="url" href="https://jinja.palletsprojects.com/en/3.1.x/api/#basics"><span class="koboSpan" id="kobo.454.1" xmlns="http://www.w3.org/1999/xhtml">https://jinja.palletsprojects.com/en/3.1.x/api/#basics</span></a><span class="koboSpan" id="kobo.455.1" xmlns="http://www.w3.org/1999/xhtml"> for some applications that load a template and inject values.</span></p>
<p><span class="koboSpan" id="kobo.456.1" xmlns="http://www.w3.org/1999/xhtml">This program’s output is a file with a name like </span><code><span class="koboSpan" id="kobo.457.1" xmlns="http://www.w3.org/1999/xhtml">summary_report.md</span></code><span class="koboSpan" id="kobo.458.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.458.2" xmlns="http://www.w3.org/1999/xhtml">This file would be ready for conversion to any of a large number of other formats.</span></p>
<p><span class="koboSpan" id="kobo.459.1" xmlns="http://www.w3.org/1999/xhtml">The process of converting a Markdown file to HTML is handled by the </span><strong><span class="koboSpan" id="kobo.460.1" xmlns="http://www.w3.org/1999/xhtml">Pandoc</span></strong><span class="koboSpan" id="kobo.461.1" xmlns="http://www.w3.org/1999/xhtml"> application. </span><span class="koboSpan" id="kobo.461.2" xmlns="http://www.w3.org/1999/xhtml">See </span><a class="url" href="https://pandoc.org/demos.html"><span class="koboSpan" id="kobo.462.1" xmlns="http://www.w3.org/1999/xhtml">https://pandoc.org/demos.html</span></a><span class="koboSpan" id="kobo.463.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.463.2" xmlns="http://www.w3.org/1999/xhtml">The command might be as complicated as the following:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-236">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.464.1" xmlns="http://www.w3.org/1999/xhtml">pandoc -s --toc -c pandoc.css summary_report.md -o summary_report.html</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.465.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.466.1" xmlns="http://www.w3.org/1999/xhtml">pandoc.css</span></code><span class="koboSpan" id="kobo.467.1" xmlns="http://www.w3.org/1999/xhtml"> file can provide the CSS styles to create a body that’s narrow enough to be printed on an ordinary US letter or A4 paper.</span></p>
<p><span class="koboSpan" id="kobo.468.1" xmlns="http://www.w3.org/1999/xhtml">The application that creates the </span><code><span class="koboSpan" id="kobo.469.1" xmlns="http://www.w3.org/1999/xhtml">summary_report.md</span></code><span class="koboSpan" id="kobo.470.1" xmlns="http://www.w3.org/1999/xhtml"> file can use </span><code><span class="koboSpan" id="kobo.471.1" xmlns="http://www.w3.org/1999/xhtml">subprocess.run()</span></code><span class="koboSpan" id="kobo.472.1" xmlns="http://www.w3.org/1999/xhtml"> to execute the </span><strong><span class="koboSpan" id="kobo.473.1" xmlns="http://www.w3.org/1999/xhtml">Pandoc </span></strong><span class="koboSpan" id="kobo.474.1" xmlns="http://www.w3.org/1999/xhtml">application and create the desired HTML file. </span><span class="koboSpan" id="kobo.474.2" xmlns="http://www.w3.org/1999/xhtml">This provides a command-line UX that results in a readable document, ready to be distributed. </span><span id="x1-336035r358"/></p>
</section>
</section>
<section class="level2" data-number="19.4" id="summary-14">
<h2 data-number="19.4"><span class="titlemark"><span class="koboSpan" id="kobo.475.1" xmlns="http://www.w3.org/1999/xhtml">15.4 </span></span> <span id="x1-3370004"/><span class="koboSpan" id="kobo.476.1" xmlns="http://www.w3.org/1999/xhtml">Summary</span></h2>
<p><span class="koboSpan" id="kobo.477.1" xmlns="http://www.w3.org/1999/xhtml">In this chapter we have created a foundation for building and using a statistical model of source data. </span><span class="koboSpan" id="kobo.477.2" xmlns="http://www.w3.org/1999/xhtml">We’ve looked at the following topics:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.478.1" xmlns="http://www.w3.org/1999/xhtml">Designing and building a more complex pipeline of processes for gathering and analyzing data.</span></p></li>
<li><p><span class="koboSpan" id="kobo.479.1" xmlns="http://www.w3.org/1999/xhtml">Some of the core concepts behind creating a statistical model of some data.</span></p></li>
<li><p><span class="koboSpan" id="kobo.480.1" xmlns="http://www.w3.org/1999/xhtml">Use of the built-in </span><code><span class="koboSpan" id="kobo.481.1" xmlns="http://www.w3.org/1999/xhtml">statistics</span></code><span class="koboSpan" id="kobo.482.1" xmlns="http://www.w3.org/1999/xhtml"> library.</span></p></li>
<li><p><span class="koboSpan" id="kobo.483.1" xmlns="http://www.w3.org/1999/xhtml">Publishing the results of the statistical measures.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.484.1" xmlns="http://www.w3.org/1999/xhtml">This application tends to be relatively small. </span><span class="koboSpan" id="kobo.484.2" xmlns="http://www.w3.org/1999/xhtml">The actual computations of the various statistical values leverage the built-in </span><code><span class="koboSpan" id="kobo.485.1" xmlns="http://www.w3.org/1999/xhtml">statistics</span></code><span class="koboSpan" id="kobo.486.1" xmlns="http://www.w3.org/1999/xhtml"> library and tend to be very small. </span><span class="koboSpan" id="kobo.486.2" xmlns="http://www.w3.org/1999/xhtml">It often seems like there’s far more programming involved in parsing the CLI argument values, and creating the required output file, than doing the “real work” of this application.</span></p>
<p><span class="koboSpan" id="kobo.487.1" xmlns="http://www.w3.org/1999/xhtml">This is a consequence of the way we’ve been separating the various concerns in data acquisition, cleaning, and analysis. </span><span class="koboSpan" id="kobo.487.2" xmlns="http://www.w3.org/1999/xhtml">We’ve partitioned the work into several, isolated stages along a pipeline:</span></p>
<ol>
<li><div id="x1-337002x1">
<p><span class="koboSpan" id="kobo.488.1" xmlns="http://www.w3.org/1999/xhtml">Acquiring raw data, generally in text form. </span><span class="koboSpan" id="kobo.488.2" xmlns="http://www.w3.org/1999/xhtml">This can involve database access or RESTful API access, or complicated file parsing problems.</span></p>
</div></li>
<li><div id="x1-337004x2">
<p><span class="koboSpan" id="kobo.489.1" xmlns="http://www.w3.org/1999/xhtml">Cleaning and converting the raw data to a more useful, native Python form. </span><span class="koboSpan" id="kobo.489.2" xmlns="http://www.w3.org/1999/xhtml">This can involve complications of parsing text and rejecting outlier values.</span></p>
</div></li>
<li><div id="x1-337006x3">
<p><span class="koboSpan" id="kobo.490.1" xmlns="http://www.w3.org/1999/xhtml">Summarizing and analyzing the cleaned data. </span><span class="koboSpan" id="kobo.490.2" xmlns="http://www.w3.org/1999/xhtml">This can focus on the data model and reporting conclusions about the data.</span></p>
</div></li>
</ol>
<p><span class="koboSpan" id="kobo.491.1" xmlns="http://www.w3.org/1999/xhtml">The idea here is the final application can grow and adapt as our understanding of the data matures. </span><span class="koboSpan" id="kobo.491.2" xmlns="http://www.w3.org/1999/xhtml">In the next chapter, we’ll add features to the summary program to create deeper insights into the available data. </span><span id="x1-337007r362"/></p>
</section>
<section class="level2" data-number="19.5" id="extras-13">
<h2 data-number="19.5"><span class="titlemark"><span class="koboSpan" id="kobo.492.1" xmlns="http://www.w3.org/1999/xhtml">15.5 </span></span> <span id="x1-3380005"/><span class="koboSpan" id="kobo.493.1" xmlns="http://www.w3.org/1999/xhtml">Extras</span></h2>
<p><span class="koboSpan" id="kobo.494.1" xmlns="http://www.w3.org/1999/xhtml">Here are some ideas for you to add to this project. </span><span id="x1-338001r361"/></p>
<section class="level3" data-number="19.5.1" id="measures-of-shape">
<h3 data-number="19.5.1"><span class="titlemark"><span class="koboSpan" id="kobo.495.1" xmlns="http://www.w3.org/1999/xhtml">15.5.1 </span></span> <span id="x1-3390001"/><span class="koboSpan" id="kobo.496.1" xmlns="http://www.w3.org/1999/xhtml">Measures of shape</span></h3>
<p><span class="koboSpan" id="kobo.497.1" xmlns="http://www.w3.org/1999/xhtml">The measurements of shape often involve two computations for skewness and kurtosis. </span><span class="koboSpan" id="kobo.497.2" xmlns="http://www.w3.org/1999/xhtml">These functions are not part of Python’s built-in </span><code><span class="koboSpan" id="kobo.498.1" xmlns="http://www.w3.org/1999/xhtml">statistics</span></code><span class="koboSpan" id="kobo.499.1" xmlns="http://www.w3.org/1999/xhtml"> library.</span></p>
<p><span class="koboSpan" id="kobo.500.1" xmlns="http://www.w3.org/1999/xhtml">It’s important to note that there are a very large number of distinct, well-understood distributions of data. </span><span class="koboSpan" id="kobo.500.2" xmlns="http://www.w3.org/1999/xhtml">The normal distribution is one of many different ways data can be distributed.</span></p>
<p><span class="koboSpan" id="kobo.501.1" xmlns="http://www.w3.org/1999/xhtml">See </span><a class="url" href="https://www.itl.nist.gov/div898/handbook/eda/section3/eda366.htm"><span class="koboSpan" id="kobo.502.1" xmlns="http://www.w3.org/1999/xhtml">https://www.itl.nist.gov/div898/handbook/eda/section3/eda366.htm</span></a><span class="koboSpan" id="kobo.503.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.504.1" xmlns="http://www.w3.org/1999/xhtml">One measure of skewness is the following:</span></p>
<div class="math-display">
<span class="koboSpan" id="kobo.505.1" xmlns="http://www.w3.org/1999/xhtml"><img alt=" ∑(Y− ¯Y)3 ----iN---- g1 = s3 " class="math-display" src="../media/file62.jpg"/></span>
</div>
<p><span class="koboSpan" id="kobo.506.1" xmlns="http://www.w3.org/1999/xhtml">Where </span><em><span class="koboSpan" id="kobo.507.1" xmlns="http://www.w3.org/1999/xhtml">Ȳ</span></em><span class="koboSpan" id="kobo.508.1" xmlns="http://www.w3.org/1999/xhtml"> is the mean, and </span><em><span class="koboSpan" id="kobo.509.1" xmlns="http://www.w3.org/1999/xhtml">s </span></em><span class="koboSpan" id="kobo.510.1" xmlns="http://www.w3.org/1999/xhtml">is the standard deviation.</span></p>
<p><span class="koboSpan" id="kobo.511.1" xmlns="http://www.w3.org/1999/xhtml">A symmetric distribution will have a skewness, </span><em><span class="koboSpan" id="kobo.512.1" xmlns="http://www.w3.org/1999/xhtml">g</span></em><sub><span class="cmr-8"><span class="koboSpan" id="kobo.513.1" xmlns="http://www.w3.org/1999/xhtml">1</span></span></sub><span class="koboSpan" id="kobo.514.1" xmlns="http://www.w3.org/1999/xhtml">, near zero. </span><span class="koboSpan" id="kobo.514.2" xmlns="http://www.w3.org/1999/xhtml">Larger numbers indicate a ”long tail” opposite a large concentration of data around the mean.</span></p>
<p><span class="koboSpan" id="kobo.515.1" xmlns="http://www.w3.org/1999/xhtml">One measure of kurtosis is the following:</span></p>
<div class="math-display">
<span class="koboSpan" id="kobo.516.1" xmlns="http://www.w3.org/1999/xhtml"><img alt=" ∑ (Y −Y¯)4 ---iN----- kurtosis = s4 " class="math-display" src="../media/file63.jpg"/></span>
</div>
<p><span class="koboSpan" id="kobo.517.1" xmlns="http://www.w3.org/1999/xhtml">The kurtosis for the standard normal distribution is 3. </span><span class="koboSpan" id="kobo.517.2" xmlns="http://www.w3.org/1999/xhtml">A value larger than 3 suggests more data is in the tails; it’s ”flatter” or ”wider” than the standard normal distribution. </span><span class="koboSpan" id="kobo.517.3" xmlns="http://www.w3.org/1999/xhtml">A value less than three is ”taller” or ”narrower” than the standard.</span></p>
<p><span class="koboSpan" id="kobo.518.1" xmlns="http://www.w3.org/1999/xhtml">These metrics can be added to the application to compute some additional univariate descriptive statistics. </span><span id="x1-339001r364"/></p>
</section>
<section class="level3" data-number="19.5.2" id="creating-pdf-reports">
<h3 data-number="19.5.2"><span class="titlemark"><span class="koboSpan" id="kobo.519.1" xmlns="http://www.w3.org/1999/xhtml">15.5.2 </span></span> <span id="x1-3400002"/><span class="koboSpan" id="kobo.520.1" xmlns="http://www.w3.org/1999/xhtml">Creating PDF reports</span></h3>
<p><span class="koboSpan" id="kobo.521.1" xmlns="http://www.w3.org/1999/xhtml">In the </span><a href="#x1-3360003"><em><span class="koboSpan" id="kobo.522.1" xmlns="http://www.w3.org/1999/xhtml">Application secondary feature</span></em></a><span class="koboSpan" id="kobo.523.1" xmlns="http://www.w3.org/1999/xhtml"> section we looked at creating a Markdown or RST document with the essential content, some additional information, and an organizational structure. </span><span class="koboSpan" id="kobo.523.2" xmlns="http://www.w3.org/1999/xhtml">The intent was to use a tool like </span><strong><span class="koboSpan" id="kobo.524.1" xmlns="http://www.w3.org/1999/xhtml">Pandoc </span></strong><span class="koboSpan" id="kobo.525.1" xmlns="http://www.w3.org/1999/xhtml">to convert the Markdown to HTML. </span><span class="koboSpan" id="kobo.525.2" xmlns="http://www.w3.org/1999/xhtml">The HTML can be rendered by a browser to present an easy-to-read summary report.</span></p>
<p><span class="koboSpan" id="kobo.526.1" xmlns="http://www.w3.org/1999/xhtml">Publishing this document as a PDF requires a tool that can create the necessary output file. </span><span class="koboSpan" id="kobo.526.2" xmlns="http://www.w3.org/1999/xhtml">There are two common choices:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.527.1" xmlns="http://www.w3.org/1999/xhtml">Use the </span><strong><span class="koboSpan" id="kobo.528.1" xmlns="http://www.w3.org/1999/xhtml">ReportLab </span></strong><span class="koboSpan" id="kobo.529.1" xmlns="http://www.w3.org/1999/xhtml">tool: </span><a class="url" href="https://www.reportlab.com/dev/docs/"><span class="koboSpan" id="kobo.530.1" xmlns="http://www.w3.org/1999/xhtml">https://www.reportlab.com/dev/docs/</span></a><span class="koboSpan" id="kobo.531.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.531.2" xmlns="http://www.w3.org/1999/xhtml">This is a commercial product with some open-source components.</span></p></li>
<li><p><span class="koboSpan" id="kobo.532.1" xmlns="http://www.w3.org/1999/xhtml">Use the </span><strong><span class="koboSpan" id="kobo.533.1" xmlns="http://www.w3.org/1999/xhtml">Pandoc </span></strong><span class="koboSpan" id="kobo.534.1" xmlns="http://www.w3.org/1999/xhtml">tool coupled with a LaTeX processing tool.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.535.1" xmlns="http://www.w3.org/1999/xhtml">See </span><a href="ch018.xhtml#x1-3190002"><em><span class="koboSpan" id="kobo.536.1" xmlns="http://www.w3.org/1999/xhtml">Preparing a report</span></em></a><span class="koboSpan" id="kobo.537.1" xmlns="http://www.w3.org/1999/xhtml"> of </span><a href="ch018.xhtml#x1-31300014"><em><span class="koboSpan" id="kobo.538.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em><em><span class="koboSpan" id="kobo.539.1" xmlns="http://www.w3.org/1999/xhtml"> 14</span></em></a><span class="koboSpan" id="kobo.540.1" xmlns="http://www.w3.org/1999/xhtml">, </span><a href="ch018.xhtml#x1-31300014"><em><span class="koboSpan" id="kobo.541.1" xmlns="http://www.w3.org/1999/xhtml">Project 4.2: Creating Reports</span></em></a><span class="koboSpan" id="kobo.542.1" xmlns="http://www.w3.org/1999/xhtml"> for some additional thoughts on using LaTeX to create PDF files. </span><span class="koboSpan" id="kobo.542.2" xmlns="http://www.w3.org/1999/xhtml">While this involves a large number of separate components, it has the advantage of having the most capabilities.</span></p>
<p><span class="koboSpan" id="kobo.543.1" xmlns="http://www.w3.org/1999/xhtml">It’s often best to learn the LaTeX tools separately. </span><span class="koboSpan" id="kobo.543.2" xmlns="http://www.w3.org/1999/xhtml">The TeXLive project maintains a number of tools useful for rendering LaTeX. </span><span class="koboSpan" id="kobo.543.3" xmlns="http://www.w3.org/1999/xhtml">For macOS users, the MacTex project offers the required binaries. </span><span class="koboSpan" id="kobo.543.4" xmlns="http://www.w3.org/1999/xhtml">An online tool like Overleaf is also useful for handling LaTeX. </span><span class="koboSpan" id="kobo.543.5" xmlns="http://www.w3.org/1999/xhtml">Sort out any problems by creating small </span><code><span class="koboSpan" id="kobo.544.1" xmlns="http://www.w3.org/1999/xhtml">hello_world.tex</span></code><span class="koboSpan" id="kobo.545.1" xmlns="http://www.w3.org/1999/xhtml"> example documents to see how the LaTeX tools work.</span></p>
<p><span class="koboSpan" id="kobo.546.1" xmlns="http://www.w3.org/1999/xhtml">Once the basics of the LaTeX tools are working, it makes sense to add the </span><strong><span class="koboSpan" id="kobo.547.1" xmlns="http://www.w3.org/1999/xhtml">Pandoc </span></strong><span class="koboSpan" id="kobo.548.1" xmlns="http://www.w3.org/1999/xhtml">tool to the environment.</span></p>
<p><span class="koboSpan" id="kobo.549.1" xmlns="http://www.w3.org/1999/xhtml">Neither of these tools are Python-based and don’t use </span><strong><span class="koboSpan" id="kobo.550.1" xmlns="http://www.w3.org/1999/xhtml">conda </span></strong><span class="koboSpan" id="kobo.551.1" xmlns="http://www.w3.org/1999/xhtml">or </span><strong><span class="koboSpan" id="kobo.552.1" xmlns="http://www.w3.org/1999/xhtml">pip</span></strong><span class="koboSpan" id="kobo.553.1" xmlns="http://www.w3.org/1999/xhtml"> installers.</span></p>
<p><span class="koboSpan" id="kobo.554.1" xmlns="http://www.w3.org/1999/xhtml">As noted in </span><a href="ch018.xhtml#x1-31300014"><em><span class="koboSpan" id="kobo.555.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em><em><span class="koboSpan" id="kobo.556.1" xmlns="http://www.w3.org/1999/xhtml"> 14</span></em></a><span class="koboSpan" id="kobo.557.1" xmlns="http://www.w3.org/1999/xhtml">, </span><a href="ch018.xhtml#x1-31300014"><em><span class="koboSpan" id="kobo.558.1" xmlns="http://www.w3.org/1999/xhtml">Project 4.2: Creating Reports</span></em></a><span class="koboSpan" id="kobo.559.1" xmlns="http://www.w3.org/1999/xhtml">, there are a lot of components to this tool chain. </span><span class="koboSpan" id="kobo.559.2" xmlns="http://www.w3.org/1999/xhtml">This is a large number of separate installs that need to be managed. </span><span class="koboSpan" id="kobo.559.3" xmlns="http://www.w3.org/1999/xhtml">The results, however, can be very nice when a final PDF is created from a few CLI interactions. </span><span id="x1-340001r365"/></p>
</section>
<section class="level3" data-number="19.5.3" id="serving-the-html-report-from-the-data-api">
<h3 data-number="19.5.3"><span class="titlemark"><span class="koboSpan" id="kobo.560.1" xmlns="http://www.w3.org/1999/xhtml">15.5.3 </span></span> <span id="x1-3410003"/><span class="koboSpan" id="kobo.561.1" xmlns="http://www.w3.org/1999/xhtml">Serving the HTML report from the data API</span></h3>
<p><span class="koboSpan" id="kobo.562.1" xmlns="http://www.w3.org/1999/xhtml">In </span><a href="ch016.xhtml#x1-27600012"><em><span class="koboSpan" id="kobo.563.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em><em><span class="koboSpan" id="kobo.564.1" xmlns="http://www.w3.org/1999/xhtml"> 12</span></em></a><span class="koboSpan" id="kobo.565.1" xmlns="http://www.w3.org/1999/xhtml">, </span><a href="ch016.xhtml#x1-27600012"><em><span class="koboSpan" id="kobo.566.1" xmlns="http://www.w3.org/1999/xhtml">Project 3.8: Integrated Data Acquisition Web Service</span></em></a><span class="koboSpan" id="kobo.567.1" xmlns="http://www.w3.org/1999/xhtml"> we created a RESTful API service to provide cleaned data.</span></p>
<p><span class="koboSpan" id="kobo.568.1" xmlns="http://www.w3.org/1999/xhtml">This service can be expanded to provide several other things. </span><span class="koboSpan" id="kobo.568.2" xmlns="http://www.w3.org/1999/xhtml">The most notable addition is the HTML summary report.</span></p>
<p><span class="koboSpan" id="kobo.569.1" xmlns="http://www.w3.org/1999/xhtml">The process of creating a summary report will look like this:</span></p>
<ol>
<li><div id="x1-341002x1">
<p><span class="koboSpan" id="kobo.570.1" xmlns="http://www.w3.org/1999/xhtml">A user makes a request for a summary report for a given time period.</span></p>
</div></li>
<li><div id="x1-341004x2">
<p><span class="koboSpan" id="kobo.571.1" xmlns="http://www.w3.org/1999/xhtml">The RESTful API creates a “task” to be performed in the background and responds with the status showing the task has been created.</span></p>
</div></li>
<li><div id="x1-341006x3">
<p><span class="koboSpan" id="kobo.572.1" xmlns="http://www.w3.org/1999/xhtml">The user checks back periodically to see if the processing has finished. </span><span class="koboSpan" id="kobo.572.2" xmlns="http://www.w3.org/1999/xhtml">Some clever JavaScript programming can display an animation while an application program checks to see if the work is completed.</span></p>
</div></li>
<li><div id="x1-341008x4">
<p><span class="koboSpan" id="kobo.573.1" xmlns="http://www.w3.org/1999/xhtml">Once the processing is complete, the user can download the final report.</span></p>
</div></li>
</ol>
<p><span class="koboSpan" id="kobo.574.1" xmlns="http://www.w3.org/1999/xhtml">This means two new resources paths will need to be added to the OpenAPI specification. </span><span class="koboSpan" id="kobo.574.2" xmlns="http://www.w3.org/1999/xhtml">These two new resources are:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.575.1" xmlns="http://www.w3.org/1999/xhtml">Requests to create a new summary. </span><span class="koboSpan" id="kobo.575.2" xmlns="http://www.w3.org/1999/xhtml">A POST request creates the task to build a summary and a GET request shows the status. </span><span class="koboSpan" id="kobo.575.3" xmlns="http://www.w3.org/1999/xhtml">A </span><code><span class="koboSpan" id="kobo.576.1" xmlns="http://www.w3.org/1999/xhtml">2023.03/summarize</span></code><span class="koboSpan" id="kobo.577.1" xmlns="http://www.w3.org/1999/xhtml"> path will parallel the </span><code><span class="koboSpan" id="kobo.578.1" xmlns="http://www.w3.org/1999/xhtml">2023.02/creation</span></code><span class="koboSpan" id="kobo.579.1" xmlns="http://www.w3.org/1999/xhtml"> path used to create the series.</span></p></li>
<li><p><span class="koboSpan" id="kobo.580.1" xmlns="http://www.w3.org/1999/xhtml">Requests for a summary report. </span><span class="koboSpan" id="kobo.580.2" xmlns="http://www.w3.org/1999/xhtml">A GET request will download a given statistical summary report. </span><span class="koboSpan" id="kobo.580.3" xmlns="http://www.w3.org/1999/xhtml">Perhaps a </span><code><span class="koboSpan" id="kobo.581.1" xmlns="http://www.w3.org/1999/xhtml">2023.03/report</span></code><span class="koboSpan" id="kobo.582.1" xmlns="http://www.w3.org/1999/xhtml"> path would be appropriate.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.583.1" xmlns="http://www.w3.org/1999/xhtml">As we add features to the RESTful API, we need to consider the resource names more and more carefully. </span><span class="koboSpan" id="kobo.583.2" xmlns="http://www.w3.org/1999/xhtml">The first wave of ideas sometimes fails to reflect the growing understanding of the user’s needs.</span></p>
<div class="tcolorbox tipbox" id="tcolobox-237">
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.584.1" xmlns="http://www.w3.org/1999/xhtml">In retrospect, the </span><code><span class="koboSpan" id="kobo.585.1" xmlns="http://www.w3.org/1999/xhtml">2023.02/create</span></code><span class="koboSpan" id="kobo.586.1" xmlns="http://www.w3.org/1999/xhtml"> path, defined in </span><a href="ch016.xhtml#x1-27600012"><em><span class="koboSpan" id="kobo.587.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em><em><span class="koboSpan" id="kobo.588.1" xmlns="http://www.w3.org/1999/xhtml"> 12</span></em></a><span class="koboSpan" id="kobo.589.1" xmlns="http://www.w3.org/1999/xhtml">, </span><a href="ch016.xhtml#x1-27600012"><em><span class="koboSpan" id="kobo.590.1" xmlns="http://www.w3.org/1999/xhtml">Project 3.8: Integrated Data Acquisition Web Service</span></em></a><span class="koboSpan" id="kobo.591.1" xmlns="http://www.w3.org/1999/xhtml">, may not have been the best name.</span></p>
<p><span class="koboSpan" id="kobo.592.1" xmlns="http://www.w3.org/1999/xhtml">There’s an interesting tension between requests to create a resource and the resulting resource. </span><span class="koboSpan" id="kobo.592.2" xmlns="http://www.w3.org/1999/xhtml">The request to create a series is clearly distinct from the resulting series. </span><span class="koboSpan" id="kobo.592.3" xmlns="http://www.w3.org/1999/xhtml">Yet, they can both be meaningfully thought of as instances of “series.” </span><span class="koboSpan" id="kobo.592.4" xmlns="http://www.w3.org/1999/xhtml">The creation request is a kind of </span><em><span class="koboSpan" id="kobo.593.1" xmlns="http://www.w3.org/1999/xhtml">future</span></em><span class="koboSpan" id="kobo.594.1" xmlns="http://www.w3.org/1999/xhtml">: an expectation that will be fulfilled later.</span></p>
<p><span class="koboSpan" id="kobo.595.1" xmlns="http://www.w3.org/1999/xhtml">An alternative naming scheme is to use </span><code><span class="koboSpan" id="kobo.596.1" xmlns="http://www.w3.org/1999/xhtml">2023.02/creation</span></code><span class="koboSpan" id="kobo.597.1" xmlns="http://www.w3.org/1999/xhtml"> for series, and use </span><code><span class="koboSpan" id="kobo.598.1" xmlns="http://www.w3.org/1999/xhtml">2023.03/create/series</span></code><span class="koboSpan" id="kobo.599.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.600.1" xmlns="http://www.w3.org/1999/xhtml">2023.03/create/summary</span></code><span class="koboSpan" id="kobo.601.1" xmlns="http://www.w3.org/1999/xhtml"> as distinct paths to manage the long-running background that does the work.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.602.1" xmlns="http://www.w3.org/1999/xhtml">The task being performed in the background will execute a number of steps:</span></p>
<ol>
<li><div id="x1-341010x1">
<p><span class="koboSpan" id="kobo.603.1" xmlns="http://www.w3.org/1999/xhtml">Determine if the request requires new data or existing data. </span><span class="koboSpan" id="kobo.603.2" xmlns="http://www.w3.org/1999/xhtml">If new data is needed, it is acquired, and cleaned. </span><span class="koboSpan" id="kobo.603.3" xmlns="http://www.w3.org/1999/xhtml">This is the existing process to acquire the series of data points.</span></p>
</div></li>
<li><div id="x1-341012x2">
<p><span class="koboSpan" id="kobo.604.1" xmlns="http://www.w3.org/1999/xhtml">Determine if the requested summary does not already exist. </span><span class="koboSpan" id="kobo.604.2" xmlns="http://www.w3.org/1999/xhtml">(For new data, of course, it will not exist.) If a summary is needed, it is created.</span></p>
</div></li>
</ol>
<p><span class="koboSpan" id="kobo.605.1" xmlns="http://www.w3.org/1999/xhtml">Once the processing is complete, the raw data, cleaned data, and summary can all be available as resources on the API server. </span><span class="koboSpan" id="kobo.605.2" xmlns="http://www.w3.org/1999/xhtml">The user can request to download any of these resources.</span></p>
<p><span class="koboSpan" id="kobo.606.1" xmlns="http://www.w3.org/1999/xhtml">It’s essential to be sure each of the components for the task work in isolation before attempting to integrate them as part of a web service. </span><span class="koboSpan" id="kobo.606.2" xmlns="http://www.w3.org/1999/xhtml">It’s far easier to diagnose and debug problems with summary reporting outside the complicated world of web services. </span><span id="x1-341013r350"/></p>
</section>
</section>
</section>
</body>
</html>
