<html><head></head><body>
<div class="Basic-Text-Frame" id="_idContainer397">
<h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">14</span></h1>
<h1 class="chapterTitle" id="_idParaDest-368"><span class="koboSpan" id="kobo.2.1">Rendering and Caching Content</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3.1">In the previous chapter, you used model inheritance and generic relations to create flexible course content models. </span><span class="koboSpan" id="kobo.3.2">You implemented a custom model field and you built a course management system using class-based views. </span><span class="koboSpan" id="kobo.3.3">Finally, you created a JavaScript drag-and-drop functionality using asynchronous HTTP requests to order course modules and their contents.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.4.1">In this chapter, you will build the functionality to create a student registration system and manage student enrollment in courses. </span><span class="koboSpan" id="kobo.4.2">You will implement rendering of the different types of course content and learn how to cache data using the Django cache framework.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.5.1">Rendering diverse content types is essential in e-learning platforms, where courses are typically structured with flexible modules that include a mix of text, images, videos, and documents. </span><span class="koboSpan" id="kobo.5.2">In this context, caching also becomes crucial. </span><span class="koboSpan" id="kobo.5.3">Since course content usually remains unchanged for extended periods – days, weeks, or even months – caching helps conserve computing power and reduces the need to query the database each time students access the same materials. </span><span class="koboSpan" id="kobo.5.4">By caching data, you not only save system resources but also improve performance when delivering content to a large number of students.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.6.1">In this chapter, you will:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.7.1">Create public views for displaying course information</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.8.1">Build a student registration system</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.9.1">Manage student enrollment in courses</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.10.1">Render diverse content for course modules</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.11.1">Install and configure Memcached</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.12.1">Cache content using the Django cache framework</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.13.1">Use the Memcached and Redis cache backends</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.14.1">Monitor your Redis server in the Django administration site</span></li>
</ul>
<h1 class="heading-1" id="_idParaDest-369"><span class="koboSpan" id="kobo.15.1">Functional overview</span></h1>
<p class="normal"><em class="italic"><span class="koboSpan" id="kobo.16.1">Figure 14.1</span></em><span class="koboSpan" id="kobo.17.1"> shows a representation of the views, templates, and functionalities that will be built in this chapter:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.18.1"><img alt="" role="presentation" src="../Images/B21088_14_01.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.19.1">Figure 14.1: Diagram of functionalities built in Chapter 14</span></p>
<p class="normal"><span class="koboSpan" id="kobo.20.1">In this chapter, you will implement the </span><code class="inlineCode"><span class="koboSpan" id="kobo.21.1">CourseListView</span></code><span class="koboSpan" id="kobo.22.1"> public view to list courses and </span><code class="inlineCode"><span class="koboSpan" id="kobo.23.1">CourseDetailView</span></code><span class="koboSpan" id="kobo.24.1"> to show the details of a course. </span><span class="koboSpan" id="kobo.24.2">You will implement </span><code class="inlineCode"><span class="koboSpan" id="kobo.25.1">StudentRegistrationView</span></code><span class="koboSpan" id="kobo.26.1"> to allow students to create user accounts and </span><code class="inlineCode"><span class="koboSpan" id="kobo.27.1">StudentCourseListView</span></code><span class="koboSpan" id="kobo.28.1"> for students to enroll in courses. </span><span class="koboSpan" id="kobo.28.2">You will create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.29.1">StudentCourseListView</span></code><span class="koboSpan" id="kobo.30.1"> for students to see the list of courses they are enrolled in and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.31.1">StudentCourseDetailView</span></code><span class="koboSpan" id="kobo.32.1"> to access all the content of a course, organized in the different course modules. </span><span class="koboSpan" id="kobo.32.2">You will also add a cache to your views using the Django cache framework, first with the Memcached backend and then replacing it with the Redis cache backend.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.33.1">The source code for this chapter can be found at </span><a href="https://github.com/PacktPublishing/Django-5-by-example/tree/main/Chapter14"><span class="url"><span class="koboSpan" id="kobo.34.1">https://github.com/PacktPublishing/Django-5-by-example/tree/main/Chapter14</span></span></a><span class="koboSpan" id="kobo.35.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.36.1">All Python modules used in this chapter are included in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.37.1">requirements.txt</span></code><span class="koboSpan" id="kobo.38.1"> file in the source code that comes along with this chapter. </span><span class="koboSpan" id="kobo.38.2">You can follow the instructions to install each Python module below or you can install all requirements at once with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.39.1">python -m pip install -r requirements.txt</span></code><span class="koboSpan" id="kobo.40.1"> command.</span></p>
<h1 class="heading-1" id="_idParaDest-370"><span class="koboSpan" id="kobo.41.1">Displaying the catalog of courses</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.42.1">You might be</span><a id="_idIndexMarker1262"/><span class="koboSpan" id="kobo.43.1"> eager to get to rendering and caching but there are a few items we must set up before we can do that. </span><span class="koboSpan" id="kobo.43.2">Let’s start with the course catalog. </span><span class="koboSpan" id="kobo.43.3">For your course catalog, you have to build the following functionalities:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.44.1">List all available courses, optionally filtered by subject</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.45.1">Display a single course overview</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.46.1">This will allow students to see all the courses available on the platform and enroll in those they are interested in. </span><span class="koboSpan" id="kobo.46.2">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.47.1">views.py</span></code><span class="koboSpan" id="kobo.48.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.49.1">courses</span></code><span class="koboSpan" id="kobo.50.1"> application and add the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.51.1">from</span></span><span class="koboSpan" id="kobo.52.1"> django.db.models </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.53.1">import</span></span><span class="koboSpan" id="kobo.54.1"> Count
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.55.1">from</span></span><span class="koboSpan" id="kobo.56.1"> .models </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.57.1">import</span></span><span class="koboSpan" id="kobo.58.1"> Subject
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.59.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.60.1">CourseListView</span></span><span class="koboSpan" id="kobo.61.1">(TemplateResponseMixin, View):
    model = Course
    template_name = </span><span class="hljs-string"><span class="koboSpan" id="kobo.62.1">'courses/course/list.html'</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.63.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.64.1">get</span></span><span class="koboSpan" id="kobo.65.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.66.1">self, request, subject=</span></span><span class="hljs-literal"><span class="koboSpan" id="kobo.67.1">None</span></span><span class="koboSpan" id="kobo.68.1">):
        subjects = Subject.objects.annotate(
            total_courses=Count(</span><span class="hljs-string"><span class="koboSpan" id="kobo.69.1">'courses'</span></span><span class="koboSpan" id="kobo.70.1">)
        )
        courses = Course.objects.annotate(
            total_modules=Count(</span><span class="hljs-string"><span class="koboSpan" id="kobo.71.1">'modules'</span></span><span class="koboSpan" id="kobo.72.1">)
        )
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.73.1">if</span></span><span class="koboSpan" id="kobo.74.1"> subject:
            subject = get_object_or_404(Subject, slug=subject)
            courses = courses.</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.75.1">filter</span></span><span class="koboSpan" id="kobo.76.1">(subject=subject)
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.77.1">return</span></span><span class="koboSpan" id="kobo.78.1"> self.render_to_response(
            {
                </span><span class="hljs-string"><span class="koboSpan" id="kobo.79.1">'subjects'</span></span><span class="koboSpan" id="kobo.80.1">: subjects,
                </span><span class="hljs-string"><span class="koboSpan" id="kobo.81.1">'subject'</span></span><span class="koboSpan" id="kobo.82.1">: subject,
                </span><span class="hljs-string"><span class="koboSpan" id="kobo.83.1">'courses'</span></span><span class="koboSpan" id="kobo.84.1">: courses
            }
        )
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.85.1">This is the </span><code class="inlineCode"><span class="koboSpan" id="kobo.86.1">CourseListView</span></code><span class="koboSpan" id="kobo.87.1"> view. </span><span class="koboSpan" id="kobo.87.2">It inherits from </span><code class="inlineCode"><span class="koboSpan" id="kobo.88.1">TemplateResponseMixin</span></code><span class="koboSpan" id="kobo.89.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.90.1">View</span></code><span class="koboSpan" id="kobo.91.1">. </span><span class="koboSpan" id="kobo.91.2">In this view, the following tasks are performed:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.92.1">Retrieve all subjects using the ORM’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.93.1">annotate()</span></code><span class="koboSpan" id="kobo.94.1"> method with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.95.1">Count()</span></code><span class="koboSpan" id="kobo.96.1"> aggregation function to include the total number of courses for each subject.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.97.1">Retrieve all available courses, including the total number of modules contained in each course.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.98.1">If a subject slug URL parameter is given, retrieve the corresponding </span><code class="inlineCode"><span class="koboSpan" id="kobo.99.1">subject</span></code><span class="koboSpan" id="kobo.100.1"> object and limit the query to the courses that belong to the given subject.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.101.1">Use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.102.1">render_to_response()</span></code><span class="koboSpan" id="kobo.103.1"> method provided by </span><code class="inlineCode"><span class="koboSpan" id="kobo.104.1">TemplateResponseMixin</span></code><span class="koboSpan" id="kobo.105.1"> to render the objects to a template and return an HTTP response.</span></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.106.1">Let’s create a</span><a id="_idIndexMarker1263"/><span class="koboSpan" id="kobo.107.1"> detail view for displaying a single course overview. </span><span class="koboSpan" id="kobo.107.2">Add the following code to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.108.1">views.py</span></code><span class="koboSpan" id="kobo.109.1"> file:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.110.1">from</span></span><span class="koboSpan" id="kobo.111.1"> django.views.generic.detail </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.112.1">import</span></span><span class="koboSpan" id="kobo.113.1"> DetailView
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.114.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.115.1">CourseDetailView</span></span><span class="koboSpan" id="kobo.116.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.117.1">DetailView</span></span><span class="koboSpan" id="kobo.118.1">):
    model = Course
    template_name = </span><span class="hljs-string"><span class="koboSpan" id="kobo.119.1">'courses/course/detail.html'</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.120.1">This view inherits from the generic </span><code class="inlineCode"><span class="koboSpan" id="kobo.121.1">DetailView</span></code><span class="koboSpan" id="kobo.122.1"> provided by Django. </span><span class="koboSpan" id="kobo.122.2">You specify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.123.1">model</span></code><span class="koboSpan" id="kobo.124.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.125.1">template_name</span></code><span class="koboSpan" id="kobo.126.1"> attributes. </span><span class="koboSpan" id="kobo.126.2">Django’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.127.1">DetailView</span></code><span class="koboSpan" id="kobo.128.1"> expects a primary key (</span><code class="inlineCode"><span class="koboSpan" id="kobo.129.1">pk</span></code><span class="koboSpan" id="kobo.130.1">) or slug URL parameter to retrieve a single object for the given model. </span><span class="koboSpan" id="kobo.130.2">The view renders the template specified in </span><code class="inlineCode"><span class="koboSpan" id="kobo.131.1">template_name</span></code><span class="koboSpan" id="kobo.132.1">, including the </span><code class="inlineCode"><span class="koboSpan" id="kobo.133.1">Course</span></code><span class="koboSpan" id="kobo.134.1"> object in the template context variable </span><code class="inlineCode"><span class="koboSpan" id="kobo.135.1">object</span></code><span class="koboSpan" id="kobo.136.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.137.1">Edit the main </span><code class="inlineCode"><span class="koboSpan" id="kobo.138.1">urls.py</span></code><span class="koboSpan" id="kobo.139.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.140.1">educa</span></code><span class="koboSpan" id="kobo.141.1"> project and add the following URL pattern to it:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.142.1">from</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.143.1"> courses.views </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.144.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.145.1"> CourseListView</span></strong></span><span class="koboSpan" id="kobo.146.1">
urlpatterns = [
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.147.1"># ...</span></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.148.1">    path(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.149.1">''</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.150.1">, CourseListView.as_view(), name=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.151.1">'course_list'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.152.1">),</span></strong></span><span class="koboSpan" id="kobo.153.1">
]
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.154.1">You add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.155.1">course_list</span></code><span class="koboSpan" id="kobo.156.1"> URL pattern to the main </span><code class="inlineCode"><span class="koboSpan" id="kobo.157.1">urls.py</span></code><span class="koboSpan" id="kobo.158.1"> file of the project because you want to display the list of courses in the URL </span><code class="inlineCode"><span class="koboSpan" id="kobo.159.1">http://127.0.0.1:8000/</span></code><span class="koboSpan" id="kobo.160.1">, and all other URLs for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.161.1">courses</span></code><span class="koboSpan" id="kobo.162.1"> application have the </span><code class="inlineCode"><span class="koboSpan" id="kobo.163.1">/course/</span></code><span class="koboSpan" id="kobo.164.1"> prefix.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.165.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.166.1">urls.py</span></code><span class="koboSpan" id="kobo.167.1"> file</span><a id="_idIndexMarker1264"/><span class="koboSpan" id="kobo.168.1"> of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.169.1">courses</span></code><span class="koboSpan" id="kobo.170.1"> application and add the following URL patterns:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.171.1">path(
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.172.1">'subject/&lt;slug:subject&gt;/'</span></span><span class="koboSpan" id="kobo.173.1">,
    views.CourseListView.as_view(),
    name=</span><span class="hljs-string"><span class="koboSpan" id="kobo.174.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.175.1">course_list_subject'</span></span><span class="koboSpan" id="kobo.176.1">
),
path(
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.177.1">'&lt;slug:slug&gt;/'</span></span><span class="koboSpan" id="kobo.178.1">,
    views.CourseDetailView.as_view(),
    name=</span><span class="hljs-string"><span class="koboSpan" id="kobo.179.1">'course_detail'</span></span><span class="koboSpan" id="kobo.180.1">
),
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.181.1">You define the following URL patterns:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.182.1">course_list_subject</span></code><span class="koboSpan" id="kobo.183.1">: For displaying all courses for a subject</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.184.1">course_detail</span></code><span class="koboSpan" id="kobo.185.1">: For displaying a single course overview</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.186.1">Let’s build templates for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.187.1">CourseListView</span></code><span class="koboSpan" id="kobo.188.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.189.1">CourseDetailView</span></code><span class="koboSpan" id="kobo.190.1"> views.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.191.1">Create the following file structure inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.192.1">templates/courses/</span></code><span class="koboSpan" id="kobo.193.1"> directory of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.194.1">courses</span></code><span class="koboSpan" id="kobo.195.1"> application:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.196.1">course/
    list.html
    detail.html
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.197.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.198.1">courses/course/list.html</span></code><span class="koboSpan" id="kobo.199.1"> template of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.200.1">courses</span></code><span class="koboSpan" id="kobo.201.1"> application and write the following</span><a id="_idIndexMarker1265"/><span class="koboSpan" id="kobo.202.1"> code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.203.1">{% extends "base.html" %}
{% block title %}
  {% if subject %}
    {{ subject.title }} courses
  {% else %}
    All courses
  {% endif %}
{% endblock %}
{% block content %}
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.204.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.205.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.206.1">&gt;</span></span><span class="koboSpan" id="kobo.207.1">
    {% if subject %}
      {{ subject.title }} courses
    {% else %}
      All courses
    {% endif %}
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.208.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.209.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.210.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.211.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.212.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.213.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.214.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.215.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.216.1">contents"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.217.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.218.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.219.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.220.1">&gt;</span></span><span class="koboSpan" id="kobo.221.1">Subjects</span><span class="hljs-tag"><span class="koboSpan" id="kobo.222.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.223.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.224.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.225.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.226.1">ul</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.227.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.228.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.229.1">"modules"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.230.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.231.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.232.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.233.1"> {% </span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.234.1">if</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.235.1">not</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.236.1">subject</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.237.1"> %}</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.238.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.239.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.240.1">"selected"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.241.1">{% </span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.242.1">endif</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.243.1"> %}&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.244.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.245.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.246.1">href</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.247.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.248.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.249.1">{% url "</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.250.1">course_list</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.251.1">" %}"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.252.1">&gt;</span></span><span class="koboSpan" id="kobo.253.1">All</span><span class="hljs-tag"><span class="koboSpan" id="kobo.254.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.255.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.256.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.257.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.258.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.259.1">&gt;</span></span><span class="koboSpan" id="kobo.260.1">
      {% for s in subjects %}
        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.261.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.262.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.263.1"> {% </span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.264.1">if</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.265.1">subject</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.266.1"> == </span></span><span class="hljs-string"><span class="koboSpan" id="kobo.267.1">s</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.268.1"> %}</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.269.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.270.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.271.1">"selected"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.272.1">{% </span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.273.1">endif</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.274.1"> %}&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.275.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.276.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.277.1">href</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.278.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.279.1">"{% url "</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.280.1">course_list_subject</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.281.1">" s.slug %}"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.282.1">&gt;</span></span><span class="koboSpan" id="kobo.283.1">
            {{ s.title }}
            </span><span class="hljs-tag"><span class="koboSpan" id="kobo.284.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.285.1">br</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.286.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.287.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.288.1">span</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.289.1">&gt;</span></span><span class="koboSpan" id="kobo.290.1">
              {{ s.total_courses }} course{{ s.total_courses|pluralize }}
            </span><span class="hljs-tag"><span class="koboSpan" id="kobo.291.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.292.1">span</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.293.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.294.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.295.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.296.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.297.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.298.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.299.1">&gt;</span></span><span class="koboSpan" id="kobo.300.1">
      {% endfor %}
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.301.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.302.1">ul</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.303.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.304.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.305.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.306.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.307.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.308.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.309.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.310.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.311.1">"module"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.312.1">&gt;</span></span><span class="koboSpan" id="kobo.313.1">
    {% for course in courses %}
      {% with subject=course.subject %}
        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.314.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.315.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.316.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.317.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.318.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.319.1">href</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.320.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.321.1">"{% url "</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.322.1">course_detail</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.323.1">" course.slug %}"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.324.1">&gt;</span></span><span class="koboSpan" id="kobo.325.1">
            {{ course.title }}
          </span><span class="hljs-tag"><span class="koboSpan" id="kobo.326.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.327.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.328.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.329.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.330.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.331.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.332.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.333.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.334.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.335.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.336.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.337.1">href</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.338.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.339.1">"{% url "</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.340.1">course_list_subject</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.341.1">" subject.slug %}"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.342.1">&gt;</span></span><span class="koboSpan" id="kobo.343.1">{{ subject }}</span><span class="hljs-tag"><span class="koboSpan" id="kobo.344.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.345.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.346.1">&gt;</span></span><span class="koboSpan" id="kobo.347.1">.
            </span><span class="koboSpan" id="kobo.347.2">{{ course.total_modules }} modules.
            </span><span class="koboSpan" id="kobo.347.3">Instructor: {{ course.owner.get_full_name }}
        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.348.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.349.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.350.1">&gt;</span></span><span class="koboSpan" id="kobo.351.1">
      {% endwith %}
    {% endfor %}
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.352.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.353.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.354.1">&gt;</span></span><span class="koboSpan" id="kobo.355.1">
{% endblock %}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.356.1">Make sure that no</span><a id="_idIndexMarker1266"/><span class="koboSpan" id="kobo.357.1"> template tag is split into multiple lines.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.358.1">This is the template for listing the available courses. </span><span class="koboSpan" id="kobo.358.2">You create an HTML list to display all </span><code class="inlineCode"><span class="koboSpan" id="kobo.359.1">Subject</span></code><span class="koboSpan" id="kobo.360.1"> objects and build a link to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.361.1">course_list_subject</span></code><span class="koboSpan" id="kobo.362.1"> URL for each of them. </span><span class="koboSpan" id="kobo.362.2">You also include the total number of courses for each subject and use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.363.1">pluralize</span></code><span class="koboSpan" id="kobo.364.1"> template filter to add a plural suffix to the word </span><strong class="screenText"><span class="koboSpan" id="kobo.365.1">course</span></strong><span class="koboSpan" id="kobo.366.1"> when the number is different than </span><code class="inlineCode"><span class="koboSpan" id="kobo.367.1">1</span></code><span class="koboSpan" id="kobo.368.1">, to show </span><em class="italic"><span class="koboSpan" id="kobo.369.1">0 courses</span></em><span class="koboSpan" id="kobo.370.1">, </span><em class="italic"><span class="koboSpan" id="kobo.371.1">1 course</span></em><span class="koboSpan" id="kobo.372.1">, </span><em class="italic"><span class="koboSpan" id="kobo.373.1">2 courses</span></em><span class="koboSpan" id="kobo.374.1">, etc. </span><span class="koboSpan" id="kobo.374.2">You add a </span><code class="inlineCode"><span class="koboSpan" id="kobo.375.1">selected</span></code><span class="koboSpan" id="kobo.376.1"> HTML class to highlight the current subject if a subject is selected. </span><span class="koboSpan" id="kobo.376.2">You iterate over every </span><code class="inlineCode"><span class="koboSpan" id="kobo.377.1">Course</span></code><span class="koboSpan" id="kobo.378.1"> object, displaying the total number of modules and the instructor’s name.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.379.1">Run the development server and open </span><code class="inlineCode"><span class="koboSpan" id="kobo.380.1">http://127.0.0.1:8000/</span></code><span class="koboSpan" id="kobo.381.1"> in your browser. </span><span class="koboSpan" id="kobo.381.2">You should see a page similar to the following one:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.382.1"><img alt="Graphical user interface, text, application  Description automatically generated" src="../Images/B21088_14_02.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.383.1">Figure 14.2: The course list page</span></p>
<p class="normal"><span class="koboSpan" id="kobo.384.1">The left sidebar</span><a id="_idIndexMarker1267"/><span class="koboSpan" id="kobo.385.1"> contains all subjects, including the total number of courses for each of them. </span><span class="koboSpan" id="kobo.385.2">You can click any subject to filter the courses displayed.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.386.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.387.1">courses/course/detail.html</span></code><span class="koboSpan" id="kobo.388.1"> template and add the following code to it:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.389.1">{% extends "base.html" %}
{% block title %}
  {{ object.title }}
{% endblock %}
{% block content %}
  {% with subject=object.subject %}
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.390.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.391.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.392.1">&gt;</span></span><span class="koboSpan" id="kobo.393.1">
      {{ object.title }}
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.394.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.395.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.396.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.397.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.398.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.399.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.400.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.401.1">"module"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.402.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.403.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.404.1">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.405.1">&gt;</span></span><span class="koboSpan" id="kobo.406.1">Overview</span><span class="hljs-tag"><span class="koboSpan" id="kobo.407.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.408.1">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.409.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.410.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.411.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.412.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.413.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.414.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.415.1">href</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.416.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.417.1">"{% url "</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.418.1">course_list_subject</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.419.1">" subject.slug %}"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.420.1">&gt;</span></span><span class="koboSpan" id="kobo.421.1">
        {{ subject.title }}</span><span class="hljs-tag"><span class="koboSpan" id="kobo.422.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.423.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.424.1">&gt;</span></span><span class="koboSpan" id="kobo.425.1">.
        </span><span class="koboSpan" id="kobo.425.2">{{ object.modules.count }} modules.
        </span><span class="koboSpan" id="kobo.425.3">Instructor: {{ object.owner.get_full_name }}
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.426.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.427.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.428.1">&gt;</span></span><span class="koboSpan" id="kobo.429.1">
      {{ object.overview|linebreaks }}
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.430.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.431.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.432.1">&gt;</span></span><span class="koboSpan" id="kobo.433.1">
  {% endwith %}
{% endblock %}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.434.1">This template displays the overview and details for a single course. </span><span class="koboSpan" id="kobo.434.2">Open </span><code class="inlineCode"><span class="koboSpan" id="kobo.435.1">http://127.0.0.1:8000/</span></code><span class="koboSpan" id="kobo.436.1"> in your browser and click on one of the courses. </span><span class="koboSpan" id="kobo.436.2">You should see a page with</span><a id="_idIndexMarker1268"/><span class="koboSpan" id="kobo.437.1"> the following structure:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.438.1"><img alt="A picture containing text  Description automatically generated" src="../Images/B21088_14_03.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.439.1">Figure 14.3: The course overview page</span></p>
<p class="normal"><span class="koboSpan" id="kobo.440.1">You have created </span><a id="_idIndexMarker1269"/><span class="koboSpan" id="kobo.441.1">a public area for displaying courses. </span><span class="koboSpan" id="kobo.441.2">Next, you need to allow users to register as students and enroll in courses.</span></p>
<h1 class="heading-1" id="_idParaDest-371"><span class="koboSpan" id="kobo.442.1">Adding student registration</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.443.1">We need to implement </span><a id="_idIndexMarker1270"/><span class="koboSpan" id="kobo.444.1">student registration to enable enrollment in courses and access to content. </span><span class="koboSpan" id="kobo.444.2">Create a new application using the following command:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.445.1">python manage.py startapp students
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.446.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.447.1">settings.py</span></code><span class="koboSpan" id="kobo.448.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.449.1">educa</span></code><span class="koboSpan" id="kobo.450.1"> project and add the new application to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.451.1">INSTALLED_APPS</span></code><span class="koboSpan" id="kobo.452.1"> setting, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.453.1">INSTALLED_APPS = [
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.454.1"># ...</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.455.1">'students.apps.StudentsConfig'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.456.1">,</span></strong></span><span class="koboSpan" id="kobo.457.1">
]
</span></code></pre>
<h2 class="heading-2" id="_idParaDest-372"><span class="koboSpan" id="kobo.458.1">Creating a student registration view</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.459.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.460.1">views.py</span></code><span class="koboSpan" id="kobo.461.1"> file </span><a id="_idIndexMarker1271"/><span class="koboSpan" id="kobo.462.1">of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.463.1">students</span></code><span class="koboSpan" id="kobo.464.1"> application and write the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.465.1">from</span></span><span class="koboSpan" id="kobo.466.1"> django.contrib.auth </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.467.1">import</span></span><span class="koboSpan" id="kobo.468.1"> authenticate, login
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.469.1">from</span></span><span class="koboSpan" id="kobo.470.1"> django.contrib.auth.forms </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.471.1">import</span></span><span class="koboSpan" id="kobo.472.1"> UserCreationForm
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.473.1">from</span></span><span class="koboSpan" id="kobo.474.1"> django.urls </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.475.1">import</span></span><span class="koboSpan" id="kobo.476.1"> reverse_lazy
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.477.1">from</span></span><span class="koboSpan" id="kobo.478.1"> django.views.generic.edit </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.479.1">import</span></span><span class="koboSpan" id="kobo.480.1"> CreateView
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.481.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.482.1">StudentRegistrationView</span></span><span class="koboSpan" id="kobo.483.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.484.1">CreateView</span></span><span class="koboSpan" id="kobo.485.1">):
    template_name = </span><span class="hljs-string"><span class="koboSpan" id="kobo.486.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.487.1">students/student/registration.html'</span></span><span class="koboSpan" id="kobo.488.1">
    form_class = UserCreationForm
    success_url = reverse_lazy(</span><span class="hljs-string"><span class="koboSpan" id="kobo.489.1">'student_course_list'</span></span><span class="koboSpan" id="kobo.490.1">)
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.491.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.492.1">form_valid</span></span><span class="koboSpan" id="kobo.493.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.494.1">self, form</span></span><span class="koboSpan" id="kobo.495.1">):
        result = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.496.1">super</span></span><span class="koboSpan" id="kobo.497.1">().form_valid(form)
        cd = form.cleaned_data
        user = authenticate(
            username=cd[</span><span class="hljs-string"><span class="koboSpan" id="kobo.498.1">'username'</span></span><span class="koboSpan" id="kobo.499.1">], password=cd[</span><span class="hljs-string"><span class="koboSpan" id="kobo.500.1">'password1'</span></span><span class="koboSpan" id="kobo.501.1">]
        )
        login(self.request, user)
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.502.1">return</span></span><span class="koboSpan" id="kobo.503.1"> result
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.504.1">This is the view that allows students to register on your site. </span><span class="koboSpan" id="kobo.504.2">You use the generic </span><code class="inlineCode"><span class="koboSpan" id="kobo.505.1">CreateView</span></code><span class="koboSpan" id="kobo.506.1">, which provides the functionality for creating model objects. </span><span class="koboSpan" id="kobo.506.2">This view requires the following attributes:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.507.1">template_name</span></code><span class="koboSpan" id="kobo.508.1">: The path of the template to render this view.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.509.1">form_class</span></code><span class="koboSpan" id="kobo.510.1">: The form for creating objects, which has to be </span><code class="inlineCode"><span class="koboSpan" id="kobo.511.1">ModelForm</span></code><span class="koboSpan" id="kobo.512.1">. </span><span class="koboSpan" id="kobo.512.2">You use Django’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.513.1">UserCreationForm</span></code><span class="koboSpan" id="kobo.514.1"> as the registration form to create </span><code class="inlineCode"><span class="koboSpan" id="kobo.515.1">User</span></code><span class="koboSpan" id="kobo.516.1"> objects.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.517.1">success_url</span></code><span class="koboSpan" id="kobo.518.1">: The URL to redirect the user to when the form is successfully submitted. </span><span class="koboSpan" id="kobo.518.2">For this, you reverse the URL named </span><code class="inlineCode"><span class="koboSpan" id="kobo.519.1">student_course_list</span></code><span class="koboSpan" id="kobo.520.1">, which we will create in the </span><em class="italic"><span class="koboSpan" id="kobo.521.1">Accessing the course contents</span></em><span class="koboSpan" id="kobo.522.1"> section for listing the courses that students are enrolled in.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.523.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.524.1">form_valid()</span></code><span class="koboSpan" id="kobo.525.1"> method is executed when valid form data has been posted. </span><span class="koboSpan" id="kobo.525.2">It has to return an HTTP response. </span><span class="koboSpan" id="kobo.525.3">You override this method to log the user in after they have successfully signed up.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.526.1">Create a new file</span><a id="_idIndexMarker1272"/><span class="koboSpan" id="kobo.527.1"> inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.528.1">students</span></code><span class="koboSpan" id="kobo.529.1"> application directory and name it </span><code class="inlineCode"><span class="koboSpan" id="kobo.530.1">urls.py</span></code><span class="koboSpan" id="kobo.531.1">. </span><span class="koboSpan" id="kobo.531.2">Add the following code to it:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.532.1">from</span></span><span class="koboSpan" id="kobo.533.1"> django.urls </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.534.1">import</span></span><span class="koboSpan" id="kobo.535.1"> path
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.536.1">from</span></span><span class="koboSpan" id="kobo.537.1"> . </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.538.1">import</span></span><span class="koboSpan" id="kobo.539.1"> views
urlpatterns = [
    path(
        </span><span class="hljs-string"><span class="koboSpan" id="kobo.540.1">'register/'</span></span><span class="koboSpan" id="kobo.541.1">,
        views.StudentRegistrationView.as_view(),
        name=</span><span class="hljs-string"><span class="koboSpan" id="kobo.542.1">'student_registration'</span></span><span class="koboSpan" id="kobo.543.1">
    ),
]
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.544.1">Then, edit the main </span><code class="inlineCode"><span class="koboSpan" id="kobo.545.1">urls.py</span></code><span class="koboSpan" id="kobo.546.1"> of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.547.1">educa</span></code><span class="koboSpan" id="kobo.548.1"> project and include the URLs for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.549.1">students</span></code><span class="koboSpan" id="kobo.550.1"> application by adding the following pattern to your URL configuration:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.551.1">urlpatterns = [
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.552.1"># ...</span></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.553.1">    path(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.554.1">'students/'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.555.1">, include(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.556.1">'students.urls'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.557.1">)),</span></strong></span><span class="koboSpan" id="kobo.558.1">
]
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.559.1">Create the following file structure inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.560.1">students</span></code><span class="koboSpan" id="kobo.561.1"> application directory:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.562.1">templates/
    students/
        student/
            registration.html
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.563.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.564.1">students/student/registration.html</span></code><span class="koboSpan" id="kobo.565.1"> template and add the following code to it:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.566.1">{% extends "base.html" %}
{% block title %}
  Sign up
{% endblock %}
{% block content %}
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.567.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.568.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.569.1">&gt;</span></span><span class="koboSpan" id="kobo.570.1">
    Sign up
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.571.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.572.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.573.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.574.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.575.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.576.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.577.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.578.1">"module"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.579.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.580.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.581.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.582.1">&gt;</span></span><span class="koboSpan" id="kobo.583.1">Enter your details to create an account:</span><span class="hljs-tag"><span class="koboSpan" id="kobo.584.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.585.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.586.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.587.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.588.1">form</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.589.1">method</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.590.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.591.1">"post"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.592.1">&gt;</span></span><span class="koboSpan" id="kobo.593.1">
      {{ form.as_p }}
      {% csrf_token %}
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.594.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.595.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.596.1">&gt;&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.597.1">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.598.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.599.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.600.1">"submit"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.601.1">value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.602.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.603.1">"Create my account"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.604.1">&gt;&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.605.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.606.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.607.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.608.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.609.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.610.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.611.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.612.1">&gt;</span></span><span class="koboSpan" id="kobo.613.1">
{% endblock %}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.614.1">Run the</span><a id="_idIndexMarker1273"/><span class="koboSpan" id="kobo.615.1"> development server and open </span><code class="inlineCode"><span class="koboSpan" id="kobo.616.1">http://127.0.0.1:8000/students/register/</span></code><span class="koboSpan" id="kobo.617.1"> in your browser. </span><span class="koboSpan" id="kobo.617.2">You should see a registration form like this:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.618.1"><img alt="Graphical user interface, text, application, email  Description automatically generated" src="../Images/B21088_14_04.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.619.1">Figure 14.4: The student registration form</span></p>
<p class="normal"><span class="koboSpan" id="kobo.620.1">Note that</span><a id="_idIndexMarker1274"/><span class="koboSpan" id="kobo.621.1"> the </span><code class="inlineCode"><span class="koboSpan" id="kobo.622.1">student_course_list</span></code><span class="koboSpan" id="kobo.623.1"> URL specified in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.624.1">success_url</span></code><span class="koboSpan" id="kobo.625.1"> attribute of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.626.1">StudentRegistrationView</span></code><span class="koboSpan" id="kobo.627.1"> view doesn’t exist yet. </span><span class="koboSpan" id="kobo.627.2">If you submit the form, Django won’t find the URL to redirect you to after a successful registration. </span><span class="koboSpan" id="kobo.627.3">As </span><a id="_idIndexMarker1275"/><span class="koboSpan" id="kobo.628.1">mentioned, you will create this URL in the </span><em class="italic"><span class="koboSpan" id="kobo.629.1">Accessing the course contents</span></em><span class="koboSpan" id="kobo.630.1"> section.</span></p>
<h2 class="heading-2" id="_idParaDest-373"><span class="koboSpan" id="kobo.631.1">Enrolling in courses</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.632.1">After users</span><a id="_idIndexMarker1276"/><span class="koboSpan" id="kobo.633.1"> create an account, they should be able to enroll in courses. </span><span class="koboSpan" id="kobo.633.2">To store enrollments, you need to create a many-to-many relationship between the </span><code class="inlineCode"><span class="koboSpan" id="kobo.634.1">Course</span></code><span class="koboSpan" id="kobo.635.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.636.1">User</span></code><span class="koboSpan" id="kobo.637.1"> models.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.638.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.639.1">models.py</span></code><span class="koboSpan" id="kobo.640.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.641.1">courses</span></code><span class="koboSpan" id="kobo.642.1"> application and add the following field to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.643.1">Course</span></code><span class="koboSpan" id="kobo.644.1"> model:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.645.1">students = models.ManyToManyField(
    User,
    related_name=</span><span class="hljs-string"><span class="koboSpan" id="kobo.646.1">'courses_joined'</span></span><span class="koboSpan" id="kobo.647.1">,
    blank=</span><span class="hljs-literal"><span class="koboSpan" id="kobo.648.1">True</span></span><span class="koboSpan" id="kobo.649.1">
)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.650.1">From the shell, execute the following command to create a migration for this change:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.651.1">python manage.py makemigrations
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.652.1">You will see output similar to this:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.653.1">Migrations for 'courses':
  courses/migrations/0004_course_students.py
    - Add field students to course
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.654.1">Then, execute the next command to apply pending migrations:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.655.1">python manage.py migrate
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.656.1">You should see some output that ends with the following line:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.657.1">Applying courses.0004_course_students... </span><span class="koboSpan" id="kobo.657.2">OK
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.658.1">You can now associate students with the courses in which they are enrolled. </span><span class="koboSpan" id="kobo.658.2">Let’s create the functionality for students to enroll in courses.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.659.1">Create a new file inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.660.1">students</span></code><span class="koboSpan" id="kobo.661.1"> application directory and name it </span><code class="inlineCode"><span class="koboSpan" id="kobo.662.1">forms.py</span></code><span class="koboSpan" id="kobo.663.1">. </span><span class="koboSpan" id="kobo.663.2">Add the following code to it:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.664.1">from</span></span><span class="koboSpan" id="kobo.665.1"> django </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.666.1">import</span></span><span class="koboSpan" id="kobo.667.1"> forms
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.668.1">from</span></span><span class="koboSpan" id="kobo.669.1"> courses.models </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.670.1">import</span></span><span class="koboSpan" id="kobo.671.1"> Course
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.672.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.673.1">CourseEnrollForm</span></span><span class="koboSpan" id="kobo.674.1">(forms.Form):
    course = forms.ModelChoiceField(
        queryset=Course.objects.none(),
        widget=forms.HiddenInput
    )
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.675.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.676.1">__init__</span></span><span class="koboSpan" id="kobo.677.1"> (self, form):
        </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.678.1">super</span></span><span class="koboSpan" id="kobo.679.1">(CourseEnrollForm, self).__init__(*args, **kwargs)
        self.fields[</span><span class="hljs-string"><span class="koboSpan" id="kobo.680.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.681.1">course'</span></span><span class="koboSpan" id="kobo.682.1">].queryset = Course.objects.</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.683.1">all</span></span><span class="koboSpan" id="kobo.684.1">()
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.685.1">This form will be used to enroll students in courses. </span><span class="koboSpan" id="kobo.685.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.686.1">course</span></code><span class="koboSpan" id="kobo.687.1"> field is for the course in which the user will be enrolled; therefore, it’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.688.1">ModelChoiceField</span></code><span class="koboSpan" id="kobo.689.1">. </span><span class="koboSpan" id="kobo.689.2">You use a </span><code class="inlineCode"><span class="koboSpan" id="kobo.690.1">HiddenInput</span></code><span class="koboSpan" id="kobo.691.1"> widget because this field is not intended to be visible to the user. </span><span class="koboSpan" id="kobo.691.2">Initially, you define the QuerySet as </span><code class="inlineCode"><span class="koboSpan" id="kobo.692.1">Course.objects.none()</span></code><span class="koboSpan" id="kobo.693.1">. </span><span class="koboSpan" id="kobo.693.2">Using </span><code class="inlineCode"><span class="koboSpan" id="kobo.694.1">none()</span></code><span class="koboSpan" id="kobo.695.1"> creates an empty QuerySet that does not return any objects and, importantly, does not query the database. </span><span class="koboSpan" id="kobo.695.2">This avoids unnecessary database load during form initialization. </span><span class="koboSpan" id="kobo.695.3">You populate the actual QuerySet in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.696.1">__init__()</span></code><span class="koboSpan" id="kobo.697.1"> method of the form. </span><span class="koboSpan" id="kobo.697.2">This dynamic setting allows you to adapt the form to different situations, such as filtering available courses based on </span><a id="_idIndexMarker1277"/><span class="koboSpan" id="kobo.698.1">specific criteria. </span><span class="koboSpan" id="kobo.698.2">Overall, this approach gives you greater flexibility in managing form data, ensuring that data is fetched based on the context in which the form is used. </span><span class="koboSpan" id="kobo.698.3">This method also aligns with best practices in Django for handling form QuerySets efficiently.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.699.1">You are going to use this form in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.700.1">CourseDetailView</span></code><span class="koboSpan" id="kobo.701.1"> view to display a button to enroll. </span><span class="koboSpan" id="kobo.701.2">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.702.1">views.py</span></code><span class="koboSpan" id="kobo.703.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.704.1">students</span></code><span class="koboSpan" id="kobo.705.1"> application and add the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.706.1">from</span></span><span class="koboSpan" id="kobo.707.1"> django.contrib.auth.mixins </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.708.1">import</span></span><span class="koboSpan" id="kobo.709.1"> LoginRequiredMixin
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.710.1">from</span></span><span class="koboSpan" id="kobo.711.1"> django.views.generic.edit </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.712.1">import</span></span><span class="koboSpan" id="kobo.713.1"> FormView
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.714.1">from</span></span><span class="koboSpan" id="kobo.715.1"> .forms </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.716.1">import</span></span><span class="koboSpan" id="kobo.717.1"> CourseEnrollForm
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.718.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.719.1">StudentEnrollCourseView</span></span><span class="koboSpan" id="kobo.720.1">(LoginRequiredMixin, FormView):
    course = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.721.1">None</span></span><span class="koboSpan" id="kobo.722.1">
    form_class = CourseEnrollForm
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.723.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.724.1">form_valid</span></span><span class="koboSpan" id="kobo.725.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.726.1">self, form</span></span><span class="koboSpan" id="kobo.727.1">):
        self.course = form.cleaned_data[</span><span class="hljs-string"><span class="koboSpan" id="kobo.728.1">'course'</span></span><span class="koboSpan" id="kobo.729.1">]
        self.course.students.add(self.request.user)
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.730.1">return</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.731.1">super</span></span><span class="koboSpan" id="kobo.732.1">().form_valid(form)
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.733.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.734.1">get_success_url</span></span><span class="koboSpan" id="kobo.735.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.736.1">self</span></span><span class="koboSpan" id="kobo.737.1">):
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.738.1">return</span></span><span class="koboSpan" id="kobo.739.1"> reverse_lazy(
            </span><span class="hljs-string"><span class="koboSpan" id="kobo.740.1">'student_course_detail'</span></span><span class="koboSpan" id="kobo.741.1">, args=[self.course.</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.742.1">id</span></span><span class="koboSpan" id="kobo.743.1">]
        )
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.744.1">This is the </span><code class="inlineCode"><span class="koboSpan" id="kobo.745.1">StudentEnrollCourseView</span></code><span class="koboSpan" id="kobo.746.1"> view. </span><span class="koboSpan" id="kobo.746.2">It handles the enrollment of students in courses. </span><span class="koboSpan" id="kobo.746.3">The view inherits from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.747.1">LoginRequiredMixin</span></code><span class="koboSpan" id="kobo.748.1"> mixin so that only logged-in users can access the view. </span><span class="koboSpan" id="kobo.748.2">It also inherits from Django’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.749.1">FormView</span></code><span class="koboSpan" id="kobo.750.1"> view, since it handles a form submission. </span><span class="koboSpan" id="kobo.750.2">You use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.751.1">CourseEnrollForm</span></code><span class="koboSpan" id="kobo.752.1"> form for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.753.1">form_class</span></code><span class="koboSpan" id="kobo.754.1"> attribute and also define a </span><code class="inlineCode"><span class="koboSpan" id="kobo.755.1">course</span></code><span class="koboSpan" id="kobo.756.1"> attribute for storing the given </span><code class="inlineCode"><span class="koboSpan" id="kobo.757.1">Course</span></code><span class="koboSpan" id="kobo.758.1"> object. </span><span class="koboSpan" id="kobo.758.2">When the form is valid, the current user is added to the students enrolled in the course.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.759.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.760.1">get_success_url()</span></code><span class="koboSpan" id="kobo.761.1"> method returns the URL that the user will be redirected to if the form was successfully submitted. </span><span class="koboSpan" id="kobo.761.2">This method is equivalent to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.762.1">success_url</span></code><span class="koboSpan" id="kobo.763.1"> attribute. </span><span class="koboSpan" id="kobo.763.2">Then, you reverse the URL named </span><code class="inlineCode"><span class="koboSpan" id="kobo.764.1">student_course_detail</span></code><span class="koboSpan" id="kobo.765.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.766.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.767.1">urls.py</span></code><span class="koboSpan" id="kobo.768.1"> file </span><a id="_idIndexMarker1278"/><span class="koboSpan" id="kobo.769.1">of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.770.1">students</span></code><span class="koboSpan" id="kobo.771.1"> application and add the following URL pattern to it:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.772.1">path(
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.773.1">'enroll-course/'</span></span><span class="koboSpan" id="kobo.774.1">,
    views.StudentEnrollCourseView.as_view(),
    name=</span><span class="hljs-string"><span class="koboSpan" id="kobo.775.1">'student_enroll_course'</span></span><span class="koboSpan" id="kobo.776.1">
),
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.777.1">Let’s add the enroll button form to the course overview page. </span><span class="koboSpan" id="kobo.777.2">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.778.1">views.py</span></code><span class="koboSpan" id="kobo.779.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.780.1">courses</span></code><span class="koboSpan" id="kobo.781.1"> application and modify </span><code class="inlineCode"><span class="koboSpan" id="kobo.782.1">CourseDetailView</span></code><span class="koboSpan" id="kobo.783.1"> to make it look as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.784.1">from</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.785.1"> students.forms </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.786.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.787.1"> CourseEnrollForm</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.788.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.789.1">CourseDetailView</span></span><span class="koboSpan" id="kobo.790.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.791.1">DetailView</span></span><span class="koboSpan" id="kobo.792.1">):
    model = Course
    template_name = </span><span class="hljs-string"><span class="koboSpan" id="kobo.793.1">'courses/course/detail.html'</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.794.1">def</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.795.1">get_context_data</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.796.1">(</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.797.1">self, **kwargs</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.798.1">):</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.799.1">        context = </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.800.1">super</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.801.1">().get_context_data(**kwargs)</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.802.1">        context[</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.803.1">'enroll_form'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.804.1">] = CourseEnrollForm(</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.805.1">            initial={</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.806.1">'course'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.807.1">:self.</span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.808.1">object</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.809.1">}</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.810.1">        )</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.811.1">return</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.812.1"> context</span></strong></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.813.1">You use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.814.1">get_context_data()</span></code><span class="koboSpan" id="kobo.815.1"> method to include the enrollment form in the context for rendering the templates. </span><span class="koboSpan" id="kobo.815.2">You initialize the hidden </span><code class="inlineCode"><span class="koboSpan" id="kobo.816.1">course</span></code><span class="koboSpan" id="kobo.817.1"> field of the form with the current </span><code class="inlineCode"><span class="koboSpan" id="kobo.818.1">Course</span></code><span class="koboSpan" id="kobo.819.1"> object so that it can be submitted directly.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.820.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.821.1">courses/course/detail.html</span></code><span class="koboSpan" id="kobo.822.1"> template and locate the following line:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.823.1">{{ </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.824.1">object</span></span><span class="koboSpan" id="kobo.825.1">.overview|linebreaks }}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.826.1">Replace it with the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.827.1">{{ </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.828.1">object</span></span><span class="koboSpan" id="kobo.829.1">.overview|linebreaks }}
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.830.1">{% </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.831.1">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.832.1"> request.user.is_authenticated %}</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.833.1">  &lt;form action=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.834.1">"{% url "</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.835.1">student_enroll_course</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.836.1">" %}"</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.837.1"> method=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.838.1">"post"</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.839.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.840.1">    {{ enroll_form }}</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.841.1">    {% csrf_token %}</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.842.1">    &lt;</span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.843.1">input</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.844.1">type</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.845.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.846.1">"submit"</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.847.1"> value=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.848.1">"Enroll now"</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.849.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.850.1">  &lt;/form&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.851.1">{% </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.852.1">else</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.853.1"> %}</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.854.1">  &lt;a href=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.855.1">"{% url "</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.856.1">student_registration</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.857.1">" %}"</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.858.1">class</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.859.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.860.1">"button"</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.861.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.862.1">    Register to enroll</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.863.1">  &lt;/a&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.864.1">{% endif %}</span></strong></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.865.1">This is the button </span><a id="_idIndexMarker1279"/><span class="koboSpan" id="kobo.866.1">for enrolling in courses. </span><span class="koboSpan" id="kobo.866.2">If the user is authenticated, the enrollment button is displayed, including the hidden form that points to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.867.1">student_enroll_course</span></code><span class="koboSpan" id="kobo.868.1"> URL. </span><span class="koboSpan" id="kobo.868.2">If the user is not authenticated, a link to register on the platform will be displayed instead.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.869.1">Make sure that the development server is running, open </span><code class="inlineCode"><span class="koboSpan" id="kobo.870.1">http://127.0.0.1:8000/</span></code><span class="koboSpan" id="kobo.871.1"> in your browser, and click a course. </span><span class="koboSpan" id="kobo.871.2">If you are logged in, you should see an </span><strong class="screenText"><span class="koboSpan" id="kobo.872.1">ENROLL NOW</span></strong><span class="koboSpan" id="kobo.873.1"> button placed below the course overview, as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.874.1"><img alt="Graphical user interface, text, application, email  Description automatically generated" src="../Images/B21088_14_05.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.875.1">Figure 14.5: The course overview page, including an ENROLL NOW button</span></p>
<p class="normal"><span class="koboSpan" id="kobo.876.1">If you are </span><a id="_idIndexMarker1280"/><span class="koboSpan" id="kobo.877.1">not logged in, you will see a </span><strong class="screenText"><span class="koboSpan" id="kobo.878.1">REGISTER TO ENROLL</span></strong><span class="koboSpan" id="kobo.879.1"> button instead.</span></p>
<h1 class="heading-1" id="_idParaDest-374"><span class="koboSpan" id="kobo.880.1">Rendering course contents</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.881.1">Once students are </span><a id="_idIndexMarker1281"/><span class="koboSpan" id="kobo.882.1">enrolled in courses, they need a central location to access all courses they are signed up for. </span><span class="koboSpan" id="kobo.882.2">We need to compile the list of courses the student is enrolled in and provide access to the contents of each course. </span><span class="koboSpan" id="kobo.882.3">Then, we need to implement a system to render various types of content, such as text, images, videos and documents, which make up the course modules. </span><span class="koboSpan" id="kobo.882.4">Let’s build the necessary views and templates for users to access course contents.</span></p>
<h2 class="heading-2" id="_idParaDest-375"><span class="koboSpan" id="kobo.883.1">Accessing course contents</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.884.1">You need a view </span><a id="_idIndexMarker1282"/><span class="koboSpan" id="kobo.885.1">for displaying the courses that students are enrolled in and a view for accessing the actual course contents. </span><span class="koboSpan" id="kobo.885.2">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.886.1">views.py</span></code><span class="koboSpan" id="kobo.887.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.888.1">students</span></code><span class="koboSpan" id="kobo.889.1"> application and add the following code to it:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.890.1">from</span></span><span class="koboSpan" id="kobo.891.1"> django.views.generic.</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.892.1">list</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.893.1">import</span></span><span class="koboSpan" id="kobo.894.1"> ListView
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.895.1">from</span></span><span class="koboSpan" id="kobo.896.1"> courses.models </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.897.1">import</span></span><span class="koboSpan" id="kobo.898.1"> Course
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.899.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.900.1">StudentCourseListView</span></span><span class="koboSpan" id="kobo.901.1">(LoginRequiredMixin, ListView):
    model = Course
    template_name = </span><span class="hljs-string"><span class="koboSpan" id="kobo.902.1">'students/course/list.html'</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.903.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.904.1">get_queryset</span></span><span class="koboSpan" id="kobo.905.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.906.1">self</span></span><span class="koboSpan" id="kobo.907.1">):
        qs = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.908.1">super</span></span><span class="koboSpan" id="kobo.909.1">().get_queryset()
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.910.1">return</span></span><span class="koboSpan" id="kobo.911.1"> qs.</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.912.1">filter</span></span><span class="koboSpan" id="kobo.913.1">(students__in=[self.request.user])
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.914.1">This is the view to see courses that students are enrolled in. </span><span class="koboSpan" id="kobo.914.2">It inherits from </span><code class="inlineCode"><span class="koboSpan" id="kobo.915.1">LoginRequiredMixin</span></code><span class="koboSpan" id="kobo.916.1"> to make sure that only logged-in users can access the view. </span><span class="koboSpan" id="kobo.916.2">It also inherits from the generic </span><code class="inlineCode"><span class="koboSpan" id="kobo.917.1">ListView</span></code><span class="koboSpan" id="kobo.918.1"> for displaying a list of </span><code class="inlineCode"><span class="koboSpan" id="kobo.919.1">Course</span></code><span class="koboSpan" id="kobo.920.1"> objects. </span><span class="koboSpan" id="kobo.920.2">You override the </span><code class="inlineCode"><span class="koboSpan" id="kobo.921.1">get_queryset()</span></code><span class="koboSpan" id="kobo.922.1"> method to retrieve only the courses that a student is enrolled in; you filter the QuerySet by the student’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.923.1">ManyToManyField</span></code><span class="koboSpan" id="kobo.924.1"> field to do so.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.925.1">Then, add the following code to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.926.1">views.py</span></code><span class="koboSpan" id="kobo.927.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.928.1">students</span></code><span class="koboSpan" id="kobo.929.1"> application:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.930.1">from</span></span><span class="koboSpan" id="kobo.931.1"> django.views.generic.detail </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.932.1">import</span></span><span class="koboSpan" id="kobo.933.1"> DetailView
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.934.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.935.1">StudentCourseDetailView</span></span><span class="koboSpan" id="kobo.936.1">(LoginRequiredMixin, DetailView):
    model = Course
    template_name = </span><span class="hljs-string"><span class="koboSpan" id="kobo.937.1">'students/course/detail.html'</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.938.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.939.1">get_queryset</span></span><span class="koboSpan" id="kobo.940.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.941.1">self</span></span><span class="koboSpan" id="kobo.942.1">):
        qs = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.943.1">super</span></span><span class="koboSpan" id="kobo.944.1">().get_queryset()
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.945.1">return</span></span><span class="koboSpan" id="kobo.946.1"> qs.</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.947.1">filter</span></span><span class="koboSpan" id="kobo.948.1">(students__in=[self.request.user])
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.949.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.950.1">get_context_data</span></span><span class="koboSpan" id="kobo.951.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.952.1">self, **kwargs</span></span><span class="koboSpan" id="kobo.953.1">):
        context = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.954.1">super</span></span><span class="koboSpan" id="kobo.955.1">().get_context_data(**kwargs)
        </span><span class="hljs-comment"><span class="koboSpan" id="kobo.956.1"># get course object</span></span><span class="koboSpan" id="kobo.957.1">
        course = self.get_object()
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.958.1">if</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.959.1">'module_id'</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.960.1">in</span></span><span class="koboSpan" id="kobo.961.1"> self.kwargs:
            </span><span class="hljs-comment"><span class="koboSpan" id="kobo.962.1"># get current module</span></span><span class="koboSpan" id="kobo.963.1">
            context[</span><span class="hljs-string"><span class="koboSpan" id="kobo.964.1">'module'</span></span><span class="koboSpan" id="kobo.965.1">] = course.modules.get(
                </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.966.1">id</span></span><span class="koboSpan" id="kobo.967.1">=self.kwargs[</span><span class="hljs-string"><span class="koboSpan" id="kobo.968.1">'module_id'</span></span><span class="koboSpan" id="kobo.969.1">]
            )
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.970.1">else</span></span><span class="koboSpan" id="kobo.971.1">:
            </span><span class="hljs-comment"><span class="koboSpan" id="kobo.972.1"># get first module</span></span><span class="koboSpan" id="kobo.973.1">
            context[</span><span class="hljs-string"><span class="koboSpan" id="kobo.974.1">'module'</span></span><span class="koboSpan" id="kobo.975.1">] = course.modules.</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.976.1">all</span></span><span class="koboSpan" id="kobo.977.1">()[</span><span class="hljs-number"><span class="koboSpan" id="kobo.978.1">0</span></span><span class="koboSpan" id="kobo.979.1">]
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.980.1">return</span></span><span class="koboSpan" id="kobo.981.1"> context
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.982.1">This is the </span><code class="inlineCode"><span class="koboSpan" id="kobo.983.1">StudentCourseDetailView</span></code><span class="koboSpan" id="kobo.984.1"> view. </span><span class="koboSpan" id="kobo.984.2">You override the </span><code class="inlineCode"><span class="koboSpan" id="kobo.985.1">get_queryset()</span></code><span class="koboSpan" id="kobo.986.1"> method to limit the base QuerySet to courses in which the student is enrolled. </span><span class="koboSpan" id="kobo.986.2">You also override the </span><code class="inlineCode"><span class="koboSpan" id="kobo.987.1">get_context_data()</span></code><span class="koboSpan" id="kobo.988.1"> method</span><a id="_idIndexMarker1283"/><span class="koboSpan" id="kobo.989.1"> to set a course module in the context if the </span><code class="inlineCode"><span class="koboSpan" id="kobo.990.1">module_id</span></code><span class="koboSpan" id="kobo.991.1"> URL parameter is given. </span><span class="koboSpan" id="kobo.991.2">Otherwise, you set the first module of the course. </span><span class="koboSpan" id="kobo.991.3">This way, enrolled students will be able to navigate through modules inside a course.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.992.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.993.1">urls.py</span></code><span class="koboSpan" id="kobo.994.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.995.1">students</span></code><span class="koboSpan" id="kobo.996.1"> application and add the following URL patterns to it:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.997.1">path(
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.998.1">'courses/'</span></span><span class="koboSpan" id="kobo.999.1">,
    views.StudentCourseListView.as_view(),
    name=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1000.1">'student_course_list'</span></span><span class="koboSpan" id="kobo.1001.1">
),
path(
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1002.1">'course/&lt;pk&gt;/'</span></span><span class="koboSpan" id="kobo.1003.1">,
    views.StudentCourseDetailView.as_view(),
    name=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1004.1">'student_course_detail'</span></span><span class="koboSpan" id="kobo.1005.1">
),
path(
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1006.1">'course/&lt;pk&gt;/&lt;module_id&gt;/'</span></span><span class="koboSpan" id="kobo.1007.1">,
    views.StudentCourseDetailView.as_view(),
    name=</span><span class="hljs-string"><span class="koboSpan" id="kobo.1008.1">'student_course_detail_module'</span></span><span class="koboSpan" id="kobo.1009.1">
),
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1010.1">Create the following file structure inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1011.1">templates/students/</span></code><span class="koboSpan" id="kobo.1012.1"> directory of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1013.1">students</span></code><span class="koboSpan" id="kobo.1014.1"> application:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1015.1">course/
    detail.html
    list.html
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1016.1">Edit </span><a id="_idIndexMarker1284"/><span class="koboSpan" id="kobo.1017.1">the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1018.1">students/course/list.html</span></code><span class="koboSpan" id="kobo.1019.1"> template and add the following code to it:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1020.1">{% extends "base.html" %}
{% block title %}My courses{% endblock %}
{% block content %}
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1021.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1022.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1023.1">&gt;</span></span><span class="koboSpan" id="kobo.1024.1">My courses</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1025.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1026.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1027.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1028.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1029.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1030.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1031.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1032.1">"module"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1033.1">&gt;</span></span><span class="koboSpan" id="kobo.1034.1">
    {% for course in object_list %}
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1035.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1036.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1037.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1038.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1039.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1040.1">course-info"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1041.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1042.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1043.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1044.1">&gt;</span></span><span class="koboSpan" id="kobo.1045.1">{{ course.title }}</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1046.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1047.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1048.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1049.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1050.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1051.1">&gt;&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1052.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1053.1">href</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1054.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1055.1">"{% url "</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1056.1">student_course_detail</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1057.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1058.1"> course.id %}"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1059.1">&gt;</span></span><span class="koboSpan" id="kobo.1060.1">
        Access contents</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1061.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1062.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1063.1">&gt;&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1064.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1065.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1066.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1067.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1068.1">&gt;</span></span><span class="koboSpan" id="kobo.1069.1">
    {% empty %}
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1070.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1071.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1072.1">&gt;</span></span><span class="koboSpan" id="kobo.1073.1">
        You are not enrolled in any courses yet.
        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1074.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1075.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1076.1">href</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1077.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1078.1">"{% url "</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1079.1">course_list</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1080.1">" %}"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1081.1">&gt;</span></span><span class="koboSpan" id="kobo.1082.1">Browse courses</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1083.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1084.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1085.1">&gt;</span></span><span class="koboSpan" id="kobo.1086.1">
        to enroll in a course.
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1087.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1088.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1089.1">&gt;</span></span><span class="koboSpan" id="kobo.1090.1">
    {% endfor %}
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1091.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1092.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1093.1">&gt;</span></span><span class="koboSpan" id="kobo.1094.1">
{% endblock %}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1095.1">This template displays the courses that the student is enrolled in. </span><span class="koboSpan" id="kobo.1095.2">Remember that when a new student successfully registers with the platform, they will be redirected to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1096.1">student_course_list</span></code><span class="koboSpan" id="kobo.1097.1"> URL. </span><span class="koboSpan" id="kobo.1097.2">Let’s also redirect students to this URL when they log in to the platform.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1098.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1099.1">settings.py</span></code><span class="koboSpan" id="kobo.1100.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1101.1">educa</span></code><span class="koboSpan" id="kobo.1102.1"> project and add the following code to it:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1103.1">from</span></span><span class="koboSpan" id="kobo.1104.1"> django.urls </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1105.1">import</span></span><span class="koboSpan" id="kobo.1106.1"> reverse_lazy
LOGIN_REDIRECT_URL = reverse_lazy(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1107.1">'student_course_list'</span></span><span class="koboSpan" id="kobo.1108.1">)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1109.1">This is the setting used by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1110.1">auth</span></code><span class="koboSpan" id="kobo.1111.1"> module to redirect the student after a successful login if no </span><code class="inlineCode"><span class="koboSpan" id="kobo.1112.1">next</span></code><span class="koboSpan" id="kobo.1113.1"> parameter is present in the request. </span><span class="koboSpan" id="kobo.1113.2">After a successful login, a student will be redirected to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1114.1">student_course_list</span></code><span class="koboSpan" id="kobo.1115.1"> URL to view the courses that they are enrolled in.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1116.1">Edit</span><a id="_idIndexMarker1285"/><span class="koboSpan" id="kobo.1117.1"> the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1118.1">students/course/detail.html</span></code><span class="koboSpan" id="kobo.1119.1"> template and add the following code to it:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1120.1">{% extends "base.html" %}
{% block title %}
  {{ object.title }}
{% endblock %}
{% block content %}
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1121.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1122.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1123.1">&gt;</span></span><span class="koboSpan" id="kobo.1124.1">
    {{ module.title }}
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1125.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1126.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1127.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1128.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1129.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1130.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1131.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1132.1">"contents"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1133.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1134.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1135.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1136.1">&gt;</span></span><span class="koboSpan" id="kobo.1137.1">Modules</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1138.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1139.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1140.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1141.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1142.1">ul</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1143.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1144.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1145.1">"modules"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1146.1">&gt;</span></span><span class="koboSpan" id="kobo.1147.1">
      {% for m in object.modules.all %}
        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1148.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1149.1">li</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1150.1">data-id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1151.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1152.1">"{{ m.id }}"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1153.1"> {% </span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1154.1">if</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1155.1">m</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1156.1"> == </span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1157.1">module</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1158.1"> %}</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1159.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1160.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1161.1">"selected"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1162.1">{% </span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1163.1">endif</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1164.1"> %}&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1165.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1166.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1167.1">href</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1168.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1169.1">"{% url "</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1170.1">student_course_detail_module</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1171.1">" </span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1172.1">object.id</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1173.1">m.id</span></span><span class="hljs-tag"> </span><span class="hljs-string"><span class="koboSpan" id="kobo.1174.1">%}"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1175.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1176.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1177.1">span</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1178.1">&gt;</span></span><span class="koboSpan" id="kobo.1179.1">
              Module </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1180.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1181.1">span</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1182.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1183.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1184.1">"order"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1185.1">&gt;</span></span><span class="koboSpan" id="kobo.1186.1">{{ m.order|add:1 }}</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1187.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1188.1">span</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1189.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1190.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1191.1">span</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1192.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1193.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1194.1">br</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1195.1">&gt;</span></span><span class="koboSpan" id="kobo.1196.1">
            {{ m.title }}
          </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1197.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1198.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1199.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1200.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1201.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1202.1">&gt;</span></span><span class="koboSpan" id="kobo.1203.1">
      {% empty %}
        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1204.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1205.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1206.1">&gt;</span></span><span class="koboSpan" id="kobo.1207.1">No modules yet.</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1208.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1209.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1210.1">&gt;</span></span><span class="koboSpan" id="kobo.1211.1">
      {% endfor %}
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1212.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1213.1">ul</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1214.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1215.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1216.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1217.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1218.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1219.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1220.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1221.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1222.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1223.1">module"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1224.1">&gt;</span></span><span class="koboSpan" id="kobo.1225.1">
    {% for content in module.contents.all %}
      {% with item=content.item %}
        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1226.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1227.1">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1228.1">&gt;</span></span><span class="koboSpan" id="kobo.1229.1">{{ item.title }}</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1230.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1231.1">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1232.1">&gt;</span></span><span class="koboSpan" id="kobo.1233.1">
        {{ item.render }}
      {% endwith %}
    {% endfor %}
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1234.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1235.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1236.1">&gt;</span></span><span class="koboSpan" id="kobo.1237.1">
{% endblock %}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1238.1">Make sure no template tag is split across multiple lines. </span><span class="koboSpan" id="kobo.1238.2">This is the template for enrolled students to access the contents of a course. </span><span class="koboSpan" id="kobo.1238.3">First, you build an HTML list including all course modules and highlighting the current module. </span><span class="koboSpan" id="kobo.1238.4">Then, you iterate over the current module contents and access each content item to display it using </span><code class="inlineCode"><span class="koboSpan" id="kobo.1239.1">{{ item.render }}</span></code><span class="koboSpan" id="kobo.1240.1">. </span><span class="koboSpan" id="kobo.1240.2">You will add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1241.1">render()</span></code><span class="koboSpan" id="kobo.1242.1"> method to the content models next. </span><span class="koboSpan" id="kobo.1242.2">This method will take care of rendering the content properly.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1243.1">You can now </span><a id="_idIndexMarker1286"/><span class="koboSpan" id="kobo.1244.1">access </span><code class="inlineCode"><span class="koboSpan" id="kobo.1245.1">http://127.0.0.1:8000/students/register/</span></code><span class="koboSpan" id="kobo.1246.1">, register a new student account, and enroll in any course.</span></p>
<h2 class="heading-2" id="_idParaDest-376"><span class="koboSpan" id="kobo.1247.1">Rendering different types of content</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1248.1">To display the </span><a id="_idIndexMarker1287"/><span class="koboSpan" id="kobo.1249.1">course contents, you need to render the different content types that you created: </span><em class="italic"><span class="koboSpan" id="kobo.1250.1">text</span></em><span class="koboSpan" id="kobo.1251.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1252.1">image</span></em><span class="koboSpan" id="kobo.1253.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1254.1">video</span></em><span class="koboSpan" id="kobo.1255.1">, and </span><em class="italic"><span class="koboSpan" id="kobo.1256.1">file</span></em><span class="koboSpan" id="kobo.1257.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1258.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1259.1">models.py</span></code><span class="koboSpan" id="kobo.1260.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1261.1">courses</span></code><span class="koboSpan" id="kobo.1262.1"> application and add the following </span><code class="inlineCode"><span class="koboSpan" id="kobo.1263.1">render()</span></code><span class="koboSpan" id="kobo.1264.1"> method to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1265.1">ItemBase</span></code><span class="koboSpan" id="kobo.1266.1"> model:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1267.1">from</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1268.1"> django.template.loader </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1269.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1270.1"> render_to_string</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1271.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1272.1">ItemBase</span></span><span class="koboSpan" id="kobo.1273.1">(models.Model):
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1274.1"># ...</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1275.1">def</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1276.1">render</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1277.1">(</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.1278.1">self</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1279.1">):</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1280.1">return</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1281.1"> render_to_string(</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1282.1">f'courses/content/</span></strong><strong class="hljs-subst-slc"><span class="koboSpan" id="kobo.1283.1">{self._meta.model_name}</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1284.1">.html'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1285.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1286.1">            {</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1287.1">'item'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1288.1">: self}</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1289.1">        )</span></strong></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1290.1">This method uses the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1291.1">render_to_string()</span></code><span class="koboSpan" id="kobo.1292.1"> function for rendering a template and returning the rendered content as a string. </span><span class="koboSpan" id="kobo.1292.2">Each kind of content is rendered using a template named after the content model. </span><code class="inlineCode"><span class="koboSpan" id="kobo.1293.1">self._meta.model_name</span></code><span class="koboSpan" id="kobo.1294.1"> is used to generate the appropriate template name for each content model dynamically. </span><span class="koboSpan" id="kobo.1294.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1295.1">render()</span></code><span class="koboSpan" id="kobo.1296.1"> method provides a common interface for rendering diverse content.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1297.1">Create the following file structure inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1298.1">templates/courses/</span></code><span class="koboSpan" id="kobo.1299.1"> directory of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1300.1">courses</span></code><span class="koboSpan" id="kobo.1301.1"> application:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1302.1">content/
    text.html
    file.html
    image.html
    video.html
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1303.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1304.1">courses/content/text.html</span></code><span class="koboSpan" id="kobo.1305.1"> template and write this code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1306.1">{{ item.content|linebreaks }}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1307.1">This is the </span><a id="_idIndexMarker1288"/><span class="koboSpan" id="kobo.1308.1">template to render text content. </span><span class="koboSpan" id="kobo.1308.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1309.1">linebreaks</span></code><span class="koboSpan" id="kobo.1310.1"> template filter replaces line breaks in plain text with HTML line breaks.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1311.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1312.1">courses/content/file.html</span></code><span class="koboSpan" id="kobo.1313.1"> template and add the following:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.1314.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1315.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1316.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1317.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1318.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1319.1">href</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1320.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1321.1">"{{ item.file.url }}"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1322.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1323.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1324.1">"button"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1325.1">&gt;</span></span><span class="koboSpan" id="kobo.1326.1">Download file</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1327.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1328.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1329.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1330.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1331.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1332.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1333.1">This is the template to render files. </span><span class="koboSpan" id="kobo.1333.2">It generates a link to download the file.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1334.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1335.1">courses/content/image.html</span></code><span class="koboSpan" id="kobo.1336.1"> template and write:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.1337.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1338.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1339.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1340.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1341.1">img</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1342.1">src</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1343.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1344.1">"{{ item.file.url }}"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1345.1">alt</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1346.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1347.1">"{{ item.title }}"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1348.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1349.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1350.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1351.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1352.1">This is the template to render images.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1353.1">You also have to create a template for rendering </span><code class="inlineCode"><span class="koboSpan" id="kobo.1354.1">Video</span></code><span class="koboSpan" id="kobo.1355.1"> objects. </span><span class="koboSpan" id="kobo.1355.2">You will use </span><code class="inlineCode"><span class="koboSpan" id="kobo.1356.1">django-embed-video</span></code><span class="koboSpan" id="kobo.1357.1"> for embedding video content. </span><code class="inlineCode"><span class="koboSpan" id="kobo.1358.1">django-embed-video</span></code><span class="koboSpan" id="kobo.1359.1"> is a third-party Django application that allows you to embed videos in your templates, from sources such as YouTube or Vimeo, by simply providing their public URL.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1360.1">Install the package with the following command:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1361.1">python -m pip install django-embed-video==1.4.9
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1362.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1363.1">settings.py</span></code><span class="koboSpan" id="kobo.1364.1"> file of your project and add the application to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1365.1">INSTALLED_APPS</span></code><span class="koboSpan" id="kobo.1366.1"> setting, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1367.1">INSTALLED_APPS = [
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1368.1"># ...</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1369.1">'embed_video'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1370.1">,</span></strong></span><span class="koboSpan" id="kobo.1371.1">
]
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1372.1">You can find the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1373.1">django-embed-video</span></code><span class="koboSpan" id="kobo.1374.1"> application’s documentation at </span><a href="https://django-embed-video.readthedocs.io/en/latest/. "><span class="url"><span class="koboSpan" id="kobo.1375.1">https://django-embed-video</span></span><span class="url"><span id="_idIndexMarker1289"/></span><span class="url"><span class="koboSpan" id="kobo.1376.1">.readthedocs.io/en/latest/.</span></span></a></p>
<p class="normal"><span class="koboSpan" id="kobo.1377.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1378.1">courses/content/video.html</span></code><span class="koboSpan" id="kobo.1379.1"> template and write the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1380.1">{% load embed_video_tags %}
{% video item.url "small" %}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1381.1">This is the template to render videos.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1382.1">Now, run the development server and access </span><code class="inlineCode"><span class="koboSpan" id="kobo.1383.1">http://127.0.0.1:8000/course/mine/</span></code><span class="koboSpan" id="kobo.1384.1"> in your browser. </span><span class="koboSpan" id="kobo.1384.2">Access the site with a user that belongs to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1385.1">Instructors</span></code><span class="koboSpan" id="kobo.1386.1"> group, and add multiple contents to a course. </span><span class="koboSpan" id="kobo.1386.2">To include video content, you can just copy any YouTube URL, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.1387.1">https://www.youtube.com/watch?v=bgV39DlmZ2U</span></code><span class="koboSpan" id="kobo.1388.1">, and include it in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1389.1">url</span></code><span class="koboSpan" id="kobo.1390.1"> field of the form.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1391.1">After adding contents to the course, open </span><code class="inlineCode"><span class="koboSpan" id="kobo.1392.1">http://127.0.0.1:8000/</span></code><span class="koboSpan" id="kobo.1393.1">, click the course, and click on the </span><strong class="screenText"><span class="koboSpan" id="kobo.1394.1">ENROLL NOW</span></strong><span class="koboSpan" id="kobo.1395.1"> button. </span><span class="koboSpan" id="kobo.1395.2">You should be enrolled in the course and redirected to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1396.1">student_course_detail</span></code><span class="koboSpan" id="kobo.1397.1"> URL. </span><em class="italic"><span class="koboSpan" id="kobo.1398.1">Figure 14.6</span></em><span class="koboSpan" id="kobo.1399.1"> shows a sample course contents page:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1400.1"><img alt="Graphical user interface, application, website  Description automatically generated" src="../Images/B21088_14_06.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1401.1">Figure 14.6: A course contents page</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1402.1">Great! </span><span class="koboSpan" id="kobo.1402.2">You have</span><a id="_idIndexMarker1290"/><span class="koboSpan" id="kobo.1403.1"> created a common interface for rendering courses with different types of content.</span></p>
<h1 class="heading-1" id="_idParaDest-377"><span class="koboSpan" id="kobo.1404.1">Using the cache framework</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1405.1">Processing HTTP requests to</span><a id="_idIndexMarker1291"/><span class="koboSpan" id="kobo.1406.1"> your web application usually entails database access, data manipulation, and template rendering. </span><span class="koboSpan" id="kobo.1406.2">It is much more expensive in terms of processing than just serving a static website. </span><span class="koboSpan" id="kobo.1406.3">The overhead in some requests can be significant when your site starts getting more and more traffic. </span><span class="koboSpan" id="kobo.1406.4">This is where caching becomes essential. </span><span class="koboSpan" id="kobo.1406.5">By caching queries, calculation results, or rendered content in an HTTP request, you will avoid expensive operations in the following requests that need to return the same data. </span><span class="koboSpan" id="kobo.1406.6">This translates into shorter response times and less processing on the server side.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1407.1">Django includes a robust cache system that allows you to cache data with different levels of granularity. </span><span class="koboSpan" id="kobo.1407.2">You can cache a single query, the output of a specific view, parts of rendered template content, or your entire site. </span><span class="koboSpan" id="kobo.1407.3">Items are stored in the cache system for a default time, but you can specify the timeout when you cache data.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1408.1">This is how the cache framework is usually used when your application processes an HTTP request:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1409.1">Try to find the requested data in the cache.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1410.1">If found, return the cached data.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1411.1">If not found, perform the following steps:</span><ol class="alphabeticList" style="list-style-type: lower-alpha;">
<li class="alphabeticList" value="1"><span class="koboSpan" id="kobo.1412.1">Perform the database query or processing required to generate the data.</span></li>
<li class="alphabeticList"><span class="koboSpan" id="kobo.1413.1">Save the generated data in the cache.</span></li>
<li class="alphabeticList"><span class="koboSpan" id="kobo.1414.1">Return the data.</span></li>
</ol>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1415.1">You can read</span><a id="_idIndexMarker1292"/><span class="koboSpan" id="kobo.1416.1"> detailed information about Django’s cache system at </span><a href="https://docs.djangoproject.com/en/5.0/topics/cache/"><span class="url"><span class="koboSpan" id="kobo.1417.1">https://docs.djangoproject.com/en/5.0/topics/cache/</span></span></a><span class="koboSpan" id="kobo.1418.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-378"><span class="koboSpan" id="kobo.1419.1">Available cache backends</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1420.1">Django comes with</span><a id="_idIndexMarker1293"/><span class="koboSpan" id="kobo.1421.1"> the following cache backends:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1422.1">backends.memcached.PyMemcacheCache</span></code><span class="koboSpan" id="kobo.1423.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1424.1">backends.memcached.PyLibMCCache</span></code><span class="koboSpan" id="kobo.1425.1">: Memcached backends. </span><span class="koboSpan" id="kobo.1425.2">Memcached is a fast and efficient memory-based cache server. </span><span class="koboSpan" id="kobo.1425.3">The backend to use depends on the Memcached Python bindings you choose.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1426.1">backends.redis.RedisCache</span></code><span class="koboSpan" id="kobo.1427.1">: A Redis cache backend. </span><span class="koboSpan" id="kobo.1427.2">This backend was added in Django 4.0.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1428.1">backends.db.DatabaseCache</span></code><span class="koboSpan" id="kobo.1429.1">: Uses the database as a cache system.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1430.1">backends.filebased.FileBasedCache</span></code><span class="koboSpan" id="kobo.1431.1">: Uses the file storage system. </span><span class="koboSpan" id="kobo.1431.2">This serializes and stores each cache value as a separate file.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1432.1">backends.locmem.LocMemCache</span></code><span class="koboSpan" id="kobo.1433.1">: A local memory cache backend. </span><span class="koboSpan" id="kobo.1433.2">This is the default cache backend.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1434.1">backends.dummy.DummyCache</span></code><span class="koboSpan" id="kobo.1435.1">: A dummy cache backend intended only for development. </span><span class="koboSpan" id="kobo.1435.2">It implements the cache interface without actually caching anything. </span><span class="koboSpan" id="kobo.1435.3">This cache is per-process and thread-safe.</span></li>
</ul>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.1436.1">For optimal performance, use a memory-based cache backend like Memcached or Redis, since </span><a id="_idIndexMarker1294"/><span class="koboSpan" id="kobo.1437.1">accessing memory is faster than accessing data from databases of files.</span></p>
</div>
<h1 class="heading-1" id="_idParaDest-379"><span class="koboSpan" id="kobo.1438.1">Installing Memcached</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1439.1">Memcached is </span><a id="_idIndexMarker1295"/><span class="koboSpan" id="kobo.1440.1">a popular high-performance, memory-based cache server. </span><span class="koboSpan" id="kobo.1440.2">We are going to use Memcached and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1441.1">PyMemcacheCache</span></code><span class="koboSpan" id="kobo.1442.1"> Memcached backend.</span></p>
<h2 class="heading-2" id="_idParaDest-380"><span class="koboSpan" id="kobo.1443.1">Installing the Memcached Docker image</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1444.1">Run the following </span><a id="_idIndexMarker1296"/><span class="koboSpan" id="kobo.1445.1">command from the shell to pull the Memcached Docker image:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1446.1">docker pull memcached:1.6.26
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1447.1">This will download the Memcached Docker image to your local machine. </span><span class="koboSpan" id="kobo.1447.2">You can find more information about the official Memcached Docker image at </span><a href="https://hub.docker.com/_/memcached"><span class="url"><span class="koboSpan" id="kobo.1448.1">https://hub.docker.com/_/memcached</span></span></a><span class="koboSpan" id="kobo.1449.1">. </span><span class="koboSpan" id="kobo.1449.2">If you don’t want to use Docker, you can also download Memcached from </span><a href="https://memcached.org/downloads"><span class="url"><span class="koboSpan" id="kobo.1450.1">https://memcached.org/downloads</span></span></a><span class="koboSpan" id="kobo.1451.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1452.1">Run the Memcached Docker container with the following command:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1453.1">docker run -it --rm --name memcached -p 11211:11211 memcached:1.6.26 -m 64
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1454.1">Memcached runs on port </span><code class="inlineCode"><span class="koboSpan" id="kobo.1455.1">11211</span></code><span class="koboSpan" id="kobo.1456.1"> by default. </span><span class="koboSpan" id="kobo.1456.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1457.1">-p</span></code><span class="koboSpan" id="kobo.1458.1"> option is used to publish the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1459.1">11211</span></code><span class="koboSpan" id="kobo.1460.1"> port to the same host interface port. </span><span class="koboSpan" id="kobo.1460.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1461.1">-m</span></code><span class="koboSpan" id="kobo.1462.1"> option is used to limit the memory for the container to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1463.1">64</span></code><span class="koboSpan" id="kobo.1464.1"> MB. </span><span class="koboSpan" id="kobo.1464.2">Memcached runs in memory, and it is allotted a specified amount of RAM. </span><span class="koboSpan" id="kobo.1464.3">When the allotted RAM is full, Memcached starts removing the oldest data to store new data. </span><span class="koboSpan" id="kobo.1464.4">If you want to run the command in detached mode (in the background of your terminal), you can use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1465.1">-d</span></code><span class="koboSpan" id="kobo.1466.1"> option.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1467.1">You can find more information about Memcached at </span><a href="https://memcached.org"><span class="url"><span class="koboSpan" id="kobo.1468.1">https://memcached.org</span></span></a><span class="koboSpan" id="kobo.1469.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-381"><span class="koboSpan" id="kobo.1470.1">Installing the Memcached Python binding</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1471.1">After installing</span><a id="_idIndexMarker1297"/><span class="koboSpan" id="kobo.1472.1"> Memcached, you have to install a Memcached Python binding. </span><span class="koboSpan" id="kobo.1472.2">We will install </span><code class="inlineCode"><span class="koboSpan" id="kobo.1473.1">pymemcache</span></code><span class="koboSpan" id="kobo.1474.1">, which is a fast, pure-Python Memcached client. </span><span class="koboSpan" id="kobo.1474.2">Run the following command in the shell:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1475.1">python -m pip install pymemcache==4.0.0
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1476.1">You can read more information about the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1477.1">pymemcache</span></code><span class="koboSpan" id="kobo.1478.1"> library at </span><a href="https://github.com/pinterest/pymemcache"><span class="url"><span class="koboSpan" id="kobo.1479.1">https://github.com/pinterest/pymemcache</span></span></a><span class="koboSpan" id="kobo.1480.1">.</span></p>
<h1 class="heading-1" id="_idParaDest-382"><span class="koboSpan" id="kobo.1481.1">Django cache settings</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1482.1">Django provides </span><a id="_idIndexMarker1298"/><span class="koboSpan" id="kobo.1483.1">the following cache settings:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1484.1">CACHES</span></code><span class="koboSpan" id="kobo.1485.1">: A dictionary containing all available caches for the project.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1486.1">CACHE_MIDDLEWARE_ALIAS</span></code><span class="koboSpan" id="kobo.1487.1">: The cache alias to use for storage.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1488.1">CACHE_MIDDLEWARE_KEY_PREFIX</span></code><span class="koboSpan" id="kobo.1489.1">: The prefix to use for cache keys. </span><span class="koboSpan" id="kobo.1489.2">Set a prefix to avoid key collisions if you share the same cache between several sites.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1490.1">CACHE_MIDDLEWARE_SECONDS</span></code><span class="koboSpan" id="kobo.1491.1">: The default number of seconds to cache pages.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.1492.1">The caching system for the project can be configured using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1493.1">CACHES</span></code><span class="koboSpan" id="kobo.1494.1"> settings. </span><span class="koboSpan" id="kobo.1494.2">This setting allows you to specify the configuration for multiple caches. </span><span class="koboSpan" id="kobo.1494.3">Each cache included in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1495.1">CACHES</span></code><span class="koboSpan" id="kobo.1496.1"> dictionary can specify the following data:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1497.1">BACKEND</span></code><span class="koboSpan" id="kobo.1498.1">: The cache backend to use.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1499.1">KEY_FUNCTION</span></code><span class="koboSpan" id="kobo.1500.1">: A string containing a dotted path to a callable that takes a prefix, version, and key as arguments and returns a final cache key.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1501.1">KEY_PREFIX</span></code><span class="koboSpan" id="kobo.1502.1">: A string prefix for all cache keys, to avoid collisions.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1503.1">LOCATION</span></code><span class="koboSpan" id="kobo.1504.1">: The location of the cache. </span><span class="koboSpan" id="kobo.1504.2">Depending on the cache backend, this might be a directory, a host and port, or a name for the in-memory backend.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1505.1">OPTIONS</span></code><span class="koboSpan" id="kobo.1506.1">: Any additional parameters to be passed to the cache backend.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1507.1">TIMEOUT</span></code><span class="koboSpan" id="kobo.1508.1">: The default timeout, in seconds, for storing the cache keys. </span><span class="koboSpan" id="kobo.1508.2">It is 300 seconds by default, which is 5 minutes. </span><span class="koboSpan" id="kobo.1508.3">If set to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1509.1">None</span></code><span class="koboSpan" id="kobo.1510.1">, the cache keys will not expire.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1511.1">VERSION</span></code><span class="koboSpan" id="kobo.1512.1">: The default version number for the cache keys. </span><span class="koboSpan" id="kobo.1512.2">Useful for cache versioning.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.1513.1">You can find more</span><a id="_idIndexMarker1299"/><span class="koboSpan" id="kobo.1514.1"> information about the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1515.1">CACHES</span></code><span class="koboSpan" id="kobo.1516.1"> settings at </span><a href="https://docs.djangoproject.com/en/5.0/ref/settings/#caches"><span class="url"><span class="koboSpan" id="kobo.1517.1">https://docs.djangoproject.com/en/5.0/ref/settings/#caches</span></span></a><span class="koboSpan" id="kobo.1518.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-383"><span class="koboSpan" id="kobo.1519.1">Adding Memcached to your project</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1520.1">Let’s configure </span><a id="_idIndexMarker1300"/><span class="koboSpan" id="kobo.1521.1">the cache for your </span><a id="_idIndexMarker1301"/><span class="koboSpan" id="kobo.1522.1">project. </span><span class="koboSpan" id="kobo.1522.2">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1523.1">settings.py</span></code><span class="koboSpan" id="kobo.1524.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1525.1">educa</span></code><span class="koboSpan" id="kobo.1526.1"> project and add the following code to it:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1527.1">CACHES = {
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1528.1">'default'</span></span><span class="koboSpan" id="kobo.1529.1">: {
        </span><span class="hljs-string"><span class="koboSpan" id="kobo.1530.1">'BACKEND'</span></span><span class="koboSpan" id="kobo.1531.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1532.1">'django.core.cache.backends.memcached.PyMemcacheCache'</span></span><span class="koboSpan" id="kobo.1533.1">,
        </span><span class="hljs-string"><span class="koboSpan" id="kobo.1534.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1535.1">LOCATION'</span></span><span class="koboSpan" id="kobo.1536.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1537.1">'127.0.0.1:11211'</span></span><span class="koboSpan" id="kobo.1538.1">,
    }
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1539.1">You are using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1540.1">PyMemcacheCache</span></code><span class="koboSpan" id="kobo.1541.1"> backend. </span><span class="koboSpan" id="kobo.1541.2">You specify its location using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1542.1">address:port</span></code><span class="koboSpan" id="kobo.1543.1"> notation. </span><span class="koboSpan" id="kobo.1543.2">If you have multiple Memcached instances, you can use a list for </span><code class="inlineCode"><span class="koboSpan" id="kobo.1544.1">LOCATION</span></code><span class="koboSpan" id="kobo.1545.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1546.1">You have set up Memcached for your project. </span><span class="koboSpan" id="kobo.1546.2">Let’s start caching data!</span></p>
<h1 class="heading-1" id="_idParaDest-384"><span class="koboSpan" id="kobo.1547.1">Cache levels</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1548.1">Django provides</span><a id="_idIndexMarker1302"/><span class="koboSpan" id="kobo.1549.1"> the following levels of caching, listed here by ascending order of granularity:</span></p>
<ul>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1550.1">Low-level cache API</span></strong><span class="koboSpan" id="kobo.1551.1">: Provides the highest granularity. </span><span class="koboSpan" id="kobo.1551.2">Allows you to cache specific queries or calculations.</span></li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1552.1">Template cache</span></strong><span class="koboSpan" id="kobo.1553.1">: Allows you to cache template fragments.</span></li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1554.1">Per-view cache</span></strong><span class="koboSpan" id="kobo.1555.1">: Provides caching for individual views.</span></li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1556.1">Per-site cache</span></strong><span class="koboSpan" id="kobo.1557.1">: The highest-level cache. </span><span class="koboSpan" id="kobo.1557.2">It caches your entire site.</span></li>
</ul>
<div class="packt_tip">
<p class="normal"><span class="koboSpan" id="kobo.1558.1">Think about your cache strategy before implementing caching. </span><span class="koboSpan" id="kobo.1558.2">Focus first on expensive queries or calculations that are not calculated on a per-user basis.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.1559.1">In the upcoming sections, we will explore how to use each of these caching levels in our project.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1560.1">Let’s start by learning </span><a id="_idIndexMarker1303"/><span class="koboSpan" id="kobo.1561.1">how to use the low-level cache API in your Python code.</span></p>
<h2 class="heading-2" id="_idParaDest-385"><span class="koboSpan" id="kobo.1562.1">Using the low-level cache API</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1563.1">The low-level </span><a id="_idIndexMarker1304"/><span class="koboSpan" id="kobo.1564.1">cache API allows you to store objects in </span><a id="_idIndexMarker1305"/><span class="koboSpan" id="kobo.1565.1">the cache with any granularity. </span><span class="koboSpan" id="kobo.1565.2">It is located at </span><code class="inlineCode"><span class="koboSpan" id="kobo.1566.1">django.core.cache</span></code><span class="koboSpan" id="kobo.1567.1">. </span><span class="koboSpan" id="kobo.1567.2">You can import it like this:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1568.1">from</span></span><span class="koboSpan" id="kobo.1569.1"> django.core.cache </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1570.1">import</span></span><span class="koboSpan" id="kobo.1571.1"> cache
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1572.1">This uses the default cache. </span><span class="koboSpan" id="kobo.1572.2">It’s equivalent to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1573.1">caches['default']</span></code><span class="koboSpan" id="kobo.1574.1">. </span><span class="koboSpan" id="kobo.1574.2">Accessing a specific cache is also possible via its alias:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1575.1">from</span></span><span class="koboSpan" id="kobo.1576.1"> django.core.cache </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1577.1">import</span></span><span class="koboSpan" id="kobo.1578.1"> caches
my_cache = caches[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1579.1">'alias'</span></span><span class="koboSpan" id="kobo.1580.1">]
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1581.1">Let’s take a look at how the cache API works. </span><span class="koboSpan" id="kobo.1581.2">Open the Django shell with the following command:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1582.1">python manage.py shell
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1583.1">Execute the following code:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta"><span class="koboSpan" id="kobo.1584.1">&gt;&gt;&gt;</span></span> <span class="hljs-con-keyword"><span class="koboSpan" id="kobo.1585.1">from</span></span><span class="koboSpan" id="kobo.1586.1"> django.core.cache </span><span class="hljs-con-keyword"><span class="koboSpan" id="kobo.1587.1">import</span></span><span class="koboSpan" id="kobo.1588.1"> cache
</span><span class="hljs-con-meta"><span class="koboSpan" id="kobo.1589.1">&gt;&gt;&gt;</span></span><span class="koboSpan" id="kobo.1590.1"> cache.</span><span class="hljs-con-built_in"><span class="koboSpan" id="kobo.1591.1">set</span></span><span class="koboSpan" id="kobo.1592.1">(</span><span class="hljs-con-string"><span class="koboSpan" id="kobo.1593.1">'musician'</span></span><span class="koboSpan" id="kobo.1594.1">, </span><span class="hljs-con-string"><span class="koboSpan" id="kobo.1595.1">'Django Reinhardt'</span></span><span class="koboSpan" id="kobo.1596.1">, </span><span class="hljs-con-number"><span class="koboSpan" id="kobo.1597.1">20</span></span><span class="koboSpan" id="kobo.1598.1">)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1599.1">You access the default cache backend and use </span><code class="inlineCode"><span class="koboSpan" id="kobo.1600.1">set(key, value, timeout)</span></code><span class="koboSpan" id="kobo.1601.1"> to store a key named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1602.1">'musician'</span></code><span class="koboSpan" id="kobo.1603.1"> with a value that is the string </span><code class="inlineCode"><span class="koboSpan" id="kobo.1604.1">'Django Reinhardt'</span></code><span class="koboSpan" id="kobo.1605.1"> for 20 seconds. </span><span class="koboSpan" id="kobo.1605.2">If you don’t specify a timeout, Django uses the default timeout specified for the cache backend in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1606.1">CACHES</span></code><span class="koboSpan" id="kobo.1607.1"> settings. </span><span class="koboSpan" id="kobo.1607.2">Now, execute the following code:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta"><span class="koboSpan" id="kobo.1608.1">&gt;&gt;&gt;</span></span><span class="koboSpan" id="kobo.1609.1"> cache.get(</span><span class="hljs-con-string"><span class="koboSpan" id="kobo.1610.1">'musician'</span></span><span class="koboSpan" id="kobo.1611.1">)
'Django Reinhardt'
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1612.1">You retrieve the key from the cache. </span><span class="koboSpan" id="kobo.1612.2">Wait for 20 seconds and execute the same code:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta"><span class="koboSpan" id="kobo.1613.1">&gt;&gt;&gt;</span></span><span class="koboSpan" id="kobo.1614.1"> cache.get(</span><span class="hljs-con-string"><span class="koboSpan" id="kobo.1615.1">'musician'</span></span><span class="koboSpan" id="kobo.1616.1">)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1617.1">No value is returned this time. </span><span class="koboSpan" id="kobo.1617.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1618.1">'musician'</span></code><span class="koboSpan" id="kobo.1619.1"> cache key has expired and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1620.1">get()</span></code><span class="koboSpan" id="kobo.1621.1"> method returns </span><code class="inlineCode"><span class="koboSpan" id="kobo.1622.1">None</span></code><span class="koboSpan" id="kobo.1623.1"> because the key is not in the cache anymore.</span></p>
<div class="packt_tip">
<p class="normal"><span class="koboSpan" id="kobo.1624.1">Always avoid storing a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1625.1">None</span></code><span class="koboSpan" id="kobo.1626.1"> value in a cache key because you won’t be able to distinguish between the actual value and a cache miss.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.1627.1">Let’s cache a QuerySet with the following code:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta"><span class="koboSpan" id="kobo.1628.1">&gt;&gt;&gt;</span></span> <span class="hljs-con-keyword"><span class="koboSpan" id="kobo.1629.1">from</span></span><span class="koboSpan" id="kobo.1630.1"> courses.models </span><span class="hljs-con-keyword"><span class="koboSpan" id="kobo.1631.1">import</span></span><span class="koboSpan" id="kobo.1632.1"> Subject
</span><span class="hljs-con-meta"><span class="koboSpan" id="kobo.1633.1">&gt;&gt;&gt;</span></span><span class="koboSpan" id="kobo.1634.1"> subjects = Subject.objects.</span><span class="hljs-con-built_in"><span class="koboSpan" id="kobo.1635.1">all</span></span><span class="koboSpan" id="kobo.1636.1">()
</span><span class="hljs-con-meta"><span class="koboSpan" id="kobo.1637.1">&gt;&gt;&gt;</span></span><span class="koboSpan" id="kobo.1638.1"> cache.</span><span class="hljs-con-built_in"><span class="koboSpan" id="kobo.1639.1">set</span></span><span class="koboSpan" id="kobo.1640.1">(</span><span class="hljs-con-string"><span class="koboSpan" id="kobo.1641.1">'my_subjects'</span></span><span class="koboSpan" id="kobo.1642.1">, subjects)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1643.1">You perform a QuerySet on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1644.1">Subject</span></code><span class="koboSpan" id="kobo.1645.1"> model and store the returned objects in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1646.1">'my_subjects'</span></code><span class="koboSpan" id="kobo.1647.1"> key. </span><span class="koboSpan" id="kobo.1647.2">Let’s retrieve the cached data:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta"><span class="koboSpan" id="kobo.1648.1">&gt;&gt;&gt;</span></span><span class="koboSpan" id="kobo.1649.1"> cache.get(</span><span class="hljs-con-string"><span class="koboSpan" id="kobo.1650.1">'my_subjects'</span></span><span class="koboSpan" id="kobo.1651.1">)
&lt;QuerySet [&lt;Subject: Mathematics&gt;, &lt;Subject: Music&gt;, &lt;Subject: Physics&gt;, &lt;Subject: Programming&gt;]&gt;
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1652.1">You are going to cache some queries in your views. </span><span class="koboSpan" id="kobo.1652.2">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1653.1">views.py</span></code><span class="koboSpan" id="kobo.1654.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1655.1">courses</span></code><span class="koboSpan" id="kobo.1656.1"> application</span><a id="_idIndexMarker1306"/><span class="koboSpan" id="kobo.1657.1"> and </span><a id="_idIndexMarker1307"/><span class="koboSpan" id="kobo.1658.1">add the following import:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1659.1">from</span></span><span class="koboSpan" id="kobo.1660.1"> django.core.cache </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1661.1">import</span></span><span class="koboSpan" id="kobo.1662.1"> cache
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1663.1">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1664.1">get()</span></code><span class="koboSpan" id="kobo.1665.1"> method of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1666.1">CourseListView</span></code><span class="koboSpan" id="kobo.1667.1">, find the following lines:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1668.1">subjects = Subject.objects.annotate(
    total_courses=Count(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1669.1">'courses'</span></span><span class="koboSpan" id="kobo.1670.1">)
)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1671.1">Replace the lines with the following ones:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1672.1">subjects = cache.get(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1673.1">'</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1674.1">all_subjects'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1675.1">)</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1676.1">if</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1677.1">not</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1678.1"> subjects:</span></strong></span><span class="koboSpan" id="kobo.1679.1">
    subjects = Subject.objects.annotate(
        total_courses=Count(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1680.1">'courses'</span></span><span class="koboSpan" id="kobo.1681.1">)
    )
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1682.1">    cache.</span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.1683.1">set</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1684.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1685.1">'all_subjects'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1686.1">, subjects)</span></strong></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1687.1">In this code, you try to get the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1688.1">all_subjects</span></code><span class="koboSpan" id="kobo.1689.1"> key from the cache using </span><code class="inlineCode"><span class="koboSpan" id="kobo.1690.1">cache.get()</span></code><span class="koboSpan" id="kobo.1691.1">. </span><span class="koboSpan" id="kobo.1691.2">This returns </span><code class="inlineCode"><span class="koboSpan" id="kobo.1692.1">None</span></code><span class="koboSpan" id="kobo.1693.1"> if the given key is not found. </span><span class="koboSpan" id="kobo.1693.2">If no key is found (not cached yet or cached but timed out), the query is performed to retrieve all </span><code class="inlineCode"><span class="koboSpan" id="kobo.1694.1">Subject</span></code><span class="koboSpan" id="kobo.1695.1"> objects and their number </span><a id="_idIndexMarker1308"/><span class="koboSpan" id="kobo.1696.1">of courses, and</span><a id="_idIndexMarker1309"/><span class="koboSpan" id="kobo.1697.1"> the result is cached using </span><code class="inlineCode"><span class="koboSpan" id="kobo.1698.1">cache.set()</span></code><span class="koboSpan" id="kobo.1699.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-386"><span class="koboSpan" id="kobo.1700.1">Checking cache requests with Django Debug Toolbar</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1701.1">Let’s add Django </span><a id="_idIndexMarker1310"/><span class="koboSpan" id="kobo.1702.1">Debug</span><a id="_idIndexMarker1311"/><span class="koboSpan" id="kobo.1703.1"> Toolbar to the project to check the cache queries. </span><span class="koboSpan" id="kobo.1703.2">You learned how to use Django Debug Toolbar in </span><em class="italic"><span class="koboSpan" id="kobo.1704.1">Chapter 7</span></em><span class="koboSpan" id="kobo.1705.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1706.1">Tracking User Actions</span></em><span class="koboSpan" id="kobo.1707.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1708.1">First, install Django Debug Toolbar with the following command:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1709.1">python -m pip install django-debug-toolbar==4.3.0
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1710.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1711.1">settings.py</span></code><span class="koboSpan" id="kobo.1712.1"> file of your project and add </span><code class="inlineCode"><span class="koboSpan" id="kobo.1713.1">debug_toolbar</span></code><span class="koboSpan" id="kobo.1714.1"> to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1715.1">INSTALLED_APPS</span></code><span class="koboSpan" id="kobo.1716.1"> setting, as follows. </span><span class="koboSpan" id="kobo.1716.2">The new line is highlighted in bold:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1717.1">INSTALLED_APPS = [
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1718.1"># ...</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1719.1">'debug_toolbar'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1720.1">,</span></strong></span><span class="koboSpan" id="kobo.1721.1">
]
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1722.1">In the same file, add the following line highlighted in bold to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1723.1">MIDDLEWARE</span></code><span class="koboSpan" id="kobo.1724.1"> setting:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1725.1">MIDDLEWARE = [
</span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1726.1">'debug_toolbar.middleware.DebugToolbarMiddleware'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1727.1">,</span></strong></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1728.1">'django.middleware.security.SecurityMiddleware'</span></span><span class="koboSpan" id="kobo.1729.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1730.1">'django.contrib.sessions.middleware.SessionMiddleware'</span></span><span class="koboSpan" id="kobo.1731.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1732.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1733.1">django.middleware.common.CommonMiddleware'</span></span><span class="koboSpan" id="kobo.1734.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1735.1">'django.middleware.csrf.CsrfViewMiddleware'</span></span><span class="koboSpan" id="kobo.1736.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1737.1">'django.contrib.auth.middleware.AuthenticationMiddleware'</span></span><span class="koboSpan" id="kobo.1738.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1739.1">'django.contrib.messages.middleware.MessageMiddleware'</span></span><span class="koboSpan" id="kobo.1740.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1741.1">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span></span><span class="koboSpan" id="kobo.1742.1">,
]
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1743.1">Remember that </span><code class="inlineCode"><span class="koboSpan" id="kobo.1744.1">DebugToolbarMiddleware</span></code><span class="koboSpan" id="kobo.1745.1"> has to be placed before any other middleware, except for middleware that encodes the response’s content, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.1746.1">GZipMiddleware</span></code><span class="koboSpan" id="kobo.1747.1">, which, if present, should come first.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1748.1">Add the following lines at the end of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1749.1">settings.py</span></code><span class="koboSpan" id="kobo.1750.1"> file:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1751.1">INTERNAL_IPS = [
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.1752.1">'127.0.0.1'</span></span><span class="koboSpan" id="kobo.1753.1">,
]   
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1754.1">Django Debug Toolbar will only display if your IP address matches an entry in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1755.1">INTERNAL_IPS</span></code><span class="koboSpan" id="kobo.1756.1"> setting.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1757.1">Edit the main </span><code class="inlineCode"><span class="koboSpan" id="kobo.1758.1">urls.py</span></code><span class="koboSpan" id="kobo.1759.1"> file of the project and add the following URL pattern to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1760.1">urlpatterns</span></code><span class="koboSpan" id="kobo.1761.1">:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1762.1">path(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1763.1">'__debug__/'</span></span><span class="koboSpan" id="kobo.1764.1">, include(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1765.1">'debug_toolbar.urls'</span></span><span class="koboSpan" id="kobo.1766.1">)),
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1767.1">Run the development server and open </span><code class="inlineCode"><span class="koboSpan" id="kobo.1768.1">http://127.0.0.1:8000/</span></code><span class="koboSpan" id="kobo.1769.1"> in your browser.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1770.1">You should now see Django Debug Toolbar on the right side of the page. </span><span class="koboSpan" id="kobo.1770.2">Click on </span><strong class="screenText"><span class="koboSpan" id="kobo.1771.1">Cache</span></strong><span class="koboSpan" id="kobo.1772.1"> in the sidebar </span><a id="_idIndexMarker1312"/><span class="koboSpan" id="kobo.1773.1">menu. </span><span class="koboSpan" id="kobo.1773.2">You </span><a id="_idIndexMarker1313"/><span class="koboSpan" id="kobo.1774.1">will see the following panel:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1775.1"><img alt="" role="presentation" src="../Images/B21088_14_07.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1776.1">Figure 14.7: The Cache panel of Django Debug Toolbar including cache requests for CourseListView on a cache miss</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1777.1">Under </span><strong class="screenText"><span class="koboSpan" id="kobo.1778.1">Total calls</span></strong><span class="koboSpan" id="kobo.1779.1"> you should see </span><strong class="screenText"><span class="koboSpan" id="kobo.1780.1">2</span></strong><span class="koboSpan" id="kobo.1781.1">. </span><span class="koboSpan" id="kobo.1781.2">The first time the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1782.1">CourseListView</span></code><span class="koboSpan" id="kobo.1783.1"> view is executed, there are two cache requests. </span><span class="koboSpan" id="kobo.1783.2">Under </span><strong class="screenText"><span class="koboSpan" id="kobo.1784.1">Commands</span></strong><span class="koboSpan" id="kobo.1785.1">, you will see that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1786.1">get</span></code><span class="koboSpan" id="kobo.1787.1"> command has been executed once, and that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1788.1">set</span></code><span class="koboSpan" id="kobo.1789.1"> command has been executed once as well. </span><span class="koboSpan" id="kobo.1789.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1790.1">get</span></code><span class="koboSpan" id="kobo.1791.1"> command corresponds to the call that retrieves the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1792.1">all_subjects</span></code><span class="koboSpan" id="kobo.1793.1"> cache key. </span><span class="koboSpan" id="kobo.1793.2">This is the first call displayed under </span><strong class="screenText"><span class="koboSpan" id="kobo.1794.1">Calls</span></strong><span class="koboSpan" id="kobo.1795.1">. </span><span class="koboSpan" id="kobo.1795.2">The first time the view is executed, a cache miss occurs because no data is cached yet. </span><span class="koboSpan" id="kobo.1795.3">That’s why there is </span><strong class="screenText"><span class="koboSpan" id="kobo.1796.1">1</span></strong><span class="koboSpan" id="kobo.1797.1"> under </span><strong class="screenText"><span class="koboSpan" id="kobo.1798.1">Cache misses</span></strong><span class="koboSpan" id="kobo.1799.1">. </span><span class="koboSpan" id="kobo.1799.2">Then, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1800.1">set</span></code><span class="koboSpan" id="kobo.1801.1"> command is used to store the results of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1802.1">subjects</span></code><span class="koboSpan" id="kobo.1803.1"> QuerySet in the cache using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1804.1">all_subjects</span></code><span class="koboSpan" id="kobo.1805.1"> cache key. </span><span class="koboSpan" id="kobo.1805.2">This is the second call displayed under </span><strong class="screenText"><span class="koboSpan" id="kobo.1806.1">Calls</span></strong><span class="koboSpan" id="kobo.1807.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1808.1">In the </span><strong class="screenText"><span class="koboSpan" id="kobo.1809.1">SQL</span></strong><span class="koboSpan" id="kobo.1810.1"> menu item of Django Debug Toolbar, you will see the total number of SQL queries executed in this request. </span><span class="koboSpan" id="kobo.1810.2">This includes the query to retrieve all subjects that are then stored in the cache:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1811.1"><img alt="Graphical user interface, application  Description automatically generated" src="../Images/B21088_14_08.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1812.1">Figure 14.8: SQL queries executed for CourseListView on a cache miss</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1813.1">Reload the </span><a id="_idIndexMarker1314"/><span class="koboSpan" id="kobo.1814.1">page in the </span><a id="_idIndexMarker1315"/><span class="koboSpan" id="kobo.1815.1">browser and click on </span><strong class="screenText"><span class="koboSpan" id="kobo.1816.1">Cache</span></strong><span class="koboSpan" id="kobo.1817.1"> in the sidebar menu:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1818.1"><img alt="" role="presentation" src="../Images/B21088_14_09.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1819.1">Figure 14.9: The Cache panel of Django Debug Toolbar, including cache requests for the CourseListView view on a cache hit</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1820.1">Now, there is only a single cache request. </span><span class="koboSpan" id="kobo.1820.2">Under </span><strong class="screenText"><span class="koboSpan" id="kobo.1821.1">Total calls</span></strong><span class="koboSpan" id="kobo.1822.1">, you should see </span><strong class="screenText"><span class="koboSpan" id="kobo.1823.1">1</span></strong><span class="koboSpan" id="kobo.1824.1">, and under </span><strong class="screenText"><span class="koboSpan" id="kobo.1825.1">Commands</span></strong><span class="koboSpan" id="kobo.1826.1">,</span><strong class="screenText"> </strong><span class="koboSpan" id="kobo.1827.1">you can see that the cache request corresponds to a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1828.1">get</span></code><span class="koboSpan" id="kobo.1829.1"> command. </span><span class="koboSpan" id="kobo.1829.2">In this case, there is a cache hit (see </span><strong class="screenText"><span class="koboSpan" id="kobo.1830.1">Cache hits</span></strong><span class="koboSpan" id="kobo.1831.1">) instead of a cache miss because the data has been found in the cache. </span><span class="koboSpan" id="kobo.1831.2">Under </span><strong class="screenText"><span class="koboSpan" id="kobo.1832.1">Calls</span></strong><span class="koboSpan" id="kobo.1833.1">, you can see the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1834.1">get</span></code><span class="koboSpan" id="kobo.1835.1"> request to retrieve the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1836.1">all_subjects</span></code><span class="koboSpan" id="kobo.1837.1"> cache key.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1838.1">Check the </span><strong class="screenText"><span class="koboSpan" id="kobo.1839.1">SQL</span></strong><span class="koboSpan" id="kobo.1840.1"> menu item of the debug toolbar. </span><span class="koboSpan" id="kobo.1840.2">You should see that there is one less SQL query in this request. </span><span class="koboSpan" id="kobo.1840.3">You are saving one SQL query because the view finds the data in the cache and doesn’t need to retrieve it from the database:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1841.1"><img alt="Graphical user interface, application  Description automatically generated" src="../Images/B21088_14_10.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1842.1">Figure 14.10: SQL queries executed for CourseListView on a cache hit</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1843.1">In this example, for a single request, it takes more time to retrieve the item from the cache than the time saved on the additional SQL query. </span><span class="koboSpan" id="kobo.1843.2">However, when you have many users accessing your site, you will find that significant time reductions can be achieved by retrieving the data from the cache instead of hitting the database, and you will be able to serve the site to more concurrent users.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1844.1">Successive requests to the same URL will retrieve the data from the cache. </span><span class="koboSpan" id="kobo.1844.2">Since we didn’t specify a timeout when caching data with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1845.1">cache.set('all_subjects', subjects)</span></code><span class="koboSpan" id="kobo.1846.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1847.1">CourseListView</span></code><span class="koboSpan" id="kobo.1848.1"> view, the default timeout will be used (300 seconds by default, which is 5 minutes). </span><span class="koboSpan" id="kobo.1848.2">When the timeout is reached, the next request to the URL will generate</span><a id="_idIndexMarker1316"/><span class="koboSpan" id="kobo.1849.1"> a cache </span><a id="_idIndexMarker1317"/><span class="koboSpan" id="kobo.1850.1">miss, the QuerySet will be executed, and data will be cached for another 5 minutes. </span><span class="koboSpan" id="kobo.1850.2">You can define a different default timeout in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1851.1">TIMEOUT</span></code><span class="koboSpan" id="kobo.1852.1"> element of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1853.1">CACHES</span></code><span class="koboSpan" id="kobo.1854.1"> setting.</span></p>
<h2 class="heading-2" id="_idParaDest-387"><span class="koboSpan" id="kobo.1855.1">Low-level caching based on dynamic data</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1856.1">Often, you</span><a id="_idIndexMarker1318"/><span class="koboSpan" id="kobo.1857.1"> will want to cache </span><a id="_idIndexMarker1319"/><span class="koboSpan" id="kobo.1858.1">something that is based on dynamic data. </span><span class="koboSpan" id="kobo.1858.2">In these cases, you have to build dynamic keys that contain all the information required to uniquely identify the cached data.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1859.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1860.1">views.py</span></code><span class="koboSpan" id="kobo.1861.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1862.1">courses</span></code><span class="koboSpan" id="kobo.1863.1"> application and modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1864.1">CourseListView</span></code><span class="koboSpan" id="kobo.1865.1"> view to make it look like this:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1866.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1867.1">CourseListView</span></span><span class="koboSpan" id="kobo.1868.1">(TemplateResponseMixin, View):
    model = Course
    template_name = </span><span class="hljs-string"><span class="koboSpan" id="kobo.1869.1">'courses/course/list.html'</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1870.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1871.1">get</span></span><span class="koboSpan" id="kobo.1872.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1873.1">self, request, subject=</span></span><span class="hljs-literal"><span class="koboSpan" id="kobo.1874.1">None</span></span><span class="koboSpan" id="kobo.1875.1">):
        subjects = cache.get(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1876.1">'all_subjects'</span></span><span class="koboSpan" id="kobo.1877.1">)
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1878.1">if</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1879.1">not</span></span><span class="koboSpan" id="kobo.1880.1"> subjects:
            subjects = Subject.objects.annotate(
                total_courses=Count(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1881.1">'courses'</span></span><span class="koboSpan" id="kobo.1882.1">)
            )
            cache.</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1883.1">set</span></span><span class="koboSpan" id="kobo.1884.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1885.1">'all_subjects'</span></span><span class="koboSpan" id="kobo.1886.1">, subjects)
        </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1887.1">all_courses</span></strong></span><span class="koboSpan" id="kobo.1888.1"> = Course.objects.annotate(
            total_modules=Count(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1889.1">'modules'</span></span><span class="koboSpan" id="kobo.1890.1">)
        )
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1891.1">if</span></span><span class="koboSpan" id="kobo.1892.1"> subject:
            subject = get_object_or_404(Subject, slug=subject)
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1893.1">            key = </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1894.1">f'subject_</span></strong><strong class="hljs-subst-slc"><span class="koboSpan" id="kobo.1895.1">{subject.</span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.1896.1">id</span></strong><strong class="hljs-subst-slc"><span class="koboSpan" id="kobo.1897.1">}</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1898.1">_courses'</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1899.1">            courses = cache.get(key)</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1900.1">if</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1901.1">not</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1902.1"> courses:</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1903.1">                courses = all_courses.</span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.1904.1">filter</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1905.1">(subject=subject)</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1906.1">                cache.</span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.1907.1">set</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1908.1">(key, courses)</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1909.1">else</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1910.1">:</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1911.1">            courses = cache.get(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1912.1">'all_courses'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1913.1">)</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1914.1">if</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1915.1">not</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1916.1"> courses:</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1917.1">                courses = all_courses</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1918.1">                cache.</span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.1919.1">set</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1920.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1921.1">'all_courses'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1922.1">, courses)</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1923.1">return</span></span><span class="koboSpan" id="kobo.1924.1"> self.render_to_response(
            {
                </span><span class="hljs-string"><span class="koboSpan" id="kobo.1925.1">'subjects'</span></span><span class="koboSpan" id="kobo.1926.1">: subjects,
                </span><span class="hljs-string"><span class="koboSpan" id="kobo.1927.1">'subject'</span></span><span class="koboSpan" id="kobo.1928.1">: subject,
                </span><span class="hljs-string"><span class="koboSpan" id="kobo.1929.1">'courses'</span></span><span class="koboSpan" id="kobo.1930.1">: courses
            }
        )
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1931.1">In this </span><a id="_idIndexMarker1320"/><span class="koboSpan" id="kobo.1932.1">case, you</span><a id="_idIndexMarker1321"/><span class="koboSpan" id="kobo.1933.1"> also cache both all courses and courses filtered by subject. </span><span class="koboSpan" id="kobo.1933.2">You use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1934.1">all_courses</span></code><span class="koboSpan" id="kobo.1935.1"> cache key for storing all courses if no subject is given. </span><span class="koboSpan" id="kobo.1935.2">If there is a subject, you build the key dynamically with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1936.1">f'subject_{subject.id}_courses'</span></code><span class="koboSpan" id="kobo.1937.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1938.1">It’s important to note that you can’t use a cached QuerySet to build other QuerySets, since what you cached are actually the results of the QuerySet. </span><span class="koboSpan" id="kobo.1938.2">So you can’t do the following:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1939.1">courses = cache.get(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1940.1">'all_courses'</span></span><span class="koboSpan" id="kobo.1941.1">)
courses.</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1942.1">filter</span></span><span class="koboSpan" id="kobo.1943.1">(subject=subject)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1944.1">Instead, you have to create the base QuerySet </span><code class="inlineCode"><span class="koboSpan" id="kobo.1945.1">Course.objects.annotate(total_modules=Count('modules'))</span></code><span class="koboSpan" id="kobo.1946.1">, which is not going to be executed until it</span><a id="_idIndexMarker1322"/><span class="koboSpan" id="kobo.1947.1"> is forced, and use </span><a id="_idIndexMarker1323"/><span class="koboSpan" id="kobo.1948.1">it to further restrict the QuerySet with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1949.1">all_courses.filter(subject=subject)</span></code><span class="koboSpan" id="kobo.1950.1"> for cases where the data was not found in the cache.</span></p>
<h2 class="heading-2" id="_idParaDest-388"><span class="koboSpan" id="kobo.1951.1">Caching template fragments</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1952.1">Caching template </span><a id="_idIndexMarker1324"/><span class="koboSpan" id="kobo.1953.1">fragments is a higher-level approach. </span><span class="koboSpan" id="kobo.1953.2">You</span><a id="_idIndexMarker1325"/><span class="koboSpan" id="kobo.1954.1"> need to load the cache template tags in your template using </span><code class="inlineCode"><span class="koboSpan" id="kobo.1955.1">{% load cache %}</span></code><span class="koboSpan" id="kobo.1956.1">. </span><span class="koboSpan" id="kobo.1956.2">Then, you will be able to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1957.1">{% cache %}</span></code><span class="koboSpan" id="kobo.1958.1"> template tag to cache specific template fragments. </span><span class="koboSpan" id="kobo.1958.2">You usually use the template tag as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1959.1">{% cache </span><span class="hljs-number"><span class="koboSpan" id="kobo.1960.1">300</span></span><span class="koboSpan" id="kobo.1961.1"> fragment_name %}
    ...
</span><span class="koboSpan" id="kobo.1961.2">{% endcache %}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1962.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1963.1">{% cache %}</span></code><span class="koboSpan" id="kobo.1964.1"> template tag has two required arguments: the timeout in seconds and a name for the fragment. </span><span class="koboSpan" id="kobo.1964.2">If you need to cache content depending on dynamic data, you can do so by passing additional arguments to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1965.1">{% cache %}</span></code><span class="koboSpan" id="kobo.1966.1"> template tag to uniquely identify the fragment.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1967.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1968.1">/students/course/detail.html</span></code><span class="koboSpan" id="kobo.1969.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1970.1">students</span></code><span class="koboSpan" id="kobo.1971.1"> application. </span><span class="koboSpan" id="kobo.1971.2">Add the following code at the top of it, just after the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1972.1">{% extends %}</span></code><span class="koboSpan" id="kobo.1973.1"> tag:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1974.1">{% load cache %}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1975.1">Then, find the following lines:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1976.1">{% for content in module.contents.all %}
  {% with item=content.item %}
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1977.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1978.1">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1979.1">&gt;</span></span><span class="koboSpan" id="kobo.1980.1">{{ item.title }}</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1981.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1982.1">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1983.1">&gt;</span></span><span class="koboSpan" id="kobo.1984.1">
    {{ item.render }}
  {% endwith %}
{% endfor %}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1985.1">Replace them with the following ones:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1986.1">{% cache </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1987.1">600</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1988.1"> module_contents module %}</span></strong></span><span class="koboSpan" id="kobo.1989.1">
  {% for content in module.contents.all %}
    {% with item=content.item %}
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1990.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1991.1">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1992.1">&gt;</span></span><span class="koboSpan" id="kobo.1993.1">{{ item.title }}</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1994.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1995.1">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1996.1">&gt;</span></span><span class="koboSpan" id="kobo.1997.1">
      {{ item.render }}
    {% endwith %}
  {% endfor %}
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1998.1">{% endcache %}</span></strong></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1999.1">You cache this template fragment using the name </span><code class="inlineCode"><span class="koboSpan" id="kobo.2000.1">module_contents</span></code><span class="koboSpan" id="kobo.2001.1"> and pass the current </span><code class="inlineCode"><span class="koboSpan" id="kobo.2002.1">Module</span></code><span class="koboSpan" id="kobo.2003.1"> object to it. </span><span class="koboSpan" id="kobo.2003.2">Thus, you uniquely identify the fragment. </span><span class="koboSpan" id="kobo.2003.3">This is important to avoid caching a module’s contents and serving the wrong content when a different module is requested.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2004.1">If the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2005.1">USE_I18N</span></code><span class="koboSpan" id="kobo.2006.1"> setting is set to </span><code class="inlineCode"><span class="koboSpan" id="kobo.2007.1">True</span></code><span class="koboSpan" id="kobo.2008.1">, the per-site middleware cache will respect the active language. </span><span class="koboSpan" id="kobo.2008.2">If you use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2009.1">{% cache %}</span></code><span class="koboSpan" id="kobo.2010.1"> template tag, you have to use one of the translation-specific</span><a id="_idIndexMarker1326"/><span class="koboSpan" id="kobo.2011.1"> variables available in </span><a id="_idIndexMarker1327"/><span class="koboSpan" id="kobo.2012.1">templates to achieve the same result, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.2013.1">{% cache 600 name request.LANGUAGE_CODE %}</span></code><span class="koboSpan" id="kobo.2014.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-389"><span class="koboSpan" id="kobo.2015.1">Caching views</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2016.1">You can cache the</span><a id="_idIndexMarker1328"/><span class="koboSpan" id="kobo.2017.1"> output of individual views using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2018.1">cache_page</span></code><span class="koboSpan" id="kobo.2019.1"> decorator located at </span><code class="inlineCode"><span class="koboSpan" id="kobo.2020.1">django.views.decorators.cache</span></code><span class="koboSpan" id="kobo.2021.1">. </span><span class="koboSpan" id="kobo.2021.2">The decorator requires a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2022.1">timeout</span></code><span class="koboSpan" id="kobo.2023.1"> argument (in seconds).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2024.1">Let’s use it in your views. </span><span class="koboSpan" id="kobo.2024.2">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2025.1">urls.py</span></code><span class="koboSpan" id="kobo.2026.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2027.1">students</span></code><span class="koboSpan" id="kobo.2028.1"> application and add the following import:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2029.1">from</span></span><span class="koboSpan" id="kobo.2030.1"> django.views.decorators.cache </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2031.1">import</span></span><span class="koboSpan" id="kobo.2032.1"> cache_page
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2033.1">Then, apply the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2034.1">cache_page</span></code><span class="koboSpan" id="kobo.2035.1"> decorator to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2036.1">student_course_detail</span></code><span class="koboSpan" id="kobo.2037.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2038.1">student_course_detail_module</span></code><span class="koboSpan" id="kobo.2039.1"> URL patterns, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2040.1">path(
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2041.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2042.1">course/&lt;pk&gt;/'</span></span><span class="koboSpan" id="kobo.2043.1">,
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2044.1">    cache_page(</span></strong><strong class="hljs-number-slc"><span class="koboSpan" id="kobo.2045.1">60</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2046.1"> * </span></strong><strong class="hljs-number-slc"><span class="koboSpan" id="kobo.2047.1">15</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2048.1">)(</span></strong></span><span class="koboSpan" id="kobo.2049.1">views.StudentCourseDetailView.as_view()</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2050.1">)</span></strong></span><span class="koboSpan" id="kobo.2051.1">,
    name=</span><span class="hljs-string"><span class="koboSpan" id="kobo.2052.1">'student_course_detail'</span></span><span class="koboSpan" id="kobo.2053.1">
),
path(
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2054.1">'course/&lt;pk&gt;/&lt;module_id&gt;/'</span></span><span class="koboSpan" id="kobo.2055.1">,
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2056.1">    cache_page(</span></strong><strong class="hljs-number-slc"><span class="koboSpan" id="kobo.2057.1">60</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2058.1"> * </span></strong><strong class="hljs-number-slc"><span class="koboSpan" id="kobo.2059.1">15</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2060.1">)(</span></strong></span><span class="koboSpan" id="kobo.2061.1">views.StudentCourseDetailView.as_view()</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2062.1">)</span></strong></span><span class="koboSpan" id="kobo.2063.1">,
    name=</span><span class="hljs-string"><span class="koboSpan" id="kobo.2064.1">'student_course_detail_module'</span></span><span class="koboSpan" id="kobo.2065.1">
),
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2066.1">Now, the complete</span><a id="_idIndexMarker1329"/><span class="koboSpan" id="kobo.2067.1"> content returned by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2068.1">StudentCourseDetailView</span></code><span class="koboSpan" id="kobo.2069.1"> is cached for 15 minutes.</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.2070.1">The per-view cache uses the URL to build the cache key. </span><span class="koboSpan" id="kobo.2070.2">Multiple URLs pointing to the same view will be cached separately.</span></p>
</div>
<h2 class="heading-2" id="_idParaDest-390"><span class="koboSpan" id="kobo.2071.1">Using the per-site cache</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2072.1">This is the </span><a id="_idIndexMarker1330"/><span class="koboSpan" id="kobo.2073.1">highest-level cache. </span><span class="koboSpan" id="kobo.2073.2">It allows you to cache your </span><a id="_idIndexMarker1331"/><span class="koboSpan" id="kobo.2074.1">entire site. </span><span class="koboSpan" id="kobo.2074.2">To allow the per-site cache, edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2075.1">settings.py</span></code><span class="koboSpan" id="kobo.2076.1"> file of your project and add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2077.1">UpdateCacheMiddleware</span></code><span class="koboSpan" id="kobo.2078.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2079.1">FetchFromCacheMiddleware</span></code><span class="koboSpan" id="kobo.2080.1"> classes to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2081.1">MIDDLEWARE</span></code><span class="koboSpan" id="kobo.2082.1"> setting, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2083.1">MIDDLEWARE = [
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2084.1">'debug_toolbar.middleware.DebugToolbarMiddleware'</span></span><span class="koboSpan" id="kobo.2085.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2086.1">'django.middleware.security.SecurityMiddleware'</span></span><span class="koboSpan" id="kobo.2087.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2088.1">'django.contrib.sessions.middleware.SessionMiddleware'</span></span><span class="koboSpan" id="kobo.2089.1">,
</span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2090.1">'django.middleware.cache.UpdateCacheMiddleware'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2091.1">,</span></strong></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2092.1">'django.middleware.common.CommonMiddleware'</span></span><span class="koboSpan" id="kobo.2093.1">,
</span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2094.1">'django.middleware.cache.FetchFromCacheMiddleware'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2095.1">,</span></strong></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2096.1">'django.middleware.csrf.CsrfViewMiddleware'</span></span><span class="koboSpan" id="kobo.2097.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2098.1">'django.contrib.auth.middleware.AuthenticationMiddleware'</span></span><span class="koboSpan" id="kobo.2099.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2100.1">'django.contrib.messages.middleware.MessageMiddleware'</span></span><span class="koboSpan" id="kobo.2101.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2102.1">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span></span><span class="koboSpan" id="kobo.2103.1">,
]
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2104.1">Remember that middleware is executed in the given order during the request phase, and in reverse order during the response phase. </span><code class="inlineCode"><span class="koboSpan" id="kobo.2105.1">UpdateCacheMiddleware</span></code><span class="koboSpan" id="kobo.2106.1"> is placed before </span><code class="inlineCode"><span class="koboSpan" id="kobo.2107.1">CommonMiddleware</span></code><span class="koboSpan" id="kobo.2108.1"> because it runs during response time, when middleware is executed in reverse order. </span><code class="inlineCode"><span class="koboSpan" id="kobo.2109.1">FetchFromCacheMiddleware</span></code><span class="koboSpan" id="kobo.2110.1"> is placed after </span><code class="inlineCode"><span class="koboSpan" id="kobo.2111.1">CommonMiddleware</span></code><span class="koboSpan" id="kobo.2112.1"> intentionally because it needs to access the request data set by the latter.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2113.1">Next, add the following settings to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2114.1">settings.py</span></code><span class="koboSpan" id="kobo.2115.1"> file:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2116.1">CACHE_MIDDLEWARE_ALIAS = </span><span class="hljs-string"><span class="koboSpan" id="kobo.2117.1">'default'</span></span><span class="koboSpan" id="kobo.2118.1">
CACHE_MIDDLEWARE_SECONDS = </span><span class="hljs-number"><span class="koboSpan" id="kobo.2119.1">60</span></span><span class="koboSpan" id="kobo.2120.1"> * </span><span class="hljs-number"><span class="koboSpan" id="kobo.2121.1">15</span></span> <span class="hljs-comment"><span class="koboSpan" id="kobo.2122.1"># 15 minutes</span></span><span class="koboSpan" id="kobo.2123.1">
CACHE_MIDDLEWARE_KEY_PREFIX = </span><span class="hljs-string"><span class="koboSpan" id="kobo.2124.1">'educa'</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2125.1">In these settings, you use the default cache for your cache middleware and set the global cache timeout to </span><code class="inlineCode"><span class="koboSpan" id="kobo.2126.1">15</span></code><span class="koboSpan" id="kobo.2127.1"> minutes. </span><span class="koboSpan" id="kobo.2127.2">You also specify a prefix for all cache keys to avoid collisions in case you use the same Memcached backend for multiple projects. </span><span class="koboSpan" id="kobo.2127.3">Your site will now cache and return cached content for all </span><code class="inlineCode"><span class="koboSpan" id="kobo.2128.1">GET</span></code><span class="koboSpan" id="kobo.2129.1"> requests.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2130.1">You can access the different pages and check the cache requests using Django Debug Toolbar. </span><span class="koboSpan" id="kobo.2130.2">The per-site cache is not viable for many sites because it affects all views, even the ones that you might not want to cache, like management views where you want data to be returned from the database to reflect the latest changes.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2131.1">In this project, the best approach is to cache the templates or views that are used to display course contents to students while keeping the content management views for instructors without any cache.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2132.1">Let’s</span><a id="_idIndexMarker1332"/><span class="koboSpan" id="kobo.2133.1"> deactivate</span><a id="_idIndexMarker1333"/><span class="koboSpan" id="kobo.2134.1"> the per-site cache. </span><span class="koboSpan" id="kobo.2134.2">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2135.1">settings.py</span></code><span class="koboSpan" id="kobo.2136.1"> file of your project and comment out the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2137.1">UpdateCacheMiddleware</span></code><span class="koboSpan" id="kobo.2138.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2139.1">FetchFromCacheMiddleware</span></code><span class="koboSpan" id="kobo.2140.1"> classes in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2141.1">MIDDLEWARE</span></code><span class="koboSpan" id="kobo.2142.1"> setting, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2143.1">MIDDLEWARE = [
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2144.1">'debug_toolbar.middleware.DebugToolbarMiddleware'</span></span><span class="koboSpan" id="kobo.2145.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2146.1">'django.middleware.security.SecurityMiddleware'</span></span><span class="koboSpan" id="kobo.2147.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2148.1">'django.contrib.sessions.middleware.SessionMiddleware'</span></span><span class="koboSpan" id="kobo.2149.1">,
    </span><span class="code-highlight"><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.2150.1"># </span></strong></span><span class="hljs-comment"><span class="koboSpan" id="kobo.2151.1">'django.middleware.cache.UpdateCacheMiddleware',</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2152.1">'django.middleware.common.CommonMiddleware'</span></span><span class="koboSpan" id="kobo.2153.1">,
    </span><span class="code-highlight"><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.2154.1"># </span></strong></span><span class="hljs-comment"><span class="koboSpan" id="kobo.2155.1">'django.middleware.cache.FetchFromCacheMiddleware',</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2156.1">'django.middleware.csrf.CsrfViewMiddleware'</span></span><span class="koboSpan" id="kobo.2157.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2158.1">'django.contrib.auth.middleware.AuthenticationMiddleware'</span></span><span class="koboSpan" id="kobo.2159.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2160.1">'django.contrib.messages.middleware.MessageMiddleware'</span></span><span class="koboSpan" id="kobo.2161.1">,
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2162.1">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span></span><span class="koboSpan" id="kobo.2163.1">,
]
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2164.1">You have seen an overview of the different methods provided by Django to cache data. </span><span class="koboSpan" id="kobo.2164.2">You should always define your cache strategy wisely, taking into account expensive QuerySets or calculations, data that won’t change frequently, and data that will be accessed </span><a id="_idIndexMarker1334"/><span class="koboSpan" id="kobo.2165.1">concurrently </span><a id="_idIndexMarker1335"/><span class="koboSpan" id="kobo.2166.1">by many users.</span></p>
<h1 class="heading-1" id="_idParaDest-391"><span class="koboSpan" id="kobo.2167.1">Using the Redis cache backend</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2168.1">Django also</span><a id="_idIndexMarker1336"/><span class="koboSpan" id="kobo.2169.1"> provides a Redis cache backend. </span><span class="koboSpan" id="kobo.2169.2">Let’s change the settings to use Redis instead of Memcached as the cache backend for the project. </span><span class="koboSpan" id="kobo.2169.3">Remember that you already used Redis in </span><em class="italic"><span class="koboSpan" id="kobo.2170.1">Chapter 7</span></em><span class="koboSpan" id="kobo.2171.1">, </span><em class="italic"><span class="koboSpan" id="kobo.2172.1">Tracking User Actions</span></em><span class="koboSpan" id="kobo.2173.1">, and in </span><em class="italic"><span class="koboSpan" id="kobo.2174.1">Chapter 10</span></em><span class="koboSpan" id="kobo.2175.1">, </span><em class="italic"><span class="koboSpan" id="kobo.2176.1">Extending Your Shop</span></em><span class="koboSpan" id="kobo.2177.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2178.1">Install </span><code class="inlineCode"><span class="koboSpan" id="kobo.2179.1">redis-py</span></code><span class="koboSpan" id="kobo.2180.1"> in your environment using the following command:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2181.1">python -m pip install redis==5.0.4
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2182.1">Then, edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2183.1">settings.py</span></code><span class="koboSpan" id="kobo.2184.1"> file of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2185.1">educa</span></code><span class="koboSpan" id="kobo.2186.1"> project and modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2187.1">CACHES</span></code><span class="koboSpan" id="kobo.2188.1"> setting, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2189.1">CACHES = {
    </span><span class="hljs-string"><span class="koboSpan" id="kobo.2190.1">'default'</span></span><span class="koboSpan" id="kobo.2191.1">: {
        </span><span class="hljs-string"><span class="koboSpan" id="kobo.2192.1">'BACKEND'</span></span><span class="koboSpan" id="kobo.2193.1">: </span><span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2194.1">'django.core.cache.backends.redis.RedisCache'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2195.1">,</span></strong></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2196.1">'LOCATION'</span></span><span class="koboSpan" id="kobo.2197.1">: </span><span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2198.1">'redis://127.0.0.1:6379'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2199.1">,</span></strong></span><span class="koboSpan" id="kobo.2200.1">
    }
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2201.1">The project will now use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2202.1">RedisCache</span></code><span class="koboSpan" id="kobo.2203.1"> cache backend. </span><span class="koboSpan" id="kobo.2203.2">The location is defined in the format </span><code class="inlineCode"><span class="koboSpan" id="kobo.2204.1">redis://[host]:[port]</span></code><span class="koboSpan" id="kobo.2205.1">. </span><span class="koboSpan" id="kobo.2205.2">You use </span><code class="inlineCode"><span class="koboSpan" id="kobo.2206.1">127.0.0.1</span></code><span class="koboSpan" id="kobo.2207.1"> to point to the localhost and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2208.1">6379</span></code><span class="koboSpan" id="kobo.2209.1">, which is the default port for Redis.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2210.1">You can read more about the Redis cache backend at </span><a href="https://docs.djangoproject.com/en/5.0/topics/cache/#redis"><span class="url"><span class="koboSpan" id="kobo.2211.1">https://docs.djangoproject.com/en/5.0/topics/cache/#redis</span></span></a><span class="koboSpan" id="kobo.2212.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2213.1">Initialize the Redis Docker container using the following command:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2214.1">docker run -it --rm --name redis -p 6379:6379 redis:7.2.4
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2215.1">If you want to run the command in the background (in detached mode), you can use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2216.1">-d</span></code><span class="koboSpan" id="kobo.2217.1"> option.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2218.1">Run the development server and open </span><code class="inlineCode"><span class="koboSpan" id="kobo.2219.1">http://127.0.0.1:8000/</span></code><span class="koboSpan" id="kobo.2220.1"> in your browser. </span><span class="koboSpan" id="kobo.2220.2">Check the cache requests in the </span><strong class="screenText"><span class="koboSpan" id="kobo.2221.1">Cache </span></strong><span class="koboSpan" id="kobo.2222.1">panel of Django Debug Toolbar. </span><span class="koboSpan" id="kobo.2222.2">You are now using Redis as your</span><a id="_idIndexMarker1337"/><span class="koboSpan" id="kobo.2223.1"> project’s cache backend instead of Memcached.</span></p>
<h2 class="heading-2" id="_idParaDest-392"><span class="koboSpan" id="kobo.2224.1">Monitoring Redis with Django Redisboard</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2225.1">You can monitor</span><a id="_idIndexMarker1338"/><span class="koboSpan" id="kobo.2226.1"> your Redis server</span><a id="_idIndexMarker1339"/><span class="koboSpan" id="kobo.2227.1"> using Django Redisboard. </span><span class="koboSpan" id="kobo.2227.2">Django Redisboard adds Redis statistics to the Django administration site. </span><span class="koboSpan" id="kobo.2227.3">You can find more information about Django Redisboard at </span><a href="https://github.com/ionelmc/django-redisboard"><span class="url"><span class="koboSpan" id="kobo.2228.1">https://github.com/ionelmc/django-redisboard</span></span></a><span class="koboSpan" id="kobo.2229.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2230.1">Install </span><code class="inlineCode"><span class="koboSpan" id="kobo.2231.1">django-redisboard</span></code><span class="koboSpan" id="kobo.2232.1"> in your environment using the following command:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2233.1">python -m pip install django-redisboard==8.4.0
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2234.1">Edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2235.1">settings.py</span></code><span class="koboSpan" id="kobo.2236.1"> file of your project and add the application to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2237.1">INSTALLED_APPS</span></code><span class="koboSpan" id="kobo.2238.1"> setting, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2239.1">INSTALLED_APPS = [
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.2240.1"># ...</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2241.1">'redisboard'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2242.1">,</span></strong></span><span class="koboSpan" id="kobo.2243.1">
]
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2244.1">Run the following command from your project’s directory to run the Django Redisboard migrations:</span></p>
<pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2245.1">python manage.py migrate redisboard
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2246.1">Run the development server and open </span><code class="inlineCode"><span class="koboSpan" id="kobo.2247.1">http://127.0.0.1:8000/admin/redisboard/redisserver/add/</span></code><span class="koboSpan" id="kobo.2248.1"> in your browser to add a Redis server to monitor. </span><span class="koboSpan" id="kobo.2248.2">For </span><strong class="screenText"><span class="koboSpan" id="kobo.2249.1">Label</span></strong><span class="koboSpan" id="kobo.2250.1">, enter </span><code class="inlineCode"><span class="koboSpan" id="kobo.2251.1">redis</span></code><span class="koboSpan" id="kobo.2252.1">, and for </span><strong class="screenText"><span class="koboSpan" id="kobo.2253.1">URL</span></strong><span class="koboSpan" id="kobo.2254.1">, enter </span><code class="inlineCode"><span class="koboSpan" id="kobo.2255.1">redis://localhost:6379/0</span></code><span class="koboSpan" id="kobo.2256.1">, as in </span><em class="italic"><span class="koboSpan" id="kobo.2257.1">Figure 14.11</span></em><span class="koboSpan" id="kobo.2258.1">:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2259.1"><img alt="Graphical user interface, text, application, email  Description automatically generated" src="../Images/B21088_14_11.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2260.1">Figure 14.11: The form to add a Redis server for Django Redisboard in the administration site</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2261.1">We will monitor </span><a id="_idIndexMarker1340"/><span class="koboSpan" id="kobo.2262.1">the</span><a id="_idIndexMarker1341"/><span class="koboSpan" id="kobo.2263.1"> Redis instance running on our localhost, which runs on port </span><code class="inlineCode"><span class="koboSpan" id="kobo.2264.1">6379</span></code><span class="koboSpan" id="kobo.2265.1"> and uses the Redis database numbered </span><code class="inlineCode"><span class="koboSpan" id="kobo.2266.1">0</span></code><span class="koboSpan" id="kobo.2267.1">. </span><span class="koboSpan" id="kobo.2267.2">Click on </span><strong class="screenText"><span class="koboSpan" id="kobo.2268.1">SAVE</span></strong><span class="koboSpan" id="kobo.2269.1">. </span><span class="koboSpan" id="kobo.2269.2">The information will be saved to the database, and you will be able to see the Redis configuration and metrics on the Django administration site:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2270.1"><img alt="" role="presentation" src="../Images/B21088_14_12.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2271.1">Figure 14.12: The Redis monitoring of Django Redisboard on the administration site</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2272.1">Congratulations! </span><span class="koboSpan" id="kobo.2272.2">You</span><a id="_idIndexMarker1342"/><span class="koboSpan" id="kobo.2273.1"> have successfully</span><a id="_idIndexMarker1343"/><span class="koboSpan" id="kobo.2274.1"> implemented caching for your project.</span></p>
<h1 class="heading-1" id="_idParaDest-393"><span class="koboSpan" id="kobo.2275.1">Summary</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2276.1">In this chapter, you implemented the public views for the course catalog. </span><span class="koboSpan" id="kobo.2276.2">You built a system for students to register and enroll in courses. </span><span class="koboSpan" id="kobo.2276.3">You also created the functionality to render different types of content for the course modules. </span><span class="koboSpan" id="kobo.2276.4">Finally, you learned how to use the Django cache framework and you used the Memcached and Redis cache backends for your project.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2277.1">In the next chapter, you will build a RESTful API for your project using Django REST framework and consume it using the Python Requests library.</span></p>
<h1 class="heading-1" id="_idParaDest-394"><span class="koboSpan" id="kobo.2278.1">Additional resources</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2279.1">The following resources provide additional information related to the topics covered in this chapter:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.2280.1">Source code for this chapter: </span><a href="https://github.com/PacktPublishing/Django-5-by-example/tree/main/Chapter14 "><span class="url"><span class="koboSpan" id="kobo.2281.1">https://github.com/PacktPublishing/Django-5-by-example/tree/main/Chapter14</span></span></a></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.2282.1">django-embed-video</span></code><span class="koboSpan" id="kobo.2283.1"> documentation: </span><a href="https://django-embed-video.readthedocs.io/en/latest/"><span class="url"><span class="koboSpan" id="kobo.2284.1">https://django-embed-video.readthedocs.io/en/latest/</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2285.1">Django’s cache framework documentation: </span><a href="https://docs.djangoproject.com/en/5.0/topics/cache/"><span class="url"><span class="koboSpan" id="kobo.2286.1">https://docs.djangoproject.com/en/5.0/topics/cache/</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2287.1">Memcached Docker image: </span><a href="https://hub.docker.com/_/memcached"><span class="url"><span class="koboSpan" id="kobo.2288.1">https://hub.docker.com/_/memcached</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2289.1">Memcached downloads: </span><a href="https://memcached.org/downloads"><span class="url"><span class="koboSpan" id="kobo.2290.1">https://memcached.org/downloads</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2291.1">Memcached official website: </span><a href="https://memcached.org"><span class="url"><span class="koboSpan" id="kobo.2292.1">https://memcached.org</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2293.1">Django’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.2294.1">CACHES</span></code><span class="koboSpan" id="kobo.2295.1"> settings documentation: </span><a href="https://docs.djangoproject.com/en/5.0/ref/settings/#caches"><span class="url"><span class="koboSpan" id="kobo.2296.1">https://docs.djangoproject.com/en/5.0/ref/settings/#caches</span></span></a><span class="koboSpan" id="kobo.2297.1">.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.2298.1">pymemcache</span></code><span class="koboSpan" id="kobo.2299.1">'s source code: </span><a href="https://github.com/pinterest/pymemcache"><span class="url"><span class="koboSpan" id="kobo.2300.1">https://github.com/pinterest/pymemcache</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2301.1">Django Redis cache backend: </span><a href="https://docs.djangoproject.com/en/5.0/topics/cache/#redis"><span class="url"><span class="koboSpan" id="kobo.2302.1">https://docs.djangoproject.com/en/5.0/topics/cache/#redis</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2303.1">Official Redis Docker image: </span><a href="https://hub.docker.com/_/redis"><span class="url"><span class="koboSpan" id="kobo.2304.1">https://hub.docker.com/_/redis</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2305.1">Redis download options: </span><a href="https://redis.io/download/"><span class="url"><span class="koboSpan" id="kobo.2306.1">https://redis.io/download/</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2307.1">Django Redisboard source code: </span><a href="https://github.com/ionelmc/django-redisboard"><span class="url"><span class="koboSpan" id="kobo.2308.1">https://github.com/ionelmc/django-redisboard</span></span></a></li>
</ul>
</div>
</body></html>