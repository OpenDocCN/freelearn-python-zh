<html><head></head><body>
  <div class="Basic-Text-Frame" id="_idContainer138">
   <h1 class="chapterNumber">
    <span class="koboSpan" id="kobo.1.1">
     7
    </span>
   </h1>
   <h1 class="chapterTitle" id="_idParaDest-209">
    <span class="koboSpan" id="kobo.2.1">
     Exceptions and Context Managers
    </span>
   </h1>
   <blockquote class="packt_quote">
    <p class="quote">
     <span class="koboSpan" id="kobo.3.1">
      The best-laid schemes o’ mice an’ men Gang aft agley.
     </span>
    </p>
    <p class="cite">
     <span class="koboSpan" id="kobo.4.1">
      – Robert Burns
     </span>
    </p>
   </blockquote>
   <p class="normal">
    <span class="koboSpan" id="kobo.5.1">
     This famous line by Robert Burns should be etched into the mind of every programmer.
    </span>
    <span class="koboSpan" id="kobo.5.2">
     Even if our code is correct, errors will happen.
    </span>
    <span class="koboSpan" id="kobo.5.3">
     If we do not deal with them properly, they can cause our best-laid schemes to go awry.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.6.1">
     Unhandled errors can cause software to crash or misbehave.
    </span>
    <span class="koboSpan" id="kobo.6.2">
     Depending on the nature of the software in question, this could have serious consequences.
    </span>
    <span class="koboSpan" id="kobo.6.3">
     Therefore, it is important to learn how to detect and handle errors.
    </span>
    <span class="koboSpan" id="kobo.6.4">
     We encourage you to cultivate the habit of always thinking about what errors can occur and how your code should respond when they do.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.7.1">
     This chapter is all about
    </span>
    <a id="_idIndexMarker699">
    </a>
    <span class="koboSpan" id="kobo.8.1">
     errors and dealing with the unexpected.
    </span>
    <span class="koboSpan" id="kobo.8.2">
     We will be learning about
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.9.1">
      exceptions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.10.1">
     , which are Python’s way of signaling that an error or other exceptional event has occurred.
    </span>
    <span class="koboSpan" id="kobo.10.2">
     We will also talk
    </span>
    <a id="_idIndexMarker700">
    </a>
    <span class="koboSpan" id="kobo.11.1">
     about
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.12.1">
      context managers
     </span>
    </strong>
    <span class="koboSpan" id="kobo.13.1">
     , which provide a mechanism to encapsulate and reuse error-handling code.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.14.1">
     In this chapter, we are going to cover the following:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.15.1">
      Exceptions
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.16.1">
      Context managers
     </span>
    </li>
   </ul>
   <h1 class="heading-1" id="_idParaDest-210">
    <span class="koboSpan" id="kobo.17.1">
     Exceptions
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.18.1">
     Even
    </span>
    <a id="_idIndexMarker701">
    </a>
    <span class="koboSpan" id="kobo.19.1">
     though we have not covered the topic yet, we expect that by now you have at least a vague idea of what an exception is.
    </span>
    <span class="koboSpan" id="kobo.19.2">
     In the previous chapters, we saw that when an iterator is exhausted, calling
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.20.1">
      next()
     </span>
    </code>
    <span class="koboSpan" id="kobo.21.1">
     on it raises a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.22.1">
      StopIteration
     </span>
    </code>
    <span class="koboSpan" id="kobo.23.1">
     exception.
    </span>
    <span class="koboSpan" id="kobo.23.2">
     We got an
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.24.1">
      IndexError
     </span>
    </code>
    <span class="koboSpan" id="kobo.25.1">
     when we tried accessing a list at a position that was outside the valid range.
    </span>
    <span class="koboSpan" id="kobo.25.2">
     We also encountered
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.26.1">
      AttributeError
     </span>
    </code>
    <span class="koboSpan" id="kobo.27.1">
     when we tried accessing an attribute that did not exist on an object, and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.28.1">
      KeyError
     </span>
    </code>
    <span class="koboSpan" id="kobo.29.1">
     when we tried to access a nonexistent key in a dictionary.
    </span>
    <span class="koboSpan" id="kobo.29.2">
     In this chapter, we will discuss exceptions in more depth.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.30.1">
     Even when an operation or a piece of code is correct, there are often conditions in which something may go wrong.
    </span>
    <span class="koboSpan" id="kobo.30.2">
     For example, if we are converting user input from
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.31.1">
      str
     </span>
    </code>
    <span class="koboSpan" id="kobo.32.1">
     to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.33.1">
      int
     </span>
    </code>
    <span class="koboSpan" id="kobo.34.1">
     , the user could have accidentally typed a letter in place of a digit, making it impossible for us to convert that value into a number.
    </span>
    <span class="koboSpan" id="kobo.34.2">
     When dividing numbers, we may not know in advance whether we might attempt a division by 0.
    </span>
    <span class="koboSpan" id="kobo.34.3">
     When opening a file, it could be missing or corrupted.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.35.1">
     When an error is detected during execution, it is called an
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.36.1">
      exception
     </span>
    </strong>
    <span class="koboSpan" id="kobo.37.1">
     .
    </span>
    <span class="koboSpan" id="kobo.37.2">
     Exceptions are not necessarily lethal; in fact, the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.38.1">
      StopIteration
     </span>
    </code>
    <span class="koboSpan" id="kobo.39.1">
     exception is deeply integrated into the Python generator and iterator mechanisms.
    </span>
    <span class="koboSpan" id="kobo.39.2">
     Normally, however, if you do not take the necessary precautions, an exception will cause your application to break.
    </span>
    <span class="koboSpan" id="kobo.39.3">
     Sometimes, this is the desired behavior, but in other cases, we want to prevent and control problems such as these.
    </span>
    <span class="koboSpan" id="kobo.39.4">
     For example, if a user tries to open a corrupted file, we can alert them to the problem and give them an opportunity to fix it.
    </span>
    <span class="koboSpan" id="kobo.39.5">
     Let us see an example of a few exceptions:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.40.1"># exceptions/first.example.txt 
&gt;&gt;&gt; gen = (n for n in range(2)) 
&gt;&gt;&gt; next(gen) 
0 
&gt;&gt;&gt; next(gen) 
1 
&gt;&gt;&gt; next(gen) 
Traceback (most recent call last): 
  File "&lt;stdin&gt;", line 1, in &lt;module&gt; 
StopIteration 
&gt;&gt;&gt; print(undefined_name) 
Traceback (most recent call last): 
  File "&lt;stdin&gt;", line 1, in &lt;module&gt; 
NameError: name 'undefined_name' is not defined 
&gt;&gt;&gt; mylist = [1, 2, 3] 
&gt;&gt;&gt; mylist[5] 
Traceback (most recent call last): 
  File "&lt;stdin&gt;", line 1, in &lt;module&gt; 
IndexError: list index out of range 
&gt;&gt;&gt; mydict = {"a": "A", "b": "B"} 
&gt;&gt;&gt; mydict["c"] 
Traceback (most recent call last): 
  File "&lt;stdin&gt;", line 1, in &lt;module&gt; 
KeyError: 'c' 
&gt;&gt;&gt; 1 / 0 
Traceback (most recent call last): 
  File "&lt;stdin&gt;", line 1, in &lt;module&gt; 
ZeroDivisionError: division by zero
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.41.1">
     As you can see, the Python shell is
    </span>
    <a id="_idIndexMarker702">
    </a>
    <span class="koboSpan" id="kobo.42.1">
     quite forgiving.
    </span>
    <span class="koboSpan" id="kobo.42.2">
     We can see
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.43.1">
      Traceback
     </span>
    </code>
    <span class="koboSpan" id="kobo.44.1">
     so that we have information about the error, but the shell itself still runs normally.
    </span>
    <span class="koboSpan" id="kobo.44.2">
     This is a special behavior; a regular program or a script would normally exit immediately if nothing were done to handle exceptions.
    </span>
    <span class="koboSpan" id="kobo.44.3">
     Let us see a quick example:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.45.1"># exceptions/unhandled.py</span></span>
<span class="hljs-number"><span class="koboSpan" id="kobo.46.1">1</span></span><span class="koboSpan" id="kobo.47.1"> + "one"
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.48.1">print</span></span><span class="koboSpan" id="kobo.49.1">("This line will never be reached")
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.50.1">
     If we run this code, we get the following output:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.51.1">$ python exceptions/unhandled.py
Traceback (most recent call last):
  File "exceptions/unhandled.py", line 2, in &lt;module&gt;
    1 + "one"
    ~~^~~~~~~
TypeError: unsupported operand type(s) for +: 'int' and 'str'
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.52.1">
     Because we did nothing to handle the exception, Python immediately exits once an exception occurs (after printing out information about the error).
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-211">
    <span class="koboSpan" id="kobo.53.1">
     Raising exceptions
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.54.1">
     The exceptions we have seen
    </span>
    <a id="_idIndexMarker703">
    </a>
    <span class="koboSpan" id="kobo.55.1">
     so far were raised by the Python interpreter when it detected an error.
    </span>
    <span class="koboSpan" id="kobo.55.2">
     However, you can also raise exceptions yourself, when a situation occurs that your own code considers to be an error.
    </span>
    <span class="koboSpan" id="kobo.55.3">
     To raise an exception, use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.56.1">
      raise
     </span>
    </code>
    <span class="koboSpan" id="kobo.57.1">
     statement.
    </span>
    <span class="koboSpan" id="kobo.57.2">
     Here is an example:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.58.1"># exceptions/raising.txt
&gt;&gt;&gt; raise NotImplementedError("I'm afraid I can't do that")
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
NotImplementedError: I'm afraid I can't do that
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.59.1">
     There are no
    </span>
    <a id="_idIndexMarker704">
    </a>
    <span class="koboSpan" id="kobo.60.1">
     restrictions on which exception types you can raise.
    </span>
    <span class="koboSpan" id="kobo.60.2">
     This allows you to choose the exception type that best describes the error condition that has occurred.
    </span>
    <span class="koboSpan" id="kobo.60.3">
     You can also define your own exception types (we will see how to do that in a moment).
    </span>
    <span class="koboSpan" id="kobo.60.4">
     Notice that the argument we passed to the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.61.1">
      Exception
     </span>
    </code>
    <span class="koboSpan" id="kobo.62.1">
     class is printed out as part of the error message.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.63.1">
      Python has too many built-in exceptions
     </span>
     <a id="_idIndexMarker705">
     </a>
     <span class="koboSpan" id="kobo.64.1">
      to list here, but they are all documented at
     </span>
     <a href="https://docs.python.org/3.12/library/exceptions.html#bltin-exceptions">
      <span class="url">
       <span class="koboSpan" id="kobo.65.1">
        https://docs.python.org/3.12/library/exceptions.html#bltin-exceptions
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.66.1">
      .
     </span>
    </p>
   </div>
   <h2 class="heading-2" id="_idParaDest-212">
    <span class="koboSpan" id="kobo.67.1">
     Defining your own exceptions
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.68.1">
     As we mentioned in the previous section, you can define your own custom exceptions.
    </span>
    <span class="koboSpan" id="kobo.68.2">
     In fact, it is pretty common for libraries, for example, to define their own exceptions.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.69.1">
     All you need to do is
    </span>
    <a id="_idIndexMarker706">
    </a>
    <span class="koboSpan" id="kobo.70.1">
     define a class that inherits from any other exception class.
    </span>
    <span class="koboSpan" id="kobo.70.2">
     All exceptions derive from
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.71.1">
      BaseException
     </span>
    </code>
    <span class="koboSpan" id="kobo.72.1">
     ; however, this class is not intended to be directly subclassed.
    </span>
    <span class="koboSpan" id="kobo.72.2">
     Your custom exceptions should inherit from
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.73.1">
      Exception
     </span>
    </code>
    <span class="koboSpan" id="kobo.74.1">
     instead.
    </span>
    <span class="koboSpan" id="kobo.74.2">
     In fact, nearly all built-in exceptions also inherit from
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.75.1">
      Exception
     </span>
    </code>
    <span class="koboSpan" id="kobo.76.1">
     .
    </span>
    <span class="koboSpan" id="kobo.76.2">
     Exceptions that do not inherit from
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.77.1">
      Exception
     </span>
    </code>
    <span class="koboSpan" id="kobo.78.1">
     are meant for internal use by the Python interpreter.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-213">
    <span class="koboSpan" id="kobo.79.1">
     Tracebacks
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.80.1">
     The
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.81.1">
      traceback
     </span>
    </strong>
    <span class="koboSpan" id="kobo.82.1">
     that Python prints
    </span>
    <a id="_idIndexMarker707">
    </a>
    <span class="koboSpan" id="kobo.83.1">
     when an unhandled exception occurs may initially look intimidating, but it is quite useful for understanding what happened to cause the exception.
    </span>
    <span class="koboSpan" id="kobo.83.2">
     For this example, we are using a mathematical formula to solve quadratic equations; it is not important if you are not familiar with it, as you do not need to understand it.
    </span>
    <span class="koboSpan" id="kobo.83.3">
     Let us look at a traceback and see what it can tell us:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.84.1"># exceptions/trace.back.py</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.85.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.86.1">squareroot</span></span><span class="koboSpan" id="kobo.87.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.88.1">number</span></span><span class="koboSpan" id="kobo.89.1">):
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.90.1">if</span></span><span class="koboSpan" id="kobo.91.1"> number &lt; </span><span class="hljs-number"><span class="koboSpan" id="kobo.92.1">0</span></span><span class="koboSpan" id="kobo.93.1">:
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.94.1">raise</span></span><span class="koboSpan" id="kobo.95.1"> ValueError("No negative numbers please") 
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.96.1">return</span></span><span class="koboSpan" id="kobo.97.1"> number**</span><span class="hljs-number"><span class="koboSpan" id="kobo.98.1">.5</span></span>
 
<span class="hljs-keyword"><span class="koboSpan" id="kobo.99.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.100.1">quadratic</span></span><span class="koboSpan" id="kobo.101.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.102.1">a, b, c</span></span><span class="koboSpan" id="kobo.103.1">):
    d = b**</span><span class="hljs-number"><span class="koboSpan" id="kobo.104.1">2</span></span><span class="koboSpan" id="kobo.105.1"> - </span><span class="hljs-number"><span class="koboSpan" id="kobo.106.1">4</span></span><span class="koboSpan" id="kobo.107.1"> * a * c
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.108.1">return</span></span><span class="koboSpan" id="kobo.109.1"> (
        (-b - squareroot(d)) / (</span><span class="hljs-number"><span class="koboSpan" id="kobo.110.1">2</span></span><span class="koboSpan" id="kobo.111.1"> * a),
        (-b + squareroot(d)) / (</span><span class="hljs-number"><span class="koboSpan" id="kobo.112.1">2</span></span><span class="koboSpan" id="kobo.113.1"> * a)
    )
quadratic(</span><span class="hljs-number"><span class="koboSpan" id="kobo.114.1">1</span></span><span class="koboSpan" id="kobo.115.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.116.1">0</span></span><span class="koboSpan" id="kobo.117.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.118.1">1</span></span><span class="koboSpan" id="kobo.119.1">)  </span><span class="hljs-comment"><span class="koboSpan" id="kobo.120.1"># x**2 + 1 == 0</span></span>
</code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.121.1">
     Here, we defined a function called
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.122.1">
      quadratic()
     </span>
    </code>
    <span class="koboSpan" id="kobo.123.1">
     , which uses the famous quadratic formula to find the solution of a quadratic equation.
    </span>
    <span class="koboSpan" id="kobo.123.2">
     Instead of using the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.124.1">
      sqrt()
     </span>
    </code>
    <span class="koboSpan" id="kobo.125.1">
     function from the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.126.1">
      math
     </span>
    </code>
    <span class="koboSpan" id="kobo.127.1">
     module, we
    </span>
    <a id="_idIndexMarker708">
    </a>
    <span class="koboSpan" id="kobo.128.1">
     wrote our own version (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.129.1">
      squareroot()
     </span>
    </code>
    <span class="koboSpan" id="kobo.130.1">
     ), which raises an exception if the number is negative.
    </span>
    <span class="koboSpan" id="kobo.130.2">
     When we call
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.131.1">
      quadratic(1, 0, 1)
     </span>
    </code>
    <span class="koboSpan" id="kobo.132.1">
     to solve the equation
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.133.1">
      x
     </span>
    </em>
    <sup class="superscript-italic" style="font-style: italic;">
     <span class="koboSpan" id="kobo.134.1">
      2
     </span>
    </sup>
    <em class="italic">
     <span class="koboSpan" id="kobo.135.1">
      +1=0
     </span>
    </em>
    <span class="koboSpan" id="kobo.136.1">
     , we will get a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.137.1">
      ValueError
     </span>
    </code>
    <span class="koboSpan" id="kobo.138.1">
     because
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.139.1">
      d
     </span>
    </code>
    <span class="koboSpan" id="kobo.140.1">
     is negative.
    </span>
    <span class="koboSpan" id="kobo.140.2">
     When we run this, we get the following:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.141.1">$ python exceptions/trace.back.py
Traceback (most recent call last):
  File "exceptions/trace.back.py", line 16, in &lt;module&gt;
    quadratic(1, 0, 1)  # x**2 + 1 == 0
    ^^^^^^^^^^^^^^^^^^
  File "exceptions/trace.back.py", line 11, in quadratic
    (-b - squareroot(d)) / (2 * a),
          ^^^^^^^^^^^^^
  File "exceptions/trace.back.py", line 4, in squareroot
    raise ValueError("No negative numbers please")
ValueError: No negative numbers please
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.142.1">
     It is often useful to read tracebacks from bottom to top.
    </span>
    <span class="koboSpan" id="kobo.142.2">
     On the very last line, we have the error message, telling us what went wrong:
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.143.1">
      ValueError: No negative numbers please
     </span>
    </code>
    <span class="koboSpan" id="kobo.144.1">
     .
    </span>
    <span class="koboSpan" id="kobo.144.2">
     The preceding lines tell us where the exception was raised (line 4 of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.145.1">
      exceptions/trace.back.py
     </span>
    </code>
    <span class="koboSpan" id="kobo.146.1">
     in the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.147.1">
      squareroot()
     </span>
    </code>
    <span class="koboSpan" id="kobo.148.1">
     function).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.149.1">
     We can also see the sequence of function calls that got us to the point where the exception was raised:
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.150.1">
      squareroot()
     </span>
    </code>
    <span class="koboSpan" id="kobo.151.1">
     was called on line 11 by the function
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.152.1">
      quadratic()
     </span>
    </code>
    <span class="koboSpan" id="kobo.153.1">
     , which was called on line 16, at the top level of the module.
    </span>
    <span class="koboSpan" id="kobo.153.2">
     As you can see, the traceback is like a map that shows us the path through the code to where the exception happened.
    </span>
    <span class="koboSpan" id="kobo.153.3">
     Following that path and examining the code in each function along the way is often helpful when you want to understand why an exception happened.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.154.1">
      There have been several improvements to error messages in Python 3.10, 3.11, and 3.12.
     </span>
     <span class="koboSpan" id="kobo.154.2">
      For example, the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.155.1">
       ^^^^
      </span>
     </code>
     <span class="koboSpan" id="kobo.156.1">
      characters underlining the exact part of each statement or expression in the traceback that led to the exception were added in Python 3.11.
     </span>
    </p>
   </div>
   <h2 class="heading-2" id="_idParaDest-214">
    <span class="koboSpan" id="kobo.157.1">
     Handling exceptions
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.158.1">
     To handle an exception in
    </span>
    <a id="_idIndexMarker709">
    </a>
    <span class="koboSpan" id="kobo.159.1">
     Python, you use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.160.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.161.1">
     statement.
    </span>
    <span class="koboSpan" id="kobo.161.2">
     When you enter the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.162.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.163.1">
     clause, Python will watch out for one or more different types of exceptions (according to how you instruct it), and if they are raised, it allows you to react.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.164.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.165.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.166.1">
     statement is composed of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.167.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.168.1">
     clause, which opens the statement, followed by one or more
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.169.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.170.1">
     clauses that define what to do when an exception is caught.
    </span>
    <span class="koboSpan" id="kobo.170.2">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.171.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.172.1">
     clauses may optionally be followed by an
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.173.1">
      else
     </span>
    </code>
    <span class="koboSpan" id="kobo.174.1">
     clause, which is executed when the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.175.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.176.1">
     clause is exited without any exception raised.
    </span>
    <span class="koboSpan" id="kobo.176.2">
     After the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.177.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.178.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.179.1">
      else
     </span>
    </code>
    <span class="koboSpan" id="kobo.180.1">
     clauses, we can have a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.181.1">
      finally
     </span>
    </code>
    <span class="koboSpan" id="kobo.182.1">
     clause (also optional), whose code is executed regardless of whatever happened in the other clauses.
    </span>
    <span class="koboSpan" id="kobo.182.2">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.183.1">
      finally
     </span>
    </code>
    <span class="koboSpan" id="kobo.184.1">
     clause is typically used to clean up resources.
    </span>
    <span class="koboSpan" id="kobo.184.2">
     You are also allowed to omit the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.185.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.186.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.187.1">
      else
     </span>
    </code>
    <span class="koboSpan" id="kobo.188.1">
     clauses and only have a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.189.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.190.1">
     clause followed by a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.191.1">
      finally
     </span>
    </code>
    <span class="koboSpan" id="kobo.192.1">
     clause.
    </span>
    <span class="koboSpan" id="kobo.192.2">
     This is helpful if we want exceptions to be propagated and handled elsewhere, but we do have some cleanup code that must be executed regardless of whether an exception occurs.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.193.1">
     The order of the clauses is important.
    </span>
    <span class="koboSpan" id="kobo.193.2">
     It must be
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.194.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.195.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.196.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.197.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.198.1">
      else
     </span>
    </code>
    <span class="koboSpan" id="kobo.199.1">
     , then
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.200.1">
      finally
     </span>
    </code>
    <span class="koboSpan" id="kobo.201.1">
     .
    </span>
    <span class="koboSpan" id="kobo.201.2">
     Also, remember that
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.202.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.203.1">
     must be followed by at least one
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.204.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.205.1">
     clause or a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.206.1">
      finally
     </span>
    </code>
    <span class="koboSpan" id="kobo.207.1">
     clause.
    </span>
    <span class="koboSpan" id="kobo.207.2">
     Let us see an example:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.208.1"># exceptions/try.syntax.py </span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.209.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.210.1">try_syntax</span></span><span class="koboSpan" id="kobo.211.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.212.1">numerator, denominator</span></span><span class="koboSpan" id="kobo.213.1">): 
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.214.1">try</span></span><span class="koboSpan" id="kobo.215.1">: 
        </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.216.1">print</span></span><span class="koboSpan" id="kobo.217.1">(f"In the </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.218.1">try</span></span><span class="koboSpan" id="kobo.219.1"> block: {numerator}/{denominator}") 
        result = numerator / denominator 
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.220.1">except</span></span><span class="koboSpan" id="kobo.221.1"> ZeroDivisionError </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.222.1">as</span></span><span class="koboSpan" id="kobo.223.1"> zde: 
        </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.224.1">print</span></span><span class="koboSpan" id="kobo.225.1">(zde) 
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.226.1">else</span></span><span class="koboSpan" id="kobo.227.1">: 
        </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.228.1">print</span></span><span class="koboSpan" id="kobo.229.1">("The result </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.230.1">is</span></span><span class="koboSpan" id="kobo.231.1">:", result) 
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.232.1">return</span></span><span class="koboSpan" id="kobo.233.1"> result 
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.234.1">finally</span></span><span class="koboSpan" id="kobo.235.1">: 
        </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.236.1">print</span></span><span class="koboSpan" id="kobo.237.1">("Exiting")
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.238.1">print</span></span><span class="koboSpan" id="kobo.239.1">(try_syntax(</span><span class="hljs-number"><span class="koboSpan" id="kobo.240.1">12</span></span><span class="koboSpan" id="kobo.241.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.242.1">4</span></span><span class="koboSpan" id="kobo.243.1">)) 
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.244.1">print</span></span><span class="koboSpan" id="kobo.245.1">(try_syntax(</span><span class="hljs-number"><span class="koboSpan" id="kobo.246.1">11</span></span><span class="koboSpan" id="kobo.247.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.248.1">0</span></span><span class="koboSpan" id="kobo.249.1">))
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.250.1">
     This example defines a
    </span>
    <a id="_idIndexMarker710">
    </a>
    <span class="koboSpan" id="kobo.251.1">
     simple
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.252.1">
      try_syntax()
     </span>
    </code>
    <span class="koboSpan" id="kobo.253.1">
     function.
    </span>
    <span class="koboSpan" id="kobo.253.2">
     We perform the division of two numbers.
    </span>
    <span class="koboSpan" id="kobo.253.3">
     We are prepared to catch a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.254.1">
      ZeroDivisionError
     </span>
    </code>
    <span class="koboSpan" id="kobo.255.1">
     exception, which will occur if we call the function with
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.256.1">
      denominator = 0
     </span>
    </code>
    <span class="koboSpan" id="kobo.257.1">
     .
    </span>
    <span class="koboSpan" id="kobo.257.2">
     Initially, the code enters the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.258.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.259.1">
     block.
    </span>
    <span class="koboSpan" id="kobo.259.2">
     If
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.260.1">
      denominator
     </span>
    </code>
    <span class="koboSpan" id="kobo.261.1">
     is not
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.262.1">
      0
     </span>
    </code>
    <span class="koboSpan" id="kobo.263.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.264.1">
      result
     </span>
    </code>
    <span class="koboSpan" id="kobo.265.1">
     is calculated and, after leaving the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.266.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.267.1">
     block, execution resumes in the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.268.1">
      else
     </span>
    </code>
    <span class="koboSpan" id="kobo.269.1">
     block.
    </span>
    <span class="koboSpan" id="kobo.269.2">
     We print
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.270.1">
      result
     </span>
    </code>
    <span class="koboSpan" id="kobo.271.1">
     and return it.
    </span>
    <span class="koboSpan" id="kobo.271.2">
     Take a look at the output, and you’ll notice that just before returning
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.272.1">
      result
     </span>
    </code>
    <span class="koboSpan" id="kobo.273.1">
     , which is the exit point of the function, Python executes the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.274.1">
      finally
     </span>
    </code>
    <span class="koboSpan" id="kobo.275.1">
     clause.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.276.1">
     When
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.277.1">
      denominator
     </span>
    </code>
    <span class="koboSpan" id="kobo.278.1">
     is
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.279.1">
      0
     </span>
    </code>
    <span class="koboSpan" id="kobo.280.1">
     , things change.
    </span>
    <span class="koboSpan" id="kobo.280.2">
     Our attempt to calculate
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.281.1">
      numerator / denominator
     </span>
    </code>
    <span class="koboSpan" id="kobo.282.1">
     raises a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.283.1">
      ZeroDivisionError
     </span>
    </code>
    <span class="koboSpan" id="kobo.284.1">
     .
    </span>
    <span class="koboSpan" id="kobo.284.2">
     As a result, we enter the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.285.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.286.1">
     block and print
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.287.1">
      zde
     </span>
    </code>
    <span class="koboSpan" id="kobo.288.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.289.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.290.1">
      else
     </span>
    </code>
    <span class="koboSpan" id="kobo.291.1">
     block is not executed because an exception was raised in the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.292.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.293.1">
     block.
    </span>
    <span class="koboSpan" id="kobo.293.2">
     Before (implicitly) returning
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.294.1">
      None
     </span>
    </code>
    <span class="koboSpan" id="kobo.295.1">
     , we still execute the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.296.1">
      finally
     </span>
    </code>
    <span class="koboSpan" id="kobo.297.1">
     block.
    </span>
    <span class="koboSpan" id="kobo.297.2">
     Look at the output and see whether it makes sense to you:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.298.1">$ python exceptions/try.syntax.py 
In the try block: 12/4 
The result is: 3.0 
Exiting 
3.0 
In the try block: 11/0 
division by zero 
Exiting 
None
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.299.1">
     When you execute a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.300.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.301.1">
     block, you may want to catch more than one exception.
    </span>
    <span class="koboSpan" id="kobo.301.2">
     For example, when calling the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.302.1">
      divmod()
     </span>
    </code>
    <span class="koboSpan" id="kobo.303.1">
     function, you can get a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.304.1">
      ZeroDivisionError
     </span>
    </code>
    <span class="koboSpan" id="kobo.305.1">
     if the second argument is
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.306.1">
      0
     </span>
    </code>
    <span class="koboSpan" id="kobo.307.1">
     , or
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.308.1">
      TypeError
     </span>
    </code>
    <span class="koboSpan" id="kobo.309.1">
     if either argument is not a number.
    </span>
    <span class="koboSpan" id="kobo.309.2">
     If you want to handle both in the same way, you can structure your code like this:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.310.1"># exceptions/multiple.py</span></span><span class="koboSpan" id="kobo.311.1">
values = (</span><span class="hljs-number"><span class="koboSpan" id="kobo.312.1">1</span></span><span class="koboSpan" id="kobo.313.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.314.1">2</span></span><span class="koboSpan" id="kobo.315.1">)
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.316.1">try</span></span><span class="koboSpan" id="kobo.317.1">:
    q, r = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.318.1">divmod</span></span><span class="koboSpan" id="kobo.319.1">(*values)
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.320.1">except</span></span><span class="koboSpan" id="kobo.321.1"> (ZeroDivisionError, TypeError) </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.322.1">as</span></span><span class="koboSpan" id="kobo.323.1"> e:
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.324.1">print</span></span><span class="koboSpan" id="kobo.325.1">(</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.326.1">type</span></span><span class="koboSpan" id="kobo.327.1">(e), e)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.328.1">
     This code will catch both
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.329.1">
      ZeroDivisionError
     </span>
    </code>
    <span class="koboSpan" id="kobo.330.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.331.1">
      TypeError
     </span>
    </code>
    <span class="koboSpan" id="kobo.332.1">
     .
    </span>
    <span class="koboSpan" id="kobo.332.2">
     Try changing
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.333.1">
      values = (1, 2)
     </span>
    </code>
    <span class="koboSpan" id="kobo.334.1">
     to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.335.1">
      values = (1, 0)
     </span>
    </code>
    <span class="koboSpan" id="kobo.336.1">
     or
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.337.1">
      values = ('one', 2)
     </span>
    </code>
    <span class="koboSpan" id="kobo.338.1">
     , and you will see the output change.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.339.1">
     If you need to handle different exception types differently, you can use multiple
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.340.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.341.1">
     clauses, like this:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.342.1"># exceptions/multiple.py </span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.343.1">try</span></span><span class="koboSpan" id="kobo.344.1">:
    q, r = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.345.1">divmod</span></span><span class="koboSpan" id="kobo.346.1">(*values)
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.347.1">except</span></span><span class="koboSpan" id="kobo.348.1"> ZeroDivisionError:
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.349.1">print</span></span><span class="koboSpan" id="kobo.350.1">("You tried to divide by zero!")
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.351.1">except</span></span><span class="koboSpan" id="kobo.352.1"> TypeError </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.353.1">as</span></span><span class="koboSpan" id="kobo.354.1"> e:
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.355.1">print</span></span><span class="koboSpan" id="kobo.356.1">(e)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.357.1">
     Keep in mind that an
    </span>
    <a id="_idIndexMarker711">
    </a>
    <span class="koboSpan" id="kobo.358.1">
     exception is handled in the first block that matches that exception class or any of its base classes.
    </span>
    <span class="koboSpan" id="kobo.358.2">
     Therefore, when you stack multiple
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.359.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.360.1">
     clauses like we have done here, make sure that you put specific exceptions at the top and generic ones at the bottom.
    </span>
    <span class="koboSpan" id="kobo.360.2">
     In OOP terms, derived classes should be placed before their base classes.
    </span>
    <span class="koboSpan" id="kobo.360.3">
     Moreover, remember that only one
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.361.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.362.1">
     handler is executed when an exception is raised.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.363.1">
      Python also allows you to use an
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.364.1">
       except
      </span>
     </code>
     <span class="koboSpan" id="kobo.365.1">
      clause without specifying any exception type (this is equivalent to writing
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.366.1">
       except BaseException
      </span>
     </code>
     <span class="koboSpan" id="kobo.367.1">
      ).
     </span>
     <span class="koboSpan" id="kobo.367.2">
      You should, however, avoid doing this as it means you will also capture exceptions that are intended for internal use by the interpreter.
     </span>
     <span class="koboSpan" id="kobo.367.3">
      They include the so-called
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.368.1">
       system-exiting exceptions
      </span>
     </em>
     <span class="koboSpan" id="kobo.369.1">
      .
     </span>
     <span class="koboSpan" id="kobo.369.2">
      These are
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.370.1">
       SystemExit
      </span>
     </code>
     <span class="koboSpan" id="kobo.371.1">
      , which is raised when the interpreter exits via a call to the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.372.1">
       exit()
      </span>
     </code>
     <span class="koboSpan" id="kobo.373.1">
      function, and
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.374.1">
       KeyboardInterrupt
      </span>
     </code>
     <span class="koboSpan" id="kobo.375.1">
      , which is raised when the user terminates the application by pressing
     </span>
     <em class="keystroke">
      <span class="koboSpan" id="kobo.376.1">
       Ctrl
      </span>
     </em>
     <span class="koboSpan" id="kobo.377.1">
      +
     </span>
     <em class="keystroke">
      <span class="koboSpan" id="kobo.378.1">
       C
      </span>
     </em>
     <span class="koboSpan" id="kobo.379.1">
      (or
     </span>
     <em class="keystroke">
      <span class="koboSpan" id="kobo.380.1">
       Delete
      </span>
     </em>
     <span class="koboSpan" id="kobo.381.1">
      on some systems).
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.382.1">
     You can also raise exceptions from within an
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.383.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.384.1">
     clause.
    </span>
    <span class="koboSpan" id="kobo.384.2">
     For example, you might want to replace a built-in exception (or one from a third-party library) with your own custom exception.
    </span>
    <span class="koboSpan" id="kobo.384.3">
     This is quite a common technique when writing libraries, as it helps shield users from the implementation details of the library.
    </span>
    <span class="koboSpan" id="kobo.384.4">
     Let us see an example:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.385.1"># exceptions/replace.txt
&gt;&gt;&gt; class NotFoundError(Exception):
...     </span><span class="koboSpan" id="kobo.385.2">pass
...
</span><span class="koboSpan" id="kobo.385.3">&gt;&gt;&gt; vowels = {"a": 1, "e": 5, "i": 9, "o": 15, "u": 21}
&gt;&gt;&gt; try:
...     </span><span class="koboSpan" id="kobo.385.4">pos = vowels["y"]
... </span><span class="koboSpan" id="kobo.385.5">except KeyError as e:
...     </span><span class="koboSpan" id="kobo.385.6">raise NotFoundError(*e.args)
...
</span><span class="koboSpan" id="kobo.385.7">Traceback (most recent call last):
  File "&lt;stdin&gt;", line 2, in &lt;module&gt;
KeyError: 'y'
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 4, in &lt;module&gt;
NotFoundError: y
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.386.1">
     By default, Python assumes that an exception that happens within an
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.387.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.388.1">
     clause is an unexpected error and helpfully prints out tracebacks for both exceptions.
    </span>
    <span class="koboSpan" id="kobo.388.2">
     We can tell the interpreter that we are deliberately raising the new exception by using a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.389.1">
      raise from
     </span>
    </code>
    <span class="koboSpan" id="kobo.390.1">
     statement:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.391.1"># exceptions/replace.py
&gt;&gt;&gt; try:
...     </span><span class="koboSpan" id="kobo.391.2">pos = vowels["y"]
... </span><span class="koboSpan" id="kobo.391.3">except KeyError as e:
...     </span><span class="koboSpan" id="kobo.391.4">raise NotFoundError(*e.args) from e
...
</span><span class="koboSpan" id="kobo.391.5">Traceback (most recent call last):
  File "&lt;stdin&gt;", line 2, in &lt;module&gt;
KeyError: 'y'
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 4, in &lt;module&gt;
NotFoundError: y
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.392.1">
     The error message has
    </span>
    <a id="_idIndexMarker712">
    </a>
    <span class="koboSpan" id="kobo.393.1">
     changed, but we still get both tracebacks, which is very handy for debugging.
    </span>
    <span class="koboSpan" id="kobo.393.2">
     If you really wanted to completely suppress the original exception, you could use
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.394.1">
      from None
     </span>
    </code>
    <span class="koboSpan" id="kobo.395.1">
     instead of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.396.1">
      from e
     </span>
    </code>
    <span class="koboSpan" id="kobo.397.1">
     (try this yourself).
    </span>
   </p>
   <div class="packt_tip">
    <p class="normal">
     <span class="koboSpan" id="kobo.398.1">
      You can also use
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.399.1">
       raise
      </span>
     </code>
     <span class="koboSpan" id="kobo.400.1">
      by itself, without specifying a new exception, to re-raise the original exception.
     </span>
     <span class="koboSpan" id="kobo.400.2">
      This is sometimes useful if you want to log the fact that an exception has occurred without suppressing or replacing the exception.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.401.1">
     Since Python 3.11, it is also possible to add notes to exceptions.
    </span>
    <span class="koboSpan" id="kobo.401.2">
     This allows you to add extra information to be displayed as part of the traceback without suppressing or replacing the original exception.
    </span>
    <span class="koboSpan" id="kobo.401.3">
     To see how this works, we will modify the quadratic formula example from earlier in the chapter, and add a note to the exception:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.402.1"># exceptions/note.py</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.403.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.404.1">squareroot</span></span><span class="koboSpan" id="kobo.405.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.406.1">number</span></span><span class="koboSpan" id="kobo.407.1">):
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.408.1">if</span></span><span class="koboSpan" id="kobo.409.1"> number &lt; </span><span class="hljs-number"><span class="koboSpan" id="kobo.410.1">0</span></span><span class="koboSpan" id="kobo.411.1">:
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.412.1">raise</span></span><span class="koboSpan" id="kobo.413.1"> ValueError("No negative numbers please")
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.414.1">return</span></span><span class="koboSpan" id="kobo.415.1"> number**</span><span class="hljs-number"><span class="koboSpan" id="kobo.416.1">0.5</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.417.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.418.1">quadratic</span></span><span class="koboSpan" id="kobo.419.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.420.1">a, b, c</span></span><span class="koboSpan" id="kobo.421.1">):
    d = b**</span><span class="hljs-number"><span class="koboSpan" id="kobo.422.1">2</span></span><span class="koboSpan" id="kobo.423.1"> - </span><span class="hljs-number"><span class="koboSpan" id="kobo.424.1">4</span></span><span class="koboSpan" id="kobo.425.1"> * a * c
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.426.1">try</span></span><span class="koboSpan" id="kobo.427.1">:
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.428.1">return</span></span><span class="koboSpan" id="kobo.429.1"> (
            (-b - squareroot(d)) / (</span><span class="hljs-number"><span class="koboSpan" id="kobo.430.1">2</span></span><span class="koboSpan" id="kobo.431.1"> * a),
            (-b + squareroot(d)) / (</span><span class="hljs-number"><span class="koboSpan" id="kobo.432.1">2</span></span><span class="koboSpan" id="kobo.433.1"> * a),
        )
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.434.1">except</span></span><span class="koboSpan" id="kobo.435.1"> ValueError </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.436.1">as</span></span><span class="koboSpan" id="kobo.437.1"> e:
        </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.438.1">e.add_note(f"Cannot solve {a}x**</span></strong><strong class="hljs-number-slc"><span class="koboSpan" id="kobo.439.1">2</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.440.1"> + {b}x + {c} == </span></strong><strong class="hljs-number-slc"><span class="koboSpan" id="kobo.441.1">0</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.442.1">")</span></strong></span>
        <span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.443.1">raise</span></strong></span><span class="koboSpan" id="kobo.444.1">
quadratic(</span><span class="hljs-number"><span class="koboSpan" id="kobo.445.1">1</span></span><span class="koboSpan" id="kobo.446.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.447.1">0</span></span><span class="koboSpan" id="kobo.448.1">, </span><span class="hljs-number"><span class="koboSpan" id="kobo.449.1">1</span></span><span class="koboSpan" id="kobo.450.1">)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.451.1">
     We have highlighted the
    </span>
    <a id="_idIndexMarker713">
    </a>
    <span class="koboSpan" id="kobo.452.1">
     lines where we added a note and re-raised the exception.
    </span>
    <span class="koboSpan" id="kobo.452.2">
     The output when we run this looks as follows:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.453.1">$ python exceptions/note.py
Traceback (most recent call last):
  File "exceptions/note.py", line 20, in &lt;module&gt;
    quadratic(1, 0, 1)
  File "exceptions/note.py", line 12, in quadratic
    (-b - squareroot(d)) / (2 * a),
          ^^^^^^^^^^^^^
  File "exceptions/note.py", line 4, in squareroot
    raise ValueError("No negative numbers please")
ValueError: No negative numbers please
Cannot solve 1x**2 + 0x + 1 == 0
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.454.1">
     The note has been printed below the original error message.
    </span>
    <span class="koboSpan" id="kobo.454.2">
     You can add as many notes as you need, by calling
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.455.1">
      add_note()
     </span>
    </code>
    <span class="koboSpan" id="kobo.456.1">
     multiple times.
    </span>
    <span class="koboSpan" id="kobo.456.2">
     The notes must all be strings.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.457.1">
     Programming with exceptions can be tricky.
    </span>
    <span class="koboSpan" id="kobo.457.2">
     You could inadvertently hide bugs by trapping exceptions that would have alerted you to their presence.
    </span>
    <span class="koboSpan" id="kobo.457.3">
     Play it safe by keeping these simple guidelines in mind:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.458.1">
      Keep the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.459.1">
       try
      </span>
     </code>
     <span class="koboSpan" id="kobo.460.1">
      clause as short as possible.
     </span>
     <span class="koboSpan" id="kobo.460.2">
      It should contain only the code that may cause the exception(s) that you want to handle.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.461.1">
      Make the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.462.1">
       except
      </span>
     </code>
     <span class="koboSpan" id="kobo.463.1">
      clauses as specific as you can.
     </span>
     <span class="koboSpan" id="kobo.463.2">
      It may be tempting to just write
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.464.1">
       except Exception
      </span>
     </code>
     <span class="koboSpan" id="kobo.465.1">
      , but if you do, you will almost certainly end up catching exceptions you did not actually intend to catch.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.466.1">
      Use tests to ensure that your code handles both expected and unexpected errors correctly.
     </span>
     <span class="koboSpan" id="kobo.466.2">
      We
     </span>
     <a id="_idIndexMarker714">
     </a>
     <span class="koboSpan" id="kobo.467.1">
      shall talk more about writing tests in
     </span>
     <em class="chapterRef">
      <span class="koboSpan" id="kobo.468.1">
       Chapter 10, Testing
      </span>
     </em>
     <span class="koboSpan" id="kobo.469.1">
      .
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.470.1">
     If you follow these suggestions, you will minimize the chance of getting it wrong.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-215">
    <span class="koboSpan" id="kobo.471.1">
     Exception groups
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.472.1">
     When working with large
    </span>
    <a id="_idIndexMarker715">
    </a>
    <span class="koboSpan" id="kobo.473.1">
     collections of data, it can be inconvenient to immediately stop and raise an exception when an error occurs.
    </span>
    <span class="koboSpan" id="kobo.473.2">
     It is often better to process all the data and report on all errors that occurred at the end.
    </span>
    <span class="koboSpan" id="kobo.473.3">
     This allows the user to deal with all the errors at once, rather than having to rerun the process multiple times, fixing errors one by one.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.474.1">
     One way of achieving this is to build up a list of errors and return it.
    </span>
    <span class="koboSpan" id="kobo.474.2">
     However, this has the disadvantage that you cannot use a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.475.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.476.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.477.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.478.1">
     statement to handle the errors.
    </span>
    <span class="koboSpan" id="kobo.478.2">
     Some libraries have worked around this by creating a container exception class and wrapping the collected errors in an instance of this class.
    </span>
    <span class="koboSpan" id="kobo.478.3">
     This allows you to handle the container exception in an
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.479.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.480.1">
     clause and inspect it to access the nested exceptions.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.481.1">
     Since Python 3.11, there is a new built-in exception class,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.482.1">
      ExceptionGroup
     </span>
    </code>
    <span class="koboSpan" id="kobo.483.1">
     , that was specifically designed as such a container exception.
    </span>
    <span class="koboSpan" id="kobo.483.2">
     Having this feature built into the language has the advantage that the traceback also shows the tracebacks of each of the nested exceptions.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.484.1">
     For example, suppose we need to validate a list of ages to ensure that the values are all positive integers.
    </span>
    <span class="koboSpan" id="kobo.484.2">
     We could write something like the following:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.485.1"># exceptions/groups/util.py</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.486.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.487.1">validate_age</span></span><span class="koboSpan" id="kobo.488.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.489.1">age</span></span><span class="koboSpan" id="kobo.490.1">):
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.491.1">if</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.492.1">not</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.493.1">isinstance</span></span><span class="koboSpan" id="kobo.494.1">(age, </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.495.1">int</span></span><span class="koboSpan" id="kobo.496.1">):
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.497.1">raise</span></span><span class="koboSpan" id="kobo.498.1"> TypeError(f"Not an integer: {age}")
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.499.1">if</span></span><span class="koboSpan" id="kobo.500.1"> age &lt; </span><span class="hljs-number"><span class="koboSpan" id="kobo.501.1">0</span></span><span class="koboSpan" id="kobo.502.1">:
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.503.1">raise</span></span><span class="koboSpan" id="kobo.504.1"> ValueError(f"Negative age: {age}")
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.505.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.506.1">validate_ages</span></span><span class="koboSpan" id="kobo.507.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.508.1">ages</span></span><span class="koboSpan" id="kobo.509.1">):
    errors = []
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.510.1">for</span></span><span class="koboSpan" id="kobo.511.1"> age </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.512.1">in</span></span><span class="koboSpan" id="kobo.513.1"> ages:
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.514.1">try</span></span><span class="koboSpan" id="kobo.515.1">:
            validate_age(age)
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.516.1">except</span></span><span class="koboSpan" id="kobo.517.1"> Exception </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.518.1">as</span></span><span class="koboSpan" id="kobo.519.1"> e:
            errors.append(e)
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.520.1">if</span></span><span class="koboSpan" id="kobo.521.1"> errors:
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.522.1">raise</span></span><span class="koboSpan" id="kobo.523.1"> ExceptionGroup("Validation errors", errors)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.524.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.525.1">
      validate_ages()
     </span>
    </code>
    <span class="koboSpan" id="kobo.526.1">
     function calls
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.527.1">
      validate_age()
     </span>
    </code>
    <span class="koboSpan" id="kobo.528.1">
     for each element of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.529.1">
      ages
     </span>
    </code>
    <span class="koboSpan" id="kobo.530.1">
     .
    </span>
    <span class="koboSpan" id="kobo.530.2">
     It catches any exceptions that occur and appends them to the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.531.1">
      errors
     </span>
    </code>
    <span class="koboSpan" id="kobo.532.1">
     list.
    </span>
    <span class="koboSpan" id="kobo.532.2">
     If the list of errors is not empty after the loops complete, we raise
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.533.1">
      ExceptionGroup
     </span>
    </code>
    <span class="koboSpan" id="kobo.534.1">
     , passing in the error message
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.535.1">
      "Validation errors"
     </span>
    </code>
    <span class="koboSpan" id="kobo.536.1">
     and the list of errors that occurred.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.537.1">
     If we call this from a Python console
    </span>
    <a id="_idIndexMarker716">
    </a>
    <span class="koboSpan" id="kobo.538.1">
     with a list containing some invalid ages, we get the following traceback:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.539.1"># exceptions/groups/exc.group.txt
&gt;&gt;&gt; from util import validate_ages
&gt;&gt;&gt; validate_ages([24, -5, "ninety", 30, None])
  + Exception Group Traceback (most recent call last):
  |   File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  |   File "exceptions/groups/util.py", line 20, in validate_ages
  |     raise ExceptionGroup("Validation errors", errors)
  | ExceptionGroup: Validation errors (3 sub-exceptions)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "exceptions/groups/util.py", line 15, in validate_ages
    |     validate_age(age)
    |   File "exceptions/groups/util.py", line 8, in validate_age
    |     raise ValueError(f"Negative age: {age}")
    | ValueError: Negative age: -5
    +---------------- 2 ----------------
    | Traceback (most recent call last):
    |   File "exceptions/groups/util.py", line 15, in validate_ages
    |     validate_age(age)
    |   File "exceptions/groups/util.py", line 6, in validate_age
    |     raise TypeError(f"Not an integer: {age}")
    | TypeError: Not an integer: ninety
    +---------------- 3 ----------------
    | Traceback (most recent call last):
    |   File "exceptions/groups/util.py", line 15, in validate_ages
    |     validate_age(age)
    |   File "exceptions/groups/util.py", line 6, in validate_age
    |     raise TypeError(f"Not an integer: {age}")
    | TypeError: Not an integer: None
    +------------------------------------
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.540.1">
     Note that we get the traceback for the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.541.1">
      ExceptionGroup
     </span>
    </code>
    <span class="koboSpan" id="kobo.542.1">
     , including the error message we specified when raising it (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.543.1">
      "Validation errors"
     </span>
    </code>
    <span class="koboSpan" id="kobo.544.1">
     ) and an indication that the group contains three sub-exceptions.
    </span>
    <span class="koboSpan" id="kobo.544.2">
     Indented below this, we get the traceback for each of the nested sub-exceptions.
    </span>
    <span class="koboSpan" id="kobo.544.3">
     To aid readability, the sub-exception tracebacks are numbered and separated by dashed lines.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.545.1">
     We can handle
    </span>
    <a id="_idIndexMarker717">
    </a>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.546.1">
      ExceptionGroup
     </span>
    </code>
    <span class="koboSpan" id="kobo.547.1">
     exceptions just like any other type of exception:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.548.1"># exceptions/groups/handle.group.txt
&gt;&gt;&gt; from util import validate_ages
&gt;&gt;&gt; try:
...     </span><span class="koboSpan" id="kobo.548.2">validate_ages([24, -5, "ninety", 30, None])
... </span><span class="koboSpan" id="kobo.548.3">except ExceptionGroup as e:
...     </span><span class="koboSpan" id="kobo.548.4">print(e)
...     </span><span class="koboSpan" id="kobo.548.5">print(e.exceptions)
...
</span><span class="koboSpan" id="kobo.548.6">Validation errors (3 sub-exceptions)
(ValueError('Negative age: -5'),
 TypeError('Not an integer: ninety'),
 TypeError('Not an integer: None'))
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.549.1">
     Note that we can access the nested list of sub-exceptions via the (read-only)
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.550.1">
      exceptions
     </span>
    </code>
    <span class="koboSpan" id="kobo.551.1">
     property.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.552.1">
     PEP 654 (
    </span>
    <a href="https://peps.python.org/pep-0654/">
     <span class="url">
      <span class="koboSpan" id="kobo.553.1">
       https://peps.python.org/pep-0654/
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.554.1">
     ), which introduced
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.555.1">
      ExceptionGroup
     </span>
    </code>
    <span class="koboSpan" id="kobo.556.1">
     to the language, also
    </span>
    <a id="_idIndexMarker718">
    </a>
    <span class="koboSpan" id="kobo.557.1">
     introduced a new variant of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.558.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.559.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.560.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.561.1">
     statement that allows us to handle nested sub-exceptions of particular types within an
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.562.1">
      ExceptionGroup
     </span>
    </code>
    <span class="koboSpan" id="kobo.563.1">
     .
    </span>
    <span class="koboSpan" id="kobo.563.2">
     This new syntax uses the keyword
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.564.1">
      except*
     </span>
    </code>
    <span class="koboSpan" id="kobo.565.1">
     instead of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.566.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.567.1">
     .
    </span>
    <span class="koboSpan" id="kobo.567.2">
     In our validation example, this allows us to have separate handling for invalid types and invalid values without having to manually iterate and filter the exceptions:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.568.1"># exceptions/groups/handle.nested.txt
&gt;&gt;&gt; from util import validate_ages
&gt;&gt;&gt; try:
...     </span><span class="koboSpan" id="kobo.568.2">validate_ages([24, -5, "ninety", 30, None])
... </span><span class="koboSpan" id="kobo.568.3">except* TypeError as e:
...     </span><span class="koboSpan" id="kobo.568.4">print("Invalid types")
...     </span><span class="koboSpan" id="kobo.568.5">print(type(e), e)
...     </span><span class="koboSpan" id="kobo.568.6">print(e.exceptions)
... </span><span class="koboSpan" id="kobo.568.7">except* ValueError as e:
...     </span><span class="koboSpan" id="kobo.568.8">print("Invalid values")
...     </span><span class="koboSpan" id="kobo.568.9">print(type(e), e)
...     </span><span class="koboSpan" id="kobo.568.10">print(e.exceptions)
...
</span><span class="koboSpan" id="kobo.568.11">Invalid types
&lt;class 'ExceptionGroup'&gt; Validation errors (2 sub-exceptions)
(TypeError('Not an integer: ninety'),
 TypeError('Not an integer: None'))
Invalid values
&lt;class 'ExceptionGroup'&gt; Validation errors (1 sub-exception)
(ValueError('Negative age: -5'),)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.569.1">
     The call to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.570.1">
      validate_ages()
     </span>
    </code>
    <span class="koboSpan" id="kobo.571.1">
     raises an exception group containing three exceptions: two instances of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.572.1">
      TypeError
     </span>
    </code>
    <span class="koboSpan" id="kobo.573.1">
     and a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.574.1">
      ValueError
     </span>
    </code>
    <span class="koboSpan" id="kobo.575.1">
     .
    </span>
    <span class="koboSpan" id="kobo.575.2">
     The interpreter matches each
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.576.1">
      except*
     </span>
    </code>
    <span class="koboSpan" id="kobo.577.1">
     clause to the nested exceptions.
    </span>
    <span class="koboSpan" id="kobo.577.2">
     The first clause matches, so the interpreter creates a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.578.1">
      ExceptionGroup
     </span>
    </code>
    <span class="koboSpan" id="kobo.579.1">
     containing all the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.580.1">
      TypeError
     </span>
    </code>
    <span class="koboSpan" id="kobo.581.1">
     instances from the original group and assigns this to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.582.1">
      e
     </span>
    </code>
    <span class="koboSpan" id="kobo.583.1">
     within the body of this clause.
    </span>
    <span class="koboSpan" id="kobo.583.2">
     We print the string
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.584.1">
      "Invalid types"
     </span>
    </code>
    <span class="koboSpan" id="kobo.585.1">
     , followed by the type and value of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.586.1">
      e
     </span>
    </code>
    <span class="koboSpan" id="kobo.587.1">
     and then
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.588.1">
      e.exceptions
     </span>
    </code>
    <span class="koboSpan" id="kobo.589.1">
     .
    </span>
    <span class="koboSpan" id="kobo.589.2">
     The remaining exceptions are then matched against the next
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.590.1">
      except*
     </span>
    </code>
    <span class="koboSpan" id="kobo.591.1">
     clause.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.592.1">
     This time, all the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.593.1">
      ValueError
     </span>
    </code>
    <span class="koboSpan" id="kobo.594.1">
     instances match, so
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.595.1">
      e
     </span>
    </code>
    <span class="koboSpan" id="kobo.596.1">
     is assigned to a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.597.1">
      ExceptionGroup
     </span>
    </code>
    <span class="koboSpan" id="kobo.598.1">
     containing these.
    </span>
    <span class="koboSpan" id="kobo.598.2">
     We print the string
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.599.1">
      "Invalid values"
     </span>
    </code>
    <span class="koboSpan" id="kobo.600.1">
     , again followed by
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.601.1">
      type(e)
     </span>
    </code>
    <span class="koboSpan" id="kobo.602.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.603.1">
      e
     </span>
    </code>
    <span class="koboSpan" id="kobo.604.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.605.1">
      e.exceptions
     </span>
    </code>
    <span class="koboSpan" id="kobo.606.1">
     .
    </span>
    <span class="koboSpan" id="kobo.606.2">
     At this point, there are no unhandled exceptions left in the group, so execution resumes normally.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.607.1">
     It is important to be aware
    </span>
    <a id="_idIndexMarker719">
    </a>
    <span class="koboSpan" id="kobo.608.1">
     that this behavior is different from a normal
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.609.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.610.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.611.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.612.1">
     statement.
    </span>
    <span class="koboSpan" id="kobo.612.2">
     In a normal
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.613.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.614.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.615.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.616.1">
     statement, only one
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.617.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.618.1">
     clause is executed: the first that matches the raised exception.
    </span>
    <span class="koboSpan" id="kobo.618.2">
     In a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.619.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.620.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.621.1">
      except*
     </span>
    </code>
    <span class="koboSpan" id="kobo.622.1">
     statement, each matching
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.623.1">
      except*
     </span>
    </code>
    <span class="koboSpan" id="kobo.624.1">
     clause is executed until there are no unhandled exceptions remaining in the group.
    </span>
    <span class="koboSpan" id="kobo.624.2">
     If any unhandled exceptions remain after all the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.625.1">
      except*
     </span>
    </code>
    <span class="koboSpan" id="kobo.626.1">
     clauses have been processed, they will be reraised at the end as a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.627.1">
      ExceptionGroup
     </span>
    </code>
    <span class="koboSpan" id="kobo.628.1">
     :
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.629.1"># exceptions/groups/handle.nested.txt
&gt;&gt;&gt; try:
...     </span><span class="koboSpan" id="kobo.629.2">validate_ages([24, -5, "ninety", 30, None])
... </span><span class="koboSpan" id="kobo.629.3">except* ValueError as e:
...     </span><span class="koboSpan" id="kobo.629.4">print("Invalid values")
...
</span><span class="koboSpan" id="kobo.629.5">Invalid values
  + Exception Group Traceback (most recent call last):
  |   File "&lt;stdin&gt;", line 2, in &lt;module&gt;
  |   File "exceptions/groups/util.py", line 20, in validate_ages
  |     raise ExceptionGroup("Validation errors", errors)
  | ExceptionGroup: Validation errors (2 sub-exceptions)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "exceptions/groups/util.py", line 15, in validate_ages
    |     validate_age(age)
    |   File "exceptions/groups/util.py", line 6, in validate_age
    |     raise TypeError(f"Not an integer: {age}")
    | TypeError: Not an integer: ninety
    +---------------- 2 ----------------
    | Traceback (most recent call last):
    |   File "exceptions/groups/util.py", line 15, in validate_ages
    |     validate_age(age)
    |   File "exceptions/groups/util.py", line 6, in validate_age
    |     raise TypeError(f"Not an integer: {age}")
    | TypeError: Not an integer: None
    +------------------------------------
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.630.1">
     Another important point
    </span>
    <a id="_idIndexMarker720">
    </a>
    <span class="koboSpan" id="kobo.631.1">
     to note is that if an exception is raised within a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.632.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.633.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.634.1">
      except*
     </span>
    </code>
    <span class="koboSpan" id="kobo.635.1">
     statement that is not an
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.636.1">
      ExceptionGroup
     </span>
    </code>
    <span class="koboSpan" id="kobo.637.1">
     instance, its type will be matched against the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.638.1">
      except*
     </span>
    </code>
    <span class="koboSpan" id="kobo.639.1">
     clauses.
    </span>
    <span class="koboSpan" id="kobo.639.2">
     If a match is found, the exception will be wrapped in an
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.640.1">
      ExceptionGroup
     </span>
    </code>
    <span class="koboSpan" id="kobo.641.1">
     before being passed to the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.642.1">
      except*
     </span>
    </code>
    <span class="koboSpan" id="kobo.643.1">
     body:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.644.1"># exceptions/groups/handle.nested.txt
&gt;&gt;&gt; try:
...     </span><span class="koboSpan" id="kobo.644.2">raise RuntimeError("Ungrouped")
... </span><span class="koboSpan" id="kobo.644.3">except* RuntimeError as e:
...     </span><span class="koboSpan" id="kobo.644.4">print(type(e), e)
...     </span><span class="koboSpan" id="kobo.644.5">print(e.exceptions)
...
</span><span class="koboSpan" id="kobo.644.6">&lt;class 'ExceptionGroup'&gt;  (1 sub-exception)
(RuntimeError('Ungrouped'),)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.645.1">
     This means that it is always safe to assume that the exception being handled within an
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.646.1">
      except*
     </span>
    </code>
    <span class="koboSpan" id="kobo.647.1">
     clause is an
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.648.1">
      ExceptionGroup
     </span>
    </code>
    <span class="koboSpan" id="kobo.649.1">
     instance.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-216">
    <span class="koboSpan" id="kobo.650.1">
     Not only for errors
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.651.1">
     Before we move on to talk about context managers, we want to show you a different use of exceptions.
    </span>
    <span class="koboSpan" id="kobo.651.2">
     In this example, we will demonstrate that exceptions
    </span>
    <a id="_idIndexMarker721">
    </a>
    <span class="koboSpan" id="kobo.652.1">
     can be used for more than just errors:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.653.1"># exceptions/for.loop.py </span></span><span class="koboSpan" id="kobo.654.1">
n = </span><span class="hljs-number"><span class="koboSpan" id="kobo.655.1">100</span></span><span class="koboSpan" id="kobo.656.1"> 
found = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.657.1">False</span></span> 
<span class="hljs-keyword"><span class="koboSpan" id="kobo.658.1">for</span></span><span class="koboSpan" id="kobo.659.1"> a </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.660.1">in</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.661.1">range</span></span><span class="koboSpan" id="kobo.662.1">(n): 
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.663.1">if</span></span><span class="koboSpan" id="kobo.664.1"> found:
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.665.1">break</span></span> 
    <span class="hljs-keyword"><span class="koboSpan" id="kobo.666.1">for</span></span><span class="koboSpan" id="kobo.667.1"> b </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.668.1">in</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.669.1">range</span></span><span class="koboSpan" id="kobo.670.1">(n): 
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.671.1">if</span></span><span class="koboSpan" id="kobo.672.1"> found:
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.673.1">break</span></span> 
        <span class="hljs-keyword"><span class="koboSpan" id="kobo.674.1">for</span></span><span class="koboSpan" id="kobo.675.1"> c </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.676.1">in</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.677.1">range</span></span><span class="koboSpan" id="kobo.678.1">(n): 
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.679.1">if</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.680.1">42</span></span><span class="koboSpan" id="kobo.681.1"> * a + </span><span class="hljs-number"><span class="koboSpan" id="kobo.682.1">17</span></span><span class="koboSpan" id="kobo.683.1"> * b + c == </span><span class="hljs-number"><span class="koboSpan" id="kobo.684.1">5096</span></span><span class="koboSpan" id="kobo.685.1">: 
                found = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.686.1">True</span></span> 
                <span class="hljs-built_in"><span class="koboSpan" id="kobo.687.1">print</span></span><span class="koboSpan" id="kobo.688.1">(a, b, c)  </span><span class="hljs-comment"><span class="koboSpan" id="kobo.689.1"># 79 99 95</span></span>
                <span class="hljs-keyword"><span class="koboSpan" id="kobo.690.1">break</span></span>
</code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.691.1">
     In the code above, we use three nested loops to find a combination of three integers (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.692.1">
      a
     </span>
    </code>
    <span class="koboSpan" id="kobo.693.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.694.1">
      b
     </span>
    </code>
    <span class="koboSpan" id="kobo.695.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.696.1">
      c
     </span>
    </code>
    <span class="koboSpan" id="kobo.697.1">
     ) that satisfy a particular equation.
    </span>
    <span class="koboSpan" id="kobo.697.2">
     At the start of each of the outer loops, we check the value of a flag (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.698.1">
      found
     </span>
    </code>
    <span class="koboSpan" id="kobo.699.1">
     ), which is set to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.700.1">
      True
     </span>
    </code>
    <span class="koboSpan" id="kobo.701.1">
     when we find a solution to the equation.
    </span>
    <span class="koboSpan" id="kobo.701.2">
     This allows us to break out of all three loops as quickly as possible when we have a solution.
    </span>
    <span class="koboSpan" id="kobo.701.3">
     We find the logic to check the flag rather inelegant, as it obscures the rest of the code, so we came up with an alternative approach:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.702.1"># exceptions/for.loop.py </span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.703.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.704.1">ExitLoopException</span></span><span class="koboSpan" id="kobo.705.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.706.1">Exception</span></span><span class="koboSpan" id="kobo.707.1">): 
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.708.1">pass</span></span> 
 
<span class="hljs-keyword"><span class="koboSpan" id="kobo.709.1">try</span></span><span class="koboSpan" id="kobo.710.1">: 
    n = </span><span class="hljs-number"><span class="koboSpan" id="kobo.711.1">100</span></span> 
    <span class="hljs-keyword"><span class="koboSpan" id="kobo.712.1">for</span></span><span class="koboSpan" id="kobo.713.1"> a </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.714.1">in</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.715.1">range</span></span><span class="koboSpan" id="kobo.716.1">(n): 
        </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.717.1">for</span></span><span class="koboSpan" id="kobo.718.1"> b </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.719.1">in</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.720.1">range</span></span><span class="koboSpan" id="kobo.721.1">(n): 
            </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.722.1">for</span></span><span class="koboSpan" id="kobo.723.1"> c </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.724.1">in</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.725.1">range</span></span><span class="koboSpan" id="kobo.726.1">(n): 
                </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.727.1">if</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.728.1">42</span></span><span class="koboSpan" id="kobo.729.1"> * a + </span><span class="hljs-number"><span class="koboSpan" id="kobo.730.1">17</span></span><span class="koboSpan" id="kobo.731.1"> * b + c == </span><span class="hljs-number"><span class="koboSpan" id="kobo.732.1">5096</span></span><span class="koboSpan" id="kobo.733.1">: 
                    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.734.1">raise</span></span><span class="koboSpan" id="kobo.735.1"> ExitLoopException(a, b, c) 
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.736.1">except</span></span><span class="koboSpan" id="kobo.737.1"> ExitLoopException </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.738.1">as</span></span><span class="koboSpan" id="kobo.739.1"> ele: 
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.740.1">print</span></span><span class="koboSpan" id="kobo.741.1">(ele.args)  </span><span class="hljs-comment"><span class="koboSpan" id="kobo.742.1"># (79, 99, 95)</span></span>
</code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.743.1">
     Hopefully, you can appreciate how much more elegant this is.
    </span>
    <span class="koboSpan" id="kobo.743.2">
     Now the breakout logic is entirely handled with a simple exception whose name even hints at its purpose.
    </span>
    <span class="koboSpan" id="kobo.743.3">
     As soon as the result is found, we raise
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.744.1">
      ExitLoopException
     </span>
    </code>
    <span class="koboSpan" id="kobo.745.1">
     with the values that satisfy our condition, and immediately the control
    </span>
    <a id="_idIndexMarker722">
    </a>
    <span class="koboSpan" id="kobo.746.1">
     is given to the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.747.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.748.1">
     clause that handles it.
    </span>
    <span class="koboSpan" id="kobo.748.2">
     Notice that we can use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.749.1">
      args
     </span>
    </code>
    <span class="koboSpan" id="kobo.750.1">
     attribute of the exception to get the values that were passed to the constructor.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.751.1">
     Now we should have a good understanding of what exceptions are, and how they are used to manage errors, flow, and exceptional situations.
    </span>
    <span class="koboSpan" id="kobo.751.2">
     We are ready to move on to the next topic:
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.752.1">
      context managers
     </span>
    </strong>
    <span class="koboSpan" id="kobo.753.1">
     .
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-217">
    <span class="koboSpan" id="kobo.754.1">
     Context managers
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.755.1">
     When working with external resources, we usually need to perform some cleanup steps when we are done.
    </span>
    <span class="koboSpan" id="kobo.755.2">
     For example, after writing data to a file, we then need to close the file.
    </span>
    <span class="koboSpan" id="kobo.755.3">
     Failing to clean up properly could result in all manner of bugs.
    </span>
    <span class="koboSpan" id="kobo.755.4">
     Therefore, we must ensure that our cleanup code will be executed even if an exception happens.
    </span>
    <span class="koboSpan" id="kobo.755.5">
     We could use
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.756.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.757.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.758.1">
      finally
     </span>
    </code>
    <span class="koboSpan" id="kobo.759.1">
     statements, but this is not always convenient and could result in a lot of repetition, as we often have to perform similar cleanup steps whenever we work with a particular type of resource.
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.760.1">
      Context managers
     </span>
    </strong>
    <span class="koboSpan" id="kobo.761.1">
     solve
    </span>
    <a id="_idIndexMarker723">
    </a>
    <span class="koboSpan" id="kobo.762.1">
     this problem by creating an execution context in which we can work with a resource and automatically perform any necessary cleanup when we leave that context, even if an exception was raised.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.763.1">
     Another use case of context managers is to make temporary changes to the global state of our program.
    </span>
    <span class="koboSpan" id="kobo.763.2">
     One example of a global state that we may want to modify temporarily is the precision for decimal computations.
    </span>
    <span class="koboSpan" id="kobo.763.3">
     For example, in data science applications, we sometimes need to perform a particular computation to a specific precision, but we want to retain the default precision for the rest of our computations.
    </span>
    <span class="koboSpan" id="kobo.763.4">
     We could achieve this by doing something like the following:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.764.1"># context/decimal.prec.py</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.765.1">from</span></span><span class="koboSpan" id="kobo.766.1"> decimal </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.767.1">import</span></span><span class="koboSpan" id="kobo.768.1"> Context, Decimal, getcontext, setcontext
one = Decimal(</span><span class="hljs-string"><span class="koboSpan" id="kobo.769.1">"1"</span></span><span class="koboSpan" id="kobo.770.1">)
three = Decimal(</span><span class="hljs-string"><span class="koboSpan" id="kobo.771.1">"3"</span></span><span class="koboSpan" id="kobo.772.1">)
orig_ctx = getcontext()
ctx = Context(prec=</span><span class="hljs-number"><span class="koboSpan" id="kobo.773.1">5</span></span><span class="koboSpan" id="kobo.774.1">)
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.775.1">setcontext(ctx)</span></strong></span>
<span class="hljs-built_in"><span class="koboSpan" id="kobo.776.1">print</span></span><span class="koboSpan" id="kobo.777.1">(f"{ctx}\n")
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.778.1">print</span></span><span class="koboSpan" id="kobo.779.1">("Custom decimal context:", one / three)
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.780.1">setcontext(orig_ctx)</span></strong></span>
<span class="hljs-built_in"><span class="koboSpan" id="kobo.781.1">print</span></span><span class="koboSpan" id="kobo.782.1">("Original context restored:", one / three)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.783.1">
     Notice that we store the current context, set a new context (with a modified precision), perform our calculation, and finally restore the original context.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.784.1">
      You may recall that the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.785.1">
       Decimal
      </span>
     </code>
     <span class="koboSpan" id="kobo.786.1">
      class allows us to perform arbitrary precision computations with decimal numbers.
     </span>
     <span class="koboSpan" id="kobo.786.2">
      If not, you may want to review the relevant section of
     </span>
     <em class="chapterRef">
      <span class="koboSpan" id="kobo.787.1">
       Chapter 2
      </span>
     </em>
     <span class="koboSpan" id="kobo.788.1">
      ,
     </span>
     <em class="chapterRef">
      <span class="koboSpan" id="kobo.789.1">
       Built-In Data Types
      </span>
     </em>
     <span class="koboSpan" id="kobo.790.1">
      , now.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.791.1">
     Running this produces the following output:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.792.1">$ python context/decimal.prec.py
Context(prec=5, rounding=ROUND_HALF_EVEN, Emin=-999999,
        Emax=999999, capitals=1, clamp=0, flags=[],
        traps=[InvalidOperation, DivisionByZero, Overflow])
Custom decimal context: 0.33333
Original context restored: 0.3333333333333333333333333333
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.793.1">
     In the above example, we
    </span>
    <a id="_idIndexMarker724">
    </a>
    <span class="koboSpan" id="kobo.794.1">
     have printed the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.795.1">
      context
     </span>
    </code>
    <span class="koboSpan" id="kobo.796.1">
     object to show you what it contains.
    </span>
    <span class="koboSpan" id="kobo.796.2">
     The rest of the code seems fine, but if an exception happened before we could restore the original context, the results of all subsequent computations would be incorrect.
    </span>
    <span class="koboSpan" id="kobo.796.3">
     We can fix this by using a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.797.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.798.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.799.1">
      finally
     </span>
    </code>
    <span class="koboSpan" id="kobo.800.1">
     statement:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.801.1"># context/decimal.prec.try.py</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.802.1">from</span></span><span class="koboSpan" id="kobo.803.1"> decimal </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.804.1">import</span></span><span class="koboSpan" id="kobo.805.1"> Context, Decimal, getcontext, setcontext
one = Decimal(</span><span class="hljs-string"><span class="koboSpan" id="kobo.806.1">"1"</span></span><span class="koboSpan" id="kobo.807.1">)
three = Decimal(</span><span class="hljs-string"><span class="koboSpan" id="kobo.808.1">"3"</span></span><span class="koboSpan" id="kobo.809.1">)
orig_ctx = getcontext()
ctx = Context(prec=</span><span class="hljs-number"><span class="koboSpan" id="kobo.810.1">5</span></span><span class="koboSpan" id="kobo.811.1">)
setcontext(ctx)
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.812.1">try</span></span><span class="koboSpan" id="kobo.813.1">:
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.814.1">print</span></span><span class="koboSpan" id="kobo.815.1">("Custom decimal context:", one / three)
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.816.1">finally</span></span><span class="koboSpan" id="kobo.817.1">:
    setcontext(orig_ctx)
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.818.1">print</span></span><span class="koboSpan" id="kobo.819.1">("Original context restored:", one / three)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.820.1">
     That is much safer.
    </span>
    <span class="koboSpan" id="kobo.820.2">
     Even if an exception does happen in that
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.821.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.822.1">
     block, we will always restore the original context.
    </span>
    <span class="koboSpan" id="kobo.822.2">
     It is not very convenient to have to save the context and then restore it in a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.823.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.824.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.825.1">
      finally
     </span>
    </code>
    <span class="koboSpan" id="kobo.826.1">
     statement every time we need to work with a modified precision, though.
    </span>
    <span class="koboSpan" id="kobo.826.2">
     Doing so would also violate
    </span>
    <a id="_idIndexMarker725">
    </a>
    <span class="koboSpan" id="kobo.827.1">
     the
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.828.1">
      DRY
     </span>
    </strong>
    <span class="koboSpan" id="kobo.829.1">
     principle.
    </span>
    <span class="koboSpan" id="kobo.829.2">
     We can avoid that by using the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.830.1">
      localcontext
     </span>
    </code>
    <span class="koboSpan" id="kobo.831.1">
     context
    </span>
    <a id="_idIndexMarker726">
    </a>
    <span class="koboSpan" id="kobo.832.1">
     manager from the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.833.1">
      decimal
     </span>
    </code>
    <span class="koboSpan" id="kobo.834.1">
     module.
    </span>
    <span class="koboSpan" id="kobo.834.2">
     This context manager will set and restore the context for us:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.835.1"># context/decimal.prec.ctx.py</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.836.1">from</span></span><span class="koboSpan" id="kobo.837.1"> decimal </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.838.1">import</span></span><span class="koboSpan" id="kobo.839.1"> Context, Decimal, localcontext
one = Decimal(</span><span class="hljs-string"><span class="koboSpan" id="kobo.840.1">"1"</span></span><span class="koboSpan" id="kobo.841.1">)
three = Decimal(</span><span class="hljs-string"><span class="koboSpan" id="kobo.842.1">"3"</span></span><span class="koboSpan" id="kobo.843.1">)
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.844.1">with</span></strong></span><span class="koboSpan" id="kobo.845.1"> localcontext(Context(prec=</span><span class="hljs-number"><span class="koboSpan" id="kobo.846.1">5</span></span><span class="koboSpan" id="kobo.847.1">)) </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.848.1">as</span></span><span class="koboSpan" id="kobo.849.1"> ctx:
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.850.1">print</span></span><span class="koboSpan" id="kobo.851.1">("Custom decimal context:", one / three)
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.852.1">print</span></span><span class="koboSpan" id="kobo.853.1">("Original context restored:", one / three)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.854.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.855.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.856.1">
     statement is used to enter a runtime context defined by the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.857.1">
      localcontext
     </span>
    </code>
    <span class="koboSpan" id="kobo.858.1">
     context manager.
    </span>
    <span class="koboSpan" id="kobo.858.2">
     When exiting the code block delimited by the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.859.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.860.1">
     statement, any cleanup operation defined by the context manager (in this case, restoring the decimal context) is executed automatically.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.861.1">
     It is also possible to combine multiple context managers in one
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.862.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.863.1">
     statement.
    </span>
    <span class="koboSpan" id="kobo.863.2">
     This is quite useful for situations where you need to work with multiple resources at the same time:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.864.1"># context/multiple.py</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.865.1">from</span></span><span class="koboSpan" id="kobo.866.1"> decimal </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.867.1">import</span></span><span class="koboSpan" id="kobo.868.1"> Context, Decimal, localcontext
one = Decimal(</span><span class="hljs-string"><span class="koboSpan" id="kobo.869.1">"1"</span></span><span class="koboSpan" id="kobo.870.1">)
three = Decimal(</span><span class="hljs-string"><span class="koboSpan" id="kobo.871.1">"3"</span></span><span class="koboSpan" id="kobo.872.1">)
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.873.1">with</span></span><span class="koboSpan" id="kobo.874.1"> (
    localcontext(Context(prec=</span><span class="hljs-number"><span class="koboSpan" id="kobo.875.1">5</span></span><span class="koboSpan" id="kobo.876.1">)),
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.877.1">open</span></span><span class="koboSpan" id="kobo.878.1">("output.txt", "w") </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.879.1">as</span></span><span class="koboSpan" id="kobo.880.1"> out_file
):
    out_file.write(f"{one} / {three} = {one / three}\n")
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.881.1">
     Here, we enter a local context and open a file (which acts as a context manager) in one
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.882.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.883.1">
     statement.
    </span>
    <span class="koboSpan" id="kobo.883.2">
     We perform a calculation and write the result to the file.
    </span>
    <span class="koboSpan" id="kobo.883.3">
     When we exit the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.884.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.885.1">
     block, the file is automatically closed, and the default decimal context is restored.
    </span>
    <span class="koboSpan" id="kobo.885.2">
     Do not worry too much about the details of working with files for now; we will discuss that in detail in
    </span>
    <em class="chapterRef">
     <span class="koboSpan" id="kobo.886.1">
      Chapter 8
     </span>
    </em>
    <span class="koboSpan" id="kobo.887.1">
     ,
    </span>
    <em class="chapterRef">
     <span class="koboSpan" id="kobo.888.1">
      Files and Data Persistence
     </span>
    </em>
    <span class="koboSpan" id="kobo.889.1">
     .
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.890.1">
      Before Python 3.10, surrounding multiple context managers in parentheses, as we did here, would have resulted in a
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.891.1">
       SyntaxError
      </span>
     </code>
     <span class="koboSpan" id="kobo.892.1">
      .
     </span>
     <span class="koboSpan" id="kobo.892.2">
      In older versions of Python, we would have had to fit both context managers into a single line of code or put the line break inside the parentheses of the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.893.1">
       localcontext()
      </span>
     </code>
     <span class="koboSpan" id="kobo.894.1">
      or
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.895.1">
       open()
      </span>
     </code>
     <span class="koboSpan" id="kobo.896.1">
      calls.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.897.1">
     Apart from decimal
    </span>
    <a id="_idIndexMarker727">
    </a>
    <span class="koboSpan" id="kobo.898.1">
     contexts and files, many other objects in the Python standard library can be used as context managers.
    </span>
    <span class="koboSpan" id="kobo.898.2">
     Here are some examples:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.899.1">
      Socket objects, which implement a low-level networking interface, can be used as context managers to automatically close network connections.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.900.1">
      The lock classes used for synchronization in concurrent programming use the context manager protocol to automatically release locks.
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.901.1">
     In the rest of this chapter, we will show you how you can implement your own context managers.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-218">
    <span class="koboSpan" id="kobo.902.1">
     Class-based context managers
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.903.1">
     Context managers work via
    </span>
    <a id="_idIndexMarker728">
    </a>
    <span class="koboSpan" id="kobo.904.1">
     two magic methods:
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.905.1">
      __enter__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.906.1">
     is called just before entering the body of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.907.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.908.1">
     statement and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.909.1">
      __exit__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.910.1">
     is called when
    </span>
    <a id="_idIndexMarker729">
    </a>
    <span class="koboSpan" id="kobo.911.1">
     exiting the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.912.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.913.1">
     statement body.
    </span>
    <span class="koboSpan" id="kobo.913.2">
     This means that you can create your own context manager simply by writing a class that implements these methods:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.914.1"># context/manager.class.py</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.915.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.916.1">MyContextManager</span></span><span class="koboSpan" id="kobo.917.1">:
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.918.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.919.1">__init__</span></span><span class="koboSpan" id="kobo.920.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.921.1">self</span></span><span class="koboSpan" id="kobo.922.1">):
        </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.923.1">print</span></span><span class="koboSpan" id="kobo.924.1">("MyContextManager init", </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.925.1">id</span></span><span class="koboSpan" id="kobo.926.1">(</span><span class="hljs-variable"><span class="koboSpan" id="kobo.927.1">self</span></span><span class="koboSpan" id="kobo.928.1">))
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.929.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.930.1">__enter__</span></span><span class="koboSpan" id="kobo.931.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.932.1">self</span></span><span class="koboSpan" id="kobo.933.1">):
        </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.934.1">print</span></span><span class="koboSpan" id="kobo.935.1">("Entering '</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.936.1">with</span></span><span class="koboSpan" id="kobo.937.1">' context")
        </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.938.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.939.1">self</span></strong></span>
    <span class="hljs-keyword"><span class="koboSpan" id="kobo.940.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.941.1">__exit__</span></span><span class="koboSpan" id="kobo.942.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.943.1">self, exc_type, exc_val, exc_tb</span></span><span class="koboSpan" id="kobo.944.1">):
        </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.945.1">print</span></span><span class="koboSpan" id="kobo.946.1">(f"{exc_type=} {exc_val=} {exc_tb=}")
        </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.947.1">print</span></span><span class="koboSpan" id="kobo.948.1">("Exiting '</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.949.1">with</span></span><span class="koboSpan" id="kobo.950.1">' context")
        </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.951.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.952.1">True</span></strong></span>
</code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.953.1">
     Here, we have defined a context manager class called
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.954.1">
      MyContextManager
     </span>
    </code>
    <span class="koboSpan" id="kobo.955.1">
     .
    </span>
    <span class="koboSpan" id="kobo.955.2">
     There are a few interesting things to note about this class.
    </span>
    <span class="koboSpan" id="kobo.955.3">
     Notice that the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.956.1">
      __enter__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.957.1">
     method returns
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.958.1">
      self
     </span>
    </code>
    <span class="koboSpan" id="kobo.959.1">
     .
    </span>
    <span class="koboSpan" id="kobo.959.2">
     This is quite common, but by no means required; you can return whatever you want from
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.960.1">
      __enter__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.961.1">
     , even
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.962.1">
      None
     </span>
    </code>
    <span class="koboSpan" id="kobo.963.1">
     .
    </span>
    <span class="koboSpan" id="kobo.963.2">
     The return value of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.964.1">
      __enter__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.965.1">
     method will be assigned to the variable named in the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.966.1">
      as
     </span>
    </code>
    <span class="koboSpan" id="kobo.967.1">
     clause of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.968.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.969.1">
     statement.
    </span>
    <span class="koboSpan" id="kobo.969.2">
     Also, notice the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.970.1">
      exc_type
     </span>
    </code>
    <span class="koboSpan" id="kobo.971.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.972.1">
      exc_val
     </span>
    </code>
    <span class="koboSpan" id="kobo.973.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.974.1">
      exc_tb
     </span>
    </code>
    <span class="koboSpan" id="kobo.975.1">
     parameters of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.976.1">
      __exit__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.977.1">
     function.
    </span>
    <span class="koboSpan" id="kobo.977.2">
     If an exception is raised within the body of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.978.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.979.1">
     statement, the interpreter will pass the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.980.1">
      type
     </span>
    </em>
    <span class="koboSpan" id="kobo.981.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.982.1">
      value
     </span>
    </em>
    <span class="koboSpan" id="kobo.983.1">
     , and
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.984.1">
      traceback
     </span>
    </em>
    <span class="koboSpan" id="kobo.985.1">
     of the exception as arguments through these parameters.
    </span>
    <span class="koboSpan" id="kobo.985.2">
     If no exception is raised, all three arguments will be
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.986.1">
      None
     </span>
    </code>
    <span class="koboSpan" id="kobo.987.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.988.1">
     Also, notice that the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.989.1">
      __exit__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.990.1">
     method returns
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.991.1">
      True
     </span>
    </code>
    <span class="koboSpan" id="kobo.992.1">
     .
    </span>
    <span class="koboSpan" id="kobo.992.2">
     This will cause any exception raised within the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.993.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.994.1">
     statement body to be suppressed (as if we had handled it in a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.995.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.996.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.997.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.998.1">
     statement).
    </span>
    <span class="koboSpan" id="kobo.998.2">
     If we had returned
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.999.1">
      False
     </span>
    </code>
    <span class="koboSpan" id="kobo.1000.1">
     instead, such an exception would continue to be propagated after our
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1001.1">
      __exit__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1002.1">
     method has executed.
    </span>
    <span class="koboSpan" id="kobo.1002.2">
     The ability to suppress exceptions means that a context manager can be used as an exception handler.
    </span>
    <span class="koboSpan" id="kobo.1002.3">
     The benefit of this is that we can write our exception-handling logic once and reuse it wherever we need it.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1003.1">
     Let us see our
    </span>
    <a id="_idIndexMarker730">
    </a>
    <span class="koboSpan" id="kobo.1004.1">
     context
    </span>
    <a id="_idIndexMarker731">
    </a>
    <span class="koboSpan" id="kobo.1005.1">
     manager in action:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1006.1"># context/manager.class.py</span></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1007.1">ctx_mgr = MyContextManager()</span></strong></span>
<span class="hljs-built_in"><span class="koboSpan" id="kobo.1008.1">print</span></span><span class="koboSpan" id="kobo.1009.1">("About to enter '</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1010.1">with</span></span><span class="koboSpan" id="kobo.1011.1">' context")
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1012.1">with</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1013.1"> ctx_mgr </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1014.1">as</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1015.1"> mgr:</span></strong></span>
    <span class="hljs-built_in"><span class="koboSpan" id="kobo.1016.1">print</span></span><span class="koboSpan" id="kobo.1017.1">("Inside '</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1018.1">with</span></span><span class="koboSpan" id="kobo.1019.1">' context")
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1020.1">print</span></span><span class="koboSpan" id="kobo.1021.1">(</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1022.1">id</span></span><span class="koboSpan" id="kobo.1023.1">(mgr))
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1024.1">raise</span></span><span class="koboSpan" id="kobo.1025.1"> Exception("Exception inside '</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1026.1">with</span></span><span class="koboSpan" id="kobo.1027.1">' context")
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1028.1">print</span></span><span class="koboSpan" id="kobo.1029.1">("This line will never be reached")
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1030.1">print</span></span><span class="koboSpan" id="kobo.1031.1">("After '</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1032.1">with</span></span><span class="koboSpan" id="kobo.1033.1">' context")
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1034.1">
     Here, we have instantiated our context manager in a separate statement, before the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1035.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.1036.1">
     statement.
    </span>
    <span class="koboSpan" id="kobo.1036.2">
     We did this to make it easier for you to see what is happening.
    </span>
    <span class="koboSpan" id="kobo.1036.3">
     However, it is much more common for those steps to be combined, like
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1037.1">
      with MyContextManager() as mgr
     </span>
    </code>
    <span class="koboSpan" id="kobo.1038.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1038.2">
     Running this code produces the following output:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1039.1">$ python context/manager.class.py
MyContextManager init 140340228792272
About to enter 'with' context
Entering 'with' context
Inside 'with' context
140340228792272
exc_type=&lt;class 'Exception'&gt; exc_val=Exception("Exception inside
'with' context") exc_tb=&lt;traceback object at 0x7fa3817c5340&gt;
Exiting 'with' context
After 'with' context
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1040.1">
     Study this output
    </span>
    <a id="_idIndexMarker732">
    </a>
    <span class="koboSpan" id="kobo.1041.1">
     carefully to make sure you
    </span>
    <a id="_idIndexMarker733">
    </a>
    <span class="koboSpan" id="kobo.1042.1">
     understand what is happening.
    </span>
    <span class="koboSpan" id="kobo.1042.2">
     We have printed some IDs to help verify that the object assigned to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1043.1">
      mgr
     </span>
    </code>
    <span class="koboSpan" id="kobo.1044.1">
     is really the same object that we returned from
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1045.1">
      __enter__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1046.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1046.2">
     Try changing the return values from the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1047.1">
      __enter__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1048.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1049.1">
      __exit__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1050.1">
     methods and see what effect that has.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-219">
    <span class="koboSpan" id="kobo.1051.1">
     Generator-based context managers
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.1052.1">
     If you are implementing a
    </span>
    <a id="_idIndexMarker734">
    </a>
    <span class="koboSpan" id="kobo.1053.1">
     class that represents some
    </span>
    <a id="_idIndexMarker735">
    </a>
    <span class="koboSpan" id="kobo.1054.1">
     resource that needs to be acquired and released, it makes sense to implement that class as a context manager.
    </span>
    <span class="koboSpan" id="kobo.1054.2">
     Sometimes, however, we want to implement context manager behavior, but we do not have a class that it makes sense to attach that behavior to.
    </span>
    <span class="koboSpan" id="kobo.1054.3">
     For example, we may just want to use a context manager to reuse some error-handling logic.
    </span>
    <span class="koboSpan" id="kobo.1054.4">
     In such situations, it would be rather tedious to have to write an additional class purely to implement the desired context manager behavior.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1055.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1056.1">
      contextmanager
     </span>
    </code>
    <span class="koboSpan" id="kobo.1057.1">
     decorator from the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1058.1">
      contextlib
     </span>
    </code>
    <span class="koboSpan" id="kobo.1059.1">
     module is useful for situations like this.
    </span>
    <span class="koboSpan" id="kobo.1059.2">
     It takes a
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1060.1">
      generator function
     </span>
    </em>
    <span class="koboSpan" id="kobo.1061.1">
     and converts it into a context manager (if you do not remember how generator functions work, you should review
    </span>
    <em class="chapterRef">
     <span class="koboSpan" id="kobo.1062.1">
      Chapter 5
     </span>
    </em>
    <span class="koboSpan" id="kobo.1063.1">
     ,
    </span>
    <em class="chapterRef">
     <span class="koboSpan" id="kobo.1064.1">
      Comprehensions and Generators
     </span>
    </em>
    <span class="koboSpan" id="kobo.1065.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.1065.2">
     The decorator wraps the generator in a context manager object.
    </span>
    <span class="koboSpan" id="kobo.1065.3">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1066.1">
      __enter__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1067.1">
     method of this object starts the generator and returns whatever the generator yields.
    </span>
    <span class="koboSpan" id="kobo.1067.2">
     If an exception occurs within the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1068.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.1069.1">
     statement body, the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1070.1">
      __exit__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1071.1">
     method passes the exception into the generator (using the generator’s
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1072.1">
      throw
     </span>
    </code>
    <span class="koboSpan" id="kobo.1073.1">
     method).
    </span>
    <span class="koboSpan" id="kobo.1073.2">
     Otherwise,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1074.1">
      __exit__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1075.1">
     simply calls
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1076.1">
      next
     </span>
    </code>
    <span class="koboSpan" id="kobo.1077.1">
     on the generator.
    </span>
    <span class="koboSpan" id="kobo.1077.2">
     Note that the generator must only yield once; a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1078.1">
      RuntimeError
     </span>
    </code>
    <span class="koboSpan" id="kobo.1079.1">
     will be raised if the generator yields a second time.
    </span>
    <span class="koboSpan" id="kobo.1079.2">
     Let us convert our previous example into a generator-based context manager:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.1080.1"># context/generator.py</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1081.1">from</span></span><span class="koboSpan" id="kobo.1082.1"> contextlib </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1083.1">import</span></span><span class="koboSpan" id="kobo.1084.1"> contextmanager
</span><span class="hljs-meta"><span class="koboSpan" id="kobo.1085.1">@contextmanager</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1086.1">def</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1087.1">my_context_manager</span></span><span class="koboSpan" id="kobo.1088.1">():
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1089.1">print</span></span><span class="koboSpan" id="kobo.1090.1">("Entering '</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1091.1">with</span></span><span class="koboSpan" id="kobo.1092.1">' context")
    val = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1093.1">object</span></span><span class="koboSpan" id="kobo.1094.1">()
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1095.1">print</span></span><span class="koboSpan" id="kobo.1096.1">(</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1097.1">id</span></span><span class="koboSpan" id="kobo.1098.1">(val))
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1099.1">try</span></span><span class="koboSpan" id="kobo.1100.1">:
        </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1101.1">yield</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1102.1"> val</span></strong></span>
    <span class="hljs-keyword"><span class="koboSpan" id="kobo.1103.1">except</span></span><span class="koboSpan" id="kobo.1104.1"> Exception </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1105.1">as</span></span><span class="koboSpan" id="kobo.1106.1"> e:
        </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1107.1">print</span></span><span class="koboSpan" id="kobo.1108.1">(f"{</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1109.1">type</span></span><span class="koboSpan" id="kobo.1110.1">(e)=} {e=} {e.__traceback__=}")
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1111.1">finally</span></span><span class="koboSpan" id="kobo.1112.1">:
        </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1113.1">print</span></span><span class="koboSpan" id="kobo.1114.1">("Exiting '</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1115.1">with</span></span><span class="koboSpan" id="kobo.1116.1">' context")
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1117.1">print</span></span><span class="koboSpan" id="kobo.1118.1">("About to enter '</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1119.1">with</span></span><span class="koboSpan" id="kobo.1120.1">' context")
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1121.1">with</span></span><span class="koboSpan" id="kobo.1122.1"> my_context_manager() </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1123.1">as</span></span><span class="koboSpan" id="kobo.1124.1"> val:
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1125.1">print</span></span><span class="koboSpan" id="kobo.1126.1">("Inside '</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1127.1">with</span></span><span class="koboSpan" id="kobo.1128.1">' context")
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1129.1">print</span></span><span class="koboSpan" id="kobo.1130.1">(</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1131.1">id</span></span><span class="koboSpan" id="kobo.1132.1">(val))
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1133.1">raise</span></span><span class="koboSpan" id="kobo.1134.1"> Exception("Exception inside '</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1135.1">with</span></span><span class="koboSpan" id="kobo.1136.1">' context")
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1137.1">print</span></span><span class="koboSpan" id="kobo.1138.1">("This line will never be reached")
</span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1139.1">print</span></span><span class="koboSpan" id="kobo.1140.1">("After '</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1141.1">with</span></span><span class="koboSpan" id="kobo.1142.1">' context")
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1143.1">
     The output from running this is similar to the previous example:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1144.1">$ python context/generator.py
About to enter 'with' context
Entering 'with' context
139768531985040
Inside 'with' context
139768531985040
type(e)=&lt;class 'Exception'&gt; e=Exception("Exception inside 'with'
context") e.__traceback__=&lt;traceback object at 0x7f1e65a42800&gt;
Exiting 'with' context
After 'with' context
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1145.1">
     Most context
    </span>
    <a id="_idIndexMarker736">
    </a>
    <span class="koboSpan" id="kobo.1146.1">
     manager generators have a similar
    </span>
    <a id="_idIndexMarker737">
    </a>
    <span class="koboSpan" id="kobo.1147.1">
     structure to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1148.1">
      my_context_manager()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1149.1">
     in this example.
    </span>
    <span class="koboSpan" id="kobo.1149.2">
     They have some setup code, followed by a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1150.1">
      yield
     </span>
    </code>
    <span class="koboSpan" id="kobo.1151.1">
     inside a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1152.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.1153.1">
     statement.
    </span>
    <span class="koboSpan" id="kobo.1153.2">
     Here, we yielded an arbitrary object so that you can see that the same object is made available via the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1154.1">
      as
     </span>
    </code>
    <span class="koboSpan" id="kobo.1155.1">
     clause of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1156.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.1157.1">
     statement.
    </span>
    <span class="koboSpan" id="kobo.1157.2">
     It is also common to have just a bare
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1158.1">
      yield
     </span>
    </code>
    <span class="koboSpan" id="kobo.1159.1">
     with no value (in which case,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1160.1">
      None
     </span>
    </code>
    <span class="koboSpan" id="kobo.1161.1">
     is yielded).
    </span>
    <span class="koboSpan" id="kobo.1161.2">
     This is equivalent to returning
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1162.1">
      None
     </span>
    </code>
    <span class="koboSpan" id="kobo.1163.1">
     from the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1164.1">
      __enter__()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1165.1">
     method of a context manager class.
    </span>
    <span class="koboSpan" id="kobo.1165.2">
     In such cases, the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1166.1">
      as
     </span>
    </code>
    <span class="koboSpan" id="kobo.1167.1">
     clause of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1168.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.1169.1">
     statement will typically be omitted.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1170.1">
     Another useful feature of generator-based context managers is that they can also be used as function decorators.
    </span>
    <span class="koboSpan" id="kobo.1170.2">
     This means that if the entire body of a function needs to be inside a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1171.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.1172.1">
     statement context, you could save a level of indentation and just decorate the function instead.
    </span>
   </p>
   <div class="packt_tip">
    <p class="normal">
     <span class="koboSpan" id="kobo.1173.1">
      In addition to the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1174.1">
       contextmanager
      </span>
     </code>
     <span class="koboSpan" id="kobo.1175.1">
      decorator, the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1176.1">
       contextlib
      </span>
     </code>
     <span class="koboSpan" id="kobo.1177.1">
      module
     </span>
     <a id="_idIndexMarker738">
     </a>
     <span class="koboSpan" id="kobo.1178.1">
      also contains many useful context managers.
     </span>
     <span class="koboSpan" id="kobo.1178.2">
      The documentation also provides several helpful examples of using and implementing context managers.
     </span>
     <span class="koboSpan" id="kobo.1178.3">
      Make sure you read it at
     </span>
     <a href="https://docs.python.org/3/library/contextlib.html">
      <span class="url">
       <span class="koboSpan" id="kobo.1179.1">
        https://docs.python.org/3/library/contextlib.html
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.1180.1">
      .
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.1181.1">
     The examples we gave in this section do not do anything useful.
    </span>
    <span class="koboSpan" id="kobo.1181.2">
     They were created purely to show you how context managers work.
    </span>
    <span class="koboSpan" id="kobo.1181.3">
     Study these examples carefully until you are confident that you understand them completely.
    </span>
    <span class="koboSpan" id="kobo.1181.4">
     Then start writing your own context managers (both as classes and generators).
    </span>
    <span class="koboSpan" id="kobo.1181.5">
     Try to convert the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1182.1">
      try
     </span>
    </code>
    <span class="koboSpan" id="kobo.1183.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1184.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.1185.1">
     statement for breaking out of a nested loop that we saw earlier in this chapter into a context manager.
    </span>
    <span class="koboSpan" id="kobo.1185.2">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1186.1">
      measure
     </span>
    </code>
    <span class="koboSpan" id="kobo.1187.1">
     decorator that we wrote in
    </span>
    <em class="chapterRef">
     <span class="koboSpan" id="kobo.1188.1">
      Chapter 6
     </span>
    </em>
    <span class="koboSpan" id="kobo.1189.1">
     ,
    </span>
    <em class="chapterRef">
     <span class="koboSpan" id="kobo.1190.1">
      OOP, Decorators, and Iterators
     </span>
    </em>
    <span class="koboSpan" id="kobo.1191.1">
     , is also a good candidate for converting to a context manager.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-220">
    <span class="koboSpan" id="kobo.1192.1">
     Summary
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.1193.1">
     In this chapter, we looked at exceptions and context managers.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1194.1">
     We saw that exceptions are Python’s way of signaling that an error has occurred.
    </span>
    <span class="koboSpan" id="kobo.1194.2">
     We showed you how to catch exceptions so that your program does not fail when errors inevitably do happen.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1195.1">
     We also showed you how you can raise exceptions yourself when your own code detects an error, and that you can even define your own exception types.
    </span>
    <span class="koboSpan" id="kobo.1195.2">
     We saw exception groups and the new syntax that extends the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1196.1">
      except
     </span>
    </code>
    <span class="koboSpan" id="kobo.1197.1">
     clause.
    </span>
    <span class="koboSpan" id="kobo.1197.2">
     We ended our exploration of exceptions by seeing that they are not only useful for signaling errors but can also be used as a flow-control mechanism.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1198.1">
     We ended the chapter with a brief overview of context managers.
    </span>
    <span class="koboSpan" id="kobo.1198.2">
     We saw how to use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1199.1">
      with
     </span>
    </code>
    <span class="koboSpan" id="kobo.1200.1">
     statement to enter a context defined by a context manager that performs cleanup operations when we exit the context.
    </span>
    <span class="koboSpan" id="kobo.1200.2">
     We also showed you how to create your own context managers, either as part of a class or by using a generator function.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1201.1">
     We will see more context managers in action in the next chapter, which focuses on files and data persistence.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-221">
    <span class="koboSpan" id="kobo.1202.1">
     Join our community on Discord
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.1203.1">
     Join our community’s Discord space for discussions with the authors and other readers:
    </span>
   </p>
   <p class="normal">
    <a href="Chapter_7.xhtml">
     <span class="url">
      <span class="koboSpan" id="kobo.1204.1">
       https://discord.com/invite/uaKmaz7FEC
      </span>
     </span>
    </a>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1205.1">
     <img alt="img" src="../Images/QR_Code119001106417026468.png"/>
    </span>
   </p>
  </div>
 </body></html>