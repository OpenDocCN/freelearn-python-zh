- en: '1'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '1'
- en: Network Basics for Development
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 开发网络基础知识
- en: This chapter is focused on explaining the basics and jargon used in **computer
    networking**. The idea is to build a good foundation to be used throughout the
    book.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章的重点是解释**计算机网络**中使用的基礎术语。目的是建立一个良好的基础，贯穿整本书。
- en: If you are a *network engineer* or have experience in this field, you might
    want to skip it, or perhaps skim through it.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你是一个**网络工程师**或在这一领域有经验，你可能想跳过它，或者也许只是浏览一下。
- en: If you are a *software developer* with little network experience, this chapter
    is for you. It will help you build a solid base on network jargon that will be
    useful when writing code for **network automation**.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你是一个对网络经验较少的**软件开发者**，这一章就是为你准备的。它将帮助你建立一个坚实的网络术语基础，这对于编写**网络自动化**代码时非常有用。
- en: 'The following are the topics that we will cover in this chapter:'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 本章我们将涵盖以下主题：
- en: Reviewing protocol layers, network device types, and network topologies
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 复习协议层、网络设备类型和网络拓扑
- en: Describing network architecture and its components
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 描述网络架构及其组件
- en: Illustrating network management components, network bastions, and more
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 阐述网络管理组件、网络堡垒等
- en: Reviewing protocol layers, network device types, and network topologies
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 复习协议层、网络设备类型和网络拓扑
- en: We have lots to talk about here. But due to the size restraints of this book,
    I have organized a summary with the most important aspects of today’s network
    jargon and explained them briefly. I hope you can find some new information to
    help your automation work.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在这里有很多话要说。但由于这本书的篇幅限制，我已经整理了一个摘要，其中包括了今天网络术语最重要的方面，并对其进行了简要解释。希望你能找到一些新的信息，帮助你自动化工作。
- en: Protocol layers
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 协议层
- en: 'It’s important to note that there are several different standards for protocol
    layers, and the most academic one is the ISO organization called **OSI model**,
    which defines seven layers. But we are going to consider only five defined in
    the TCP/IP protocol stack, which is used on the internet. Here is a short summary
    of each of the layers:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意的是，存在多种不同的协议层标准，其中最学术性的一个是被称为**OSI模型**的ISO组织，它定义了七层。但我们将只考虑在互联网上使用的TCP/IP协议栈中定义的五层，以下是对每一层的简要总结：
- en: '**Physical layer**: In this layer are the technologies involved in the physical
    connection itself where the bits and bytes are transformed into the physical medium,
    such as the light in fiber optics, electricity in a cable, and radio waves in
    antennas. At this layer, physical checks can be implemented on the node input,
    such as power levels, collision, noise, and signal distortion, among other types
    of checks.'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**物理层**：在这一层中，涉及的是物理连接本身的技术，其中比特和字节被转换成物理媒介，例如光纤中的光、电缆中的电和天线中的无线电波。在这一层，可以在节点输入上实施物理检查，例如功率水平、冲突、噪声和信号失真等。'
- en: '**Data link layer**: Here, the information is called a **frame**, and it contains
    a delimited size, known as the **maximum transmission unit** (**MTU**). The reason
    is that a frame is a data representation in bytes that has to move from one node
    to another one and in a reliable manner without interruption. At this level, frame
    queues are present; the queues are used to place the frames on the physical layer
    in sequential order or in priority order. Some data link devices can prioritize
    certain types of frames, jumping to the front of the queue. At the data link layer,
    some checks are done, but within the frame itself, such as CRC or checksum. In
    addition, source and destination addresses can be added to the frame to differentiate
    destinations on a shared media. The information on the frame is normally used
    locally within the same organization. This layer is also known as the **Ethernet
    layer**.'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据链路层**：在这里，信息被称为**帧**，它包含一个分隔的大小，称为**最大传输单元**（**MTU**）。原因是帧是字节表示的数据，它必须从一个节点移动到另一个节点，并且以可靠的方式无中断地移动。在这一层，存在帧队列；队列用于将帧按顺序或优先级顺序放置在物理层。某些数据链路设备可以优先处理某些类型的帧，将其跳到队列的前面。在数据链路层，会进行一些检查，但这些检查是在帧本身内进行的，例如CRC或校验和。此外，还可以将源地址和目的地址添加到帧中，以区分共享媒体上的目的地。帧上的信息通常在同一个组织内部本地使用。这一层也被称为**以太网层**。'
- en: '**Network layer**: This is also known as the **IP layer**, or the router layer.
    Here, the information is called a **packet**, and it contains the information
    that goes between nodes that are beyond the layer 2 domain (or the previous Ethernet
    layer). This level is where the routing protocols are used, the **network address
    translation** (**NAT**) does its job, some **access control lists** (**ACLs**)
    are present, and the control packets are, among other functions. The packet on
    this level has enough information to know where it came from and where it has
    to go. This layer is also responsible for fragmenting the packet into multiple
    packets if the frame MTU is smaller than the IP packet. The main information carried
    in the packet is the **IP address** and has source and destination addresses.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络层**：这也被称为**IP层**，或**路由器层**。在这里，信息被称为**数据包**，它包含在层2域（或之前的以太网层）之间的节点之间传输的信息。在这一层，使用路由协议，**网络地址转换**（NAT）执行其任务，存在一些**访问控制列表**（ACLs），控制数据包在其它功能中。在这一层的包包含了足够的信息来知道它从哪里来以及它要去哪里。这一层还负责如果帧MTU小于IP包时将包分片成多个包。包中携带的主要信息是**IP地址**，并包含源地址和目标地址。'
- en: '`80` for HTTP communication, and to associate it with a communication **socket**
    in the host. The port number is required for the source and destination, which
    will be used to designate the correct socket to communicate with the host.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`80`用于HTTP通信，并将其与主机中的通信**套接字**关联。端口号对于源地址和目标地址都是必需的，它将用来指定与主机通信的正确套接字。'
- en: '**Application layer**: This is the top of the layers, normally referred to
    by my professor as the *cherry on the cake*. An application layer is used to associate
    a **socket** on the host where data will be sent and received. The application
    normally handles the content of the data, such as page requests on HTTP. The software
    that we are producing in this book uses this layer to automate the network.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**应用层**：这是层的顶端，通常被我的教授称为“蛋糕上的樱桃”。应用层用于将主机上的**套接字**与将要发送和接收的数据关联起来。应用通常处理数据的正文，例如HTTP中的页面请求。我们在这本书中生产的软件使用这一层来自动化网络。'
- en: LAN, WAN, internet, and intranet
  id: totrans-18
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 局域网（LAN）、广域网（WAN）、互联网和内部网
- en: '**LAN**, or **local area network**, is used to refer to networks that are local.
    Nowadays, it means networks that use the data link layer as the main communication,
    such as Ethernet. The reason why the name is more related to the communication
    layer than the geography is that technology has evolved, allowing Ethernet switches
    to communicate over thousands of kilometers. So, a LAN normally designates a topology
    inside the same organization using Ethernet, but not necessarily geographically
    in the same location.'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '**局域网**（LAN），或**本地网络**，用来指代本地网络。如今，它意味着使用数据链路层作为主要通信的网络，例如以太网。之所以这个名字更多地与通信层相关而不是地理相关，是因为技术已经发展，使得以太网交换机能够在数千公里内通信。因此，一个局域网通常指同一组织内部使用以太网的拓扑结构，但不一定是地理位置相同。'
- en: '**WAN**, or **wide area network**, is used to refer to networks that are remotely
    connected, or technologies that allow nodes to be far apart, such as extinct technologies
    such as X.25, Frame Relay, and **Asynchronous Transfer Mode** (**ATM**). Now,
    the term WAN is normally used to designate interfaces or networks that are connected
    to different networks, or in other words, networks that are not in the same organization,
    data link layer, or Ethernet domain.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '**广域网**（WAN），或**宽域网络**，用来指代远程连接的网络，或允许节点相隔甚远的 技术，例如已经灭绝的技术如X.25、帧中继和**异步传输模式**（ATM）。现在，WAN这个术语通常用来指代连接到不同网络或换句话说，不在同一组织、数据链路层或以太网域中的接口或网络。'
- en: Information
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 信息
- en: For more information about ATM, please refer to the article *Technology and
    Applications* in SSRN Electronic Journal, June 1998, by Jeffrey Scott Ray.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 如需了解更多关于ATM的信息，请参阅SSRN电子期刊1998年6月的文章《技术和应用》，作者：Jeffrey Scott Ray。
- en: The internet is what you know, this gigantic network interconnecting everybody
    worldwide.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 互联网就是你所知道的，这个连接全球每个人的巨大网络。
- en: The term intranet was used when corporations were using the internet protocols
    to communicate internally on their network. The reason is that other technologies
    were competing with the internet TCP/IP protocol at that time, such as SNA and
    IPX. So, when the term intranet was used, it was simply to state that the corporate
    network uses TCP/IP. Nowadays, intranet refers to a network that is within the
    same organization and not connected to external nodes. Therefore, the network
    is *safe* from external interference.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 当公司使用互联网协议在其网络上进行内部通信时，使用了“内部网络”这个术语。原因是当时有其他技术与互联网 TCP/IP 协议竞争，例如 SNA 和 IPX。因此，当使用“内部网络”这个术语时，它只是简单地表明公司网络使用
    TCP/IP。如今，“内部网络”指的是同一组织内的网络，且不连接到外部节点。因此，该网络是*安全的*，不受外部干扰。
- en: Point-to-point connections
  id: totrans-25
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 点对点连接
- en: A **point-to-point** (**P2P**) connection is used to interconnect two nodes.
    A link between two nodes is normally a P2P connection (as shown in *Figure 1.1*),
    unless using media such as satellite or broadcast antennas. This connection can
    either be *back to back* or not. The term *back to back* is normally used to indicate
    that the nodes are connected directly without any other physical layer between
    them, such as repeaters. Therefore, back-to-back connections have limited distances
    due to the noise and distortion introduced in the connection as the wiring gets
    longer. Depending on the speed and the technology used, the distances are limited
    to within the same room or building.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '**点对点**（**P2P**）连接用于连接两个节点。两个节点之间的连接通常是 P2P 连接（如图 *1.1* 所示），除非使用卫星或广播天线等媒体。这种连接可以是*背靠背*的，也可以不是。术语*背靠背*通常用来表示节点之间直接连接，没有任何其他物理层（如中继器）介于它们之间。因此，背靠背连接由于连接中引入的噪声和失真而受到限制，随着线缆变长，距离有限，通常限制在同一房间或建筑物内。'
- en: '![Figure 1.1 – A P2P connection](img/B18165_01_001.jpg)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![图 1.1 – P2P 连接](img/B18165_01_001.jpg)'
- en: Figure 1.1 – A P2P connection
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.1 – P2P 连接
- en: Star or hub-spoke topologies
  id: totrans-29
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 星形或中心辐射拓扑
- en: Star or hub-spoke topologies are used in small and medium companies, where one
    office is the main distributor and the other locations are consumers. The topology
    looks like a star, and network elements are smaller and simpler at the remote
    locations, while being larger and complex at the main distributor (see the example
    in *Figure 1.2*).
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 星形或中心辐射拓扑用于小型和中型公司，其中一家办公室是主要分销商，其他地点是消费者。该拓扑看起来像一颗星，远程位置的网元较小且简单，而在主要分销商处较大且复杂（见图
    *1.2* 的示例）。
- en: Normally, these types of topologies can scale up to hundreds of nodes, but depending
    on the traffic, the requirements can scale to thousands. Let’s look at two examples
    that illustrate the scale of these topologies.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，这些类型的拓扑可以扩展到数百个节点，但根据流量，需求可以扩展到数千。让我们看看两个示例，以说明这些拓扑的规模。
- en: For instance, in a bank, the automated teller machines are distributed in remote
    locations, where the main computer is located in the main branch. This can scale
    to thousands of remote machines as the traffic requirements are small in terms
    of byte transfer on a teller machine.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，在银行中，自动柜员机分布在偏远地点，而主计算机位于总行。由于在柜员机上的字节传输量很小，因此这种拓扑可以扩展到数千台远程机器。
- en: On the other hand, if you have a supermarket chain using a star topology, it
    won’t scale to thousands of remote machines, as each supermarket requires a large
    amount of data transfer to handle all transactions and employees.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，如果你有一个使用星形拓扑的超市连锁店，它无法扩展到数千台远程机器，因为每个超市都需要大量数据传输来处理所有交易和员工。
- en: So, the use of star topologies is limited to the amount of traffic it can handle
    in the central node. In the star topology, we have two device functions, a device
    that will be either at the remote location or in the main office.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，星形拓扑的使用受到其中央节点可以处理的流量的限制。在星形拓扑中，我们有两种设备功能，一种设备将位于远程位置或主办公室。
- en: Network capacity planning is trivial when dealing with star topologies, as the
    main office node is updated as it grows.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 当处理星形拓扑时，网络容量规划很简单，因为随着其增长，主办公室节点会更新。
- en: '![Figure 1.2 – A star topology](img/B18165_01_002.jpg)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![图 1.2 – 星形拓扑](img/B18165_01_002.jpg)'
- en: Figure 1.2 – A star topology
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.2 – 星形拓扑
- en: Hierarchical or tree topologies
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 分层或树形拓扑
- en: Hierarchical topologies are used to optimize traffic, where larger nodes are
    used to aggregate traffic to smaller nodes in a hierarchical matter (see the example
    in *Figure 1.3*). These topologies can scale to thousands of nodes; however, because
    of the number of nodes in the path, the topologies can cause undesirable latency
    and extra node costs.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 分层拓扑用于优化流量，其中较大的节点用于按分层方式将流量聚合到较小的节点（参见*图1.3*中的示例）。这些拓扑可以扩展到数千个节点；然而，由于路径中的节点数量，这些拓扑可能导致不希望的延迟和额外的节点成本。
- en: An internet service provider normally uses a hierarchical topology to concentrate
    customer traffic in certain remote locations before aggregating even more in other
    locations.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 互联网服务提供商通常使用分层拓扑在特定远程位置集中客户流量，然后再在其他位置进行进一步的聚合。
- en: There is no limit on the number of nodes on this type of topology, and it’s
    one of the foundations of the internet global infrastructure.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 这种类型拓扑的节点数量没有限制，它是互联网全球基础设施的基础之一。
- en: In the hierarchical topologies, we have multiple device functions, the **customer
    premises equipment** (**CPE**), aggregators, distributors, core, and peering,
    among others.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在分层拓扑中，我们有多个设备功能，包括**客户场所设备**（**CPE**）、聚合器、分发器、核心和对等，等等。
- en: Depending on the size of this topology, it can introduce a longer path, which
    will add significant latency. For instance, in *Figure 1.3*, **A1** has to cross
    five hosts to reach **A7**.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 根据这种拓扑的大小，它可能会引入更长的路径，这将增加显著的延迟。例如，在*图1.3*中，**A1**必须穿越五个主机才能到达**A7**。
- en: Network capacity planning is focused on the aggregation points, and augmenting
    the network is not that difficult.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 网络容量规划集中在聚合点，增强网络并不困难。
- en: '![Figure 1.3 – A hierarchical or tree topology](img/B18165_01_003.jpg)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![图1.3 – 分层或树形拓扑](img/B18165_01_003.jpg)'
- en: Figure 1.3 – A hierarchical or tree topology
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.3 – 分层或树形拓扑
- en: Clos topologies
  id: totrans-47
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Clos拓扑
- en: This type of topology is also known as a **Clos network** or **fabric**. This
    topology is used to increase the number of ports without compromising latency
    and throughput and is often used in data centers. This topology is composed of
    at least three stages. Note that there is no oversubscription or aggregation like
    in the hierarchical topologies. The Clos topology provides the same amount of
    available bandwidth on the input and output. The stage names are normally **spines**
    and **leafs**. The spines are always in the center and only have connections to
    the Clos nodes. Leaves are used to connect to external devices or networks.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 这种类型的拓扑也被称为**Clos网络**或**布线**。这种拓扑用于在不影响延迟和吞吐量的情况下增加端口数量，通常用于数据中心。这种拓扑至少由三个阶段组成。请注意，与分层拓扑不同，这里没有过度预订或聚合。Clos拓扑在输入和输出上提供相同数量的可用带宽。阶段名称通常是**脊**和**叶**。脊始终位于中心，并且仅与Clos节点连接。叶用于连接外部设备或网络。
- en: '*Figure 1.4* shows an example of a 16-port Clos network. Note that normally,
    all connections between a spine node to a leaf node are *back to back*:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '*图1.4*展示了16端口Clos网络的示例。请注意，通常，脊节点到叶节点的所有连接都是*背靠背*：'
- en: '![Figure 1.4 – A Clos topology](img/B18165_01_004.jpg)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![图1.4 – Clos拓扑](img/B18165_01_004.jpg)'
- en: Figure 1.4 – A Clos topology
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.4 – Clos拓扑
- en: Why are these topologies used? To increase the number of ports available without
    compromising throughput. This kind of topology is also used inside a router to
    provide connectivity between interface cards. Some companies use small devices
    to increase the number of ports that are offered without raising the cost as smaller
    devices are normally cheaper.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么使用这些拓扑？为了在不影响吞吐量的情况下增加可用的端口数量。这种拓扑也用于路由器内部，以提供接口卡之间的连接。一些公司使用小型设备来增加提供的端口数量，而不增加成本，因为小型设备通常更便宜。
- en: Important note
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: One additional characteristic of the Clos network is that it has the same distance
    between any two external ports (in terms of nodes in the path), therefore the
    latency in normal conditions is the same. For instance, in *Figure 1.4*, the latency
    between an external port on node L1 to an external port on L4 or E1 is the same.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: Clos网络的另一个特点是它具有任何两个外部端口之间的相同距离（就路径中的节点而言），因此正常条件下的延迟是相同的。例如，在*图1.4*中，节点L1上的外部端口与L4或E1上的外部端口之间的延迟是相同的。
- en: Important note
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: 'More information on Clos networks can be found in an interesting paper from
    Google called *Jupiter Rising: A Decade of Clos Topologies and Centralized Control
    in Google’s Datacenter Network* – ACM SIGCOMM Computer Communication Review, Volume
    45, Issue 4, October 2015.'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 关于 Clos 网络的更多信息可以在一篇有趣的谷歌论文中找到，名为《Jupiter Rising：谷歌数据中心网络中 Clos 拓扑和集中式控制十年》——
    ACM SIGCOMM 计算机通信评论，第 45 卷，第 4 期，2015 年 10 月。
- en: Mixed topologies
  id: totrans-57
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 混合拓扑
- en: A mixed topology is used in large corporations where latency and traffic are
    both important to care of. Normally, star topologies and P2P are used to shorten
    paths and reduce latency, whereas hierarchical topologies are used to optimize
    and aggregate traffic, and finally, Clos networks to increase the number of ports.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 混合拓扑在大公司中使用，其中延迟和流量都很重要。通常，星型拓扑和对等网络用于缩短路径和降低延迟，而分层拓扑用于优化和聚合流量，最后，Clos 网络用于增加端口数量。
- en: Modern cloud service providers are migrating to a more complex topology, where
    there are connections between elements where latency matters and aggregate device
    functions where traffic matters.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 现代云服务提供商正在迁移到一个更复杂的拓扑，其中元素之间存在延迟相关的连接，以及流量相关的聚合设备功能。
- en: 'Network capacity planning is normally harder because connections are not totally
    hierarchical and aggregation points are not necessarily part of all traffic paths.
    An example of this kind of mixed topology is shown in *Figure 1.5*:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 网络容量规划通常更困难，因为连接不是完全分层的，聚合点也不一定是所有流量路径的一部分。这种混合拓扑的一个例子在 *图 1.5* 中显示：
- en: '![Figure 1.5 – A mixed topology](img/B18165_01_005.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![图 1.5 – 混合拓扑](img/B18165_01_005.jpg)'
- en: Figure 1.5 – A mixed topology
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.5 – 混合拓扑
- en: Interface speeds
  id: totrans-63
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 接口速度
- en: A very important point that some engineers get confused about is the interface
    speed representation. 1 KB in memory representation is 2^10 or 1,024 bytes and
    1 GB is 2^30, which is 1,073,741,824 bytes. For interface speeds, the same does
    not apply, and 1 Kbps is actually 1,000 bits/second, while 1 Gbps is 1,000,000,000
    bits/second (more details can be found at [https://en.wikipedia.org/wiki/Data-rate_units](https://en.wikipedia.org/wiki/Data-rate_units)).
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 一些工程师可能会混淆的一个非常重要的点是接口速度的表示。在内存表示中，1 KB 是 2^10 或 1,024 字节，而 1 GB 是 2^30，即 1,073,741,824
    字节。对于接口速度，情况并不相同，1 Kbps 实际上是 1,000 比特/秒，而 1 Gbps 是 1,000,000,000 比特/秒（更多详细信息请参阅
    [https://en.wikipedia.org/wiki/Data-rate_units](https://en.wikipedia.org/wiki/Data-rate_units)）。
- en: Device types and functions
  id: totrans-65
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 设备类型和功能
- en: 'Network devices used to have specific functions as CPU and memory were scarce
    and expensive. Nowadays, network devices can have multiple functions when required.
    In large networks, devices have fewer functions as they tend to get overloaded
    easier when traffic demands increase. Here are some of the functions that a device
    can have:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 网络设备过去具有特定的功能，因为 CPU 和内存稀缺且昂贵。如今，网络设备在需要时可以具有多种功能。在大网络中，设备的功能较少，因为当流量需求增加时，它们更容易过载。以下是一些设备可能具有的功能：
- en: '**Hub**: This is a very old term to designate a device that only repeats the
    physical signal.'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**集线器**：这是一个非常古老的术语，用来指代只重复物理信号的设备。'
- en: '**Switch**: A device that works only on the data link layer. It is normally
    used in LANs, and it works by switching frames. The most common protocol used
    on these devices to control paths is the **Spanning Tree Protocol** (**STP**).'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**交换机**：仅在数据链路层工作的设备。它通常用于局域网，通过交换帧来工作。在这些设备上用于控制路径的最常见协议是 **生成树协议**（**STP**）。'
- en: '**Router**: A device that works only on the network layer or IP Layer. It is
    used to interconnect multiple LANs or create long-haul remote connections. Internally,
    a router routes packets using a routing protocol to exchange route information
    with other routers. Some routers can also switch frames or work as a switch.'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**路由器**：仅在网络层或 IP 层工作的设备。它用于连接多个局域网或创建长途远程连接。内部，路由器使用路由协议路由数据包，与其他路由器交换路由信息。一些路由器还可以交换帧或作为交换机工作。'
- en: '**NAT**: NAT is devices that replace source and destination IP addresses to
    allow the use of private IP addresses or to isolate internal traffic from external
    traffic.'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**NAT**：NAT 是替换源和目的 IP 地址的设备，允许使用私有 IP 地址或将内部流量与外部流量隔离。'
- en: '**Firewall**: Normally, devices that control the traffic that passes through
    it by looking into the content of the frame or the packet. There are several different
    types of firewalls, and some might be super complex, which includes encrypting
    and decrypting traffic.'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**防火墙**：通常，通过检查帧或数据包的内容来控制通过它的流量。有几种不同类型的防火墙，其中一些可能非常复杂，包括加密和解密流量。'
- en: '**Load balancers**: When servers can’t handle too many clients because of hardware
    limitations, load balancers can be used to deal with the client demands by sharing
    the client request between several servers. Those devices also look into the packet
    content to determine which server would get the traffic.'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**负载均衡器**：当服务器由于硬件限制无法处理过多的客户端时，可以使用负载均衡器通过在多个服务器之间共享客户端请求来处理客户端需求。这些设备还会检查数据包内容以确定哪个服务器将获得流量。'
- en: '**Network server**: A computer used to provide some sort of *service* to the
    network, for instance, an authentication server, an NTP server, or a Syslog collector.'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络服务器**：用于向网络提供某种**服务**的计算机，例如认证服务器、NTP服务器或Syslog收集器。'
- en: Oversubscription
  id: totrans-74
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 过度订阅
- en: In network jargon, this term is used to describe nodes or links in the network
    that aggregate traffic from other parts of the network and statistically use it
    to their advantage. For instance, they have a 1 Gbps interface to connect to the
    internet and 1,000 customers with 10 Mbps interfaces to use the service, which
    is an oversubscription of 1 to 10\. This practice is quite normal and is only
    possible to use because of the characteristics of the client’s traffic that allow
    such aggregation without degradation. There are lots of mathematical models and
    papers on the internet describing this behavior and how to use it in your favor.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 在网络术语中，这个术语用来描述网络中聚合来自网络其他部分流量的节点或链接，并统计上利用它来获得优势。例如，它们有一个1 Gbps的接口连接到互联网，以及1000个拥有10
    Mbps接口的客户使用服务，这是一个1到10的过度订阅。这种做法相当普遍，并且之所以能够这样做，是因为客户端流量的特性允许在不降低性能的情况下进行这种聚合。互联网上有许多数学模型和论文描述了这种行为以及如何利用它。
- en: But some traffic can’t be aggregated without being degraded. In a data center,
    the traffic that can’t be oversubscribed is the traffic between servers, such
    as remote disk, data transfers, and database replicas. In this scenario, the best
    solution is to interconnect them without oversubscription using a solution such
    as non-blocking Clos topologies.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 但有些流量不能在不降低性能的情况下进行聚合。在数据中心，无法过度订阅的流量是服务器之间的流量，例如远程磁盘、数据传输和数据库副本。在这种情况下，最佳解决方案是使用非阻塞Clos拓扑等解决方案在不进行过度订阅的情况下将它们互连。
- en: Browsing web pages, watching videos, and receiving messages from most of the
    traffic on the internet, which easily allows the aggregation technique without
    degradation.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 浏览网页、观看视频和接收来自互联网上大部分流量的消息，这很容易允许在不降低性能的情况下进行聚合技术。
- en: Important note
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: More information on oversubscription can be found in the paper *Evaluating Impacts
    of Oversubscription on Future Internet Business Models* by A. Raju, V. Gonçalves,
    and P. Ballon – Published in Networking Workshops, 25 May 2012 – Computer Science.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 关于过度订阅的更多信息可以在A. Raju、V. Gonçalves和P. Ballon发表的论文《评估过度订阅对未来互联网商业模式的影响》中找到——发表于2012年5月25日的网络研讨会——计算机科学。
- en: In this section, we went over the basic components of computer networks, including
    protocols, topology types, interface speeds, and device types. By now, you should
    be able to identify these terms more easily and will be familiar with their meanings,
    because we are going to use these terms throughout this book. Moving on, we are
    going to review more terms related to network architecture.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们介绍了计算机网络的基本组件，包括协议、拓扑类型、接口速度和设备类型。到现在为止，你应该能够更容易地识别这些术语，并且熟悉它们的含义，因为我们将在这本书中反复使用这些术语。接下来，我们将回顾更多与网络架构相关的术语。
- en: Describing network architecture and its components
  id: totrans-81
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 描述网络架构及其组件
- en: The term network architecture was introduced in the early 2000s, mimicking roles
    in the construction industry, where architects design and civil engineers build.
    Different companies use the term differently, but in this book, network architecture
    will be used to refer to the design of the network and its functions.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 网络架构这个术语是在2000年代初提出的，模仿了建筑行业中的角色，在那里建筑师设计，土木工程师建造。不同的公司使用这个术语的方式不同，但在这本书中，网络架构将用来指代网络的设计及其功能。
- en: For a good network architecture, it is desirable to have a document describing
    in detail the first three layers of the network, from the physical layer to the
    routing layer. With this documentation, it is easy for the engineers to understand
    the physical connections, the Ethernet domains, and the routing protocols used.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 对于一个好的网络架构，最好有一个详细描述网络前三个层次的文档，从物理层到路由层。有了这份文档，工程师们可以很容易地理解物理连接、以太网域和使用的路由协议。
- en: Diagrams
  id: totrans-84
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 图表
- en: A network diagram is mostly like a map, where the cities are the nodes and the
    roads are the links that connect them. For a network engineer, diagrams are crucial
    to describe how nodes are connected, and they also can group and demarcate important
    areas. A good diagram is easy to interpret and follow how data flows.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 网络图表大多像一张地图，其中城市是节点，道路是连接它们的链接。对于网络工程师来说，图表对于描述节点如何连接至关重要，它们还可以分组和划分重要区域。一个好的图表易于解释，并可以追踪数据流。
- en: There are up to three types of diagrams; they can be integrated on the same
    page and graph, or they can be separated onto different pages. The main diagrams
    are one to show the physical connections, which can include the technology involved
    in the data link layer, and the switching and routing diagrams.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 有多达三种类型的图表；它们可以集成在同一页面上和图表中，或者可以分离到不同的页面上。主要图表中有一个用于显示物理连接，这可能包括数据链路层中涉及的技术，以及交换和路由图表。
- en: 'In *Figure 1.6*, we can see an example of a network diagram:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在 *图1.6* 中，我们可以看到一个网络图表的示例：
- en: '![Figure 1.6 – Example of a network diagram](img/B18165_01_006.jpg)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![图1.6 – 网络图表示例](img/B18165_01_006.jpg)'
- en: Figure 1.6 – Example of a network diagram
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.6 – 网络图表示例
- en: '*Figure 1.7* shows examples of network diagram symbols:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '*图1.7* 展示了网络图表符号的示例：'
- en: '![Figure 1.7 – Network diagram symbols](img/B18165_01_007.jpg)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![图1.7 – 网络图表符号](img/B18165_01_007.jpg)'
- en: Figure 1.7 – Network diagram symbols
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.7 – 网络图表符号
- en: Network node names
  id: totrans-93
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 网络节点名称
- en: 'A network node is a device that is essentially used to interconnect and serve
    as a transport of the data in the network. It can be either a hub, a switch, or
    a router. To help network engineers identify the node function, names are used
    to describe their main function. Here are some of them:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 网络节点是一种主要用于互连和作为网络中数据传输的设备。它可以是集线器、交换机或路由器。为了帮助网络工程师识别节点功能，使用名称来描述它们的主要功能。以下是一些例子：
- en: '**Transit router**: These are routers that have interfaces with other service
    providers. These links are normally used as a service to access other networks,
    therefore they have a cost because they are normally connected to other big carriers.'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**中继路由器**：这些路由器与其他服务提供商有接口。这些链接通常用作访问其他网络的服务，因此它们有成本，因为它们通常连接到其他大型运营商。'
- en: '**Peer router**: These routers have interfaces with other networks in a peer
    configuration, meaning none of the parts pay to use it. In these links, only the
    traffic between the peer companies is exchanged, and the traffic destinated to
    outside networks are not allowed. Accessing external networks would be the case
    when using transit routers.'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**对等路由器**：这些路由器以对等配置与其他网络有接口，这意味着没有任何部分需要付费使用。在这些链接中，只有对等公司之间的流量被交换，不允许流量流向外部网络。使用中继路由器访问外部网络的情况。'
- en: '**Core router**: These are nodes that are in the center of the network. They
    normally handle a large amount of traffic and have high-speed interfaces. Their
    throughput capacity is the highest in the network, but they have fewer interfaces
    as they concentrate the traffic of the network.'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**核心路由器**：这些节点位于网络中心。它们通常处理大量流量并具有高速接口。它们的吞吐量能力是网络中最高的，但它们的接口较少，因为它们集中了网络的流量。'
- en: '**Distribution router**: These are nodes that normally connect to the core
    and aggregation routers. They normally interconnect different locations of the
    network. They don’t have many interfaces and their throughput capacity is high,
    but not as high as the core router.'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分发路由器**：这些节点通常连接到核心路由器和聚合路由器。它们通常连接网络的不同位置。它们没有很多接口，吞吐量能力很高，但不如核心路由器高。'
- en: '**Aggregation router**: These routers normally aggregate the traffic from the
    access routers. They are normally located in the same area or location as the
    access routers, and they have fewer interfaces compared to the access routers.'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**聚合路由器**：这些路由器通常聚合接入路由器的流量。它们通常位于接入路由器相同区域或位置，并且与接入路由器相比接口更少。'
- en: '**Access router**: Some architects add a node that connects all last-mile networks
    or CPE nodes. These routers are located closer to the customer and have more interfaces
    than any other router.'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**接入路由器**: 一些架构师添加一个节点，连接所有最后一英里网络或CPE节点。这些路由器位于更靠近客户的位置，并且比其他路由器有更多的接口。'
- en: '**Top of the rack** (**TOR**): **TOR** refers to nodes that can be either a
    switch or a router, depending on the architecture. They are responsible for connecting
    the servers in the rack to the rest of the network.'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**机架顶部** (**TOR**): **TOR**指的是可以是交换机或路由器的节点，这取决于架构。它们负责将机架中的服务器连接到整个网络。'
- en: '**Clos rack**: A Clos network, as described before, is a technique to add connectivity
    to multiple servers using small devices. A Clos rack is seen by the rest of the
    network as a single unique block, and in terms of architecture, it acts as a single
    node, normally used as a single router with a large number of interfaces.'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Clos机架**: 如前所述，Clos网络是一种使用小型设备向多个服务器添加连接性的技术。Clos机架在网络中被视为一个唯一的单一块，在架构方面，它作为一个单一节点，通常用作具有大量接口的单个路由器。'
- en: '**CPE**: CPE is the node that is installed at the customer’s location. It normally
    has one interface connecting to the last-mile network and one local interface
    that can be an Ethernet or a wireless Ethernet. These devices can also implement
    NAT, firewall and, in some cases, they have multiple local interfaces, which can
    act as a switch and a router. These nodes are cheap and small with very low throughput
    capacity compared to the other nodes.'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**CPE**: CPE是在客户位置安装的节点。它通常有一个接口连接到最后一英里网络，还有一个本地接口，可以是以太网或无线以太网。这些设备还可以实现NAT、防火墙，在某些情况下，它们有多个本地接口，可以作为交换机和路由器使用。这些节点价格低廉、体积小，与其他节点相比，吞吐量能力非常低。'
- en: The last-mile network
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 最后一英里网络
- en: This term is used to describe the architecture used to connect the customer
    to the network. Normally, this term is only used for ISPs, but some corporations
    also use it to interconnect their branches.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 这个术语用来描述连接客户到网络的架构。通常，这个术语仅用于ISP，但一些公司也用它来互联他们的分支机构。
- en: 'The **last-mile network** has a range of coverage and normally doesn’t cross
    the 1 km mark but depends on the type of technology used. Here are some of the
    most common last-mile networks:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: '**最后一英里网络**的覆盖范围有限，通常不会超过1公里，这取决于所使用的技术类型。以下是一些最常见的最后一英里网络：'
- en: '**Cable TV**: There are several technologies used here to provide data communication
    using the cable TV that the customer has installed. The most used one is DOCSIS,
    which in 2017 was upgraded to version 4\. This solution uses a single cable that
    is shared to several premises.'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**有线电视**: 在这里使用了多种技术，通过客户安装的有线电视提供数据通信。最常用的是DOCSIS，它在2017年升级到了版本4。该解决方案使用一根共享给多个住宅的单电缆。'
- en: '**Digital subscriber line** (**DSL**): DSL uses the old telephone line to pass
    data communication. For that, there are lots of standards, and the most common
    ones are VDSL and ADSL. The DSL solutions don’t share the same media as cable
    TV does, and there is one cable for each customer.'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数字用户线路** (**DSL**): DSL使用旧的电话线路进行数据通信。为此，有许多标准，其中最常见的是VDSL和ADSL。DSL解决方案不与有线电视共享相同的媒体，每个客户都有一个单独的电缆。'
- en: '**Fiber to the premises** (**FTTP**): FTTP is when an optical cable arrives
    at a customer’s premises. Like cable TV, the most common implementation is a single
    fiber that crosses several different customers in a sharable manner. The most
    common technology is a **passive optical network** (**PON**) or, more specifically,
    the **Gigabit Ethernet PON** (**GPON**) (or G.984).'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**光纤到户** (**FTTP**): FTTP是指光纤到达客户的住宅。就像有线电视一样，最常见的实现方式是单根光纤以可共享的方式跨越多个客户。最常见的技术是**无源光网络**
    (**PON**)，或者更具体地说，是**吉比特以太网PON** (**GPON**)（或G.984）。'
- en: Important note
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 重要注意事项
- en: Further details on GPON networks can be found in the paper *GPON in Telecommunication
    Network* – November 2010 – Paper from the International Congress on Ultra Modern
    Telecommunications and Control Systems (ICUMT) conference, 2010.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 关于GPON网络的更多详细信息可以在2010年11月的论文《电信网络中的GPON》中找到——2010年国际超现代电信与控制系统大会（ICUMT）会议论文，2010年。
- en: '**Wi-Fi**: Normally, this technology is used privately inside a company or
    a home, but some ISPs use the Wireless Ethernet standards (IEEE 802.11 family)
    to provide the last mile to customers using omnidirectional antennas. This particular
    use is different depending on each country and it depends on the government’s
    legislation. They are normally advertised as **Ethernet hotspots** ([https://en.wikipedia.org/wiki/Hotspot_(Wi-Fi)](https://en.wikipedia.org/wiki/Hotspot_(Wi-Fi))).'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Wi-Fi**：通常，这项技术用于公司或家庭内部的私人用途，但一些互联网服务提供商（ISP）使用无线以太网标准（IEEE 802.11系列）通过全向天线向客户提供最后一英里的服务。这种特定用途因国家而异，取决于政府的立法。它们通常被宣传为**以太网热点**（[https://en.wikipedia.org/wiki/Hotspot_(Wi-Fi)](https://en.wikipedia.org/wiki/Hotspot_(Wi-Fi))）。'
- en: '**Satellite**: For data communication using satellites, there are two methods:
    one using geostationary satellites and the other using constellation satellites.
    The difference between them is the latency, as geostationary orbits very far from
    earth. The constellation method has low latency but has handover challenges as
    the satellites keep moving, normally having very low data throughput. The most
    famous technology using geostationary is VSAT. Internet using VSAT adds around
    250 ms every time it has to travel from earth to the satellite, therefore it is
    a 500 ms round trip. But the dark ages of high latency might be over as SpaceX
    has announced they have finally solved the handover problem using the constellation
    method. This new service is called **Starlink** and has promised to have high
    capacity, low latency, and high availability using low orbit satellites.'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**卫星**：对于使用卫星进行数据通信，有两种方法：一种使用地球静止卫星，另一种使用星座卫星。它们之间的区别在于延迟，因为地球静止轨道离地球非常远。星座方法具有低延迟，但由于卫星不断移动，存在切换挑战，通常数据吞吐量非常低。最著名的使用地球静止轨道的技术是VSAT。使用VSAT的互联网每次从地球到卫星的旅行都会增加大约250毫秒，因此往返时间为500毫秒。但随着SpaceX宣布他们最终解决了使用星座方法的切换问题，高延迟的黑暗时代可能已经结束。这项新服务被称为**Starlink**，并承诺使用低轨道卫星提供高容量、低延迟和高可用性。'
- en: Important note
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: A good discussion on the Starlink network can be found in the paper *Starlink
    Analysis* – July 15, 2021 – Research group ROADMAP-5G at the Carinthia University
    of Applied Sciences.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 在卡林西亚应用科学大学Research group ROADMAP-5G的研究论文《Starlink分析》中可以找到关于Starlink网络的良好讨论，日期为2021年7月15日。
- en: '**Power line communication** (**PLC**) **or HomePlug**: PLC, or **broadband
    over power lines** (**BoPL**), uses the power cables to communicate data. This
    is achieved by modulating high frequencies on the wire. Most transformers won’t
    be able to pass through the information as they act as a low-frequency cut filter,
    so it has to be contained within a house or between posts without a transformer.
    The most common technologies here are the HomePlug AV2 and IEEE 1901-2010 ([https://ieeexplore.ieee.org/document/5678772](https://ieeexplore.ieee.org/document/5678772)).'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**电力线通信**（**PLC**）或**HomePlug**：PLC，或**电力线宽带**（**BoPL**），使用电力线进行数据通信。这是通过在电线上调制高频来实现的。大多数变压器无法通过信息，因为它们充当低频截止滤波器，所以它必须包含在房屋内或变压器之间。这里最常见的技术是HomePlug
    AV2和IEEE 1901-2010（[https://ieeexplore.ieee.org/document/5678772](https://ieeexplore.ieee.org/document/5678772)）。'
- en: '**Mobile**: Definitely the most popular network is the mobile last mile. Today,
    they use 5G technology, but other old networks are still in use, such as 4G (LTE),
    3G, and GPRS.'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**移动网络**：无疑是最后一英里中最受欢迎的网络。如今，它们使用5G技术，但其他旧网络仍在使用中，例如4G（LTE）、3G和GPRS。'
- en: Important note
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 重要提示
- en: More information on mobile technologies can be found at *Evolution of Mobile
    Communication Technology towards 5G Networks and Challenges* by A. Agarwal, K.
    Agarwal, S. Agarwal, and G. Misra – American Journal of Electrical and Electronic
    Engineering, 2019, Vol. 7, No. 2, pp. 34-37.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 更多关于移动技术的信息可以在A. Agarwal、K. Agarwal、S. Agarwal和G. Misra撰写的《面向5G网络的移动通信技术演变及其挑战》一文中找到，该文发表于2019年，美国电气和电子工程杂志，第7卷，第2期，第34-37页。
- en: The physical architecture
  id: totrans-120
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 物理架构
- en: 'The physical architecture is sometimes not necessarily the description of the
    cables or the fibers that will connect the devices but the infrastructure used
    by the network as a **physical** layer defined in the TCP/IP stack. This means
    we can reuse other foreign networks as a **physical layer** even though they have
    their own protocol stacks. Here are some of the possible physical technologies
    used in the architecture:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 物理架构有时并不一定是描述连接设备的电缆或光纤，而是网络作为TCP/IP堆栈中定义的**物理**层所使用的**基础设施**。这意味着我们可以将其他外国网络作为**物理层**来重用，即使它们有自己的协议栈。以下是架构中可能使用的某些物理技术：
- en: '**Dark fiber**: When connecting nodes, the term **dark fiber** means the nodes
    that are connected will be using a fiber that does not contain a repeater or underlying
    infrastructure. In the case of a connection between two nodes using dark fiber,
    if one node loses power, the other will not receive any light from the fiber.
    In this scenario, a fiber cut is perceived in both ends immediately, and interfaces
    go down instantaneously with a fiber cut. Only the packets in the output interface
    queue are discarded when a failure occurs.'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**暗光纤**：当连接节点时，**暗光纤**这个术语意味着连接的节点将使用不含中继器或底层基础设施的光纤。在两个节点之间使用暗光纤连接的情况下，如果一个节点断电，另一个节点将不会从光纤中接收到任何光。在这种情况下，光纤切断会在两端立即感知到，接口会立即因光纤切断而关闭。当发生故障时，只有输出接口队列中的数据包会被丢弃。'
- en: '**Synchronous Transport Module** (**STM**): STM was initially created to multiplex
    digital phone lines, but later started to be used for data communication. The
    most common one was STM-1, which was 155 Mbps. Routers used to have an interface
    that could encapsulates STM frames toward an STM network. The STM network would
    just switch the frames from one end to the other. A cut in the fiber using this
    technology might not be perceived quickly enough, causing a huge amount of packet
    loss. As we will describe later, **bidirectional forwarding detection** (**BFD**)
    needs to be used here to avoid drastic problems.'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**同步传输模块**（**STM**）：STM最初是为了复用数字电话线路而创建的，但后来开始用于数据通信。最常见的是STM-1，其速率为155 Mbps。路由器曾经有一个接口可以封装STM帧到STM网络。STM网络只是将帧从一端切换到另一端。使用这种技术切断光纤可能不会迅速感知到，这可能导致大量数据包丢失。正如我们稍后将要描述的，**双向转发检测**（**BFD**）需要在这里使用以避免严重问题。'
- en: '**Dense wavelength-division multiplexing** (**DWDM**): DWDM is an evolution
    of STM. The DWDM network is a switch network that also has a frame and time and
    wave division for each of the packets of data carried, similar to STM but enhanced.
    Similarly, BFD is necessary because a cut in the fiber here would not be perceived
    quickly enough, causing a huge amount of packet loss.'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**密集波分复用**（**DWDM**）：DWDM是STM的一种演变。DWDM网络是一个交换网络，它也为每个承载的数据包的帧、时间和波分提供了分路，类似于STM但有所增强。同样，BFD是必要的，因为在这里光纤的切断可能不会迅速感知到，这可能导致大量数据包丢失。'
- en: '**Back to back**: As explained before, the term *back to back* is normally
    used to designate the nodes that are connected directly without any other physical
    layer in between, such as repeaters.'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**端到端**：如前所述，**端到端**这个术语通常用来指定直接连接而没有其他物理层（如中继器）在之间的节点。'
- en: '**Network tunnels**: Network tunnels are points of the network that are used
    to encapsulate the traffic and travel in a different network. Tunnels can be either
    Layer 2 or Layer 3 and are implemented to abstract the network that is being carried.
    In some network architectures, they are meant to reach a distant part of the network
    using a foreign infrastructure.'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络隧道**：网络隧道是网络中用于封装流量并在不同网络中传输的点。隧道可以是第2层或第3层，并实现以抽象所承载的网络。在某些网络架构中，它们旨在使用外国基础设施到达网络的遥远部分。'
- en: '**VPN tunnels**: These are like network tunnels. VPN tunnels normally add encryption.'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**VPN隧道**：这些就像网络隧道。VPN隧道通常会增加加密。'
- en: The routing architecture
  id: totrans-128
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 路由架构
- en: 'It’s important to define how the traffic will flow in the network. For that,
    we need to have a proper design in terms of routing distribution. This is necessary
    so failure remediation, redundant paths, load balancing, routing policies, and
    traffic agreements can be implemented. The architecture would have to include
    an internal routing protocol and an external routing protocol if connected outside.
    Here is a summary:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 定义网络中流量如何流动是很重要的。为此，我们需要在路由分配方面有一个适当的设计。这是必要的，以便实现故障恢复、冗余路径、负载均衡、路由策略和流量协议。如果连接到外部，架构必须包括内部路由协议和外部路由协议。以下是一个总结：
- en: '**Interior gateway protocol** (**IGP**): IGP is a routing protocol that runs
    in a delimited area or location, normally internally within the same organization,
    as the name says. In the IGP domain, routers exchange path information by announcing
    and receiving topology updates. The most common IGPs use link state information
    to build the routing path topology. If an interface goes down, the update has
    to be propagated to the entire IGP domain. Isolated areas are used to avoid having
    to update a too-large topology and cause instability. Historically, the popular
    IGPs were RIP and EIGRP, but today, only **Open Shortest Path First** (**OSPF**)
    and **Intermediate System-to-Intermediate System** (**IS-IS**) are used.'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**内部网关协议**（**IGP**）：IGP是一种在限定区域或位置运行的路由协议，通常如名称所示，在同一个组织内部运行。在IGP域中，路由器通过宣布和接收拓扑更新来交换路径信息。最常用的IGP使用链路状态信息来构建路由路径拓扑。如果一个接口故障，更新必须传播到整个IGP域。孤立区域被用来避免更新过大的拓扑并引起不稳定。历史上，流行的IGP有RIP和EIGRP，但今天，只有**开放最短路径优先**（**OSPF**）和**中间系统到中间系统**（**IS-IS**）被使用。'
- en: '**Exterior gateway protocol** (**EGP**): EGP is a routing protocol used to
    exchange routing information between organizations. It normally does not contain
    link state information, only the path distance. The most common EGP protocol is
    **Border Gateway Protocol** (**BGP**).'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**外部网关协议**（**EGP**）：EGP是一种用于在组织之间交换路由信息的路由协议。它通常不包含链路状态信息，只有路径距离。最常用的EGP协议是**边界网关协议**（**BGP**）。'
- en: '**IS-IS**: IS-IS is an IGP protocol designed by ISO, registered as ISO 10589\.
    It is a link state protocol based on the shortest path algorithm called Dijkstra’s
    algorithm. It’s the second most used IGP.'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**IS-IS**: IS-IS是由ISO设计的IGP协议，注册为ISO 10589。它是一种基于称为迪杰斯特拉算法的最短路径算法的链路状态协议。它是第二常用的IGP。'
- en: '**OSPF**: OSPF is an IGP protocol designed by IETF, registered originally in
    1989 by RFC1131 and updated a few times later. Version 3 is the last version described
    in RFC5340\. OSPF also uses Dijkstra’s algorithm to calculate paths and is the
    most popular and used IGP. OSPF uses areas to scale and improve stability during
    routing database updates.'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**OSPF**: OSPF是由IETF设计的IGP协议，最初于1989年由RFC1131注册，后来更新了几次。版本3是最后在RFC5340中描述的版本。OSPF也使用迪杰斯特拉算法来计算路径，是最流行和广泛使用的IGP。OSPF使用区域来扩展并提高路由数据库更新期间的稳定性。'
- en: '**BGP**: BGP is a unique protocol used to exchange routing information between
    organizations. It was first introduced in 1989 in RFC1105\. It is also one of
    the protocols with more updates and extensions on the IETF and can be used for
    different purposes, such as **internal BGP** (**iBGP**), **Multiprotocol BGP**(**MP-BGP**)
    defined in RFC4760, MPLS (MP-BGP), and recently, BGPsec, defined in 2017 in RFC8205\.
    BGP is a path vector-based protocol, also known as a distance vector protocol,
    and it does not use link information like OSPF.'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**BGP**: BGP是一种独特的协议，用于在组织之间交换路由信息。它首次在1989年的RFC1105中被引入。它也是IETF上更新和扩展最多的协议之一，可用于不同的目的，例如**内部BGP**（**iBGP**）、在RFC4760中定义的**多协议BGP**（**MP-BGP**）、MPLS（MP-BGP）以及最近在2017年定义的BGPsec，定义在RFC8205中。BGP是一种基于路径向量的协议，也称为距离向量协议，它不使用像OSPF那样的链路信息。'
- en: '**Autonomous system number** (**ASN**): Like the IP range, ASN is a unique
    number that is associated with an organization when starting using BGP to exchange
    routing tables. It is controlled by the five regional internet registries: **ARIN**
    in North America, **LACNIC** in Latin America, **APNIC** in Asia-Pacific, **RIPE**
    in Europe, and **AFRINIC** in Africa. When routing tables are exchanged using
    BGP, the ASN is carried on the path. For instance, Amazon.com uses ASN 16509 ([https://whois.arin.net/rest/asn/AS16509](https://whois.arin.net/rest/asn/AS16509)).'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自治系统编号**（**ASN**）：与IP范围一样，ASN是一个与组织在开始使用BGP交换路由表时关联的唯一数字。它由五个区域互联网注册机构控制：北美地区的**ARIN**，拉丁美洲的**LACNIC**，亚太地区的**APNIC**，欧洲的**RIPE**，以及非洲的**AFRINIC**。当使用BGP交换路由表时，ASN会随路径传输。例如，Amazon.com使用ASN
    16509 ([https://whois.arin.net/rest/asn/AS16509](https://whois.arin.net/rest/asn/AS16509))。'
- en: Let’s explore how a network works in terms of its state.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们探讨从网络状态的角度来看网络是如何工作的。
- en: Types of failure
  id: totrans-137
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 失败类型
- en: 'In computer networks, a major problem is the *instability* caused by failures
    in routing tables, links, or nodes. If a node goes numb, for example, the CPU
    freezes, the other nodes have to detect it quickly so they can divert the traffic
    through a different path. But how can a failure be detected to reroute quickly
    enough? Let’s explore the types of failures first:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 在计算机网络中，路由表、链路或节点故障引起的不稳定性是一个主要问题。例如，如果一个节点变得无响应，比如CPU冻结，其他节点必须快速检测到它，以便它们可以通过不同的路径重新分配流量。但如何检测到故障以便快速重新路由呢？让我们首先探讨故障类型：
- en: '**Link failure**: A link failure is when a connection between two nodes stops
    receiving or sending data because there is an interruption on the path. The failure
    can be caused by a physical problem, such as a fiber cut, environmental conditions,
    such as heavy rain, or because of middleware equipment failure. Nodes normally
    detect whether a link is down by the lack of signal on the input, but in some
    cases, such as when using repeaters or underlying networks (such as DWDM), the
    signal is present on the input but data can’t be delivered. So, it requires a
    higher-level protocol to monitor and detect the communication breakdown instead
    of the interface input signal alone; otherwise, data will be discarded continuously
    until a node decides to reroute the traffic, which can take several seconds in
    some cases.'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**链路故障**：链路故障是指两个节点之间的连接停止接收或发送数据，因为路径上存在中断。故障可能由物理问题引起，例如光纤切割，环境条件，如大雨，或者由于中间件设备故障。节点通常通过输入信号缺失来检测链路是否断开，但在某些情况下，例如使用中继器或底层网络（如DWDM），输入信号存在，但数据无法传输。因此，需要更高层次的协议来监控和检测通信中断，而不仅仅是接口输入信号；否则，数据将持续丢弃，直到节点决定重新路由流量，在某些情况下这可能需要几秒钟。'
- en: '**Node failure**: A node can fail in several different ways; the most common
    ones are power loss and OS freeze. A software glitch can cause a router to freeze
    for minutes or even hours, causing packet loss or not, depending on where the
    freeze occurs, in either the forwarding plane or the control plane. Detecting
    this failure quickly is a bit harder because all interface signals are still present,
    and the forwarding plane might be still working.'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**节点故障**：节点可以通过多种方式发生故障；最常见的是电源丢失和操作系统冻结。软件故障可能导致路由器冻结数分钟甚至数小时，导致数据包丢失或不丢失，具体取决于冻结发生在转发平面还是控制平面。快速检测这种故障有点困难，因为所有接口信号仍然存在，转发平面可能仍在工作。'
- en: '**Flapping**: Interface flapping is when the interface keeps going down for
    short periods without being detected. Flapping causes data loss without detection
    and normally is hard to be discovered without specific equipment to measure the
    medium connected normally on both ends. The term **flapping** also is used when
    a route keeps appearing and disappearing on the routing table, called **route
    flapping**.'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**波动**：接口波动是指接口在没有被检测到的情况下频繁地短暂断开。波动会导致数据丢失而未被检测到，通常没有特定设备来测量两端正常连接的介质是难以发现的。术语**波动**也用于描述路由表上路由频繁出现和消失的情况，称为**路由波动**。'
- en: Failure detection techniques
  id: totrans-142
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 故障检测技术
- en: 'Here are some techniques to detect failure:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 这里有一些检测故障的技术：
- en: '**Signal off**: Interfaces have a very simple way of detecting failure, by
    the absence of the main signal or light. In the case of fiber, if the intensity
    of the light received is too low, it would consider the interface down. Note that
    this detection is made on the input interface.'
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**信号关闭**：接口通过主信号或灯光的缺失来检测故障，这是一种非常简单的方式。在光纤的情况下，如果接收到的光强度太低，就会认为接口已关闭。请注意，这种检测是在输入接口上进行的。'
- en: '**Protocol keep alive and hello packets**: Some routing protocols have keep
    alive (or *hello*) messages to check whether their neighbors are still alive.
    In OSPF, the default period for hello packets is 10 seconds for LAN interfaces,
    and 30 seconds for P2P connections. BGP has a default of 30 seconds. For today’s
    network speed, 30 seconds is a lot of data lost. A 10 Gbps interface would discard
    a total of 37 GB if fully loaded. In today’s protocol implementation, the period
    of sending these messages can’t be shorter than a few seconds, which is still
    a long period of data lost.'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**协议保持活动状态和hello包**：一些路由协议有保持活动状态（或*hello*）消息来检查它们的邻居是否仍然存活。在OSPF中，hello包的默认周期对于LAN接口是10秒，对于P2P连接是30秒。BGP的默认值是30秒。对于今天的网络速度，30秒会导致大量数据丢失。一个10
    Gbps的接口如果完全负载，就会丢弃总共37 GB的数据。在今天的协议实现中，发送这些消息的周期不能短于几秒，这仍然是一个很长的时间段，会导致大量数据丢失。'
- en: '**Link BFD**: In 2010, IETF published RFC5880, which describes the BFD protocol,
    which was intended to allow routers to detect failure on their interfaces in the
    order of microseconds. The BFD message supports a minimum of 1 ms interval. BFD
    is normally implemented on the interface hardware, which allows it to respond
    without interrupting the main CPU.'
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**链路BFD**：2010年，IETF发布了RFC5880，该文件描述了BFD协议，旨在允许路由器以微秒级顺序检测其接口上的故障。BFD消息支持至少1毫秒的间隔。BFD通常在接口硬件上实现，这使得它可以在不中断主CPU的情况下做出响应。'
- en: '**The BFD routing protocol**: Link BFD is normally enabled in all interfaces
    of the network to detect failures quickly, but it would not help in the case of
    OS router freeze or control plane failure. To avoid packet loss in these cases,
    all major protocols have the BFD capability, including OSPF, IS-IS, and BGP. Although
    the BFD protocol message supports microsecond intervals, the implementation using
    routing protocols is normally in the order of milliseconds and limited to the
    number of points. The reason is that these messages need to be handled by the
    main CPU, and too many might cause performance degradation.'
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**BFD路由协议**：链路BFD通常在网络的所有接口上启用，以快速检测故障，但在OS路由器冻结或控制平面故障的情况下，它不会有所帮助。为了避免在这些情况下丢失数据包，所有主要协议都具备BFD功能，包括OSPF、IS-IS和BGP。尽管BFD协议消息支持微秒级间隔，但使用路由协议的实现通常以毫秒级顺序进行，并且受限于点的数量。原因是这些消息需要由主CPU处理，过多的消息可能会导致性能下降。'
- en: '**Route flapping detection**: The routing protocol can detect persistent route
    flapping and suppress it for a period. This is useful to avoid recalculating paths
    when a route is not actually stable. When suppression is in place, normally, the
    default route is taken.'
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**路由抖动检测**：路由协议可以检测持续的路由抖动并在一段时间内抑制它。这有助于避免在路由实际上不稳定时重新计算路径。当抑制生效时，通常情况下，会采用默认路由。'
- en: Control plane and forwarding plane
  id: totrans-149
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 控制平面和转发平面
- en: It is very important to understand the difference between a forwarding plane
    and a control plane, especially if you are working on network automation. Let’s
    explore them in this section.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 理解转发平面和控制平面之间的区别非常重要，尤其是如果你正在从事网络自动化工作。让我们在本节中探讨它们。
- en: The forwarding plane, or data plane, is an abstract concept where some processes,
    equipment, and hardware are used to forward traffic through the network. In other
    words, the forwarding plane defines all entities in the network responsible for
    receiving data, transporting it, and delivering it.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 转发平面，或数据平面，是一个抽象概念，其中一些进程、设备和硬件被用来通过网络转发流量。换句话说，转发平面定义了网络中所有负责接收数据、传输数据和交付数据的实体。
- en: The control plane is an abstract concept designated to all entities in the network
    responsible for constructing the data path, removing it, or updating it.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 控制平面是一个抽象概念，指定了网络中所有负责构建数据路径、移除数据路径或更新数据路径的实体。
- en: A forwarding plane works when data is carried from one input point, *A*, to
    another output point, *B*, but does not need to have a control plane working.
    The control plane would only work if a path does not exist from *A* to *B*. The
    control plane also works in case of a failure because the original path might
    be interrupted and needs to be constructed again.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 转发平面在数据从一个输入点，*A*，传输到另一个输出点，*B*时工作，但不需要控制平面工作。只有当从*A*到*B*不存在路径时，控制平面才会工作。在出现故障的情况下，控制平面也会工作，因为原始路径可能被中断，需要重新构建。
- en: So, why is this important in network automation? Because the control plane has
    to update forwarding paths if there is a problem with the forwarding plane, which
    can cause packet drop, jitter, and delays. A stable network does not require any
    path updates and consequently minimum work for the control plane. Network automation
    needs to avoid any particular automation that might cause the control plane to
    update the network.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，为什么这在网络自动化中很重要呢？因为如果转发平面出现问题，控制平面必须更新转发路径，这可能导致数据包丢失、抖动和延迟。稳定的网络不需要任何路径更新，因此控制平面的工作量最小。网络自动化需要避免任何可能导致控制平面更新网络的特定自动化。
- en: Graceful restart
  id: totrans-155
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 优雅重启
- en: Usually, when a router restarts, all the routing peers detect that the session
    went down and then came up. This *down/up* transition results in the control plane
    working to recompute all the route paths, generating thousands of updates in the
    entire network and, consequently, causing a churn to the forwarding plane. This
    recomputation can also cause routing flaps, which may create transient forwarding
    black holes and transient forwarding loops. These transient problems also consume
    a lot of resources on the control plane of the routers affected.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，当路由器重启时，所有路由对等体会检测到会话已断开，然后又重新建立。这种*下/上*转换导致控制平面重新计算所有路由路径，在整个网络中生成数千个更新，从而对转发平面造成波动。这种重新计算也可能导致路由震荡，可能创建瞬时的转发黑洞和瞬时的转发环路。这些瞬时问题也会消耗受影响路由器的控制平面的大量资源。
- en: Therefore, a **graceful restart** was created to avoid such drastic changes
    if a restart is required.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，为了在需要重启的情况下避免这种剧烈的变化，创建了一种**优雅重启**。
- en: The idea is we could restart all control plane processes in one router without
    affecting the forwarding plane and the control plane of the other neighbor routers.
    In practice, a graceful restart is a method to restart the routing processes without
    affecting the forwarding plane.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 理念是我们可以在一个路由器上重启所有控制平面进程，而不影响转发平面和其他邻居路由器的控制平面。在实践中，优雅重启是一种重启路由进程而不影响转发平面的方法。
- en: In 2003, IETF published RFC3623 to define the implementation of the graceful
    restart for OSPF. Today, the main control plane protocols have some sort of graceful
    restart, including BGP, IS-IS, MPLS, RSVP, and LDP.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 2003年，IETF发布了RFC3623，以定义OSPF的优雅重启实现。今天，主要的控制平面协议都有某种形式的优雅重启，包括BGP、IS-IS、MPLS、RSVP和LDP。
- en: When building network automation, this kind of method is preferred to update
    the software.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 在构建网络自动化时，这种方法更倾向于更新软件。
- en: In this section, we’ve reviewed network architecture and its components. We
    got more details on routing and physical architecture components. We also learned
    how important control and data plane separation is, along with the failure types.
    It is important to know these network terminologies to help with network automation.
    Next, we’re going to review network management and its components.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们回顾了网络架构及其组件。我们获得了更多关于路由和物理架构组件的详细信息。我们还了解到控制平面和数据平面分离的重要性，以及故障类型。了解这些网络术语对于帮助网络自动化很重要。接下来，我们将回顾网络管理和其组件。
- en: Illustrating network management components, network bastions, and more
  id: totrans-162
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 展示网络管理组件、网络堡垒等
- en: Before we finish this chapter, let’s touch on some of the terms used in network
    management and planning.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们完成本章之前，让我们简要讨论一下网络管理和规划中使用的术语。
- en: ACL
  id: totrans-164
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ACL
- en: An **ACL** is used almost everywhere in the network to control access by filtering
    the IP packet based on the IP or port number.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '**访问控制列表（ACL**）几乎在网络的所有地方都用于通过基于IP或端口号过滤IP数据包来控制访问。'
- en: The ACL can be implemented on either the forwarding plane or the control plane.
    When implemented on the forwarding plane, they are used to limit the IP reachability
    to certain parts of the network and also avoid IP spoofing. When implemented on
    the control plane, they are protecting the routing protocol and management ports
    from malicious connections.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 访问控制列表（ACL）可以在转发平面或控制平面实现。当在转发平面实现时，它们用于限制IP可达性到网络的一部分，并避免IP欺骗。当在控制平面实现时，它们用于保护路由协议和管理端口免受恶意连接。
- en: ACLs are also used in the management interfaces to avoid undesirable traffic
    when using in-band management.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 在带内管理中，也使用ACL在管理接口中避免不希望的交通。
- en: Management system and managed elements
  id: totrans-168
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 管理系统和被管理元素
- en: The **management system** is the platform including the software and hardware
    responsible for managing the network. It can be centralized or distributed. The
    managed elements are the targets of the management system, including routers,
    switches, modems, repeaters, and intelligent racks, among others.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: '**管理系统**是包括负责管理网络的软件和硬件的平台。它可以集中式或分布式。被管理元素是管理系统的目标，包括路由器、交换机、调制解调器、中继器和智能机架等。'
- en: Note that the **managed element** does not need to be part of the network. It
    can be a support system, such as a rack with fans or an air conditioning unit.
    When writing code for network management, it is important to classify the elements
    appropriately so they can be managed accordingly.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，**被管理元素**不必是网络的一部分。它可以是一个支持系统，例如带有风扇的机架或空调单元。在编写网络管理代码时，适当地分类元素非常重要，以便可以相应地管理它们。
- en: In-band and out-of-band management
  id: totrans-171
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 带内和带外管理
- en: In-band and **out-of-band** (**OOB**) management refer to how the management
    system traffic reaches the management elements.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 带内和**带外**（**OOB**）管理指的是管理系统流量如何到达管理元素。
- en: For OOB management, there is an isolated network infrastructure that carries
    only management traffic, which is not connected to the main network in any way
    and only to the management ports of every managed element. In other words, the
    forwarding plane does not carry any management traffic. In addition, the OOB network
    should be able to exist and deliver management traffic independently of the main
    network routing status, because, in the case of a catastrophic scenario, the OOB
    network should be enough to reach the managed element even if its network interfaces
    are down. It’s important to note that this network normally does not carry much
    traffic and the nodes and interfaces on it have low throughput. Some OOB networks
    are implemented using mobile networks.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 对于带外管理，存在一个隔离的网络基础设施，它仅承载管理流量，以任何方式都不连接到主网络，仅连接到每个被管理元素的管理端口。换句话说，转发平面不承载任何管理流量。此外，带外网络应能够在主网络路由状态独立存在并传输管理流量，因为在灾难性场景中，即使其网络接口关闭，带外网络也应该足以到达被管理元素。重要的是要注意，这个网络通常不承载太多流量，并且其上的节点和接口吞吐量较低。一些带外网络使用移动网络实现。
- en: In in-band management, there is no physical network isolation between the forwarding
    plane and management traffic, so the interface that carries customer data also
    carries management traffic. In this scenario, ACLs are used extensively to avoid
    unwanted traffic toward the ports of the managed elements. In addition, some network
    architecture adds priority queues to interfaces to allow the management traffic
    to be delivered first and avoid discards on heavily loaded links.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 在带内管理中，转发平面和管理流量之间没有物理网络隔离，因此承载客户数据的接口也承载管理流量。在这种情况下，广泛使用ACL来避免向被管理元素端口的不必要流量。此外，一些网络架构在接口上添加优先级队列，以便首先传输管理流量，避免在重载链路上丢弃。
- en: Some management systems use both to talk to the devices, some via in-band and
    some via OOB networks. Normally, heavy traffic, such as OS upgrades and event
    logging, goes via in-band and the element console access goes via the OOB network.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 一些管理系统同时使用带内和带外（OOB）网络与设备通信。通常，如操作系统升级和事件记录等重交通量通过带内网络，而元素控制台访问则通过带外网络。
- en: Network telemetry
  id: totrans-176
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 网络遥测
- en: Telemetry is not a new term and refers to any type of equipment that can monitor
    field variables remotely, such as temperature or humidity. This term was then
    imported to computer networks to refer to a group of procedures used to collect
    network information remotely.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 遥测不是一个新术语，它指的是任何可以远程监控现场变量的设备，例如温度或湿度。这个术语后来被引入到计算机网络中，用来指代用于远程收集网络信息的一系列程序。
- en: '**Network telemetry** refers to an area in a computer network responsible for
    encompassing various procedures and systems to define, collect, and analyze network
    data. In some cases, it can mean a new method of obtaining network data by using
    streaming methods from the network devices.'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: '**网络遥测**指的是计算机网络中的一个区域，该区域负责涵盖各种程序和系统来定义、收集和分析网络数据。在某些情况下，它可能意味着通过使用网络设备中的流式传输方法来获取网络数据的新方法。'
- en: Management information base
  id: totrans-179
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 管理信息库
- en: A **management information base** (**MIB**) is a formal description of a set
    of objects that can be managed using the **Simple Network Management Protocol**
    (**SNMP**).
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: '**管理信息库**（**MIB**）是使用**简单网络管理协议**（**SNMP**）可以管理的对象集合的正式描述。'
- en: An MIB can be public or private. When public, its definitions are published
    by an RFC, such as the interface group MIB defined on RFC2863\. When private,
    it has to be provided by the vendor who owns the MIB.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: MIB 可以是公共的或私有的。当它是公共的，其定义由 RFC 发布，例如在 RFC2863 上定义的接口组 MIB。当它是私有的，它必须由拥有 MIB
    的供应商提供。
- en: The MIB is normally organized in a tree by numbers (*Figure 1.8*). When describing
    an object in an MIB tree, it is normally referred to as an **object identifier**
    (**OID**). For instance, the number of packets seen in an interface output is
    represented by an OID called **IfOutUcastPkts**, which has the sequence *.1.3.6.1.2.1.2.17*
    ([http://www.net-snmp.org/docs/mibs/interfaces.html](http://www.net-snmp.org/docs/mibs/interfaces.html)).
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: MIB 通常按数字组织成树状结构（*图 1.8*）。当描述 MIB 树中的对象时，它通常被称为**对象标识符**（**OID**）。例如，接口输出中看到的包数由一个名为**IfOutUcastPkts**的
    OID 表示，其序列为 *.1.3.6.1.2.1.2.17* ([http://www.net-snmp.org/docs/mibs/interfaces.html](http://www.net-snmp.org/docs/mibs/interfaces.html))。
- en: The OID normally contains a value that is a variable that can have different
    types, such as `COUNTER`, `GAUGE`, `INTEGER`, and `OCTETSTR`, among others.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: OID 通常包含一个值，该值是一个可以具有不同类型的变量，例如 `COUNTER`、`GAUGE`、`INTEGER` 和 `OCTETSTR` 等。
- en: '![Figure 1.8 – The SNMP MIB tree](img/B18165_01_008.jpg)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![图 1.8 – SNMP MIB 树](img/B18165_01_008.jpg)'
- en: Figure 1.8 – The SNMP MIB tree
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1.8 – SNMP MIB 树
- en: Network bastions
  id: totrans-186
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 网络堡垒
- en: The term **bastion** comes from fortifications that were used to protect cannons
    during medieval wars. At that time, a bastion was an angularly shaped part of
    an outer wall, usually placed around the corners of a fort to allow defensive
    fire in many directions.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 术语**堡垒**来自中世纪战争中用来保护加农炮的防御工事。当时，堡垒是外墙的角形部分，通常放置在堡垒的角落，以便在多个方向上进行防御射击。
- en: Like cannons in medieval times, network elements need layers for protection.
    **Network bastions** or **bastion hosts** are physical devices, normally computers,
    with defensive mechanisms built in that are connected to two or more networks.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 就像中世纪时期的加农炮一样，网络元素需要层次结构来保护。**网络堡垒**或**堡垒主机**是具有内置防御机制并连接到两个或更多网络的物理设备，通常是计算机。
- en: Bastion hosts are popularly designed using Linux installed on a computer with
    multiple Ethernet ports. Each Ethernet port connects to a different part of the
    network where isolation or protection is desired.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 堡垒主机通常设计为在具有多个以太网端口的计算机上安装 Linux。每个以太网端口连接到网络的不同部分，在这些部分需要隔离或保护。
- en: 'To protect the networks, bastion hosts do not forward traffic, and normally,
    the IP forwarding capability is disabled like the following example applied in
    Linux:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 为了保护网络，堡垒主机不转发流量，通常情况下，IP 转发功能被禁用，如下例所示，这是在 Linux 中应用的：
- en: '[PRE0]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: A Linux box without IP forwarding means traffic can’t be routed between interfaces,
    so traffic has to be originated in the bastion host to reach an external interface,
    and no other traffic would go out of the Ethernet port that is not originated
    locally in the box. Therefore, bastion hosts need to have authentication, such
    as a username and password, to allow a *user* or *system* to log in and run a
    shell locally. From the host, the user might be able to generate IP packets toward
    the other Ethernet ports.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 一个没有IP转发的Linux盒子意味着流量不能在接口之间路由，因此流量必须从堡垒主机发起才能到达外部接口，并且没有其他流量会从不在盒子本地发起的以太网端口流出。因此，堡垒主机需要具有身份验证，例如用户名和密码，以允许*用户*或*系统*登录并本地运行shell。从主机出发，用户可能能够生成指向其他以太网端口的IP数据包。
- en: Network automation will require an additional mechanism to allow accessing the
    network nodes for configuring them. We are going to cover these mechanisms later
    when writing some code to access the nodes.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 网络自动化将需要一个额外的机制来允许访问网络节点以进行配置。我们将在编写一些访问节点的代码时介绍这些机制。
- en: 'An example of a bastion host is shown in *Figure 1.9*:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: '*图1.9*展示了堡垒主机的示例：'
- en: '![Figure 1.9 – Bastion host connecting production and corporate networks](img/B18165_01_009.jpg)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: '![图1.9 – 连接生产网络和公司网络的堡垒主机](img/B18165_01_009.jpg)'
- en: Figure 1.9 – Bastion host connecting production and corporate networks
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 图1.9 – 连接生产网络和公司网络的堡垒主机
- en: FCAPS
  id: totrans-197
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: FCAPS
- en: '**FCAPS** is a management network model and framework defined by ISO for network
    management. Its acronym stands for **fault, configuration, accounting, performance,
    and security**. Each of these is the management category into which the ISO model
    defines network management tasks. Let’s look at a very summarized description
    of each of these tasks:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: '**FCAPS**是由ISO定义的网络管理模型和框架。其首字母缩写代表**故障、配置、计费、性能和安全**。这些每一个都是ISO模型定义的网络管理任务的管理类别。让我们来看一下每个任务的非常简化的描述：'
- en: '**Fault**: The goal of fault management is to recognize, isolate, correct,
    and log faults that occur in the network.'
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**故障**：故障管理的目标是识别、隔离、纠正和记录网络中发生的故障。'
- en: '**Configuration**: This refers to storing configurations from devices, tracking
    changes, and provisioning new configurations.'
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**配置**：这指的是从设备中存储配置、跟踪更改以及提供新的配置。'
- en: '**Accounting**: This is concerned with tracking network usage for data transported,
    per business, client, or user. The goal is to be able to appropriately be billed
    or charged for accounting purposes.'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**计费**：这涉及跟踪网络使用情况，按业务、客户或用户进行。目标是能够适当地进行计费或收费。'
- en: '**Performance**: This is focused on ensuring that the network works at an acceptable
    level by monitoring network latency, packet loss, link utilization, packet discards,
    retransmissions, and error rates.'
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**性能**：这侧重于通过监控网络延迟、数据包丢失、链路利用率、数据包丢弃、重传和错误率来确保网络在可接受的水平上运行。'
- en: '**Security**: This refers to controlling access to assets and protocols in
    the network, which can include AAA systems, ACLs, and firewalls.'
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**安全**：这指的是控制对网络中资产和协议的访问，这可能包括AAA系统、ACL和防火墙。'
- en: Why is FCAPS important for network automation? Because it’s better to write
    network automation code with tasks separated like in FCAPS, so we can place automation
    in different parts of the management system accordingly.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么FCAPS对网络自动化很重要？因为用FCAPS将任务分离来编写网络自动化代码会更好，这样我们就可以根据管理系统的不同部分相应地放置自动化。
- en: Network planning
  id: totrans-205
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 网络规划
- en: Growing the network is hard because if you buy too many resources, you could
    lose money. However, if you buy too little, you could lose customers. Network
    planning is used to ensure performance and costs are going in the right direction.
    In other words, it consists of several activities whose final target is to define
    an optimal cost-effective network design for the future. Network planning engineers
    work with prediction and statistical models to draw the most probable future network
    growth.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 扩展网络是困难的，因为如果你购买过多的资源，可能会损失金钱。然而，如果你购买得太少，可能会失去客户。网络规划用于确保性能和成本朝着正确的方向发展。换句话说，它包括几个活动，其最终目标是定义一个未来最优的成本效益网络设计。网络规划工程师使用预测和统计模型来绘制最可能未来的网络增长。
- en: Because of the nature of the predictions, the network planning team needs a
    lot of data from the network, and most of them are probably not easy to collect.
    You might be required to collect instantaneous data, which is not available on
    the current management systems, so you can use your network automation skills
    for that.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 由于预测的性质，网络规划团队需要从网络中获取大量数据，其中大部分可能不容易收集。你可能需要收集瞬时数据，而这些数据在当前的管理系统中是不可用的，因此你可以使用你的网络自动化技能来完成这项工作。
- en: Network security
  id: totrans-208
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 网络安全
- en: One important point to mention is the work that companies are doing to create
    a safe place for traffic to flow. Most companies today have invested in separate
    and specialized teams to deal with security, and those teams have engineers that
    only understand nuances of the network to delineate security rules to be taken
    when designing and operating computer networks.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 需要提到的一个重要观点是公司正在做的工作，以创建一个安全的环境让流量流动。如今，大多数公司都投资了独立的和专业的团队来处理安全问题，这些团队拥有只理解网络细微差别的工程师，他们负责在设计和运营计算机网络时制定安全规则。
- en: Your automation work will probably involve dealing with such security rules
    applied in the network, and will probably vary by company depending on the technology
    and level of security required. A good overview of network security can be found
    at [https://en.wikipedia.org/wiki/Network_security](https://en.wikipedia.org/wiki/Network_security).
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 你的自动化工作可能涉及处理在网络中应用的安全规则，并且可能因公司而异，这取决于技术和所需的安全级别。有关网络安全的良好概述可以在[https://en.wikipedia.org/wiki/Network_security](https://en.wikipedia.org/wiki/Network_security)找到。
- en: Summary
  id: totrans-211
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we reviewed the key points of networking. The intention was
    to highlight the main concepts and define some of the network jargon. At this
    point, you have enough network background to discuss automation work with any
    network engineer. I hope that any work done on network automation coding from
    now on will make more sense and you’re more familiar with the network terms.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们回顾了网络的关键点。目的是突出主要概念并定义一些网络术语。到目前为止，你已经拥有了足够的网络背景知识，可以与任何网络工程师讨论自动化工作。我希望从现在开始进行的网络自动化编码工作将更有意义，并且你对网络术语更加熟悉。
- en: In the next chapter, we will learn about how networks are evolving to be programmable.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将了解网络是如何演变成为可编程的。
