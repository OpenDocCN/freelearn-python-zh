<html><head></head><body>
  <div id="sbo-rt-content"><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Download and Install CherryPy</h1></div></div></div><p>Like most open-source projects, CherryPy can be downloaded and installed in various ways. Here we will discuss the following three methods:<a id="id9" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Using a tarball</p></li><li class="listitem"><p>Using easy_install</p></li><li class="listitem"><p>Getting the latest version of the source code using Subversion</p></li></ul></div><p>Each one brings a different value to the users of the project and it is important to understand the contribution made by each.</p><p>Once you have read this chapter, you should be able to retrieve and deploy CherryPy, as well as understand how to use each technique for your own software.</p><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec01"/>Requirements</h1></div></div></div><p>Throughout this book we will assume you have the following packages installed and available.<a id="id10" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Python 2.4 or above</p></li><li class="listitem"><p>CherryPy 3.0</p></li></ul></div><p>We will also assume you have knowledge of Python itself as we will not cover the language.</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec02"/>Overview</h1></div></div></div><p>Installing a Python module or package is usually an easy process. First let's discuss the most common way to build and install a new package, thanks to a standard module, distutils, which appeared with Python 2.0.<a id="id11" class="indexterm"/>
</p><p>This module provides a clean interface for specifying how a package is structured, what are the required dependencies, and the building rules of the package. For the user, it usually means typing the following commands:</p><div class="informalexample"><pre class="programlisting">python setup.py build
python setup.py install
</pre></div><p>The first one will simply build the package against the rules defined by the developers, reporting errors so that the end user knows about a missing dependency for example. The second one will install the package in the default directory used by Python to store third-party packages or modules. Note that the latter command will call the former by default to quickly check that nothing has changed since the last run.</p><p>The default directories where packages and modules are stored are:<a id="id12" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>On UNIX or Linux<code class="literal"> /usr/local/lib/python2.4/site-packages</code> or<code class="literal"> /usr/lib/python2.4/site-packages</code>
</p></li><li class="listitem"><p>On Microsoft Windows<code class="literal"> C:\Python or C:\Python2x</code>
</p></li><li class="listitem"><p>On MacOS<code class="literal"> Python:Lib:site-packages</code>
</p></li></ul></div><p>On UNIX or Linux it will depend how your Python installation has been deployed, but the directories given above are the most common. When importing a module, Python will look into a list of directories, some defaults and others provided by the user, until it finds a matching module or else an exception will be raised. The searched list can be modified either by defining the<code class="literal"> PYTHONPATH</code> environment variable or by amending it from the code itself as follows:</p><div class="informalexample"><pre class="programlisting">import sys
sys.path.append(path)
</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note02"/>Note</h3><p>The<code class="literal"> PYTHONPATH</code> environment variable is one of the variables read by the Python engine when it is being launched. It contains additional paths to append to the searched list of paths for third-party modules and packages.</p></div><p>Another method is to set a file named after the package with the<code class="literal"> .pth</code> extension. This file should contain the full path of the package.</p><p>Notwithstanding its simplicity, this algorithm has its limitations. Since the<code class="literal"> sys.path</code> list is ordered you have to make sure that if two paths contain the same module with different versions, the one your application imports is the first one to be reached. This leads us to the following package versioning problem.</p><p>Imagine that you install CherryPy 2.2.1 in your global installation of Python; it would be available under the directory<code class="literal"> /usr/local/lib/site-packages/cherrypy</code>. However, the path does not contain the version information of the package. Therefore, if you must install CherryPy 3.0.0 as well, you have to overwrite the existing installation.</p><p>Luckily the Python community has come up with a solution to this problem—eggs. An<span class="strong"><strong> egg</strong></span> is a compressed folder containing all the files and sub-folders of a package with the version details of the package in its name.<a id="id13" class="indexterm"/>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note03"/>Note</h3><p>An egg is a distributable bundle, by default zipped, of a Python package or module including information such as the author and the version of the package.</p></div><p>For example, CherryPy 2.2.1 built by Python 2.4 would look like the following:<code class="literal"> Cherrypy-2.2.1-py2.4.egg</code>. An egg by itself is not very useful; its deployment requires easy_install, a Python module that contains the logic for handling eggs. This means you can have multiple versions deployed in the same directory and leave it up to easy_install to decide which one to load.</p><p>In the next sections we will see in detail how to install CherryPy using the most common cases.</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec03"/>Installation from a Tarball</h1></div></div></div><p>A<span class="strong"><strong> tarball</strong></span> is a compressed archive of a file or directory. The name comes from the use of the tar utility found on UNIX and related operating systems.<a id="id14" class="indexterm"/>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note04"/>Note</h3><p>Historically the compression used has usually been<code class="literal"> gzip</code> and the extension of a<span class="emphasis"><em> tarball</em></span> is either<code class="literal"> .tar.gz</code> or<code class="literal"> .tgz</code>.</p></div><p>CherryPy provides a tarball for each release whether it is alpha, beta, release candidate, or stable. They can all be retrieved from <a class="ulink" href="http://download.cherrypy.org/">http://download.cherrypy.org/</a>.</p><p>CherryPy tarballs contain the complete source code of the library.</p><div class="mediaobject"><img src="images/1848_02_01.jpg" alt="Installation from a Tarball"/></div><p>To install CherryPy from a tarball you need to go through the following steps:</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>1. Download the version that interests you from <a class="ulink" href="http://download.cherrypy.org/">http://download.cherrypy.org/</a>.<a id="id15" class="indexterm"/>
</p></li><li class="listitem"><p>2. Go to the directory where the tarball has been downloaded and uncompress it:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>If you are using Linux, type the following command:</p><pre class="programlisting"><span class="strong"><strong>tar zxvf cherrypy-x.y.z.tgz
</strong></span>
</pre></li></ul></div><p>In the given command, <code class="literal">x.y.z</code> is the version you have fetched.
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>If you are running Microsoft Windows, you can use a utility such as 7-Zip to uncompress the archive via a graphical interface.</p></li></ul></div></li><li class="listitem"><p>3. Move to the newly created directory and enter the following command, which will build CherryPy:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>python setup.py build
</strong></span>
</pre></div></li><li class="listitem"><p>4. Finally, in order to do a global installation you have to issue the following command (you will more than likely need administrator permissions):</p></li></ol></div><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>python setup.py install
</strong></span>
</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note05"/>Note</h3><p>Note that these commands will have to be issued from a command line. Under Microsoft Windows you will run those from a DOS command prompt</p></div><p>The above steps will perform a global installation of CherryPy on your system for the default Python environment. There are cases where this is not suitable or not possible. For example, you may want to install CherryPy only for a given version of Python; in that case you will have to specify the correct Python binary such as<code class="literal"> python2.4</code> in steps 3 and 4 mentioned earlier.</p><p>It may also happen that you prefer not to do a global installation, in that case the quickest way under UNIX and Linux is to replace step 4 mentioned earlier with:<a id="id16" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>python setup.py install --home=~
</strong></span>
</pre></div><p>This will put the files in<code class="literal"> $HOME/lib/python</code> where<code class="literal"> $HOME</code> represents your home directory.</p><p>Under Microsoft Windows, which has no knowledge of<code class="literal"> HOME</code>, you would do the following:<a id="id17" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>python setup.py install --prefix=c:\some\path
</strong></span>
</pre></div><p>The path you choose is not important in itself and you can use whatever suits your environment.</p><p>Then you will have to make sure Python goes through that directory when you need to import modules. The easiest way is to set the<code class="literal"> PYTHONPATH</code> environment variable to the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>On Linux using a bash shell</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>export PYTHONPATH=~/lib/python</strong></span>
</pre></div></li><li class="listitem"><p>On Microsoft Windows using a command prompt</p><div class="informalexample"><pre class="programlisting">set PYTHONPATH=/some/path/
</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note06"/>Note</h3><p>Note that this will only last while the Command window is opened and will be dropped once you close it. To make the changes permanent you should set the global<code class="literal"> PYTHONPATH</code> variable via<span class="strong"><strong> System Properties | Advanced | Environment Variables</strong></span>.</p></div></li><li class="listitem"><p>On MacOS using a<code class="literal"> csh</code> shell</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>setenv PYTHONPATH "/some/path/"
</strong></span>
</pre></div></li></ul></div><p>The<code class="literal"> PYTHONPATH</code> environment variable will be read at startup by the Python interpreter, which will append it to its internal system path.</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec04"/>Installation through Easy Install</h1></div></div></div><p>
<code class="literal">Easy_install</code> is a Python module that can be found on the<span class="strong"><strong> Python Enterprise Application Kit</strong></span> (<span class="strong"><strong>PEAK</strong></span>) website to facilitate the deployment of Python packages and modules. From the developer's point of view, it provides an easy API to import Python modules either for a given version or a range of versions. For instance, here is what you would do to load the first CherryPy version greater than 2.2 found in your environment:<a id="id18" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">&gt;&gt;&gt; from pkg_resources import require
&gt;&gt;&gt; require("cherrypy&gt;=2.2")
[CherryPy 2.2.1 (/home/sylvain/lib/python/
CherryPy-2.2.1-py2.4.egg)]
</pre></div><p>From the user's point of view it simplifies the procedure of downloading, building, and deploying Python products.</p><p>Before installing CherryPy, we must install<code class="literal"> easy_install</code> itself. Download the<code class="literal"> ez_setup.py</code> module from <a class="ulink" href="http://peak.telecommunity.com/dist/ez_setup.py">http://peak.telecommunity.com/dist/ez_setup.py</a> and run it as follows, as a user with administrative rights on the computer:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>python ez_setup.py
</strong></span>
</pre></div><p>If you do not have administrator permission, you can use the<code class="literal"> -install-dir (-d)</code> option as follows:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>python ez_setup.py -install-dir=/some/path
</strong></span>
</pre></div><p>Make sure that<code class="literal"> /some/path</code> is part of the Python system path. You can set<code class="literal"> PYTHONPATH</code> to that directory for example.</p><p>This will set up your environment to support easy_install. Then to install a Python product that supports easy_install, you should issue the following command:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>easy_install product_name
</strong></span>
</pre></div><p>easy_install will search the<span class="strong"><strong> Python Package Index</strong></span> (<span class="strong"><strong>PyPI</strong></span>) to find the given product. PyPI is a centralized repository of information about Python products.</p><div class="mediaobject"><img src="images/1848_02_02.jpg" alt="Installation through Easy Install"/></div><p>In order to deploy the latest available version of CherryPy, you should then issue the following command:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>easy_install cherrypy
</strong></span>
</pre></div><p>easy_install will then download CherryPy, build, and install it globally to your Python environment. If you prefer installing it in a specific location, you will have to enter the following command:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>easy_install --install-dir=~ cherrypy
</strong></span>
<a id="id19" class="indexterm"/>
</pre></div><p>Once installed, you will have a file named<code class="literal"> cherrypy.x.y.z-py2.4.egg</code> depending on the latest version of CherryPy.</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec05"/>Installation from Subversion<a id="id20" class="indexterm"/>
</h1></div></div></div><p>Subversion is an excellent open-source revision control system that allows developers to carry out projects in a controlled and concurrent manner.<a id="id21" class="indexterm"/>
</p><p>The basic principle of such systems is to register a resource and then keep track of every change made to it, so that any developer can retrieve any previous version, compare two versions, or even follow the evolution over time of the said resource. A resource can be a source code file, a binary, an image, documentation, or anything that is expressible in machine-readable form.<a id="id22" class="indexterm"/>
</p><p>Subversion is centralized, so a project is managed by a subversion server and each client has a copy of it. The developer works on that copy and commits back any changes he or she has made. When a conflict arises, for instance, if another developer has modified the same file and has committed it already, the server will let you know and forbid your commit until you resolve the issue.</p><p>Subversion is atomic, which means that if a commit fails on one file the whole commit fails. On the other hand if it succeeds the entire project revision is incremented, not just the files involved.<a id="id23" class="indexterm"/>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note07"/>Note</h3><p>Subversion is often viewed as the successor of CVS and is considered much friendlier. However, other revision systems also exist such as Monotone or Darcs.</p></div><p>Under Linux, you can either install Subversion from its sources or using a package manager. Let's describe the procedure for the source code.</p><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>1. Get the latest tarball from <a class="ulink" href="http://subversion.tigris.org/">http://subversion.tigris.org/</a>
</p></li><li class="listitem"><p>2. Then type the following command in the command console:</p></li></ol></div><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>tar zxvf subversion-x.y.z.tar.gz
</strong></span>
</pre></div><div class="orderedlist"><ol class="orderedlist"><li class="listitem"><p>3. Enter the newly created directory and type:<code class="literal"> ./configure</code>
</p></li><li class="listitem"><p>4. Then to build the package itself type:<code class="literal"> make</code>
</p></li><li class="listitem"><p>5. You might later need the Python binding for Subversion as well:
</p><div class="informalexample"><pre class="programlisting">
 make swig-py
 </pre></div></li><li class="listitem"><p>6. To install Subversion globally, you will need to be the administrator and then enter:<code class="literal"> make install; make install-swig-py</code>
</p></li></ol></div><p>Most of the time, under Linux or UNIX, it is easier to use Subversion through the command line. However, if you prefer to use a graphical interface, I would advise you to install a fat client application such as eSvn or kdesvn.</p><div class="mediaobject"><img src="images/1848_02_03.jpg" alt="Installation from SubversionCherryPyinstalling, easy_install used"/></div><p>Under Microsoft Windows, it is much easier to directly use a graphical application such as TortoiseSVN, which will install the Subversion client as well.<a id="id24" class="indexterm"/>
</p><p>Getting CherryPy using Subversion is recommended in the following situations:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>A feature exists or a bug has been fixed and is only available in code under development.</p></li><li class="listitem"><p>You decide to work on CherryPy itself.</p></li><li class="listitem"><p>You need to branch from the main trunk in order to<span class="emphasis"><em> try and see</em></span> a feature, a new design, or simply backport bug fixing in a previous release.</p></li></ul></div><p>In order to use the most recent version of the project, you will first need to check out the trunk folder found on the Subversion repository. Enter the following command from a shell:</p><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>svn co http://svn.cherrypy.org/trunk cherrypy
</strong></span>
</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note08"/>Note</h3><p>Under Microsoft Windows you can do this from a command line or simply use TortoiseSVN. Please refer to its documentation for more information.</p></div><p>This will create a<code class="literal"> cherrypy</code> directory and download the complete source code into it. As it is usually not recommended to deploy globally a version under development; you would type the following command to install CherryPy into a local directory:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Under Linux and related systems using a console:</p></li></ul></div><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>python setup.py install --home=~
</strong></span>
</pre></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Under Microsoft Windows using the command prompt:</p></li></ul></div><div class="informalexample"><pre class="programlisting"><span class="strong"><strong>python setup.py install --prefix=c:\some\path
</strong></span>
</pre></div><p>Then simply point the<code class="literal"> PYTHONPATH</code> environment variable to the chosen directory.</p><p>Note that this directory does not matter as long as it is reachable by the Python process via PYTHONPATH or the standard sys module.<a id="id25" class="indexterm"/>
</p></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec06"/>Testing your Installation<a id="id26" class="indexterm"/>
</h1></div></div></div><p>Whichever way you decide to install and deploy CherryPy in your environment, you must be able to import it from the Python shell as follows:<a id="id27" class="indexterm"/>
</p><div class="informalexample"><pre class="programlisting">&gt;&gt;&gt; import cherrypy
&gt;&gt;&gt; cherrypy.__version__
'3.0.0'
</pre></div><p>If you do not install CherryPy globally to your Python environment, do not forget to set the<code class="literal"> PYTHONPATH</code> environment variable, else you will get an error as follows:</p><div class="informalexample"><pre class="programlisting">&gt;&gt;&gt; import cherrypy
Traceback (most recent call last):
File "&lt;stdin&gt;", line 1, in ?
ImportError: No module named cherrypy
</pre></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec07"/>Keeping CherryPy Up to Date</h1></div></div></div><p>Updating or upgrading CherryPy will depend on the approach you have taken to install it.<a id="id28" class="indexterm"/>
</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>Installed using a tarball</p><p>Usually the cleanest way to ensure the update goes smoothly is to first remove the directory containing the package from its location in <code class="literal">sys.path</code>, then to follow the steps described previously to install the library.
</p></li><li class="listitem"><p>Installed using easy_install</p><p>Updating is one of the key features provided by easy_install.
</p></li></ul></div><div class="informalexample"><pre class="programlisting">easy_install -U cherrypy
</pre></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>As the eggs containing the library are named after the version they serve, you can simply follow the steps defined in the previous section without removing an existing egg. Be careful though, as this only holds true when the application running specifies precisely which version it requires.
</p></li><li class="listitem"><p>Installed using Subversion</p><p>The interesting aspect of this approach is that you can update the library almost continuously. To update your installation, you need to enter <code class="literal">svn</code> update from the top directory holding the source code and then issue the <code class="literal">python setup.py install</code> command.
<a id="id29" class="indexterm"/>
</p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note09"/>Note</h3><p>As always remember to take a backup of your files before doing an update.</p></div></div><div class="section"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec08"/>Summary</h1></div></div></div><p>We have discussed in this chapter the different ways of installing CherryPy in your environment via three techniques. The traditional approach is to use an archive containing all the files of the Python package to install and use the<code class="literal"> setup.py</code> module within that archive. A newer and more common way of deploying a package is to use the<code class="literal"> easy_install</code> command to install eggs. Finally, if you wish to be synchronized with the latest development of CherryPy, you can get the package from its Subversion repository. Whichever method you follow, they will all lead to CherryPy being available on your system.</p></div></div></div>
</body></html>