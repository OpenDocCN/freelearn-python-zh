<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer039" class="_idGenObjectStyleOverride-1">&#13;
			<h1 id="_idParaDest-62" class="chapter-number" lang="en-GB"><a id="_idTextAnchor062"/>4</h1>&#13;
			<h1 id="_idParaDest-63" lang="en-GB"><a id="_idTextAnchor063"/>Crafting an Interpreter – First Steps</h1>&#13;
			<p lang="en-GB">In this chapter, we’ll take our first steps toward constructing a computer simulator by constructing a very primitive simulator that can execute only a single instruction. Once we’ve taken this step, we can move on by gradually enhancing <span class="No-Break">this simulator.</span></p>&#13;
			<p lang="en-GB">The key topics that we’ll cover in this chapter are <span class="No-Break">as follows:</span></p>&#13;
			<ul>&#13;
				<li lang="en-GB">Designing a minimal computer with <span class="No-Break">one instruction</span></li>&#13;
				<li lang="en-GB">Designing a simple simulator that can decode and execute <span class="No-Break">several instructions</span></li>&#13;
				<li lang="en-GB">The instruction set of a general-purpose computer <span class="No-Break">called TC1</span></li>&#13;
				<li lang="en-GB">Handing bits in Python (<span class="No-Break">Boolean operations)</span></li>&#13;
				<li lang="en-GB">Decoding an instruction in binary form into its <span class="No-Break">component parts</span></li>&#13;
				<li lang="en-GB">Executing an instruction after it has <span class="No-Break">been decoded</span></li>&#13;
				<li lang="en-GB">Arithmetic operations in <span class="No-Break">a computer</span></li>&#13;
				<li lang="en-GB">Designing functions <span class="No-Break">in Python</span></li>&#13;
				<li lang="en-GB">Branch and flow control instructions in computer <span class="No-Break">instruction sets</span></li>&#13;
			</ul>&#13;
			<p lang="en-GB">Collectively, these topics cover three areas. Some topics expand our knowledge of Python to help us construct a simulator. Some topics introduce the instruction set of a typical digital computer that we call TC1 (TC1 simply means <em class="italic">Teaching Computer 1</em>). Some topics cover the actual design of TC1 <span class="No-Break">in Python.</span></p>&#13;
			<p lang="en-GB">This chapter will introduce the computer simulator and look at some basic building blocks. The actual simulator will be presented in <a href="B19624_06.xhtml#_idTextAnchor091"><span class="No-Break"><em class="italic">Chapter 6</em></span></a><span class="No-Break">.</span></p>&#13;
			<h1 id="_idParaDest-64" lang="en-GB"><a id="_idTextAnchor064"/>Technical Requirements</h1>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB">You can find the programs used in this chapter on GitHub <span class="No-Break">at </span><a href="https://github.com/PacktPublishing/Practical-Computer-Architecture-with-Python-and-ARM/tree/main/Chapter04"><span class="No-Break">https://github.com/PacktPublishing/Practical-Computer-Architecture-with-Python-and-ARM/tree/main/Chapter04</span></a><span class="No-Break">.</span></p>&#13;
			<h3 lang="en-GB">An ultra-primitive one-instruction computer</h3>&#13;
			<p lang="en-GB">Our first <em class="italic">one-instruction interpreter</em> demonstrates both instruction decoding and execution, which are <a id="_idIndexMarker224"/>key to all simulators. This computer has a memory with nine locations, <strong class="source-inline">mem[0]</strong> to <strong class="source-inline">mem[8]</strong>, arranged as a list of integers. The contents of the memory are preset to <strong class="source-inline">mem = [4,6,1,2,7,8,4,4,5]</strong>. The memory locations are 0 to 8 and are read left to right in the list; for example, memory location 0 contains a value of 4, location 1 contains a value of 6, and location 8 contains a value <span class="No-Break">of 5.</span></p>&#13;
			<p lang="en-GB">The computer has an array of eight registers, <strong class="source-inline">r[0]</strong> to <strong class="source-inline">r[7]</strong>. These are specified in Python via <span class="No-Break">the following:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span> r = [0,0,0,0,0,0,0,0]                  <span class="sc-comment">#. Define a list of 8 registers and set them all to 0.</span></span></pre>&#13;
			<p lang="en-GB">The single instruction we are going to execute is <strong class="source-inline">add r[4],mem[3],mem[7]</strong>. This instruction adds the contents of memory location 3 to the contents of memory location 7 and puts the sum in register 4. We have chosen to begin with a single-instruction computer because it can be expressed in a few lines of Python code and yet it performs many of the actions required of a real <span class="No-Break">computer simulator.</span></p>&#13;
			<p lang="en-GB">We have defined this add memory to memory operation as a demonstration. It’s not part of any real computer language. Interestingly, it’s more complex than most real computer instructions because it uses memory-to-memory operations rather than <span class="No-Break">register-to-register operations.</span></p>&#13;
			<p lang="en-GB">We are going to <a id="_idIndexMarker225"/>write the Python code necessary to read this instruction in text form and carry out the action it defines. The two shaded lines in the following code take this instruction and split it into a list of tokens that can be processed. A token is an element in an instruction (just as a sentence in English can be split into tokens that we call words). The tokens here are <strong class="source-inline">'add'</strong>, <strong class="source-inline">'r[4]'</strong>, <strong class="source-inline">'mem[3]'</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">'mem[7]'</strong></span><span class="No-Break">.</span></p>&#13;
			<p lang="en-GB">This instruction reads the contents of <strong class="source-inline">mem[3]</strong>, which is 2; reads the contents of <strong class="source-inline">mem[7]</strong>, which is 4; adds them together to get 2 + 4 = 6; and then stores the value 6 in register 4. After this instruction has been executed, the value of register <strong class="source-inline">r[4]</strong> should <span class="No-Break">be 6:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span><strong class="source-inline">mem = [4,6,1,2,7,8,4,4,5]</strong>            <span class="sc-comment"># Create a 9-location memory. Fill with some data</span></span>&#13;
<span>r =   [0,0,0,0,0,0,0,0]                 <span class="sc-comment"># Create a set of 8 registers, all initialized to 0</span></span>&#13;
<span><strong class="bold">inst   = 'add r[4],mem[3],mem[7]'</strong>       <span class="sc-comment"># inst is our solitary instruction, stored as a string</span></span>&#13;
<span class="sc-grey" lang="en-GB">inst1  = inst.replace(' ',',')          <span class="sc-comment"># Step 1: Replace any space with a comma</span></span>&#13;
<span class="sc-grey" lang="en-GB">inst2  = inst1.split(',')               <span class="sc-comment"># Step 2: Split instruction into tokens at each comma</span></span>&#13;
<span class="sc-bottom" lang="en-GB">token0 = inst2[0]                       <span class="sc-comment"># Step 3: Get token0 via the 'add' instruction</span></span>&#13;
<span class="sc-bottom" lang="en-GB">token1 = inst2[1]                       <span class="sc-comment"># Step 4: Get token1, register 'r[4]'</span></span>&#13;
<span class="sc-bottom" lang="en-GB">token2 = inst2[2]                       <span class="sc-comment"># Step 5: Get token2, 'mem[3]'</span></span>&#13;
<span class="sc-bottom" lang="en-GB">token3 = inst2[3]                       <span class="sc-comment"># Step 6: Get token3, 'mem[7]'</span></span>&#13;
<span class="sc-bottom" lang="en-GB">value1 = int(token1[2])                 <span class="sc-comment"># Step 7: Get the register number as an integer</span></span>&#13;
<span class="sc-bottom" lang="en-GB">value2 = int(token2[4])                 <span class="sc-comment"># Step 8: Get the first memory number as an integer</span></span>&#13;
<span class="sc-bottom" lang="en-GB">value3 = int(token3[4])                 <span class="sc-comment"># Step 9: Get the second memory number as an integer</span></span>&#13;
<span class="sc-bottom" lang="en-GB">if token0 == ‹add›:                     <span class="sc-comment"># Step 10: Test for an 'add' instruction</span></span>&#13;
<span class="sc-bottom" lang="en-GB">  r[value1] = mem[value2] + mem[value3]<strong class="bold"> </strong><span class="sc-comment"># Step 11: If ADD, then add the contents of the memory</span></span>&#13;
<span class="sc-bottom">print('Registers: ',r)</span></pre>&#13;
			<p lang="en-GB">The <strong class="source-inline">inst1 = inst.replace(' ',',')</strong> operation takes the instruction and replaces a space with a comma to get <strong class="source-inline">'add r[4],mem[3],mem[7]'</strong>.This is now a string with the tokens separated <span class="No-Break">by commas.</span></p>&#13;
			<p lang="en-GB">The next step <a id="_idIndexMarker226"/>is to create a list of tokens so that we can access the individual components of the instruction. The effect of <strong class="source-inline">inst2 = inst1.split(',')</strong> is to create a list <span class="No-Break">of strings:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>inst2 = ['add', 'r[4]', 'mem[3]', 'mem[7]']</span></pre>&#13;
			<p lang="en-GB">The <strong class="source-inline">split()</strong> method takes a string and creates a list of strings using the delimiter specified as a parameter. If <strong class="source-inline">y = x.split('!')</strong>, the value of <strong class="source-inline">y</strong> is a list of strings and the separator is <strong class="source-inline">!</strong>. An example of the use of <strong class="source-inline">split()</strong> is <span class="No-Break">shown here:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>&gt;&gt;&gt; x = 'asssfg! !   !,!!rr'</span>&#13;
<span>&gt;&gt;&gt; x</span>&#13;
<span>'asssfg! !   !,!!rr'</span>&#13;
<span>&gt;&gt;&gt; y = x.split('!')</span>&#13;
<span>&gt;&gt;&gt; y</span>&#13;
<span>['asssfg', ' ', '   ', ',', '', 'rr']</span></pre>&#13;
			<p lang="en-GB">The <strong class="source-inline">token2 = inst2[2]</strong> line gives <strong class="source-inline">token2 = 'mem[3]'</strong>; that is, the <span class="No-Break">fourth token.</span></p>&#13;
			<p lang="en-GB">The <strong class="source-inline">value2 = int(token2[4])</strong> line gives <strong class="source-inline">value2 = 3</strong> because the second slice is the 3 in the <strong class="source-inline">'mem[3]'</strong> string. Note that we use the <strong class="source-inline">int()</strong> function to convert the characters 4, 3, and 7 into integer values. When going from strings to numeric operations, you have to remember to convert between character and <span class="No-Break">integer types.</span></p>&#13;
			<p lang="en-GB">If we execute this program, we get the <span class="No-Break">following output:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>Registers:  [0, 0, 0, 0, <strong class="bold">6</strong>, 0, 0, 0]    <span class="sc-comment">Output from the program. The correct value is in r4</span></span></pre>&#13;
			<p lang="en-GB">Now that we’ve <a id="_idIndexMarker227"/>introduced the fundamental components of a simulator, the next step is to construct a computer that can handle more instructions, albeit a tiny subset of typical operations. However, this is a subset that includes all categories of real <span class="No-Break">computer operations.</span></p>&#13;
			<h1 id="_idParaDest-65" lang="en-GB"><a id="_idTextAnchor065"/>Building a simple computer interpreter in Python</h1>&#13;
			<p lang="en-GB">We can take the concept of a simulator a step further and execute a program with multiple instructions <a id="_idIndexMarker228"/>using the concepts we just developed. Consecutive instructions are executed by reading them from program memory, one by one, and using a program counter to keep track of where we are in <span class="No-Break">the program.</span></p>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB">Please be aware <a id="_idIndexMarker229"/>of a possible source of confusion when we refer to a <em class="italic">program</em>. We are writing a program in the high-level language Python to simulate a computer. That simulated computer runs a program written in assembly language. Consequently, the term program can refer to two different entities. It should be clear from the context which one we are <span class="No-Break">referring to.</span></p>&#13;
			<p lang="en-GB">Note that pseudocode is not a computer language, but a method of expressing a computer algorithm in almost plain English. So, a piece of pseudocode can represent either a high-level language such as Python or an <span class="No-Break">assembly language.</span></p>&#13;
			<p lang="en-GB">In the following example, the source program of assembly language instructions is expressed as a Python list, where each instruction is a string: </p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>prog=['LDRL r0 0','LDRL r1 0','ADDL r1 r1 1','ADD r0 r0 r1','CMPL r1 10', \</span>&#13;
<span>     'BNE 2','STOP']</span></pre>&#13;
			<p lang="en-GB">The effect of these instructions is <span class="No-Break">as follows:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>LDRL r0 0           <span class="sc-comment">Load r0 with literal 0</span></span>&#13;
<span>ADDL r1 r1 1        <span class="sc-comment">Add 1 to r1 and put the result in </span><span class="sc-comment">r1</span></span>&#13;
<span>ADD  r0 r0 r1       <span class="sc-comment">Add r1 to r0 and put the result in r0</span></span>&#13;
<span>CMPL r1 10          <span class="sc-comment">Compare the contents of r1 with literal 10</span></span>&#13;
<span>BNE  2              <span class="sc-comment">Branch to instruction 2 if the last result is not 0</span></span>&#13;
<span>STOP                <span class="sc-comment">Stop</span></span></pre>&#13;
			<p lang="en-GB">To simplify the Python code, we’ve used spaces as separators – for example, <strong class="source-inline">LDRL r0,0</strong> is written as <strong class="source-inline">LDRL </strong><span class="No-Break"><strong class="source-inline">r0 0</strong></span><span class="No-Break">.</span></p>&#13;
			<p lang="en-GB">Real computers store assembly language instructions as strings of 32- or 64-bit binary numbers. We’re going to directly execute the assembly language instructions from the text string to avoid having to translate text into binary and then interpret the binary as instructions. Here, we have one goal: to demonstrate how a program <span class="No-Break">is executed.</span></p>&#13;
			<p lang="en-GB">The computer <a id="_idIndexMarker230"/>on which the preceding assembly-level code runs has only a handful of instructions, although it is very easy to add extra instructions. Throughout this <a id="_idIndexMarker231"/>text, the term <em class="italic">opcode</em> or operation code indicates the binary code (or text version) of an assembly language instruction such as <strong class="source-inline">ADD</strong> or <strong class="source-inline">BNE</strong>. The structure of the simulator program in pseudocode is <span class="No-Break">as follows:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>prog=['LDRL r0 0','LDRL r1 0','ADDL r1 r1 1','ADD r0 r0 r1', \</span>&#13;
<span>      'CMPL r1 10','BNE 2','STOP']</span>&#13;
<span>Define and initialize variables (PC, registers, memory)</span>&#13;
<span>while run == True:</span>&#13;
<span>   read instruction from prog</span>&#13;
<span>   point to next instruction (increment program counter)</span>&#13;
<span>   split instruction into fields (opcode plus operands)</span>&#13;
<span>   if   first field = op-code1 get operands and execute</span>&#13;
<span>   elif first field = op-code2 get operands and execute</span>&#13;
<span>   elif first field = op-code3 . . .</span>&#13;
<span>   . . .</span></pre>&#13;
			<pre class="source-code">   else declare an error if no instruction matches.</pre>&#13;
			<p lang="en-GB">This assembly language program, <strong class="source-inline">prog</strong> (provided as a list in the simulator code), uses a conditional branch, <strong class="source-inline">BNE 2</strong>, to jump back to instruction 2 if the previous operation result was not 0. The assembly language version in the Python program in the following section uses a symbolic name, <strong class="source-inline">Loop</strong>, to indicate the target of the branch, but the actual code uses a literal 2. We will look at how symbolic names such as <strong class="source-inline">Loop</strong> are <span class="No-Break">handled later.</span></p>&#13;
			<h2 id="_idParaDest-66" lang="en-GB"><a id="_idTextAnchor066"/>Python code for a primitive simulator</h2>&#13;
			<p lang="en-GB">The following is <a id="_idIndexMarker232"/>the Python code for this simulator. The initial series of comments on lines 0 to 6 show the assembly language <span class="No-Break">pro :</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>#                                 <span class="sc-comment">@ Test fetch/execute cycle</span></span>&#13;
<span>#0       LDRL r0 0                <span class="sc-comment">@ </span><span class="sc-comment">Load register r0 with 0 (the sum)</span></span>&#13;
<span>#1       LDRL r1 0                <span class="sc-comment">@ Load register r1 with 0 (the counter)</span></span>&#13;
<span>#2 Loop  ADDL r1 r1 1             <span class="sc-comment">@ REPEAT Increment counter in r1. Loop address = 2</span></span>&#13;
<span>#3       ADD  r0 r0 r1            <span class="sc-comment">@</span><span class="sc-comment"> Add the count to the sum in r0</span></span>&#13;
<span>#4       CMPL r1 10               <span class="sc-comment">@ Compare the count with 10</span></span>&#13;
<span>#5       BNE  Loop                <span class="sc-comment">@ Branch back to Loop until all numbers added (BNE 2)</span></span>&#13;
<span>#6       STOP                     <span class="sc-comment">@ Terminate execution</span></span>&#13;
<span>prog=['LDRL r0 0','LDRL r1 0','ADDL r1 r1 1','ADD r0 r0 r1','CMPL r1 10', \</span>&#13;
<span>      'BNE 2','STOP']</span>&#13;
<span>r = [0] * 8                       <span class="sc-comment"># Initialize r[0], r[1], ... r[7] and initialize to 0</span></span>&#13;
<span>z = 0                             <span class="sc-comment"># Z is zero flag: if a compare result is 0, z = 1</span></span>&#13;
<span>run = True                        <span class="sc-comment"># Run flag True to execute</span></span>&#13;
<span>pc = 0                            <span class="sc-comment"># Pc is program counter, initially 0</span></span>&#13;
<span>while run == True:                <span class="sc-comment"># The fetch/execute loop</span></span>&#13;
<span>    inst = prog[pc]               <span class="sc-comment"># Read next instruction from memory</span></span>&#13;
<span>    oldPC = pc                    <span class="sc-comment"># Save the old value of the the pc (program counter)</span></span>&#13;
<span>    pc = pc + 1                   <span class="sc-comment"># Point to the next instruction</span></span>&#13;
<span>    inst = inst.split(' ')        <span class="sc-comment"># Split divides the instruction into tokens (separate fields)</span></span>&#13;
<span>    if inst[0] == 'ADD':          <span class="sc-comment"># Test for ADD rd,rS1,rS2 instruction</span></span>&#13;
<span>        rd  = int(inst[1][1])     <span class="sc-comment"># Get dest, source 1 and source 2</span></span>&#13;
<span>        rS1 = int(inst[2][1])</span>&#13;
<span>        rS2 = int(inst[3][1])</span>&#13;
<span>        r[rd] = r[rS1] + r[rS2]   <span class="sc-comment"># Add reg 1 and 2 sum in destination register</span></span>&#13;
<span>    elif inst[0] == 'ADDL':       <span class="sc-comment"># Test for ADD literal instruction, ADDL</span></span>&#13;
<span>        rd  = int(inst[1][1])     <span class="sc-comment"># If found, get destination register</span></span>&#13;
<span>        rS1 = int(inst[2][1])     <span class="sc-comment"># Now get source 1 register</span></span>&#13;
<span>        literal =  int(inst[3])   <span class="sc-comment"># Now get the literal</span></span>&#13;
<span>        r[rd] = r[rS1] + literal  <span class="sc-comment"># Add reg 1 and literal</span></span>&#13;
<span>    elif inst[0] == 'BNE':        <span class="sc-comment"># Test for branch on not zero</span></span>&#13;
<span>        if z == 0:                <span class="sc-comment"># I</span><span class="sc-comment">f z is 0 (last register not zero)</span></span>&#13;
<span>           pc = int(inst[1])      <span class="sc-comment"># Get branch destination from operation</span></span>&#13;
<span>    elif inst[0] == 'CMPL':       <span class="sc-comment"># Test register for equality with a literal</span></span>&#13;
<span>        z = 0                     <span class="sc-comment"># Set z flag to 0 (assume not equal)</span></span>&#13;
<span>        rVal = r[int(inst[1][1])] <span class="sc-comment"># Register value</span></span>&#13;
<span>        intVal = int(inst[2])     <span class="sc-comment"># Literal value</span></span>&#13;
<span>        if rVal == intVal: z = 1  <span class="sc-comment"># If reg value =s literal, z=1</span></span>&#13;
<span>    elif inst[0] == 'LDRL':       <span class="sc-comment"># Test for load literal into register operation</span></span>&#13;
<span>        rd = int(inst[1][1])      <span class="sc-comment"># Get destination register</span></span>&#13;
<span>        data = int(inst[2])       <span class="sc-comment"># Test literal value</span></span>&#13;
<span>        r[rd] = data              <span class="sc-comment"># Store literal in destination register</span></span>&#13;
<span>    elif inst[0] == 'STOP':       <span class="sc-comment"># Test for STOP instruction</span></span>&#13;
<span>        run = False               <span class="sc-comment"># If STOP found, then set run flag to False</span></span>&#13;
<span>        print('End of program reached')</span>&#13;
<span>    else:                         <span class="sc-comment"># If we end up here, not a valid instruction</span></span>&#13;
<span>        run = False               <span class="sc-comment"># So set run flag to False and stop</span></span>&#13;
<span>        print('Error: illegal instruction ',inst)</span>&#13;
<span>    print('PC = ',oldPC,'r0 = ',r[0],'r1 = ',r[1],'z = ',z)  <span class="sc-comment"># Print results</span></span>&#13;
<span>                                  <span class="sc-comment"># Repeat loop until Run = False</span></span></pre>&#13;
			<p lang="en-GB">The interesting <a id="_idIndexMarker233"/>part of the code is extracting the operands from the instruction. Consider the <strong class="source-inline">ADDL r1 r2 3</strong> instruction, which means add a literal to the source register and put the sum in the destination register. The destination register is <strong class="source-inline">r1</strong>, the source register is <strong class="source-inline">r2</strong>, and the literal <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">3</strong></span><span class="No-Break">.</span></p>&#13;
			<p lang="en-GB">The Python <strong class="source-inline">inst = inst.split(' ')</strong> operation converts a string into a list of substrings using a space as a separator. Therefore, the new value of <strong class="source-inline">inst</strong> is the <span class="No-Break">following list:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>inst =  ['ADDL', 'r1', 'r2', '3'] <span class="sc-comment"># An instruction converted into a list of substrings</span></span></pre>&#13;
			<p lang="en-GB">We can now examine the four fields of this list; for example, <strong class="source-inline">inst[0] = 'ADDL'</strong> gives us the actual <span class="No-Break">instruction mnemonic.</span></p>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB">Suppose we want to get the contents of the source register, <strong class="source-inline">r2</strong>. The source register is in the third position in the list at <strong class="source-inline">['ADDL', 'r1', 'r2', '3']</strong>; that is, <strong class="source-inline">inst[2]</strong>. Let’s write <strong class="source-inline">rS1 = inst[2]</strong>. The value of <strong class="source-inline">rS1</strong> <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">'r2'</strong></span><span class="No-Break">.</span></p>&#13;
			<p lang="en-GB">We want the register number (that is, 2) as an integer, so we have to get the second character of r2 and convert it into an integer. We can do this in the <span class="No-Break">following way:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>rS1 = int(rS1<span class="pcode-bold">[1]</span>)              <span class="sc-comment"># get second character of the rS1 string and convert it into an integer</span></span></pre>&#13;
			<p lang="en-GB">We can combine these two expressions into one <span class="No-Break">as follows.</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span><strong class="source-inline">rS1 = int(inst[2]</strong><span class="pcode-bold">[1]</span><strong class="source-inline">)</strong>        <span class="sc-comment"># inst[2][1], which gets character 1 of substring 2</span><span class="sc-comment">.</span></span></pre>&#13;
			<p lang="en-GB">The tiny computer we have created executed only five different instructions, but it includes many <a id="_idIndexMarker234"/>of the most important components of a real computer. This computer directly executes instructions from their assembly language form, rather than from their binary code. The next step is to look a little more closely at instruction sets before we can build a more <span class="No-Break">realistic machine.</span></p>&#13;
			<p lang="en-GB">Having constructed a simulator, the next step is to look at the type of instructions a computer <span class="No-Break">can execute.</span></p>&#13;
			<p lang="en-GB">In the next section, we will develop an instruction set for the TC1 computer. As well as providing a practical example of instruction set design, we will demonstrate how instructions are divided into multiple fields and each field supplies some information about the <span class="No-Break">current instruction.</span></p>&#13;
			<h2 id="_idParaDest-67" lang="en-GB"><a id="_idTextAnchor067"/>The TC1 instruction set</h2>&#13;
			<p lang="en-GB">In this section, we will <a id="_idIndexMarker235"/>introduce the key component of our demonstration computer: its instruction set. This computer, TC1, has many <a id="_idIndexMarker236"/>of the functions of a real computer and is easy to understand and modify. We will begin by introducing the TC1 instruction <span class="No-Break">set encoding.</span></p>&#13;
			<p lang="en-GB">To simplify this, we can use separate programs and data memories. This departure from the traditional von Neuman model allows us to have a 32-bit program memory and a 16-bit data memory. Moreover, we don’t have to worry about accidentally putting data in the middle of the <span class="No-Break">program area.</span></p>&#13;
			<p lang="en-GB">A typical instruction has several fields; for example, operation code, registers, and literals (that is, constants). However, the number of bits in each field must add up to the total length of <span class="No-Break">the instruction.</span></p>&#13;
			<p lang="en-GB">Modern computers normally employ different formats for each class of instruction. This optimizes the allocation of op-codes to bits; for example, a branch instruction may have a 4-bit opcode and a 28-bit literal field, whereas a data-processing instruction may have a 17-bit opcode and three 5-bit <span class="No-Break">register-select fields.</span></p>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB">For the sake of simplicity, the TC1 computer has a single, fixed format. All instructions have the same number of fields, and fields are the same size for each instruction. An instruction, as shown in <span class="No-Break"><em class="italic">Figure 4</em></span><em class="italic">.1</em>, is made up of an operation <em class="italic">class</em> plus an opcode, three register fields, and a literal field. <span class="No-Break"><em class="italic">Figure 4</em></span><em class="italic">.1</em> shows the opcode field as 7 bits, with a 2-bit opcode class and a 5-bit <span class="No-Break">actual opcode.</span></p>&#13;
			<p lang="en-GB">The structure of this instruction format is inefficient because if an instruction does not access a register, the three register select fields are wasted. In a three-register instruction such as ADD r<span class="subscript">d</span>,r<span class="subscript">S1</span>,r<span class="subscript">S2</span>, the r<span class="subscript">d</span> register is the destination, r<span class="subscript">S1</span> is source register 1, and r<span class="subscript">S2</span> is source <span class="No-Break">register 2:</span></p>&#13;
			<div class="_idGenObjectLayout-1">&#13;
				<div id="_idContainer037" class="IMG---Figure">&#13;
					<img class="_idGenObjectAttribute-1" src="Images/Figure_4.01_B19624.jpg" alt="Figure 4.1 – TC1 instruction format (RISC style)" width="1109" height="282"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.1 – TC1 instruction format (RISC style)</p>&#13;
			<p lang="en-GB">We devote 16 bits to the literal field so that we can load a constant into memory with a single instruction. That leaves 32 - 16 = 16 bits to allocate to all the <span class="No-Break">other fields.</span></p>&#13;
			<p lang="en-GB">TC1 has a three-register format, which is typical of load and store computers such as ARM and MIPS. If we have eight registers, it takes 3 x 3 = 9 bits to specify all three registers. After allocating 16 bits to the literal and 9 bits to the register selection, we are left with 32 - (16 + 9) = 7 bits to specify up to 128 different possible instructions (2<span class="superscript">7</span> = <span class="No-Break">128).</span></p>&#13;
			<p lang="en-GB">The opcode field itself is divided into four categories or classes, which take two bits, leaving 7- 2 = 5 for the instructions in each category. <em class="italic">Table 4.1</em> defines the categories (class) <span class="No-Break">of instructions:</span></p>&#13;
			<table id="table001-3" class="No-Table-Style">&#13;
				<colgroup>&#13;
					<col/>&#13;
					<col/>&#13;
					<col/>&#13;
				</colgroup>&#13;
				<thead>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-1">&#13;
							<p class="IMG---Figure" lang="en-GB"><strong class="bold CharOverride-1">Class</strong></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-1">&#13;
							<p class="IMG---Figure ParaOverride-1" lang="en-GB"><strong class="bold CharOverride-2">Group</strong></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-2">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="bold">Comments</strong></span></p>&#13;
						</td>&#13;
					</tr>&#13;
				</thead>&#13;
				<tbody>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="IMG---Figure" lang="en-GB"><span class="CharOverride-3" lang="en-US" xml:lang="en-US">0 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="IMG---Figure ParaOverride-1" lang="en-GB"><span class="CharOverride-3" lang="en-US" xml:lang="en-US">Special operation</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="IMG---Figure ParaOverride-1" lang="en-GB"><span class="CharOverride-3" lang="en-US" xml:lang="en-US">Operations that perform functions such as </span><strong class="source-inline CharOverride-4">STOP</strong><span class="CharOverride-3" lang="en-US" xml:lang="en-US"> or read the keyboard</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="IMG---Figure" lang="en-GB"><span class="CharOverride-3" lang="en-US" xml:lang="en-US">0 1</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="IMG---Figure ParaOverride-1" lang="en-GB"><span class="CharOverride-3" lang="en-US" xml:lang="en-US">Data transfer</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="IMG---Figure ParaOverride-1" lang="en-GB"><span class="CharOverride-3" lang="en-US" xml:lang="en-US">Operations that copy data from one place to another</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="IMG---Figure" lang="en-GB"><span class="CharOverride-3" lang="en-US" xml:lang="en-US">1 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="IMG---Figure ParaOverride-1" lang="en-GB"><span class="CharOverride-3" lang="en-US" xml:lang="en-US">Data processing</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="IMG---Figure ParaOverride-1" lang="en-GB"><span class="CharOverride-3" lang="en-US" xml:lang="en-US">Arithmetic and logic data-processing operations</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="IMG---Figure" lang="en-GB"><span class="CharOverride-3" lang="en-US" xml:lang="en-US">1 1</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="IMG---Figure ParaOverride-1" lang="en-GB"><span class="CharOverride-3" lang="en-US" xml:lang="en-US">Flow control</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="IMG---Figure ParaOverride-1" lang="en-GB"><span class="CharOverride-3" lang="en-US" xml:lang="en-US">Operations that control the sequencing of instructions, such as </span><strong class="source-inline CharOverride-4">BEQ</strong></p>&#13;
						</td>&#13;
					</tr>&#13;
				</tbody>&#13;
			</table>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 4.1 – TC1 instruction classes</p>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB"><em class="italic">Table 4.2</em> illustrates the <a id="_idIndexMarker237"/>TC1 instruction set. The first column (<strong class="bold">Binary Code</strong>) provides the 7-bit instruction code; for example, <strong class="source-inline">01 00001</strong> loads a register with the contents of a memory location. The leftmost two bits are separated to indicate the <span class="No-Break">instruction group:</span></p>&#13;
			<table id="table002-3" class="No-Table-Style">&#13;
				<colgroup>&#13;
					<col/>&#13;
					<col/>&#13;
					<col/>&#13;
					<col/>&#13;
					<col/>&#13;
				</colgroup>&#13;
				<thead>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="No-Break"><strong class="bold">Binary Code</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="No-Break"><strong class="bold">Operation</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="No-Break"><strong class="bold">Mnemonic</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="No-Break"><strong class="bold">Instruction Format</strong></span></p>&#13;
							<p class="ParaOverride-2" lang="en-GB"><strong class="bold">rrr = Rd, aaa = rS1, bbb = </strong><span class="No-Break"><strong class="bold">rS2</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><strong class="bold">Code </strong><span class="No-Break"><strong class="bold">Format</strong></span></p>&#13;
						</td>&#13;
					</tr>&#13;
				</thead>&#13;
				<tbody>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">00 00000</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-5">Stop operation</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">STOP</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">00 00000 000 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">0 0 </span><span class="No-Break CharOverride-5">0 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">00 00001</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-5">No operation</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">NOP</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">00 00001 000 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">0 0 </span><span class="No-Break CharOverride-5">0 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><strong class="source-inline">00 </strong><span class="No-Break"><strong class="source-inline">00 010</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Get a char from </span><span class="No-Break CharOverride-5">the</span><span class="No-Break CharOverride-5" lang="ar-SA" xml:lang="ar-SA"> </span><span class="No-Break CharOverride-5">keyboard</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">GET</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">00 00010 rrr 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">00 00011</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Get a </span><span class="No-Break CharOverride-5">random character</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">RND</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">00 00011 rrr 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">00 00100</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Swap bytes in </span><span class="No-Break CharOverride-5">the register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">SWAP r0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">00 00100 rrr 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">00 01000</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Print a hex value in </span><span class="No-Break CharOverride-5">the register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">PRT  </span><span class="No-Break CharOverride-6">r0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">00 01000 rrr 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">00 11111</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-5">Terminate program</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">END</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">00 11111 000 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">0 0 </span><span class="No-Break CharOverride-5">0 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">01 00000</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Load register </span><span class="No-Break CharOverride-5">from register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">MOV</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,r1</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">01 00000 rrr aaa </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">0 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">01 00001</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Load register </span><span class="No-Break CharOverride-5">from memory</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">LDRM r0,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">01 00001 rrr 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">01 00010</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Load register </span><span class="No-Break CharOverride-5">with literal</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">LDRL r0,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">01 00010 rrr 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">01 00011</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Load </span><span class="No-Break CharOverride-5">register indirect</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">LDRI r0,[r1,L]</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">01 00011 rrr aaa </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">01 00100</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Store register </span><span class="No-Break CharOverride-5">in memory</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">STRM r0,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">01 00100 rrr 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">01 00101</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Store </span><span class="No-Break CharOverride-5">register indirect</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">STRI r0,[r1,L]</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">01 00101 rrr aaa </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 00000</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Add register </span><span class="No-Break CharOverride-5">to register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">ADD</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,r1,r2</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 00000 rrr aaa </span><span class="No-Break CharOverride-6">bbb 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">1 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 00001</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Add register </span><span class="No-Break CharOverride-5">to literal</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">ADDL r0,r1,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 00001 rrr aaa </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 00010</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Subtract register </span><span class="No-Break CharOverride-5">from register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">SUB</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,r1,r2</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 00010 rrr aaa </span><span class="No-Break CharOverride-6">bbb 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">1 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 00011</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Subtract literal </span><span class="No-Break CharOverride-5">from register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">SUBL r0,r1,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 00011 rrr aaa </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 00100</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Multiply register </span><span class="No-Break CharOverride-5">by register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">MUL</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,r1,r2</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 00100 rrr aaa </span><span class="No-Break CharOverride-6">bbb 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">1 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 00101</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Multiply literal </span><span class="No-Break CharOverride-5">by register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">MULL r0,r1,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 00101 rrr aaa </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 00110</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Divide register </span><span class="No-Break CharOverride-5">by register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">DIV</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,r1,r2</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 00110 rrr aaa </span><span class="No-Break CharOverride-6">bbb 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">1 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 00111</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Divide register </span><span class="No-Break CharOverride-5">by literal</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">DIVL r0,r1,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 00111 rrr aaa </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 01000</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Mod register </span><span class="No-Break CharOverride-5">by register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">MOD</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,r1,r2</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 01000 rrr aaa </span><span class="No-Break CharOverride-6">bbb 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">1 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 01001</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Mod register </span><span class="No-Break CharOverride-5">by literal</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">MOD</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,r1,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 01001 rrr aaa </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 01010</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">AND register </span><span class="No-Break CharOverride-5">to register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">AND</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,r1,r2</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 01000 rrr aaa </span><span class="No-Break CharOverride-6">bbb 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">1 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 01011</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">AND register </span><span class="No-Break CharOverride-5">to literal</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">ANDL r0,r1,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 01001 rrr aaa </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 01100</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">OR register </span><span class="No-Break CharOverride-5">to register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">OR</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">   </span><span class="No-Break CharOverride-6">r0,r1,r2</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 01010 rrr aaa </span><span class="No-Break CharOverride-6">bbb 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">1 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 01101</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">OR register </span><span class="No-Break CharOverride-5">to literal</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">ORL</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,r1,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 01011 rrr aaa </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 01110</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">EOR register </span><span class="No-Break CharOverride-5">to register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">EOR</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,r1,r2</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 01010 rrr aaa </span><span class="No-Break CharOverride-6">bbb 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">1 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 01111</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">EOR register </span><span class="No-Break CharOverride-5">to literal</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">EORL r0,r1,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 01011 rrr aaa </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 10000</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-5">NOT register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">NOT</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10000 rrr 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 10010</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-5">Increment register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">INC</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10010 rrr 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 10011</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-5">Decrement register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">DEC</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10011 rrr 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 10100</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Compare register </span><span class="No-Break CharOverride-5">with register</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">CMP</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,r1</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10100 rrr aaa </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">0 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 10101</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Compare register </span><span class="No-Break CharOverride-5">with literal</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">CMPL r0,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10101 rrr 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 10110</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Add </span><span class="No-Break CharOverride-5">with carry</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">ADC</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,r1,r2</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10110 rrr aaa </span><span class="No-Break CharOverride-6">bbb 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">1 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 10111</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Subtract </span><span class="No-Break CharOverride-5">with borrow</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">SBC</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,r1,r2</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10111 rrr aaa </span><span class="No-Break CharOverride-6">bbb 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 1 </span><span class="No-Break CharOverride-5">1 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 11000</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Logical </span><span class="No-Break CharOverride-5">shift left</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">LSL</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10000 rrr 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 11001</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Logical shift </span><span class="No-Break CharOverride-5">left literal</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">LSLL r0,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10000 rrr 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 11010</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Logical </span><span class="No-Break CharOverride-5">shift right</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">LSR</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10001 rrr 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 11011</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Logical shift </span><span class="No-Break CharOverride-5">right literal</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">LSRL r0,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10001 rrr 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 11100</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-5">Rotate left</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">ROL</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10010 rrr 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 11101</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Rotate </span><span class="No-Break CharOverride-5">left literal</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">ROLL r0,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10010 rrr 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 11110</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-5">Rotate right</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">ROR</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="No-Break CharOverride-6">r0,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10010 rrr 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">10 11111</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Rotate </span><span class="No-Break CharOverride-5">right literal</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">RORL r0,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">10 10010 rrr 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-6">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">11 00000</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-5">Branch unconditionally</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">BRA</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="CharOverride-6">L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">11 00000 000 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">0 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-6">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">11 00001</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Branch </span><span class="No-Break CharOverride-5">on zero</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">BEQ</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="CharOverride-6">L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">11 00001 000 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">0 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-6">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">11 00010</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Branch on </span><span class="No-Break CharOverride-5">not zero</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">BNE</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="CharOverride-6">L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">11 00010 000 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">0 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-6">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">11 00011</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Branch </span><span class="No-Break CharOverride-5">on minus</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">BMI</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="CharOverride-6">L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">11 00011 000 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">0 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-6">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">11 00100</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Branch </span><span class="No-Break CharOverride-5">to subroutine</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">BSR</span><span class="CharOverride-6" lang="ar-SA" xml:lang="ar-SA">  </span><span class="CharOverride-6">L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">11 00100 000 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">0 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-6">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">11 00101</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Return </span><span class="No-Break CharOverride-5">from subroutine</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">RTS</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">11 00101 000 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">0 0 </span><span class="No-Break CharOverride-5">0 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-6">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">11 00110</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5" lang="ar-SA" xml:lang="ar-SA">Decrement and branch on </span><span class="No-Break CharOverride-5" lang="ar-SA" xml:lang="ar-SA">not ٠</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">DBNE r0,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">11 00110 rrr 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-6">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">11 00111</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Decrement and branch </span><span class="No-Break CharOverride-5">on zero</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">DBEQ r0,L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">11 00111 rrr 000 </span><span class="No-Break CharOverride-6">000 L</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-6">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">11 01000</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Push register on </span><span class="No-Break CharOverride-5">the stack</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">PUSH r0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">11 01000 rrr 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-6">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="source-inline">11 01001</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-5">Pull register off </span><span class="No-Break CharOverride-5">the stack</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="No-Break CharOverride-6">PULL r0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB"><span class="CharOverride-6">11 01001 rrr 000 </span><span class="No-Break CharOverride-6">000 0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-4">&#13;
							<p lang="en-GB"><span class="CharOverride-5">1 0 </span><span class="No-Break CharOverride-5">0 0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
				</tbody>&#13;
			</table>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 4.2 – TC1 Instruction encoding (the 4 code format bits are not part of the opcode)</p>&#13;
			<p lang="en-GB">The rightmost <a id="_idIndexMarker238"/>column is called <strong class="bold">Code Format</strong> and is not part of the instruction. This code can be derived from the opcode (as we shall see) and tells the simulator what information is required from the instruction. Each bit of the code format corresponds to an operand. If a bit in the code format is 1, the corresponding operand in the instruction must be extracted. The order of the code format bits (left to right) is destination register, source register 1, source register 2, literal; for example, code <strong class="source-inline">1001</strong> tells the assembler that the <a id="_idIndexMarker239"/>instruction requires a destination register and a 16-bit literal. Code 0000 tells us that the instruction contains no operands <span class="No-Break">at all.</span></p>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB">We chose these instructions to demonstrate a range of operations. Many of these instructions are typical of a RISC computer such as ARM (that is, we don’t include operations on data in memory). Note that later, we’ll introduce a simulator for a memory-to-register instruction set that allows operations such as <strong class="source-inline">ADD r1,12</strong>, where <strong class="source-inline">12</strong> is a <span class="No-Break">memory location.</span></p>&#13;
			<p lang="en-GB">Some instructions in <em class="italic">Table 4.2</em> don’t exist on a real computer; for example, read a character from the keyboard. We added that to simplify debugging and experimentation. Similarly, TC1 can generate a random number, a feature not found in most computer instruction sets. However, it’s useful for generating random test data. Some instructions, such as <a id="_idIndexMarker240"/>subroutine calls and returns, implement more sophisticated operations, which we shall <span class="No-Break">encounter later.</span></p>&#13;
			<p lang="en-GB">The column labeled <strong class="bold">Operation</strong> in <em class="italic">Table 4.2</em> describes the instruction in words; the third column provides the instruction’s mnemonic, where <strong class="source-inline">L</strong> indicates a literal value (that is, a <span class="No-Break">16-bit constant).</span></p>&#13;
			<p lang="en-GB">The fourth <a id="_idIndexMarker241"/>column (<strong class="bold">Instruction Format</strong>) defines the instruction’s encoding in binary. The fields containing <strong class="source-inline">rrr</strong>, <strong class="source-inline">aaa</strong>, and <strong class="source-inline">bbb</strong> show the location of the three register select fields. The rightmost field (<strong class="source-inline">0</strong> or <strong class="source-inline">L</strong>) represents 16 bits of the literal. We show <strong class="source-inline">0</strong> if all bits are 0, and <strong class="source-inline">L</strong> if a 16-bit literal is required by the instruction. If a register field is not required, the corresponding field is filled with zeros (although it doesn’t matter what value these bits are because they are not used by <span class="No-Break">the instruction).</span></p>&#13;
			<p lang="en-GB">Remember that the four bits in the rightmost column are not part of the opcode or instruction itself. These bits show which fields are required by the current instruction: the destination register (<strong class="source-inline">rrr</strong>), the source 1 register (<strong class="source-inline">aaa</strong>), the source 2 register (<strong class="source-inline">bb</strong>), and the literal, <strong class="source-inline">L</strong>. For example, code <strong class="source-inline">1100</strong> indicates that the instruction has a destination register and a single <span class="No-Break">source register.</span></p>&#13;
			<h3 lang="en-GB">Explaining some of the instructions</h3>&#13;
			<p lang="en-GB">Some of the <a id="_idIndexMarker242"/>instructions in <em class="italic">Table 4.2</em> are typical of real processors. Several instructions have been included to provide useful facilities such as generating a random number for testing purposes. This section describes several of the instructions in <span class="No-Break"><em class="italic">Table 4.2</em></span><span class="No-Break">.</span></p>&#13;
			<p lang="en-GB"><strong class="source-inline">STOP</strong> terminates instruction processing. Most modern computers don’t have an explicit <span class="No-Break"><strong class="source-inline">STOP</strong></span><span class="No-Break"> operation.</span></p>&#13;
			<p lang="en-GB"><strong class="source-inline">NOP</strong> does nothing other than advance the program counter. It’s a dummy operation that is useful as a marker in code, a placeholder for future code, or as an aid <span class="No-Break">to testing.</span></p>&#13;
			<p lang="en-GB"><strong class="source-inline">GET</strong> reads data from the keyboard and offers a simple way of getting input from the keyboard into a register. This is useful when testing programs and is not a normal <span class="No-Break">computer instruction.</span></p>&#13;
			<p lang="en-GB"><strong class="source-inline">RND</strong> generates a random number. It’s not in computer instruction sets but provides an excellent means of generating data internally when testing <span class="No-Break">your code.</span></p>&#13;
			<p lang="en-GB"><strong class="source-inline">SWAP</strong> exchanges upper- and lower-order bytes – for example, <strong class="source-inline">0x1234</strong> <span class="No-Break">becomes </span><span class="No-Break"><strong class="source-inline">0x3412</strong></span><span class="No-Break">.</span></p>&#13;
			<p lang="en-GB">The load and store instructions move data between memory and registers. The difference between <a id="_idIndexMarker243"/>members of this class is the direction (store is computer-to-memory, while load is memory-to-computer), size (some computers allow byte, 16-bit, or 32-bit transfers), and addressing mode (using a literal value, an absolute address, or an address from <span class="No-Break">a register).</span></p>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB"><strong class="source-inline">MOV</strong> copies one register to another – for example, <strong class="source-inline">MOV r3,r1</strong> copies the contents of <strong class="source-inline">r1</strong> to <strong class="source-inline">r3</strong>. <strong class="source-inline">MOV</strong> is, essentially, an a load register with register (<span class="No-Break">LDRR) instruction.</span></p>&#13;
			<p lang="en-GB"><strong class="source-inline">LDRL</strong> loads a register with a literal value – for example, <strong class="source-inline">LDRL r3,20</strong> loads register <strong class="source-inline">r3</strong> <span class="No-Break">with </span><span class="No-Break"><strong class="source-inline">20</strong></span><span class="No-Break">.</span></p>&#13;
			<p lang="en-GB"><strong class="source-inline">LDRM</strong> loads a register with the contents of a memory location specified by a literal address. <strong class="source-inline">LDRM r1,42</strong> loads <strong class="source-inline">r1</strong> with the contents of memory location <strong class="source-inline">42</strong>. This instruction does not exist on modern RISC processors. Most modern processors do not allow you to access an absolute <span class="No-Break">memory address,</span></p>&#13;
			<p lang="en-GB"><strong class="source-inline">LDRI</strong>, the load register indexed (or load register indirect) instruction, loads a register with the contents of a memory location specified by the contents of a register plus a literal address. <strong class="source-inline">LDRM r2,[r3,10]</strong> loads <strong class="source-inline">r2</strong> with the contents of the memory location whose address is given by the contents of <strong class="source-inline">r3</strong> plus <strong class="source-inline">10</strong>. This instruction is the standard RISC <span class="No-Break">load operation.</span></p>&#13;
			<p lang="en-GB"><strong class="source-inline">STRM</strong>, the store register memory instruction, stores a register at the location specified by a literal address. <strong class="source-inline">STRM r2,15</strong> stores register <strong class="source-inline">r2</strong> at memory location <strong class="source-inline">15</strong>. RISC processors don’t implement <span class="No-Break">this instruction.</span></p>&#13;
			<p lang="en-GB"><strong class="source-inline">STRI</strong>, the store register indexed instruction, stores a register at the location specified by a register plus a literal. <strong class="source-inline">STRI r2,[r6,8]</strong> stores <strong class="source-inline">r2</strong> at the memory location whose address is <strong class="source-inline">r6</strong> <span class="No-Break">plus </span><span class="No-Break"><strong class="source-inline">8</strong></span><span class="No-Break">.</span></p>&#13;
			<p lang="en-GB">The <strong class="source-inline">STR</strong>, <strong class="source-inline">STRM</strong>, and <strong class="source-inline">STRI</strong> instructions are anomalous because they write the source and destination <a id="_idIndexMarker244"/>operands in the reverse order to <strong class="source-inline">LDR</strong> (and all other processor operations); that is, if you write <strong class="source-inline">LDR r0,PQR</strong>, you should write <strong class="source-inline">STR PQR,r0</strong> to indicate the reverse data flow. But, by custom and practice, <span class="No-Break">we don’t.</span></p>&#13;
			<p lang="en-GB"><strong class="source-inline">DBNE</strong> We added the decrement and branch on not zero instruction for fun because it reminds me of my old Motorola days. The 68000 was a powerful microprocessor (at the time) with a 32-bit architecture. It has a decrement and branch instruction that is used at the end of a loop. On each pass around the loop, the specified register is decremented, and a branch back to a label is made if the counter is not -1. <strong class="source-inline">DBNE r0,L</strong> decrements <strong class="source-inline">r0</strong> and branches to the line numbered <strong class="source-inline">L</strong> if the count is <span class="No-Break">not zero.</span></p>&#13;
			<h3 lang="en-GB">Register indirect addressing</h3>&#13;
			<p lang="en-GB">Two instructions require a special mention because they are concerned not with operations on <a id="_idIndexMarker245"/>data but with accessing data in memory. These are <strong class="source-inline">LDRI</strong> and <strong class="source-inline">STRI</strong>, both of which use register indirect addressing. In <em class="italic">Table 4.2,</em> the <strong class="source-inline">0b0100011</strong> opcode corresponds to <strong class="source-inline">LDRI</strong> (that is, load register <em class="italic">indirect</em>). This instruction doesn’t give you the actual address of the operand; it tells you where the address can be found. The register indirect addressing mode is also called pointer-based or indexed addressing. The operand address in memory is given by the contents of a register plus an offset; that is, <strong class="source-inline">r[rD]=mem[r[rS1]+lit]</strong>. If we use bold and shading, we can make its interpretation a <span class="No-Break">little easier:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>r[rD] = mem[<strong class="bold">r[rS1]</strong>+<span class="sc-source-bg">lit</span>]</span></pre>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB"><span class="No-Break"><em class="italic">Figure 4</em></span><em class="italic">.2</em> demonstrates the effect of the <strong class="source-inline">LDRI r1,[r0,3]</strong> TC1 instruction, where pointer register <strong class="source-inline">r0</strong> contains 100 and the operand is accessed at memory address 100 + 3 = <span class="No-Break">103:</span></p>&#13;
			<div class="_idGenObjectLayout-1">&#13;
				<div id="_idContainer038" class="IMG---Figure">&#13;
					<img class="_idGenObjectAttribute-1" src="Images/Figure_4.02_B19624.jpg" alt="Figure 4.2 – Register indirect addressing" width="903" height="450"/>&#13;
				</div>&#13;
			</div>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 4.2 – Register indirect addressing</p>&#13;
			<p lang="en-GB">This addressing mode lets you modify addresses while the program is running (because you can change <a id="_idIndexMarker246"/>the contents of the pointer, <strong class="source-inline">r0</strong>). Pointer-based addressing makes it possible to step through a list of items, element by element, simply by incrementing the pointer. Here’s <span class="No-Break">an example:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>LDRI  <strong class="bold">r1</strong>,[<strong class="bold">r</strong><span class="sc-source-bold-bg">2</span>,0]    <span class="sc-comment">@ Get the element pointed at by r2. Here the offset is 0</span></span>&#13;
<span>INC   <strong class="bold">r</strong><span class="sc-source-bold-bg">2</span>           <span class="sc-comment">@ Increment r2 to point to the next element</span></span></pre>&#13;
			<p lang="en-GB">We access the element pointed at by <strong class="source-inline">r2</strong> (in this case, the offset is <strong class="source-inline">0</strong>). The next line increments <strong class="source-inline">r2</strong> to point to the next element. If this sequence is executed in a loop, the data will be accessed element <span class="No-Break">by element.</span></p>&#13;
			<p lang="en-GB">Computers implement both arithmetic and Boolean (logical) operations. In the next section, we’ll briefly look at how Python can be used to simulate logical operations at the assembly <span class="No-Break">language level.</span></p>&#13;
			<h2 id="_idParaDest-68" lang="en-GB"><a id="_idTextAnchor068"/>Bit-handling in Python</h2>&#13;
			<p lang="en-GB">In this section, we’ll look <a id="_idIndexMarker247"/>at how Python deals with the fundamental component of all computer data: the bit. Because simulated computers operate at the level of bits, we have to look at how <a id="_idIndexMarker248"/>bits are manipulated in Python before we can construct a simulator that can perform logical operations such as <strong class="source-inline">AND</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">OR</strong></span><span class="No-Break">.</span></p>&#13;
			<p lang="en-GB">Computers can <a id="_idIndexMarker249"/>operate on entire words as a single entity, or on the individual bits of a word. Consequently, we have to be able to perform both bit operations and word operations to simulate <span class="No-Break">a computer.</span></p>&#13;
			<p lang="en-GB">Python lets you input data and display it as a binary string of bits. You can operate on individual bits of a string using Boolean operators, and you can shift the bits of a word left and right. You have all the tools you need in Python. We are now going to look at Python, which lets you operate on the individual bits of <span class="No-Break">an integer.</span></p>&#13;
			<p lang="en-GB">Because the <a id="_idIndexMarker250"/>simulator will operate on binary numbers, we have to exploit several Python facilities; for example, a binary value is indicated by prefixing it with <strong class="source-inline">0b</strong>. If you want to use the binary equivalent of 15, you must write <strong class="source-inline">0b1111</strong> and use it just like a decimal number. The following two operations have the <span class="No-Break">same effect:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>x = y + 0b111      <span class="sc-comment"># Addition using a binary integer</span></span></pre>&#13;
			<pre class="source-code">x = y + 15         <span class="sc-comment"># Addition using a decimal integer</span></pre>&#13;
			<p lang="en-GB">Two important binary operators are <strong class="source-inline">&gt;&gt;</strong> (shift right) and <strong class="source-inline">&lt;&lt;</strong> (shift left). Shift expressions are written as <strong class="source-inline">p &gt;&gt; q</strong> or <strong class="source-inline">p &lt;&lt; q</strong>, where <strong class="source-inline">p</strong> is the number to be operated on and <strong class="source-inline">q</strong> is the number of bit positions shifted. Consider the <span class="No-Break">following example:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>x = 0b1110110</span>&#13;
<span>x = x &lt;&lt; 2</span></pre>&#13;
			<p lang="en-GB">This shifts <strong class="source-inline">x</strong> two places left to give the new value <strong class="source-inline">0b111011000</strong>. All the bits have moved two places left and 0s have been entered at the right-hand end to fill the newly vacated positions. The shifted version of <strong class="source-inline">x</strong> now has nine bits, rather than seven. However, when we simulate a computer, we have to ensure that, whatever we do, the number of bits in a word remains constant. If a register has 16 bits, any operation you perform on it must yield <span class="No-Break">16 bits.</span></p>&#13;
			<p lang="en-GB">We can take two words and perform Boolean (bitwise) operations on them; for example, C = A &amp; B ANDs together words A and B by calculating c<span class="subscript">i</span> = a<span class="subscript">i</span> · b<span class="subscript">i</span> for each bit in the word (that is, for i = 0 to 7). Consider <span class="No-Break">the following:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>x = 0b11101101 &amp; 0b00001111</span></pre>&#13;
			<table id="table003-1" class="No-Table-Style">&#13;
				<colgroup>&#13;
					<col/>&#13;
					<col/>&#13;
					<col/>&#13;
				</colgroup>&#13;
				<thead>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3" colspan="3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><strong class="bold CharOverride-7">Truth table </strong><span class="No-Break"><strong class="bold CharOverride-7">for AND</strong></span></p>&#13;
						</td>&#13;
					</tr>&#13;
				</thead>&#13;
				<tbody>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-8">x</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-8">y</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-8">z=x &amp; y</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-9">0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-9">0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-9">0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-9">0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-9">1</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-9">0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-9">1</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-9">0</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-9">0</span></p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-9">1</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-9">1</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p class="ParaOverride-2" lang="en-GB"><span class="CharOverride-9">1</span></p>&#13;
						</td>&#13;
					</tr>&#13;
				</tbody>&#13;
			</table>&#13;
			<p lang="en-GB">This gives <strong class="source-inline">x = 0b000001101</strong>, because ANDing a bit with 0 gives a 0 result, and ANDing a bit x with 1 gives x, because 1 &amp; 0 = 0 and 1 &amp; 1 = 1, as the truth <span class="No-Break">table demonstrates.</span></p>&#13;
			<p lang="en-GB">In Python, hexadecimal <a id="_idIndexMarker251"/>numbers are prefixed with <strong class="source-inline">0x</strong>; for example, <strong class="source-inline">0x2F1A</strong>. We use hexadecimal numbers in Python programs because they are shorter than <a id="_idIndexMarker252"/>binary numbers. Here is <span class="No-Break">an example:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>0x1234 = 0b0001001000110100</span>&#13;
<span>0xA0C2 = 0b1010000011000010</span>&#13;
<span>0xFFFF = 0b1111111111111111</span></pre>&#13;
			<p lang="en-GB">Consider the following fragment of <span class="No-Break">Python code:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>x = 0b<strong class="bold">0011</strong>1001<strong class="bold">0101</strong>0011   <span class="sc-comment"># A 16-bit binary string we are going to process</span></span>&#13;
<span>y = (x &gt;&gt; 8) &amp; 0xF       <span class="sc-comment"># Shift x right 8 places and mask it to 4 bits</span></span>&#13;
<span>print('y is ',bin(y))    <span class="sc-comment"># Print the result in binary form using bin()</span></span></pre>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB">The output from this code is <strong class="source-inline">y </strong><span class="No-Break"><strong class="source-inline">is 0b1001</strong></span><span class="No-Break">.</span></p>&#13;
			<p lang="en-GB">Python uses more than 16 bits to represent numbers. To simulate binary arithmetic in TC1, we must constrain Python’s numbers to 16 bits. We have to work with the longer words provided by Python and chop them down to 16 or 32 bits as necessary. Consider <span class="No-Break">the following:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>x = 0xF009       <span class="sc-comment"># Set up 16-bit</span> number       <strong class="bold">1111</strong>0000<strong class="bold">0000</strong>1001</span>&#13;
<span>y = x &lt;&lt; 2       <span class="sc-comment"># Shift left twice to get</span>      11<strong class="bold">1100</strong>0000<strong class="bold">0010</strong>0100 = 0x3C024 (18 bits)</span>&#13;
<span>y = y &amp; 0xFFFF   <span class="sc-comment"># Constrain to 16 bits to get</span>     <strong class="bold">1100</strong>0000<strong class="bold">0010</strong>0100 = 0xC024</span></pre>&#13;
			<p lang="en-GB">Shifting the 16-bit <a id="_idIndexMarker253"/>word left two places made it an 18-bit word. ANDing it <a id="_idIndexMarker254"/>with the <strong class="source-inline">0b1111111111111111</strong> binary value forces it to 16 <span class="No-Break">significant bits.</span></p>&#13;
			<h2 id="_idParaDest-69" lang="en-GB"><a id="_idTextAnchor069"/>Operator precedence in Python</h2>&#13;
			<p lang="en-GB">Now, we have to re-learn something that we learned about in high school arithmetic: operator <a id="_idIndexMarker255"/>precedence. When you use several operators in an expression, you have to be aware of operator precedence; that is, which operations are performed before others. For example, is 4 * 5 + 3 equal to 23 or 32? All computer <a id="_idIndexMarker256"/>languages have a hierarchy of operator precedence. The partial list of operator precedence for Python is as follows, with the highest precedence first. We often use parentheses to make the meaning of expressions clearer, even if it’s not required – for example, <strong class="source-inline">(xxx &lt;&lt; 4) &amp; (yyy &lt;&lt; </strong><span class="No-Break"><strong class="source-inline">2)</strong></span><span class="No-Break">:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>()                          <span class="sc-comment">Parentheses</span>               <span class="sc-comment">Highest precedence</span></span>&#13;
<span>~                           <span class="sc-comment">Negation</span></span>&#13;
<span>*,/, %                      <span class="sc-comment">Multiplication, division, modulus</span></span>&#13;
<span>+,-                         <span class="sc-comment">Addition, subtraction</span></span>&#13;
<span>&lt;&lt;, &gt;&gt;                      <span class="sc-comment">Bitwise shift left, right</span></span>&#13;
<span>&amp;                           <span class="sc-comment">Logical (bitwise) AND</span></span>&#13;
<span>^                           <span class="sc-comment">Logical (bitwise) XOR</span></span>&#13;
<span>|                           <span class="sc-comment">Logical (bitwise) OR</span></span>&#13;
<span>&lt;, &lt;+, &gt;, &gt;+, &lt;&gt;, !=, ==    <span class="sc-comment">Boolean comparisons</span>         <span class="sc-comment">Lowest precedence</span></span></pre>&#13;
			<p lang="en-GB">In the next section, we’ll look at how an instruction, which is a string of 1s and 0s, is decoded and the appropriate operation <span class="No-Break">that’s performed.</span></p>&#13;
			<p lang="en-GB">Next, we’ll take a major step in constructing a simulator – that is, decoding a machine-level binary instruction to extract information about the operation it is going <span class="No-Break">to simulate.</span></p>&#13;
			<h1 id="_idParaDest-70" lang="en-GB"><a id="_idTextAnchor070"/>Decoding and executing an instruction</h1>&#13;
			<p lang="en-GB">In this section, we’ll look at a few examples of how instructions are encoded and decoded. Consider the <strong class="source-inline">ADD r1,r2,r3</strong>, operation (where the codes for registers <strong class="source-inline">rD</strong>, <strong class="source-inline">rS1</strong>, and <strong class="source-inline">rS2</strong> are shaded), which is defined in RTL <span class="No-Break">as follows:</span></p>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB"><strong class="source-inline">[r1] </strong><strong class="source-inline CharOverride-10">←</strong><strong class="source-inline"> [r2] + [</strong><span class="No-Break"><strong class="source-inline">r3]</strong></span></p>&#13;
			<p lang="en-GB"><em class="italic">Table 4.2</em> shows that the encoding of <strong class="source-inline">ADD r1,r2,r3</strong> is <strong class="source-inline">10 00000 001 010 011 0000000000000000</strong>. The corresponding 4-bit format code that defines the registers to be used is <strong class="source-inline">1110</strong> because we use three registers and no literal field (remember that this 4-bit format <a id="_idIndexMarker257"/>code is not part of the opcode but is used by the assembler to interpret <span class="No-Break">the instruction).</span></p>&#13;
			<p lang="en-GB">The following <a id="_idIndexMarker258"/>Python code shows how we can decode an instruction to extract five variables: the operation code (<strong class="source-inline">binOp</strong>); the three registers, <strong class="source-inline">rD</strong>, <strong class="source-inline">rS1</strong>, and <strong class="source-inline">rS2</strong>; and a literal. Decoding is performed by shifting the bits of the instruction right to move the required field into the least significant position and then ANDing it with a mask to remove any other fields. Consider, <strong class="source-inline">xxxxxxx xxx 010 xxx xxxxxxxxxxxxxxxx</strong>. If we shift this string 19 places right, we get <strong class="source-inline">0000000000000000000xxxxxxxxxx010</strong>. The zeros have been shifted in, and the three bits we’re interested in are right-justified in the least significant bits. If we <strong class="source-inline">AND</strong> this with <strong class="source-inline">0b111</strong> to select only the three least significant bits, we get <strong class="source-inline">0000000000000000000000000000010</strong> – that is, the required register value is now right-justified and we can <span class="No-Break">use it:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>binOp = binCode &gt;&gt; 25             <span class="sc-comment"># Extract the 7-bit opcode binOp by shifting 25 bits right</span></span>&#13;
<span>rD    = binCode &gt;&gt; 22 &amp; 0b111     <span class="sc-comment"># Extract the destination register as rD. 0b111 is a mask</span></span>&#13;
<span>rS1   = binCode &gt;&gt; 19 &amp; 0b111     <span class="sc-comment"># Extract source register 1 as rS1</span></span>&#13;
<span>rS2   = binCode &gt;&gt; 16 &amp; 0b111     <span class="sc-comment"># Extract the source register 2 as rS2</span></span>&#13;
<span>lit   = binCode &amp; 0xFFFF          <span class="sc-comment"># Extract the low-order 16 bits (the literal) as lit</span></span>&#13;
<span>op0 = r[rD]                       <span class="sc-comment"># Read contents of destination register operand 0 as op0</span></span>&#13;
<span>op1 = r[rS1]                      <span class="sc-comment"># Read contents of source 1 register as op1</span></span>&#13;
<span>op2 = r[rS2]                      <span class="sc-comment"># Read contents of source 2 register as op2</span></span></pre>&#13;
			<p lang="en-GB">The shift-right operator in Python is <strong class="source-inline">&gt;&gt;</strong> and the bit-wise logical <strong class="source-inline">AND</strong> operator is <strong class="source-inline">&amp;</strong>. The mask is expressed <a id="_idIndexMarker259"/>as a string of bits (rather than a decimal number) because ANDing with binary 111 is clearer than ANDing with decimal 7. In Python, a binary <a id="_idIndexMarker260"/>value is preceded by 0b, so 7 is represented by <strong class="source-inline">0b111</strong>. The literal is ANDed with 16 ones, expressed as <strong class="source-inline">0xFFFF</strong>. We use binary for short fields, and hex value for long fields. It’s just <span class="No-Break">personal preference.</span></p>&#13;
			<p lang="en-GB">The <strong class="source-inline">binCode &gt;&gt; 22 &amp; 0b111</strong> expression shifts the bits of <strong class="source-inline">binCode</strong> 22 places right, and then bitwise ANDs the result with <strong class="source-inline">000…000111</strong>. Because of operator precedence, the shifting is performed first. Otherwise, we would have written <strong class="source-inline">(binCode &gt;&gt; 22) &amp; 0b111</strong>. We often use parentheses, even when not strictly necessary, to stress <span class="No-Break">operator precedence.</span></p>&#13;
			<p lang="en-GB">Note that we extract all fields, even though they may not be required by each instruction. Similarly, we read all three register’s contents. This approach simplifies the Python code, at the cost <span class="No-Break">of efficiency.</span></p>&#13;
			<p lang="en-GB">Consider extracting the destination register field, <strong class="source-inline">rrr</strong>. Suppose that the instruction is <strong class="source-inline">ADD r1,r2,r3</strong>, and the opcode is <strong class="source-inline">10</strong><span class="pcode-bold">00000</span><span class="pcode-bg">001</span><span class="pcode-bold">010</span><strong class="source-inline">011</strong><span class="pcode-bold">0000000000000000</span>. We have put alternate fields in bold font and the destination field is shaded to make it easier to read. Performing a 22-bit right shift moves the destination register into the least-significant bits and leaves us with </p>&#13;
			<pre class="source-code"><strong class="source-inline">00000000000000000000001000000</strong><span class="pcode-bg">001</span>   <span class="sc-comment">(after shifting 22 places right).</span></pre>&#13;
			<p lang="en-GB">Now, if we perform the <strong class="source-inline">AND</strong> operation with 111 (all bits to the left are zero), we get <span class="No-Break">the following:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>0000000000000000000000<strong class="bold">1</strong>000000<span class="sc-source-bg">001</span>      <span class="sc-comment">(after shifting 22 places right)</span></span>&#13;
<span>00000000000000000000000000000<span class="sc-source-bg">111</span>      <span class="sc-comment">(the three-bit mask)</span></span>&#13;
<span><span class="sc-source-grey">00000000000000000000000000000</span><span class="sc-source-bold-bg">001</span>      <span class="sc-comment">(The result; the 1 in bit position 9 has been removed)</span></span></pre>&#13;
			<p lang="en-GB">We have now <a id="_idIndexMarker261"/>isolated the first register field to get <strong class="source-inline">001</strong>, which corresponds <a id="_idIndexMarker262"/>to register <strong class="source-inline">r1</strong>. The final three lines of the program to decode an instruction are <span class="No-Break">as follows:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>op0 = r[rD]    <span class="sc-comment"># Operand 0 is the contents of the destination register</span></span>&#13;
<span>op1 = r[rS1]   <span class="sc-comment"># Operand 1 is the contents of source register 1</span></span>&#13;
<span>op2 = r[rS2]   <span class="sc-comment"># Operand 2 is the contents of source register 2</span></span></pre>&#13;
			<p lang="en-GB">These instructions use the register addresses (<strong class="source-inline">rD</strong>, <strong class="source-inline">rS1</strong>, and <strong class="source-inline">rS2</strong>) to access registers; that is, the instruction specifies which registers are to be used. For example, if <strong class="source-inline">op0 = r[5],</strong> register <strong class="source-inline">r5</strong> is operand zero, the destination register. If an instruction does not specify a register, the unused field is set <span class="No-Break">to zero.</span></p>&#13;
			<p lang="en-GB">Once an instruction has been decoded, it can be executed. Fortunately, executing most instructions is remarkably easy. Consider the <span class="No-Break">following examples:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>if   opCode == 0b0100010: r[rD] = lit               <span class="sc-comment"># Load register with literal</span></span>&#13;
<span>elif opCode == 0b0100001: r[rD] = mem[lit]          <span class="sc-comment"># Load register from memory</span></span>&#13;
<span>elif opCode == 0b0100011: r[rD] = mem[op1 + lit]    <span class="sc-comment"># Load register indirect</span></span>&#13;
<span>elif opCode == 0b0100100: mem[lit] = r[rD]          <span class="sc-comment"># Store register in memory</span></span></pre>&#13;
			<p lang="en-GB">This fragment of code demonstrates the execution of four instructions from the load and store (that is, memory access) group. The Python <strong class="source-inline">if … elif</strong> construct tests each opcode in turn. The first line compares the 7-bit opcode with the binary value <strong class="source-inline">0100010</strong>, which corresponds to the <strong class="source-inline">LDRL</strong> (load a register with a literal value) instruction. Incidentally, in the final version of TC1, we made the code easier to read by comparing operations with the actual mnemonic; for example, <strong class="source-inline">'LDRL'</strong> is easier to read than its <span class="No-Break">code, </span><span class="No-Break"><strong class="source-inline">0b100010</strong></span><span class="No-Break">.</span></p>&#13;
			<p lang="en-GB">If there is a match, the code following the colon is executed, <strong class="source-inline">(r[rD] = lit)</strong>. If not, the next line uses the <strong class="source-inline">elif</strong> command to compare the opcode with 010001. If there is a match, the code after <a id="_idIndexMarker263"/>the colon is executed. In this way, the opcode is compared with all its possible values until a match <span class="No-Break">is found.</span></p>&#13;
			<p lang="en-GB">Suppose the <a id="_idIndexMarker264"/>instruction’s opcode is <strong class="source-inline">0100010</strong>, and the <strong class="source-inline">r[rD] = lit</strong> line is executed. This Python operation transfers the value of the 16-bit literal provided in the instruction to the destination register specified in the instruction. In RTL terms, it carries out <strong class="source-inline">r[rD] ← lit</strong> and is used by the programmer to load an integer into a register. Let’s say the binary pattern of the instruction code is <span class="No-Break">as follows:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>01 00010 <strong class="bold">110</strong> 000 000 <strong class="bold">0000</strong>0000<strong class="bold">1100</strong>0001,</span></pre>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB">Here, the 16-bit literal is loaded into register <strong class="source-inline">r6</strong> to implement <span class="No-Break"><strong class="source-inline">LDRL r6,193</strong></span><span class="No-Break">.</span></p>&#13;
			<h2 id="_idParaDest-71" lang="en-GB"><a id="_idTextAnchor071"/>Arithmetic and logical operations</h2>&#13;
			<p lang="en-GB">The arithmetic and logical group of operations do all the work (data processing) in a program. They include <a id="_idIndexMarker265"/>arithmetic operations (addition, subtraction, and multiplication), as well as logical operations (<strong class="source-inline">AND</strong>, <strong class="source-inline">OR</strong>, <strong class="source-inline">EOR</strong>, and <strong class="source-inline">NOT</strong>). These are <a id="_idIndexMarker266"/>three-operand instructions, apart from <strong class="source-inline">NOT</strong>; for example, <strong class="source-inline">AND r</strong><strong class="source-inline">3,r0,r5</strong> performs a bitwise <strong class="source-inline">AND</strong> between the bits of <strong class="source-inline">r0</strong> and <strong class="source-inline">r5</strong>, and puts the result <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">r3</strong></span><span class="No-Break">.</span></p>&#13;
			<p lang="en-GB">The following fragment of Python code shows how TC1 interprets four instructions in this group. There are two pairs of instructions: addition and subtraction. Each pair consists of a register-to-register operation and a register-with-literal operation; for example, <strong class="source-inline">ADD r1,r2,r3</strong> adds the contents of registers <strong class="source-inline">r2</strong> and <strong class="source-inline">r3</strong> together, whereas <strong class="source-inline">ADDL r1,r2,L</strong> adds the contents of a 16-bit literal to the contents of register <strong class="source-inline">r2</strong>. We don’t do the <a id="_idIndexMarker267"/>arithmetic here. Instead, we call a function called <strong class="source-inline">alu(f,a,b)</strong> to perform the <a id="_idIndexMarker268"/>required action. The next section will show you how to create your <span class="No-Break">own functions:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>elif opCode==0b1000000: reg[dest]=alu(1,reg[src1],<strong class="bold CharOverride-11">reg[src2]</strong>) <span class="sc-comment CharOverride-12"># Add register to register</span></span>&#13;
<span>elif opCode==0b1000001: reg[dest]=alu(1,reg[src1],<strong class="bold CharOverride-11">literal</strong>)   <span class="sc-comment CharOverride-12"># Add literal to register</span></span>&#13;
<span>elif opCode==0b1000010: reg[dest]=alu(2,reg[src1],reg[src2]) <span class="sc-comment CharOverride-12"># Subtract register from register</span></span>&#13;
<span>elif opCode==0b1000011: reg[dest]=alu(2,reg[src1],literal)   <span class="sc-comment CharOverride-12"># </span><span class="sc-comment CharOverride-12">Subtract literal from register</span></span></pre>&#13;
			<p lang="en-GB">If you were to write the full Python code required to execute each operation, it would require several lines of code per instruction. An addition operation such as <strong class="source-inline">reg[dest] = reg[src1] + reg[src2]</strong> appears simple enough, but there is more to an <span class="No-Break">arithmetic operation.</span></p>&#13;
			<p lang="en-GB">To explain why, we need to discuss the role of conditional flag bits. Recall that computers make decisions regarding whether to execute the next instruction in sequence, or whether to jump to a different place in the code (that is, an <strong class="source-inline">if…then…else</strong> construct). The decision whether to take the <strong class="source-inline">if</strong> branch or the <strong class="source-inline">else</strong> branch is determined by the outcome of an arithmetic or logical operation (this includes <span class="No-Break">compare operations).</span></p>&#13;
			<p lang="en-GB">The result of an arithmetic or logical operation is tested and used to set or clear condition code flags. These flags are usually the negative, zero, carry, and overflow flags and are written as <strong class="source-inline">n</strong>, <strong class="source-inline">z</strong>, <strong class="source-inline">c</strong>, and <strong class="source-inline">v</strong>. For example, if an operation is x = p – q and the result is x = 0, then the z-bit (zero bit) is set to 1. Similarly, if an operation yields a result that cannot be represented in 16 bits, the carry bit, c, is set. Because most computers use two’s complement arithmetic, the negative flag, n, is set if the result is negative in two’s complement terms (that is, its most significant bit is 1). The v-bit indicates arithmetic overflow <a id="_idIndexMarker269"/>and is set if the result is out of range. This means <a id="_idIndexMarker270"/>that two positive numbers have been added and the result is negative, or two negative numbers have been added and the result <span class="No-Break">is positive.</span></p>&#13;
			<p lang="en-GB"><em class="italic">Table 4.3</em> demonstrates how 4 bits can be allocated to the numbers 0 to 15 (unsigned) or -8 to 7 (signed two’s complement). It’s up to the programmer to choose the convention. However, the arithmetic remains the same for <span class="No-Break">both conventions.</span></p>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB">Consider 0110 + 1100, which is 10010 (or 0010 in 4 bits). If we interpret these figures as unsigned, the calculation gives us 6 + 12 = 2, which is incorrect, because the result 18 cannot be represented in 4 bits. If we consider these as signed values, the calculation is 6 + -4 = 2 and the result <span class="No-Break">is correct:</span></p>&#13;
			<table id="table004-1" class="No-Table-Style">&#13;
				<colgroup>&#13;
					<col/>&#13;
					<col/>&#13;
					<col/>&#13;
					<col/>&#13;
					<col/>&#13;
					<col/>&#13;
				</colgroup>&#13;
				<thead>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-7">&#13;
							<p lang="en-GB"><strong class="bold">8</strong></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-7">&#13;
							<p lang="en-GB"><strong class="bold">4</strong></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-7">&#13;
							<p lang="en-GB"><strong class="bold">2</strong></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-7">&#13;
							<p lang="en-GB"><strong class="bold">1</strong></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-7">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="bold">Unsigned value</strong></span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-7">&#13;
							<p lang="en-GB"><span class="No-Break"><strong class="bold">Signed value</strong></span></p>&#13;
						</td>&#13;
					</tr>&#13;
				</thead>&#13;
				<tbody>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    0</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    1</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    2</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    2</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    3</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    3</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    4</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    4</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    5</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    5</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    6</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    6</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    7</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-5">&#13;
							<p lang="en-GB">    7</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-7">&#13;
							<p lang="en-GB">8</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-7">&#13;
							<p lang="en-GB">4</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-7">&#13;
							<p lang="en-GB">2</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-7">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-7"/>&#13;
						<td class="No-Table-Style CellOverride-7"/>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">    8</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-8">&#13;
							<p lang="en-GB">    -8</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">    9</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-8">&#13;
							<p lang="en-GB">    -7</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">    <span class="No-Break">10</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-8">&#13;
							<p lang="en-GB">    -6</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">    <span class="No-Break">11</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-8">&#13;
							<p lang="en-GB">    -5</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">    <span class="No-Break">12</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-8">&#13;
							<p lang="en-GB">    -4</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">    <span class="No-Break">13</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-8">&#13;
							<p lang="en-GB">    -3</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">0</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">    <span class="No-Break">14</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-8">&#13;
							<p lang="en-GB">    -2</p>&#13;
						</td>&#13;
					</tr>&#13;
					<tr class="No-Table-Style">&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">1</p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-3">&#13;
							<p lang="en-GB">    <span class="No-Break">15</span></p>&#13;
						</td>&#13;
						<td class="No-Table-Style CellOverride-8">&#13;
							<p lang="en-GB">    -1</p>&#13;
						</td>&#13;
					</tr>&#13;
				</tbody>&#13;
			</table>&#13;
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 4.3 – A representation of 4-bit values in signed and unsigned forms</p>&#13;
			<h4 lang="en-GB">Two’s complement arithmetic – a note</h4>&#13;
			<p lang="en-GB">There are several <a id="_idIndexMarker271"/>ways of representing negative numbers in binary arithmetic. One of the oldest is called sign and magnitude, where a number is prefixed by 0 if it’s positive and 1 if it’s negative. This is not used today in binary arithmetic (except for <span class="No-Break">floating-point numbers).</span></p>&#13;
			<p lang="en-GB">Two’s complement notation is used by almost all modern computers to represent signed integers. In two’s complement arithmetic, if N is a positive number in n bits, the value of -N is given by 2<span class="superscript">n – 1</span>. The two’s complement of N can be calculated easily by inverting the bits and adding 1. For example, if N = <strong class="source-inline">000110</strong> in six bits, the value of -6 is represented <span class="No-Break">by </span><span class="No-Break"><strong class="source-inline">111010</strong></span><span class="No-Break">.</span></p>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB">The advantage of two’s complement arithmetic is that addition and subtraction are performed in the same way. If you add a two’s complement value to another number, the result is correctly calculated. For example, if we add 9 (that is, <strong class="source-inline">001001</strong>) to the previous value of -6, we get <strong class="source-inline">001001</strong> + <strong class="source-inline">111010</strong> = <strong class="source-inline">1000011</strong>, which is +3 in six bits. The carry-out (in bold font) <span class="No-Break">is discarded.</span></p>&#13;
			<h4 lang="en-GB">Zero, carry, and sign bits</h4>&#13;
			<p lang="en-GB">The carry <a id="_idIndexMarker272"/>and sign bits are used to determine whether a result is in range or out of range. In signed <a id="_idIndexMarker273"/>arithmetic, the result of a two’s complement addition of S = A+B is <a id="_idIndexMarker274"/>out of range, if the sign bits of A and B are both 0 and the sign bit of S is 1, or if the sign bits of A and B are both 1 and the sign bit of S is 0. Consider addition and subtraction using four bits. Two’s complement arithmetic is used, and the leftmost bit is the sign bit. In each case, we’ve performed a two’s complement addition on signed numbers. The results give us the state of the <span class="No-Break">flag bits:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span> +0101                               +5 + -5 = 0</span>&#13;
<span><span class="No-Break"> </span><span class="Underline">+1011</span></span>&#13;
<span> 10000 Z = 1, N = 0, C = 1, V = 0   </span>&#13;
<span>                            <span class="sc-comment">The result is zero and the Z-bit is set. The C bit is 1, and N, V bits are clear</span></span>&#13;
<span> +1101                               -3 + -3 = -6</span>&#13;
<span> <span class="Underline">+1101</span></span>&#13;
<span> 11010 Z = 0, N = 1, C = 1, V = 0    <span class="sc-comment">The result is negative, N = 1, and a carry is generated, C = 1</span></span>&#13;
<span> +1101                               -3 + +5 = +2</span>&#13;
<span> <span class="Underline">+0101</span></span>&#13;
<span> 10010 Z = 0, N = 0, C = 1, V = 0    <span class="sc-comment">The result is positive and the carry bit is set</span></span>&#13;
<span> +0101                               +5 + 6 = -5</span>&#13;
<span> <span class="Underline">+0110</span></span>&#13;
<span>  1011 Z = 0, N = 1, C = 0, V = 1</span>&#13;
<span>                                 <span class="sc-comment">Two positive numbers are added and the result is negative. V is set</span></span>&#13;
<span>  1010                               -6 + -4 = +7</span>&#13;
<span> <span class="Underline">+1100</span></span>&#13;
<span> 10111 Z = 0, N = 0, C = 1, V = 1</span>&#13;
<span>                                 <span class="sc-comment">Two negative numbers are added and the result is positive. V is set</span></span></pre>&#13;
			<p lang="en-GB">How do we know <a id="_idIndexMarker275"/>whether a number is signed or unsigned? We don’t! There is no <a id="_idIndexMarker276"/>difference. If you use signed numbers, you must interpret the result <a id="_idIndexMarker277"/>as a signed value. If you use unsigned numbers, you must interpret the result as an unsigned value. For example, in four bits, 1110 is both -2 and +14, depending on how you look <span class="No-Break">at it.</span></p>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB">The next topic deals with how we handle groups of repetitive operations. If the same sequence of operations is going to be used more than once in a program, it makes sense to combine them into a group and invoke that group whenever you need it. In Python, this group of actions is called <span class="No-Break">a function.</span></p>&#13;
			<h1 id="_idParaDest-72" lang="en-GB"><a id="_idTextAnchor072"/>Functions in Python</h1>&#13;
			<p lang="en-GB">We will now <a id="_idIndexMarker278"/>describe Python’s functions. We’ve already used functions that are part of the language, such as <strong class="source-inline">len()</strong>. In this section, we’ll do <span class="No-Break">the following:</span></p>&#13;
			<ul>&#13;
				<li lang="en-GB">Explain why functions <span class="No-Break">are useful</span></li>&#13;
				<li lang="en-GB">Provide an example of a function to implement <span class="No-Break">an ALU</span></li>&#13;
				<li lang="en-GB">Explain how variables can be private to a function or shared between <span class="No-Break">functions (scope)</span></li>&#13;
				<li lang="en-GB">Describe how parameters are passed <span class="No-Break">to functions</span></li>&#13;
				<li lang="en-GB">Describe how a function returns <span class="No-Break">a result</span></li>&#13;
			</ul>&#13;
			<p lang="en-GB">Writing the Python code to deal with each arithmetic or logical operation implemented by a simulator would be tedious because so much code would be replicated by individual instructions. Instead, we can create a Python function (that is, a subroutine or procedure) that carries out both the arithmetic/logic operation and the appropriate <span class="No-Break">flag-bit setting.</span></p>&#13;
			<p lang="en-GB">Consider a Python function called <strong class="source-inline">alu(f,p,q)</strong> that returns an integer that is a function of the <strong class="source-inline">f</strong>, <strong class="source-inline">p</strong>, and <strong class="source-inline">q</strong> parameters. The operation to be performed is passed to the procedure as an integer, <strong class="source-inline">f</strong>. The function also updates the z and n flag bits. This is a simplified version of the actual function we will use and will provide just two operations, add and subtract, and update only two <span class="No-Break">flag bits:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>def alu(f,p,q):                  <span class="sc-comment"># Define the alu function with the f, p, and q input parameters</span></span>&#13;
<span>    global z,n                   <span class="sc-comment"># Declare flags as global</span></span>&#13;
<span>    if f == 1: r = p + q         <span class="sc-comment"># If f (the operation) is 1, do an addition</span></span>&#13;
<span>    if f == 2: r = p – q         <span class="sc-comment"># If f is 2, do a subtraction</span></span>&#13;
<span>    z, n = 0, 0                  <span class="sc-comment"># Clear zero and negative flags</span></span>&#13;
<span>    if r &amp; 0xFFFF == 0: z = 1    <span class="sc-comment"># If the result is 0 in 16 bits, then z = 1</span></span>&#13;
<span>    if r &amp; 0x8000 != 0: n = 1    <span class="sc-comment"># If result is negative (msb = 1), then n = 1</span></span>&#13;
<span>    return (0xFFFF &amp; r)          <span class="sc-comment"># Ensure result is restricted to 16 bits</span></span></pre>&#13;
			<p lang="en-GB">The function is introduced by <strong class="source-inline">def</strong>, its name, and any parameters followed by a colon. The body of the function <a id="_idIndexMarker279"/>is indented. The first parameter, <strong class="source-inline">f</strong>, selects the operation we wish to perform (<strong class="source-inline">f</strong> = 1 for addition and 2 for subtraction). The next two input parameters, <strong class="source-inline">p</strong> and <strong class="source-inline">q</strong>, are the data values used by the function. The last line of the function returns the result to the function’s calling point. This function can be called by, for example, <strong class="source-inline">opVal = alu(2,s1,s2)</strong>. In this case, the result, <strong class="source-inline">opVal</strong>, would be the value of <strong class="source-inline">s1 – </strong><span class="No-Break"><strong class="source-inline">s2</strong></span><span class="No-Break">.</span></p>&#13;
			<p lang="en-GB">We also update two flag bits, <strong class="source-inline">z</strong> and <strong class="source-inline">n</strong>. Initially, both <strong class="source-inline">z</strong> and <strong class="source-inline">n</strong> are set to zero by <strong class="source-inline">z, n = 0, 0</strong>. (Python allows multiple assignments on the same line; for example, <strong class="source-inline">a,b,c = 1,5,0</strong> sets <strong class="source-inline">a</strong>, <strong class="source-inline">b</strong>, and <strong class="source-inline">c </strong>to 1, 5, and <span class="No-Break">0, respectively.)</span></p>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB">You can pass data to a function via parameters and receive a result via <strong class="source-inline">return()</strong>. However, you can declare variables in a function as <strong class="source-inline">global</strong>, which means they can be accessed and modified as if they were part of the <span class="No-Break">calling program.</span></p>&#13;
			<p lang="en-GB"><strong class="source-inline">return()</strong> is not mandatory because some functions don’t return a value. You can have multiple <strong class="source-inline">return()</strong> statements in a function because you can return from more than one point in a function. A return can pass multiple values because Python permits multiple assignments on a line; for example, see <span class="No-Break">the following:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>this, that  = myFunction(f,g)  <span class="sc-comment"># Assign f to this and g to that</span></span></pre>&#13;
			<p lang="en-GB">Testing for a <a id="_idIndexMarker280"/>zero result can easily be done by comparing the result, <strong class="source-inline">r</strong>, with 0. Testing for a negative result is harder. In two’s complement arithmetic, a signed value is negative if the most significant bit is 1. We are using 16-bit arithmetic, so that corresponds to bit 15. We can extract bit 15 by ANDing the result, <strong class="source-inline">r</strong>, with the binary value of 1000000000000000 by writing <strong class="source-inline">r&amp;0x8000</strong> (the literal is expressed in hex form as 0x8000, which is mercifully shorter than the <span class="No-Break">binary version).</span></p>&#13;
			<p lang="en-GB">To call the function, we can write <span class="No-Break">the following:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span> if opCode == 0b1000000: r[rD] = alu(1,r[rS1],r[rS2])</span></pre>&#13;
			<p lang="en-GB">We test for opcode 1000000 and call the <strong class="source-inline">alu</strong> function if it corresponds to <strong class="source-inline">ADD</strong>. The function is called with the <strong class="source-inline">f = 1</strong> parameter for addition; the numbers to be added are the contents of the two source registers. The result is loaded into the <strong class="source-inline">r[rD]</strong> register. In the current version of TC1, we use the opcode to look up the mnemonic and then apply the test if <strong class="source-inline">mnemonic == 'ADD':</strong>. This approach is easier to read and can use the mnemonic when displaying the output <span class="No-Break">during tracing.</span></p>&#13;
			<p lang="en-GB">We have made the <strong class="source-inline">z</strong> and <strong class="source-inline">n</strong> variables global (that is, they can be changed by the function and accessed externally). If we didn’t make them global, we would have to have made them return parameters. In general, it is regarded as a better practice to pass variables as parameters rather than making <span class="No-Break">them global.</span></p>&#13;
			<h3 lang="en-GB">Functions and scope</h3>&#13;
			<p lang="en-GB">Variables are associated with <em class="italic">scope</em> or <em class="italic">visibility</em>. If you write a program without functions, variables <a id="_idIndexMarker281"/>can be accessed everywhere in the program. If you use functions, life becomes rather <span class="No-Break">more complex.</span></p>&#13;
			<p lang="en-GB">If you declare a variable in the main body, that variable will be visible in functions (that is, you can use it). However, you cannot change it in the function and then access the new value outside the function. What goes on in the function stays in the function. If you wish to access it from outside the function, you must declare it as <em class="italic">global</em>. If you write <strong class="source-inline">global temp3</strong>, then the <strong class="source-inline">temp3</strong> variable is the same variable both in and outside <span class="No-Break">the function.</span></p>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB">If you create a variable in a function, that variable cannot be accessed outside the function because it’s private to the function (a local variable). You can create a variable with the same name in another function or the body of the program, but the variable in this function has no effect on variables with the same name outside <span class="No-Break">the function.</span></p>&#13;
			<p lang="en-GB">If you create <a id="_idIndexMarker282"/>a variable in a function that you want to be visible outside the function, you have to declare it as global in the function. Consider the <span class="No-Break">following code:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>def fun_1():                      <span class="sc-comment"># A dummy function</span></span>&#13;
<span>    p = 3                         <span class="sc-comment"># p is local to fun_1 and set to 3</span></span>&#13;
<span>    <strong class="bold">global q</strong>                      <span class="sc-comment"># q is global and visible everywhere</span></span>&#13;
<span>    print('In fun_1 p =',p)       <span class="sc-comment"># Print p in fun_1</span></span>&#13;
<span>    print('In fun_1 q =',q)       <span class="sc-comment"># Print q in fun_1</span></span>&#13;
<span>    q = q + 1                     <span class="sc-comment"># q is changed in this function</span></span>&#13;
<span>    p = p + 1                     <span class="sc-comment"># p is changed in this function</span></span>&#13;
<span>    r = 5                         <span class="sc-comment"># set local variable r to 5</span></span>&#13;
<span>    return()                      <span class="sc-comment"># You don't need a return</span></span>&#13;
<span>p = 5                             <span class="sc-comment"># p is defined in the body</span></span>&#13;
<span>q = 10                            <span class="sc-comment"># q is defined in the body</span></span>&#13;
<span>print('In body: p =',p, 'q =',q ) <span class="sc-comment"># Print current values of p and q</span></span>&#13;
<span>fun_1()                           <span class="sc-comment"># Call fun_1 and see what happens to p and q</span></span>&#13;
<span>print('In body after fun_1 q =',q, 'after fun_1 p = ',p)</span></pre>&#13;
			<p lang="en-GB">After running this code, we get the following. As you can see, the function changes <strong class="source-inline">q</strong> because it is global, whereas <strong class="source-inline">p</strong> does not change since it is a local variable in <span class="No-Break">the function:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>In body: p = 5 q = 10</span>&#13;
<span>In fun_1 p = 3</span>&#13;
<span>In fun_1 q = 10</span>&#13;
<span>In body after fun_1 q = 11 after fun_1 p =  5</span></pre>&#13;
			<p lang="en-GB">Here is a summary of <span class="No-Break">the rules:</span></p>&#13;
			<ul>&#13;
				<li lang="en-GB">If you don’t change it in a function, you can use <span class="No-Break">it anywhere</span></li>&#13;
				<li lang="en-GB">If you declare it in a function, it’s all yours and private to <span class="No-Break">the function</span></li>&#13;
				<li lang="en-GB">If you want to change it in the function and use it outside the function, then declare it as global in <span class="No-Break">the function</span></li>&#13;
			</ul>&#13;
			<p lang="en-GB">This means that <a id="_idIndexMarker283"/>variables such as the <strong class="source-inline">z</strong> and <strong class="source-inline">n</strong> condition code flags can be accessed in a function. If you wish to change them in a function, they must be declared as global by using the <span class="No-Break">following command:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>global z,n</span></pre>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB">If a function returns a value, it ends with <strong class="source-inline">return(whatever)</strong>. If you don’t return a value from a function, the <strong class="source-inline">return</strong> statement is not necessary. However, we usually include a <strong class="source-inline">return()</strong> that returns nothing, and then we explicitly mark the end of <span class="No-Break">the function.</span></p>&#13;
			<p lang="en-GB">Although the use of global variables is supported by Python, some programmers avoid them because global variables make it too easy to accidentally change a variable in a function and not notice it, leading to headaches when debugging a faulty program. They argue that all variables should be passed to a function as <span class="No-Break">a parameter.</span></p>&#13;
			<p lang="en-GB">In the next section, we’ll describe the very thing that makes a computer a computer – its ability to take two different courses of action, depending on the outcome of <span class="No-Break">an operation.</span></p>&#13;
			<h2 id="_idParaDest-73" lang="en-GB"><a id="_idTextAnchor073"/>Branches and flow control</h2>&#13;
			<p lang="en-GB">All microprocessors <a id="_idIndexMarker284"/>have flow control instructions; for example, the unconditional branch, <strong class="source-inline">BRA XYZ</strong>, means execute the next instruction at address <strong class="source-inline">XYZ</strong>. A typical conditional instruction is <strong class="source-inline">BNE</strong> <strong class="source-inline">XYZ</strong>, which implements taking the branch to the instruction at location <strong class="source-inline">XYZ</strong>, if and only if, the z flag is not set. The <strong class="source-inline">BNE</strong> mnemonic means “branch on not equal” because the z-bit is evaluated by comparing two values using subtraction. Consider the following example, which uses the TC1 <span class="No-Break">assembly language:</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>     LDRL <strong class="bold">r2</strong>,0        <span class="sc-comment">@ Load r2 (the sum) with 0</span></span>&#13;
<span>     LDRL <strong class="bold">r0</strong>,5        <span class="sc-comment">@ Load r0 (the loop counter) with 5</span></span>&#13;
<span>     LDRL <strong class="bold">r1</strong>,1        <span class="sc-comment">@ Load r1 (the register added to the sum) with 1</span></span>&#13;
<span>Loop ADD  <strong class="bold">r2</strong>,r2,r1    <span class="sc-comment">@ Repeat: add r1 to r2</span></span>&#13;
<span>     INC  <strong class="bold">r1</strong>          <span class="sc-comment">@ Increment r1 so that we add 1, 2, 3 … as we go round the loop</span></span>&#13;
<span>     DEC  <strong class="bold">r0</strong>          <span class="sc-comment">@ Decrement the loop counter in r0</span></span>&#13;
<span>     BNE  Loop        <span class="sc-comment">@ Until loop counter = 0</span></span>&#13;
<span>     STOP             <span class="sc-comment">@ Program completed</span></span></pre>&#13;
			<p lang="en-GB">Load register with a literal (<strong class="source-inline">LDRL</strong>) is used three times to load <strong class="source-inline">r2</strong> with 0, <strong class="source-inline">r0</strong> with 5, and <strong class="source-inline">r1</strong> with 1. In the line labeled <strong class="source-inline">Loop</strong>, we add <strong class="source-inline">r2</strong> to <strong class="source-inline">r1</strong> and put the result in <strong class="source-inline">r2</strong>. On its first execution, <strong class="source-inline">r2</strong> becomes 0 + 1 = <span class="No-Break">1.</span></p>&#13;
			<p lang="en-GB">The next two lines increment <strong class="source-inline">r1</strong> and decrement r0 so that <strong class="source-inline">r1</strong> becomes 2 and <strong class="source-inline">r0</strong> becomes 4. When we decrement <strong class="source-inline">r0</strong>, the z-flag is set if the result is zero. Since r2 initially contains 5 and then 4 after decrementing, the result is not zero and the z-flag is <span class="No-Break">not set.</span></p>&#13;
			<p lang="en-GB">When <strong class="source-inline">BNE</strong> is executed, the z-flag is tested. If it is not zero, a branch is taken to the line labeled <strong class="source-inline">Loop</strong> and the same batch of four instructions are executed again. When the <strong class="source-inline">BNE</strong> is encountered a second time, the z-bit is still zero, because this time the decrement went from 4 to 3. Eventually, <strong class="source-inline">r0</strong> contains 1 and is decremented to 0. The z-bit is then set. When <strong class="source-inline">BNE</strong> is next executed, the branch to loop is not taken, and the next instruction in the sequence, <strong class="source-inline">STOP</strong>, is executed. The loop is repeated 5 times. This program evaluates 1 + 2 + 3 + 4 + 5 = 15, which is the result <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">r2</strong></span><span class="No-Break">.</span></p>&#13;
			<p class="_idGenParaOverride-1" lang="en-GB">Branch addresses can be a little complicated. You can provide an absolute address; for example, <strong class="source-inline">BRA 24</strong> jumps to the instruction at memory location 24. Most computers use a relative address, which is relative to the current instruction. For example, in this case, we would branch three instructions back from the current location (that is, the <strong class="source-inline">BNE</strong> instruction). So, you might think that the relative address is -3. It is a negative address because it is backward from the current address. Since the program counter has already been incremented to point to the next instruction, the branch back is -4. So, the literal field of the <strong class="source-inline">BNE</strong> loop would <span class="No-Break">be -4.</span></p>&#13;
			<p lang="en-GB">The following fragment of code demonstrates testing four branch instructions and their implementation. In this example, we are using relative addressing for the branch; that is, the target address is specified with respect to the program counter. The first branch, <strong class="source-inline">BRA</strong>, is an <a id="_idIndexMarker285"/>unconditional branch and the next value of <strong class="source-inline">pc</strong> is calculated. All the others are conditional branches, and <strong class="source-inline">pc</strong> is changed only if the required condition is met. Note that the last operation is <strong class="source-inline">BMI</strong>, which means branch on minus, although some call it branch on negative (which has the <span class="No-Break">same meaning):</span></p>&#13;
			<pre class="source-code" lang="en-GB">&#13;
<span>if   opCode == 0b1100000:            pc = 0xFFFF &amp; (pc + literal) <span class="sc-comment"># Branch always</span></span>&#13;
<span>elif opCode == 0b1100001 and z == 1: pc = 0xFFFF &amp; (pc + literal) <span class="sc-comment"># Branch on zero</span></span>&#13;
<span>elif opCode == 0b1100010 and z == 0: pc = 0xFFFF &amp; (pc + literal) <span class="sc-comment"># </span><span class="sc-comment">Branch on not zero</span></span>&#13;
<span>elif opCode == 0b1100011 and n == 1: pc = 0xFFFF &amp; (pc + literal) <span class="sc-comment"># Branch on minus</span></span></pre>&#13;
			<p lang="en-GB"><strong class="source-inline">The pc</strong> is incremented by <strong class="source-inline">pc + literal</strong>. However, since backward branches are represented in two’s complement form, it is necessary to <strong class="source-inline">AND</strong> the result with 0xFFFF to force it to 16 bits to generate the correct value. This is because we are simulating 16-bit arithmetic using a computer language, Python, that represents numbers with more than 16 bits. This is <a id="_idIndexMarker286"/>just an unfortunate consequence of computer arithmetic that you have to be aware of when simulating <span class="No-Break">binary arithmetic.</span></p>&#13;
			<p lang="en-GB">In the next chapter, we will return to Python and extend our ability to handle data structures and use <span class="No-Break">Python’s functions.</span></p>&#13;
			<h1 id="_idParaDest-74" lang="en-GB"><a id="_idTextAnchor074"/>Summary</h1>&#13;
			<p lang="en-GB">We started this chapter by designing a computer simulator. However, we haven’t created a final product yet. Instead, we looked at some of the issues involved, such as the nature of an instruction set and the structure of <span class="No-Break">an opcode.</span></p>&#13;
			<p lang="en-GB">We examined how an instruction can be decoded and how it can be executed. We also took the opportunity to broaden our knowledge of Python and introduced Python’s bit-manipulation facilities, which let us implement machine-level instructions that operate <span class="No-Break">on bits.</span></p>&#13;
			<p lang="en-GB">We also introduced an important component of Python, known as a function, which allows the programmer to create a self-contained unit of code that can be called to perform a specific job from many points in a program. Functions are vital to modern programming because they facilitate elegant design by bundling a complex sequence of operations into a unit, which you call to carry out <span class="No-Break">a task.</span></p>&#13;
			<p lang="en-GB">In <a href="B19624_05.xhtml#_idTextAnchor075"><span class="No-Break"><em class="italic">Chapter 5</em></span></a>, we’ll return to Python and look at some topics in a little more depth – in particular, lists. Lists are probably Python’s most interesting and <span class="No-Break">important feature.</span></p>&#13;
		</div>&#13;
	</div></body></html>