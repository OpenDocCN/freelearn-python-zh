<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;Python Tools in Visual Studio"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. Python Tools in Visual Studio</h1></div></div></div><p>Now that we have our tools up and running, we can start to take a deeper look into one of the most important features of PTVS: the intelligent code completion feature or IntelliSense of Visual Studio.</p><p>In this chapter, we will dig deeper into the automatic syntax and hierarchic analysis tools of Visual Studio that we can use with Python. Essentially, these are IntelliSense and navigation tools, which are really helpful for a Python developer during the coding process.</p><p>Furthermore, we will see how to maximize the capabilities of Visual Studio in conjunction with the inner REPL tool for quick and useful code testing and debugging.</p><div class="section" title="Mastering IntelliSense with Python"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec14"/>Mastering IntelliSense with Python</h1></div></div></div><p>As shown <a id="id27" class="indexterm"/>in the <span class="strong"><strong>Python Environments</strong></span> tab, Visual <a id="id28" class="indexterm"/>Studio analyzes the Python code that is available in the current solution and the installed libraries to populate the internal database. By doing so, we are able to gain a better understanding of the available classes, methods, and field descriptions. This is done in a way that can help the developer speed up the coding process.</p><p>The IntelliSense context-aware code completion feature can be recalled in line using the <span class="emphasis"><em>Ctrl</em></span> + Space bar or <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>J</em></span> shortcuts. The <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>J</em></span> shortcut displays the list even when there's only one possibility. This is what happens when you call it in the middle of a command:</p><div class="mediaobject"><img src="graphics/8687OS_02_01.jpg" alt="Mastering IntelliSense with Python"/></div><p>IntelliSense<a id="id29" class="indexterm"/> shows all the available methods, classes, and fields<a id="id30" class="indexterm"/> available in the current code, ordered in alphabetical order. Besides showing them from the list of available commands, it also provides you with a quick documentation. In our example, for the <code class="literal">range</code> method<a id="id31" class="indexterm"/>, IntelliSense shows the list of its overloaded methods and its signature.</p><p>If you are aware of the method that you are searching for but want a little help with the list of parameters available, just recall the IntelliSense window either through the parameter parenthesis when you open it or with the <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + Space bar shortcut.</p><div class="mediaobject"><img src="graphics/8687OS_02_02.jpg" alt="Mastering IntelliSense with Python"/></div><p>In this case, IntelliSense will show possible combinations of the parameters and a quick documentation for each one, given by the position of the parameter in the list as shown in preceding screenshot.</p><p>The automatic importing of modules is another interesting functionality that helps in speeding up development. It also provides the functionality of automatic inclusion when you use a class from another Python file.</p><p>As shown in the preceding screenshot, if you have a <code class="literal">Paging</code> class in one of your Python files in your project, IntelliSense can recognize it as a class that is reachable from your project; also, it will suggest further operations by showing a smart tag under the first character of the classname:</p><div class="mediaobject"><img src="graphics/8687OS_02_03.jpg" alt="Mastering IntelliSense with Python"/><div class="caption"><p>IntelliSense in action on a classname for importing. The little blue rectangle under the classname means there are functions available from Visual Studio</p></div></div><p>When it's <a id="id32" class="indexterm"/>clicked, an action pop up is shown. You<a id="id33" class="indexterm"/> can choose the operation to execute along with its ability to reference the source/originated file into the current code:</p><div class="mediaobject"><img src="graphics/8687OS_02_04.jpg" alt="Mastering IntelliSense with Python"/></div><p>If you click on one of the two options, an inclusion statement will be added as the header of your code file:</p><div class="mediaobject"><img src="graphics/8687OS_02_05.jpg" alt="Mastering IntelliSense with Python"/><div class="caption"><p>After selecting the "from Paging import Paging" option, the inclusion statement is generated at the top of the code file</p></div></div><p>Once the class is visible in your code, Visual Studio is able to inspect the referenced class. You will start seeing the class in the IntelliSense window when it's called, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/8687OS_02_06.jpg" alt="Mastering IntelliSense with Python"/><div class="caption"><p>IntelliSense showing the methods available in the Paging class</p></div></div><p>IntelliSense<a id="id34" class="indexterm"/> can be extended even further. In the<a id="id35" class="indexterm"/> following example, when the <code class="literal">foo</code> class is defined with<a id="id36" class="indexterm"/> the <code class="literal">bar</code> method, IntelliSense will fetch the class structure to display the helper to be used in the code:</p><div class="mediaobject"><img src="graphics/8687OS_02_07.jpg" alt="Mastering IntelliSense with Python"/></div><p>IntelliSense is able to provide us with an insight into the structure of the class and the available elements of it, but without any documentation. To have the documentation shown in the code, we can simply add it to the code of the class as follows:</p><div class="mediaobject"><img src="graphics/8687OS_02_08.jpg" alt="Mastering IntelliSense with Python"/><div class="caption"><p>IntelliSense showing the class or method documentation</p></div></div><p>It's really<a id="id37" class="indexterm"/> straightforward and simple. Any element<a id="id38" class="indexterm"/> in the Python project is automatically analyzed and fed into the reference database of Visual Studio without having to rework the code or execute external tools during the coding session.</p><p>IntelliSense can also help when the code is referenced, giving us an overview of all the modules that are available, all the PythonPath-referenced modules, the modules you are going to reference in your solution, and the modules that are part of your project:</p><div class="mediaobject"><img src="graphics/8687OS_02_09.jpg" alt="Mastering IntelliSense with Python"/></div><p>Furthermore, IntelliSense is<a id="id39" class="indexterm"/> useful not only to <a id="id40" class="indexterm"/>select the module, but also to select the import part:</p><div class="mediaobject"><img src="graphics/8687OS_02_10.jpg" alt="Mastering IntelliSense with Python"/></div></div></div>
<div class="section" title="Using REPL in Visual Studio"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec15"/>Using REPL in Visual Studio</h1></div></div></div><p>In this<a id="id41" class="indexterm"/> section, we will explore the usage of the standard <span class="strong"><strong>read–eval–print loop</strong></span> (<span class="strong"><strong>REPL</strong></span>) tool for<a id="id42" class="indexterm"/> Python inside Visual Studio. As mentioned in the introduction, PTVS has an enhanced version of REPL. Besides the standard Python commands in the REPL version of PTVS—the Interactive Python window—there are some added commands and functionalities that can help speed up the debugging process and also enable simple testing of your code.</p><p>The enhanced commands are shown by typing <code class="literal">$help</code> in REPL, as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/8687OS_02_11.jpg" alt="Using REPL in Visual Studio"/></div><p>We'll go<a id="id43" class="indexterm"/> into detail on the most used and interesting<a id="id44" class="indexterm"/> commands. The <code class="literal">$cls</code> command cleans up the<a id="id45" class="indexterm"/> command line, while the <code class="literal">$reset</code> command cleans up the engine in a way <a id="id46" class="indexterm"/>that you can restart with a clean REPL environment.</p><p>The most interesting functions are <code class="literal">$load</code> and <code class="literal">$mod</code>. The <code class="literal">$load</code> command permits you to execute<a id="id47" class="indexterm"/> the content of a given Python file inside REPL:</p><div class="mediaobject"><img src="graphics/8687OS_02_12.jpg" alt="Using REPL in Visual Studio"/><div class="caption"><p>An example of the $load function in the REPL tool</p></div></div><p>These<a id="id48" class="indexterm"/> functions are useful as they provide an on-the-fly <a id="id49" class="indexterm"/>view of the execution cycle of your code.</p><p>The <code class="literal">$mod</code> command<a id="id50" class="indexterm"/> gives you the opportunity to change the scope on which the REPL tool is operating.</p><p>When REPL starts, it's automatically set on the main module of the opened project, <code class="literal">(__main__)</code>. Typing <code class="literal">$mod</code> followed by the name of the module allows you to switch to another module of the same project, giving access to the module and its content.</p><div class="mediaobject"><img src="graphics/8687OS_02_13.jpg" alt="Using REPL in Visual Studio"/></div><p>As we can see in the preceding screenshot, the user interface of the REPL window has a combobox at the top, which allows us to interactively switch the scope. IntelliSense is also managed in REPL.</p><p>We can execute every piece of code in our project using the <span class="strong"><strong>Send to Interactive</strong></span> command<a id="id51" class="indexterm"/> in the context menu under the coding panel (or, use the <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>E</em></span> shortcut):</p><div class="mediaobject"><img src="graphics/8687OS_02_14.jpg" alt="Using REPL in Visual Studio"/></div><p>We can<a id="id52" class="indexterm"/> also instruct the debugger to use REPL as the<a id="id53" class="indexterm"/> output of the application by selecting the <span class="strong"><strong>Execute Project in Python Interactive</strong></span> option from the <span class="strong"><strong>DEBUG</strong></span> menu (or by using the <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>F5</em></span> shortcut).</p><p>It's also possible to tell the debugger to use REPL as the output of the application instead of the standard console output; to do this, just click on the <span class="strong"><strong>Execute Project in Python Interactive</strong></span> entry in the <span class="strong"><strong>DEBUG</strong></span> menu or use the <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>F5</em></span> shortcut:</p><div class="mediaobject"><img src="graphics/8687OS_02_15.jpg" alt="Using REPL in Visual Studio"/></div><p>This is <a id="id54" class="indexterm"/>particularly useful when developing back-office <a id="id55" class="indexterm"/>modules in a web application for which the debugging and testing of the code is particularly difficult if you wish to do this directly in the browser. Using the REPL tool, you can achieve a much more productive and quicker process.</p></div>
<div class="section" title="Navigating code with ease"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec16"/>Navigating code with ease</h1></div></div></div><p>Visual Studio <a id="id56" class="indexterm"/>provides lots of features to speed up the process of code navigation; at the same time, these features allow Visual Studio to have a streamlined coding process with a more holistic view of the project. This is particularly useful when you need to switch to a module to see the actual implementation or to update some parts of it, even when it is located somewhere else in the project. Some of the most important features for code navigation are reachable from the context menu in the coding panel:</p><div class="mediaobject"><img src="graphics/8687OS_02_16.jpg" alt="Navigating code with ease"/></div><p>As shown in<a id="id57" class="indexterm"/> the preceding screenshot, when the cursor is over a method and the contextual menu is opened, the command <span class="strong"><strong>Go To Definition</strong></span> can be found. The <span class="strong"><strong>Go To Definition</strong></span> command<a id="id58" class="indexterm"/> moves the view to the implemented code of the method inside the referenced module.</p><p>Another <a id="id59" class="indexterm"/>useful debugging function is the <span class="strong"><strong>Find All References</strong></span> command (the <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>F12</em></span> shortcut). It shows all the points inside the project where the method is used:</p><div class="mediaobject"><img src="graphics/8687OS_02_17.jpg" alt="Navigating code with ease"/></div><p>The result of the execution of the <span class="strong"><strong>Find All References</strong></span> command will be shown in a new tool window, <span class="strong"><strong>Find Symbol Results</strong></span>. It shows both the definition of the method and the actual references inside the project in which the method is actually used.</p><p>Furthermore, the code panel provides tools to quickly navigate to any given point of the code. Because of the fact that Visual Studio dynamically analyzes the code when a Python file is opened in the code editor panel, the IDE automatically creates a hierarchal index of it. To navigate the index, use the two comboboxes with the navigation bar that are located at the top of the window.</p><p>The first one <a id="id60" class="indexterm"/>shows all the global reachable elements in the file, while the second one shows all the inner elements of the item selected in the first combobox. The selection of an element in comboboxes controls the view of the code editor and jumps to the referenced code.</p><p>In the following screenshot, we can see how navigation of the comboboxes works, showing the hierarchal view by displaying all the inner components of the <code class="literal">html2text</code> class in the second combobox:</p><div class="mediaobject"><img src="graphics/8687OS_02_18.jpg" alt="Navigating code with ease"/></div><p>To easily go back and forward while navigating the code, especially when jumping between modules, there are two useful buttons in the toolbar that allow you to jump back to the starting point. Look for the two arrow-shaped buttons at the very left-hand side of the toolbar. The arrow pointing to the left is to move backward, which is accessible through the <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>-</em></span> shortcut; the arrow pointing to the right is used to move forward, which is accessible through the <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>-</em></span> shortcut.</p><div class="mediaobject"><img src="graphics/8687OS_02_19.jpg" alt="Navigating code with ease"/><div class="caption"><p>The navigation buttons in blue on the left side of the toolbar, are a good way to quickly navigate through the code</p></div></div><p>The editor<a id="id61" class="indexterm"/> window provides a way to navigate the files that are already opened through the file tabs located at the top of the window. As of the time of writing this book, Visual Studio has refined the features available for this. So now, even for PTVS, there are many possibilities to do so. You can close the tabs and move them around. A single tab can be shown in an independent window or side-by-side with another one.</p><div class="mediaobject"><img src="graphics/8687OS_02_20.jpg" alt="Navigating code with ease"/><div class="caption"><p>Visual Studio offers a powerful window management, providing a full set of alignment option on every window in the IDE by simply dragging them from the tab</p></div></div><p>Tabs can be pinned to the leftmost position of the tab bar so they can be easily reached when many files are opened in the code editor. The tab itself has a contextual menu with more commands<a id="id62" class="indexterm"/> for the file:</p><div class="mediaobject"><img src="graphics/8687OS_02_21.jpg" alt="Navigating code with ease"/></div><p>From the tab contextual menu, you are able to manage the tabs or directly execute the code inside the tabs. The <span class="strong"><strong>Copy Full Path</strong></span> and <span class="strong"><strong>Open Containing Folder</strong></span> options are very handy during the coding process.</p><p>It is also possible to navigate through the files of the project through the <span class="strong"><strong>Solution Explorer</strong></span> window. Clicking on the file of interest will open the file in the code editor window. A single click opens the file in a temporary state, which means that the file will be opened in a tab at the right end of the tab bar. This is really useful when going through various files without working with them.</p><p>Unlike a permanent tab, the temporary tab will remain open until you navigate to another file through the <span class="strong"><strong>Solution Explorer</strong></span> window. This trims down the amount of tabs open in the code editor. As we all know, it will become difficult to manage and navigate a huge number of open tabs.</p><p>Double-clicking<a id="id63" class="indexterm"/> on a file in the <span class="strong"><strong>Solution Explorer</strong></span> window opens it in a permanent tab in the code editor, which is indicated with a pin icon:</p><div class="mediaobject"><img src="graphics/8687OS_02_22.jpg" alt="Navigating code with ease"/><div class="caption"><p>The "Solution Explorer" window, on the right, is a powerful tool to navigate through the files of the projects. Open a file in temporary tab by clicking on it. Double-click opens a permanent tab which is indicated with a pin icon</p></div></div></div>
<div class="section" title="Object Browser"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec17"/>Object Browser</h1></div></div></div><p>Another<a id="id64" class="indexterm"/> way to have a high-level clear view of the project and the elements that compose it is to use the <span class="strong"><strong>Object Browser</strong></span> tool. This tool gives you a more hierarchal view of the entire project. There are two different ways to access the view; let's take a look at both of them.</p><p>The first way is to open the full version of the <span class="strong"><strong>Object Browser</strong></span> tool, which is accessible from the <span class="strong"><strong>VIEW</strong></span> menu through the main toolbar, or by using the <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>J</em></span> shortcut.</p><p>Using the shortcut will open a new tab in the code editor window, which will present us with the following view:</p><div class="mediaobject"><img src="graphics/8687OS_02_23.jpg" alt="Object Browser"/></div><p>The <span class="strong"><strong>Object Browser</strong></span> tool is a three-pane window. The top-left pane shows a list of all the Python files that compose the project. The top-right pane shows a list of elements that compose<a id="id65" class="indexterm"/> the selected file (methods, fields, and so on). The bottom pane shows the element footprint and related documentation (if available) of the selected element.</p><p>Any of the elements in the <span class="strong"><strong>Object Browser</strong></span> tool are clickable. A double-click will open the code file and jump to the code that implements the clicked element.</p><p>It is also possible to filter the kind of elements to be shown using the <span class="strong"><strong>Object Browser</strong></span> settings icon in the toolbar at the top of the window. It is also possible to perform an actual search using the top search bar, which will show all the references of the searched text in the underlying panels:</p><div class="mediaobject"><img src="graphics/8687OS_02_24.jpg" alt="Object Browser"/></div><p>Besides<a id="id66" class="indexterm"/> using the full <span class="strong"><strong>Object Browser </strong></span>tool, we can traverse the project hierarchy through the <span class="strong"><strong>Class View</strong></span> window, which is normally located in the same window as that of <span class="strong"><strong>Solution Explorer</strong></span>. Switching to the <span class="strong"><strong>Class View</strong></span> tab shows the reduced <span class="strong"><strong>Object Browser </strong></span>tool, which is practically the same but without the documentation panel. The <span class="strong"><strong>Class View</strong></span> tab is shown as follows:</p><div class="mediaobject"><img src="graphics/8687OS_02_25.jpg" alt="Object Browser"/></div><p>This<a id="id67" class="indexterm"/> tool gives the exact same functionalities as the full-fledged <span class="strong"><strong>Object Browser </strong></span>tool, including the search and filter capabilities. Double-clicking on the element will jump to the code at the exact point of the implementation as well.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec18"/>Summary</h1></div></div></div><p>In this chapter, we introduced a wide range of usage of IntelliSense with Python, including working with classes between project files with simple importing and referencing capabilities. We also learned how to use REPL for a more streamlined debugging and testing process.</p><p>Now you are familiarized with the different code navigation functionalities that can help you find code references using filtering as well as tabs. Combined with the <span class="strong"><strong>Object Browser</strong></span> tool, you are able to view your Python project with a high-level view of all methods, classes, fields, elements, related documents, and so on.</p><p>In the next chapter, we will dive into the day-to-day coding tools to guide you through the whole programming lifecycle.</p></div></body></html>