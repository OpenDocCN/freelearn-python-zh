<html xml:lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head>
<meta charset="utf-8"/>
<meta content="pandoc" name="generator"/>
<title>ch017.xhtml</title>
<link href="../styles/stylesheet1.css" rel="stylesheet" type="text/css"/>
<!-- kobo-style -->
<style id="koboSpanStyle" type="text/css" xmlns="http://www.w3.org/1999/xhtml">.koboSpan { -webkit-text-combine: inherit; }</style>
</head>
<body epub:type="bodymatter">
<section class="level1" data-number="17" id="chapter-13-project-4.1-visual-analysis-techniques">
<h1 data-number="17"><span class="titlemark"><span class="koboSpan" id="kobo.1.1" xmlns="http://www.w3.org/1999/xhtml">Chapter 13</span></span><br/>
<span id="x1-29700013"/><span class="koboSpan" id="kobo.2.1" xmlns="http://www.w3.org/1999/xhtml">Project 4.1: Visual Analysis Techniques</span></h1>
<p><span class="koboSpan" id="kobo.3.1" xmlns="http://www.w3.org/1999/xhtml">When doing </span><strong><span class="koboSpan" id="kobo.4.1" xmlns="http://www.w3.org/1999/xhtml">exploratory data analysis </span></strong><span class="koboSpan" id="kobo.5.1" xmlns="http://www.w3.org/1999/xhtml">(</span><strong><span class="koboSpan" id="kobo.6.1" xmlns="http://www.w3.org/1999/xhtml">EDA</span></strong><span class="koboSpan" id="kobo.7.1" xmlns="http://www.w3.org/1999/xhtml">), one common practice is to use graphical techniques to </span><span id="dx1-297001"/><span class="koboSpan" id="kobo.8.1" xmlns="http://www.w3.org/1999/xhtml">help understand the </span><span id="dx1-297002"/><span class="koboSpan" id="kobo.9.1" xmlns="http://www.w3.org/1999/xhtml">nature of data distribution. </span><span class="koboSpan" id="kobo.9.2" xmlns="http://www.w3.org/1999/xhtml">The US </span><strong><span class="koboSpan" id="kobo.10.1" xmlns="http://www.w3.org/1999/xhtml">National Institute of Standards and Technology</span></strong><span class="koboSpan" id="kobo.11.1" xmlns="http://www.w3.org/1999/xhtml"> (</span><strong><span class="koboSpan" id="kobo.12.1" xmlns="http://www.w3.org/1999/xhtml">NIST</span></strong><span class="koboSpan" id="kobo.13.1" xmlns="http://www.w3.org/1999/xhtml">) has an </span><em><span class="koboSpan" id="kobo.14.1" xmlns="http://www.w3.org/1999/xhtml">Engineering Statistics Handbook </span></em><span class="koboSpan" id="kobo.15.1" xmlns="http://www.w3.org/1999/xhtml">that strongly emphasizes the need for graphic techniques. </span><span class="koboSpan" id="kobo.15.2" xmlns="http://www.w3.org/1999/xhtml">See </span><a class="url" href="https://doi.org/10.18434/M32189"><span class="koboSpan" id="kobo.16.1" xmlns="http://www.w3.org/1999/xhtml">https://doi.org/10.18434/M32189</span></a><span class="koboSpan" id="kobo.17.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.18.1" xmlns="http://www.w3.org/1999/xhtml">This chapter will create some additional Jupyter notebooks to present a few techniques for displaying univariate and multivariate distributions.</span></p>
<p><span class="koboSpan" id="kobo.19.1" xmlns="http://www.w3.org/1999/xhtml">In this chapter, we’ll focus on some important skills for creating diagrams for the cleaned data:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.20.1" xmlns="http://www.w3.org/1999/xhtml">Additional Jupyter Notebook techniques</span></p></li>
<li><p><span class="koboSpan" id="kobo.21.1" xmlns="http://www.w3.org/1999/xhtml">Using </span><strong><span class="koboSpan" id="kobo.22.1" xmlns="http://www.w3.org/1999/xhtml">PyPlot </span></strong><span class="koboSpan" id="kobo.23.1" xmlns="http://www.w3.org/1999/xhtml">to present data</span></p></li>
<li><p><span class="koboSpan" id="kobo.24.1" xmlns="http://www.w3.org/1999/xhtml">Unit testing for Jupyter Notebook functions</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.25.1" xmlns="http://www.w3.org/1999/xhtml">This chapter has one project, to build the start of a more complete analysis notebook. </span><span class="koboSpan" id="kobo.25.2" xmlns="http://www.w3.org/1999/xhtml">A notebook can be saved and exported as a PDF file, allowing an analyst to share preliminary results for early conversations. </span><span class="koboSpan" id="kobo.25.3" xmlns="http://www.w3.org/1999/xhtml">In the next chapter, we’ll expand on the notebook to create a presentation that can be shared with colleagues.</span></p>
<p><span class="koboSpan" id="kobo.26.1" xmlns="http://www.w3.org/1999/xhtml">Looking further down the road, a notebook can help to identify important aspects of the data that need ongoing monitoring. </span><span class="koboSpan" id="kobo.26.2" xmlns="http://www.w3.org/1999/xhtml">The computations created here will often become the basis for more fully automated reporting tools and notifications. </span><span class="koboSpan" id="kobo.26.3" xmlns="http://www.w3.org/1999/xhtml">This analysis activity is an important step toward understanding the data and designing a model for the data.</span></p>
<p><span class="koboSpan" id="kobo.27.1" xmlns="http://www.w3.org/1999/xhtml">We’ll start with a description of an analysis notebook. </span><span id="x1-297003r316"/></p>
<section class="level2" data-number="17.1" id="description-19">
<h2 data-number="17.1"><span class="titlemark"><span class="koboSpan" id="kobo.28.1" xmlns="http://www.w3.org/1999/xhtml">13.1 </span></span> <span id="x1-2980001"/><span class="koboSpan" id="kobo.29.1" xmlns="http://www.w3.org/1999/xhtml">Description</span></h2>
<p><span class="koboSpan" id="kobo.30.1" xmlns="http://www.w3.org/1999/xhtml">In the previous chapters, the sequence of projects created a pipeline to acquire and then clean the raw data. </span><span class="koboSpan" id="kobo.30.2" xmlns="http://www.w3.org/1999/xhtml">The intent is to build automated data gathering as Python applications.</span></p>
<p><span class="koboSpan" id="kobo.31.1" xmlns="http://www.w3.org/1999/xhtml">We noted that ad hoc data inspection is best done with a notebook, not an automated CLI tool. </span><span class="koboSpan" id="kobo.31.2" xmlns="http://www.w3.org/1999/xhtml">Similarly, creating command-line applications for analysis and presentation can be challenging. </span><span class="koboSpan" id="kobo.31.3" xmlns="http://www.w3.org/1999/xhtml">Analytical work seems to be essentially exploratory, making it helpful to have immediate feedback from looking at results.</span></p>
<p><span class="koboSpan" id="kobo.32.1" xmlns="http://www.w3.org/1999/xhtml">Additionally, analytical work transforms raw data into information, and possibly even insight. </span><span class="koboSpan" id="kobo.32.2" xmlns="http://www.w3.org/1999/xhtml">Analytical results need to be shared to create significant value. </span><span class="koboSpan" id="kobo.32.3" xmlns="http://www.w3.org/1999/xhtml">A Jupyter notebook is an exploratory environment that can create readable, helpful presentations.</span></p>
<p><span class="koboSpan" id="kobo.33.1" xmlns="http://www.w3.org/1999/xhtml">One of the first things to do with raw data is to create diagrams to illustrate the distribution of univariate data and the relationships among variables in multivariate data. </span><span class="koboSpan" id="kobo.33.2" xmlns="http://www.w3.org/1999/xhtml">We’ll emphasize the following common kinds of diagrams:</span></p>
<ul>
<li><p><strong><span class="koboSpan" id="kobo.34.1" xmlns="http://www.w3.org/1999/xhtml">Histograms </span></strong><span class="koboSpan" id="kobo.35.1" xmlns="http://www.w3.org/1999/xhtml">A histogram summarizes </span><span id="dx1-298001"/><span class="koboSpan" id="kobo.36.1" xmlns="http://www.w3.org/1999/xhtml">the distribution of values for a variable in a dataset. </span><span class="koboSpan" id="kobo.36.2" xmlns="http://www.w3.org/1999/xhtml">The histogram will have data values on one axis and frequency on the other axis.</span></p></li>
<li><p><strong><span class="koboSpan" id="kobo.37.1" xmlns="http://www.w3.org/1999/xhtml">Scatter Plots </span></strong><span class="koboSpan" id="kobo.38.1" xmlns="http://www.w3.org/1999/xhtml">A scatter plot summarizes the </span><span id="dx1-298002"/><span class="koboSpan" id="kobo.39.1" xmlns="http://www.w3.org/1999/xhtml">relationships between values for two variables in a dataset. </span><span class="koboSpan" id="kobo.39.2" xmlns="http://www.w3.org/1999/xhtml">The visual clustering can be apparent to the casual observer.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.40.1" xmlns="http://www.w3.org/1999/xhtml">For small datasets, each relationship in a scatter plot can be a single dot. </span><span class="koboSpan" id="kobo.40.2" xmlns="http://www.w3.org/1999/xhtml">For larger datasets, where a number of points have similar relationships, it can be helpful to create “bins” that reflect how many points have the same relationship.</span></p>
<p><span class="koboSpan" id="kobo.41.1" xmlns="http://www.w3.org/1999/xhtml">There are a number of ways of showing the size of these bins. </span><span class="koboSpan" id="kobo.41.2" xmlns="http://www.w3.org/1999/xhtml">This includes using a color code for more popular combinations. </span><span class="koboSpan" id="kobo.41.3" xmlns="http://www.w3.org/1999/xhtml">For some datasets, the size of an enclosing circle can show the relative concentration of similarly-valued data. </span><span class="koboSpan" id="kobo.41.4" xmlns="http://www.w3.org/1999/xhtml">The reader is encouraged to look at alternatives to help emphasize the interesting relationships among the attributes of the various samples.</span></p>
<p><span class="koboSpan" id="kobo.42.1" xmlns="http://www.w3.org/1999/xhtml">The use of </span><strong><span class="koboSpan" id="kobo.43.1" xmlns="http://www.w3.org/1999/xhtml">Seaborn </span></strong><span class="koboSpan" id="kobo.44.1" xmlns="http://www.w3.org/1999/xhtml">to provide colorful styles is also important when working with diagrams. </span><span class="koboSpan" id="kobo.44.2" xmlns="http://www.w3.org/1999/xhtml">You are encouraged to explore various color palettes to help emphasize interesting data. </span><span id="x1-298003r322"/></p>
</section>
<section class="level2" data-number="17.2" id="overall-approach-2">
<h2 data-number="17.2"><span class="titlemark"><span class="koboSpan" id="kobo.45.1" xmlns="http://www.w3.org/1999/xhtml">13.2 </span></span> <span id="x1-2990002"/><span class="koboSpan" id="kobo.46.1" xmlns="http://www.w3.org/1999/xhtml">Overall approach</span></h2>
<p><span class="koboSpan" id="kobo.47.1" xmlns="http://www.w3.org/1999/xhtml">We’ll take some </span><span id="dx1-299001"/><span class="koboSpan" id="kobo.48.1" xmlns="http://www.w3.org/1999/xhtml">guidance from the C4 model ( </span><a class="url" href="https://c4model.com"><span class="koboSpan" id="kobo.49.1" xmlns="http://www.w3.org/1999/xhtml">https://c4model.com</span></a><span class="koboSpan" id="kobo.50.1" xmlns="http://www.w3.org/1999/xhtml">) when looking at our approach:</span></p>
<ul>
<li><p><strong><span class="koboSpan" id="kobo.51.1" xmlns="http://www.w3.org/1999/xhtml">Context</span></strong><span class="koboSpan" id="kobo.52.1" xmlns="http://www.w3.org/1999/xhtml">: For this project, the context diagram has two use cases: the acquire-to-clean process and this analysis notebook.</span></p></li>
<li><p><strong><span class="koboSpan" id="kobo.53.1" xmlns="http://www.w3.org/1999/xhtml">Containers</span></strong><span class="koboSpan" id="kobo.54.1" xmlns="http://www.w3.org/1999/xhtml">: There’s one container for analysis application: the user’s personal computer.</span></p></li>
<li><p><strong><span class="koboSpan" id="kobo.55.1" xmlns="http://www.w3.org/1999/xhtml">Components</span></strong><span class="koboSpan" id="kobo.56.1" xmlns="http://www.w3.org/1999/xhtml">: The software components include the existing analysis models that provide handy definitions for the Python objects.</span></p></li>
<li><p><strong><span class="koboSpan" id="kobo.57.1" xmlns="http://www.w3.org/1999/xhtml">Code</span></strong><span class="koboSpan" id="kobo.58.1" xmlns="http://www.w3.org/1999/xhtml">: The code is scattered in two places: supporting modules as well as the notebook itself.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.59.1" xmlns="http://www.w3.org/1999/xhtml">A context diagram for this application is shown in </span><a href="#13.1"><em><span class="koboSpan" id="kobo.60.1" xmlns="http://www.w3.org/1999/xhtml">Figure 13.1</span></em></a><span class="koboSpan" id="kobo.61.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<figure class="IMG---Figure">
<span class="koboSpan" id="kobo.62.1" xmlns="http://www.w3.org/1999/xhtml"><img alt="Figure 13.1: Context diagram " src="../media/file55.jpg"/></span>
<figcaption class="IMG---Caption"><span class="id" id="13.1"><span class="koboSpan" id="kobo.63.1" xmlns="http://www.w3.org/1999/xhtml">Figure 13.1: </span></span><span class="content"><span class="koboSpan" id="kobo.64.1" xmlns="http://www.w3.org/1999/xhtml">Context diagram </span></span></figcaption>
</figure>
<p><span class="koboSpan" id="kobo.65.1" xmlns="http://www.w3.org/1999/xhtml">The analyst will often need to share their analytical results with stakeholders. </span><span class="koboSpan" id="kobo.65.2" xmlns="http://www.w3.org/1999/xhtml">An initial notebook might provide confirmation that some data does not conform to the null hypothesis, suggesting an interesting relationship that deserves deeper exploration. </span><span class="koboSpan" id="kobo.65.3" xmlns="http://www.w3.org/1999/xhtml">This could be part of justifying a budget allocation to do more analysis based on preliminary results. </span><span class="koboSpan" id="kobo.65.4" xmlns="http://www.w3.org/1999/xhtml">Another possible scenario is sharing a notebook to confirm the null hypothesis is likely true, and that the variations in the data have a high probability of being some kind of measurement noise. </span><span class="koboSpan" id="kobo.65.5" xmlns="http://www.w3.org/1999/xhtml">This could be used to end one investigation and focus on alternatives.</span></p>
<p><span class="koboSpan" id="kobo.66.1" xmlns="http://www.w3.org/1999/xhtml">In </span><a href="ch010.xhtml#x1-1460006"><em><span class="koboSpan" id="kobo.67.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em><em><span class="koboSpan" id="kobo.68.1" xmlns="http://www.w3.org/1999/xhtml"> 6</span></em></a><span class="koboSpan" id="kobo.69.1" xmlns="http://www.w3.org/1999/xhtml">, </span><a href="ch010.xhtml#x1-1460006"><em><span class="koboSpan" id="kobo.70.1" xmlns="http://www.w3.org/1999/xhtml">Project 2.1: Data Inspection Notebook</span></em></a><span class="koboSpan" id="kobo.71.1" xmlns="http://www.w3.org/1999/xhtml">, the data inspection notebook was described. </span><span class="koboSpan" id="kobo.71.2" xmlns="http://www.w3.org/1999/xhtml">The use of a single acquisition model module for the data was mentioned, but the details of the Python implementation weren’t emphasized. </span><span class="koboSpan" id="kobo.71.3" xmlns="http://www.w3.org/1999/xhtml">The raw data </span><span id="dx1-299004"/><span class="koboSpan" id="kobo.72.1" xmlns="http://www.w3.org/1999/xhtml">module often provides little useful structure to the data when doing inspections.</span></p>
<p><span class="koboSpan" id="kobo.73.1" xmlns="http://www.w3.org/1999/xhtml">Moving forward into more complicated projects, we’ll see the relationship between the notebooks and the modules that define the data model become more important.</span></p>
<p><span class="koboSpan" id="kobo.74.1" xmlns="http://www.w3.org/1999/xhtml">For this analysis notebook, the analysis data model, created in </span><a href="ch013.xhtml#x1-2080009"><em><span class="koboSpan" id="kobo.75.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em><em><span class="koboSpan" id="kobo.76.1" xmlns="http://www.w3.org/1999/xhtml"> 9</span></em></a><span class="koboSpan" id="kobo.77.1" xmlns="http://www.w3.org/1999/xhtml">, </span><a href="ch013.xhtml#x1-2080009"><em><span class="koboSpan" id="kobo.78.1" xmlns="http://www.w3.org/1999/xhtml">Project 3.1: Data Cleaning Base Application</span></em></a><span class="koboSpan" id="kobo.79.1" xmlns="http://www.w3.org/1999/xhtml">, will be a central part of the notebook for doing analysis. </span><span class="koboSpan" id="kobo.79.2" xmlns="http://www.w3.org/1999/xhtml">This will be imported and used in the analysis notebook. </span><span class="koboSpan" id="kobo.79.3" xmlns="http://www.w3.org/1999/xhtml">The analysis process may lead to changes to the analysis model to reflect lessons learned.</span></p>
<p><span class="koboSpan" id="kobo.80.1" xmlns="http://www.w3.org/1999/xhtml">A technical complication arises from the directory structure. </span><span class="koboSpan" id="kobo.80.2" xmlns="http://www.w3.org/1999/xhtml">The data acquisition and cleaning applications are in the </span><code><span class="koboSpan" id="kobo.81.1" xmlns="http://www.w3.org/1999/xhtml">src</span></code><span class="koboSpan" id="kobo.82.1" xmlns="http://www.w3.org/1999/xhtml"> directory, where the notebooks are kept in a separate </span><code><span class="koboSpan" id="kobo.83.1" xmlns="http://www.w3.org/1999/xhtml">notebooks</span></code><span class="koboSpan" id="kobo.84.1" xmlns="http://www.w3.org/1999/xhtml"> directory.</span></p>
<p><span class="koboSpan" id="kobo.85.1" xmlns="http://www.w3.org/1999/xhtml">When working with a notebook in the </span><code><span class="koboSpan" id="kobo.86.1" xmlns="http://www.w3.org/1999/xhtml">notebooks</span></code><span class="koboSpan" id="kobo.87.1" xmlns="http://www.w3.org/1999/xhtml"> directory, it is difficult to make the Python </span><code><span class="koboSpan" id="kobo.88.1" xmlns="http://www.w3.org/1999/xhtml">import</span></code><span class="koboSpan" id="kobo.89.1" xmlns="http://www.w3.org/1999/xhtml"> statement look into the adjacent </span><code><span class="koboSpan" id="kobo.90.1" xmlns="http://www.w3.org/1999/xhtml">src</span></code><span class="koboSpan" id="kobo.91.1" xmlns="http://www.w3.org/1999/xhtml"> directory. </span><span class="koboSpan" id="kobo.91.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.92.1" xmlns="http://www.w3.org/1999/xhtml">import</span></code><span class="koboSpan" id="kobo.93.1" xmlns="http://www.w3.org/1999/xhtml"> statement scans a list of directories defined by the </span><code><span class="koboSpan" id="kobo.94.1" xmlns="http://www.w3.org/1999/xhtml">sys.path</span></code><span class="koboSpan" id="kobo.95.1" xmlns="http://www.w3.org/1999/xhtml"> value. </span><span class="koboSpan" id="kobo.95.2" xmlns="http://www.w3.org/1999/xhtml">This value is seeded from some defined rules, the current working directory, and the value of the </span><code><span class="koboSpan" id="kobo.96.1" xmlns="http://www.w3.org/1999/xhtml">PYTHONPATH</span></code><span class="koboSpan" id="kobo.97.1" xmlns="http://www.w3.org/1999/xhtml"> environment variable.</span></p>
<p><span class="koboSpan" id="kobo.98.1" xmlns="http://www.w3.org/1999/xhtml">There are two ways to make the </span><code><span class="koboSpan" id="kobo.99.1" xmlns="http://www.w3.org/1999/xhtml">import</span></code><span class="koboSpan" id="kobo.100.1" xmlns="http://www.w3.org/1999/xhtml"> statement load modules from the adjacent </span><code><span class="koboSpan" id="kobo.101.1" xmlns="http://www.w3.org/1999/xhtml">src</span></code><span class="koboSpan" id="kobo.102.1" xmlns="http://www.w3.org/1999/xhtml"> directory:</span></p>
<ol>
<li><div id="x1-299006x1">
<p><span class="koboSpan" id="kobo.103.1" xmlns="http://www.w3.org/1999/xhtml">Put </span><code><span class="koboSpan" id="kobo.104.1" xmlns="http://www.w3.org/1999/xhtml">../src</span></code><span class="koboSpan" id="kobo.105.1" xmlns="http://www.w3.org/1999/xhtml"> into the </span><code><span class="koboSpan" id="kobo.106.1" xmlns="http://www.w3.org/1999/xhtml">PYTHONPATH</span></code><span class="koboSpan" id="kobo.107.1" xmlns="http://www.w3.org/1999/xhtml"> environment variable before starting JupyterLab.</span></p>
</div></li>
<li><div id="x1-299008x2">
<p><span class="koboSpan" id="kobo.108.1" xmlns="http://www.w3.org/1999/xhtml">Put the absolute path to </span><code><span class="koboSpan" id="kobo.109.1" xmlns="http://www.w3.org/1999/xhtml">../src</span></code><span class="koboSpan" id="kobo.110.1" xmlns="http://www.w3.org/1999/xhtml"> into the </span><code><span class="koboSpan" id="kobo.111.1" xmlns="http://www.w3.org/1999/xhtml">sys.path</span></code><span class="koboSpan" id="kobo.112.1" xmlns="http://www.w3.org/1999/xhtml"> list after starting JupyterLab.</span></p>
</div></li>
</ol>
<p><span class="koboSpan" id="kobo.113.1" xmlns="http://www.w3.org/1999/xhtml">The two are equivalent. </span><span class="koboSpan" id="kobo.113.2" xmlns="http://www.w3.org/1999/xhtml">The first can be done by updating one’s </span><code><span class="koboSpan" id="kobo.114.1" xmlns="http://www.w3.org/1999/xhtml">~/.zshrc</span></code><span class="koboSpan" id="kobo.115.1" xmlns="http://www.w3.org/1999/xhtml"> file to make sure the </span><code><span class="koboSpan" id="kobo.116.1" xmlns="http://www.w3.org/1999/xhtml">PYTHONPATH</span></code><span class="koboSpan" id="kobo.117.1" xmlns="http://www.w3.org/1999/xhtml"> environment variable is set each time a terminal session starts. </span><span class="koboSpan" id="kobo.117.2" xmlns="http://www.w3.org/1999/xhtml">There are other files appropriate for other shells; for example, </span><code><span class="koboSpan" id="kobo.118.1" xmlns="http://www.w3.org/1999/xhtml">~/.bashrc</span></code><span class="koboSpan" id="kobo.119.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.120.1" xmlns="http://www.w3.org/1999/xhtml">./rc</span></code><span class="koboSpan" id="kobo.121.1" xmlns="http://www.w3.org/1999/xhtml"> for the classic </span><code><span class="koboSpan" id="kobo.122.1" xmlns="http://www.w3.org/1999/xhtml">sh</span></code><span class="koboSpan" id="kobo.123.1" xmlns="http://www.w3.org/1999/xhtml"> shell. </span><span class="koboSpan" id="kobo.123.2" xmlns="http://www.w3.org/1999/xhtml">For Windows, there’s a dialog that allows one to edit the system’s environment variables.</span></p>
<p><span class="koboSpan" id="kobo.124.1" xmlns="http://www.w3.org/1999/xhtml">The alternative is to update </span><code><span class="koboSpan" id="kobo.125.1" xmlns="http://www.w3.org/1999/xhtml">sys.path</span></code><span class="koboSpan" id="kobo.126.1" xmlns="http://www.w3.org/1999/xhtml"> with a </span><span id="dx1-299009"/><span class="koboSpan" id="kobo.127.1" xmlns="http://www.w3.org/1999/xhtml">cell containing code like the following example:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-209">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.128.1" xmlns="http://www.w3.org/1999/xhtml">import sys
from pathlib import Path

src_path = Path.cwd().parent / "src"
sys.path.append(str(src_path))</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.129.1" xmlns="http://www.w3.org/1999/xhtml">This cell will add the peer </span><code><span class="koboSpan" id="kobo.130.1" xmlns="http://www.w3.org/1999/xhtml">../src</span></code><span class="koboSpan" id="kobo.131.1" xmlns="http://www.w3.org/1999/xhtml"> directory to the system path. </span><span class="koboSpan" id="kobo.131.2" xmlns="http://www.w3.org/1999/xhtml">After this is done, the </span><code><span class="koboSpan" id="kobo.132.1" xmlns="http://www.w3.org/1999/xhtml">import</span></code><span class="koboSpan" id="kobo.133.1" xmlns="http://www.w3.org/1999/xhtml"> statement will bring in modules from the </span><code><span class="koboSpan" id="kobo.134.1" xmlns="http://www.w3.org/1999/xhtml">../src</span></code><span class="koboSpan" id="kobo.135.1" xmlns="http://www.w3.org/1999/xhtml"> directory as well as bringing in built-in standard library modules, and modules installed with </span><strong><span class="koboSpan" id="kobo.136.1" xmlns="http://www.w3.org/1999/xhtml">conda </span></strong><span class="koboSpan" id="kobo.137.1" xmlns="http://www.w3.org/1999/xhtml">or </span><strong><span class="koboSpan" id="kobo.138.1" xmlns="http://www.w3.org/1999/xhtml">pip</span></strong><span class="koboSpan" id="kobo.139.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.140.1" xmlns="http://www.w3.org/1999/xhtml">An initialization module can be defined as part of the IPython startup. </span><span class="koboSpan" id="kobo.140.2" xmlns="http://www.w3.org/1999/xhtml">This module can alter the </span><code><span class="koboSpan" id="kobo.141.1" xmlns="http://www.w3.org/1999/xhtml">sys.path</span></code><span class="koboSpan" id="kobo.142.1" xmlns="http://www.w3.org/1999/xhtml"> value in a consistent way for a number of related notebooks in a project.</span></p>
<div class="tcolorbox tipbox" id="tcolobox-210">
<div class="tcolorbox-content">
<p><span class="koboSpan" id="kobo.143.1" xmlns="http://www.w3.org/1999/xhtml">While some developers object to tinkering with </span><code><span class="koboSpan" id="kobo.144.1" xmlns="http://www.w3.org/1999/xhtml">sys.path</span></code><span class="koboSpan" id="kobo.145.1" xmlns="http://www.w3.org/1999/xhtml"> in a notebook, it has the advantage of being explicit.</span></p>
<p><span class="koboSpan" id="kobo.146.1" xmlns="http://www.w3.org/1999/xhtml">Setting </span><code><span class="koboSpan" id="kobo.147.1" xmlns="http://www.w3.org/1999/xhtml">PYTHONPATH</span></code><span class="koboSpan" id="kobo.148.1" xmlns="http://www.w3.org/1999/xhtml"> in one’s </span><code><span class="koboSpan" id="kobo.149.1" xmlns="http://www.w3.org/1999/xhtml">~/.zshrc</span></code><span class="koboSpan" id="kobo.150.1" xmlns="http://www.w3.org/1999/xhtml"> file is a very clean and reliable solution. </span><span class="koboSpan" id="kobo.150.2" xmlns="http://www.w3.org/1999/xhtml">It then becomes necessary to put a reminder in a </span><code><span class="koboSpan" id="kobo.151.1" xmlns="http://www.w3.org/1999/xhtml">README</span></code><span class="koboSpan" id="kobo.152.1" xmlns="http://www.w3.org/1999/xhtml"> file so that new team members can also make this change to their personal home directory.</span></p>
<p><span class="koboSpan" id="kobo.153.1" xmlns="http://www.w3.org/1999/xhtml">When sharing notebooks, it becomes imperative to make sure all stakeholders have access to the entire project the notebook depends on. </span><span class="koboSpan" id="kobo.153.2" xmlns="http://www.w3.org/1999/xhtml">This can lead to a need to create a Git repository that contains the notebook being shared along with reminders, test cases, and needed modules.</span></p>
</div>
</div>
<p><span class="koboSpan" id="kobo.154.1" xmlns="http://www.w3.org/1999/xhtml">Once we have the path defined properly, the notebook </span><span id="dx1-299015"/><span class="koboSpan" id="kobo.155.1" xmlns="http://www.w3.org/1999/xhtml">can share classes and functions with the rest of the applications. </span><span class="koboSpan" id="kobo.155.2" xmlns="http://www.w3.org/1999/xhtml">We’ll move on to looking at one possible organization of an analysis notebook. </span><span id="x1-299016r320"/></p>
<section class="level3" data-number="17.2.1" id="general-notebook-organization">
<h3 data-number="17.2.1"><span class="titlemark"><span class="koboSpan" id="kobo.156.1" xmlns="http://www.w3.org/1999/xhtml">13.2.1 </span></span> <span id="x1-3000001"/><span class="koboSpan" id="kobo.157.1" xmlns="http://www.w3.org/1999/xhtml">General notebook organization</span></h3>
<p><span class="koboSpan" id="kobo.158.1" xmlns="http://www.w3.org/1999/xhtml">An analytical notebook is often the primary method for presenting and sharing results. </span><span class="koboSpan" id="kobo.158.2" xmlns="http://www.w3.org/1999/xhtml">It differs from a “lab” notebook. </span><span class="koboSpan" id="kobo.158.3" xmlns="http://www.w3.org/1999/xhtml">It’s common for lab notebooks to contain a number of experiments, some of which are failures, and some of which have more useful results. </span><span class="koboSpan" id="kobo.158.4" xmlns="http://www.w3.org/1999/xhtml">Unlike a lab notebook, an analytical </span><span id="dx1-300001"/><span class="koboSpan" id="kobo.159.1" xmlns="http://www.w3.org/1999/xhtml">notebook needs to have a tidy organization with carefully-written Markdown cells interspersed with data processing cells. </span><span class="koboSpan" id="kobo.159.2" xmlns="http://www.w3.org/1999/xhtml">In effect, an analysis notebook needs to tell a kind of story. </span><span class="koboSpan" id="kobo.159.3" xmlns="http://www.w3.org/1999/xhtml">It needs to expose actors and actions and the consequences of those actions.</span></p>
<p><span class="koboSpan" id="kobo.160.1" xmlns="http://www.w3.org/1999/xhtml">It’s essential that the notebook’s cells execute correctly from beginning to end. </span><span class="koboSpan" id="kobo.160.2" xmlns="http://www.w3.org/1999/xhtml">The author should be able to restart the kernel and run all of the cells at any time to redo the computations. </span><span class="koboSpan" id="kobo.160.3" xmlns="http://www.w3.org/1999/xhtml">While this may be undesirable for a particularly long-running computation, it still must be true.</span></p>
<p><span class="koboSpan" id="kobo.161.1" xmlns="http://www.w3.org/1999/xhtml">A notebook may have preliminary operations that aren’t relevant to most readers of the report. </span><span class="koboSpan" id="kobo.161.2" xmlns="http://www.w3.org/1999/xhtml">A specific example is setting the </span><code><span class="koboSpan" id="kobo.162.1" xmlns="http://www.w3.org/1999/xhtml">sys.path</span></code><span class="koboSpan" id="kobo.163.1" xmlns="http://www.w3.org/1999/xhtml"> to import modules from an adjacent </span><code><span class="koboSpan" id="kobo.164.1" xmlns="http://www.w3.org/1999/xhtml">../src</span></code><span class="koboSpan" id="kobo.165.1" xmlns="http://www.w3.org/1999/xhtml"> directory. </span><span class="koboSpan" id="kobo.165.2" xmlns="http://www.w3.org/1999/xhtml">It can be helpful to make use of JupyterLab’s ability to collapse a cell as a way to set some of the computation details aside to help the reader focus on the key concepts.</span></p>
<p><span class="koboSpan" id="kobo.166.1" xmlns="http://www.w3.org/1999/xhtml">It seems sensible to formalize this with Markdown cells to explain the preliminaries. </span><span class="koboSpan" id="kobo.166.2" xmlns="http://www.w3.org/1999/xhtml">The remaining cells in this section can be collapsed visually to minimize distractions.</span></p>
<p><span class="koboSpan" id="kobo.167.1" xmlns="http://www.w3.org/1999/xhtml">The preliminaries can include technical and somewhat less technical aspects. </span><span class="koboSpan" id="kobo.167.2" xmlns="http://www.w3.org/1999/xhtml">For example, setting </span><code><span class="koboSpan" id="kobo.168.1" xmlns="http://www.w3.org/1999/xhtml">sys.path</span></code><span class="koboSpan" id="kobo.169.1" xmlns="http://www.w3.org/1999/xhtml"> is purely technical, and few stakeholders will need to see this. </span><span class="koboSpan" id="kobo.169.2" xmlns="http://www.w3.org/1999/xhtml">On the other hand, reading the </span><code><span class="koboSpan" id="kobo.170.1" xmlns="http://www.w3.org/1999/xhtml">SeriesSample</span></code><span class="koboSpan" id="kobo.171.1" xmlns="http://www.w3.org/1999/xhtml"> objects from an ND JSON format file is a preliminary step that’s somewhat more </span><span id="dx1-300002"/><span class="koboSpan" id="kobo.172.1" xmlns="http://www.w3.org/1999/xhtml">relevant to the stakeholder’s problems.</span></p>
<p><span class="koboSpan" id="kobo.173.1" xmlns="http://www.w3.org/1999/xhtml">After the preliminaries, the bulk of the notebook can focus on two topics:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.174.1" xmlns="http://www.w3.org/1999/xhtml">Summary statistics</span></p></li>
<li><p><span class="koboSpan" id="kobo.175.1" xmlns="http://www.w3.org/1999/xhtml">Visualizations</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.176.1" xmlns="http://www.w3.org/1999/xhtml">We’ll look at the summary statistics in the next section. </span><span id="x1-300003r325"/></p>
</section>
<section class="level3" data-number="17.2.2" id="python-modules-for-summarizing">
<h3 data-number="17.2.2"><span class="titlemark"><span class="koboSpan" id="kobo.177.1" xmlns="http://www.w3.org/1999/xhtml">13.2.2 </span></span> <span id="x1-3010002"/><span class="koboSpan" id="kobo.178.1" xmlns="http://www.w3.org/1999/xhtml">Python modules for summarizing</span></h3>
<p><span class="koboSpan" id="kobo.179.1" xmlns="http://www.w3.org/1999/xhtml">For initial reports, Python’s </span><code><span class="koboSpan" id="kobo.180.1" xmlns="http://www.w3.org/1999/xhtml">statistics</span></code><span class="koboSpan" id="kobo.181.1" xmlns="http://www.w3.org/1999/xhtml"> module offers a few handy statistical functions. </span><span class="koboSpan" id="kobo.181.2" xmlns="http://www.w3.org/1999/xhtml">This module offers </span><code><span class="koboSpan" id="kobo.182.1" xmlns="http://www.w3.org/1999/xhtml">mean()</span></code><span class="koboSpan" id="kobo.183.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.184.1" xmlns="http://www.w3.org/1999/xhtml">median()</span></code><span class="koboSpan" id="kobo.185.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.186.1" xmlns="http://www.w3.org/1999/xhtml">mode()</span></code><span class="koboSpan" id="kobo.187.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.188.1" xmlns="http://www.w3.org/1999/xhtml">stdev()</span></code><span class="koboSpan" id="kobo.189.1" xmlns="http://www.w3.org/1999/xhtml">, </span><code><span class="koboSpan" id="kobo.190.1" xmlns="http://www.w3.org/1999/xhtml">variance()</span></code><span class="koboSpan" id="kobo.191.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.191.2" xmlns="http://www.w3.org/1999/xhtml">There are numerous other functions here the reader is encouraged to explore.</span></p>
<p><span class="koboSpan" id="kobo.192.1" xmlns="http://www.w3.org/1999/xhtml">These functions can be </span><span id="dx1-301001"/><span class="koboSpan" id="kobo.193.1" xmlns="http://www.w3.org/1999/xhtml">evaluated in a cell, and the results will be displayed below the cell. </span><span class="koboSpan" id="kobo.193.2" xmlns="http://www.w3.org/1999/xhtml">In many cases, this is all that’s required.</span></p>
<p><span class="koboSpan" id="kobo.194.1" xmlns="http://www.w3.org/1999/xhtml">In a few cases, though, results need to be truncated to remove meaningless trailing digits. </span><span class="koboSpan" id="kobo.194.2" xmlns="http://www.w3.org/1999/xhtml">In other cases, it can help to use an f-string to provide a label for a result. </span><span class="koboSpan" id="kobo.194.3" xmlns="http://www.w3.org/1999/xhtml">A cell might look like the following:</span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.195.1" xmlns="http://www.w3.org/1999/xhtml">f"mean = {statistics.mean(data_values): .2f}"</span></pre>
<p><span class="koboSpan" id="kobo.196.1" xmlns="http://www.w3.org/1999/xhtml">This provides a label, and truncates the output to two places to the right of the decimal point.</span></p>
<p><span class="koboSpan" id="kobo.197.1" xmlns="http://www.w3.org/1999/xhtml">In some cases, we might want to incorporate computed values into markdown cells. </span><span class="koboSpan" id="kobo.197.2" xmlns="http://www.w3.org/1999/xhtml">The </span><strong><span class="koboSpan" id="kobo.198.1" xmlns="http://www.w3.org/1999/xhtml">Python Markdown </span></strong><span class="koboSpan" id="kobo.199.1" xmlns="http://www.w3.org/1999/xhtml">extension provides a </span><span id="dx1-301003"/><span class="koboSpan" id="kobo.200.1" xmlns="http://www.w3.org/1999/xhtml">tidy way to incorporate computed values into markdown content.</span></p>
<p><span class="koboSpan" id="kobo.201.1" xmlns="http://www.w3.org/1999/xhtml">See </span><a class="url" href="https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/python-markdown/readme.html"><span class="koboSpan" id="kobo.202.1" xmlns="http://www.w3.org/1999/xhtml">https://jupyter-contrib-nbextensions.readthedocs.io/en/latest/nbextensions/python-markdown/readme.html</span></a><span class="koboSpan" id="kobo.203.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.204.1" xmlns="http://www.w3.org/1999/xhtml">The most important part of the notebook is the graphic visualization of the data, we’ll turn to that in the next section. </span><span id="x1-301004r326"/></p>
</section>
<section class="level3" data-number="17.2.3" id="pyplot-graphics">
<h3 data-number="17.2.3"><span class="titlemark"><span class="koboSpan" id="kobo.205.1" xmlns="http://www.w3.org/1999/xhtml">13.2.3 </span></span> <span id="x1-3020003"/><span class="koboSpan" id="kobo.206.1" xmlns="http://www.w3.org/1999/xhtml">PyPlot graphics</span></h3>
<p><span class="koboSpan" id="kobo.207.1" xmlns="http://www.w3.org/1999/xhtml">The </span><strong><span class="koboSpan" id="kobo.208.1" xmlns="http://www.w3.org/1999/xhtml">matplotlib </span></strong><span class="koboSpan" id="kobo.209.1" xmlns="http://www.w3.org/1999/xhtml">package works well for </span><span id="dx1-302001"/><span class="koboSpan" id="kobo.210.1" xmlns="http://www.w3.org/1999/xhtml">creating images and diagrams. </span><span class="koboSpan" id="kobo.210.2" xmlns="http://www.w3.org/1999/xhtml">Within this extensive, sophisticated graphic </span><span id="dx1-302002"/><span class="koboSpan" id="kobo.211.1" xmlns="http://www.w3.org/1999/xhtml">library is a smaller library, </span><code><span class="koboSpan" id="kobo.212.1" xmlns="http://www.w3.org/1999/xhtml">pyplot</span></code><span class="koboSpan" id="kobo.213.1" xmlns="http://www.w3.org/1999/xhtml">, that’s narrowly focused on data visualizations. </span><span class="koboSpan" id="kobo.213.2" xmlns="http://www.w3.org/1999/xhtml">Using the </span><code><span class="koboSpan" id="kobo.214.1" xmlns="http://www.w3.org/1999/xhtml">pyplot</span></code><span class="koboSpan" id="kobo.215.1" xmlns="http://www.w3.org/1999/xhtml"> library permits a few lines of code to create a useful display of data.</span></p>
<p><span class="koboSpan" id="kobo.216.1" xmlns="http://www.w3.org/1999/xhtml">The module is often renamed to </span><span id="dx1-302003"/><span class="koboSpan" id="kobo.217.1" xmlns="http://www.w3.org/1999/xhtml">make it easier to type. </span><span class="koboSpan" id="kobo.217.2" xmlns="http://www.w3.org/1999/xhtml">The common convention is shown in the following line of code:</span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.218.1" xmlns="http://www.w3.org/1999/xhtml">import matplotlib.pyplot as plt</span></pre>
<p><span class="koboSpan" id="kobo.219.1" xmlns="http://www.w3.org/1999/xhtml">This lets us use </span><code><span class="koboSpan" id="kobo.220.1" xmlns="http://www.w3.org/1999/xhtml">plt</span></code><span class="koboSpan" id="kobo.221.1" xmlns="http://www.w3.org/1999/xhtml"> as a namespace to refer to functions defined in the </span><code><span class="koboSpan" id="kobo.222.1" xmlns="http://www.w3.org/1999/xhtml">pyplot</span></code><span class="koboSpan" id="kobo.223.1" xmlns="http://www.w3.org/1999/xhtml"> module of the </span><code><span class="koboSpan" id="kobo.224.1" xmlns="http://www.w3.org/1999/xhtml">matplotlib</span></code><span class="koboSpan" id="kobo.225.1" xmlns="http://www.w3.org/1999/xhtml"> package.</span></p>
<p><span class="koboSpan" id="kobo.226.1" xmlns="http://www.w3.org/1999/xhtml">In some cases, JupyterLab may not have the </span><code><span class="koboSpan" id="kobo.227.1" xmlns="http://www.w3.org/1999/xhtml">matplotlib</span></code><span class="koboSpan" id="kobo.228.1" xmlns="http://www.w3.org/1999/xhtml"> library prepared for interactive use. </span><span class="koboSpan" id="kobo.228.2" xmlns="http://www.w3.org/1999/xhtml">(This will be clear when the plotted images are not shown in the notebook.) In these cases, the interactive use of the </span><code><span class="koboSpan" id="kobo.229.1" xmlns="http://www.w3.org/1999/xhtml">matplotlib</span></code><span class="koboSpan" id="kobo.230.1" xmlns="http://www.w3.org/1999/xhtml"> library needs to be enabled. </span><span class="koboSpan" id="kobo.230.2" xmlns="http://www.w3.org/1999/xhtml">Use the following magic commands in a cell of the notebook to enable interactive use:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-211">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.231.1" xmlns="http://www.w3.org/1999/xhtml">%matplotlib inline
%config InlineBackend.figure_formats = {’png’, ’retina’}</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.232.1" xmlns="http://www.w3.org/1999/xhtml">The first command enables the </span><code><span class="koboSpan" id="kobo.233.1" xmlns="http://www.w3.org/1999/xhtml">matplotlib</span></code><span class="koboSpan" id="kobo.234.1" xmlns="http://www.w3.org/1999/xhtml"> library to create graphics immediately in the notebook. </span><span class="koboSpan" id="kobo.234.2" xmlns="http://www.w3.org/1999/xhtml">It won’t create separate files or pop-up windows. </span><span class="koboSpan" id="kobo.234.3" xmlns="http://www.w3.org/1999/xhtml">The second command produces readily-shared PNG output files. </span><span class="koboSpan" id="kobo.234.4" xmlns="http://www.w3.org/1999/xhtml">It also helps </span><strong><span class="koboSpan" id="kobo.235.1" xmlns="http://www.w3.org/1999/xhtml">MAC OS X </span></strong><span class="koboSpan" id="kobo.236.1" xmlns="http://www.w3.org/1999/xhtml">users to optimize the graphics for their high-resolution displays.</span></p>
<p><span class="koboSpan" id="kobo.237.1" xmlns="http://www.w3.org/1999/xhtml">This isn’t always required. </span><span class="koboSpan" id="kobo.237.2" xmlns="http://www.w3.org/1999/xhtml">It’s needed only for those installations that didn’t configure the </span><code><span class="koboSpan" id="kobo.238.1" xmlns="http://www.w3.org/1999/xhtml">matplotlib</span></code><span class="koboSpan" id="kobo.239.1" xmlns="http://www.w3.org/1999/xhtml"> library for interactive use in a Jupyter notebook.</span></p>
<p><span class="koboSpan" id="kobo.240.1" xmlns="http://www.w3.org/1999/xhtml">In many cases, the </span><code><span class="koboSpan" id="kobo.241.1" xmlns="http://www.w3.org/1999/xhtml">pyplot</span></code><span class="koboSpan" id="kobo.242.1" xmlns="http://www.w3.org/1999/xhtml"> library expects simple sequences of values for the various plotting functions. </span><span class="koboSpan" id="kobo.242.2" xmlns="http://www.w3.org/1999/xhtml">The </span><em><span class="koboSpan" id="kobo.243.1" xmlns="http://www.w3.org/1999/xhtml">x </span></em><span class="koboSpan" id="kobo.244.1" xmlns="http://www.w3.org/1999/xhtml">and </span><em><span class="koboSpan" id="kobo.245.1" xmlns="http://www.w3.org/1999/xhtml">y </span></em><span class="koboSpan" id="kobo.246.1" xmlns="http://www.w3.org/1999/xhtml">values of a scatter plot, for example, are expected to be two parallel lists of the same length. </span><span class="koboSpan" id="kobo.246.2" xmlns="http://www.w3.org/1999/xhtml">This will lead to a few extra cells to restructure data.</span></p>
<p><span class="koboSpan" id="kobo.247.1" xmlns="http://www.w3.org/1999/xhtml">The data cleaning applications from previous chapters produced a single sequence of compound sample objects. </span><span class="koboSpan" id="kobo.247.2" xmlns="http://www.w3.org/1999/xhtml">Each object was a separate sample, with the related values for all of the variables. </span><span class="koboSpan" id="kobo.247.3" xmlns="http://www.w3.org/1999/xhtml">We’ll need to </span><span id="dx1-302007"/><span class="koboSpan" id="kobo.248.1" xmlns="http://www.w3.org/1999/xhtml">convert from this sample record organization to parallel sequences of values for the individual variables.</span></p>
<p><span class="koboSpan" id="kobo.249.1" xmlns="http://www.w3.org/1999/xhtml">This can involve </span><span id="dx1-302008"/><span class="koboSpan" id="kobo.250.1" xmlns="http://www.w3.org/1999/xhtml">something like the following:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-212">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.251.1" xmlns="http://www.w3.org/1999/xhtml">x = [s.x for s in series_1]
y = [s.y for s in series_1]</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.252.1" xmlns="http://www.w3.org/1999/xhtml">An alternative is to use the </span><code><span class="koboSpan" id="kobo.253.1" xmlns="http://www.w3.org/1999/xhtml">operator.attrgetter()</span></code><span class="koboSpan" id="kobo.254.1" xmlns="http://www.w3.org/1999/xhtml"> function. </span><span class="koboSpan" id="kobo.254.2" xmlns="http://www.w3.org/1999/xhtml">It looks like the following:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-213">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.255.1" xmlns="http://www.w3.org/1999/xhtml">from operator import attrgetter

x = list(map(attrgetter(’x’), series_1))
y = list(map(attrgetter(’y’), series_1))</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.256.1" xmlns="http://www.w3.org/1999/xhtml">We’ll start with a histogram to show the distribution of values for a single variable.</span></p>
<section class="level4 likesubsubsectionHead" data-number="17.2.3.1" id="data-frequency-histograms">
<h4 class="likesubsubsectionHead" data-number="17.2.3.1"><span id="x1-3030003"/><span class="koboSpan" id="kobo.257.1" xmlns="http://www.w3.org/1999/xhtml">Data frequency histograms</span></h4>
<p><span class="koboSpan" id="kobo.258.1" xmlns="http://www.w3.org/1999/xhtml">Often, a document — like a book — has individual figures. </span><span class="koboSpan" id="kobo.258.2" xmlns="http://www.w3.org/1999/xhtml">A figure may contain a single plot. </span><span class="koboSpan" id="kobo.258.3" xmlns="http://www.w3.org/1999/xhtml">Or, it may contain a number of “subplots” within a </span><span id="dx1-303001"/><span class="koboSpan" id="kobo.259.1" xmlns="http://www.w3.org/1999/xhtml">single figure. </span><span class="koboSpan" id="kobo.259.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.260.1" xmlns="http://www.w3.org/1999/xhtml">pyplot</span></code><span class="koboSpan" id="kobo.261.1" xmlns="http://www.w3.org/1999/xhtml"> library provides support for creating a single figure that contains many subplots. </span><span class="koboSpan" id="kobo.261.2" xmlns="http://www.w3.org/1999/xhtml">The idea of a figure with a single plot can be seen as a special case of this generalized approach.</span></p>
<p><span class="koboSpan" id="kobo.262.1" xmlns="http://www.w3.org/1999/xhtml">A figure with a single plot can be prepared with a statement like the following:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-214">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.263.1" xmlns="http://www.w3.org/1999/xhtml">fig, ax = plt.subplots()</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.264.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.265.1" xmlns="http://www.w3.org/1999/xhtml">fig</span></code><span class="koboSpan" id="kobo.266.1" xmlns="http://www.w3.org/1999/xhtml"> object is the figure as a whole. </span><span class="koboSpan" id="kobo.266.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.267.1" xmlns="http://www.w3.org/1999/xhtml">ax</span></code><span class="koboSpan" id="kobo.268.1" xmlns="http://www.w3.org/1999/xhtml"> object is the set of axes for the subplot within the figure. </span><span class="koboSpan" id="kobo.268.2" xmlns="http://www.w3.org/1999/xhtml">While the explicit </span><code><span class="koboSpan" id="kobo.269.1" xmlns="http://www.w3.org/1999/xhtml">ax</span></code><span class="koboSpan" id="kobo.270.1" xmlns="http://www.w3.org/1999/xhtml"> object can seem unnecessary, it’s part of a more general approach that allows figures with related plots to be built.</span></p>
<p><span class="koboSpan" id="kobo.271.1" xmlns="http://www.w3.org/1999/xhtml">The more general case stacks multiple subplots within a figure. </span><span class="koboSpan" id="kobo.271.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.272.1" xmlns="http://www.w3.org/1999/xhtml">sublots()</span></code><span class="koboSpan" id="kobo.273.1" xmlns="http://www.w3.org/1999/xhtml"> function can return axes for each subplot. </span><span class="koboSpan" id="kobo.273.2" xmlns="http://www.w3.org/1999/xhtml">The call to create a two-plot figure might look like this:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-215">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.274.1" xmlns="http://www.w3.org/1999/xhtml">fig, (ax_0, ax_1) = plt.subplots(1, 2)</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.275.1" xmlns="http://www.w3.org/1999/xhtml">Here we’ve stated we’ll have 1 row with 2 subplots stacked next to each other. </span><span class="koboSpan" id="kobo.275.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.276.1" xmlns="http://www.w3.org/1999/xhtml">fig</span></code><span class="koboSpan" id="kobo.277.1" xmlns="http://www.w3.org/1999/xhtml"> object is the figure as a whole. </span><span class="koboSpan" id="kobo.277.2" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.278.1" xmlns="http://www.w3.org/1999/xhtml">ax_0</span></code><span class="koboSpan" id="kobo.279.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.280.1" xmlns="http://www.w3.org/1999/xhtml">ax_1</span></code><span class="koboSpan" id="kobo.281.1" xmlns="http://www.w3.org/1999/xhtml"> objects are the sets of axes for each of these two subplots within the figure.</span></p>
<p><span class="koboSpan" id="kobo.282.1" xmlns="http://www.w3.org/1999/xhtml">Here’s an example of creating a single histogram from the </span><code><span class="koboSpan" id="kobo.283.1" xmlns="http://www.w3.org/1999/xhtml">y</span></code><span class="koboSpan" id="kobo.284.1" xmlns="http://www.w3.org/1999/xhtml"> values of one of the four Anscombe’s quartet series:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-216">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.285.1" xmlns="http://www.w3.org/1999/xhtml">fig, ax = plt.subplots()

# Labels and Title
ax.set_xlabel(’Y’)
ax.set_ylabel(’Counts’)
ax.set_title(’Series I’)

# Draw Histogram
_ = ax.hist(y, fill=False)</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.286.1" xmlns="http://www.w3.org/1999/xhtml">For this example, the </span><code><span class="koboSpan" id="kobo.287.1" xmlns="http://www.w3.org/1999/xhtml">y</span></code><span class="koboSpan" id="kobo.288.1" xmlns="http://www.w3.org/1999/xhtml"> variable </span><span id="dx1-303013"/><span class="koboSpan" id="kobo.289.1" xmlns="http://www.w3.org/1999/xhtml">must be a list of </span><em><span class="koboSpan" id="kobo.290.1" xmlns="http://www.w3.org/1999/xhtml">y </span></em><span class="koboSpan" id="kobo.291.1" xmlns="http://www.w3.org/1999/xhtml">attribute values from Series I. </span><span class="koboSpan" id="kobo.291.2" xmlns="http://www.w3.org/1999/xhtml">The series data must be read from the cleaned source file.</span></p>
<p><span class="koboSpan" id="kobo.292.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.293.1" xmlns="http://www.w3.org/1999/xhtml">_</span></code><code><span class="koboSpan" id="kobo.294.1" xmlns="http://www.w3.org/1999/xhtml"> =</span></code><code><span class="koboSpan" id="kobo.295.1" xmlns="http://www.w3.org/1999/xhtml"> ax.hist(...)</span></code><span class="koboSpan" id="kobo.296.1" xmlns="http://www.w3.org/1999/xhtml"> statement assigns the results of the </span><code><span class="koboSpan" id="kobo.297.1" xmlns="http://www.w3.org/1999/xhtml">hist()</span></code><span class="koboSpan" id="kobo.298.1" xmlns="http://www.w3.org/1999/xhtml"> function to the variable </span><code><span class="koboSpan" id="kobo.299.1" xmlns="http://www.w3.org/1999/xhtml">_</span></code><span class="koboSpan" id="kobo.300.1" xmlns="http://www.w3.org/1999/xhtml"> as a way to suppress displaying the result value in this cell. </span><span class="koboSpan" id="kobo.300.2" xmlns="http://www.w3.org/1999/xhtml">Without this assignment statement, the notebook will show the result of the </span><code><span class="koboSpan" id="kobo.301.1" xmlns="http://www.w3.org/1999/xhtml">hist()</span></code><span class="koboSpan" id="kobo.302.1" xmlns="http://www.w3.org/1999/xhtml"> function, which isn’t very interesting and clutters up the output. </span><span class="koboSpan" id="kobo.302.2" xmlns="http://www.w3.org/1999/xhtml">Since each series has both an </span><em><span class="koboSpan" id="kobo.303.1" xmlns="http://www.w3.org/1999/xhtml">x </span></em><span class="koboSpan" id="kobo.304.1" xmlns="http://www.w3.org/1999/xhtml">and a </span><em><span class="koboSpan" id="kobo.305.1" xmlns="http://www.w3.org/1999/xhtml">y </span></em><span class="koboSpan" id="kobo.306.1" xmlns="http://www.w3.org/1999/xhtml">value, it helps to stack two histograms that shows the distribution of these values. </span><span class="koboSpan" id="kobo.306.2" xmlns="http://www.w3.org/1999/xhtml">The reader is encouraged to develop a figure with two stacked subplots.</span></p>
<p><span class="koboSpan" id="kobo.307.1" xmlns="http://www.w3.org/1999/xhtml">The number of options for color and borders on the histogram bars are breathtaking in their complexity. </span><span class="koboSpan" id="kobo.307.2" xmlns="http://www.w3.org/1999/xhtml">It helps to try several variants in a single notebook and then delete the ones that aren’t helpful.</span></p>
<p><span class="koboSpan" id="kobo.308.1" xmlns="http://www.w3.org/1999/xhtml">The comparison between values is often shown in a scatter plot that shows each (</span><em><span class="koboSpan" id="kobo.309.1" xmlns="http://www.w3.org/1999/xhtml">x,y</span></em><span class="koboSpan" id="kobo.310.1" xmlns="http://www.w3.org/1999/xhtml">) pair. </span><span class="koboSpan" id="kobo.310.2" xmlns="http://www.w3.org/1999/xhtml">We’ll look at this next.</span></p>
</section>
<section class="level4 likesubsubsectionHead" data-number="17.2.3.2" id="x-y-scatter-plot">
<h4 class="likesubsubsectionHead" data-number="17.2.3.2"><span id="x1-3040003"/><span class="koboSpan" id="kobo.311.1" xmlns="http://www.w3.org/1999/xhtml">X-Y scatter plot</span></h4>
<p><span class="koboSpan" id="kobo.312.1" xmlns="http://www.w3.org/1999/xhtml">A scatter plot is one of many </span><span id="dx1-304001"/><span class="koboSpan" id="kobo.313.1" xmlns="http://www.w3.org/1999/xhtml">ways to show the relationship between two variables. </span><span class="koboSpan" id="kobo.313.2" xmlns="http://www.w3.org/1999/xhtml">Here’s an example of creating a single plot from the </span><code><span class="koboSpan" id="kobo.314.1" xmlns="http://www.w3.org/1999/xhtml">x</span></code><span class="koboSpan" id="kobo.315.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.316.1" xmlns="http://www.w3.org/1999/xhtml">y</span></code><span class="koboSpan" id="kobo.317.1" xmlns="http://www.w3.org/1999/xhtml"> values of one of the four Anscombe’s quartet series:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-217">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.318.1" xmlns="http://www.w3.org/1999/xhtml">fig, ax = plt.subplots()

# Labels and Title
ax.set_xlabel(’X’)
ax.set_ylabel(’Y’)
ax.set_title(’Series I’)

# Draw Scatter
_ = ax.scatter(x, y)</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.319.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.320.1" xmlns="http://www.w3.org/1999/xhtml">_</span></code><code><span class="koboSpan" id="kobo.321.1" xmlns="http://www.w3.org/1999/xhtml"> =</span></code><code><span class="koboSpan" id="kobo.322.1" xmlns="http://www.w3.org/1999/xhtml"> ax.scatter(...)</span></code><span class="koboSpan" id="kobo.323.1" xmlns="http://www.w3.org/1999/xhtml"> statement assigns the results of the </span><code><span class="koboSpan" id="kobo.324.1" xmlns="http://www.w3.org/1999/xhtml">scatter()</span></code><span class="koboSpan" id="kobo.325.1" xmlns="http://www.w3.org/1999/xhtml"> function to the variable </span><code><span class="koboSpan" id="kobo.326.1" xmlns="http://www.w3.org/1999/xhtml">_</span></code><span class="koboSpan" id="kobo.327.1" xmlns="http://www.w3.org/1999/xhtml"> as a way to suppress displaying the value. </span><span class="koboSpan" id="kobo.327.2" xmlns="http://www.w3.org/1999/xhtml">This keeps the output focused on the figure.</span></p>
<p><span class="koboSpan" id="kobo.328.1" xmlns="http://www.w3.org/1999/xhtml">The above example presumes the data have been extracted from a sequence of </span><code><span class="koboSpan" id="kobo.329.1" xmlns="http://www.w3.org/1999/xhtml">SeriesSample</span></code><span class="koboSpan" id="kobo.330.1" xmlns="http://www.w3.org/1999/xhtml"> instances using code like the following:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-218">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.331.1" xmlns="http://www.w3.org/1999/xhtml">x = [s.x for s in series_1]
y = [s.y for s in series_1]</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.332.1" xmlns="http://www.w3.org/1999/xhtml">This, in turn, presumes the value for </span><code><span class="koboSpan" id="kobo.333.1" xmlns="http://www.w3.org/1999/xhtml">series_1</span></code><span class="koboSpan" id="kobo.334.1" xmlns="http://www.w3.org/1999/xhtml"> was read from the clean data created by the </span><strong><span class="koboSpan" id="kobo.335.1" xmlns="http://www.w3.org/1999/xhtml">acquire </span></strong><span class="koboSpan" id="kobo.336.1" xmlns="http://www.w3.org/1999/xhtml">and </span><strong><span class="koboSpan" id="kobo.337.1" xmlns="http://www.w3.org/1999/xhtml">clean </span></strong><span class="koboSpan" id="kobo.338.1" xmlns="http://www.w3.org/1999/xhtml">applications.</span></p>
<p><span class="koboSpan" id="kobo.339.1" xmlns="http://www.w3.org/1999/xhtml">Now that we have an approach to building the notebook, we can address the way notebooks tend to evolve. </span><span id="x1-304013r327"/></p>
</section>
</section>
<section class="level3" data-number="17.2.4" id="iteration-and-evolution">
<h3 data-number="17.2.4"><span class="titlemark"><span class="koboSpan" id="kobo.340.1" xmlns="http://www.w3.org/1999/xhtml">13.2.4 </span></span> <span id="x1-3050004"/><span class="koboSpan" id="kobo.341.1" xmlns="http://www.w3.org/1999/xhtml">Iteration and evolution</span></h3>
<p><span class="koboSpan" id="kobo.342.1" xmlns="http://www.w3.org/1999/xhtml">A notebook is often built iteratively. </span><span class="koboSpan" id="kobo.342.2" xmlns="http://www.w3.org/1999/xhtml">Cells are added, removed, and modified as the data is understood.</span></p>
<p><span class="koboSpan" id="kobo.343.1" xmlns="http://www.w3.org/1999/xhtml">On a purely technical level, the Python programming in the cells needs to evolve from a good idea to software that’s testable. </span><span class="koboSpan" id="kobo.343.2" xmlns="http://www.w3.org/1999/xhtml">It’s often easiest to do this by rewriting selected cells into functions. </span><span class="koboSpan" id="kobo.343.3" xmlns="http://www.w3.org/1999/xhtml">For example, define a function to acquire the ND JSON data. </span><span class="koboSpan" id="kobo.343.4" xmlns="http://www.w3.org/1999/xhtml">This can be supplemented by </span><code><span class="koboSpan" id="kobo.344.1" xmlns="http://www.w3.org/1999/xhtml">doctest</span></code><span class="koboSpan" id="kobo.345.1" xmlns="http://www.w3.org/1999/xhtml"> comments to confirm the function works as expected.</span></p>
<p><span class="koboSpan" id="kobo.346.1" xmlns="http://www.w3.org/1999/xhtml">A collection of functions </span><span id="dx1-305001"/><span class="koboSpan" id="kobo.347.1" xmlns="http://www.w3.org/1999/xhtml">can be refactored into a separate, testable module if needed. </span><span class="koboSpan" id="kobo.347.2" xmlns="http://www.w3.org/1999/xhtml">This can permit wider reuse of good ideas in multiple notebooks.</span></p>
<p><span class="koboSpan" id="kobo.348.1" xmlns="http://www.w3.org/1999/xhtml">Equally important is to avoid “over-engineering” a notebook. </span><span class="koboSpan" id="kobo.348.2" xmlns="http://www.w3.org/1999/xhtml">It’s rarely worth the time and effort to carefully specify the contents of a notebook, and then write code that meets those specifications. </span><span class="koboSpan" id="kobo.348.3" xmlns="http://www.w3.org/1999/xhtml">It’s far easier to create — and refine — the notebook.</span></p>
<p><span class="koboSpan" id="kobo.349.1" xmlns="http://www.w3.org/1999/xhtml">In some large organizations, a senior analyst may direct the efforts of junior analysts. </span><span class="koboSpan" id="kobo.349.2" xmlns="http://www.w3.org/1999/xhtml">In this kind of enterprise, it can be helpful to provide guidance to junior analysts. </span><span class="koboSpan" id="kobo.349.3" xmlns="http://www.w3.org/1999/xhtml">When formal methods are needed, the design guidance can take the form of a notebook with markdown cells to explain the desired goal.</span></p>
<p><span class="koboSpan" id="kobo.350.1" xmlns="http://www.w3.org/1999/xhtml">Now that we have an approach to building the notebook, we can enumerate the deliverables for this project. </span><span id="x1-305002r323"/></p>
</section>
</section>
<section class="level2" data-number="17.3" id="deliverables-19">
<h2 data-number="17.3"><span class="titlemark"><span class="koboSpan" id="kobo.351.1" xmlns="http://www.w3.org/1999/xhtml">13.3 </span></span> <span id="x1-3060003"/><span class="koboSpan" id="kobo.352.1" xmlns="http://www.w3.org/1999/xhtml">Deliverables</span></h2>
<p><span class="koboSpan" id="kobo.353.1" xmlns="http://www.w3.org/1999/xhtml">This project has </span><span id="dx1-306001"/><span class="koboSpan" id="kobo.354.1" xmlns="http://www.w3.org/1999/xhtml">the following deliverables:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.355.1" xmlns="http://www.w3.org/1999/xhtml">A </span><code><span class="koboSpan" id="kobo.356.1" xmlns="http://www.w3.org/1999/xhtml">requirements-dev.txt</span></code><span class="koboSpan" id="kobo.357.1" xmlns="http://www.w3.org/1999/xhtml"> file that identifies the tools used, usually </span><code><span class="koboSpan" id="kobo.358.1" xmlns="http://www.w3.org/1999/xhtml">jupyterlab==3.5.3</span></code><span class="koboSpan" id="kobo.359.1" xmlns="http://www.w3.org/1999/xhtml"> and </span><code><span class="koboSpan" id="kobo.360.1" xmlns="http://www.w3.org/1999/xhtml">matplotlib==3.7.0</span></code><span class="koboSpan" id="kobo.361.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p></li>
<li><p><span class="koboSpan" id="kobo.362.1" xmlns="http://www.w3.org/1999/xhtml">Documentation in the </span><code><span class="koboSpan" id="kobo.363.1" xmlns="http://www.w3.org/1999/xhtml">docs</span></code><span class="koboSpan" id="kobo.364.1" xmlns="http://www.w3.org/1999/xhtml"> folder.</span></p></li>
<li><p><span class="koboSpan" id="kobo.365.1" xmlns="http://www.w3.org/1999/xhtml">Unit tests for any new application modules in the </span><code><span class="koboSpan" id="kobo.366.1" xmlns="http://www.w3.org/1999/xhtml">tests</span></code><span class="koboSpan" id="kobo.367.1" xmlns="http://www.w3.org/1999/xhtml"> folder.</span></p></li>
<li><p><span class="koboSpan" id="kobo.368.1" xmlns="http://www.w3.org/1999/xhtml">Any new application modules in the </span><code><span class="koboSpan" id="kobo.369.1" xmlns="http://www.w3.org/1999/xhtml">src</span></code><span class="koboSpan" id="kobo.370.1" xmlns="http://www.w3.org/1999/xhtml"> folder with code to be used by the inspection notebook.</span></p></li>
<li><p><span class="koboSpan" id="kobo.371.1" xmlns="http://www.w3.org/1999/xhtml">A notebook to summarize the clean data. </span><span class="koboSpan" id="kobo.371.2" xmlns="http://www.w3.org/1999/xhtml">In the case of Anscombe’s quartet, it’s essential to show the means and variances are nearly identical, but the scatter plots are dramatically different.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.372.1" xmlns="http://www.w3.org/1999/xhtml">We’ll look at a few of these deliverables in a little more detail. </span><span id="x1-306002r330"/></p>
<section class="level3" data-number="17.3.1" id="unit-test-1">
<h3 data-number="17.3.1"><span class="titlemark"><span class="koboSpan" id="kobo.373.1" xmlns="http://www.w3.org/1999/xhtml">13.3.1 </span></span> <span id="x1-3070001"/><span class="koboSpan" id="kobo.374.1" xmlns="http://www.w3.org/1999/xhtml">Unit test</span></h3>
<p><span class="koboSpan" id="kobo.375.1" xmlns="http://www.w3.org/1999/xhtml">There are two distinct </span><span id="dx1-307001"/><span class="koboSpan" id="kobo.376.1" xmlns="http://www.w3.org/1999/xhtml">kinds of modules that can require testing:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.377.1" xmlns="http://www.w3.org/1999/xhtml">The notebook with any function or class definitions. </span><span class="koboSpan" id="kobo.377.2" xmlns="http://www.w3.org/1999/xhtml">All of these definitions require unit tests.</span></p></li>
<li><p><span class="koboSpan" id="kobo.378.1" xmlns="http://www.w3.org/1999/xhtml">If functions are factored from the notebook into a supporting module, this module will need unit tests. </span><span class="koboSpan" id="kobo.378.2" xmlns="http://www.w3.org/1999/xhtml">Many previous projects have emphasized these tests.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.379.1" xmlns="http://www.w3.org/1999/xhtml">A notebook cell with a computation cell is notoriously difficult to test. </span><span class="koboSpan" id="kobo.379.2" xmlns="http://www.w3.org/1999/xhtml">The visual output from the </span><code><span class="koboSpan" id="kobo.380.1" xmlns="http://www.w3.org/1999/xhtml">hist()</span></code><span class="koboSpan" id="kobo.381.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><code><span class="koboSpan" id="kobo.382.1" xmlns="http://www.w3.org/1999/xhtml">scatter()</span></code><span class="koboSpan" id="kobo.383.1" xmlns="http://www.w3.org/1999/xhtml"> functions seems almost impossible to test in a meaningful way.</span></p>
<p><span class="koboSpan" id="kobo.384.1" xmlns="http://www.w3.org/1999/xhtml">In addition, there are numerous usability tests that can’t be automated. </span><span class="koboSpan" id="kobo.384.2" xmlns="http://www.w3.org/1999/xhtml">Poor choice of colors, for example, can obscure an important relationship. </span><span class="koboSpan" id="kobo.384.3" xmlns="http://www.w3.org/1999/xhtml">Consider the following questions:</span></p>
<ol>
<li><div id="x1-307003x1">
<p><span class="koboSpan" id="kobo.385.1" xmlns="http://www.w3.org/1999/xhtml">Is it informative?</span></p>
</div></li>
<li><div id="x1-307005x2">
<p><span class="koboSpan" id="kobo.386.1" xmlns="http://www.w3.org/1999/xhtml">Is it relevant?</span></p>
</div></li>
<li><div id="x1-307007x3">
<p><span class="koboSpan" id="kobo.387.1" xmlns="http://www.w3.org/1999/xhtml">Is it misleading in any way?</span></p>
</div></li>
</ol>
<p><span class="koboSpan" id="kobo.388.1" xmlns="http://www.w3.org/1999/xhtml">In many cases, these questions are difficult to quantify and difficult to test. </span><span class="koboSpan" id="kobo.388.2" xmlns="http://www.w3.org/1999/xhtml">As a consequence, it’s best to focus automated testing on the Python programming.</span></p>
<p><span class="koboSpan" id="kobo.389.1" xmlns="http://www.w3.org/1999/xhtml">It’s imperative to avoid testing the internals of </span><code><span class="koboSpan" id="kobo.390.1" xmlns="http://www.w3.org/1999/xhtml">matplotlib.pyplot</span></code><span class="koboSpan" id="kobo.391.1" xmlns="http://www.w3.org/1999/xhtml">.</span></p>
<p><span class="koboSpan" id="kobo.392.1" xmlns="http://www.w3.org/1999/xhtml">What’s left to test?</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.393.1" xmlns="http://www.w3.org/1999/xhtml">The data loading.</span></p></li>
<li><p><span class="koboSpan" id="kobo.394.1" xmlns="http://www.w3.org/1999/xhtml">Any ad hoc transformations that are part of the notebook.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.395.1" xmlns="http://www.w3.org/1999/xhtml">The data loading should be reduced to a single function that creates a sequence of </span><code><span class="koboSpan" id="kobo.396.1" xmlns="http://www.w3.org/1999/xhtml">SeriesSample</span></code><span class="koboSpan" id="kobo.397.1" xmlns="http://www.w3.org/1999/xhtml"> instances from the lines in an ND JSON file of clean data. </span><span class="koboSpan" id="kobo.397.2" xmlns="http://www.w3.org/1999/xhtml">This loading function can include a test case.</span></p>
<p><span class="koboSpan" id="kobo.398.1" xmlns="http://www.w3.org/1999/xhtml">We might define the function as follows:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-219">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.399.1" xmlns="http://www.w3.org/1999/xhtml">def load(source_file):
    """
    &gt;&gt;&gt; from io import StringIO
    &gt;&gt;&gt; file = StringIO(’’’{"x": 2.0, "y": 3.0}\\n{"x": 5.0, "y": 7.0}’’’)
    &gt;&gt;&gt; d = load(file)
    &gt;&gt;&gt; len(d)
    2
    &gt;&gt;&gt; d[0]
    SeriesSample(x=2.0, y=3.0)
    """
    data = [
        SeriesSample(**json.loads(line)) for line in source_file if line
    ]
    return data</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.400.1" xmlns="http://www.w3.org/1999/xhtml">This permits testing by adding a </span><span id="dx1-307022"/><span class="koboSpan" id="kobo.401.1" xmlns="http://www.w3.org/1999/xhtml">cell to the notebook that includes the following:</span></p>
<div class="tcolorbox tcolorbox" id="tcolobox-220">
<div class="tcolorbox-content">
<pre class="source-code"><span class="koboSpan" id="kobo.402.1" xmlns="http://www.w3.org/1999/xhtml">import doctest
doctest.testmod()</span></pre>
</div>
</div>
<p><span class="koboSpan" id="kobo.403.1" xmlns="http://www.w3.org/1999/xhtml">This cell will find the functions defined by the notebook, extract any doctest cases from the docstrings in the function definitions, and confirm the doctest cases pass.</span></p>
<p><span class="koboSpan" id="kobo.404.1" xmlns="http://www.w3.org/1999/xhtml">For more complicated </span><span id="dx1-307025"/><span class="koboSpan" id="kobo.405.1" xmlns="http://www.w3.org/1999/xhtml">numerical processing, the </span><strong><span class="koboSpan" id="kobo.406.1" xmlns="http://www.w3.org/1999/xhtml">hypothesis </span></strong><span class="koboSpan" id="kobo.407.1" xmlns="http://www.w3.org/1999/xhtml">library is helpful. </span><span class="koboSpan" id="kobo.407.2" xmlns="http://www.w3.org/1999/xhtml">See </span><a href="ch014.xhtml#x1-2600001"><em><span class="koboSpan" id="kobo.408.1" xmlns="http://www.w3.org/1999/xhtml">Hypothesis testing</span></em></a><span class="koboSpan" id="kobo.409.1" xmlns="http://www.w3.org/1999/xhtml"> in </span><a href="ch014.xhtml#x1-22900010"><em><span class="koboSpan" id="kobo.410.1" xmlns="http://www.w3.org/1999/xhtml">Chapter</span></em><em><span class="koboSpan" id="kobo.411.1" xmlns="http://www.w3.org/1999/xhtml"> 10</span></em></a><span class="koboSpan" id="kobo.412.1" xmlns="http://www.w3.org/1999/xhtml">, </span><a href="ch014.xhtml#x1-22900010"><em><span class="koboSpan" id="kobo.413.1" xmlns="http://www.w3.org/1999/xhtml">Data Cleaning Features</span></em></a><span class="koboSpan" id="kobo.414.1" xmlns="http://www.w3.org/1999/xhtml"> for more information. </span><span id="x1-307026r332"/></p>
</section>
<section class="level3" data-number="17.3.2" id="acceptance-test-3">
<h3 data-number="17.3.2"><span class="titlemark"><span class="koboSpan" id="kobo.415.1" xmlns="http://www.w3.org/1999/xhtml">13.3.2 </span></span> <span id="x1-3080002"/><span class="koboSpan" id="kobo.416.1" xmlns="http://www.w3.org/1999/xhtml">Acceptance test</span></h3>
<p><span class="koboSpan" id="kobo.417.1" xmlns="http://www.w3.org/1999/xhtml">An automated acceptance test is difficult to define for a notebook. </span><span class="koboSpan" id="kobo.417.2" xmlns="http://www.w3.org/1999/xhtml">It’s hard to specify ways in which a notebook is helpful, meaningful, or insightful in the simple language of Gherkin scenarios.</span></p>
<p><span class="koboSpan" id="kobo.418.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.419.1" xmlns="http://www.w3.org/1999/xhtml">jupyter</span></code><code><span class="koboSpan" id="kobo.420.1" xmlns="http://www.w3.org/1999/xhtml"> execute</span></code><code><span class="koboSpan" id="kobo.421.1" xmlns="http://www.w3.org/1999/xhtml"> &lt;filename&gt;</span></code><span class="koboSpan" id="kobo.422.1" xmlns="http://www.w3.org/1999/xhtml"> command will execute an </span><code><span class="koboSpan" id="kobo.423.1" xmlns="http://www.w3.org/1999/xhtml">.ipynb</span></code><span class="koboSpan" id="kobo.424.1" xmlns="http://www.w3.org/1999/xhtml"> notebook file. </span><span class="koboSpan" id="kobo.424.2" xmlns="http://www.w3.org/1999/xhtml">This execution is entirely automated, allowing a </span><span id="dx1-308001"/><span class="koboSpan" id="kobo.425.1" xmlns="http://www.w3.org/1999/xhtml">kind of sanity check to be sure the notebook runs to completion. </span><span class="koboSpan" id="kobo.425.2" xmlns="http://www.w3.org/1999/xhtml">If there is a problem, the command will exit with a return code of 1, and the cell with the error will be displayed in detail. </span><span class="koboSpan" id="kobo.425.3" xmlns="http://www.w3.org/1999/xhtml">This can be handy for confirming the notebook isn’t trivially broken.</span></p>
<p><span class="koboSpan" id="kobo.426.1" xmlns="http://www.w3.org/1999/xhtml">The </span><code><span class="koboSpan" id="kobo.427.1" xmlns="http://www.w3.org/1999/xhtml">.ipynb</span></code><span class="koboSpan" id="kobo.428.1" xmlns="http://www.w3.org/1999/xhtml"> file is a JSON document. </span><span class="koboSpan" id="kobo.428.2" xmlns="http://www.w3.org/1999/xhtml">An application (or a step definition for </span><strong><span class="koboSpan" id="kobo.429.1" xmlns="http://www.w3.org/1999/xhtml">Behave</span></strong><span class="koboSpan" id="kobo.430.1" xmlns="http://www.w3.org/1999/xhtml">) can read the file to confirm some of its properties. </span><span class="koboSpan" id="kobo.430.2" xmlns="http://www.w3.org/1999/xhtml">An acceptance test case might look for error messages, for example, to see if the notebook failed to work properly.</span></p>
<p><span class="koboSpan" id="kobo.431.1" xmlns="http://www.w3.org/1999/xhtml">Cells with </span><code><span class="koboSpan" id="kobo.432.1" xmlns="http://www.w3.org/1999/xhtml">"type":</span></code><code><span class="koboSpan" id="kobo.433.1" xmlns="http://www.w3.org/1999/xhtml"> "code"</span></code><span class="koboSpan" id="kobo.434.1" xmlns="http://www.w3.org/1999/xhtml"> will also have </span><code><span class="koboSpan" id="kobo.435.1" xmlns="http://www.w3.org/1999/xhtml">"outputs"</span></code><span class="koboSpan" id="kobo.436.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span class="koboSpan" id="kobo.436.2" xmlns="http://www.w3.org/1999/xhtml">If one of the outputs has </span><code><span class="koboSpan" id="kobo.437.1" xmlns="http://www.w3.org/1999/xhtml">"output_type":</span></code><code><span class="koboSpan" id="kobo.438.1" xmlns="http://www.w3.org/1999/xhtml"> "error"</span></code><span class="koboSpan" id="kobo.439.1" xmlns="http://www.w3.org/1999/xhtml">; this cell indicates a problem in the notebook. </span><span class="koboSpan" id="kobo.439.2" xmlns="http://www.w3.org/1999/xhtml">The notebook did not run to completion, and the acceptance test should be counted as a failure.</span></p>
<p><span class="koboSpan" id="kobo.440.1" xmlns="http://www.w3.org/1999/xhtml">We can use projects like </span><strong><span class="koboSpan" id="kobo.441.1" xmlns="http://www.w3.org/1999/xhtml">Papermill </span></strong><span class="koboSpan" id="kobo.442.1" xmlns="http://www.w3.org/1999/xhtml">to automate notebook refresh with new data. </span><span class="koboSpan" id="kobo.442.2" xmlns="http://www.w3.org/1999/xhtml">This project can execute a template notebook and save the results as a finalized output notebook with values available and computations performed.</span></p>
<p><span class="koboSpan" id="kobo.443.1" xmlns="http://www.w3.org/1999/xhtml">For more information, see </span><a class="url" href="https://papermill.readthedocs.io"><span class="koboSpan" id="kobo.444.1" xmlns="http://www.w3.org/1999/xhtml">https://papermill.readthedocs.io</span></a><span class="koboSpan" id="kobo.445.1" xmlns="http://www.w3.org/1999/xhtml">. </span><span id="x1-308002r331"/></p>
</section>
</section>
<section class="level2" data-number="17.4" id="summary-12">
<h2 data-number="17.4"><span class="titlemark"><span class="koboSpan" id="kobo.446.1" xmlns="http://www.w3.org/1999/xhtml">13.4 </span></span> <span id="x1-3090004"/><span class="koboSpan" id="kobo.447.1" xmlns="http://www.w3.org/1999/xhtml">Summary</span></h2>
<p><span class="koboSpan" id="kobo.448.1" xmlns="http://www.w3.org/1999/xhtml">This project begins the deeper analysis work on clean data. </span><span class="koboSpan" id="kobo.448.2" xmlns="http://www.w3.org/1999/xhtml">It emphasizes several key skills, including:</span></p>
<ul>
<li><p><span class="koboSpan" id="kobo.449.1" xmlns="http://www.w3.org/1999/xhtml">More advanced Jupyter Notebook techniques. </span><span class="koboSpan" id="kobo.449.2" xmlns="http://www.w3.org/1999/xhtml">This includes setting the </span><code><span class="koboSpan" id="kobo.450.1" xmlns="http://www.w3.org/1999/xhtml">PYTHONPATH</span></code><span class="koboSpan" id="kobo.451.1" xmlns="http://www.w3.org/1999/xhtml"> to import modules and creating figures with plots to visualize data.</span></p></li>
<li><p><span class="koboSpan" id="kobo.452.1" xmlns="http://www.w3.org/1999/xhtml">Using </span><strong><span class="koboSpan" id="kobo.453.1" xmlns="http://www.w3.org/1999/xhtml">PyPlot </span></strong><span class="koboSpan" id="kobo.454.1" xmlns="http://www.w3.org/1999/xhtml">to present data. </span><span class="koboSpan" id="kobo.454.2" xmlns="http://www.w3.org/1999/xhtml">The project uses popular types of visualizations: histograms and scatter plots.</span></p></li>
<li><p><span class="koboSpan" id="kobo.455.1" xmlns="http://www.w3.org/1999/xhtml">Unit testing for Jupyter Notebook functions.</span></p></li>
</ul>
<p><span class="koboSpan" id="kobo.456.1" xmlns="http://www.w3.org/1999/xhtml">In the next chapter, we’ll formalize the notebook into a presentation “slide deck” that can be shown to a group of stakeholders. </span><span id="x1-309001r334"/></p>
</section>
<section class="level2" data-number="17.5" id="extras-11">
<h2 data-number="17.5"><span class="titlemark"><span class="koboSpan" id="kobo.457.1" xmlns="http://www.w3.org/1999/xhtml">13.5 </span></span> <span id="x1-3100005"/><span class="koboSpan" id="kobo.458.1" xmlns="http://www.w3.org/1999/xhtml">Extras</span></h2>
<p><span class="koboSpan" id="kobo.459.1" xmlns="http://www.w3.org/1999/xhtml">Here are some ideas for the reader to add to these projects. </span><span id="x1-310001r333"/></p>
<section class="level3" data-number="17.5.1" id="use-seaborn-for-plotting">
<h3 data-number="17.5.1"><span class="titlemark"><span class="koboSpan" id="kobo.460.1" xmlns="http://www.w3.org/1999/xhtml">13.5.1 </span></span> <span id="x1-3110001"/><span class="koboSpan" id="kobo.461.1" xmlns="http://www.w3.org/1999/xhtml">Use Seaborn for plotting</span></h3>
<p><span class="koboSpan" id="kobo.462.1" xmlns="http://www.w3.org/1999/xhtml">An alternative to the </span><strong><span class="koboSpan" id="kobo.463.1" xmlns="http://www.w3.org/1999/xhtml">pyplot </span></strong><span class="koboSpan" id="kobo.464.1" xmlns="http://www.w3.org/1999/xhtml">package is the </span><strong><span class="koboSpan" id="kobo.465.1" xmlns="http://www.w3.org/1999/xhtml">Seaborn </span></strong><span class="koboSpan" id="kobo.466.1" xmlns="http://www.w3.org/1999/xhtml">package. </span><span class="koboSpan" id="kobo.466.2" xmlns="http://www.w3.org/1999/xhtml">This package also provides statistical plotting functions. </span><span class="koboSpan" id="kobo.466.3" xmlns="http://www.w3.org/1999/xhtml">It provides a wider variety of styling options, permitting more colorful (and perhaps more informative) plots.</span></p>
<p><span class="koboSpan" id="kobo.467.1" xmlns="http://www.w3.org/1999/xhtml">See </span><a class="url" href="https://seaborn.pydata.org"><span class="koboSpan" id="kobo.468.1" xmlns="http://www.w3.org/1999/xhtml">https://seaborn.pydata.org</span></a><span class="koboSpan" id="kobo.469.1" xmlns="http://www.w3.org/1999/xhtml"> for more information.</span></p>
<p><span class="koboSpan" id="kobo.470.1" xmlns="http://www.w3.org/1999/xhtml">This module is based on </span><code><span class="koboSpan" id="kobo.471.1" xmlns="http://www.w3.org/1999/xhtml">matplotlib</span></code><span class="koboSpan" id="kobo.472.1" xmlns="http://www.w3.org/1999/xhtml">, making it compatible with JupyterLab.</span></p>
<p><span class="koboSpan" id="kobo.473.1" xmlns="http://www.w3.org/1999/xhtml">Note that the </span><strong><span class="koboSpan" id="kobo.474.1" xmlns="http://www.w3.org/1999/xhtml">Seaborn </span></strong><span class="koboSpan" id="kobo.475.1" xmlns="http://www.w3.org/1999/xhtml">package can work directly with a list-of-dictionary structure. </span><span class="koboSpan" id="kobo.475.2" xmlns="http://www.w3.org/1999/xhtml">This matches the ND JSON format used for acquiring and cleaning the data.</span></p>
<p><span class="koboSpan" id="kobo.476.1" xmlns="http://www.w3.org/1999/xhtml">Using a list-of-dictionary type suggests it might be better to avoid the analysis model structure, and stick with dictionaries created by the </span><strong><span class="koboSpan" id="kobo.477.1" xmlns="http://www.w3.org/1999/xhtml">clean </span></strong><span class="koboSpan" id="kobo.478.1" xmlns="http://www.w3.org/1999/xhtml">application. </span><span class="koboSpan" id="kobo.478.2" xmlns="http://www.w3.org/1999/xhtml">Doing this might sacrifice some model-specific processing and validation functionality.</span></p>
<p><span class="koboSpan" id="kobo.479.1" xmlns="http://www.w3.org/1999/xhtml">On the other hand, the </span><code><span class="koboSpan" id="kobo.480.1" xmlns="http://www.w3.org/1999/xhtml">pydantic</span></code><span class="koboSpan" id="kobo.481.1" xmlns="http://www.w3.org/1999/xhtml"> package offers a built-in </span><code><span class="koboSpan" id="kobo.482.1" xmlns="http://www.w3.org/1999/xhtml">dict()</span></code><span class="koboSpan" id="kobo.483.1" xmlns="http://www.w3.org/1999/xhtml"> method that covers a sophisticated analysis model object into a single dictionary, amenable to use with the </span><strong><span class="koboSpan" id="kobo.484.1" xmlns="http://www.w3.org/1999/xhtml">Seaborn </span></strong><span class="koboSpan" id="kobo.485.1" xmlns="http://www.w3.org/1999/xhtml">package. </span><span class="koboSpan" id="kobo.485.2" xmlns="http://www.w3.org/1999/xhtml">This seems to be an excellent way to combine these packages. </span><span class="koboSpan" id="kobo.485.3" xmlns="http://www.w3.org/1999/xhtml">We encourage the reader to explore this technology stack. </span><span id="x1-311001r336"/></p>
</section>
<section class="level3" data-number="17.5.2" id="adjust-color-palettes-to-emphasize-key-points-about-the-data">
<h3 data-number="17.5.2"><span class="titlemark"><span class="koboSpan" id="kobo.486.1" xmlns="http://www.w3.org/1999/xhtml">13.5.2 </span></span> <span id="x1-3120002"/><span class="koboSpan" id="kobo.487.1" xmlns="http://www.w3.org/1999/xhtml">Adjust color palettes to emphasize key points about the data</span></h3>
<p><span class="koboSpan" id="kobo.488.1" xmlns="http://www.w3.org/1999/xhtml">Both the </span><strong><span class="koboSpan" id="kobo.489.1" xmlns="http://www.w3.org/1999/xhtml">pyplot </span></strong><span class="koboSpan" id="kobo.490.1" xmlns="http://www.w3.org/1999/xhtml">package and the </span><strong><span class="koboSpan" id="kobo.491.1" xmlns="http://www.w3.org/1999/xhtml">Seaborn </span></strong><span class="koboSpan" id="kobo.492.1" xmlns="http://www.w3.org/1999/xhtml">package have extensive capabilities for applying color to the plot. </span><span class="koboSpan" id="kobo.492.2" xmlns="http://www.w3.org/1999/xhtml">A choice of colors can sometimes help make a distinction visible, or it can obscure important details.</span></p>
<p><span class="koboSpan" id="kobo.493.1" xmlns="http://www.w3.org/1999/xhtml">You can consider alternative styles to see which seems more useful.</span></p>
<p><span class="koboSpan" id="kobo.494.1" xmlns="http://www.w3.org/1999/xhtml">In some enterprise contexts, there are enterprise communications standards, with colors and fonts that are widely used. </span><span class="koboSpan" id="kobo.494.2" xmlns="http://www.w3.org/1999/xhtml">An important technique when using Seaborn is to create a style that matches enterprise communication standards.</span></p>
<p><span class="koboSpan" id="kobo.495.1" xmlns="http://www.w3.org/1999/xhtml">A number of websites provide website color schemes and design help. </span><span class="koboSpan" id="kobo.495.2" xmlns="http://www.w3.org/1999/xhtml">Sites like </span><a class="url" href="https://paletton.com"><span class="koboSpan" id="kobo.496.1" xmlns="http://www.w3.org/1999/xhtml">https://paletton.com</span></a><span class="koboSpan" id="kobo.497.1" xmlns="http://www.w3.org/1999/xhtml"> or </span><a class="url" href="https://colordesigner.io"><span class="koboSpan" id="kobo.498.1" xmlns="http://www.w3.org/1999/xhtml">colordesigner.io</span></a><span class="koboSpan" id="kobo.499.1" xmlns="http://www.w3.org/1999/xhtml"> provide complementary color palettes. </span><span class="koboSpan" id="kobo.499.2" xmlns="http://www.w3.org/1999/xhtml">With some effort, we can take these kinds of designs for color palettes and create Seaborn styles that permit a consistent and unique presentation style. </span><span id="x1-312001r321"/></p>
</section>
</section>
</section>
</body>
</html>
