<html><head></head><body><div><div><div><div><h1 class="title"><a id="ch03"/>Chapter 3. Day-to-day Coding Tools</h1></div></div></div><p>In this chapter, we will go through the <a id="id68" class="indexterm"/>coding tools that are essential during a normal day of work for a Python programmer in Visual Studio.</p><p>First we will analyze how to handle projects and solutions in Visual Studio, and then we will go through the refactoring of functionalities. Finally, we will go through the debugger functions that are available.</p><div><div><div><div><h1 class="title"><a id="ch03lvl1sec19"/>Project handling</h1></div></div></div><p>One of the most important and <a id="id69" class="indexterm"/>useful features of Visual Studio is the solution and project handling. Since the whole workflow is integrated into the IDE, the developer does not <a id="id70" class="indexterm"/>have the burden of dealing with files, working paths, and libraries. All of these can be managed directly in the IDE with the powerful Visual Studio user interface.</p><p>Before we dig into the tools in detail, we will first take a look at the Visual Studio lingo relating to project handling. The two main concepts used in this chapter are the solution and the project.</p><div><div><div><div><h2 class="title"><a id="ch03lvl2sec08"/>Solution</h2></div></div></div><p>A solution is essentially a container <a id="id71" class="indexterm"/>of projects that are bundled together to cover a unique scope. The projects can be referenced to each other and they can be of different types. For example, in a solution, you can mix a Python project with a C++ project while referencing the output of the project in the Python solution to use it as an external library. A solution also provides a way to group the whole code base of work in a single file/folder structure. You can then insert and manage the grouping in the versioning tool of your choice to share it quickly. A Visual Studio solution is also capable of maintaining shared configurations for the inner projects, while handing different commands and operations during different events (i.e. during the build of the solution).</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec09"/>Project</h2></div></div></div><p>A project is the classical definition of a <a id="id72" class="indexterm"/>bunch of files written in the same language and which covers a single scope. The types of projects can range from a website to a library or a console application.</p><p>Visual Studio projects for Python contain the environment definition: where to target the code, the references to external libraries, and the search paths that the compiler has to search in the libraries. The last one is particularly important since PTVS does not use the computer's PythonPath environment variable.</p><p>The deliberate and useful feature of ignoring system-wide settings allows you to reference different libraries in different projects for different Python versions. Furthermore, the dependency list in the code brings the added bonus of an easier debugging process and also provides an easy setup of a new development environment on other computers.</p><p>PTVS offers <a id="id73" class="indexterm"/>preconfigured Python <a id="id74" class="indexterm"/>projects called project templates, as we have seen in <a class="link" href="ch01.html" title="Chapter 1. Introduction to PTVS">Chapter 1</a>, <em>Introduction to PTVS</em>, which take care of creating the right project structure so that the developer can focus on the code.</p><p>Let's take a look at the actual tools that will handle solutions and projects. The most important and powerful one is the <strong>Solution Explorer</strong> window tool. This tool gives a complete view of the solution composition and the files and configurations available in each project.</p><div><img src="img/8687OS_03_01.jpg" alt="Project"/><div><p>To add something or to perform actions on a Solution or a Project, select the Solution or Project node in the tree-view</p></div></div><p>By now, you should already know how to navigate through the code using this tool, as we learned in <a class="link" href="ch02.html" title="Chapter 2. Python Tools in Visual Studio">Chapter 2</a>, <em>Python Tools in Visual Studio</em>. The <strong>Solution Explorer</strong> window tool also provides file handling capabilities, <a id="id75" class="indexterm"/>giving us the ability to add or remove files directly in the project structure. Just select <a id="id76" class="indexterm"/>a folder item in the project structure to insert a new file. To add something in the project root, select the project item in <strong>Solution Explorer</strong>, right-click to open the contextual menu, and go into the <strong>Add</strong> submenu as shown in the following screenshot:</p><div><img src="img/8687OS_03_02.jpg" alt="Project"/></div><p>Here, you can choose to add <a id="id77" class="indexterm"/>either <strong>New Item</strong>, <strong>Existing Item</strong>, or <strong>New Folder</strong>. If you choose to add <strong>New Item</strong>, the <strong>Add New Item</strong> window will show up as follows:</p><div><img src="img/8687OS_03_03.jpg" alt="Project"/></div><p>From here, you can create a new item from the various types that are available in the project.</p><p>If instead you want to add an existing file to the selected folder, select the <strong>Add existing item</strong> option from the contextual add menu. <a id="id78" class="indexterm"/>This will open a standard Windows browse file window; from here, you can navigate through the filesystem and select the file that you want to add to the selected folder. A copy of that file will be added to the folder.</p><p>To delete a file, just select the item in the project list and select the <strong>Delete</strong> menu item from the contextual menu.</p><div><img src="img/8687OS_03_04.jpg" alt="Project"/><div><p>The file contextual menu in the Solution Explorer window offers lots of functions on file, like "Delete", "Rename" and others</p></div></div><p>Now that we have more confidence in <strong>Solution Explorer</strong>, let's dig a little deeper into the Python-specific options that <strong>Solution Explorer</strong> offers. In the following sections, you will learn more about the configuration of a <a id="id79" class="indexterm"/>Python project: the environment, the references, and the search path.</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec10"/>Specifying Python environments</h2></div></div></div><p>It's possible to specifically <a id="id80" class="indexterm"/>define a Python environment version for a project instead of using the default Python version installed on the machine. This is particularly important for projects that we work on with other developers. By <a id="id81" class="indexterm"/>default, Visual Studio uses the default Python version installed on the machine when starting a new project. To link a project to a given Python version (environment), right-click on the <strong>Python Environment</strong> item in <strong>Solution Explorer</strong> to see the contextual menu. This is shown in the following screenshot:</p><div><img src="img/8687OS_03_05.jpg" alt="Specifying Python environments"/><div><p>The Python Environments contextual menu in the Solution Explorer window</p></div></div><p>This contextual menu provides various functionalities such as adding or removing a Python environment and linking the project to either a virtual Python environment or an existing one. The last two options are very useful when you need to have a project running in a completely isolated <a id="id82" class="indexterm"/>environment space on the machine. The project can then be run with all of its dependencies and libraries in an isolated place, without interfering with the existing Python installations and Python path configurations on the machine.</p><p>Creating a virtual environment in <a id="id83" class="indexterm"/>Visual Studio is straightforward. Click on either <strong>Add Virtual Environment</strong> or <strong>Add Existing Virtual Environment</strong> and follow a few steps to complete the setup.</p><p>As an example, we will create a virtual environment for our project. Clicking on <strong>Add Virtual Environment</strong> will show the following modal window:</p><div><img src="img/8687OS_03_06.jpg" alt="Specifying Python environments"/></div><p>You can define the name of the virtual environment and the targeted Python version in this window. Once the <strong>Create</strong> button is pressed, Visual Studio will create the virtual environment. As a nifty bonus, if <a id="id84" class="indexterm"/>the necessary Python libraries are not installed on the machine—essentially <code class="literal">pip</code>, <code class="literal">setuptools</code>, and <code class="literal">virtualEnv</code>—<a id="id85" class="indexterm"/>PTVS will take care of this by downloading and installing them. Like other generic <a id="id86" class="indexterm"/>Python packages, they will be installed in the system-defined <code class="literal">site-packages</code> folder.</p><p>To link a project to a given Python version, just click on the <strong>Add Python Environment</strong> option in the contextual menu and the following helper box will show up:</p><div><img src="img/8687OS_03_07.jpg" alt="Specifying Python environments"/></div><p>This helper box shows a list of the Python versions installed on the machine and which are available for you to choose. Once a Python version is <a id="id87" class="indexterm"/>selected, the reference <a id="id88" class="indexterm"/>will show up in <strong>Solution Explorer</strong>.</p><div><img src="img/8687OS_03_08.jpg" alt="Specifying Python environments"/><div><p>The <strong>References</strong> item elements in a project provide the ability to tightly link a library in your project or reference to packages compiled in the .pyd files</p></div></div><p>Right-click on the <strong>Reference</strong> option <a id="id89" class="indexterm"/>and then click on <strong>Add Reference</strong> to bring up the following helper window:</p><div><img src="img/8687OS_03_09.jpg" alt="Specifying Python environments"/></div><p>We will focus on the <strong>Projects</strong> tab, which shows all the other projects in your solution. If you wish to use another library project to handle a subscope of the application, select the desired project and click on <strong>OK</strong>. This creates a reference in your project. You can find the list of references under the reference <a id="id90" class="indexterm"/>option in the <strong>Solution </strong>
<a id="id91" class="indexterm"/>
<strong>Explorer</strong> window:</p><div><img src="img/8687OS_03_10.jpg" alt="Specifying Python environments"/></div></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec11"/>Defining Search Paths</h2></div></div></div><p>The <strong>Search Paths</strong> <a id="id92" class="indexterm"/>functionality basically tells Visual Studio <a id="id93" class="indexterm"/>where to search for additional libraries that will be used in the project. You can reference a folder in the system or a <code class="literal">.zip</code> file that contains the libraries:</p><div><img src="img/8687OS_03_11.jpg" alt="Defining Search Paths"/><div><p>The Search Path contextual menu, with the "Add Folder" and "Add Zip Archive" options</p></div></div><p>Once the folder of the <code class="literal">.zip</code> file <a id="id94" class="indexterm"/>is selected, you can <a id="id95" class="indexterm"/>find the libraries in the window:</p><div><img src="img/8687OS_03_12.jpg" alt="Defining Search Paths"/></div></div></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec20"/>Refactoring</h1></div></div></div><p>Refactoring is one of the biggest <a id="id96" class="indexterm"/>advancements in modern IDEs. It significantly cuts down on time and reduces the margin of error by the way in which it handles changes in the code and automated operations. Visual Studio comes with great out-of-the-box refactoring functionalities such as renaming and the creating method from a selected piece of code.</p><p>The renaming functionality can really help with potential errors in code, such as when changing the <a id="id97" class="indexterm"/>name of an element. There might be instances in the codebase where the old name is still used. Let's have a look at the following code:</p><div><pre class="programlisting">class foo:
    """
    Documentation of the class.
    It can be multiline and contain any amount of text
    """
    @classmethod
    def bar(self, first=0, second=0):
        """This is the documentation for the method"""
        return first + second

print(foo.bar())</pre></div><p>In this code, there's a class, <code class="literal">foo</code>, that has a method called <code class="literal">bar</code>. If <code class="literal">bar</code> is renamed, it will create an error by referencing to a nonexistent method.</p><p>Visual Studio's refactoring functionality helps the renaming process by taking all the references of the element into account. <a id="id98" class="indexterm"/>Select the element that you wish to demand and then access the refactoring function in the code contextual menu by right-clicking on it:</p><div><img src="img/8687OS_03_13.jpg" alt="Refactoring"/><div><p>Access refactoring function by right clicking on the element</p></div></div><p>Select the <strong>Rename</strong> function to start the two-step process:</p><div><img src="img/8687OS_03_14.jpg" alt="Refactoring"/></div><p>You are prompted to enter a new name for the element. There's also a checkbox that permits you to preview the references of the element to be renamed. When the checkbox is unchecked, all the references that are <a id="id99" class="indexterm"/>found will be renamed; you will not be able to preview which references are going to be renamed.</p><div><img src="img/8687OS_03_15.jpg" alt="Refactoring"/></div><p>In a situation where you wish to preview the reference change, a preview window will be shown. As shown in the preceding screenshot, in this window all references of the old element name can be found at the top panel and the code preview will be at the bottom. All the files of the project will be analyzed to refactor the element correctly. A checkbox near each reference provides the option to activate the refactoring of that <a id="id100" class="indexterm"/>reference. Clicking on the <strong>Apply</strong> button will rename the element and all the selected references.</p><p>The other refactoring function is <strong>Extract </strong>
<a id="id101" class="indexterm"/>
<strong>Method</strong>. This comes in handy when you wish to reuse a piece of code somewhere else as a function or a method. Visual Studio can generate it as a function/method. As an example, refer to the following screenshot:</p><div><img src="img/8687OS_03_16.jpg" alt="Refactoring"/></div><p>In the code, the highlighted code aims to create a generic method that calculates the sum of two elements. Select the code and then select <strong>Extract Method</strong> from the <strong>Refactor</strong> submenu in the contextual menu. This brings up the <strong>Extract Method</strong> dialog box, which is shown in the following screenshot:</p><div><img src="img/8687OS_03_17.jpg" alt="Refactoring"/></div><p>In the <strong>Extract Method</strong> window, you can define the name of the method in the <strong>New method name</strong> field and provide a path for the method to be created in the <strong>Extract to</strong> field. A <strong>Preview</strong> panel also shows the <a id="id102" class="indexterm"/>generated code. Click on <strong>OK</strong> to create the new method based on the selected code.</p></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec21"/>Debugging</h1></div></div></div><p>Visual Studio offers a large set of <a id="id103" class="indexterm"/>debugging tools; PTVS inherits a lot of them, which helps Python developers to debug code by using step-by-step execution, runtime <a id="id104" class="indexterm"/>variable watch capabilities, breakpoints, and the ability to see where the code fails during a debugging session.</p><p>The ability to see where the code breaks can significantly speed up the debugging session. In the following screenshot, we can see an example of an untracked exception:</p><div><img src="img/8687OS_03_18.jpg" alt="Debugging"/><div><p>An example of error dialog box during debugging a Python application</p></div></div><p>When you run the code, Visual Studio will stop the execution because it detects the raised exception of a problematic code. It highlights the exact point where the error occurred while also suggesting ways to fix it—even if <a id="id105" class="indexterm"/>right now Visual Studio may not suggest useful solutions for the problem.</p><p>The debugging process is not only about understanding where exceptions are raised, but also to understand what happens in the <a id="id106" class="indexterm"/>code when it is not behaving as expected. This is where step-by-step execution and breakpoints come in handy.</p><div><div><div><div><h2 class="title"><a id="ch03lvl2sec12"/>Using breakpoints</h2></div></div></div><p>A breakpoint is a point that you <a id="id107" class="indexterm"/>can define in the code to stop the execution. <a id="id108" class="indexterm"/>Visual Studio has made it very simple to set a breakpoint. It allows better visibility of the content of variables and it follows the flow of the code. A breakpoint can be set by clicking in the gutter of the code window, which will bring up a red circle. Select <strong>Insert Breakpoint</strong> in the <strong>Breakpoint</strong> submenu in the code contextual menu.</p><p>Once the breakpoint is set, you can see it in the code window as shown in the following screenshot:</p><div><img src="img/8687OS_03_19.jpg" alt="Using breakpoints"/></div><p>Now that the breakpoint is set, if you run the application, Visual Studio will stop its execution precisely at the breakpoint while following the flow of the code:</p><div><img src="img/8687OS_03_20.jpg" alt="Using breakpoints"/><div><p>Indicated that line 29 as the breakpoint</p></div></div><p>The IDE puts the caret on the first column <a id="id109" class="indexterm"/>of the line of code in which we set the breakpoint. When hovering around the variables in that context, we can see the current value <a id="id110" class="indexterm"/>of the variable.</p></div><div><div><div><div><h2 class="title"><a id="ch03lvl2sec13"/>Utilizing watch entries</h2></div></div></div><p>We can also create a watch <a id="id111" class="indexterm"/>entry on a variable in order to see how the value of a variable changes during the program flow. To watch a variable, right-click on it during the <a id="id112" class="indexterm"/>debugging process and click on <strong>Add Watch</strong> in the contextual menu. The variable will be added into the <strong>Watch</strong> window as shown in the following screenshot:</p><div><img src="img/8687OS_03_21.jpg" alt="Utilizing watch entries"/></div><p>Besides the <code class="literal">watch</code> variable, it is also <a id="id113" class="indexterm"/>possible to see all the variables in the current scope from the <strong>Locals</strong> tab:</p><div><img src="img/8687OS_03_22.jpg" alt="Utilizing watch entries"/></div><p>Once a breakpoint has been hit, it's <a id="id114" class="indexterm"/>possible to use one of the following three functions to move on in the program flow: <code class="literal">Step Into</code>, <code class="literal">Step Over</code>, and <code class="literal">Step Out</code>. These functions are accessible through the <strong>Debug</strong> menu or the buttons available in the toolbar. Alternatively, you can also use <code class="literal">Run to Cursor</code> (<em>Ctrl</em> + <em>F10</em>) to run through the program until you reach where the cursor is:</p><div><img src="img/8687OS_03_23.jpg" alt="Utilizing watch entries"/></div><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">Step Into</code>: This executes the <a id="id115" class="indexterm"/>next statement and stops. If the next statement is a call to a function, the debugger will stop at the first line of the function being called entering the function.</li><li class="listitem" style="list-style-type: disc"><code class="literal">Step Over</code>: This executes the <a id="id116" class="indexterm"/>next statement. However, if the next statement is a function, calling it will not go into it. It's useful when you are not willing to follow the entire program flow of the function.</li><li class="listitem" style="list-style-type: disc"><code class="literal">Step Out</code>: This executes the code <a id="id117" class="indexterm"/>until the end of the current <a id="id118" class="indexterm"/>function. It's useful when you do not wish to go through the entire program <a id="id119" class="indexterm"/>flow of the current function.</li></ul></div><p>If you wish to just continue the execution of the program flow without going into a single line of code at the time, just press the <strong>Continue</strong> button in the toolbar or <em>F5</em>. If there are other breakpoints in your code, the execution will continue through all of them until the last one.</p></div></div>
<div><div><div><div><h1 class="title"><a id="ch03lvl1sec22"/>Summary</h1></div></div></div><p>In this chapter, we introduced the tools for day-to-day coding. You are now familiar with browsing through the code with <strong>Solution Explorer</strong> and the flexible setting of Python environments. You also learned about the more efficient refactoring and debugging process and that setting up breakpoints and watching entries helps you trace exactly where the code breaks.</p><p>In the next chapter, we will explore how to harness the powerful Visual Studio IDE and the tools available to speed up Django development.</p></div></body></html>