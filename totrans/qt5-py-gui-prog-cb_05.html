<html><head></head><body>
  <div id="sbo-rt-content"><div class="chapter" title="Chapter 5. Matplotlib Charts"><div class="titlepage"><div><div><h1 class="title"><a id="ch05"/>Chapter 5. Matplotlib Charts</h1></div></div></div><p>In this chapter, we will create beautiful charts using Python 3 with the Matplotlib module.</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Creating beautiful charts using Matplotlib</li><li class="listitem" style="list-style-type: disc">Matplotlib – downloading modules using pip</li><li class="listitem" style="list-style-type: disc">Matplotlib – downloading modules with whl extensions</li><li class="listitem" style="list-style-type: disc">Creating our first chart</li><li class="listitem" style="list-style-type: disc">Placing labels on charts</li><li class="listitem" style="list-style-type: disc">How to give the chart a legend</li><li class="listitem" style="list-style-type: disc">Scaling charts</li><li class="listitem" style="list-style-type: disc">Adjusting the scale of charts dynamically</li></ul></div><div class="section" title="Introduction"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec44"/>Introduction</h1></div></div></div><p>In this chapter, we will create beautiful charts that visually represent data. Depending on the format of the data source, we can plot one or several columns of data in the same chart.</p><p>We will be using the Python Matplotlib module to create our charts.</p><p>In order to create these graphical charts, we need to download additional Python modules and there are several ways to install them.</p><p>This chapter will explain how to download the Matplotlib Python module, all other required Python modules, and the ways to do this.</p><p>After we have the required modules installed, we will then create our own Pythonic charts.</p></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Creating beautiful charts using Matplotlib"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec45"/>Creating beautiful charts using Matplotlib</h1></div></div></div><p>This<a id="id140" class="indexterm"/> recipe introduces us to the Matplotlib Python <a id="id141" class="indexterm"/>module, which enables us to create visual charts using Python 3.</p><p>The following URL is a great place to start exploring the world of Matplotlib and will teach <a id="id142" class="indexterm"/>you how to create many charts that are not presented in this chapter:</p><p>
<a class="ulink" href="http://matplotlib.org/users/screenshots.html">http://matplotlib.org/users/screenshots.html</a>
</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec113"/>Getting ready</h2></div></div></div><p>In order to use the Matplotlib Python module, we first have to install this module, as well as several other related Python modules such as numpy.</p><p>If you are running a version of Python less than 3.4.3, I would encourage you to upgrade your version of Python as we will be using the Python pip module throughout this chapter to install the required Python modules, and pip is installed with 3.4.3 and above.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note42"/>Note</h3><p>It is possible to install pip with earlier versions of Python 3 but the process is not very intuitive, so it is definitely better to upgrade to 3.4.3 or above.</p></div></div></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec114"/>How to do it...</h2></div></div></div><p>The following picture is an example of what incredible graphical charts can be created using Python with the Matplotlib module.</p><p>I have copied the following code from the <a class="ulink" href="http://matplotlib.org/">http://matplotlib.org/</a> website, which creates this incredible chart. There are many examples available on this site and I encourage you to try them out until you find the kind of charts you like to create.</p><p>Here is the code to create the chart, in less than 25 lines of Python code, including whitespaces.</p><div class="informalexample"><pre class="programlisting">from mpl_toolkits.mplot3d import Axes3D
from matplotlib import cm
from matplotlib.ticker import LinearLocator, FormatStrFormatter
import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure()
ax = fig.gca(projection='3d')
X = np.arange(-5, 5, 0.25)
Y = np.arange(-5, 5, 0.25)
X, Y = np.meshgrid(X, Y)
R = np.sqrt(X**2 + Y**2)
Z = np.sin(R)
surf = ax.plot_surface(X, Y, Z, rstride=1, cstride=1, cmap=cm.coolwarm, linewidth=0, antialiased=False)

ax.set_zlim(-1.01, 1.01)

ax.zaxis.set_major_locator(LinearLocator(10))
ax.zaxis.set_major_formatter(FormatStrFormatter('%.02f'))

fig.colorbar(surf, shrink=0.5, aspect=5)

plt.show()</pre></div><p>Running the<a id="id143" class="indexterm"/> code <a id="id144" class="indexterm"/>creates the chart pictured as follows:</p><div class="mediaobject"><img src="images/B04829_05_01.jpg" alt="How to do it..."/></div><p>Running the code using Python 3.4 or above with the Eclipse PyDev plugin might show some unresolved import errors. This seems to be a bug in PyDev or Java.</p><p>Just ignore those errors if you are developing using Eclipse, as the code will run successfully.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec115"/>How it works...</h2></div></div></div><p>In order to <a id="id145" class="indexterm"/>create beautiful graphs as shown in the preceding screenshot, we <a id="id146" class="indexterm"/>need to download several other Python modules.</p><p>The following recipes will guide us through how to successfully download all the required modules, which enables us to create our own beautiful charts.</p></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Matplotlib – downloading modules using pip"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec46"/>Matplotlib – downloading modules using pip</h1></div></div></div><p>The usual <a id="id147" class="indexterm"/>way to download additional Python <a id="id148" class="indexterm"/>modules is by using pip. The pip module comes pre-installed with the latest version of Python (3.4 and above).</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note43"/>Note</h3><p>If you are using an older version of Python, you might have to download both pip and setuptools yourself.</p></div></div><p>In addition to using the Python installer, there are several other precompiled Windows executables that make it easy for us to install Python modules such as Matplotlib.</p><p>This recipe will show how to successfully install Matplotlib via a Windows executable, as well as using pip in order to install the additional modules that the Matplotlib library requires.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec116"/>Getting ready</h2></div></div></div><p>All we need to do to download the required Python modules to use the Matplotlib module is to have a Python release of 3.4 (or later) installed on our PC.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec117"/>How to do it...</h2></div></div></div><p>We can install Matplotlib via a Windows executable from the official Matplotlib website.</p><p>Make sure you install the Matplotlib version that matches the Python version you are using. For example, download and install <code class="literal">Matplotlib-1.4.3.win-amd64-py3.4.exe</code> if you have Python 3.4 installed on a 64-bit OS such as Microsoft Windows 7.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note44"/>Note</h3><p>The "amd64" in the middle of the executable name means you are installing the 64-bit version. If you are using a 32-bit x86 system then installing amd64 will not work. Similar problems can occur if you have installed a 32-bit version of Python and download 64-bit Python modules.</p></div></div><div class="mediaobject"><img src="images/B04829_05_02.jpg" alt="How to do it..."/></div><p>Running<a id="id149" class="indexterm"/> the executable will get us started <a id="id150" class="indexterm"/>and looks like this:</p><div class="mediaobject"><img src="images/B04829_05_03.jpg" alt="How to do it..."/></div><p>We can verify that we have successfully installed Matplotlib by looking at our Python installation directory.</p><p>After<a id="id151" class="indexterm"/> a successful installation, the Matplotlib folder<a id="id152" class="indexterm"/> is added to site-packages. Using a default installation, the full path to the site-packages folder on Windows is:</p><p>
<code class="literal">C:\Python34\Lib\site-packages\matplotlib\</code>
</p><div class="mediaobject"><img src="images/B04829_05_04.jpg" alt="How to do it..."/></div><p>The simplest plotting example on the official Matplotlib website requires the use of the Python numpy module, so let's download and install this module next.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note45"/>Note</h3><p>Numpy is a<a id="id153" class="indexterm"/> mathematical module that enables the graphing of the Matplotlib charts but goes well beyond Matplotlib. If the software you are developing requires a lot of mathematical computations, you definitely want to check out numpy.</p></div></div><p>There is one excellent website that gives us quick links to pretty much all the Python modules out there. It serves as a great time saver by pointing out which other Python modules<a id="id154" class="indexterm"/> are necessary to use Matplotlib successfully <a id="id155" class="indexterm"/>and gives us hyperlinks to download these modules, which enables us to install them quickly and easily.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note46"/>Note</h3><p>Here is the link:</p><p>
<a class="ulink" href="http://www.lfd.uci.edu/~gohlke/pythonlibs/">http://www.lfd.uci.edu/~gohlke/pythonlibs/</a>
</p></div></div><div class="mediaobject"><img src="images/B04829_05_05.jpg" alt="How to do it..."/></div><p>Notice how<a id="id156" class="indexterm"/> the file extensions of the installer packages all end in whl. In order to use them, we have to install the Python wheel module, and we do this using pip.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note47"/>Note</h3><p>Wheels are the new standard of Python distribution and are intended to replace eggs.</p><p>You can<a id="id157" class="indexterm"/> find more details at the following website:</p><p>
<a class="ulink" href="http://pythonwheels.com/">http://pythonwheels.com/</a>
</p><p>It is best to run the Windows command processor as an administrator to avoid potential installation errors.</p></div></div><div class="mediaobject"><img src="images/B04829_05_06.jpg" alt="How to do it..."/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec118"/>How it works...</h2></div></div></div><p>The<a id="id158" class="indexterm"/> common way to download Python modules is<a id="id159" class="indexterm"/> by using pip, as shown above. In order to install all the modules that Matplotlib requires, the download format of the main website where we can download them has changed to using a whl format.</p><p>The next recipe will explain how to install Python modules using wheel.</p></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Matplotlib – downloading modules with whl extensions"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec47"/>Matplotlib – downloading modules with whl extensions</h1></div></div></div><p>We will <a id="id160" class="indexterm"/>use several additional <a id="id161" class="indexterm"/>Python modules that Matplotlib requires and, in this recipe, we will download them using Python's new module distribution standard, called wheel.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note48"/>Note</h3><p>You <a id="id162" class="indexterm"/>can find the Python Enhancement Proposal (PEP) for the new wheel standard at the following URL: <a class="ulink" href="https://www.python.org/dev/peps/pep-0427/">https://www.python.org/dev/peps/pep-0427/</a>
</p></div></div><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec119"/>Getting ready</h2></div></div></div><p>In order to download Python modules with a whl extension, the Python wheel module has to be installed first, which was explained in the previous recipe.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec120"/>How to do it...</h2></div></div></div><p>Let's download <code class="literal">numpy-1.9.2+mkl-cp34-none-win_amd64.whl</code> from the web. After installing the wheel module, we can use pip to install packages with whl file extensions.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note49"/>Note</h3><p>Pip ships with Python 3.4.3 and above. If you are using an older version of Python, I would recommend installing pip because it makes installing all other additional Python modules so much easier.</p><p>An even better suggestion might be to upgrade your Python version to the latest stable release. By the time you read this book, that most likely will be Python 3.5.0 or above.</p><p>Python is free software. It does not cost us anything to upgrade.</p></div></div><p>Browse<a id="id163" class="indexterm"/> to the folder where the<a id="id164" class="indexterm"/> package to be installed is located, and install it using the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>pip install numpy-1.9.2+mkl-cp34-none-win_amd64.whl</strong></span>
</pre></div><div class="mediaobject"><img src="images/B04829_05_07.jpg" alt="How to do it..."/></div><p>Now we can create our first Matplotlib chart, using the simplest example application from the official website. After that, we will be creating our own charts.</p><div class="mediaobject"><img src="images/B04829_05_08.jpg" alt="How to do it..."/></div><p>The fact that we are not quite ready to run the preceding code shows that we need to download more modules. While at first having to download more modules might seem to be a little bit annoying, it really is a form of code reuse.</p><p>So let's <a id="id165" class="indexterm"/>download and install the <a id="id166" class="indexterm"/>six and all the other required modules (dateutil, pyparsing, and so on) using pip with wheel until our code works and creates a nice chart from only a few lines of Python code.</p><p>We can download all the required modules from the same website we just used to install numpy. This website even lists all of the other modules the module we are installing depends on and has hyperlinks to jump to the installation software located in this very same website.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note50"/>Note</h3><p>As<a id="id167" class="indexterm"/> mentioned previously, the URL for installing Python modules is: <a class="ulink" href="http://www.lfd.uci.edu/~gohlke/pythonlibs/">http://www.lfd.uci.edu/~gohlke/pythonlibs/</a>
</p></div></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec121"/>How it works...</h2></div></div></div><p>The website that enables us to download many Python modules from one convenient place also provides other Python modules. Not all dependencies shown are required. It depends on what you are developing. You might have to download and install additional modules as your journey into using the Matplotlib library advances.</p><div class="mediaobject"><img src="images/B04829_05_09.jpg" alt="How it works..."/></div></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Creating our first chart"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec48"/>Creating our first chart</h1></div></div></div><p>Now that<a id="id168" class="indexterm"/> we have all of the required Python modules installed, we can create our own charts using Matplotlib.</p><p>We can create charts from only a few lines of Python code.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec122"/>Getting ready</h2></div></div></div><p>Using the code from the previous recipe, we can now create a chart that looks similar to the one shown next.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec123"/>How to do it...</h2></div></div></div><p>Using the <a id="id169" class="indexterm"/>minimum amount of code as presented on the official website, we can create our first chart. Well, almost. The sample code shown on the website does not work until we import the <code class="literal">show</code> method and then call it.</p><div class="mediaobject"><img src="images/B04829_05_10.jpg" alt="How to do it..."/></div><p>We can simplify the code and even improve it by using another of many examples provided on the official Matplotlib website.</p><div class="mediaobject"><img src="images/B04829_05_11.jpg" alt="How to do it..."/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec124"/>How it works...</h2></div></div></div><p>The<a id="id170" class="indexterm"/> Python Matplotlib module, combined with add-ons such as numpy, create a very rich programming environment that enables us to do mathematical computations and plot them in visual charts very easily.</p><p>The Python numpy method <code class="literal">arange</code> does not intend to arrange anything. It means to create "a range", which in Python is used for the built-in "range" operator. The <code class="literal">linspace</code> method can create similar confusion. Who is "lin" and in what "space"?</p><p>As it turns out, the name means "linear spaced vector".</p><p>The pyglet function <code class="literal">show</code> displays the graph we created. Calling <code class="literal">show()</code> has some side-effects when you try to plot another graph after successfully creating the first one.</p></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Placing labels on charts"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec49"/>Placing labels on charts</h1></div></div></div><p>So far,<a id="id171" class="indexterm"/> we have used the default Matplotlib GUI. Now we will create some tkinter GUIs using Matplotlib.</p><p>This will require a few more lines of Python code and importing some more libraries, and it is well worth the effort, because we are gaining control of our paintings using canvases.</p><p>We will position labels onto both the horizontal as well as the vertical axes, aka <span class="emphasis"><em>x</em></span> and <span class="emphasis"><em>y</em></span>.</p><p>We will do this by creating a Matplotlib figure upon which we will draw.</p><p>We will also learn how to use sub plots, which will enable us to draw more than one graph in the same window.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec125"/>Getting ready</h2></div></div></div><p>With the necessary Python modules installed and knowing where to find the official online documentation and tutorials, we can now carry on with our creation of Matplotlib charts.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec126"/>How to do it...</h2></div></div></div><p>While <code class="literal">plot</code> is the easiest way to create a Matplotlib chart, using <code class="literal">Figure</code> in combination with <code class="literal">Canvas</code> creates a more custom-made graph, which looks much better and also enables us to add buttons and other widgets to it.</p><div class="informalexample"><pre class="programlisting">from matplotlib.figure import Figure
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
import tkinter as tk
#--------------------------------------------------------------
fig = Figure(figsize=(12, 8), facecolor='white')
#--------------------------------------------------------------
# axis = fig.add_subplot(111)   # 1 row,  1 column, only graph
axis = fig.add_subplot(211)     # 2 rows, 1 column, Top graph
#--------------------------------------------------------------
xValues = [1,2,3,4]
yValues = [5,7,6,8]
axis.plot(xValues, yValues)

axis.set_xlabel('Horizontal Label')
axis.set_ylabel('Vertical Label')

# axis.grid()                   # default line style 
axis.grid(linestyle='-')        # solid grid lines
#--------------------------------------------------------------
def _destroyWindow():
    root.quit()
    root.destroy() 
#--------------------------------------------------------------
root = tk.Tk() 
root.withdraw()
root.protocol('WM_DELETE_WINDOW', _destroyWindow)   
#--------------------------------------------------------------
canvas = FigureCanvasTkAgg(fig, master=root)
canvas._tkcanvas.pack(side=tk.TOP, fill=tk.BOTH, expand=1)
#--------------------------------------------------------------
root.update()
root.deiconify()
root.mainloop()</pre></div><p>Running the preceding code results in the following chart:</p><div class="mediaobject"><img src="images/B04829_05_12.jpg" alt="How to do it..."/></div><p>In the first line<a id="id172" class="indexterm"/> of code after the import statements, we create an instance of a <code class="literal">Figure</code> object. Next, we add sub plots to this figure by calling <code class="literal">add_subplot(211)</code>. The first number in 211 tells the figure how many plots to add, the second number determines the number of columns and the third tells the figure in which order to display the plots.</p><p>We also add a grid and change its default line style.</p><p>Even though we only display one plot in the chart, by choosing 2 for the number of sub plots, we are moving the plot up, which results in extra whitespace at the bottom of the chart. This first plot now only occupies 50% of the screen, which affects how large the grid lines of this plot are when being displayed.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note51"/>Note</h3><p>Experiment with the code by uncommenting the code for <code class="literal">axis =</code> and <code class="literal">axis.grid()</code> to see the different effects.</p></div></div><p>We can add more sub plots by assigning them to the second position using <code class="literal">add_subplot(212)</code>.</p><div class="informalexample"><pre class="programlisting">from matplotlib.figure import Figure
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
import tkinter as tk
#--------------------------------------------------------------
fig = Figure(figsize=(12, 8), facecolor='white')
#--------------------------------------------------------------
axis = fig.add_subplot(211)     # 2 rows, 1 column, Top graph
#--------------------------------------------------------------
xValues = [1,2,3,4]
yValues = [5,7,6,8]
axis.plot(xValues, yValues)

axis.set_xlabel('Horizontal Label')
axis.set_ylabel('Vertical Label')

axis.grid(linestyle='-')        # solid grid lines
#--------------------------------------------------------------
axis1 = fig.add_subplot(212)    # 2 rows, 1 column, Bottom graph
#--------------------------------------------------------------
xValues1 = [1,2,3,4]
yValues1 = [7,5,8,6]
axis1.plot(xValues1, yValues1)
axis1.grid()                    # default line style 
#--------------------------------------------------------------
def _destroyWindow():
    root.quit()
    root.destroy() 
#--------------------------------------------------------------
root = tk.Tk() 
root.withdraw()
root.protocol('WM_DELETE_WINDOW', _destroyWindow)   
#--------------------------------------------------------------
canvas = FigureCanvasTkAgg(fig, master=root)
canvas._tkcanvas.pack(side=tk.TOP, fill=tk.BOTH, expand=1)
#--------------------------------------------------------------
root.update()
root.deiconify()
root.mainloop()</pre></div><p>Running the<a id="id173" class="indexterm"/> slightly modified code now adds axis1 to the chart. For the grid of the bottom plot, we left the line style at its default.</p><div class="mediaobject"><img src="images/B04829_05_13.jpg" alt="How to do it..."/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec127"/>How it works...</h2></div></div></div><p>We imported <a id="id174" class="indexterm"/>the necessary Matplotlib modules to create a figure and a canvas onto which to draw the chart. We gave it some values for the <span class="emphasis"><em>x</em></span> and <span class="emphasis"><em>y</em></span> axes and set a few of very many configuration options.</p><p>We created our own tkinter window in which to display the chart and customized the positioning of the plots.</p><p>As we have seen in previous chapters, in order to create a tkinter GUI, we first have to import the tkinter module and then create an instance of the <code class="literal">Tk</code> class. We assign this class instance to a variable we named <code class="literal">root</code>, which is a name that is often used in examples.</p><p>Our tkinter GUI will not become visible until we start the main event loop and, to do that, we use <code class="literal">root.mainloop()</code>.</p><p>One important reason to avoid the Matplotlib default GUI here and instead create our own GUI using tkinter is that we wanted to improve the not very pretty appearance of the default Matplotlib GUI and we can very easily do this using tkinter.</p><p>We no longer have those out-of-date looking buttons appearing at the bottom of the Matplotlib GUI if we build our GUI with tkinter.</p><p>At the<a id="id175" class="indexterm"/> same time, the Matplotlib GUI has a feature our tkinter GUI does not have and that is that we can actually see the x and y coordinates in the Matplotlib GUI when we move our mouse around within the chart. The x and y coordinate positions are displayed in the bottom right corner.</p></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="How to give the chart a legend"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec50"/>How to give the chart a legend</h1></div></div></div><p>Once we<a id="id176" class="indexterm"/> start plotting more than one line of data points, things might become a little bit unclear. By adding a legend to our graphs, we can tell which data is what, and what it actually means.</p><p>We do not have to choose different colors to represent the different data. Matplotlib automatically assigns a different color to each line of data points.</p><p>All we have to do is create the chart and add a legend to it.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec128"/>Getting ready</h2></div></div></div><p>In this recipe, we will enhance the chart from the previous recipe. We will only plot one chart.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec129"/>How to do it...</h2></div></div></div><p>First, we will plot more lines of data in the same chart and then we will add a legend to the chart.</p><p>We do this by modifying the code from the previous recipe.</p><div class="informalexample"><pre class="programlisting">from matplotlib.figure import Figure
from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
import tkinter as tk
#--------------------------------------------------------------
fig = Figure(figsize=(12, 5), facecolor='white')
#--------------------------------------------------------------
axis  = fig.add_subplot(111)                  # 1 row, 1 column

xValues  = [1,2,3,4]

yValues0 = [6,7.5,8,7.5]
yValues1 = [5.5,6.5,8,6]
yValues2 = [6.5,7,8,7]

t0, = axis.plot(xValues, yValues0)
t1, = axis.plot(xValues, yValues1)
t2, = axis.plot(xValues, yValues2)

axis.set_ylabel('Vertical Label')
axis.set_xlabel('Horizontal Label')

axis.grid()
          
fig.legend((t0, t1, t2), ('First line', 'Second line', 'Third line'), 'upper right')

#--------------------------------------------------------------
def _destroyWindow():
    root.quit()
    root.destroy() 
#--------------------------------------------------------------
root = tk.Tk() 
root.withdraw()
root.protocol('WM_DELETE_WINDOW', _destroyWindow)
#--------------------------------------------------------------
canvas = FigureCanvasTkAgg(fig, master=root)
canvas._tkcanvas.pack(side=tk.TOP, fill=tk.BOTH, expand=1)
#--------------------------------------------------------------
root.update()
root.deiconify()
root.mainloop()</pre></div><p>Running<a id="id177" class="indexterm"/> the modified code creates the following chart, which has a legend in the upper right corner:</p><div class="mediaobject"><img src="images/B04829_05_14.jpg" alt="How to do it..."/></div><p>We are only plotting one graph in this recipe and we do this by changing <code class="literal">fig.add_subplot(111)</code>. We also slightly modify the size of the figure via the <code class="literal">figsize</code> property.</p><p>Next, we <a id="id178" class="indexterm"/>create three Python lists that contain the values to be plotted. When we plot the data, we save the references to the plots in local variables.</p><p>We create the legend by passing in a tuple with the references to the three plots, another tuple that contains the strings that are then displayed in the legend, and in the third argument we position the legend within the chart.</p><p>The default settings of Matplotlib assign a color scheme to the lines being plotted.</p><p>We can easily change this default setting of colors to the colors we prefer by setting a property when we plot each axis.</p><p>We do this by using the color property and assigning it an available color value.</p><div class="informalexample"><pre class="programlisting">t0, = axis.plot(xValues, yValues0, color = 'purple')
t1, = axis.plot(xValues, yValues1, color = 'red')
t2, = axis.plot(xValues, yValues2, color = 'blue')</pre></div><p>Note how the comma after the variable assignments of t0, t1, and t2 is not a mistake but is required in order to create the legend.</p><p>The comma after each variable turns a list into a tuple. If we leave this out, our legend will not be displayed.</p><p>The code will still run, just without the intended legend.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note52"/>Note</h3><p>When we remove the comma after the t0 = assignment, we get an error and the first line no longer appears in the figure. The chart and legend still get created, but without the first line appearing in the legend.</p></div></div><div class="mediaobject"><img src="images/B04829_05_15.jpg" alt="How to do it..."/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec130"/>How it works...</h2></div></div></div><p>We <a id="id179" class="indexterm"/>enhanced our chart by plotting three lines of data in the same chart and giving it a legend in order to distinguish the data that those three lines plot.</p></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Scaling charts"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec51"/>Scaling charts</h1></div></div></div><p>In the <a id="id180" class="indexterm"/>previous recipes, while creating our first charts and enhancing them, we hard-coded the scaling of how those values are visually represented.</p><p>While this served us well for the values we were using, we often plot charts from very large databases.</p><p>Depending on the range of that data, our hard-coded values for the vertical y-dimension might not always be the best solution, which may make it hard to see the lines in our charts.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec131"/>Getting ready</h2></div></div></div><p>We will <a id="id181" class="indexterm"/>improve our code from the previous recipe. If you have not typed in all of the code from all of the previous recipes, just download the code for this chapter and it will get you started (and then you can have a lot of fun creating GUIs, charts, and so on, using Python).</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec132"/>How to do it...</h2></div></div></div><p>Modify the <code class="literal">yValues1</code> line of code from the previous recipe to use 50 as the third value.</p><div class="informalexample"><pre class="programlisting">axis  = fig.add_subplot(111)        # 1 row, 1 column

xValues  = [1,2,3,4]

yValues0 = [6,7.5,8,7.5]
yValues1 = [5.5,6.5,50,6]           # one very high value
yValues2 = [6.5,7,8,7]</pre></div><p>The only difference to the code that created the chart in the previous recipe is one data value.</p><p>By changing one value that is not close to the average range of all the other values for all plotted lines, the visual representation of data has dramatically changed and we lost a lot of details about the overall data and now mainly see one high spike.</p><div class="mediaobject"><img src="images/B04829_05_16.jpg" alt="How to do it..."/></div><p>So far, our <a id="id182" class="indexterm"/>charts have adjusted themselves according to the data they visually represent.</p><p>While this is a practical feature of Matplotlib, this is not always what we want. We can restrict the scale of the chart being represented by limiting the vertical y-dimension.</p><div class="informalexample"><pre class="programlisting">yValues0 = [6,7.5,8,7.5]
yValues1 = [5.5,6.5,50,6]           # one very high value (50)
yValues2 = [6.5,7,8,7]

axis.set_ylim(5, 8)                 # limit the vertical display</pre></div><p>The <code class="literal">axis.set_ylim(5, 8)</code> line of code now limits the beginning value to 5 and the ending value of the vertical display to 8.</p><p>Now, when we create our chart, the high value peak no longer has the impact it had before.</p><div class="mediaobject"><img src="images/B04829_05_17.jpg" alt="How to do it..."/></div></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec133"/>How it works...</h2></div></div></div><p>We increased<a id="id183" class="indexterm"/> one value in the data, which resulted in a dramatic effect. By setting limits to the vertical and horizontal displays of the chart, we can see the data we are most interested in.</p><p>Spikes such as the ones just shown, can be of great interest too. It all depends on what we are looking for. The visual representation of data is of great value.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note53"/>Note</h3><p>A picture is worth a thousand words.</p></div></div></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Adjusting the scale of charts dynamically"><div class="titlepage"><div><div><h1 class="title"><a id="ch05lvl1sec52"/>Adjusting the scale of charts dynamically</h1></div></div></div><p>In the<a id="id184" class="indexterm"/> previous recipe, we learned how we can limit the scaling of our charts. In this recipe, we will go one step further by dynamically adjusting the scaling by setting both a limit and analyzing our data before we represent it.</p><div class="section" title="Getting ready"><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec134"/>Getting ready</h2></div></div></div><p>We will enhance the code from the previous recipe by reading in the data we are plotting dynamically, averaging it, and then adjusting our chart.</p><p>While we <a id="id185" class="indexterm"/>would typically read in the data from an external source, in this recipe, we create the data we are plotting using Python lists, as can be seen in the following code.</p></div><div class="section" title="How to do it..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec135"/>How to do it...</h2></div></div></div><p>We are creating our own data in our Python module by assigning lists with data to the xvalues and yvalues variables.</p><p>In many graphs, the beginning of the x and y coordinate system starts at (0, 0). This is usually a good idea, so let's adjust our chart coordinate code accordingly.</p><p>Let's modify the code to set limits on both the x and y dimensions:</p><div class="informalexample"><pre class="programlisting">xValues  = [1,2,3,4]

yValues0 = [6,7.5,8,7.5]
yValues1 = [5.5,6.5,50,6]           # one very high value (50)
yValues2 = [6.5,7,8,7]              

axis.set_ylim(0, 8)                 # lower limit (0)
axis.set_xlim(0, 8)                 # use same limits for x</pre></div><p>Now that we have set the same limits for x and y, our chart might look more balanced. When we run the modified code, we get the following result:</p><div class="mediaobject"><img src="images/B04829_05_18.jpg" alt="How to do it..."/></div><p>Maybe starting at (0, 0) was not such a great idea after all…</p><p>What we really want to do is to adjust our chart dynamically according to the range of the data, while at the same time, restricting values that are too high or too low.</p><p>We can<a id="id186" class="indexterm"/> do this by parsing all the data to be represented in the chart while at the same time, setting some explicit limits.</p><p>Modify the code, as shown here:</p><div class="informalexample"><pre class="programlisting">xValues  = [1,2,3,4]

yValues0 = [6,7.5,8,7.5]
yValues1 = [5.5,6.5,50,6]              # one very high value (50)
yValues2 = [6.5,7,8,7]              
yAll = [yValues0, yValues1, yValues2]  # list of lists

# flatten list of lists retrieving minimum value
minY = min([y for yValues in yAll for y in yValues])

yUpperLimit = 20
# flatten list of lists retrieving max value within defined limit
maxY = max([y for yValues in yAll for y in yValues if y &lt; yUpperLimit])

# dynamic limits
axis.set_ylim(minY, maxY)                 
axis.set_xlim(min(xValues), max(xValues))                

t0, = axis.plot(xValues, yValues0)
t1, = axis.plot(xValues, yValues1)
t2, = axis.plot(xValues, yValues2)</pre></div><p>Running the code results in the following chart. We adjusted both its x and y dimensions dynamically. Note how the y-dimension now starts at 5.5 instead of 5.0, as it did before. The chart also no longer starts at (0, 0), giving us more valuable information about our data.</p><div class="mediaobject"><img src="images/B04829_05_19.jpg" alt="How to do it..."/></div><p>We are <a id="id187" class="indexterm"/>creating a list of lists for the y-dimension data and then using a list comprehension wrapped into a call to Python's <code class="literal">min()</code> and <code class="literal">max()</code> functions.</p><p>If list comprehensions seem to be a little bit advanced, what they basically are is a very compressed loop.</p><p>They are also designed to be faster than a regular programming loop.</p><p>In the Python code that creates the preceding chart, we created three lists that hold the y-dimensional data to be plotted. We then created another list that holds those three lists, which created a list of lists.</p><p>Like this:</p><div class="informalexample"><pre class="programlisting">yValues0 = [6,7.5,8,7.5]
yValues1 = [5.5,6.5,50,6]              # one very high value (50)
yValues2 = [6.5,7,8,7]              
yAll = [yValues0, yValues1, yValues2]  # list of lists</pre></div><p>We are interested in getting both the minimum value of all of the y-dimensional data, as well as the maximum value contained within these three lists.</p><p>We can do this via a Python list comprehension.</p><div class="informalexample"><pre class="programlisting"># flatten list of lists retrieving minimum value
minY = min([y for yValues in yAll for y in yValues])</pre></div><p>After running the list comprehension, <code class="literal">minY</code> is: 5.5.</p><p>The one line of code above is the list comprehension that runs through all the values of all the data contained within the three lists and finds the minimum value using the Python <code class="literal">min</code> keyword.</p><p>In the very<a id="id188" class="indexterm"/> same pattern, we find the maximum value contained in the data we wish to plot. This time, we also set a limit within our list comprehension that ignores all values that are above the limit we specified, like this:</p><div class="informalexample"><pre class="programlisting">yUpperLimit = 20
# flatten list of lists retrieving max value within defined limit
maxY = max([y for yValues in yAll for y in yValues if y &lt; yUpperLimit])</pre></div><p>After running the preceding code with our chosen restriction, <code class="literal">maxY</code> has the value of 8 (not 50).</p><p>We applied a restriction for the max value, according to a predefined condition choosing 20 as the maximum value to be displayed in the chart.</p><p>For the x-dimension, we simply called <code class="literal">min()</code> and <code class="literal">max()</code> in the Matplotlib method to scale the limits of the chart dynamically.</p></div><div class="section" title="How it works..."><div class="titlepage"><div><div><h2 class="title"><a id="ch05lvl2sec136"/>How it works...</h2></div></div></div><p>In this recipe, we created several Matplotlib charts and adjusted some of the many available properties. We also used core Python to control the scaling of the charts dynamically.</p></div></div></div>
</body></html>