<html><head></head><body>
  <div id="sbo-rt-content"><div class="chapter" title="Chapter 1. Getting Started with Selenium WebDriver and Python"><div class="titlepage"><div><div><h1 class="title"><a id="ch01"/>Chapter 1. Getting Started with Selenium WebDriver and Python</h1></div></div></div><p>Selenium automates browsers. It automates the interaction we do in a browser window such as navigating to a website, clicking on links, filling out forms, submitting forms, navigating through pages, and so on. It works on every major browser available out there.</p><p>In order to use Selenium WebDriver, we need a programing language to write automation scripts. The language that we select should also have a Selenium client library available.</p><p>In this book, we will use Python along with the Selenium WebDriver client library to create automated scripts. Python is a widely used general-purpose, high-level programming language. It's easy and its syntax allows us to express concepts in fewer lines of code. It emphasizes code readability and provides constructs that enable us to write programs on both the small and large scale. It also provides a number of in-built and user-written libraries to achieve complex tasks quite easily.</p><p>The Selenium WebDriver client library for Python provides access to all the Selenium WebDriver features and Selenium standalone server for remote and distributed testing of browser-based applications. Selenium Python language bindings are developed and maintained by David Burns, Adam Goucher, Maik Röder, Jason Huggins, Luke Semerau, Miki Tebeka, and Eric Allenin.</p><p>The Selenium WebDriver client library is supported on Python Version 2.6, 2.7, 3.2, and 3.3.</p><p>This chapter will introduce you to the Selenium WebDriver client library for Python by demonstrating its installation, basic features, and overall structure.</p><p>In this chapter, we will cover the following topics:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Installing Python and Selenium package</li><li class="listitem" style="list-style-type: disc">Selecting and setting up a Python editor</li><li class="listitem" style="list-style-type: disc">Implementing a sample script using the Selenium WebDriver Python client library</li><li class="listitem" style="list-style-type: disc">Implementing cross-browser support with Internet Explorer and Google Chrome</li></ul></div><div class="section" title="Preparing your machine"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec08"/>Preparing your machine</h1></div></div></div><p>As a first step of <a id="id0" class="indexterm"/>using Selenium with Python, we'll need to install it on our computer with the minimum requirements possible. Let's set up the basic environment with the steps explained in the following sections.</p><div class="section" title="Installing Python"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec07"/>Installing Python</h2></div></div></div><p>You will find <a id="id1" class="indexterm"/>Python installed by default on most Linux distributions, Mac <a id="id2" class="indexterm"/>OS X, and other Unix machines. On Windows, you will need to install it separately. Installers for different <a id="id3" class="indexterm"/>platforms can be found at <a class="ulink" href="http://python.org/download/">http://python.org/download/</a>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note02"/>Note</h3><p>All the examples in this book are written and tested on Python 2.7 and Python 3.0 on Windows 8 operating systems.</p></div></div></div><div class="section" title="Installing the Selenium package"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec08"/>Installing the Selenium package</h2></div></div></div><p>The Selenium <a id="id4" class="indexterm"/>WebDriver Python client library is available in the Selenium package. To install the Selenium package in a simple way, use the <code class="literal">pip</code> installer <a id="id5" class="indexterm"/>tool available at <a class="ulink" href="https://pip.pypa.io/en/latest/">https://pip.pypa.io/en/latest/</a>.</p><p>With <code class="literal">pip</code>, you can simply install or upgrade the Selenium package using the following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>pip install -U selenium</strong></span>
</pre></div><p>This is a <a id="id6" class="indexterm"/>fairly simple process. This command will set up the Selenium WebDriver client library on your machine with all modules and classes that we will need to create automated scripts using Python. The <code class="literal">pip</code> tool will download the latest version of the Selenium package and install it on your machine. The optional <code class="literal">–U</code> flag will upgrade the existing version of the installed package to the latest version.</p><p>You can also download the latest version of the Selenium package source from <a class="ulink" href="https://pypi.python.org/pypi/selenium">https://pypi.python.org/pypi/selenium</a>. Just click on the <span class="strong"><strong>Download</strong></span> button on the upper-right-hand side <a id="id7" class="indexterm"/>of the page, unarchive the downloaded file, and install it with following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>python setup.py install</strong></span>
</pre></div></div><div class="section" title="Browsing the Selenium WebDriver Python documentation"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec09"/>Browsing the Selenium WebDriver Python documentation</h2></div></div></div><p>The <a id="id8" class="indexterm"/>Selenium WebDriver Python <a id="id9" class="indexterm"/>client library documentation is available at <a class="ulink" href="http://selenium.googlecode.com/git/docs/api/py/api.html">http://selenium.googlecode.com/git/docs/api/py/api.html</a> as shown in the following <a id="id10" class="indexterm"/>screenshot:</p><div class="mediaobject"><img src="images/3506OS_01_01.jpg" alt="Browsing the Selenium WebDriver Python documentation"/></div><p>It offers detailed information on all core classes and functions of Selenium WebDriver. Also note the <a id="id11" class="indexterm"/>following links for Selenium documentation:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">The official documentation at <a class="ulink" href="http://docs.seleniumhq.org/docs/">http://docs.seleniumhq.org/docs/</a> offers documentation for all the Selenium components with examples in supported languages</li><li class="listitem" style="list-style-type: disc">Selenium <a id="id12" class="indexterm"/>Wiki at <a class="ulink" href="https://code.google.com/p/selenium/w/list">https://code.google.com/p/selenium/w/list</a> lists some useful <a id="id13" class="indexterm"/>topics that we will explore later in this book</li></ul></div></div><div class="section" title="Selecting an IDE"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec10"/>Selecting an IDE</h2></div></div></div><p>Now that we <a id="id14" class="indexterm"/>have Python and Selenium WebDriver set up, we will need an editor or an <span class="strong"><strong>Integrated Development Environment</strong></span> (<span class="strong"><strong>IDE</strong></span>) to write automation scripts. A good editor or IDE <a id="id15" class="indexterm"/>increases the productivity and helps in doing a lot of other things that make the coding experience simple and easy. While we can write Python code in simple editors such as Emacs, Vim, or Notepad, using an IDE will make life a lot easier. There are many IDEs to choose from. Generally, an IDE provides the following features to accelerate your development and coding time:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">A graphical code editor with code completion and IntelliSense</li><li class="listitem" style="list-style-type: disc">A code explorer for functions and classes</li><li class="listitem" style="list-style-type: disc">Syntax highlighting</li><li class="listitem" style="list-style-type: disc">Project management</li><li class="listitem" style="list-style-type: disc">Code templates</li><li class="listitem" style="list-style-type: disc">Tools for unit testing and debugging</li><li class="listitem" style="list-style-type: disc">Source control support</li></ul></div><p>If you're new to Python, or you're a tester working for the first time in Python, your development team will help you to set up the right IDE.</p><p>However, if you're starting with Python for the first time and don't know which IDE to select, here are a few choices that you might want to consider.</p><div class="section" title="PyCharm"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec01"/>PyCharm</h3></div></div></div><p>PyCharm is developed <a id="id16" class="indexterm"/>by JetBrains, a leading vendor of professional development tools and IDEs such as IntelliJ IDEA, RubyMine, PhpStorm, and TeamCity.</p><p>PyCharm is a <a id="id17" class="indexterm"/>polished, powerful, and versatile IDE that works pretty well. It brings best of the JetBrains experience in building powerful IDEs with lots of other features for a highly productive experience.</p><p>PyCharm <a id="id18" class="indexterm"/>is supported on Windows, Linux, and Mac. To know more about PyCharm and its features visit <a class="ulink" href="http://www.jetbrains.com/pycharm/">http://www.jetbrains.com/pycharm/</a>.</p><p>PyCharm comes in two versions—a community edition and a professional edition. The community edition is free, whereas you have to pay for the professional edition. Here is the PyCharm community edition running a sample Selenium script in the following screenshot:</p><div class="mediaobject"><img src="images/3506OS_01_02.jpg" alt="PyCharm"/></div><p>The community edition is <a id="id19" class="indexterm"/>great for building and running Selenium scripts with its fantastic debugging support. We will use PyCharm in the rest of this book. Later <a id="id20" class="indexterm"/>in this chapter, we will set up PyCharm and create our first Selenium script.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>All the examples in this book are built using PyCharm; however, you can easily use these examples in your choice of editor or IDE.</p></div></div></div><div class="section" title="The PyDev Eclipse plugin"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec02"/>The PyDev Eclipse plugin</h3></div></div></div><p>The PyDev Eclipse <a id="id21" class="indexterm"/>plugin is another widely used editor among <a id="id22" class="indexterm"/>Python developers. Eclipse is a famous open source IDE primarily built for Java; however, it also offers support to various other programming languages and tools through its powerful plugin architecture.</p><p>Eclipse is a cross-platform IDE supported on Windows, Linux, and Mac. You can get the latest edition of <a id="id23" class="indexterm"/>Eclipse at <a class="ulink" href="http://www.eclipse.org/downloads/">http://www.eclipse.org/downloads/</a>.</p><p>You need to install the PyDev plugin separately after setting up Eclipse. Use the tutorial from <span class="emphasis"><em>Lars Vogel</em></span> to <a id="id24" class="indexterm"/>install PyDev at <a class="ulink" href="http://www.vogella.com/tutorials/Python/article.html">http://www.vogella.com/tutorials/Python/article.html</a> to install PyDev. Installation instructions are also available at <a class="ulink" href="http://pydev.org/">http://pydev.org/</a>.</p><p>Here's the Eclipse PyDev plugin running a sample Selenium script as shown in the following screenshot:</p><div class="mediaobject"><img src="images/3506OS_01_03.jpg" alt="The PyDev Eclipse plugin"/></div></div><div class="section" title="PyScripter"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl3sec03"/>PyScripter</h3></div></div></div><p>For the Windows users, PyScripter can also be a great choice. It is open source, lightweight, and provides <a id="id25" class="indexterm"/>all the features that modern IDEs offer such as <a id="id26" class="indexterm"/>IntelliSense and code completion, testing, and debugging support. You can find more about PyScripter along with its download information at <a class="ulink" href="https://code.google.com/p/pyscripter/">https://code.google.com/p/pyscripter/</a>.</p><p>Here's PyScripter running a sample Selenium script as shown in the following screenshot:</p><div class="mediaobject"><img src="images/3506OS_01_04.jpg" alt="PyScripter"/></div></div></div><div class="section" title="Setting up PyCharm"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec11"/>Setting up PyCharm</h2></div></div></div><p>Now that we have <a id="id27" class="indexterm"/>seen IDE choices, let's set up PyCharm. All examples in this book are created with PyCharm. However, you can set up any other IDE of <a id="id28" class="indexterm"/>your choice and use examples as they are. We will set up PyCharm with following steps to get started with Selenium Python:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Download and <a id="id29" class="indexterm"/>install the PyCharm Community Edition from JetBrains site <a class="ulink" href="http://www.jetbrains.com/pycharm/download/index.html">http://www.jetbrains.com/pycharm/download/index.html</a>.</li><li class="listitem">Launch the <a id="id30" class="indexterm"/>PyCharm Community Edition. Click on the <span class="strong"><strong>Create New Project</strong></span> option on the <span class="strong"><strong>PyCharm Community Edition</strong></span> dialog box as shown in the following screenshot:<div class="mediaobject"><img src="images/3506OS_01_05.jpg" alt="Setting up PyCharm"/></div></li><li class="listitem">
On the <span class="strong"><strong>Create New Project</strong></span> dialog box, as shown in next screenshot, specify the name of your project in the <span class="strong"><strong>Project name</strong></span> field. In this example, <code class="literal">setests</code> is <a id="id31" class="indexterm"/>used as the project name. We need to configure the interpreter for the first time. Click on the <span class="inlinemediaobject"><img src="images/3506OS_01_14.jpg" alt="Setting up PyCharm"/></span> button to set up the interpreter, as shown in the following screenshot:
<div class="mediaobject"><img src="images/3506OS_01_06.jpg" alt="Setting up PyCharm"/></div></li><li class="listitem">On the <span class="strong"><strong>Python Interpreter</strong></span> dialog box, click on the plus icon. PyCharm will suggest the <a id="id32" class="indexterm"/>installed interpreter similar to the following screenshot. Select the interpreter from <span class="strong"><strong>Select Interpreter Path</strong></span>.<div class="mediaobject"><img src="images/3506OS_01_07.jpg" alt="Setting up PyCharm"/></div></li><li class="listitem">PyCharm <a id="id33" class="indexterm"/>will configure the selected interpreter as shown in the following screenshot. It will show a list of packages that are installed along with Python. Click on the <span class="strong"><strong>Apply</strong></span> button and then on the <span class="strong"><strong>OK</strong></span> button:<div class="mediaobject"><img src="images/3506OS_01_08.jpg" alt="Setting up PyCharm"/></div></li><li class="listitem">On the <span class="strong"><strong>Create </strong></span><a id="id34" class="indexterm"/><span class="strong"><strong>New Project</strong></span> dialog box, click on the <a id="id35" class="indexterm"/><span class="strong"><strong>OK</strong></span> button to create the project:<div class="mediaobject"><img src="images/3506OS_01_09.jpg" alt="Setting up PyCharm"/></div></li></ol></div></div></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Taking your first steps with Selenium and Python"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec09"/>Taking your first steps with Selenium and Python</h1></div></div></div><p>We are now <a id="id36" class="indexterm"/>ready to start with creating and running automated scripts in Python. Let's begin with Selenium WebDriver and create a Python script that uses Selenium WebDriver classes and functions to automate browser interaction.</p><p>We will use a sample web application for most of the examples in this book. This sample application is <a id="id37" class="indexterm"/>built on a famous e-commerce framework—<span class="strong"><strong>Magento</strong></span>. You can find the application at <a class="ulink" href="http://demo.magentocommerce.com/">http://demo.magentocommerce.com/</a>.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip02"/>Tip</h3><p>
<span class="strong"><strong>Downloading the example code</strong></span>
</p><p>You can download the example code files from your account at <a class="ulink" href="http://www.packtpub.com">http://www.packtpub.com</a> for all the Packt Publishing books you have purchased. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p><p>The example code is also hosted at <a class="ulink" href="https://github.com/upgundecha/learnsewithpython">https://github.com/upgundecha/learnsewithpython</a>.</p></div></div><p>In this sample script, we will navigate to the demo version of the application, search for products, and list the names of products from the search result page with the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Let's use the project that we created earlier while setting up PyCharm. Create a simple Python script that will use the Selenium WebDriver client library. In Project Explorer, right-click on <code class="literal">setests</code> and navigate to <span class="strong"><strong>New</strong></span> | <span class="strong"><strong>Python File</strong></span> from the pop-up menu:<div class="mediaobject"><img src="images/3506OS_01_10.jpg" alt="Taking your first steps with Selenium and Python"/></div></li><li class="listitem">On the <span class="strong"><strong>New Python file</strong></span> dialog box, enter <code class="literal">searchproducts</code> in the <span class="strong"><strong>Name</strong></span> field and click on the <span class="strong"><strong>OK</strong></span> button:<div class="mediaobject"><img src="images/3506OS_01_11.jpg" alt="Taking your first steps with Selenium and Python"/></div></li><li class="listitem">PyCharm will add a new tab <span class="strong"><strong>searchproducts.py</strong></span> in the code editor area. Copy the <a id="id38" class="indexterm"/>following code in the <span class="strong"><strong>searchproduct.py</strong></span> tab:<div class="informalexample"><pre class="programlisting">from selenium import webdriver

# create a new Firefox session
driver = webdriver.Firefox()
driver.implicitly_wait(30)
driver.maximize_window()

# navigate to the application home page
driver.get("http://demo.magentocommerce.com/")

# get the search textbox
search_field = driver.find_element_by_name("q")
search_field.clear()

# enter search keyword and submit
search_field.send_keys("phones")
search_field.submit()

# get all the anchor elements which have product names displayed
# currently on result page using find_elements_by_xpath method
products = driver.find_elements_by_xpath("//h2[@class='product-name']/a")

# get the number of anchor elements found
print "Found " + str(len(products)) + " products:"

# iterate through each anchor element and print the text that is # name of the product
for product in products:
    print product.text

# close the browser window
driver.quit()</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note04"/>Note</h3><p>If you're using any other IDE or editor of your choice, create a new file, copy the code to the new file, and save the file as <code class="literal">searchproducts.py</code>.</p></div></div></li><li class="listitem">To run the script, press the <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>F10</em></span> combination in the PyCharm code window or select <span class="strong"><strong>Run 'searchproducts'</strong></span> from the <span class="strong"><strong>Run</strong></span> menu. This will start the <a id="id39" class="indexterm"/>execution and you will see a new Firefox window navigating to the demo site and the Selenium commands getting executed in the Firefox window. If all goes well, at the end, the script will close the Firefox window. The script will print the list of products in the PyCharm console as shown in the following screenshot:<div class="mediaobject"><img src="images/3506OS_01_12.jpg" alt="Taking your first steps with Selenium and Python"/></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note05"/>Note</h3><p>We can also run this script through the command line with the following command. Open <a id="id40" class="indexterm"/>the command line, then open the <code class="literal">setests</code> directory, and run following command:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>python searchproducts.py</strong></span>
</pre></div><p>We will use command line as the preferred method in the rest of the book to execute the tests.</p></div></div></li></ol></div><p>We'll spend some time looking into the script that we created just now. We will go through each statement and understand Selenium WebDriver in brief. There is a lot to go through in the rest of the book.</p><p>The <code class="literal">selenium.webdriver</code> module implements the browser driver classes that are supported by Selenium, including Firefox, Chrome, Internet Explorer, Safari, and various other browsers, and <code class="literal">RemoteWebDriver</code> to test on browsers that are hosted on remote machines.</p><p>We need to import <code class="literal">webdriver</code> from the Selenium package to use the Selenium WebDriver methods:</p><div class="informalexample"><pre class="programlisting">from selenium import webdriver</pre></div><p>Next, we need an instance of a browser that we want to use. This will provide a programmatic interface to interact with the browser using the Selenium commands. In this example, we are using Firefox. We can create an instance of Firefox as shown in following code:</p><div class="informalexample"><pre class="programlisting">driver = webdriver.Firefox()</pre></div><p>During the run, this will launch a new Firefox window. We also set a few options on the driver:</p><div class="informalexample"><pre class="programlisting">driver.implicitly_wait(30)
driver.maximize_window()</pre></div><p>We configured a timeout for Selenium to execute steps using an implicit wait of 30 seconds for the driver and maximized the Firefox window through the Selenium API. We will learn more about implicit wait in <a class="link" href="ch05.html" title="Chapter 5. Synchronizing Tests">Chapter 5</a>, <span class="emphasis"><em>Synchronizing Tests</em></span>.</p><p>Next, we will navigate to the demo version of the application using its URL by calling the <code class="literal">driver.get()</code> method. After the <code class="literal">get()</code> method is called, WebDriver <a id="id41" class="indexterm"/>waits until the page is fully loaded in the Firefox window and returns the control to the script.</p><p>After loading the page, Selenium will interact with various elements on the page, like a human user. For example, on the Home page of the application, we need to enter a search term in a textbox and click on the <span class="strong"><strong>Search</strong></span> button. These elements are implemented as HTML input elements and Selenium needs to find these elements to simulate the user action. Selenium WebDriver provides a number of methods to find these elements and interact with them to perform operations such as sending values, clicking buttons, selecting items in dropdowns, and so on. We will see more about this in <a class="link" href="ch03.html" title="Chapter 3. Finding Elements">Chapter 3</a>, <span class="emphasis"><em>Finding Elements</em></span>.</p><p>In this example, we are finding the <span class="strong"><strong>Search</strong></span> textbox using the <code class="literal">find_element_by_name</code> method. This will return the first element matching the name attribute specified in the <code class="literal">find</code> method. The HTML elements are defined with tag and attributes. We can use this information to find an element, by following the given steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">In this example, the <span class="strong"><strong>Search</strong></span> textbox has the name attribute defined as <code class="literal">q</code> and we can use this attribute as shown in the following code example:<div class="informalexample"><pre class="programlisting">search_field = driver.find_element_by_name("q")</pre></div></li><li class="listitem">Once the <span class="strong"><strong>Search</strong></span> textbox is found, we will interact with this element by clearing the previous value (if entered) using the <code class="literal">clear()</code> method and enter the specified new value using the <code class="literal">send_keys()</code> method. Next, we will submit the search request by calling the <code class="literal">submit()</code> method:<div class="informalexample"><pre class="programlisting">search_field.clear()
search_field.send_keys("phones")
search_field.submit()</pre></div></li><li class="listitem">After submission of the search request, Firefox will load the result page returned by the application. The result page has a list of products that match the search term, <a id="id42" class="indexterm"/>which is <code class="literal">phones</code>. We can read the list of results and specifically the names of all the products that are rendered in the anchor <code class="literal">&lt;a&gt;</code> element using the <code class="literal">find_elements_by_xpath()</code> method. This will return more than one matching element as a list:<div class="informalexample"><pre class="programlisting">products = driver.find_elements_by_xpath("//h2[@class='product-name']/a")</pre></div></li><li class="listitem">Next, we will print the number of products (that is the number of anchor <code class="literal">&lt;a&gt;</code> elements) that are found on the page and the names of the products using the <code class="literal">.text</code> property of all the anchor <code class="literal">&lt;a&gt;</code> elements:<div class="informalexample"><pre class="programlisting">print "Found " + str(len(products)) + " products:"

for product in products:
    print product.text</pre></div></li><li class="listitem">At end of the script, we will close the Firefox browser using the <code class="literal">driver.quit()</code> method:<div class="informalexample"><pre class="programlisting">driver.quit()</pre></div></li></ol></div><p>This example script gives us a concise example of using Selenium WebDriver and Python together to create a simple automation script. We are not testing anything in this script yet. Later in the <a id="id43" class="indexterm"/>book, we will extend this simple script into a set of tests and use various other libraries and features of Python.</p></div></div>


  <div id="sbo-rt-content"><div class="section" title="Cross-browser support"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec10"/>Cross-browser support</h1></div></div></div><p>So far we have <a id="id44" class="indexterm"/>built and run our script with Firefox. Selenium has extensive support for cross-browser testing where you can automate on all the major browsers including Internet Explorer, Google Chrome, Safari, Opera, and headless browsers such as PhantomJS. In this section, we will set up and run the script that we created in the previous section with Internet Explorer and Google Chrome to see the cross-browser capabilities of Selenium WebDriver.</p><div class="section" title="Setting up Internet Explorer"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec12"/>Setting up Internet Explorer</h2></div></div></div><p>There is a <a id="id45" class="indexterm"/>little more to run scripts on <a id="id46" class="indexterm"/>Internet Explorer. To run tests on Internet Explorer, we need to download and set up the <code class="literal">InternetExplorerDriver</code> server. The <code class="literal">InternetExplorerDriver</code> server is a standalone server executable that implements WebDriver's wire protocol to work as glue between the test script and Internet Explorer. It supports major IE versions on Windows XP, Vista, Windows 7, and Windows 8 operating systems. Let's set up the <code class="literal">InternetExplorerDriver</code> server with the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Download <a id="id47" class="indexterm"/>the <code class="literal">InternetExplorerDriver</code> server from <a class="ulink" href="http://www.seleniumhq.org/download/">http://www.seleniumhq.org/download/</a>. You can download 32- or 64-bit versions based on the system configuration that you are using.</li><li class="listitem">After downloading the <code class="literal">InternetExplorerDriver</code> server, unzip and copy the file to the same directory where scripts are stored.</li><li class="listitem">On IE 7 or higher, the <span class="strong"><strong>Protected Mode</strong></span> settings for each zone must have the same value. <span class="strong"><strong>Protected Mode</strong></span> can either be on or off, as long as it is for all the zones. To set the <span class="strong"><strong>Protected Mode</strong></span> settings:<div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Choose <span class="strong"><strong>Internet Options</strong></span> from the <span class="strong"><strong>Tools</strong></span> menu.</li><li class="listitem">On the <span class="strong"><strong>Internet Options</strong></span> dialog box, click on the <span class="strong"><strong>Security</strong></span> tab.</li><li class="listitem">Select each zone listed in <span class="strong"><strong>Select a zone to view or change security settings</strong></span> and make sure <span class="strong"><strong>Enable Protected Mode (requires restarting Internet Explorer)</strong></span> is either checked or unchecked for all the zones. All the zones should have the same settings as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="images/3506OS_01_13.jpg" alt="Setting up Internet Explorer"/></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note07"/>Note</h3><p>While using the <code class="literal">InternetExplorerDriver</code> server, it is also important to keep the browser zoom level set to 100 percent so that the native mouse events can be set to the correct coordinates.</p></div></div></li><li class="listitem">Finally, modify <a id="id48" class="indexterm"/>the script to <a id="id49" class="indexterm"/>use Internet Explorer. Instead of creating an instance of the Firefox class, we will use the <code class="literal">IE</code> class in the following way:<div class="informalexample"><pre class="programlisting">import os
from selenium import webdriver

# get the path of IEDriverServer
dir = os.path.dirname(__file__)
ie_driver_path = dir + "\IEDriverServer.exe"

# create a new Internet Explorer session
driver = webdriver.Ie(ie_driver_path)
driver.implicitly_wait(30)
driver.maximize_window()

# navigate to the application home page
driver.get("http://demo.magentocommerce.com/")

# get the search textbox
search_field = driver.find_element_by_name("q")
search_field.clear()

# enter search keyword and submit
search_field.send_keys("phones")
search_field.submit()

# get all the anchor elements which have product names displayed
# currently on result page using find_elements_by_xpath method
products = driver.find_elements_by_xpath("//h2[@class='product-name']/a")

# get the number of anchor elements found
print "Found " + str(len(products)) + " products:"

# iterate through each anchor element and print the text that is # name of the product
for product in products:
    print product.text

# close the browser window
driver.quit()</pre></div><p>In this script, we passed the path of the <code class="literal">InternetExplorerDriver</code> server while creating the instance of an <code class="literal">IE</code> browser class.</p></li><li class="listitem">Run the script and <a id="id50" class="indexterm"/>Selenium will first launch the <code class="literal">InternetExplorerDriver</code> server, which launches the browser, and execute the steps.<p>The <code class="literal">InternetExplorerDriver</code> server acts as an intermediary between the Selenium <a id="id51" class="indexterm"/>script and the browser. Execution of the actual steps is very similar to what we observed with Firefox.</p></li></ol></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip03"/>Tip</h3><p>Read more about <a id="id52" class="indexterm"/>the important configuration options for Internet Explorer at <a class="ulink" href="https://code.google.com/p/selenium/wiki/InternetExplorerDriver">https://code.google.com/p/selenium/wiki/InternetExplorerDriver</a> and the <span class="emphasis"><em>DesiredCapabilities</em></span> article at <a class="ulink" href="https://code.google.com/p/selenium/wiki/DesiredCapabilities">https://code.google.com/p/selenium/wiki/DesiredCapabilities</a>.</p></div></div></div><div class="section" title="Setting up Google Chrome"><div class="titlepage"><div><div><h2 class="title"><a id="ch01lvl2sec13"/>Setting up Google Chrome</h2></div></div></div><p>Setting up and <a id="id53" class="indexterm"/>running Selenium scripts on Google Chrome is similar to Internet Explorer. We need to download the <code class="literal">ChromeDriver</code> server similar to <code class="literal">InternetExplorerDriver</code>. The <code class="literal">ChromeDriver</code> server is a standalone <a id="id54" class="indexterm"/>server developed and maintained by the Chromium team. It implements WebDriver's wire protocol for automating Google Chrome. It is supported on Windows, Linux, and Mac operating systems. Set up the <code class="literal">ChromeDriver</code> server using the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">Download the <a id="id55" class="indexterm"/><code class="literal">ChromeDriver</code> server from <a class="ulink" href="http://chromedriver.storage.googleapis.com/index.html">http://chromedriver.storage.googleapis.com/index.html</a>.</li><li class="listitem">After downloading the <code class="literal">ChromeDriver</code> server, unzip and copy the file to the same directory where the scripts are stored.</li><li class="listitem">Finally, modify the sample script to use Chrome. Instead of creating an instance of the Firefox class, we will use the <code class="literal">Chrome</code> class in the following way:<div class="informalexample"><pre class="programlisting">import os
from selenium import webdriver

# get the path of chromedriver
dir = os.path.dirname(__file__)
chrome_driver_path = dir + "\chromedriver.exe" #remove the .exe extension on linux or mac platform

# create a new Chrome session
driver = webdriver.Chrome(chrome_driver_path)
driver.implicitly_wait(30)
driver.maximize_window()

# navigate to the application home page
driver.get("http://demo.magentocommerce.com/")

# get the search textbox
search_field = driver.find_element_by_name("q")
search_field.clear()

# enter search keyword and submit
search_field.send_keys("phones")
search_field.submit()

# get all the anchor elements which have product names displayed
# currently on result page using find_elements_by_xpath method
products = driver.find_elements_by_xpath("//h2[@class='product-name']/a")

# get the number of anchor elements found
print "Found " + str(len(products)) + " products:"

# iterate through each anchor element and print the text that is # name of the product
for product in products:
    print product.text

# close the browser window
driver.quit()</pre></div><p>In this script, we passed the path of the <code class="literal">ChromeDriver</code> server while creating an instance of the Chrome browser class.</p></li><li class="listitem">Run the script. Selenium will first launch the <code class="literal">Chromedriver</code> server, which launches <a id="id56" class="indexterm"/>the Chrome <a id="id57" class="indexterm"/>browser, and execute the steps. Execution of the <a id="id58" class="indexterm"/>actual steps is <a id="id59" class="indexterm"/>very similar to what we observed with Firefox.</li></ol></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip04"/>Tip</h3><p>Read more <a id="id60" class="indexterm"/>about ChromeDriver at <a class="ulink" href="https://code.google.com/p/selenium/wiki/ChromeDriver">https://code.google.com/p/selenium/wiki/ChromeDriver</a> and <a class="ulink" href="https://sites.google.com/a/chromium.org/chromedriver/home">https://sites.google.com/a/chromium.org/chromedriver/home</a>.</p></div></div></div></div></div>


  <div id="sbo-rt-content"><div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch01lvl1sec11"/>Summary</h1></div></div></div><p>In this chapter, we introduced you to Selenium and its components. We installed the <code class="literal">selenium</code> package using the <code class="literal">pip</code> tool. Then we looked at various Editors and IDEs to ease our coding experience with Selenium and Python and set up PyCharm. Then we built a simple script on a sample application covering some of the high-level concepts of Selenium WebDriver Python client library using Firefox. We ran the script and analyzed the outcome. Finally, we explored the cross-browser testing support of Selenium WebDriver by configuring and running the script with Internet Explorer and Google Chrome.</p><p>In next chapter, we will learn how to use the <code class="literal">unittest</code> library to create automated tests using Selenium WebDriver. We will also learn how to create a suite of tests and run tests in groups.</p></div></div>
</body></html>