<html><head></head><body>
<div id="_idContainer063">
<h1 class="chapter-number" id="_idParaDest-113"><a id="_idTextAnchor114"/><span class="koboSpan" id="kobo.1.1">7</span></h1>
<h1 id="_idParaDest-114"><a id="_idTextAnchor115"/><span class="koboSpan" id="kobo.2.1">Technical Analysis and Its Implementation in Python</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In the previous chapter, we considered fundamental factors and saw how they may impact market prices. </span><span class="koboSpan" id="kobo.3.2">We noted that, although such an impact may be significant and potentially quite lucrative for trading, most of the time, it’s difficult to suggest a quantitative model that could generate unambiguous trading rules (when to enter the market, to which direction, and when to exit it) that wouldn’t require human discretion. </span><span class="koboSpan" id="kobo.3.3">For clarity’s sake, let’s note that there exist various fully quantitative approaches to evaluating fundamental factors, even political ones, but they are based on complex cross-discipline subjects, such as semantic analysis, and thus require solid knowledge of respective sciences. </span><span class="koboSpan" id="kobo.3.4">Is it possible to avoid this complexity and find a method to analyze market behavior using only price data? </span><span class="koboSpan" id="kobo.3.5">Or, maybe, some additional data, but only in </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">numeric form?</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">The answer is yes, and this kind of market analysis is called </span><strong class="bold"><span class="koboSpan" id="kobo.6.1">technical analysis</span></strong><span class="koboSpan" id="kobo.7.1">. </span><span class="koboSpan" id="kobo.7.2">In this chapter, we will consider its premises, learn about the most common technical indicators, and discover how they may be used to quantitatively describe various processes that go on in the market. </span><span class="koboSpan" id="kobo.7.3">We will also consider the implementations of key technical indicators in Python and introduce the concept of the sliding window, which will be used throughout all </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">future codes.</span></span></p>
<p><span class="koboSpan" id="kobo.9.1">In this chapter, you will learn about the </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.11.1">Technical analysis – ideal for computing, but missing real </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">market processes</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">Momentum and RSI as indicators to measure the velocity of </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">the market</span></span></li>
<li><span class="koboSpan" id="kobo.15.1">Digital filters and </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">moving averages</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.17.1">Range indicators</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.18.1">Volatility indicators</span></span></li>
<li><span class="koboSpan" id="kobo.19.1">Implementation of technical indicators </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">in Python</span></span></li>
</ul>
<h1 id="_idParaDest-115"><a id="_idTextAnchor116"/><span class="koboSpan" id="kobo.21.1">Technical analysis – ideal for computing, but missing real market processes</span></h1>
<p><span class="koboSpan" id="kobo.22.1">The main idea that</span><a id="_idIndexMarker372"/><span class="koboSpan" id="kobo.23.1"> lies in the foundation of </span><strong class="bold"><span class="koboSpan" id="kobo.24.1">technical analysis</span></strong><span class="koboSpan" id="kobo.25.1">, or </span><strong class="bold"><span class="koboSpan" id="kobo.26.1">TA</span></strong><span class="koboSpan" id="kobo.27.1"> for short, is that </span><em class="italic"><span class="koboSpan" id="kobo.28.1">price includes everything in itself</span></em><span class="koboSpan" id="kobo.29.1">. </span><span class="koboSpan" id="kobo.29.2">From this standpoint, if we see a price movement up or down, large or small, we don’t really want to know the reason behind this movement; instead, we just acknowledge that it was caused by some fundamental factors and try to focus on the future price development in regard to the observed price </span><span class="No-Break"><span class="koboSpan" id="kobo.30.1">movement only.</span></span></p>
<p><span class="koboSpan" id="kobo.31.1">Of course, TA can analyze a </span><em class="italic"><span class="koboSpan" id="kobo.32.1">series</span></em><span class="koboSpan" id="kobo.33.1"> of data and not just a single data point. </span><span class="koboSpan" id="kobo.33.2">In this regard, TA studies help in identifying </span><em class="italic"><span class="koboSpan" id="kobo.34.1">patterns</span></em><span class="koboSpan" id="kobo.35.1"> or repeating sequences in price time series that bear resemblance to each other. </span><span class="koboSpan" id="kobo.35.2">TA suggests that if we observe a pattern that we already saw in the past, then the following price development will also be similar to what happened in the past; therefore, we can be prepared and </span><span class="No-Break"><span class="koboSpan" id="kobo.36.1">exploit it.</span></span></p>
<p><span class="koboSpan" id="kobo.37.1">With TA, we don’t want and don’t need to know the actual fundamental factors that affected the price, we are only looking for </span><em class="italic"><span class="koboSpan" id="kobo.38.1">footprints</span></em><span class="koboSpan" id="kobo.39.1"> of something that happened behind the scenes and will then take action depending on the form of </span><span class="No-Break"><span class="koboSpan" id="kobo.40.1">these footprints.</span></span></p>
<p><span class="koboSpan" id="kobo.41.1">Now that we understand the difference in the foundations of fundamental and technical analyses, let’s see how this difference impacts the two main practical points of any market analysis: its time horizon </span><span class="No-Break"><span class="koboSpan" id="kobo.42.1">and precision.</span></span></p>
<p><span class="koboSpan" id="kobo.43.1">Fundamental analysis focuses on macroeconomic factors, which are always longer term by nature, so the time horizon for fundamental forecasts is normally days and above, up to years. </span><span class="koboSpan" id="kobo.43.2">On the contrary, technical studies may analyze extremely short-living processes (for example, momentary imbalances in the order book), and therefore, it’s normal that technical studies may have a forecast horizon of 1 second, 1 millisecond, and sometimes even a </span><span class="No-Break"><span class="koboSpan" id="kobo.44.1">few microseconds.</span></span></p>
<p><span class="koboSpan" id="kobo.45.1">The main differences between fundamental and technical analyses are summarized in the </span><span class="No-Break"><span class="koboSpan" id="kobo.46.1">following table:</span></span></p>
<table class="T---Table" id="table001-1">
<colgroup>
<col/>
<col/>
<col/>
</colgroup>
<tbody>
<tr class="T---Table">
<td class="T---Table T---Body T---Body"/>
<td class="T---Table T---Body T---Body">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.47.1">Fundamental analysis</span></strong></span></p>
</td>
<td class="T---Table T---Body T---Body">
<p><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.48.1">Technical analysis</span></strong></span></p>
</td>
</tr>
<tr class="T---Table">
<td class="T---Table T---Body T---Body">
<p><span class="No-Break"><span class="koboSpan" id="kobo.49.1">Key focus</span></span></p>
</td>
<td class="T---Table T---Body T---Body">
<p><span class="koboSpan" id="kobo.50.1">Macroeconomics, politics, industry news, and the sentiment </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">of investors</span></span></p>
</td>
<td class="T---Table T---Body T---Body">
<p><span class="koboSpan" id="kobo.52.1">Price, volume, open interest, spreads, liquidity, and other </span><span class="No-Break"><span class="koboSpan" id="kobo.53.1">quantitative parameters</span></span></p>
</td>
</tr>
<tr class="T---Table">
<td class="T---Table T---Body T---Body">
<p><span class="No-Break"><span class="koboSpan" id="kobo.54.1">Forecast horizon</span></span></p>
</td>
<td class="T---Table T---Body T---Body">
<p><span class="koboSpan" id="kobo.55.1">Days </span><span class="No-Break"><span class="koboSpan" id="kobo.56.1">to years</span></span></p>
</td>
<td class="T---Table T---Body T---Body">
<p><span class="koboSpan" id="kobo.57.1">Microseconds to days, and rarely, weeks </span><span class="No-Break"><span class="koboSpan" id="kobo.58.1">and months</span></span></p>
</td>
</tr>
<tr class="T---Table">
<td class="T---Table T---Body T---Body">
<p><span class="No-Break"><span class="koboSpan" id="kobo.59.1">Forecast precision</span></span></p>
</td>
<td class="T---Table T---Body T---Body">
<p><span class="No-Break"><span class="koboSpan" id="kobo.60.1">Very volatile</span></span></p>
</td>
<td class="T---Table T---Body T---Body">
<p><span class="koboSpan" id="kobo.61.1">Depends on </span><span class="No-Break"><span class="koboSpan" id="kobo.62.1">the timeframe</span></span></p>
</td>
</tr>
</tbody>
</table>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.63.1">Table 7.1 – Key differences between fundamental and technical analyses</span></p>
<p><span class="koboSpan" id="kobo.64.1">The building </span><a id="_idIndexMarker373"/><span class="koboSpan" id="kobo.65.1">block </span><a id="_idIndexMarker374"/><span class="koboSpan" id="kobo.66.1">of any TA study is</span><a id="_idIndexMarker375"/><span class="koboSpan" id="kobo.67.1"> an </span><strong class="bold"><span class="koboSpan" id="kobo.68.1">indicator</span></strong><span class="koboSpan" id="kobo.69.1">. </span><span class="koboSpan" id="kobo.69.2">It is a combination of price, time, volume, and/or any other market data that can be </span><span class="No-Break"><span class="koboSpan" id="kobo.70.1">quantitatively measured.</span></span></p>
<p><span class="koboSpan" id="kobo.71.1">Indicators are usually </span><a id="_idIndexMarker376"/><span class="koboSpan" id="kobo.72.1">plotted as lines, dots, histograms, and other graphical objects </span><em class="italic"><span class="koboSpan" id="kobo.73.1">on</span></em><span class="koboSpan" id="kobo.74.1"> a price chart, </span><em class="italic"><span class="koboSpan" id="kobo.75.1">below</span></em><span class="koboSpan" id="kobo.76.1"> a price chart, or both. </span><span class="koboSpan" id="kobo.76.2">Normally, technical analysts use two to five indicators, each of them showing a particular feature of the examined price time series. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.77.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.78.1">.1</span></em><span class="koboSpan" id="kobo.79.1"> shows a typical example of such a combination of TA indicators in a </span><span class="No-Break"><span class="koboSpan" id="kobo.80.1">single chart:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer036">
<span class="koboSpan" id="kobo.81.1"><img alt="Figure 7.1 – Typical layout of TA indicators with a price chart" src="image/B19145_7_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.82.1">Figure 7.1 – Typical layout of TA indicators with a price chart</span></p>
<p><span class="koboSpan" id="kobo.83.1">Excessive</span><a id="_idIndexMarker377"/><span class="koboSpan" id="kobo.84.1"> use of TA indicators may lead to a mess when it’s really hard to understand what each of them shows and what the author of this mess really wanted to achieve. </span><span class="koboSpan" id="kobo.84.2">You probably can’t believe it, but the example in the following figure is not my fantasy, but something similar to what I saw with my own eyes so many times on various </span><span class="No-Break"><span class="koboSpan" id="kobo.85.1">trading forums!</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer037">
<span class="koboSpan" id="kobo.86.1"><img alt="Figure 7.2 – How the excessive use of TA indicators may lead to ﻿abuse" src="image/B19145_7_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.87.1">Figure 7.2 – How the excessive use of TA indicators may lead to abuse</span></p>
<p><span class="koboSpan" id="kobo.88.1">There is one thing common</span><a id="_idIndexMarker378"/><span class="koboSpan" id="kobo.89.1"> for all TA indicators – their values are always synchronized with the original price time series on which they </span><span class="No-Break"><span class="koboSpan" id="kobo.90.1">are based.</span></span></p>
<p><span class="koboSpan" id="kobo.91.1">This means that if we build an indicator based on a 1-minute chart, then the values of this indicator will be updated every minute; for an hourly chart, the values will be updated every hour, and </span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">so on.</span></span></p>
<p><span class="koboSpan" id="kobo.93.1">As you can see, if we use a tick chart as the source data to calculate the values of a TA indicator, then these values will be updated on every tick. </span><span class="koboSpan" id="kobo.93.2">When we work with live data feeds, TA indicators show fixed, unchanged values for all historical bars (well, we can’t change history, can we?), but update the latest reading with every new tick that comes in for a bar that is not </span><span class="No-Break"><span class="koboSpan" id="kobo.94.1">completed yet.</span></span></p>
<p><span class="koboSpan" id="kobo.95.1">Regardless of their </span><a id="_idIndexMarker379"/><span class="koboSpan" id="kobo.96.1">complexity, almost all TA indicators can be classified into four major groups: velocity of the market, digital filters, range indicators, and volatility indicators. </span><span class="koboSpan" id="kobo.96.2">Let’s consider each </span><span class="No-Break"><span class="koboSpan" id="kobo.97.1">of them.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.98.1">An important note before we proceed</span></p>
<p class="callout"><span class="koboSpan" id="kobo.99.1">In all the following discussions about technical indicators, we will use the term </span><strong class="bold"><span class="koboSpan" id="kobo.100.1">current bar</span></strong><span class="koboSpan" id="kobo.101.1">. </span><span class="koboSpan" id="kobo.101.2">This</span><a id="_idIndexMarker380"/><span class="koboSpan" id="kobo.102.1"> doesn’t mean that we are talking only about the last (rightmost) bar on the chart. </span><span class="koboSpan" id="kobo.102.2">This means that when we plot charts, indicators, backtest strategies, and so on, we always move (imaginarily) from left to right, from historically older data to historically present, and we calculate anything </span><em class="italic"><span class="koboSpan" id="kobo.103.1">on every bar that we encounter</span></em><span class="koboSpan" id="kobo.104.1">. </span><span class="koboSpan" id="kobo.104.2">This bar, for which we are calculating any values </span><em class="italic"><span class="koboSpan" id="kobo.105.1">at the moment</span></em><span class="koboSpan" id="kobo.106.1">, is referred to as the </span><strong class="bold"><span class="koboSpan" id="kobo.107.1">current bar</span></strong><span class="koboSpan" id="kobo.108.1">. </span><span class="koboSpan" id="kobo.108.2">We use this term because when we go live with our developments, the current bar will actually mean the price data that we receive </span><em class="italic"><span class="koboSpan" id="kobo.109.1">at this very moment</span></em><span class="koboSpan" id="kobo.110.1">, so we don’t have to modify anything in our study or </span><span class="No-Break"><span class="koboSpan" id="kobo.111.1">strategy code.</span></span></p>
<p><span class="koboSpan" id="kobo.112.1">With this important note in mind, let’s </span><span class="No-Break"><span class="koboSpan" id="kobo.113.1">go ahead.</span></span></p>
<h2 id="_idParaDest-116"><a id="_idTextAnchor117"/><span class="koboSpan" id="kobo.114.1">Velocity of the market</span></h2>
<p><span class="koboSpan" id="kobo.115.1">These </span><a id="_idIndexMarker381"/><span class="koboSpan" id="kobo.116.1">indicators </span><a id="_idIndexMarker382"/><span class="koboSpan" id="kobo.117.1">try to answer the question, </span><em class="italic"><span class="koboSpan" id="kobo.118.1">How fast is the price moving?</span></em><span class="koboSpan" id="kobo.119.1">. </span><span class="koboSpan" id="kobo.119.2">Indeed, if we compare a normal average day in the FX market with a release of important economic news or a political event, then we clearly see the difference. </span><span class="koboSpan" id="kobo.119.3">And of course, it would be nice to assess this difference quantitatively. </span><span class="koboSpan" id="kobo.119.4">We will consider only the two most well-known indicators of this kind – momentum and RSI – but any more sophisticated market speed indicator will be inevitably built on the </span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">same principles.</span></span></p>
<h3><span class="koboSpan" id="kobo.121.1">Momentum</span></h3>
<p><span class="koboSpan" id="kobo.122.1">This is </span><a id="_idIndexMarker383"/><span class="koboSpan" id="kobo.123.1">probably</span><a id="_idIndexMarker384"/><span class="koboSpan" id="kobo.124.1"> the oldest technical indicator and definitely the simplest. </span><span class="koboSpan" id="kobo.124.2">It is really hard to imagine a </span><span class="No-Break"><span class="koboSpan" id="kobo.125.1">simpler formula:</span></span></p>
<p><span class="koboSpan" id="kobo.126.1"><img alt="" src="image/Formula_B19145_07_001.png"/></span></p>
<p><span class="koboSpan" id="kobo.127.1">Here, </span><em class="italic"><span class="koboSpan" id="kobo.128.1">C</span></em><span class="subscript"><span class="koboSpan" id="kobo.129.1">0</span></span><span class="koboSpan" id="kobo.130.1"> means the current closing price and </span><em class="italic"><span class="koboSpan" id="kobo.131.1">C</span></em><span class="subscript"><span class="koboSpan" id="kobo.132.1">-1</span></span><span class="koboSpan" id="kobo.133.1"> means the closing price of the </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">previous bar.</span></span></p>
<p><span class="koboSpan" id="kobo.135.1">If we </span><a id="_idIndexMarker385"/><span class="koboSpan" id="kobo.136.1">calculate these differences for every bar, store</span><a id="_idIndexMarker386"/><span class="koboSpan" id="kobo.137.1"> them in an array, and plot the indicator below the chart, we will see that its values no longer follow the price movements and, overall, it looks more like noise rather than a clear trending price pattern. </span><span class="koboSpan" id="kobo.137.2">However, this noise is quite informative. </span><span class="koboSpan" id="kobo.137.3">Even from a quick glance at the chart in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.138.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.139.1">.3</span></em><span class="koboSpan" id="kobo.140.1">, we can conclude a number of </span><span class="No-Break"><span class="koboSpan" id="kobo.141.1">important points:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer039">
<span class="koboSpan" id="kobo.142.1"><img alt="Figure 7.3 – Basic momentum plotted below a price chart" src="image/B19145_7_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.143.1">Figure 7.3 – Basic momentum plotted below a price chart</span></p>
<p><span class="koboSpan" id="kobo.144.1">First, we can see that the readings of momentum seldom remain in the positive or negative zone for more than two or three data points in a row. </span><span class="koboSpan" id="kobo.144.2">Since the momentum’s value is the difference between the current and the previous closing prices of just two adjacent bars, we can</span><a id="_idIndexMarker387"/><span class="koboSpan" id="kobo.145.1"> say that it’s not usual for this market that the price grew or declined steadily for more than three bars in a row. </span><span class="koboSpan" id="kobo.145.2">In other words, if we see more than two bars closing up, we may expect a bar to close down rather than another bar closing up. </span><span class="koboSpan" id="kobo.145.3">Technical analysts call these bars </span><strong class="bold"><span class="koboSpan" id="kobo.146.1">corrections</span></strong><span class="koboSpan" id="kobo.147.1">; they </span><a id="_idIndexMarker388"/><span class="koboSpan" id="kobo.148.1">may even appear inside quite long and steady trends, as in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.149.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.150.1">.3</span></em><span class="koboSpan" id="kobo.151.1">, but they do not break the trend. </span><span class="koboSpan" id="kobo.151.2">So, overall, we can say that this market is really prone </span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">to corrections.</span></span></p>
<p><span class="koboSpan" id="kobo.153.1">Second, if we</span><a id="_idIndexMarker389"/><span class="koboSpan" id="kobo.154.1"> estimate the amplitude of the momentum indicator, we can see that it is different during different market regimes. </span><span class="koboSpan" id="kobo.154.2">While the market remained more or less </span><em class="italic"><span class="koboSpan" id="kobo.155.1">flat</span></em><span class="koboSpan" id="kobo.156.1"> (at the beginning of the chart), the amplitude of the momentum hardly exceeded 0.002 points, but as the uptrend was developing, its values increased to 0.004 by absolute value – that is, two times the </span><em class="italic"><span class="koboSpan" id="kobo.157.1">idle</span></em><span class="koboSpan" id="kobo.158.1"> market. </span><span class="koboSpan" id="kobo.158.2">So, we can assume that the </span><em class="italic"><span class="koboSpan" id="kobo.159.1">market speed</span></em><span class="koboSpan" id="kobo.160.1"> has some correlation with the market regime and could potentially use it in our </span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">own studies.</span></span></p>
<p><span class="koboSpan" id="kobo.162.1">Normally, the momentum indicator has one parameter – the number of bars between which we calculate the difference. </span><span class="koboSpan" id="kobo.162.2">In the classical formula at the beginning of this section, we compared the closing prices of two adjacent bars; of course, we can compare the price of the current bar with that of any bar in the past. </span><span class="koboSpan" id="kobo.162.3">If we continue doing that for every bar, we will get to a </span><span class="No-Break"><span class="koboSpan" id="kobo.163.1">modified formula:</span></span></p>
<p><span class="koboSpan" id="kobo.164.1"><img alt="" src="image/Formula_B19145_07_002.png"/></span></p>
<p><span class="koboSpan" id="kobo.165.1">Here, </span><em class="italic"><span class="koboSpan" id="kobo.166.1">n</span></em><span class="koboSpan" id="kobo.167.1"> means the number of bars </span><em class="italic"><span class="koboSpan" id="kobo.168.1">back</span></em><span class="koboSpan" id="kobo.169.1"> from the </span><span class="No-Break"><span class="koboSpan" id="kobo.170.1">current bar.</span></span></p>
<p><span class="koboSpan" id="kobo.171.1">For example, if we set </span><em class="italic"><span class="koboSpan" id="kobo.172.1">n</span></em><span class="koboSpan" id="kobo.173.1"> to 24, then we calculate the difference in closing prices between the current bar and 24 bars ago (which, for an hourly chart, means the price strictly 24 hours or 1 day ago), we will see a somewhat different picture, as shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.174.1">Figure 7</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.175.1">.4</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.176.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer041">
<span class="koboSpan" id="kobo.177.1"><img alt="Figure 7.4 – A 24-bar momentum based on a 1-hour chart means the price rate of change for 24 hours" src="image/B19145_7_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.178.1">Figure 7.4 – A 24-bar momentum based on a 1-hour chart means the price rate of change for 24 hours</span></p>
<p><span class="koboSpan" id="kobo.179.1">We can see</span><a id="_idIndexMarker390"/><span class="koboSpan" id="kobo.180.1"> that the </span><em class="italic"><span class="koboSpan" id="kobo.181.1">market speed</span></em><span class="koboSpan" id="kobo.182.1">, or the price rate of </span><a id="_idIndexMarker391"/><span class="koboSpan" id="kobo.183.1">change for 24 hours, looks totally different from the preceding chart, where we considered the difference in closing prices of just two neighbor bars. </span><span class="koboSpan" id="kobo.183.2">There’s no </span><em class="italic"><span class="koboSpan" id="kobo.184.1">noise</span></em><span class="koboSpan" id="kobo.185.1"> here anymore; instead, we observe longer-term changes in the momentum values. </span><span class="koboSpan" id="kobo.185.2">But the observations we made previously (regarding the corrections and correlations between </span><em class="italic"><span class="koboSpan" id="kobo.186.1">market speed</span></em><span class="koboSpan" id="kobo.187.1"> and range/trend markets) remain valid, as only the scale and proportions of these </span><span class="No-Break"><span class="koboSpan" id="kobo.188.1">phenomena increased.</span></span></p>
<p><span class="koboSpan" id="kobo.189.1">So, to summarize, the momentum indicator is useful to determine the idle market phases (when its readings are close to zero) and the highly active market (when its readings exceed a certain threshold). </span><span class="koboSpan" id="kobo.189.2">However, I hope you can see the evident shortcoming of this indicator in its present form – to decide whether the present market is active or not, we must specify this very </span><em class="italic"><span class="koboSpan" id="kobo.190.1">certain threshold</span></em><span class="koboSpan" id="kobo.191.1"> we </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">just mentioned.</span></span></p>
<p><span class="koboSpan" id="kobo.193.1">What is this threshold? </span><span class="koboSpan" id="kobo.193.2">In the first example (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.194.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.195.1">.3</span></em><span class="koboSpan" id="kobo.196.1">), the momentum values never exceeded 0.006, while in the second one (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.197.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.198.1">.4</span></em><span class="koboSpan" id="kobo.199.1">), it reaches almost 0.02, which is </span><em class="italic"><span class="koboSpan" id="kobo.200.1">a order of magnitude</span></em><span class="koboSpan" id="kobo.201.1"> greater. </span><span class="koboSpan" id="kobo.201.2">So, if we say that market speed above 0.004 is </span><em class="italic"><span class="koboSpan" id="kobo.202.1">abnormally big</span></em><span class="koboSpan" id="kobo.203.1">, then we have to agree that</span><a id="_idIndexMarker392"/><span class="koboSpan" id="kobo.204.1"> in the second example, the market is in </span><em class="italic"><span class="koboSpan" id="kobo.205.1">abnormally big</span></em><span class="koboSpan" id="kobo.206.1"> mode half of </span><span class="No-Break"><span class="koboSpan" id="kobo.207.1">the time.</span></span></p>
<p><span class="koboSpan" id="kobo.208.1">It becomes clear </span><a id="_idIndexMarker393"/><span class="koboSpan" id="kobo.209.1">that for the classical momentum indicator, there is no such threshold as a single unique numeric value. </span><span class="koboSpan" id="kobo.209.2">It depends on the market, the data resolution, and the momentum period. </span><span class="koboSpan" id="kobo.209.3">And it would be great if we could adjust the threshold value automatically, without the need for doing that manually every time, and consequently, eliminating possible human </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">discretion bias.</span></span></p>
<p><span class="koboSpan" id="kobo.211.1">So, how can we get rid of subjectivity when setting such </span><span class="No-Break"><span class="koboSpan" id="kobo.212.1">a threshold?</span></span></p>
<h3><span class="koboSpan" id="kobo.213.1">RSI</span></h3>
<p><span class="koboSpan" id="kobo.214.1">The </span><a id="_idIndexMarker394"/><span class="koboSpan" id="kobo.215.1">problem</span><a id="_idIndexMarker395"/><span class="koboSpan" id="kobo.216.1"> of answering the key question, </span><em class="italic"><span class="koboSpan" id="kobo.217.1">Is it big enough or still small</span></em><span class="koboSpan" id="kobo.218.1"> discussed in the previous section was solved for the momentum indicator by</span><em class="italic"><span class="koboSpan" id="kobo.219.1"> J.</span></em><em class="italic"><span class="koboSpan" id="kobo.220.1"> Welles Wilder Jr.</span></em><span class="koboSpan" id="kobo.221.1"> in 1978. </span><span class="koboSpan" id="kobo.221.2">In his book, </span><em class="italic"><span class="koboSpan" id="kobo.222.1">New Concepts in Technical Trading Systems</span></em><span class="koboSpan" id="kobo.223.1">, he introduced the </span><strong class="bold"><span class="koboSpan" id="kobo.224.1">relative strength index</span></strong><span class="koboSpan" id="kobo.225.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.226.1">RSI</span></strong><span class="koboSpan" id="kobo.227.1">), a new TA indicator that he suggested using in order to determine the </span><em class="italic"><span class="koboSpan" id="kobo.228.1">overbought</span></em><span class="koboSpan" id="kobo.229.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.230.1">oversold</span></em><span class="koboSpan" id="kobo.231.1"> states of the market. </span><span class="koboSpan" id="kobo.231.2">In his terminology, </span><em class="italic"><span class="koboSpan" id="kobo.232.1">overbought</span></em><span class="koboSpan" id="kobo.233.1"> corresponds to the situation when prices grow </span><em class="italic"><span class="koboSpan" id="kobo.234.1">too quickly</span></em><span class="koboSpan" id="kobo.235.1">, basically meaning that the market speed we discussed previously is too high. </span><em class="italic"><span class="koboSpan" id="kobo.236.1">Oversold</span></em><span class="koboSpan" id="kobo.237.1"> zones correspond to situations when prices fall </span><em class="italic"><span class="koboSpan" id="kobo.238.1">too quickly</span></em><span class="koboSpan" id="kobo.239.1">, meaning the momentum is still greater than average by its absolute value but has a </span><span class="No-Break"><span class="koboSpan" id="kobo.240.1">negative sign.</span></span></p>
<p><span class="koboSpan" id="kobo.241.1">RSI solves the problem of specifying a universal threshold for the momentum indicator by </span><em class="italic"><span class="koboSpan" id="kobo.242.1">normalizing</span></em><span class="koboSpan" id="kobo.243.1"> its values. </span><span class="koboSpan" id="kobo.243.2">Normalization is a process of scaling data so that all values fit into a certain range. </span><span class="koboSpan" id="kobo.243.3">For example, we have </span><span class="No-Break"><span class="koboSpan" id="kobo.244.1">two datasets:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.245.1">
{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}
{0, 0.1, 0.4, 0.05, 0.1, 0.3, 0.2}</span></pre>
<p><span class="koboSpan" id="kobo.246.1">We want to be able to compare </span><em class="italic"><span class="koboSpan" id="kobo.247.1">apples to apples</span></em><span class="koboSpan" id="kobo.248.1">, and thus we want to scale both of them so the minimum and the maximum values of each dataset are the same. </span><span class="koboSpan" id="kobo.248.2">Typically, a range of 0 to 100 is used (it’s convenient: if we normalize data to this range we can then consider the values as a percentage). </span><span class="koboSpan" id="kobo.248.3">So, if we scale the first dataset to the range </span><em class="italic"><span class="koboSpan" id="kobo.249.1">0:100</span></em><span class="koboSpan" id="kobo.250.1">, we will get an </span><span class="No-Break"><span class="koboSpan" id="kobo.251.1">obvious sequence:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.252.1">
{0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100}</span></pre>
<p><span class="koboSpan" id="kobo.253.1">But when we scale the second one, then </span><strong class="source-inline"><span class="koboSpan" id="kobo.254.1">0</span></strong><span class="koboSpan" id="kobo.255.1"> remains </span><strong class="source-inline"><span class="koboSpan" id="kobo.256.1">0</span></strong><span class="koboSpan" id="kobo.257.1">, and the maximum value, which is </span><strong class="source-inline"><span class="koboSpan" id="kobo.258.1">0.4</span></strong><span class="koboSpan" id="kobo.259.1">, becomes </span><strong class="source-inline"><span class="koboSpan" id="kobo.260.1">100</span></strong><span class="koboSpan" id="kobo.261.1">, so the scaling coefficient is </span><em class="italic"><span class="koboSpan" id="kobo.262.1">100/0.4 = 250</span></em><span class="koboSpan" id="kobo.263.1">. </span><span class="koboSpan" id="kobo.263.2">Then, the normalized dataset will look </span><span class="No-Break"><span class="koboSpan" id="kobo.264.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.265.1">
{0, 25, 100, 12.5, 25, 75, 50}</span></pre>
<p><span class="koboSpan" id="kobo.266.1">Now</span><a id="_idIndexMarker396"/><span class="koboSpan" id="kobo.267.1"> we </span><a id="_idIndexMarker397"/><span class="koboSpan" id="kobo.268.1">can compare, for example, the rate of change of data points in both datasets using the same metrics, despite the fact that, originally, the second dataset contains values of </span><em class="italic"><span class="koboSpan" id="kobo.269.1">a order of magnitude smaller</span></em><span class="koboSpan" id="kobo.270.1"> than values in the </span><span class="No-Break"><span class="koboSpan" id="kobo.271.1">first one.</span></span></p>
<p><span class="koboSpan" id="kobo.272.1">So, the idea of the normalization of TA indicators is to scale them </span><em class="italic"><span class="koboSpan" id="kobo.273.1">automatically</span></em><span class="koboSpan" id="kobo.274.1"> so that their values always remain in the </span><em class="italic"><span class="koboSpan" id="kobo.275.1">0:100</span></em><span class="koboSpan" id="kobo.276.1"> range, or sometimes, </span><em class="italic"><span class="koboSpan" id="kobo.277.1">-100:100</span></em><span class="koboSpan" id="kobo.278.1">. </span><span class="koboSpan" id="kobo.278.2">Let’s do it for </span><span class="No-Break"><span class="koboSpan" id="kobo.279.1">the momentum.</span></span></p>
<p><span class="koboSpan" id="kobo.280.1">Welles Wilder suggests calculating RSI in two steps: first, we </span><a id="_idIndexMarker398"/><span class="koboSpan" id="kobo.281.1">calculate the </span><strong class="bold"><span class="koboSpan" id="kobo.282.1">relative strength</span></strong><span class="koboSpan" id="kobo.283.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.284.1">RS</span></strong><span class="koboSpan" id="kobo.285.1">), and second, </span><span class="No-Break"><span class="koboSpan" id="kobo.286.1">the RSI.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.287.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.288.1">Don’t forget that as with any other TA indicator, RSI uses </span><em class="italic"><span class="koboSpan" id="kobo.289.1">period</span></em><span class="koboSpan" id="kobo.290.1">, a parameter that determines the number of data points we take into consideration. </span><span class="koboSpan" id="kobo.290.2">In the first example of the momentum indicator from the previous section, the period was just 1, and in the second example, it </span><span class="No-Break"><span class="koboSpan" id="kobo.291.1">was 24.</span></span></p>
<p><span class="koboSpan" id="kobo.292.1">To calculate the RS, we </span><a id="_idIndexMarker399"/><span class="koboSpan" id="kobo.293.1">should first calculate the </span><em class="italic"><span class="koboSpan" id="kobo.294.1">gains</span></em><span class="koboSpan" id="kobo.295.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.296.1">losses</span></em><span class="koboSpan" id="kobo.297.1"> for the period. </span><span class="koboSpan" id="kobo.297.2">A gain, in Wilder’s terminology, happened when a bar closed up, and a loss when a bar closed down. </span><span class="koboSpan" id="kobo.297.3">Then, we calculate the average of gains and the average of losses separately. </span><span class="koboSpan" id="kobo.297.4">And finally, we calculate the relative strength for </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">the period:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer042">
<span class="koboSpan" id="kobo.299.1"><img alt="" src="image/Formula_B19145_07_003.jpg"/></span>
</div>
</div>
<p><span class="koboSpan" id="kobo.300.1">This formula is similar to the original momentum, only the momentum measures the </span><em class="italic"><span class="koboSpan" id="kobo.301.1">difference</span></em><span class="koboSpan" id="kobo.302.1"> between prices, and the RS measures the </span><em class="italic"><span class="koboSpan" id="kobo.303.1">ratio</span></em><span class="koboSpan" id="kobo.304.1">. </span><span class="koboSpan" id="kobo.304.2">Using ratios is always preferred when </span><a id="_idIndexMarker400"/><span class="koboSpan" id="kobo.305.1">we want to become independent of the original value range, where subtracting 0.01 from 0.1 will result in 0.09, while subtracting 10 from 100 results in 90, and it’s evident </span><a id="_idIndexMarker401"/><span class="koboSpan" id="kobo.306.1">that 90 and 0.09 differ by </span><em class="italic"><span class="koboSpan" id="kobo.307.1">4 orders of magnitude</span></em><span class="koboSpan" id="kobo.308.1">, so it’s impossible to compare them directly. </span><span class="koboSpan" id="kobo.308.2">However, dividing 0.01 by 0.1 and dividing 10 by 100 produces exactly the same value, that is, 0.1, so in terms of market speed, this value is indeed </span><span class="No-Break"><span class="koboSpan" id="kobo.309.1">the same.</span></span></p>
<p><span class="koboSpan" id="kobo.310.1">Now, we normalize the RS by keeping it always within the range of 0 </span><span class="No-Break"><span class="koboSpan" id="kobo.311.1">to 100:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer043">
<span class="koboSpan" id="kobo.312.1"><img alt="" src="image/Formula_B19145_07_004.jpg"/></span>
</div>
</div>
<p><span class="koboSpan" id="kobo.313.1">If we now plot the RSI along with the momentum on the same chart, we can see that the two indicators are </span><span class="No-Break"><span class="koboSpan" id="kobo.314.1">very similar:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer044">
<span class="koboSpan" id="kobo.315.1"><img alt="Figure 7.5 – Momentum (top) and RSI (bottom) plotted on the same price chart" src="image/B19145_7_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.316.1">Figure 7.5 – Momentum (top) and RSI (bottom) plotted on the same price chart</span></p>
<p><span class="koboSpan" id="kobo.317.1">Since RSI is </span><a id="_idIndexMarker402"/><span class="koboSpan" id="kobo.318.1">normalized to a range of 0 to 100, typically, the values above 70 are considered an </span><em class="italic"><span class="koboSpan" id="kobo.319.1">overbought</span></em><span class="koboSpan" id="kobo.320.1"> market, while values below 30 are</span><a id="_idIndexMarker403"/><span class="koboSpan" id="kobo.321.1"> spoken of as </span><em class="italic"><span class="koboSpan" id="kobo.322.1">oversold</span></em><span class="koboSpan" id="kobo.323.1">. </span><span class="koboSpan" id="kobo.323.2">In the preceding chart, the </span><em class="italic"><span class="koboSpan" id="kobo.324.1">overbought</span></em><span class="koboSpan" id="kobo.325.1"> market corresponds to an uptrend, and absence of </span><em class="italic"><span class="koboSpan" id="kobo.326.1">oversold</span></em><span class="koboSpan" id="kobo.327.1"> state can be interpreted as a strong upside bias in the </span><span class="No-Break"><span class="koboSpan" id="kobo.328.1">market sentiment.</span></span></p>
<p><span class="koboSpan" id="kobo.329.1">There are more market speed indicators than momentum and RSI, but all of them are used to determine the following </span><span class="No-Break"><span class="koboSpan" id="kobo.330.1">market regimes:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.331.1">Idle versus active market (prices move slowly </span><span class="No-Break"><span class="koboSpan" id="kobo.332.1">or quickly)</span></span></li>
<li><span class="koboSpan" id="kobo.333.1">Overbought/oversold zones (prices went </span><em class="italic"><span class="koboSpan" id="kobo.334.1">too high</span></em><span class="koboSpan" id="kobo.335.1"> or </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.336.1">too low</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.337.1">)</span></span></li>
<li><span class="koboSpan" id="kobo.338.1">Sharp bursts of prices mostly caused by liquidity issues (</span><em class="italic"><span class="koboSpan" id="kobo.339.1">spikes</span></em><span class="koboSpan" id="kobo.340.1"> on </span><span class="No-Break"><span class="koboSpan" id="kobo.341.1">momentum charts)</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.342.1">So, momentum is good for detecting relatively short-living market situations. </span><span class="koboSpan" id="kobo.342.2">But what about something longer-term? </span><span class="koboSpan" id="kobo.342.3">Are there indicators that could show us a more global sentiment, a long-term tendency? </span><span class="koboSpan" id="kobo.342.4">Let’s move on to another class of TA indicators that is normally used for this </span><span class="No-Break"><span class="koboSpan" id="kobo.343.1">very purpose.</span></span></p>
<h2 id="_idParaDest-117"><a id="_idTextAnchor118"/><span class="koboSpan" id="kobo.344.1">Digital filters</span></h2>
<p><span class="koboSpan" id="kobo.345.1">If </span><a id="_idIndexMarker404"/><span class="koboSpan" id="kobo.346.1">you listen to music of any genre, and I hope you do, there’s a good </span><a id="_idIndexMarker405"/><span class="koboSpan" id="kobo.347.1">chance that you are familiar with high-pass filters, low-pass filters, and equalizers. </span><span class="koboSpan" id="kobo.347.2">Any car audio, desktop, or mobile audio player offers this functionality. </span><span class="koboSpan" id="kobo.347.3">And I do hope that if you played with audio settings at least once in your life, you will remember what happens if you turn off treble and boost the bass to the maximum – that is, instead of music, you now hear </span><span class="No-Break"><span class="koboSpan" id="kobo.348.1">only </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.349.1">boom-boom-boom</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.350.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.351.1">However, cutting off higher frequencies can also be quite useful if you want to focus on the rhythm, on the bass line, and probably on the chords and base (as opposed to harmonics) tones. </span><span class="koboSpan" id="kobo.351.2">And this is what lots of technical analysts dream of – to strip away all the </span><em class="italic"><span class="koboSpan" id="kobo.352.1">noise</span></em><span class="koboSpan" id="kobo.353.1"> from the market prices, leaving only the </span><em class="italic"><span class="koboSpan" id="kobo.354.1">bass line</span></em><span class="koboSpan" id="kobo.355.1"> or </span><em class="italic"><span class="koboSpan" id="kobo.356.1">rhythm</span></em><span class="koboSpan" id="kobo.357.1">, – that is, the key trends and major price movements that last relatively long and, potentially, </span><span class="No-Break"><span class="koboSpan" id="kobo.358.1">bring profits.</span></span></p>
<p><span class="koboSpan" id="kobo.359.1">Surprisingly, or not, all TA indicators that do this job work </span><em class="italic"><span class="koboSpan" id="kobo.360.1">exactly</span></em><span class="koboSpan" id="kobo.361.1"> the same as low or high-pass filters in audio because they are based on </span><em class="italic"><span class="koboSpan" id="kobo.362.1">exactly the same</span></em><span class="koboSpan" id="kobo.363.1"> mathematical principles. </span><span class="koboSpan" id="kobo.363.2">That’s why we put them all in one section: </span><span class="No-Break"><span class="koboSpan" id="kobo.364.1">digital filters.</span></span></p>
<h3><span class="koboSpan" id="kobo.365.1">Moving averages</span></h3>
<p><span class="koboSpan" id="kobo.366.1">A </span><a id="_idIndexMarker406"/><span class="koboSpan" id="kobo.367.1">moving average</span><a id="_idIndexMarker407"/><span class="koboSpan" id="kobo.368.1"> is also one of the oldest technical indicators. </span><span class="koboSpan" id="kobo.368.2">It is calculated as the average of prices for the period and</span><a id="_idIndexMarker408"/><span class="koboSpan" id="kobo.369.1"> recalculated on </span><span class="No-Break"><span class="koboSpan" id="kobo.370.1">every bar.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.371.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.372.1">When we discuss TA indicators, we always use two terms: </span><em class="italic"><span class="koboSpan" id="kobo.373.1">period</span></em><span class="koboSpan" id="kobo.374.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.375.1">current bar</span></em><span class="koboSpan" id="kobo.376.1">. </span><span class="koboSpan" id="kobo.376.2">So let me just quickly remind you that a </span><em class="italic"><span class="koboSpan" id="kobo.377.1">period</span></em><span class="koboSpan" id="kobo.378.1"> means a number of data points (ticks, bars, any other samples from a time series) that the TA indicator analyzes, and the </span><em class="italic"><span class="koboSpan" id="kobo.379.1">current bar</span></em><span class="koboSpan" id="kobo.380.1"> changes one by one, left to right, as we reconstruct the historical values of the indicator, along with the historical values of the market </span><span class="No-Break"><span class="koboSpan" id="kobo.381.1">price itself.</span></span></p>
<p><span class="koboSpan" id="kobo.382.1">To give you a simple example, let’s consider the </span><span class="No-Break"><span class="koboSpan" id="kobo.383.1">following dataset:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.384.1">
A = {0, 1, 2, 3, 2, 1, 0, 1, 2, 3}</span></pre>
<p><span class="koboSpan" id="kobo.385.1">Let’s </span><a id="_idIndexMarker409"/><span class="koboSpan" id="kobo.386.1">calculate an average of three data points starting from </span><a id="_idIndexMarker410"/><span class="koboSpan" id="kobo.387.1">the leftmost one. </span><span class="koboSpan" id="kobo.387.2">For the first element in the original dataset, it’s impossible to do because we have only one data point and we require three. </span><span class="koboSpan" id="kobo.387.3">The same for the second data point. </span><span class="koboSpan" id="kobo.387.4">So, we can start calculating the moving average from the third data point, and its value will be </span><span class="No-Break"><span class="koboSpan" id="kobo.388.1">as follows:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer045">
<span class="koboSpan" id="kobo.389.1"><img alt="" src="image/Formula_B19145_07_005.jpg"/></span>
</div>
</div>
<p><span class="koboSpan" id="kobo.390.1">Then, we move on to the fourth data point and again calculate the value of the moving average, but this time, we start calculating from the second element in </span><span class="No-Break"><span class="koboSpan" id="kobo.391.1">our dataset:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer046">
<span class="koboSpan" id="kobo.392.1"><img alt="" src="image/Formula_B19145_07_006.jpg"/></span>
</div>
</div>
<p><span class="koboSpan" id="kobo.393.1">Proceeding in this way, we will get a new dataset that represents the average values of three data points in a row, recalculated for each data point from left to right. </span><span class="koboSpan" id="kobo.393.2">Therefore, for the first two data points, we don’t have any value (as the number of original data points was insufficient to calculate a </span><span class="No-Break"><span class="koboSpan" id="kobo.394.1">three-point average):</span></span></p>
<pre class="source-code">
<span class="koboSpan" id="kobo.395.1"><img alt="" src="image/Formula_B19145_07_007.png"/></span><span class="koboSpan" id="kobo.396.1">= {NaN, NaN, 1, 2, 2.33, 2, 1, 0.66, 1, 2}</span></pre>
<p class="callout-heading"><span class="koboSpan" id="kobo.397.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.398.1">I hope you got the point: we always take three samples from the dataset, calculate the average, store this value in a new dataset, and move on to the next sample. </span><span class="koboSpan" id="kobo.398.2">This technique is called the </span><strong class="bold"><span class="koboSpan" id="kobo.399.1">moving window</span></strong><span class="koboSpan" id="kobo.400.1"> and</span><a id="_idIndexMarker411"/><span class="koboSpan" id="kobo.401.1"> is the basis for the calculation of all </span><span class="No-Break"><span class="koboSpan" id="kobo.402.1">TA indicators.</span></span></p>
<p><span class="koboSpan" id="kobo.403.1">Normally, </span><strong class="bold"><span class="koboSpan" id="kobo.404.1">moving averages</span></strong><span class="koboSpan" id="kobo.405.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.406.1">MAs</span></strong><span class="koboSpan" id="kobo.407.1">) are calculated based on the closing prices of bars, but nothing </span><a id="_idIndexMarker412"/><span class="koboSpan" id="kobo.408.1">prevents us from using them with any other price (such as high, low, or trade) or non-price data (such as volume, liquidity, and </span><span class="No-Break"><span class="koboSpan" id="kobo.409.1">so on).</span></span></p>
<p><span class="koboSpan" id="kobo.410.1">It’s evident</span><a id="_idIndexMarker413"/><span class="koboSpan" id="kobo.411.1"> that an MA with a period of one equals the original time series. </span><span class="koboSpan" id="kobo.411.2">How will values of MAs with greater periods correspond to the </span><span class="No-Break"><span class="koboSpan" id="kobo.412.1">original data?</span></span></p>
<p><span class="koboSpan" id="kobo.413.1">Let’s plot the original price time series in form of just dots, not bars, where each dot will denote a closing price of the bar. </span><span class="koboSpan" id="kobo.413.2">And let’s plot 3 different MAs along with the original series with periods of 2, 3, 5, and </span><span class="No-Break"><span class="koboSpan" id="kobo.414.1">10, respectively:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer048">
<span class="koboSpan" id="kobo.415.1"><img alt="Figure 7.6 – 3, 7, and 13-period MAs on top of a 1-hour chart of EURUSD" src="image/B19145_7_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.416.1">Figure 7.6 – 3, 7, and 13-period MAs on top of a 1-hour chart of EURUSD</span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.417.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.418.1">.6</span></em><span class="koboSpan" id="kobo.419.1"> plots the original time series as bars, and 3, 7, and 13-period MAs as dashes, crosses, and solid lines, respectively. </span><span class="koboSpan" id="kobo.419.2">We can see that the smaller the period of an MA, the closer its values are to the original series, and the greater the period, the </span><em class="italic"><span class="koboSpan" id="kobo.420.1">smoother</span></em><span class="koboSpan" id="kobo.421.1"> the change in the </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">MA’s values.</span></span></p>
<p><span class="koboSpan" id="kobo.423.1">This </span><em class="italic"><span class="koboSpan" id="kobo.424.1">smoothing</span></em><span class="koboSpan" id="kobo.425.1"> is the very effect of a low-pass filter. </span><span class="koboSpan" id="kobo.425.2">Surprisingly, an MA, calculated using simple mathematics, </span><em class="italic"><span class="koboSpan" id="kobo.426.1">is</span></em><span class="koboSpan" id="kobo.427.1"> a digital filter, pretty close to those used in audio processing. </span><span class="koboSpan" id="kobo.427.2">The greater the period of the MA, the lower the maximum frequency passed by such a filter. </span><span class="koboSpan" id="kobo.427.3">So, if applied to an audio signal, such a filter will leave us with </span><em class="italic"><span class="koboSpan" id="kobo.428.1">boom-boom</span></em><span class="koboSpan" id="kobo.429.1">, and now we can see this </span><em class="italic"><span class="koboSpan" id="kobo.430.1">boom-boom</span></em><span class="koboSpan" id="kobo.431.1"> in the market prices. </span><span class="koboSpan" id="kobo.431.2">Ultimately, using MAs with a </span><a id="_idIndexMarker414"/><span class="koboSpan" id="kobo.432.1">period of 20, 50, or 200 will show only longer-term changes in the market prices, considering minor price movements as </span><span class="No-Break"><span class="koboSpan" id="kobo.433.1">high-frequency noise.</span></span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.434.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.435.1">.7</span></em><span class="koboSpan" id="kobo.436.1"> shows </span><a id="_idIndexMarker415"/><span class="koboSpan" id="kobo.437.1">the same hourly chart of EURUSD with closing prices only, plotted as big black dots, and 20-, 50-, and 200-period MAs on top </span><span class="No-Break"><span class="koboSpan" id="kobo.438.1">of it:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer049">
<span class="koboSpan" id="kobo.439.1"><img alt="Figure 7.7 – 20, 50, and 200-period MAs plotted over a 1-hour chart of closing prices of EURUSD" src="image/B19145_7_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.440.1">Figure 7.7 – 20, 50, and 200-period MAs plotted over a 1-hour chart of closing prices of EURUSD</span></p>
<p><span class="koboSpan" id="kobo.441.1">In this example, we can see that the MA with the greatest period (200) only grows with slight changes in the growth rate, while MAs with shorter periods grow and decline, and the smaller the period of the MA, the closer its values are to the </span><span class="No-Break"><span class="koboSpan" id="kobo.442.1">original series.</span></span></p>
<p><span class="koboSpan" id="kobo.443.1">So, MAs are</span><a id="_idIndexMarker416"/><span class="koboSpan" id="kobo.444.1"> the simplest digital filters and are designed to detect </span><em class="italic"><span class="koboSpan" id="kobo.445.1">tendencies</span></em><span class="koboSpan" id="kobo.446.1"> rather than immediate activity. </span><span class="koboSpan" id="kobo.446.2">They are used in TA to solve the </span><span class="No-Break"><span class="koboSpan" id="kobo.447.1">following problems:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.448.1">To determine long- and </span><span class="No-Break"><span class="koboSpan" id="kobo.449.1">medium-term trends</span></span></li>
<li><span class="koboSpan" id="kobo.450.1">To distinguish bullish and bearish markets (normally, when daily prices close above the 200-period MA, the market is considered bullish, and </span><span class="No-Break"><span class="koboSpan" id="kobo.451.1">vice versa)</span></span></li>
<li><span class="koboSpan" id="kobo.452.1">To smoothen </span><em class="italic"><span class="koboSpan" id="kobo.453.1">occasional</span></em><span class="koboSpan" id="kobo.454.1"> or </span><em class="italic"><span class="koboSpan" id="kobo.455.1">abnormal</span></em><span class="koboSpan" id="kobo.456.1"> sharp </span><span class="No-Break"><span class="koboSpan" id="kobo.457.1">price movements</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.458.1">Very </span><a id="_idIndexMarker417"/><span class="koboSpan" id="kobo.459.1">frequently, MAs are used in combination with momentum indicators – for example, an MA can be used to determine whether the market is bullish (closing prices above 200-period MA), and momentum can determine the moment when the market speed is high, so potentially, it could be a good time </span><span class="No-Break"><span class="koboSpan" id="kobo.460.1">to buy.</span></span></p>
<p><span class="koboSpan" id="kobo.461.1">However, you probably already heard about traders who lost their fortune buying when prices were already too high or selling when prices were already too low. </span><span class="koboSpan" id="kobo.461.2">I hope now that we have so thoroughly examined the design of market speed indicators and digital filters, you have already spotted the bottleneck here – </span><em class="italic"><span class="koboSpan" id="kobo.462.1">too high</span></em><span class="koboSpan" id="kobo.463.1"> or </span><em class="italic"><span class="koboSpan" id="kobo.464.1">too low</span></em><span class="koboSpan" id="kobo.465.1">. </span><span class="koboSpan" id="kobo.465.2">But how do we decide that it’s already </span><em class="italic"><span class="koboSpan" id="kobo.466.1">too</span></em><span class="koboSpan" id="kobo.467.1"> high or still </span><em class="italic"><span class="koboSpan" id="kobo.468.1">not so</span></em><span class="koboSpan" id="kobo.469.1"> high? </span><span class="koboSpan" id="kobo.469.2">The answer is in the </span><span class="No-Break"><span class="koboSpan" id="kobo.470.1">following section.</span></span></p>
<h2 id="_idParaDest-118"><a id="_idTextAnchor119"/><span class="koboSpan" id="kobo.471.1">Range indicators</span></h2>
<p><span class="koboSpan" id="kobo.472.1">One</span><a id="_idIndexMarker418"/><span class="koboSpan" id="kobo.473.1"> of the</span><a id="_idIndexMarker419"/><span class="koboSpan" id="kobo.474.1"> most common methods to solve the problem of identifying whether the current price is in any extreme zone (too high or too low) is using range indicators. </span><span class="koboSpan" id="kobo.474.2">Normally, a </span><strong class="bold"><span class="koboSpan" id="kobo.475.1">price range</span></strong><span class="koboSpan" id="kobo.476.1"> is a</span><a id="_idIndexMarker420"/><span class="koboSpan" id="kobo.477.1"> difference between the maximum price and the minimum price for, well (I’m sure I heard you say that), a </span><em class="italic"><span class="koboSpan" id="kobo.478.1">period</span></em><span class="koboSpan" id="kobo.479.1">. </span><span class="koboSpan" id="kobo.479.2">As always, with technical indicators, we’re bound to a certain timespan, a moving window that we slide along the chart from left to right. </span><span class="koboSpan" id="kobo.479.3">So, when we talk about range, we have to define the period for which this range </span><span class="No-Break"><span class="koboSpan" id="kobo.480.1">is calculated.</span></span></p>
<p><span class="koboSpan" id="kobo.481.1">Let’s look at the chart shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.482.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.483.1">.8</span></em><span class="koboSpan" id="kobo.484.1">. </span><span class="koboSpan" id="kobo.484.2">The rectangle shows the maximum and minimum </span><a id="_idIndexMarker421"/><span class="koboSpan" id="kobo.485.1">price of a 24-bar span (since it’s an hourly chart, this means the rectangle corresponds to </span><span class="No-Break"><span class="koboSpan" id="kobo.486.1">1 day):</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer050">
<span class="koboSpan" id="kobo.487.1"><img alt="Figure 7.8 – A 24-hour price range with 2 closing prices shown as percentage of range, EURUSD, 1-hour" src="image/B19145_7_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.488.1">Figure 7.8 – A 24-hour price range with 2 closing prices shown as percentage of range, EURUSD, 1-hour</span></p>
<p><span class="koboSpan" id="kobo.489.1">Two closing</span><a id="_idIndexMarker422"/><span class="koboSpan" id="kobo.490.1"> prices are marked with small arrows. </span><span class="koboSpan" id="kobo.490.2">Horizontal lines are drawn through these closing prices to visualize the price levels relative to the range rather than absolute values. </span><span class="koboSpan" id="kobo.490.3">So, for the first (left to right) closing price, the absolute value is 1.1260, but relative to the range, it’s right at 50% of it. </span><span class="koboSpan" id="kobo.490.4">The second closing price is 1.1292, but relative to the range, it’s about 85% </span><span class="No-Break"><span class="koboSpan" id="kobo.491.1">of it.</span></span></p>
<p><span class="koboSpan" id="kobo.492.1">Got the point? </span><span class="koboSpan" id="kobo.492.2">We can replace absolute price values that don’t say much with relative price levels, which could be interpreted pretty much as we interpreted RSI values (see the </span><em class="italic"><span class="koboSpan" id="kobo.493.1">RSI</span></em><span class="koboSpan" id="kobo.494.1"> section). </span><span class="koboSpan" id="kobo.494.2">For example, we can say that when the price is above 80% of the range level, then</span><a id="_idIndexMarker423"/><span class="koboSpan" id="kobo.495.1"> the price is </span><em class="italic"><span class="koboSpan" id="kobo.496.1">too high</span></em><span class="koboSpan" id="kobo.497.1">, and when the price is </span><a id="_idIndexMarker424"/><span class="koboSpan" id="kobo.498.1">below 20% of the range level, then the price is </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.499.1">too low</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.500.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.501.1">The first and the most well-known range indicator is the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.502.1">stochastic oscillator</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.503.1">.</span></span></p>
<h3><span class="koboSpan" id="kobo.504.1">Stochastic oscillator</span></h3>
<p><strong class="bold"><span class="koboSpan" id="kobo.505.1">Stochastic</span></strong><span class="koboSpan" id="kobo.506.1"> is </span><a id="_idIndexMarker425"/><span class="koboSpan" id="kobo.507.1">quite a popular word among traders, but unfortunately, it is often used improperly. </span><span class="koboSpan" id="kobo.507.2">In mathematics, the term </span><em class="italic"><span class="koboSpan" id="kobo.508.1">stochastic</span></em><span class="koboSpan" id="kobo.509.1"> means a variety of random processes. </span><span class="koboSpan" id="kobo.509.2">To understand what it means, let’s consider </span><span class="No-Break"><span class="koboSpan" id="kobo.510.1">an example.</span></span></p>
<p><span class="koboSpan" id="kobo.511.1">If you go out </span><a id="_idIndexMarker426"/><span class="koboSpan" id="kobo.512.1">to buy some bread, then you will most likely go down the same streets, end your route at the same local grocery store, and spend more or less the same amount of time as usual. </span><span class="koboSpan" id="kobo.512.2">This is an example of a </span><em class="italic"><span class="koboSpan" id="kobo.513.1">deterministic process</span></em><span class="koboSpan" id="kobo.514.1"> – although there can be some </span><em class="italic"><span class="koboSpan" id="kobo.515.1">fluctuations</span></em><span class="koboSpan" id="kobo.516.1"> or deviations down the road (for example, you decide to walk on this or that side of the street), the overall route and destination remain </span><span class="No-Break"><span class="koboSpan" id="kobo.517.1">the same.</span></span></p>
<p><span class="koboSpan" id="kobo.518.1">Now, imagine that you go out with no particular goal in mind and stop at any shop, bar, or movie theater you like, spend any amount of time in each, and decide where to go next by tossing a coin. </span><span class="koboSpan" id="kobo.518.2">Every time you take such a trip, its trajectory, destinations, and time spent, both on each leg and the entire journey, will differ. </span><span class="koboSpan" id="kobo.518.3">Although the area where you’re traveling is confined and you visit the same places, the map of your actual movements will be different because of the </span><em class="italic"><span class="koboSpan" id="kobo.519.1">randomness</span></em><span class="koboSpan" id="kobo.520.1"> of your decisions. </span><span class="koboSpan" id="kobo.520.2">Such a process is called </span><em class="italic"><span class="koboSpan" id="kobo.521.1">stochastic</span></em><span class="koboSpan" id="kobo.522.1"> or </span><em class="italic"><span class="koboSpan" id="kobo.523.1">random</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.524.1">or </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.525.1">probabilistic</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.526.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.527.1">Market price movements are also considered random or stochastic processes by many researchers, who have suggested various probabilistic models that describe price behavior. </span><span class="koboSpan" id="kobo.527.2">Although this standpoint can also be criticized, such an academic debate is definitely outside the scope of this book, so the main points we should take away from this brief </span><em class="italic"><span class="koboSpan" id="kobo.528.1">lyrical digression</span></em><span class="koboSpan" id="kobo.529.1"> are </span><span class="No-Break"><span class="koboSpan" id="kobo.530.1">as follows:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.531.1">Processes with a definite trajectory, target, and time are </span><span class="No-Break"><span class="koboSpan" id="kobo.532.1">called </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.533.1">deterministic</span></strong></span></li>
<li><span class="koboSpan" id="kobo.534.1">Processes where every next step has just some probability and you never know for sure where and when it reaches any target are </span><span class="No-Break"><span class="koboSpan" id="kobo.535.1">called </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.536.1">stochastic</span></strong></span></li>
<li><span class="koboSpan" id="kobo.537.1">Changes in market prices can be considered a </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.538.1">stochastic process</span></strong></span></li>
<li><span class="koboSpan" id="kobo.539.1">The stochastic oscillator has nothing in common with </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.540.1">stochastic processes</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.541.1">The</span><a id="_idIndexMarker427"/><span class="koboSpan" id="kobo.542.1"> stochastic oscillator </span><a id="_idIndexMarker428"/><span class="koboSpan" id="kobo.543.1">in its original form shows exactly what we considered at the very end of the previous section – it shows where the current price is as a percentage of a certain price range. </span><span class="koboSpan" id="kobo.543.2">So, in order to </span><a id="_idIndexMarker429"/><span class="koboSpan" id="kobo.544.1">calculate the stochastic oscillator, we should choose a period (number of data points), then find the maximum and the minimum price for this period, and then calculate the value of the </span><span class="No-Break"><span class="koboSpan" id="kobo.545.1">stochastic oscillator:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer051">
<span class="koboSpan" id="kobo.546.1"><img alt="" src="image/Formula_B19145_07_008.jpg"/></span>
</div>
</div>
<p><span class="koboSpan" id="kobo.547.1">Here, </span><em class="italic"><span class="koboSpan" id="kobo.548.1">P</span></em><span class="subscript"><span class="koboSpan" id="kobo.549.1">0</span></span><span class="koboSpan" id="kobo.550.1"> means the current price, </span><em class="italic"><span class="koboSpan" id="kobo.551.1">L</span></em><span class="koboSpan" id="kobo.552.1"> means the lowest price for the period, and </span><em class="italic"><span class="koboSpan" id="kobo.553.1">H</span></em><span class="koboSpan" id="kobo.554.1"> means the highest price for </span><span class="No-Break"><span class="koboSpan" id="kobo.555.1">the period.</span></span></p>
<p><span class="koboSpan" id="kobo.556.1">Let’s again open an hourly chart of a currency pair, but this time, the Japanese yen for a change, and let’s plot this indicator with a period of 24 below it (thus tracking changes in price as a percentage of a </span><span class="No-Break"><span class="koboSpan" id="kobo.557.1">day’s range):</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer052">
<span class="koboSpan" id="kobo.558.1"><img alt="Figure 7.9 – Basic 24-period stochastic oscillator below the 1-hour chart of USDJPY" src="image/B19145_7_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.559.1">Figure 7.9 – Basic 24-period stochastic oscillator below the 1-hour chart of USDJPY</span></p>
<p><span class="koboSpan" id="kobo.560.1">In </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.561.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.562.1">.9</span></em><span class="koboSpan" id="kobo.563.1">, we </span><a id="_idIndexMarker430"/><span class="koboSpan" id="kobo.564.1">can see that the stochastic oscillator indeed </span><em class="italic"><span class="koboSpan" id="kobo.565.1">oscillates</span></em><span class="koboSpan" id="kobo.566.1"> in a range from 0 to 100 (what a surprise). </span><span class="koboSpan" id="kobo.566.2">During trends (right half of the picture), it tends to stay above 50, and in sideways markets (middle part of the picture) it can oscillate </span><span class="No-Break"><span class="koboSpan" id="kobo.567.1">full scale.</span></span></p>
<p><span class="koboSpan" id="kobo.568.1">So, what’s the possible application of the </span><span class="No-Break"><span class="koboSpan" id="kobo.569.1">stochastic oscillator?</span></span></p>
<p><span class="koboSpan" id="kobo.570.1">First and foremost, it’s used </span><a id="_idIndexMarker431"/><span class="koboSpan" id="kobo.571.1">to answer the question of whether the price is </span><em class="italic"><span class="koboSpan" id="kobo.572.1">too high</span></em><span class="koboSpan" id="kobo.573.1"> or </span><em class="italic"><span class="koboSpan" id="kobo.574.1">too low</span></em><span class="koboSpan" id="kobo.575.1"> (I hope you remember this Shakespearean question from the end of the previous section). </span><span class="koboSpan" id="kobo.575.2">We can say, for example, that when the price is above the level of 80 – which means that the price is greater than 80% of the price range – then it is indeed </span><em class="italic"><span class="koboSpan" id="kobo.576.1">too high</span></em><span class="koboSpan" id="kobo.577.1">. </span><span class="koboSpan" id="kobo.577.2">Likewise, being under 20% of the range could mean that the price is </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.578.1">too low</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.579.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.580.1">Second, some technical traders like to use stochastic and similar oscillators to determine trends. </span><span class="koboSpan" id="kobo.580.2">We already saw that, during trends, the stochastic oscillator tends to remain above (for uptrends) or below (for downtrends) 50% of the range for quite a long time. </span><span class="koboSpan" id="kobo.580.3">It’s no wonder that trends are special market regimes where corrections in prices are much smaller and last for a much shorter time than the movements in the direction of the trend. </span><span class="koboSpan" id="kobo.580.4">So, prices will indeed remain in the upper or lower half of the range for many hours, days, or sometimes </span><span class="No-Break"><span class="koboSpan" id="kobo.581.1">even weeks.</span></span></p>
<p><span class="koboSpan" id="kobo.582.1">There are </span><a id="_idIndexMarker432"/><span class="koboSpan" id="kobo.583.1">numerous modifications of the stochastic oscillator. </span><span class="koboSpan" id="kobo.583.2">For</span><a id="_idIndexMarker433"/><span class="koboSpan" id="kobo.584.1"> example, adding an MA to its values (and we remember that we can add an MA to any time series, not necessarily price) gives us a so-called </span><em class="italic"><span class="koboSpan" id="kobo.585.1">slow stochastic</span></em><span class="koboSpan" id="kobo.586.1">. </span><span class="koboSpan" id="kobo.586.2">Some authors suggest using the original indicator and the averaged one on the same chart, but the essence remains the same – this is a range oscillator and can, therefore, be used to solve the </span><span class="No-Break"><span class="koboSpan" id="kobo.587.1">following problems:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.588.1">Identifying whether the price is </span><em class="italic"><span class="koboSpan" id="kobo.589.1">too high</span></em><span class="koboSpan" id="kobo.590.1"> or </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.591.1">too low</span></em></span></li>
<li><span class="koboSpan" id="kobo.592.1">Identifying trends as long-term periods when prices are above or below 50% of </span><span class="No-Break"><span class="koboSpan" id="kobo.593.1">the range</span></span></li>
<li><span class="koboSpan" id="kobo.594.1">Suggesting buy signals when the oscillator starts going up from </span><em class="italic"><span class="koboSpan" id="kobo.595.1">too </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.596.1">low</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.597.1"> levels</span></span></li>
<li><span class="koboSpan" id="kobo.598.1">Suggesting sell signals when the oscillator starts going down from </span><em class="italic"><span class="koboSpan" id="kobo.599.1">too </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.600.1">high</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.601.1"> levels</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.602.1">Now that we have a speed indicator (momentum or RSI) that tells us that the market is moving fast, a digital filter (MAs) that confirms that the main tendency in the market is still positive, and a range indicator (stochastic) that shows that the asset is currently oversold, it may look like it’s a good time </span><span class="No-Break"><span class="koboSpan" id="kobo.603.1">to buy.</span></span></p>
<p><span class="No-Break"><span class="koboSpan" id="kobo.604.1">But!</span></span></p>
<p><span class="koboSpan" id="kobo.605.1">Even if we calculated the timing of our entry with the highest degree of perfection, markets still remain stochastic processes (remember what we started with at the beginning of this section?) and it is normal that price may go against you for some time. </span><span class="koboSpan" id="kobo.605.2">The key question here is whether this adverse price movement is only a small correction and it’s wise to just wait till red turns green, or you were wrong with your trading decision (which, by the way, is also absolutely normal) and should liquidate your losing position before it drains your </span><span class="No-Break"><span class="koboSpan" id="kobo.606.1">account completely.</span></span></p>
<p><span class="koboSpan" id="kobo.607.1">Normally, this problem is solved by adding volatility studies to the trading </span><span class="No-Break"><span class="koboSpan" id="kobo.608.1">strategy logic.</span></span></p>
<h2 id="_idParaDest-119"><a id="_idTextAnchor120"/><span class="koboSpan" id="kobo.609.1">Volatility indicators</span></h2>
<p><span class="koboSpan" id="kobo.610.1">If we</span><a id="_idIndexMarker434"/><span class="koboSpan" id="kobo.611.1"> look up the definition of volatility in Merriam-Webster, the first suggested </span><a id="_idIndexMarker435"/><span class="koboSpan" id="kobo.612.1">meaning would be </span><em class="italic"><span class="koboSpan" id="kobo.613.1">a tendency to change quickly and unpredictably</span></em><span class="koboSpan" id="kobo.614.1">. </span><span class="koboSpan" id="kobo.614.2">Sounds good, but how can we measure this tendency, this ability </span><span class="No-Break"><span class="koboSpan" id="kobo.615.1">to change?</span></span></p>
<p><span class="koboSpan" id="kobo.616.1">Wikipedia (</span><a href="https://en.wikipedia.org/wiki/Volatility_(finance)"><span class="koboSpan" id="kobo.617.1">https://en.wikipedia.org/wiki/Volatility_(finance)</span></a><span class="koboSpan" id="kobo.618.1">) suggests a different definition: </span><em class="italic"><span class="koboSpan" id="kobo.619.1">“volatility (usually denoted by σ) is the degree of variation of a trading price series over time, usually measured by the standard deviation of logarithmic returns.”</span></em><span class="koboSpan" id="kobo.620.1"> If you are not familiar with mathematical statistics, this may sound like a foreign language to you, but don’t worry, let’s take a quick tour of the theory </span><span class="No-Break"><span class="koboSpan" id="kobo.621.1">of probability.</span></span></p>
<p><span class="koboSpan" id="kobo.622.1">Let’s use the same example with a random walk around bars and movie theaters. </span><span class="koboSpan" id="kobo.622.2">Let’s measure the distance between the starting point (your home, presumably) and the ending point (where you decide to finish your walk for the day). </span><span class="koboSpan" id="kobo.622.3">Every day, we will get different values because you make your travel decisions randomly. </span><span class="koboSpan" id="kobo.622.4">However, we can calculate the average value and say that, on average, you walk, say, three kilometers </span><span class="No-Break"><span class="koboSpan" id="kobo.623.1">per walk.</span></span></p>
<p><span class="koboSpan" id="kobo.624.1">The devil is always in the details, and the devil of averaging is</span><a id="_idIndexMarker436"/><span class="koboSpan" id="kobo.625.1"> called </span><strong class="bold"><span class="koboSpan" id="kobo.626.1">dispersion</span></strong><span class="koboSpan" id="kobo.627.1">. </span><span class="koboSpan" id="kobo.627.2">This is a measure of how much the actual values of a certain random variable differ from the average, or </span><em class="italic"><span class="koboSpan" id="kobo.628.1">mean</span></em><span class="koboSpan" id="kobo.629.1"> value. </span><span class="koboSpan" id="kobo.629.2">Let’s consider </span><span class="No-Break"><span class="koboSpan" id="kobo.630.1">two examples.</span></span></p>
<p><span class="koboSpan" id="kobo.631.1">First, let’s go back to a deterministic process when you go out to a local grocery. </span><span class="koboSpan" id="kobo.631.2">We record travel distances for each trip and put them into </span><span class="No-Break"><span class="koboSpan" id="kobo.632.1">a dataset:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.633.1">
S = {1.8, 1.9, 1.85, 1.79, 1.78, 1.81, 1.85, 1.82, 1.89, 1.2}</span></pre>
<p><span class="koboSpan" id="kobo.634.1">Now, let’s calculate the mean value of </span><span class="No-Break"><span class="koboSpan" id="kobo.635.1">this dataset:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer053">
<span class="koboSpan" id="kobo.636.1"><img alt="" src="image/Formula_B19145_07_009.jpg"/></span>
</div>
</div>
<p><span class="koboSpan" id="kobo.637.1">Now, subtract this mean value from each element of the </span><span class="No-Break"><span class="koboSpan" id="kobo.638.1">original dataset:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.639.1">
D = {0.03, 0.13, 0.08, 0.02, 0.01, 0.04, 0.08, 0.05, 0.12, -0.57}</span></pre>
<p><span class="koboSpan" id="kobo.640.1">We can see that </span><a id="_idIndexMarker437"/><span class="koboSpan" id="kobo.641.1">the difference between almost all recorded values and their mean is </span><em class="italic"><span class="koboSpan" id="kobo.642.1">a order of magnitude smaller</span></em><span class="koboSpan" id="kobo.643.1"> than the mean itself. </span><span class="koboSpan" id="kobo.643.2">The only exception is the last values in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.644.1">D</span></strong><span class="koboSpan" id="kobo.645.1"> dataset: the difference between it and the mean is comparable to the value itself. </span><span class="koboSpan" id="kobo.645.2">Such a value is called </span><a id="_idIndexMarker438"/><span class="koboSpan" id="kobo.646.1">an </span><strong class="bold"><span class="koboSpan" id="kobo.647.1">outlier</span></strong><span class="koboSpan" id="kobo.648.1"> and is most likely explained by incorrect measurements or something exceptional that happened to you down </span><span class="No-Break"><span class="koboSpan" id="kobo.649.1">the road.</span></span></p>
<p><span class="koboSpan" id="kobo.650.1">Now, let’s </span><a id="_idIndexMarker439"/><span class="koboSpan" id="kobo.651.1">record the distances traveled each time you took a random walk around the local bars and movie theaters. </span><span class="koboSpan" id="kobo.651.2">In some cases, you found a nice place to stay almost as soon as you left your house; in other cases, you walked quite a lot and still returned home unsatisfied, hence the difference in the distance you traveled each time. </span><span class="koboSpan" id="kobo.651.3">We will get a dataset </span><span class="No-Break"><span class="koboSpan" id="kobo.652.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.653.1">
S1 = {0.7, 2, 1.5, 0.3, 2.6, 1.1, 1.8, 0.45, 3.1, 2.9}</span></pre>
<p><span class="koboSpan" id="kobo.654.1">Its mean value is 1.645. </span><span class="koboSpan" id="kobo.654.2">If we now do the same as previously (that is, subtract this mean from each element of the dataset), we will see that the differences now are quite comparable to the mean value, and in some cases, nearly </span><span class="No-Break"><span class="koboSpan" id="kobo.655.1">exceed it:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.656.1">
D = {-0.94, 0.35, -0.14, -1.34, 0.95, -0.54, 0.15, -1.19, 1.45, 1.25}</span></pre>
<p><span class="koboSpan" id="kobo.657.1">The process in which the differences between values and their mean are way smaller than the values themselves is a </span><em class="italic"><span class="koboSpan" id="kobo.658.1">deterministic process</span></em><span class="koboSpan" id="kobo.659.1">, and now we have a more math-looking definition of it (although it’s still not formally correct). </span><span class="koboSpan" id="kobo.659.2">Conversely, the process where the differences between values and their mean are comparable to the mean itself is a </span><em class="italic"><span class="koboSpan" id="kobo.660.1">stochastic</span></em><span class="koboSpan" id="kobo.661.1"> or </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.662.1">random</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.663.1"> process.</span></span></p>
<p><span class="koboSpan" id="kobo.664.1">So, back to the market stuff. </span><span class="koboSpan" id="kobo.664.2">If we do the same math with prices (for example, recording the changes in price for each bar and then calculating their mean value and the difference), then we can use this difference as the measure of </span><em class="italic"><span class="koboSpan" id="kobo.665.1">volatility</span></em><span class="koboSpan" id="kobo.666.1">. </span><span class="koboSpan" id="kobo.666.2">It will indeed match the Merriam-Webster definition – the greater the differences in question, the less predictable the values and the quicker the possible changes </span><span class="No-Break"><span class="koboSpan" id="kobo.667.1">in prices.</span></span></p>
<p><span class="koboSpan" id="kobo.668.1">In practice, a bit more complex calculation is used to determine market volatility. </span><span class="koboSpan" id="kobo.668.2">One of the commonly used metrics that estimate </span><em class="italic"><span class="koboSpan" id="kobo.669.1">how far the values of a dataset are from their mean</span></em><span class="koboSpan" id="kobo.670.1"> is called </span><strong class="bold"><span class="koboSpan" id="kobo.671.1">standard deviation</span></strong><span class="koboSpan" id="kobo.672.1">. </span><span class="koboSpan" id="kobo.672.2">If </span><a id="_idIndexMarker440"/><span class="koboSpan" id="kobo.673.1">you are interested in learning more about it and the </span><a id="_idIndexMarker441"/><span class="koboSpan" id="kobo.674.1">mathematics behind the concept of volatility, I encourage you to first read the basics about mathematical statistics to get familiar with the terminology and the key concepts. </span><span class="koboSpan" id="kobo.674.2">The article in Wikipedia (</span><a href="https://en.wikipedia.org/wiki/Mathematical_statistics"><span class="koboSpan" id="kobo.675.1">https://en.wikipedia.org/wiki/Mathematical_statistics</span></a><span class="koboSpan" id="kobo.676.1">) could be a good starting point. </span><span class="koboSpan" id="kobo.676.2">In the </span><a id="_idIndexMarker442"/><span class="koboSpan" id="kobo.677.1">meantime, we continue in a somewhat informal manner and remember that standard deviation is used to estimate the volatility in any stochastic process and market prices </span><span class="No-Break"><span class="koboSpan" id="kobo.678.1">in particular.</span></span></p>
<p><span class="koboSpan" id="kobo.679.1">I am sure you now perfectly understand that </span><strong class="bold"><span class="koboSpan" id="kobo.680.1">standard deviation</span></strong><span class="koboSpan" id="kobo.681.1"> (or </span><strong class="bold"><span class="koboSpan" id="kobo.682.1">stddev</span></strong><span class="koboSpan" id="kobo.683.1"> for short) also requires a period quite like any other TA indicator. </span><span class="koboSpan" id="kobo.683.2">This period is the length of the dataset for which we measure the volatility. </span><span class="koboSpan" id="kobo.683.3">So, what we’re plotting is </span><span class="No-Break"><span class="koboSpan" id="kobo.684.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.685.1">
S = stddev(close, 24)</span></pre>
<p><span class="koboSpan" id="kobo.686.1">This can be shown in the form of an equation </span><span class="No-Break"><span class="koboSpan" id="kobo.687.1">like so:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer054">
<span class="koboSpan" id="kobo.688.1"><img alt="" src="image/Formula_B19145_07_010.jpg"/></span>
</div>
</div>
<p><span class="koboSpan" id="kobo.689.1">Here, </span><em class="italic"><span class="koboSpan" id="kobo.690.1">c</span></em><span class="subscript"><span class="koboSpan" id="kobo.691.1">i</span></span><span class="koboSpan" id="kobo.692.1"> means the closing price of the </span><em class="italic"><span class="koboSpan" id="kobo.693.1">i</span></em><span class="koboSpan" id="kobo.694.1">-th bar, </span><span class="koboSpan" id="kobo.695.1"><img alt="" src="image/Formula_B19145_07_011.png"/></span><span class="koboSpan" id="kobo.696.1"> denotes the mean value, and </span><em class="italic"><span class="koboSpan" id="kobo.697.1">24</span></em><span class="koboSpan" id="kobo.698.1"> means the number of data points (closing prices of bars) for which we </span><span class="No-Break"><span class="koboSpan" id="kobo.699.1">calculate </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.700.1">stddev</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.701.1">.</span></span></p>
<p><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.702.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.703.1">.10</span></em><span class="koboSpan" id="kobo.704.1"> shows the same 1-hour chart of GBPUSD as in the previous example, but now with the 24-period standard deviation indicator </span><span class="No-Break"><span class="koboSpan" id="kobo.705.1">below it:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer056">
<span class="koboSpan" id="kobo.706.1"><img alt="Figure 7.10 – Hourly chart of GBPUSD with a standard deviation of closing prices" src="image/B19145_7_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.707.1">Figure 7.10 – Hourly chart of GBPUSD with a standard deviation of closing prices</span></p>
<p><span class="koboSpan" id="kobo.708.1">We can see</span><a id="_idIndexMarker443"/><span class="koboSpan" id="kobo.709.1"> that volatility is something that doesn’t have any </span><a id="_idIndexMarker444"/><span class="koboSpan" id="kobo.710.1">evident relationships with the direction of the market prices or with trend/sideways market regimes. </span><span class="koboSpan" id="kobo.710.2">What we </span><em class="italic"><span class="koboSpan" id="kobo.711.1">can</span></em><span class="koboSpan" id="kobo.712.1"> see though is a number of </span><span class="No-Break"><span class="koboSpan" id="kobo.713.1">important observations:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.714.1">Standard deviation is always positive; it disregards the direction of the </span><span class="No-Break"><span class="koboSpan" id="kobo.715.1">price movement</span></span></li>
<li><span class="koboSpan" id="kobo.716.1">A sudden increase in the market activity does increase values of the standard deviation of </span><span class="No-Break"><span class="koboSpan" id="kobo.717.1">closing prices</span></span></li>
<li><span class="koboSpan" id="kobo.718.1">The longer the price remains at new levels (see the jump in price on July 27 and a congestion zone following it the next day), the greater the increase in values of the </span><span class="No-Break"><span class="koboSpan" id="kobo.719.1">standard deviation</span></span></li>
<li><span class="koboSpan" id="kobo.720.1">Maximums and minimums in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.721.1">stddev</span></strong><span class="koboSpan" id="kobo.722.1"> indicator do not correspond to maximums and minimums in the </span><span class="No-Break"><span class="koboSpan" id="kobo.723.1">price chart</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.724.1">Interesting picture, but there’s one questionable assumption here, and I hope you already exclaimed, “</span><em class="italic"><span class="koboSpan" id="kobo.725.1">Wait! </span><span class="koboSpan" id="kobo.725.2">But we measure the standard deviation of an incorrect dataset! </span><span class="koboSpan" id="kobo.725.3">Why do we measure it for the price itself when we should have done that for </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.726.1">price increments?</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.727.1">”.</span></span></p>
<p><span class="koboSpan" id="kobo.728.1">Indeed, the </span><a id="_idIndexMarker445"/><span class="koboSpan" id="kobo.729.1">market process can be considered a stochastic process from a </span><a id="_idIndexMarker446"/><span class="koboSpan" id="kobo.730.1">number of standpoints. </span><span class="koboSpan" id="kobo.730.2">We can consider every closing price as an independent value of a random process, or we can look at price movements as a random walk process, where we’re interested only in how much the price changed since the last observation (bar). </span><span class="koboSpan" id="kobo.730.3">So instead of calculating the standard deviation of </span><em class="italic"><span class="koboSpan" id="kobo.731.1">closing prices</span></em><span class="koboSpan" id="kobo.732.1">, we should rather calculate the standard deviation of </span><em class="italic"><span class="koboSpan" id="kobo.733.1">changes in price</span></em><span class="koboSpan" id="kobo.734.1"> for </span><span class="No-Break"><span class="koboSpan" id="kobo.735.1">each bar:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer057">
<span class="koboSpan" id="kobo.736.1"><img alt="" src="image/Formula_B19145_07_012.jpg"/></span>
</div>
</div>
<p><span class="koboSpan" id="kobo.737.1">Here, </span><em class="italic"><span class="koboSpan" id="kobo.738.1">C</span></em><span class="subscript"><span class="koboSpan" id="kobo.739.1">i</span></span><span class="koboSpan" id="kobo.740.1"> means the current bar, </span><em class="italic"><span class="koboSpan" id="kobo.741.1">C</span></em><span class="subscript"><span class="koboSpan" id="kobo.742.1">i-1</span></span><span class="koboSpan" id="kobo.743.1"> means the previous bar, and the delta symbol means the price increment per bar (positive or negative – and this is the key difference from calculating standard deviations for prices, as they can only </span><span class="No-Break"><span class="koboSpan" id="kobo.744.1">be positive).</span></span></p>
<p><span class="koboSpan" id="kobo.745.1">Let’s see whether there’s any difference between the standard deviation of closing prices and the standard deviation of </span><em class="italic"><span class="koboSpan" id="kobo.746.1">differences</span></em><span class="koboSpan" id="kobo.747.1"> of closing prices. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.748.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.749.1">.11</span></em><span class="koboSpan" id="kobo.750.1"> still shows the same chart of GBPUSD with both standard deviations plotted </span><span class="No-Break"><span class="koboSpan" id="kobo.751.1">below it:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer058">
<span class="koboSpan" id="kobo.752.1"><img alt="Figure 7.11 – Two versions of the standard deviation-based volatility indicator" src="image/B19145_7_11.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.753.1">Figure 7.11 – Two versions of the standard deviation-based volatility indicator</span></p>
<p><span class="koboSpan" id="kobo.754.1">The </span><a id="_idIndexMarker447"/><span class="koboSpan" id="kobo.755.1">difference is pathetic! </span><span class="koboSpan" id="kobo.755.2">There are no longer </span><em class="italic"><span class="koboSpan" id="kobo.756.1">smooth</span></em><span class="koboSpan" id="kobo.757.1"> changes in </span><a id="_idIndexMarker448"/><span class="koboSpan" id="kobo.758.1">volatility. </span><span class="koboSpan" id="kobo.758.2">Instead, we observe periods of high and low volatility abruptly switching from one to another. </span><span class="koboSpan" id="kobo.758.3">Now the picture is more adequate to what we observe in the </span><span class="No-Break"><span class="koboSpan" id="kobo.759.1">market itself:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.760.1">Sharp price movements always and immediately cause our volatility indicator </span><span class="No-Break"><span class="koboSpan" id="kobo.761.1">to jump</span></span></li>
<li><span class="koboSpan" id="kobo.762.1">High volatility often means a reversal </span><span class="No-Break"><span class="koboSpan" id="kobo.763.1">in price</span></span></li>
<li><span class="koboSpan" id="kobo.764.1">Longer-term trends (the right part of the chart) are accompanied by low </span><span class="No-Break"><span class="koboSpan" id="kobo.765.1">volatility (surprise!)</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.766.1">The fact that sharp price movements cause volatility to also increase sharply is used in </span><em class="italic"><span class="koboSpan" id="kobo.767.1">volatility breakout</span></em><span class="koboSpan" id="kobo.768.1"> strategies; the idea is buying or selling the asset in the direction of the already started </span><a id="_idIndexMarker449"/><span class="koboSpan" id="kobo.769.1">sharp price movement. </span><span class="koboSpan" id="kobo.769.2">And the fact that the volatility is relatively low during</span><a id="_idIndexMarker450"/><span class="koboSpan" id="kobo.770.1"> trends is used in various </span><em class="italic"><span class="koboSpan" id="kobo.771.1">trend-following</span></em><span class="koboSpan" id="kobo.772.1"> or </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.773.1">mean-reversion</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.774.1"> strategies.</span></span></p>
<p><span class="koboSpan" id="kobo.775.1">Our study on volatility would definitely be incomplete without one of the most well-known and popular TA indicators, </span><span class="No-Break"><span class="koboSpan" id="kobo.776.1">Bollinger bands.</span></span></p>
<h3><span class="koboSpan" id="kobo.777.1">Bollinger bands</span></h3>
<p><span class="koboSpan" id="kobo.778.1">This</span><a id="_idIndexMarker451"/><span class="koboSpan" id="kobo.779.1"> indicator was introduced by John Bollinger in the 1980s. </span><span class="koboSpan" id="kobo.779.2">The idea</span><a id="_idIndexMarker452"/><span class="koboSpan" id="kobo.780.1"> is to determine whether the price of an asset lies outside of the </span><em class="italic"><span class="koboSpan" id="kobo.781.1">normal</span></em><span class="koboSpan" id="kobo.782.1"> range. </span><span class="koboSpan" id="kobo.782.2">In this indicator, the </span><em class="italic"><span class="koboSpan" id="kobo.783.1">normal</span></em><span class="koboSpan" id="kobo.784.1"> range is defined as the mean value plus or minus two standard deviations (or two </span><em class="italic"><span class="koboSpan" id="kobo.785.1">sigma</span></em><span class="koboSpan" id="kobo.786.1">). </span><span class="koboSpan" id="kobo.786.2">Therefore, Bollinger bands consist of </span><em class="italic"><span class="koboSpan" id="kobo.787.1">two</span></em><span class="koboSpan" id="kobo.788.1"> lines, one always going above the price (</span><em class="italic"><span class="koboSpan" id="kobo.789.1">B+</span></em><span class="koboSpan" id="kobo.790.1">) and the other, always </span><span class="No-Break"><span class="koboSpan" id="kobo.791.1">below (</span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.792.1">B-</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.793.1">):</span></span></p>
<p><span class="No-Break"><span class="koboSpan" id="kobo.794.1">B+ =</span><span class="koboSpan" id="kobo.795.1"><img alt="" src="image/Formula_B19145_07_013.png"/></span></span></p>
<p><span class="koboSpan" id="kobo.796.1">B- = </span><span class="koboSpan" id="kobo.797.1"><img alt="" src="image/Formula_B19145_07_014.png"/></span></p>
<p><span class="koboSpan" id="kobo.798.1">Why two </span><em class="italic"><span class="koboSpan" id="kobo.799.1">stddev</span></em><span class="koboSpan" id="kobo.800.1">, not one? </span><span class="koboSpan" id="kobo.800.2">If you want to learn the correct, formal answer, I would recommend that you refer to any book on mathematical statistics or the same Wikipedia article as earlier. </span><span class="koboSpan" id="kobo.800.3">Without going into details, let us just take it for granted that for a stochastic process, 90% of data points fall into the mean </span><em class="italic"><span class="koboSpan" id="kobo.801.1">± 2</span></em><span class="koboSpan" id="kobo.802.1"> sigma range. </span><span class="koboSpan" id="kobo.802.2">So, the idea of Bollinger bands is that drawing lines in a </span><em class="italic"><span class="koboSpan" id="kobo.803.1">2</span></em><span class="koboSpan" id="kobo.804.1"> sigma distance from the mean could help isolate outliers – that is, the prices that lie outside the </span><em class="italic"><span class="koboSpan" id="kobo.805.1">±2</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.806.1">stddev range.</span></span></p>
<p><span class="koboSpan" id="kobo.807.1">Let’s see what it looks like in reality. </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.808.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.809.1">.12</span></em><span class="koboSpan" id="kobo.810.1"> shows a 1-minute chart of AUDUSD with 20-period Bollinger bands </span><span class="No-Break"><span class="koboSpan" id="kobo.811.1">on it:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer061">
<span class="koboSpan" id="kobo.812.1"><img alt="Figure 7.12 – 1-minute chart of AUDUSD with Bollinger bands﻿" src="image/B19145_7_12.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.813.1">Figure 7.12 – 1-minute chart of AUDUSD with Bollinger bands</span></p>
<p><span class="koboSpan" id="kobo.814.1">This chart </span><a id="_idIndexMarker453"/><span class="koboSpan" id="kobo.815.1">represents the mean or moving average (solid line in the middle) and two Bollinger bands (gray lines above and below). </span><span class="koboSpan" id="kobo.815.2">Bold black dots mark the closing prices that lie above the upper band or below the lower band. </span><span class="koboSpan" id="kobo.815.3">Both </span><span class="No-Break"><span class="koboSpan" id="kobo.816.1">are </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.817.1">outliers</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.818.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.819.1">Technical traders use </span><a id="_idIndexMarker454"/><span class="koboSpan" id="kobo.820.1">Bollinger bands for various purposes as other TA indicators as </span><span class="No-Break"><span class="koboSpan" id="kobo.821.1">well, though:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.822.1">Outliers can be interpreted as breakouts – moments when the price starts its movement to a certain direction – so can be used in strategies that attempt to buy or sell </span><em class="italic"><span class="koboSpan" id="kobo.823.1">along with</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.824.1">the movement</span></span></li>
<li><span class="koboSpan" id="kobo.825.1">Outliers can be interpreted as liquidity issues and thus considered as good points for mean reversion – so can be used as entry points to buy or sell </span><em class="italic"><span class="koboSpan" id="kobo.826.1">against</span></em><span class="koboSpan" id="kobo.827.1"> the current </span><span class="No-Break"><span class="koboSpan" id="kobo.828.1">price movement</span></span></li>
</ul>
<h2 id="_idParaDest-120"><a id="_idTextAnchor121"/><span class="koboSpan" id="kobo.829.1">Key takeaways – what TA indicators are all about and how to use them</span></h2>
<p><span class="koboSpan" id="kobo.830.1">The world of technical indicators is really vast. </span><span class="koboSpan" id="kobo.830.2">However, most of them are just variations of the same old classical indicators of the four </span><span class="No-Break"><span class="koboSpan" id="kobo.831.1">main types:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.832.1">Momentum, or </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.833.1">market speed</span></em></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.834.1">Digital filters</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.835.1">Range</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.836.1">Volatility</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.837.1">Don’t forget this when you stumble upon a new </span><em class="italic"><span class="koboSpan" id="kobo.838.1">unique</span></em><span class="koboSpan" id="kobo.839.1"> indicator that promises </span><em class="italic"><span class="koboSpan" id="kobo.840.1">fantastic</span></em><span class="koboSpan" id="kobo.841.1"> results. </span><span class="koboSpan" id="kobo.841.2">Give it a thorough examination first and you will see what it </span><span class="No-Break"><span class="koboSpan" id="kobo.842.1">actually shows.</span></span></p>
<p><span class="koboSpan" id="kobo.843.1">Don’t forget that no indicator can build you a robust trading strategy. </span><span class="koboSpan" id="kobo.843.2">They serve only to quantitatively identify various situations in the market, and it is still up to you as the trading strategy developer how you actually exploit these situations in the logic of </span><span class="No-Break"><span class="koboSpan" id="kobo.844.1">your code.</span></span></p>
<p><span class="koboSpan" id="kobo.845.1">Now, it’s time to see how we can implement technical indicators in native </span><span class="No-Break"><span class="koboSpan" id="kobo.846.1">Python code.</span></span></p>
<h1 id="_idParaDest-121"><a id="_idTextAnchor122"/><span class="koboSpan" id="kobo.847.1">Implementation of TA indicators in Python</span></h1>
<p><span class="koboSpan" id="kobo.848.1">I am sure you </span><a id="_idIndexMarker455"/><span class="koboSpan" id="kobo.849.1">remember that any TA indicator uses a certain period as a parameter. </span><span class="koboSpan" id="kobo.849.2">This period means a number of data points that we take into consideration. </span><span class="koboSpan" id="kobo.849.3">To calculate an indicator on every bar, we start from the oldest one (the leftmost on the chart) and then move one by one, updating our dataset with each </span><span class="No-Break"><span class="koboSpan" id="kobo.850.1">new bar.</span></span></p>
<p><span class="koboSpan" id="kobo.851.1">Since we are talking about an absolutely essential thing that lies in the foundation of all TA, let me be very detailed here – probably too detailed – but I want to leave no place for ambiguity or misunderstanding in the following concepts and </span><span class="No-Break"><span class="koboSpan" id="kobo.852.1">code samples.</span></span></p>
<p><span class="koboSpan" id="kobo.853.1">Let’s start with the core concept of time series processing: the </span><span class="No-Break"><span class="koboSpan" id="kobo.854.1">sliding window.</span></span></p>
<h2 id="_idParaDest-122"><a id="_idTextAnchor123"/><span class="koboSpan" id="kobo.855.1">Sliding windows</span></h2>
<p><span class="koboSpan" id="kobo.856.1">Let’s go</span><a id="_idIndexMarker456"/><span class="koboSpan" id="kobo.857.1"> back to the example of a random walk (around bars and movies) that we considered in the previous section. </span><span class="koboSpan" id="kobo.857.2">The entire dataset, or historical data, consists of 10 </span><span class="No-Break"><span class="koboSpan" id="kobo.858.1">data points:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.859.1">
S1 = {0.7, 2, 1.5, 0.3, 2.6, 1.1, 1.8, 0.45, 3.1, 2.9}</span></pre>
<p><span class="koboSpan" id="kobo.860.1">Now, if we are interested in analyzing the activity only for the last 3 days, then we get the </span><span class="No-Break"><span class="koboSpan" id="kobo.861.1">following subsets:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.862.1">
S1_1 = {0.7, 2, 1.5}
S1_2 = {2, 1.5, 0.3}
...
</span><span class="koboSpan" id="kobo.862.2">S1_8 = {0.45, 3.1, 2.9}</span></pre>
<p><span class="koboSpan" id="kobo.863.1">Then, we apply a TA indicator to each subset, one by one, left to right, older </span><span class="No-Break"><span class="koboSpan" id="kobo.864.1">to newer.</span></span></p>
<p><span class="koboSpan" id="kobo.865.1">This</span><a id="_idIndexMarker457"/><span class="koboSpan" id="kobo.866.1"> technique is known as the </span><strong class="bold"><span class="koboSpan" id="kobo.867.1">sliding window</span></strong><span class="koboSpan" id="kobo.868.1">, and is the cornerstone of all technical trading, from plotting simple indicators to backtesting </span><span class="No-Break"><span class="koboSpan" id="kobo.869.1">and optimization.</span></span></p>
<h2 id="_idParaDest-123"><a id="_idTextAnchor124"/><span class="koboSpan" id="kobo.870.1">Peeking ahead</span></h2>
<p><span class="koboSpan" id="kobo.871.1">The</span><a id="_idIndexMarker458"/><span class="koboSpan" id="kobo.872.1"> main problem of working with</span><a id="_idIndexMarker459"/><span class="koboSpan" id="kobo.873.1"> historical data while using sliding windows is the potential ability to </span><em class="italic"><span class="koboSpan" id="kobo.874.1">peek ahead</span></em><span class="koboSpan" id="kobo.875.1">, or look into the future (see </span><a href="B19145_04.xhtml#_idTextAnchor073"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.876.1">Chapter 4</span></em></span></a><span class="koboSpan" id="kobo.877.1">, </span><em class="italic"><span class="koboSpan" id="kobo.878.1">Trading Application – What’s Inside?</span></em><span class="koboSpan" id="kobo.879.1">, in the </span><em class="italic"><span class="koboSpan" id="kobo.880.1">Trading logic – this is where a small mistake may cost a fortune</span></em><span class="koboSpan" id="kobo.881.1"> section, for the discussion on the peeking ahead issue). </span><span class="koboSpan" id="kobo.881.2">If we reconstruct your random walk movements from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.882.1">S1</span></strong><span class="koboSpan" id="kobo.883.1"> dataset (see the </span><em class="italic"><span class="koboSpan" id="kobo.884.1">Stochastic oscillator</span></em><span class="koboSpan" id="kobo.885.1"> section in this chapter), we should take particular care about </span><em class="italic"><span class="koboSpan" id="kobo.886.1">not</span></em><span class="koboSpan" id="kobo.887.1"> using data from </span><em class="italic"><span class="koboSpan" id="kobo.888.1">tomorrow</span></em><span class="koboSpan" id="kobo.889.1"> when we analyze what happened </span><em class="italic"><span class="koboSpan" id="kobo.890.1">today</span></em><span class="koboSpan" id="kobo.891.1">. </span><span class="koboSpan" id="kobo.891.2">Let’s add dates to our data samples to give them </span><span class="No-Break"><span class="koboSpan" id="kobo.892.1">more clarity:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.893.1">
S1 =  {{01/01/2001,0.7}
      {01/02/2001, 2}
      {01/03/2001, 1.5}
      {01/04/2001, 0.3}
      {01/05/2001, 2.6}
      {01/06/2001, 1.1}
      {01/07/2001, 1.8}
      {01/08/2001, 0.45}
      {01/09/2001, 3.1}
      {01/10/2001, 2.9}}</span></pre>
<p><span class="koboSpan" id="kobo.894.1">If we</span><a id="_idIndexMarker460"/><span class="koboSpan" id="kobo.895.1"> reconstruct what happened on or before January 6, 2001, we are allowed to take into consideration only data from the prior period. </span><span class="koboSpan" id="kobo.895.2">We </span><em class="italic"><span class="koboSpan" id="kobo.896.1">cannot, should not, and have no right</span></em><span class="koboSpan" id="kobo.897.1"> to use data from January 7 or later. </span><span class="koboSpan" id="kobo.897.2">If we do, we face this </span><span class="No-Break"><span class="koboSpan" id="kobo.898.1">peek-ahead issue.</span></span></p>
<p><span class="koboSpan" id="kobo.899.1">Now, imagine</span><a id="_idIndexMarker461"/><span class="koboSpan" id="kobo.900.1"> that you’re developing a trading strategy and want to test it using past data. </span><span class="koboSpan" id="kobo.900.2">The goal of such a test is to reconstruct what </span><em class="italic"><span class="koboSpan" id="kobo.901.1">would have happened</span></em><span class="koboSpan" id="kobo.902.1"> on that particular day at that particular time </span><em class="italic"><span class="koboSpan" id="kobo.903.1">if</span></em><span class="koboSpan" id="kobo.904.1"> your strategy actually worked then. </span><span class="koboSpan" id="kobo.904.2">If you reconstruct what your strategy would have done on January 6, you have no right to peek ahead and use data from January 7, even 1 second past the test date, because you have no time machine (or so I assume) and when you run your strategy </span><em class="italic"><span class="koboSpan" id="kobo.905.1">live</span></em><span class="koboSpan" id="kobo.906.1">, you will be also unable to retrieve data from </span><span class="No-Break"><span class="koboSpan" id="kobo.907.1">the future.</span></span></p>
<p><span class="koboSpan" id="kobo.908.1">However, peeking ahead is, surprisingly, quite a common mistake, and this is why I go into so much detail on this issue here. </span><span class="koboSpan" id="kobo.908.2">Remember that </span><em class="italic"><span class="koboSpan" id="kobo.909.1">if your strategy delivers unrealistically good returns, then most likely, they are indeed not realistic and are caused by </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.910.1">peeking ahead.</span></em></span></p>
<p><span class="koboSpan" id="kobo.911.1">How is it possible to peek ahead non-intentionally, occasionally? </span><span class="koboSpan" id="kobo.911.2">Well, it’s very easy if you store price time series in a list or any similar iterable structure, and retrieve data to do calculations by an index. </span><span class="koboSpan" id="kobo.911.3">In the previous example, I can get data from January 7 while testing a strategy for January 6 simply by calling </span><strong class="source-inline"><span class="koboSpan" id="kobo.912.1">S1[4:7]</span></strong><span class="koboSpan" id="kobo.913.1">. </span><span class="koboSpan" id="kobo.913.2">Even if you use dictionaries, you can get erroneous data by retrieving it with an incorrectly specified </span><span class="No-Break"><span class="koboSpan" id="kobo.914.1">datetime index.</span></span></p>
<p><span class="koboSpan" id="kobo.915.1">But having said all that, is there a method to guarantee that your code will never try to retrieve data from the future? </span><span class="koboSpan" id="kobo.915.2">Let’s </span><span class="No-Break"><span class="koboSpan" id="kobo.916.1">find out!</span></span></p>
<h2 id="_idParaDest-124"><a id="_idTextAnchor125"/><span class="koboSpan" id="kobo.917.1">The ultimate solution to the peek-ahead issue</span></h2>
<p><span class="koboSpan" id="kobo.918.1">To </span><a id="_idIndexMarker462"/><span class="koboSpan" id="kobo.919.1">suggest such a solution, we should recall that when we use </span><em class="italic"><span class="koboSpan" id="kobo.920.1">live</span></em><span class="koboSpan" id="kobo.921.1"> data, we are physically unable to get data from the</span><a id="_idIndexMarker463"/><span class="koboSpan" id="kobo.922.1"> future because ticks or any other data packets arrive at your trading application one by one. </span><span class="koboSpan" id="kobo.922.2">So, if we want to fully guarantee no peeking ahead during the testing phase of the development, we may want to emulate the very incoming data stream and write the rest of the code as if we plan to work with live data, not historical data stored </span><span class="No-Break"><span class="koboSpan" id="kobo.923.1">on disk.</span></span></p>
<p><span class="koboSpan" id="kobo.924.1">The first step toward this universal architecture was made in </span><a href="B19145_05.xhtml#_idTextAnchor086"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.925.1">Chapter 5</span></em></span></a><span class="koboSpan" id="kobo.926.1">, </span><em class="italic"><span class="koboSpan" id="kobo.927.1">Retrieving and Handling Market Data with Python</span></em><span class="koboSpan" id="kobo.928.1">, where we suggested using queues and threads to accommodate for receiving large amounts of incoming ticks. </span><span class="koboSpan" id="kobo.928.2">Now, let’s look at the problem of calculating TA indicators from the </span><span class="No-Break"><span class="koboSpan" id="kobo.929.1">same standpoint.</span></span></p>
<p><span class="koboSpan" id="kobo.930.1">I’m sure you remember that </span><em class="italic"><span class="koboSpan" id="kobo.931.1">any</span></em><span class="koboSpan" id="kobo.932.1"> TA indicator analyzes a subset of price time series, and the length of this subset is</span><a id="_idIndexMarker464"/><span class="koboSpan" id="kobo.933.1"> called a </span><strong class="bold"><span class="koboSpan" id="kobo.934.1">period</span></strong><span class="koboSpan" id="kobo.935.1">. </span><span class="koboSpan" id="kobo.935.2">When we looked at charts, we always noted that for the reconstruction of the indicator’s values on historical price data, we need to move this period from left to right, from the oldest to the newest data points. </span><span class="koboSpan" id="kobo.935.3">We called this approach a </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.936.1">sliding window</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.937.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.938.1">But now let’s think about what we should do in case we try to build the indicator’s values </span><em class="italic"><span class="koboSpan" id="kobo.939.1">on the fly</span></em><span class="koboSpan" id="kobo.940.1">, live, as market data is coming in. </span><span class="koboSpan" id="kobo.940.2">There’s no history, no stored values, only live ticks. </span><span class="koboSpan" id="kobo.940.3">So how can we create such a </span><span class="No-Break"><span class="koboSpan" id="kobo.941.1">sliding window?</span></span></p>
<p><span class="koboSpan" id="kobo.942.1">The answer is obvious: we do create a </span><em class="italic"><span class="koboSpan" id="kobo.943.1">window</span></em><span class="koboSpan" id="kobo.944.1">, but we don’t create a </span><em class="italic"><span class="koboSpan" id="kobo.945.1">sliding</span></em><span class="koboSpan" id="kobo.946.1"> window because there’s nothing to </span><span class="No-Break"><span class="koboSpan" id="kobo.947.1">slide on.</span></span></p>
<p><span class="koboSpan" id="kobo.948.1">Let’s recall how a queue works (see also </span><a href="B19145_05.xhtml#_idTextAnchor086"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.949.1">Chapter 5</span></em></span></a><span class="koboSpan" id="kobo.950.1">, </span><em class="italic"><span class="koboSpan" id="kobo.951.1">Retrieving and Handling Market Data with Python</span></em><span class="koboSpan" id="kobo.952.1">). </span><span class="koboSpan" id="kobo.952.2">Generally speaking, a queue is a list with the </span><span class="No-Break"><span class="koboSpan" id="kobo.953.1">following properties:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.954.1">When a new element comes in, it is added to the end of </span><span class="No-Break"><span class="koboSpan" id="kobo.955.1">the queue</span></span></li>
<li><span class="koboSpan" id="kobo.956.1">When we retrieve an element from the queue, it is taken from the beginning </span><span class="No-Break"><span class="koboSpan" id="kobo.957.1">and removed</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.958.1">Now, let’s create a special queue where the oldest elements (those at the beginning) are not retrieved, but automatically removed as soon as a new element is added. </span><span class="koboSpan" id="kobo.958.2">Let’s look at the diagram in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.959.1">Figure 7</span></em></span><em class="italic"><span class="koboSpan" id="kobo.960.1">.13</span></em><span class="koboSpan" id="kobo.961.1"> to see how </span><span class="No-Break"><span class="koboSpan" id="kobo.962.1">it works:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer062">
<span class="koboSpan" id="kobo.963.1"><img alt="Figure 7.13 – Queue with a fixed length and automatic removal of the oldest element upon arrival of a new element" src="image/B19145_7_13.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.964.1">Figure 7.13 – Queue with a fixed length and automatic removal of the oldest element upon arrival of a new element</span></p>
<p><span class="koboSpan" id="kobo.965.1">Now, let’s </span><a id="_idIndexMarker465"/><span class="koboSpan" id="kobo.966.1">start filling this queue with</span><a id="_idIndexMarker466"/><span class="koboSpan" id="kobo.967.1"> price time series, starting from the oldest data points. </span><span class="koboSpan" id="kobo.967.2">What do we </span><span class="No-Break"><span class="koboSpan" id="kobo.968.1">get then?</span></span></p>
<p><span class="koboSpan" id="kobo.969.1">Let’s do it with our </span><strong class="source-inline"><span class="koboSpan" id="kobo.970.1">S1</span></strong><span class="koboSpan" id="kobo.971.1"> sample data from the preceding example. </span><span class="koboSpan" id="kobo.971.2">Imagine that we created such a queue with a length of three. </span><span class="koboSpan" id="kobo.971.3">Then, we start pushing data points to this queue, removing the oldest points as new points come in. </span><span class="koboSpan" id="kobo.971.4">We will get the </span><span class="No-Break"><span class="koboSpan" id="kobo.972.1">following subsets:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.973.1">
S1_1 = {{01/01/2001,0.7}
      {01/02/2001, 2}
      {01/03/2001, 1.5}}
S1_2 = {{01/02/2001, 2}
      {01/03/2001, 1.5}
      {01/04/2001, 0.3}}
S1_3 = {{01/03/2001, 1.5}
      {01/04/2001, 0.3}
      {01/05/2001, 2.6}}
...</span></pre>
<p><span class="koboSpan" id="kobo.974.1">And </span><span class="No-Break"><span class="koboSpan" id="kobo.975.1">so on.</span></span></p>
<p><span class="koboSpan" id="kobo.976.1">What are these </span><span class="No-Break"><span class="koboSpan" id="kobo.977.1">subsets now?</span></span></p>
<p><span class="koboSpan" id="kobo.978.1">Wow, these are exactly what we got using a </span><span class="No-Break"><span class="koboSpan" id="kobo.979.1">sliding window!</span></span></p>
<p><span class="koboSpan" id="kobo.980.1">Now, instead </span><a id="_idIndexMarker467"/><span class="koboSpan" id="kobo.981.1">of storing data in a database or any other storage and then retrieving it for the purpose of building a TA indicator, we do that </span><em class="italic"><span class="koboSpan" id="kobo.982.1">on the fly</span></em><span class="koboSpan" id="kobo.983.1"> as new data is coming in. </span><span class="koboSpan" id="kobo.983.2">In this case, we will never be able to peek ahead because we will never be able to receive data from the future. </span><span class="koboSpan" id="kobo.983.3">All we need to do is emulate the data feed using </span><span class="No-Break"><span class="koboSpan" id="kobo.984.1">historical data.</span></span></p>
<p><span class="koboSpan" id="kobo.985.1">This solution has another </span><a id="_idIndexMarker468"/><span class="koboSpan" id="kobo.986.1">evident and huge benefit: if we develop our application using an emulated data feed, then we can switch to a live data feed </span><em class="italic"><span class="koboSpan" id="kobo.987.1">without changing a single line of code</span></em><span class="koboSpan" id="kobo.988.1">. </span><span class="koboSpan" id="kobo.988.2">So, this approach not only guarantees that the results of our tests are always honest but also that we save a massive amount of time by developing a </span><em class="italic"><span class="koboSpan" id="kobo.989.1">universal</span></em><span class="koboSpan" id="kobo.990.1"> application from the </span><span class="No-Break"><span class="koboSpan" id="kobo.991.1">very beginning.</span></span></p>
<p><span class="koboSpan" id="kobo.992.1">Enough talk, let’s get </span><span class="No-Break"><span class="koboSpan" id="kobo.993.1">to coding.</span></span></p>
<h2 id="_idParaDest-125"><a id="_idTextAnchor126"/><span class="koboSpan" id="kobo.994.1">Sliding window as a queue</span></h2>
<p><span class="koboSpan" id="kobo.995.1">Now, we’re</span><a id="_idIndexMarker469"/><span class="koboSpan" id="kobo.996.1"> ready to implement </span><a id="_idIndexMarker470"/><span class="koboSpan" id="kobo.997.1">the sliding window using a </span><span class="No-Break"><span class="koboSpan" id="kobo.998.1">Python queue:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.999.1">Let’s create a class for our sliding </span><span class="No-Break"><span class="koboSpan" id="kobo.1000.1">windows first:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1001.1">
class sliding_window:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1002.1">
    def __init__(self, length):</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1003.1">
        self.data = ([0]*length)</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.1004.1">Here, we create a container for our sliding window and fill it </span><span class="No-Break"><span class="koboSpan" id="kobo.1005.1">with zeros.</span></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.1006.1">Now, let’s add the only method that appends a new element to this window and immediately deletes the </span><span class="No-Break"><span class="koboSpan" id="kobo.1007.1">oldest one:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1008.1">
    def add(self, element):</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1009.1">
        self.data.append(element)</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1010.1">
        self.data.pop(0)</span></pre></li>
<li><span class="koboSpan" id="kobo.1011.1">Now, create </span><a id="_idIndexMarker471"/><span class="koboSpan" id="kobo.1012.1">an instance</span><a id="_idIndexMarker472"/><span class="koboSpan" id="kobo.1013.1"> of this class with a length of just </span><strong class="source-inline"><span class="koboSpan" id="kobo.1014.1">5</span></strong><span class="koboSpan" id="kobo.1015.1"> (for </span><span class="No-Break"><span class="koboSpan" id="kobo.1016.1">demo purposes):</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1017.1">
sw = sliding_window(5)</span></pre></li>
</ol>
<p><span class="No-Break"><span class="koboSpan" id="kobo.1018.1">That’s it!</span></span></p>
<ol>
<li value="4"><span class="koboSpan" id="kobo.1019.1">Now, let’s use the code that we created in </span><a href="B19145_05.xhtml#_idTextAnchor086"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1020.1">Chapter 5</span></em></span></a><span class="koboSpan" id="kobo.1021.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1022.1">Retrieving and Handling Market Data with Python</span></em><span class="koboSpan" id="kobo.1023.1">. </span><span class="koboSpan" id="kobo.1023.2">It already contains the global queue (data stream) that can be used to transfer any data from any object or module to any other. </span><span class="koboSpan" id="kobo.1023.3">All we want now is to add two functions: one that reads data from a compressed file (bars) and sends it to the global data stream, and the other that reads bars from this data stream and pushes them to the </span><span class="No-Break"><span class="koboSpan" id="kobo.1024.1">sliding window:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1025.1">
def get_sample(f):</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1026.1">
    sample = {}</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1027.1">
    values = f.readline().rstrip("\n").split(",")</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1028.1">
    timestamp_string = "0" + values[0] + " " + values[1]</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1029.1">
    ts = datetime.strptime(timestamp_string, "%m/%d/%Y %H:%M:%S")</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1030.1">
    sample["open"] = float(values[2])</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1031.1">
    sample["high"] = float(values[3])</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1032.1">
    sample["low"]  = float(values[4])</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1033.1">
    sample["close"]= float(values[5])</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1034.1">
    sample["UpVolume"] = int(values[6])</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1035.1">
    sample["DownVolume"] = int(values[7])</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1036.1">
    sample["Datetime"] = ts</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1037.1">
    return sample</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.1038.1">You can see that we have completely reused the function that we created in </span><a href="B19145_05.xhtml#_idTextAnchor086"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1039.1">Chapter 5</span></em></span></a><span class="koboSpan" id="kobo.1040.1">, </span><em class="italic"><span class="koboSpan" id="kobo.1041.1">Retrieving and Handling Market Data with Python</span></em><span class="koboSpan" id="kobo.1042.1">, when we learned how </span><a id="_idIndexMarker473"/><span class="koboSpan" id="kobo.1043.1">to handle data stored in files. </span><span class="koboSpan" id="kobo.1043.2">Here, we read a bar from a CSV ASCII file, parse it, and convert it into </span><span class="No-Break"><span class="koboSpan" id="kobo.1044.1">a dictionary.</span></span></p>
<ol>
<li value="5"><span class="koboSpan" id="kobo.1045.1">Now, let’s </span><a id="_idIndexMarker474"/><span class="koboSpan" id="kobo.1046.1">send this sample to the </span><span class="No-Break"><span class="koboSpan" id="kobo.1047.1">global queue:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1048.1">
def emulate_bar_stream():</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1049.1">
    while True:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1050.1">
        time.sleep(1)</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1051.1">
        datastream.put(get_sample(f))</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.1052.1">Again, this is similar to what we did in the previous chapter, the only difference is that we now use a different function that gets data from a file. </span><span class="koboSpan" id="kobo.1052.2">Anyway, the result is the same: we put the new sample into the global </span><span class="No-Break"><span class="koboSpan" id="kobo.1053.1">data stream.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.1054.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.1055.1">Don’t forget that the delay here is added only for the sake of debugging and demonstration to emulate samples arriving at the application one </span><span class="No-Break"><span class="koboSpan" id="kobo.1056.1">by one.</span></span></p>
<p><span class="koboSpan" id="kobo.1057.1">Now, we have finished the code that emulates the incoming data. </span><span class="koboSpan" id="kobo.1057.2">Let’s look at it: any code written from this point and retrieving data from the global queue will be </span><em class="italic"><span class="koboSpan" id="kobo.1058.1">independent</span></em><span class="koboSpan" id="kobo.1059.1"> of any particular data source. </span><span class="koboSpan" id="kobo.1059.2">If you want to replace the source or</span><a id="_idIndexMarker475"/><span class="koboSpan" id="kobo.1060.1"> switch from testing to live trading, then all you need to do is to re-write the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1061.1">emulate_bar_stream()</span></strong><span class="koboSpan" id="kobo.1062.1"> function. </span><span class="koboSpan" id="kobo.1062.2">The rest of the code will </span><span class="No-Break"><span class="koboSpan" id="kobo.1063.1">remain unchanged.</span></span></p>
<p><span class="koboSpan" id="kobo.1064.1">Finally, we need a function that reads from the global data queue and does </span><span class="No-Break"><span class="koboSpan" id="kobo.1065.1">something meaningful.</span></span></p>
<ol>
<li value="6"><span class="koboSpan" id="kobo.1066.1">In our </span><a id="_idIndexMarker476"/><span class="koboSpan" id="kobo.1067.1">present case, we will take only the closing price of the bar, push it to the sliding window, and then call any function that calculates a </span><span class="No-Break"><span class="koboSpan" id="kobo.1068.1">TA indicator:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1069.1">
def retrieve_bars():</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1070.1">
    while True:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1071.1">
        sw.add(datastream.get()["close"])</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1072.1">
        # calling a TA indicator function here</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1073.1">
        print(sw.data)</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.1074.1">Making output to the console from a function is definitely a bad practice, but it’s added here only temporarily, to quickly check the correctness of the code </span><span class="No-Break"><span class="koboSpan" id="kobo.1075.1">during debugging.</span></span></p>
<ol>
<li value="7"><span class="koboSpan" id="kobo.1076.1">Now, let’s start two threads: one that reads data from a file (or, in the future, from any other source) and the other that processes the received data. </span><span class="koboSpan" id="kobo.1076.2">Don’t forget to import the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1077.1">threading</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1078.1"> module:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1079.1">
import threading</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1080.1">
data_source_thread = threading.Thread(target = emulate_bar_stream)</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1081.1">
data_receiver_thread = threading.Thread(target = retrieve_bars)</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1082.1">
data_source_thread.start()</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1083.1">
data_receiver_thread.start()</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.1084.1">If you did everything correctly, you should see something like this in </span><span class="No-Break"><span class="koboSpan" id="kobo.1085.1">the console:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1086.1">
[0, 0, 0, 0, 1.12949]
[0, 0, 0, 1.12949, 1.12941]
[0, 0, 1.12949, 1.12941, 1.12965]
[0, 1.12949, 1.12941, 1.12965, 1.12883]
[1.12949, 1.12941, 1.12965, 1.12883, 1.12894]
[1.12941, 1.12965, 1.12883, 1.12894, 1.12925]</span></pre>
<p><span class="koboSpan" id="kobo.1087.1">You can see </span><a id="_idIndexMarker477"/><span class="koboSpan" id="kobo.1088.1">now how our sliding window is </span><a id="_idIndexMarker478"/><span class="koboSpan" id="kobo.1089.1">being filled with values from right to left, pushing older values out – </span><em class="italic"><span class="koboSpan" id="kobo.1090.1">exactly</span></em><span class="koboSpan" id="kobo.1091.1"> like a bar or tick chart on screen. </span><span class="koboSpan" id="kobo.1091.2">So at any given moment, we have a </span><em class="italic"><span class="koboSpan" id="kobo.1092.1">ready</span></em><span class="koboSpan" id="kobo.1093.1"> sliding window of the specified length filled with any data we need to calculate an indicator – or to do any other thing we only </span><span class="No-Break"><span class="koboSpan" id="kobo.1094.1">could imagine.</span></span></p>
<p><span class="koboSpan" id="kobo.1095.1">Let’s now see how easily we can build indicators using </span><span class="No-Break"><span class="koboSpan" id="kobo.1096.1">this approach.</span></span></p>
<h2 id="_idParaDest-126"><a id="_idTextAnchor127"/><span class="koboSpan" id="kobo.1097.1">Moving average – implementation</span></h2>
<p><span class="koboSpan" id="kobo.1098.1">To</span><a id="_idIndexMarker479"/><span class="koboSpan" id="kobo.1099.1"> calculate an MA with our </span><a id="_idIndexMarker480"/><span class="koboSpan" id="kobo.1100.1">setup, we only need to calculate an average of all values in </span><span class="No-Break"><span class="koboSpan" id="kobo.1101.1">the window:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1102.1">
def moving_average(data):
    return sum(data) / len(data)</span></pre>
<p><span class="koboSpan" id="kobo.1103.1">It is indeed that simple! </span><span class="koboSpan" id="kobo.1103.2">We don’t have to worry about any parameters because we already specified the length of the sliding window when we instantiated from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1104.1">sliding_window</span></strong><span class="koboSpan" id="kobo.1105.1"> class and specified the type of data (in our example, closing prices) when we fill the window </span><span class="No-Break"><span class="koboSpan" id="kobo.1106.1">with data.</span></span></p>
<p><span class="koboSpan" id="kobo.1107.1">If we run our program now, we will get something like </span><span class="No-Break"><span class="koboSpan" id="kobo.1108.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1109.1">
0.225898
0.45178
0.67771
0.903476
1.129264
1.129216
1.129208</span></pre>
<p><span class="koboSpan" id="kobo.1110.1">This</span><a id="_idIndexMarker481"/><span class="koboSpan" id="kobo.1111.1"> explains why we always </span><a id="_idIndexMarker482"/><span class="koboSpan" id="kobo.1112.1">disregard the first </span><em class="italic"><span class="koboSpan" id="kobo.1113.1">N-1</span></em><span class="koboSpan" id="kobo.1114.1"> values from a sliding window with a length of </span><em class="italic"><span class="koboSpan" id="kobo.1115.1">N</span></em><span class="koboSpan" id="kobo.1116.1">; until </span><em class="italic"><span class="koboSpan" id="kobo.1117.1">all</span></em><span class="koboSpan" id="kobo.1118.1"> elements of the window are filled with meaningful data, the indicator’s value is meaningless and should be ignored. </span><span class="koboSpan" id="kobo.1118.2">So, since in our example </span><em class="italic"><span class="koboSpan" id="kobo.1119.1">N == 5</span></em><span class="koboSpan" id="kobo.1120.1">, we disregard the first </span><span class="No-Break"><span class="koboSpan" id="kobo.1121.1">4 values.</span></span></p>
<h2 id="_idParaDest-127"><a id="_idTextAnchor128"/><span class="koboSpan" id="kobo.1122.1">Stochastic oscillator – implementation</span></h2>
<p><span class="koboSpan" id="kobo.1123.1">Let’s now</span><a id="_idIndexMarker483"/><span class="koboSpan" id="kobo.1124.1"> see how we calculate </span><a id="_idIndexMarker484"/><span class="koboSpan" id="kobo.1125.1">a range indicator like a stochastic oscillator. </span><span class="koboSpan" id="kobo.1125.2">Since this indicator requires three values per bar (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1126.1">high</span></strong><span class="koboSpan" id="kobo.1127.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1128.1">low</span></strong><span class="koboSpan" id="kobo.1129.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1130.1">close</span></strong><span class="koboSpan" id="kobo.1131.1">), we may want to modify our </span><span class="No-Break"><span class="koboSpan" id="kobo.1132.1">code slightly:</span></span></p>
<ol>
<li value="1"><span class="koboSpan" id="kobo.1133.1">First, let’s replace the generic name of our sliding window from </span><strong class="source-inline"><span class="koboSpan" id="kobo.1134.1">sw</span></strong><span class="koboSpan" id="kobo.1135.1"> to </span><strong class="source-inline"><span class="koboSpan" id="kobo.1136.1">close</span></strong><span class="koboSpan" id="kobo.1137.1"> and add two more sliding windows for highs </span><span class="No-Break"><span class="koboSpan" id="kobo.1138.1">and lows:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1139.1">
close = sliding_window(5)</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1140.1">
high = sliding_window(5)</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1141.1">
low = sliding_window(5)</span></pre></li>
<li><span class="koboSpan" id="kobo.1142.1">Now, let’s write the function that calculates the </span><span class="No-Break"><span class="koboSpan" id="kobo.1143.1">stochastic indicator:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1144.1">
def stochastic(high, low, close):</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1145.1">
    max_price = max(high)</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1146.1">
    min_price = min(low)</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1147.1">
    return (close[-1] - min_price) / (max_price - min_price)</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.1148.1">Here, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1149.1">close[-1]</span></strong><span class="koboSpan" id="kobo.1150.1"> stands for the last available closing price (the one we will just receive if we run the code in </span><span class="No-Break"><span class="koboSpan" id="kobo.1151.1">real time).</span></span></p>
<ol>
<li value="3"><span class="koboSpan" id="kobo.1152.1">And </span><a id="_idIndexMarker485"/><span class="koboSpan" id="kobo.1153.1">finally, let’s slightly modify the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1154.1">retrieve_bars()</span></strong><span class="koboSpan" id="kobo.1155.1"> function so it adds data points to all </span><a id="_idIndexMarker486"/><span class="koboSpan" id="kobo.1156.1">three sliding windows (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1157.1">high</span></strong><span class="koboSpan" id="kobo.1158.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.1159.1">low</span></strong><span class="koboSpan" id="kobo.1160.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.1161.1">close</span></strong><span class="koboSpan" id="kobo.1162.1">) and calculates the values of the </span><span class="No-Break"><span class="koboSpan" id="kobo.1163.1">stochastic indicator:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.1164.1">
def retrieve_bars():</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1165.1">
    while True:</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1166.1">
        data_point = datastream.get()</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1167.1">
        close.add(data_point["close"])</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1168.1">
        high.add(data_point["high"])</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1169.1">
        low.add(data_point["low"])</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1170.1">
        ma = moving_average(close.data)</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1171.1">
        stoch = stochastic(high.data, low.data,</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1172.1">
                           close.data)</span></pre><pre class="source-code"><span class="koboSpan" id="kobo.1173.1">
        print(close.data[-1], ma, stoch)</span></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.1174.1">If we run our code now, we will get something similar to </span><span class="No-Break"><span class="koboSpan" id="kobo.1175.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1176.1">
(1.12949, 0.22589800000000002, 0.9999911465250112)
(1.12941, 0.45178, 0.9998406501473985)
(1.12965, 0.67771, 0.9999557404620697)
(1.12883, 0.9034760000000001, 0.9992298840400107)
(1.12894, 1.129264, 0.1914893617022131)
(1.12925, 1.129216, 0.5212765957448215)
(1.12937, 1.129208, 0.6489361702128061)</span></pre>
<p><span class="koboSpan" id="kobo.1177.1">Again, as always, we </span><a id="_idIndexMarker487"/><span class="koboSpan" id="kobo.1178.1">should </span><a id="_idIndexMarker488"/><span class="koboSpan" id="kobo.1179.1">disregard the first </span><em class="italic"><span class="koboSpan" id="kobo.1180.1">N-1</span></em><span class="koboSpan" id="kobo.1181.1"> values, so reasonable readings start from </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1182.1">line 5</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1183.1">.</span></span></p>
<h1 id="_idParaDest-128"><a id="_idTextAnchor129"/><span class="koboSpan" id="kobo.1184.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.1185.1">Well, it’s been a long and – I hope – interesting trip, so it’s time now to summarize what </span><span class="No-Break"><span class="koboSpan" id="kobo.1186.1">we learned.</span></span></p>
<p><span class="koboSpan" id="kobo.1187.1">Technical analysis assumes that price includes everything in itself and attempts to find repeating patterns of behavior, suggesting that the price action following a similar pattern will also be similar to what already happened in </span><span class="No-Break"><span class="koboSpan" id="kobo.1188.1">the past.</span></span></p>
<p><span class="koboSpan" id="kobo.1189.1">There are just four major classes of technical studies, despite their visual diversity at first glance: market speed or momentum, digital filters, range, and volatility. </span><span class="koboSpan" id="kobo.1189.2">Each type of study can be used to detect a certain situation in the market, but none of them can produce a ready profitable trading strategy on </span><span class="No-Break"><span class="koboSpan" id="kobo.1190.1">its own.</span></span></p>
<p><span class="koboSpan" id="kobo.1191.1">The cornerstone of all technical studies is the sliding window, and the bane of technical trading is peeking ahead during development and testing. </span><span class="koboSpan" id="kobo.1191.2">Using queues to emulate incoming data streams and to organize sliding windows solves the problem of peeking ahead once and </span><span class="No-Break"><span class="koboSpan" id="kobo.1192.1">for all.</span></span></p>
<p><span class="koboSpan" id="kobo.1193.1">Besides that, this approach makes your application scalable, flexible, and modular with the ability to connect to a live data source after testing without rewriting your </span><span class="No-Break"><span class="koboSpan" id="kobo.1194.1">trading code.</span></span></p>
<p><span class="koboSpan" id="kobo.1195.1">Now that we have plenty of data points, we definitely want to visualize all of them to be able to quickly check the results or even trade live. </span><span class="koboSpan" id="kobo.1195.2">So, let’s move on to the </span><span class="No-Break"><span class="koboSpan" id="kobo.1196.1">next chapter.</span></span></p>
</div>
</body></html>