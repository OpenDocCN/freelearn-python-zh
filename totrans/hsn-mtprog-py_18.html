<html><head></head><body>
<div><div><h1 id="_idParaDest-182"><em class="italic"><a id="_idTextAnchor184"/>Chapter 15</em>: Implementing a Case Study</h1>
<p>In this chapter, we will work on implementing a case study by applying the metaprogramming concepts that we have learned so far. For this case study, we will be using the <code>Automobile.</code> <code>(1987)</code>. <code>UCI Machine</code> <code>Learning</code> <code>Repository</code> dataset.</p>
<p>In this chapter, we will be looking at the following main topics:</p>
<ul>
<li>Explaining the case study</li>
<li>Defining base classes</li>
<li>Developing a code generator library</li>
<li>Generating code</li>
<li>Designing an execution framework</li>
</ul>
<p>By the end of this chapter, you should have an understanding of how to use the existing methods of the ast library in Python to enable your application to generate its own code.</p>
<h1 id="_idParaDest-183"><a id="_idTextAnchor185"/>Technical requirements</h1>
<p>The code examples shared in this chapter are available on GitHub at: <a href="https://github.com/PacktPublishing/Metaprogramming-with-Python/tree/main/Chapter15">https://github.com/PacktPublishing/Metaprogramming-with-Python/tree/main/Chapter15</a>.</p>
<h1 id="_idParaDest-184"><a id="_idTextAnchor186"/>Explaining the case study</h1>
<p>In this section, we will <a id="_idIndexMarker704"/>be looking at the details of the case study before we start implementing it. Let’s consider a car agency, <em class="italic">ABC Car Agency</em>, that focuses on sales of new and used cars from multiple brands. This agency would like to build an application that produces customized catalogs for each car displaying the various specifications and features of the car.</p>
<p>We will look at the details available to develop and build the application by applying the concepts that we have learned throughout this book. There are 205 different cars that need to be <a id="_idIndexMarker705"/>cataloged and the data used to build this case study is taken from the following dataset: <code>Automobile. (1987). UCI Machine Learning Repository</code>.</p>
<p>There are many ways to develop an application that can solve this problem. We are going to look at how to develop a reusable application that uses metaprogramming.</p>
<p>A high-level view of the automobile data is as follows:</p>
<div><div><img alt="Figure 15.1 – The Automobile. (1987). UCI Machine Learning Repository dataset  " height="442" src="img/Figure_15.1_B13426.jpg" width="1311"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.1 – The Automobile. (1987). UCI Machine Learning Repository dataset </p>
<p>For this case study, we are not going to perform any detailed data processing using the automobile dataset. Instead, we will be using the data available in this dataset to create various components for the application’s development. The flow of design for this example will start with developing a code generator library, followed by creating a code generator framework. We will then generate the <em class="italic">ABC Car Agency</em> library and, finally, create an execution framework. All of these processes will be explained in detail in this section.</p>
<p>The Python scripts that will be developed for this case study will be as follows:</p>
<div><div><img alt="Figure 15.2 – Python scripts for the ABC Car Agency case study" height="353" src="img/Figure_15.2_B13426.jpg" width="1425"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.2 – Python scripts for the ABC Car Agency case study</p>
<p>The<a id="_idIndexMarker706"/> car sales application will be developed by defining the following classes:</p>
<ul>
<li><code>CarSpecs</code></li>
<li><code>CarMake</code> with its subclasses</li>
<li><code>CarCatalogue</code></li>
<li><code>BodyStyle</code> with its subclasses</li>
<li><code>SaleType</code> with its subclasses</li>
</ul>
<p>Each of these classes will be explained in this section.</p>
<p>The overall structure of classes for this application is going to look as follows:</p>
<div><div><img alt="Figure 15.3 – Overview of the car sales application" height="1303" src="img/Figure_15.3_B13426.jpg" width="1297"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.3 – Overview of the car sales application</p>
<p>With this <a id="_idIndexMarker707"/>understood, we will look further at the base classes for the application.</p>
<h1 id="_idParaDest-185"><a id="_idTextAnchor187"/>Defining base classes</h1>
<p>We will now<a id="_idIndexMarker708"/> start building the code required for the case study.</p>
<p>Let’s start by developing a metaclass named <code>CarSpecs</code>. This class will have the following structure:</p>
<ol>
<li>The <code>__new__</code> of the <code>CarSpecs</code> class will perform the following tasks:<ol><li>If the attribute of the input class is an integer, then add the attribute name in title case as <code>feature</code>, the value in string format as <code>info</code>, and <code>type</code> as numeric.</li><li>If the attribute of the input class is a string, then add the attribute name in title case as <code>feature</code>, the value in string format as <code>info</code>, and <code>type</code> as varchar.</li><li>If the attribute of the input class is a Boolean, then add the attribute name title case as a <code>feature</code>, the value in string format as <code>info</code>, and <code>type</code> as Boolean.</li><li>If not, the actual attribute will be returned as such.</li></ol></li>
</ol>
<p>Let’s now look at the definition of <code>CarSpecs</code>:</p>
<pre>from abc import ABC, abstractmethod
class CarSpecs(type):
    def __new__(classitself, classname, baseclasses, attributes):  
        newattributes = {}
        for attribute, value in attributes.items():
            if attribute.startswith("__"):
                newattributes[attribute] = value
            elif type(value)==int or type(value)==float:
                newattributes[attribute] = {}
                newattributes[attribute]['feature'] = attribute.title().replace('_', ' ')
                newattributes[attribute]['info'] = str(value)
                newattributes[attribute]['type'] = 'NUMERIC'
            elif type(value)==str:
                newattributes[attribute] = {}
                newattributes[attribute]['feature'] = attribute.title().replace('_', ' ')
                newattributes[attribute]['info'] = value.title()
                newattributes[attribute]['type'] = 'VARCHAR'
            elif type(value)==bool:
                newattributes[attribute] = {}
                newattributes[attribute]['feature'] = attribute.title().replace('_', ' ')
                newattributes[attribute]['info'] = value.title()
                newattributes[attribute]['type'] = 'BOOLEAN'
                
            else:
                newattributes[attribute] = value                
        return type.__new__(classitself, classname, baseclasses, newattributes)</pre>
<ol>
<li value="2">The<a id="_idIndexMarker709"/> next class in this example will be <code>CarCatalogue</code> with two abstract methods to define the color and print the catalog:<pre>class CarCatalogue(metaclass = CarSpecs):
    @abstractmethod
    def define_color(self):
        pass
    @abstractmethod
    def print_catalogue(self):
        pass</pre></li>
<li>The next class will be the parent class or superclass that captures the specifications of the car:<pre>class CarMake(metaclass = CarSpecs):   
    @abstractmethod
    def define_spec(self):
        pass     </pre></li>
<li>Let’s create another superclass named <code>BodyStyle</code>, which will capture the body style and engine features of the car:<pre>class BodyStyle(metaclass = CarSpecs):
    @abstractmethod
    def body_style_features(self):
        pass   </pre></li>
<li>The next class for this case study will be <code>SaleType</code>, in which we will add an abstract method to calculate the price of the car:<pre>class SaleType(metaclass = CarSpecs):
    @abstractmethod
    def calculate_price(self):
        pass</pre></li>
<li>This class will be a subclass of <code>SaleType</code> for calculating the price of new cars:<pre>class New(SaleType, CarCatalogue,  metaclass = CarSpecs):
    def calculate_price(self, classname):
        car = classname()
        price = float(car.price['info'])
        return price</pre></li>
<li>The<a id="_idIndexMarker710"/> next class will be another subclass of <code>SaleType</code> for calculating the price of resale cars:<pre>class Resale(SaleType, CarCatalogue,  metaclass = CarSpecs):
    def calculate_price(self, classname, years):
        car = classname()
        depreciation = years * 0.15
        price = float(car.price['info']) * (1 - depreciation)
        return price</pre></li>
</ol>
<p>These are the main classes for which we will be creating templates that will be used to generate code in the next section.</p>
<h1 id="_idParaDest-186"><a id="_idTextAnchor188"/>Developing a code generator library</h1>
<p>In this section, let’s look <a id="_idIndexMarker711"/>at developing a code generator that will be used to generate code for all the base classes – <code>CarSpecs</code>, <code>CarMake</code>, <code>CarCatalogue</code>, <code>BodyStyle</code>, and <code>SaleType</code>. The detailed steps are as follows:</p>
<ol>
<li value="1">Let’s create a file named <code>codegenerator.py</code> and start by defining a class named <code>CodeGenerator</code>:<pre>class CodeGenerator:</pre></li>
<li>Let’s define<a id="_idIndexMarker712"/> a method that imports the <code>ast</code> library and adds a <code>meta_template</code> attribute that has the string format of the <code>CarSpecs</code> class as a value. The <code>meta_template</code> attribute is further parsed and unparsed into class code:<pre>def generate_meta(self):
        ast = __import__('ast')
        meta_template = '''
from abc import ABC, abstractmethod, ABCMeta
class CarSpecs(type, metaclass = ABCMeta):
    def __new__(classitself, classname, baseclasses, attributes):  
        newattributes = {}
        for attribute, value in attributes.items():
            if attribute.startswith("__"):
                newattributes[attribute] = value
            elif type(value)==int or type(value)==float:
                newattributes[attribute] = {}
                newattributes[attribute]['feature'] = attribute.title().replace('_', ' ')
                newattributes[attribute]['info'] = str(value)
                newattributes[attribute]['type'] = 'NUMERIC'
            elif type(value)==str:
                newattributes[attribute] = {}
                newattributes[attribute]['feature'] = attribute.title().replace('_', ' ')
                newattributes[attribute]['info'] = value.title()
                newattributes[attribute]['type'] = 'VARCHAR'
            elif type(value)==bool:
                newattributes[attribute] = {}
                newattributes[attribute]['feature'] = attribute.title().replace('_', ' ')
                newattributes[attribute]['info'] = value.title()
                newattributes[attribute]['type'] = 'BOOLEAN'
            else:
                newattributes[attribute] = value                
        return type.__new__(classitself, classname, baseclasses, newattributes)
'''
        meta_tree = ast.parse(meta_template)
        print(ast.unparse(meta_tree))
        print('\n')</pre></li>
<li>Let’s now define another method named <code>generate_car_catalogue</code> and add the class <a id="_idIndexMarker713"/>template for <code>CarCatalogue</code>:<pre>def generate_car_catalogue(self):
        ast = __import__('ast')
        catalogue_template = '''
class CarCatalogue(metaclass = CarSpecs):
    @abstractmethod
    def define_color(self):
        pass
    
    @abstractmethod
    def print_catalogue(self):
        pass
        '''
        catalogue_tree = ast.parse(catalogue_template)
        print(ast.unparse(catalogue_tree))
        print('\n')</pre></li>
<li>The next step is to define a method named <code>generate_carmake_code</code> and add the code template for the <code>CarMake</code> class:<pre>def generate_carmake_code(self):
        ast = __import__('ast')
        carmake_template = '''
class CarMake(metaclass = CarSpecs):   
    @abstractmethod
    def define_spec(self):
        pass     
        '''
        carmake_tree = ast.parse(carmake_template)
        print(ast.unparse(carmake_tree))
        print('\n')</pre></li>
<li>In the<a id="_idIndexMarker714"/> next code block, we will define another method named <code>generate_bodystyle_parent</code> and add the code template for the <code>BodyStyle</code> class:<pre>def generate_bodystyle_parent(self):
        ast = __import__('ast')
        bodystyle_parent_template = '''
class BodyStyle(metaclass = CarSpecs):
    @abstractmethod
    def body_style_features(self):
        pass  
        '''
        bodystyle_parent_tree = ast.parse(bodystyle_parent_template)
        print(ast.unparse(bodystyle_parent_tree))
        print('\n')</pre></li>
<li>Let’s further define the <code>generate_salestype_code</code> method, which generates the class code for the <code>SaleType</code> class:<pre>def generate_salestype_code(self):
        ast = __import__('ast')
        saletype_template = '''
class SaleType(metaclass = CarSpecs):
    @abstractmethod
    def calculate_price(self):
        pass
        '''
        salestype_tree = ast.parse(saletype_template)
        print(ast.unparse(salestype_tree))
        print('\n')</pre></li>
<li>In this<a id="_idIndexMarker715"/> step, let’s define the <code>generate_newsale_code</code> method to generate code for the <code>New</code> class:<pre>def generate_newsale_code(self):
        ast = __import__('ast')
        newsale_template = '''
class New(SaleType, CarCatalogue,  metaclass = CarSpecs):
    def calculate_price(self, classname):
        car = classname()
        price = float(car.price['info'])
        return price
        '''
        newsale_tree = ast.parse(newsale_template)
        print(ast.unparse(newsale_tree))
        print('\n')</pre></li>
<li>Let’s further define the <code>generate_resale_code</code> method, which generates the code<a id="_idIndexMarker716"/> for the <code>Resale</code> class and has the method for calculating the resale price of the car:<pre>    def generate_resale_code(self):
        ast = __import__('ast')
        resale_template = '''
class Resale(SaleType, CarCatalogue,  metaclass = CarSpecs):
    def calculate_price(self, classname, years):
        car = classname()
        depreciation = years * 0.15
        price = float(car.price['info']) * (1 - depreciation)
        return price
        '''
        resale_tree = ast.parse(resale_template)
        print(ast.unparse(resale_tree))
        print('\n')</pre></li>
<li>In this step, we will define a <code>generate_car_code</code> method; it inherits the <code>CarMake</code> class, defines the color and specifications for individual car brands, and prints the catalog:<pre>def generate_car_code(self, classname, carspecs):
        self.classname = classname
        self.carspecs = carspecs
        ast = __import__('ast')
        car_template = '''
class '''+self.classname+'''(CarMake, CarCatalogue, metaclass = CarSpecs):
    fuel_type = '''+"'"+self.carspecs['fuel_type']+"'"+'''
    aspiration = '''+"'"+self.carspecs['aspiration']+"'"+'''
    num_of_door = '''+"'"+self.carspecs['num_of_door']+"'"+'''
    drive_wheels = '''+"'"+self.carspecs['drive_wheels']+"'"+'''
    wheel_base = '''+"'"+self.carspecs['wheel_base']+"'"+'''
    length = '''+"'"+self.carspecs['length']+"'"+'''
    width = '''+"'"+self.carspecs['width']+"'"+'''
    height = '''+"'"+self.carspecs['height']+"'"+'''
    curb_weight = '''+"'"+self.carspecs['curb_weight']+"'"+'''
    fuel_system = '''+"'"+self.carspecs['fuel_system']+"'"+'''
    city_mpg = '''+"'"+self.carspecs['city_mpg']+"'"+'''
    highway_mpg = '''+"'"+self.carspecs['highway_mpg']+"'"+'''
    price = '''+"'"+self.carspecs['price']+"'"+'''
    def define_color(self):
            BOLD = '\33[5m'
            BLUE = '\033[94m'
            return BOLD + BLUE
    def define_spec(self):
            specs = [self.fuel_type, self.aspiration, self.num_of_door, self.drive_wheels, 
                     self.wheel_base, self.length, self.width, self.height, self.curb_weight,
                    self.fuel_system, self.city_mpg, self.highway_mpg]
            return specs
    def print_catalogue(self):
            for i in self.define_spec():
                print(self.define_color() + i['feature'], ": ", self.define_color() + i['info'])   
                '''
        car_tree = ast.parse(car_template)
        print(ast.unparse(car_tree))
        print('\n')</pre></li>
<li>The<a id="_idIndexMarker717"/> last method of this code generator is <code>generate_bodystyle_code</code>, which generates class code for different body styles, such as Sedan and Hatchback, defines the color and features for an individual car body style, and prints the catalog:<pre>def generate_bodystyle_code(self, classname, carfeatures):
        self.classname = classname
        self.carfeatures = carfeatures
        ast = __import__('ast')
        bodystyle_template = '''
class '''+self.classname+'''(BodyStyle, CarCatalogue,  metaclass = CarSpecs):
    engine_location = '''+"'"+self.carfeatures['engine_location']+"'"+'''
    engine_type = '''+"'"+self.carfeatures['engine_type']+"'"+'''
    num_of_cylinders = '''+"'"+self.carfeatures['num_of_cylinders']+"'"+''' 
    engine_size = '''+"'"+self.carfeatures['engine_size']+"'"+'''
    bore = '''+"'"+self.carfeatures['bore']+"'"+'''
    stroke = '''+"'"+self.carfeatures['stroke']+"'"+'''
    compression_ratio = '''+"'"+self.carfeatures['compression_ratio']+"'"+'''
    horse_power = '''+"'"+self.carfeatures['horse_power']+"'"+'''
    peak_rpm = '''+"'"+self.carfeatures['peak_rpm']+"'"+'''
    def body_style_features(self):
            features = [self.engine_location, self.engine_type, self.num_of_cylinders, self.engine_size,
                     self.bore, self.stroke, self.compression_ratio, self.horse_power, self.peak_rpm]
            return features  
    def define_color(self):
            BOLD = '\33[5m'
            RED = '\033[31m'
            return BOLD + RED
    def print_catalogue(self):
            for i in self.body_style_features():
                print(self.define_color() + i['feature'], ": ", self.define_color() + i['info'])  
                '''
        bodystyle_tree = ast.parse(bodystyle_template)
        print(ast.unparse(bodystyle_tree))
        print('\n')</pre></li>
</ol>
<p>With <a id="_idIndexMarker718"/>these methods, we are all set to generate the code required for the ABC Car Agency’s catalog.</p>
<p>Now, let’s proceed further to develop a code generation framework that generates the hundreds of classes required for our application.</p>
<h1 id="_idParaDest-187"><a id="_idTextAnchor189"/>Generating code </h1>
<p>In this section, we are<a id="_idIndexMarker719"/> going to make use of <code>codegenerator.py</code> to generate the base classes and its corresponding subclasses, which maintain and print various catalogs for the ABC Car Agency, as follows:</p>
<ol>
<li value="1">To begin with, let’s start using the automobile data to generate the base classes required for this application. For the base data preparation, let’s import the <code>pandas</code> library, which helps with processing data:<pre>import pandas as pd</pre></li>
<li>Let’s load the data and make a copy of it. For this application, we need a unique set of car brands and another unique set of car body styles:<pre>auto = pd.read_csv("automobile.csv")
auto_truncated = auto.copy(deep=True)
auto_truncated.drop_duplicates(subset = ['make','body-style'], inplace = True)
auto_truncated.reset_index(inplace = True, drop = True)
auto_truncated['make'] = auto_truncated['make'].apply(lambda x: x.title().replace('-',''))
auto_truncated.reset_index(inplace = True)
auto_truncated['index'] = auto_truncated['index'].astype('str')
auto_truncated['make'] = auto_truncated['make'] + auto_truncated['index']
auto_truncated['body-style'] = auto_truncated['body-style'].apply(lambda x: x.title().replace('-',''))
auto_truncated['body-style'] = auto_truncated['body-style'] + auto_truncated['index']</pre></li>
</ol>
<p>Once <a id="_idIndexMarker720"/>the basic data has been processed, let’s create two DataFrames that will be used to generate multiple classes using the code generator:</p>
<pre>auto_specs = auto_truncated[['make', 'fuel-type', 'aspiration', 'num-of-doors', 'drive-wheels', 'wheel-base',  'length', 'width', 'height', 'curb-weight', 'fuel-system', 'city-mpg',  'highway-mpg', 'price']].copy(deep = True)
auto_specs.columns = ['classname', 'fuel_type', 'aspiration', 'num_of_door', 'drive_wheels',                      'wheel_base', 'length', 'width', 'height', 'curb_weight', 'fuel_system', 'city_mpg', 'highway_mpg', 'price' ]
for col in auto_specs.columns:
    auto_specs[col] = auto_specs[col].astype('str')
auto_features = auto_truncated[['body-style', 'engine-location', 'engine-type', 'num-of-cylinders', 'engine-size', 'bore', 'stroke', 'compression-ratio', 'horsepower', 'peak-rpm']].copy(deep = True)
auto_features.columns = ['classname', 'engine_location', 'engine_type', 'num_of_cylinders', 'engine_size', 'bore', 'stroke', 'compression_ratio', 'horse_power', 'peak_rpm']
for col in auto_features.columns:
    auto_features[col] = auto_features[col].astype('str')</pre>
<ol>
<li value="3">After <a id="_idIndexMarker721"/>processing the data into the format that we need to provide as input to the code generator, the sample data for specifications will be as follows:</li>
</ol>
<div><div><img alt="Figure 15.4 – Sample specifications  " height="197" src="img/Figure_15.4_B13426.jpg" width="942"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.4 – Sample specifications </p>
<ol>
<li value="4">The sample data for features will be as follows:</li>
</ol>
<div><div><img alt="Figure 15.5 – Sample features " height="192" src="img/Figure_15.5_B13426.jpg" width="970"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.5 – Sample features</p>
<ol>
<li value="5">Now that the base data required to generate code is ready, we can start importing the code generator:<pre>from codegenerator import CodeGenerator
codegen = CodeGenerator()</pre></li>
<li>In this step, let’s now define a function that generates the library by calling the code to <a id="_idIndexMarker722"/>generate each base class in a pipeline followed by generating multiple subclasses for <code>CarMake</code> and <code>BodyStyle</code>:<pre>def generatelib():
    codegen.generate_meta()
    codegen.generate_car_catalogue()
    codegen.generate_carmake_code()
    codegen.generate_bodystyle_parent()
    codegen.generate_salestype_code()
    codegen.generate_newsale_code()
    codegen.generate_resale_code()
    for index, row in auto_specs.iterrows():
        carspecs = dict(row)
        classname = carspecs['classname']
        del carspecs['classname']
        codegen.generate_car_code(classname = classname, carspecs = carspecs)
    for index, row in auto_features.iterrows():
        carfeatures = dict(row)
        classname = carfeatures['classname']
        del carfeatures['classname']
        codegen.generate_bodystyle_code(classname = classname, carfeatures = carfeatures)</pre></li>
<li>Open a Python file named <code>abccaragencylib.py</code> and call a <code>generatelib</code> function to write the code generated for all the required classes:<pre>from contextlib import redirect_stdout
with open('abccaragencylib.py', 'w') as code:
    with redirect_stdout(code):
        generatelib()
code.close()</pre></li>
<li>An <a id="_idIndexMarker723"/>example class autogenerated and written into <code>abccaragencylib.py</code> is represented in the following screenshot:</li>
</ol>
<div><div><img alt="Figure 15.6 – An autogenerated class code for a car brand " height="494" src="img/Figure_15.6_B13426.jpg" width="1031"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 15.6 – An autogenerated class code for a car brand</p>
<p>We have not autogenerated the code required for this example. We will now look at designing an execution framework.</p>
<h1 id="_idParaDest-188"><a id="_idTextAnchor190"/>Designing an execution framework</h1>
<p>In this section, let’s look at the last process of designing the ABC Car Agency application where we <a id="_idIndexMarker724"/>will actually run the code generated throughout this case study:</p>
<ol>
<li value="1">Let’s start by loading the autogenerated library:<pre>import abccaragencylib as carsales</pre></li>
<li>At this stage, we will follow a sequence of steps by implementing a façade design pattern so that we can print the specifications and features for different types of cars:<pre>class Queue:
    def __init__(self, makeclass, styleclass, age):
        self.makeclass = makeclass
        self.styleclass = styleclass
        self.make = self.makeclass()
        self.style = self.styleclass()
        self.new = carsales.New()
        self.resale = carsales.Resale()
        self.age = age
    def pipeline(self):
        print('*********ABC Car Agency - Catalogue***********')
        self.make.print_catalogue()
        print('\n')
        self.style.print_catalogue()
        print('\n')
        print('New Car Price : ' + str(self.new.calculate_price(self.makeclass)))
        print('Resale Price : ' + str(self.resale.calculate_price(self.makeclass, self.age)))</pre></li>
<li>Let’s define a method to run the façade pattern:<pre>def run_facade(makeclass, styleclass, age):
    queue = Queue(makeclass, styleclass, age)
    queue.pipeline()</pre></li>
<li>In this <a id="_idIndexMarker725"/>step, we will run one combination of a car brand with a car body style to generate a catalog:<pre>run_facade(carsales.AlfaRomero1, carsales.Hatchback28, 3)</pre></li>
</ol>
<p>The output is as follows:</p>
<pre><strong class="bold">*********ABC Car Agency - Catalogue***********</strong>
<strong class="bold">Fuel Type :  Gas</strong>
<strong class="bold">Aspiration :  Std</strong>
<strong class="bold">Num Of Door :  Two</strong>
<strong class="bold">Drive Wheels :  Rwd</strong>
<strong class="bold">Wheel Base :  94.5</strong>
<strong class="bold">Length :  171.2</strong>
<strong class="bold">Width :  65.5</strong>
<strong class="bold">Height :  52.4</strong>
<strong class="bold">Curb Weight :  2823</strong>
<strong class="bold">Fuel System :  Mpfi</strong>
<strong class="bold">City Mpg :  19</strong>
<strong class="bold">Highway Mpg :  26</strong>
<strong class="bold">Engine Location :  Front</strong>
<strong class="bold">Engine Type :  Ohc</strong>
<strong class="bold">Num Of Cylinders :  Four</strong>
<strong class="bold">Engine Size :  97</strong>
<strong class="bold">Bore :  3.15</strong>
<strong class="bold">Stroke :  3.29</strong>
<strong class="bold">Compression Ratio :  9.4</strong>
<strong class="bold">Horse Power :  69</strong>
<strong class="bold">Peak Rpm :  5200</strong>
<strong class="bold">New Car Price : 16500.0</strong>
<strong class="bold">Resale Price : 9075.0</strong></pre>
<p>There are 56 unique subclasses generated for <code>CarMake</code> and 56 unique subclasses generated for <code>BodyStyle</code>. We can use various combinations of <code>CarMake</code> and <code>BodyStyle</code> to print catalogs for this application.</p>
<ol>
<li value="5">Let’s try <a id="_idIndexMarker726"/>another combination:<pre>run_facade(carsales.Mitsubishi24, carsales.Sedan16, 5)</pre></li>
</ol>
<p>The output generated is as follows:</p>
<pre><strong class="bold">*********ABC Car Agency - Catalogue***********</strong>
<strong class="bold">Fuel Type :  Gas</strong>
<strong class="bold">Aspiration :  Std</strong>
<strong class="bold">Num Of Door :  Two</strong>
<strong class="bold">Drive Wheels :  Fwd</strong>
<strong class="bold">Wheel Base :  93.7</strong>
<strong class="bold">Length :  157.3</strong>
<strong class="bold">Width :  64.4</strong>
<strong class="bold">Height :  50.8</strong>
<strong class="bold">Curb Weight :  1918</strong>
<strong class="bold">Fuel System :  2Bbl</strong>
<strong class="bold">City Mpg :  37</strong>
<strong class="bold">Highway Mpg :  41</strong>
<strong class="bold">Engine Location :  Front</strong>
<strong class="bold">Engine Type :  Dohc</strong>
<strong class="bold">Num Of Cylinders :  Six</strong>
<strong class="bold">Engine Size :  258</strong>
<strong class="bold">Bore :  3.63</strong>
<strong class="bold">Stroke :  4.17</strong>
<strong class="bold">Compression Ratio :  8.1</strong>
<strong class="bold">Horse Power :  176</strong>
<strong class="bold">Peak Rpm :  4750</strong>
<strong class="bold">New Car Price : 5389.0</strong>
<strong class="bold">Resale Price : 1347.25</strong></pre>
<p>This is the <a id="_idIndexMarker727"/>step-by-step process of developing an application by applying metaprogramming methodologies in Python.</p>
<h1 id="_idParaDest-189"><a id="_idTextAnchor191"/>Summary</h1>
<p>In this chapter, we have learned how to develop an application by applying various techniques of metaprogramming. We started by explaining the case study, and we defined the base classes required for this case study.</p>
<p>We also learned how to develop a code generator and how to generate code using it. We also designed a framework that could be used to execute or test the code generated for the application in this case study.</p>
<p>In the next chapter, we will be looking at some of the best practices that can be followed while designing an application with Python and metaprogramming.</p>
</div>
</div></body></html>