<html><head></head><body>
		<div id="_idContainer127">
			<h1 id="_idParaDest-645" class="chapter-number"><a id="_idTextAnchor734"/>14</h1>
			<h1 id="_idParaDest-646"><a id="_idTextAnchor735"/>CMS Website Development</h1>
			<p>Odoo has a built-in feature called Website Builder, which is a powerful tool that allows you to create and manage websites within the Odoo ERP ecosystem. It offers a user-friendly and visual approach to web design, making it accessible to users without extensive <span class="No-Break">technical knowledge.</span></p>
			<p>Here are some <a id="_idIndexMarker965"/>key features and aspects of Odoo <span class="No-Break">Website Builder:</span></p>
			<ul>
				<li><strong class="bold">Drag-and-drop interface</strong>: Website Builder provides a drag-and-drop interface, allowing you to easily add and arrange various content elements on your web pages. This includes text, images, videos, forms, buttons, <span class="No-Break">and more.</span></li>
				<li><strong class="bold">Pre-designed templates</strong>: Odoo offers a selection of pre-designed website templates that you can use as a starting point. These templates are customizable and can be adapted to your <span class="No-Break">brand’s identity.</span></li>
				<li><strong class="bold">Responsive design</strong>: Websites created with Odoo are designed to be responsive, which means they automatically adapt to different screen sizes and devices, ensuring a consistent user experience on desktops, tablets, <span class="No-Break">and smartphones.</span></li>
				<li><strong class="bold">Content management</strong>: You can create and manage web pages, blogs, product <a id="_idIndexMarker966"/>listings, and other types of content easily. Website Builder provides a <strong class="bold">content management system</strong> (<strong class="bold">CMS</strong>) to organize and update <span class="No-Break">your content.</span></li>
				<li><strong class="bold">Search engine optimization (SEO)</strong>: Odoo includes tools for SEO, allowing you to set metadata, define SEO-friendly URLs, and manage sitemaps to improve your website’s visibility in <span class="No-Break">search engines.</span></li>
				<li><strong class="bold">Multilingual support</strong>: Odoo supports multiple languages, making it suitable for businesses with international audiences. You can translate content and adapt your website for <span class="No-Break">different regions.</span></li>
				<li><strong class="bold">Integration with other Odoo modules</strong>: One of the advantages of using Odoo Website <a id="_idIndexMarker967"/>Builder is its seamless integration with other Odoo modules, such as CRM, sales, inventory, and more. This means you can manage various aspects of your business within a <span class="No-Break">unified system.</span></li>
				<li><strong class="bold">Analytics and reporting</strong>: Odoo provides built-in analytics and reporting tools to track the performance of your website, including visitor statistics, conversion rates, <span class="No-Break">and more.</span></li>
				<li><strong class="bold">Custom development</strong>: For businesses with unique requirements, Odoo’s modular architecture allows for custom development to extend the <span class="No-Break">platform’s functionality.</span></li>
			</ul>
			<p>In this chapter, you will explore the developments of the Odoo website’s custom features and learn how to create web pages. You will also learn how to create building blocks that <a id="_idIndexMarker968"/>users can drag and drop on a page. Advanced things such as <strong class="bold">Urchin Tracking Modules</strong> (<strong class="bold">UTMs</strong>), SEO, multi-websites, GeoIP, and sitemaps are also covered in <span class="No-Break">this chapter.</span></p>
			<p>In this chapter, we will cover the <span class="No-Break">following recipes:</span></p>
			<ul>
				<li><span class="No-Break">Managing assets</span></li>
				<li>Adding CSS and JavaScript for <span class="No-Break">a website</span></li>
				<li>Creating or <span class="No-Break">modifying templates</span></li>
				<li>Managing <span class="No-Break">dynamic routes</span></li>
				<li>Offering static snippets to <span class="No-Break">the user</span></li>
				<li>Offering dynamic snippets to <span class="No-Break">the user</span></li>
				<li>Getting input from <span class="No-Break">website users</span></li>
				<li>Managing <span class="No-Break">SEO options</span></li>
				<li>Managing sitemaps for <span class="No-Break">the website</span></li>
				<li>Getting a visitor’s <span class="No-Break">country information</span></li>
				<li>Tracking a <span class="No-Break">marketing campaign</span></li>
				<li>Managing <span class="No-Break">multiple websites</span></li>
				<li>Redirecting <span class="No-Break">old URLs</span></li>
				<li>Publish management for <span class="No-Break">website-related reco<a id="_idTextAnchor736"/>rds</span></li>
			</ul>
			<h1 id="_idParaDest-647"><a id="_idTextAnchor737"/>Managing assets</h1>
			<p>In the context of Odoo’s website, assets <a id="_idIndexMarker969"/>refer to various types of resources, such <a id="_idIndexMarker970"/>as <strong class="bold">Cascading Style Sheets</strong> (<strong class="bold">CSS</strong>), JavaScript files, fonts, and images, that are used to enhance the appearance and functionality of your website. Managing assets <a id="_idIndexMarker971"/>in Odoo is important for maintaining a well-structured and efficient website. When a page is loaded in the browser, these static files make a separate request to the server. The higher the number of requests, the lower the website speed. To avoid this issue, most websites serve static assets by combining multiple files. There are several tools on the market to manage these sorts of things, but Odoo has its own implementation for managing <span class="No-Break">static a<a id="_idTextAnchor738"/>ssets.</span></p>
			<h2 id="_idParaDest-648"><a id="_idTextAnchor739"/>What are asset bundles and different assets in Odoo?</h2>
			<p>In Odoo, asset bundles are collections of different assets, such as CSS, JavaScript files, and other <a id="_idIndexMarker972"/>resources, grouped together for efficient and organized loading on your website. Asset bundles help manage the loading of these resources by allowing you to define which assets should be loaded together to improve performance and ensure that your website functions properly. The job of an asset bundle is to combine all the JavaScript and CSS in a single file and reduce its size by <span class="No-Break">minimizing it.</span></p>
			<p>Here are the different asset bundles used <span class="No-Break">in Odoo:</span></p>
			<ul>
				<li><span class="No-Break"><strong class="source-inline">web._assets_primary_variables</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">web._assets_secondary_variables</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">web.assets_backend</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">web.assets_frontend</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">web.assets_frontend_minimal</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">web.assets_frontend_lazy</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">web.report_assets_common</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">web.report_assets_pdf</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">web.assets_web_dark</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">web._assets_frontend_helpers</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">web_editor.assets_wysiwyg</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">website.assets_wysiwyg</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">website.assets_editor</strong></span></li>
			</ul>
			<p class="callout-heading">Important information</p>
			<p class="callout">There are some other asset bundles used for <span class="No-Break">specific applications;</span></p>
			<p class="callout">for example, <strong class="source-inline">point_of_sale.assets</strong>, <strong class="source-inline">survey.survey_assets</strong>, <strong class="source-inline">mass_mailing.layout</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">website_slides.slide_embed_assets</strong></span><span class="No-Break">.</span></p>
			<p>Odoo manages <a id="_idIndexMarker973"/>its static assets through the <strong class="source-inline">AssetBundle</strong> class, which is located <span class="No-Break">at </span><span class="No-Break"><strong class="source-inline">/odoo/addons/base/models/assetsbundle.py</strong></span><span class="No-Break">.</span></p>
			<p>Now, <strong class="source-inline">AssetBundle</strong> not only combines multiple files; it is also packed with more features. Here is <a id="_idIndexMarker974"/>the list of features <span class="No-Break">it provides:</span></p>
			<ul>
				<li>It combines multiple JavaScript and <span class="No-Break">CSS files.</span></li>
				<li>It minifies the JavaScript and CSS files by removing comments, extra spaces, and carriage returns from the file content. Removing this extra data will reduce the size of static assets and improve the page <span class="No-Break">loading speed.</span></li>
				<li>It has built-in <a id="_idIndexMarker975"/>support for CSS preprocessors, such as <strong class="bold">Sassy CSS</strong> (<strong class="bold">SCSS</strong>) and <strong class="bold">Leaner Style Sheets</strong> (<strong class="bold">LESS</strong>). This means you can add SCSS <a id="_idIndexMarker976"/>and LESS files and they will automatically be compiled and added to <a id="_idTextAnchor740"/><span class="No-Break">the bundle.</span></li>
			</ul>
			<h2 id="_idParaDest-649"><a id="_idTextAnchor741"/>Custom assets</h2>
			<p>As we have seen, Odoo has different assets for different code bases. To get the right result, you will <a id="_idIndexMarker977"/>need to choose the right asset bundle in which to place your custom JavaScript and CSS files. For example, if you are designing a website, you need to put your file in <strong class="source-inline">web.assets_frontend</strong>. Although it is rare, sometimes, you need to create a whole new asset bundle. You can create your own asset bundle, as we will describe in the <span class="No-Break">following section.</span></p>
			<h2 id="_idParaDest-650"><a id="_idTextAnchor742"/>How to do it...</h2>
			<p>To load assets, you <a id="_idIndexMarker978"/>can use the <strong class="source-inline">web.assets_frontend</strong> template in your module’s <strong class="source-inline">__manifest__.py</strong> file; <span class="No-Break">for example:</span></p>
			<pre class="source-code">
'assets': {
    'web.assets_backend': [
        'my_hostel/static/src/xml/**/*',
    ],
    'web.assets_frontend: [
        'my_hostel/static/lib/bootstrap/**/*',
        'my_hostel/static/src/js/**',
        'my_hostel/static/src/scss/**',
    ],
},</pre>			<p>Here are some of the most <span class="No-Break">important bundles:</span></p>
			<ul>
				<li><span class="No-Break"><strong class="source-inline">web.assets_common</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">web.assets_backend</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">web.assets_frontend</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">web.qunit_suite_tests</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">web.qunit_mobil<a id="_idTextAnchor743"/>e_suite_tests</strong></span></li>
			</ul>
			<h3>Operations</h3>
			<p>Here are <a id="_idIndexMarker979"/>all directives targeting a certain <span class="No-Break">asset file:</span></p>
			<ul>
				<li><span class="No-Break"><strong class="source-inline">before</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">after</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">replace</strong></span></li>
				<li><span class="No-Break"><strong class="source-inline">remove</strong></span></li>
			</ul>
			<h3>append</h3>
			<p>An appending <a id="_idIndexMarker980"/>assets operation refers to adding additional CSS or JavaScript files to existing bundles or templates provided by other modules or the Odoo core. This allows you to extend the functionality or appearance without modifying the original code directly; <span class="No-Break">for example:</span></p>
			<pre class="source-code">
'web.assets_common': [
    'my_hostel/static/src/js/**/*',
],</pre>			<p>Always consider the sequence in which your assets are loaded. If your code depends on any specific libraries or functionalities defined in other assets, ensure they are loaded in the correct order to avoid conflicts <span class="No-Break">or errors.</span></p>
			<h3>prepend</h3>
			<p>Prepending <a id="_idIndexMarker981"/>assets in Odoo involves adding your own CSS or JavaScript files at the beginning of existing bundles or templates provided by other modules or the Odoo core. This helps ensure that your customizations take precedence over existing styles or scripts; <span class="No-Break">for example:</span></p>
			<pre class="source-code">
'web.assets_common': [
    ('prepend','my_hostel/static/src/css/bootstrap_overridden.scss'),
],</pre>			<p>Determine the <a id="_idIndexMarker982"/>sequence in which your assets are loaded. Prepending assets means they’ll be loaded before other styles or scripts, potentially impacting functionality or design. Be cautious with overriding <span class="No-Break">core functionalities.</span></p>
			<h3>before</h3>
			<p>In Odoo, organizing assets such as CSS or JavaScript files before other modules’ assets involves <a id="_idIndexMarker983"/>controlling the loading order of resources to ensure your module’s files are loaded before those of other modules; <span class="No-Break">for example:</span></p>
			<pre class="source-code">
'web.assets_common': [
    ('before', 'web/static/src/css/bootstrap_overridden.scss',   'my_hostel/static/src/css/bootstrap_overridden.scss'),
],</pre>			<p>Ensure that you’re referring to the correct assets or templates of modules you want to load your resources beforehand. Incorrect referencing might lead to errors or <span class="No-Break">unexpected behavior.</span></p>
			<h3>after</h3>
			<p>In Odoo, organizing assets such as CSS or JavaScript files to load after other modules’ assets involves <a id="_idIndexMarker984"/>controlling the loading order to ensure your module’s files are loaded after those of other modules. This is useful when you need your assets to rely on or override styles or scripts from other modules; <span class="No-Break">for example:</span></p>
			<pre class="source-code">
'web.assets_common': [
    ('after', 'web/static/src/css/list_view.scss', 'my_hostel/static/src/css/list_view.scss'),
],</pre>			<p>Controlling the loading sequence using the <strong class="source-inline">after</strong> attribute or Python code helps ensure your <a id="_idIndexMarker985"/>module’s assets are loaded after other modules, enabling you to manage dependencies and <span class="No-Break">customizations effectively.</span></p>
			<h3>include</h3>
			<p>In Odoo, including assets such as CSS or JavaScript files involves linking these resources to your module <a id="_idIndexMarker986"/>or theme to enhance its functionality or appearance; <span class="No-Break">for example:</span></p>
			<pre class="source-code">
'web.assets_common': [
    ('include', 'web._primary_variables'),
],</pre>			<p>Including assets in Odoo allows you to extend your module’s capabilities by adding custom styles or scripts, enhancing the user experience <span class="No-Break">and functionality.</span></p>
			<h3>remove</h3>
			<p>Remove one or <span class="No-Break">multiple file(s).</span></p>
			<p>Removing <a id="_idIndexMarker987"/>assets, such as CSS or JavaScript files, in Odoo involves excluding them from your module’s assets; <span class="No-Break">for example:</span></p>
			<pre class="source-code">
'web.assets_common': [
    ('remove', 'web/static/src/js/boot.js'),
],</pre>			<p>Removing assets in Odoo enables you to customize your module by excluding specific styles or scripts that are not needed or conflict with your <span class="No-Break">module’s functionalities.</span></p>
			<h3>replace</h3>
			<p>In Odoo, replacing <a id="_idIndexMarker988"/>assets involves substituting existing CSS or JavaScript files with new ones in your module or theme; <span class="No-Break">for example:</span></p>
			<pre class="source-code">
'web.assets_common': [
    ('replace', 'web/static/src/js/boot.js', 'my_addon/static/src/js/
boot.js'),
],</pre>			<p>Replacing assets in Odoo allows you to update and customize the appearance or functionality of <a id="_idIndexMarker989"/>your module by substituting existing files with new ones. Be cautious when replacing assets to maintain the stability and functional<a id="_idTextAnchor744"/>ity of <span class="No-Break">your application.</span></p>
			<h3>Loading order</h3>
			<p>In Odoo, managing the loading order of assets (CSS, JavaScript, and so on) is crucial for ensuring that <a id="_idIndexMarker990"/>dependencies are resolved correctly and that the user interface renders properly. The loading order can be controlled to determine which assets are loaded first or after others; <span class="No-Break">for example:</span></p>
			<pre class="source-code">
'web.assets_common': [
    'my_addon/static/lib/jquery/jquery.js',
    'my_addon/static/lib/jquery/**/*',
],</pre>			<p>When an asset bundle is called (for example, <strong class="source-inline">t-call-assets="web.assets_common"</strong>), an empty list of assets <span class="No-Break">is generated.</span></p>
			<p>All records of type <strong class="source-inline">ir.asset</strong> matching the bundle are fetched and sorted by sequence number. Then, all records with a sequence strictly less than 16 are processed and applied to the current list <span class="No-Break">of assets.</span></p>
			<p>All modules declaring assets for the said bundle in their manifest apply their assets’ operations to this list. This is done following the order of module dependencies (for example, web assets are processed before the website). If a directive tries to add a file already present in the list, nothing is done for that file. In other words, only the first occurrence of a file is kept in <span class="No-Break">the list.</span></p>
			<p>The remaining <strong class="source-inline">ir.asset</strong> records (those with a sequence greater than or equal to 16) are then processed and applied <span class="No-Break">as well.</span></p>
			<p>Assets declared in the manifest may need to be loaded in a particular order; for example, <strong class="source-inline">jquery.js</strong> must be loaded before all other <strong class="source-inline">jquery</strong> scripts when loading the <strong class="source-inline">lib</strong> folder. One solution <a id="_idIndexMarker991"/>would be to create an <strong class="source-inline">ir.asset</strong> record with a lower sequence or a <strong class="source-inline">prepend</strong> directive, but there is another, simpler way to <span class="No-Break">do so.</span></p>
			<h2 id="_idParaDest-651"><a id="_idTextAnchor745"/>There’s more...</h2>
			<p>The following are a few things you need to know if you are working with assets <span class="No-Break">in Odoo.</span></p>
			<p>Debugging JavaScript <a id="_idIndexMarker992"/>can be very hard in Odoo because <strong class="source-inline">AssetBundle</strong> merges multiple JavaScript files into a single file and also minifies them. By enabling developer mode with assets, you can skip asset bundling, and the page will load static assets separately so that you can <span class="No-Break">debug easily.</span></p>
			<p>Combined assets are generated once and stored in the <strong class="source-inline">ir.attachment</strong> model. After that, they are served from the attachment. If you want to regenerate assets, you can do so from the debug options, as shown in the <span class="No-Break">following screenshot:</span></p>
			<div>
				<div id="_idContainer120" class="IMG---Figure">
					<img src="image/B20997_14_1.jpg" alt="Figure 14.1 – Screenshot of assets’ activation options"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.1 – Screenshot of assets’ activation options</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">As you know, Odoo will generate an asset only once. This behavior can be a headache during development, as it requires frequent server restarts. To overcome this issue, you can use <strong class="source-inline">dev=xml</strong> in the command line, which will load assets directly, so there will be no <a id="_idTextAnchor746"/>need for a <span class="No-Break">server restart.</span></p>
			<h3>Lazy loading</h3>
			<p>Lazy loading is a <a id="_idIndexMarker993"/>technique that defers loading non-essential resources until they’re needed, often used for images, scripts, or other assets to <span class="No-Break">improve performance:</span></p>
			<pre class="source-code">
await loadAssets({
    jsLibs: ["/web/static/lib/stacktrace-js/stacktrace.js"],
});</pre>			<p>However, implementing lazy loading for specific assets or components in Odoo can be achieved through custom development or by utilizing third-party libraries. Here are some approaches you <span class="No-Break">might consider.</span></p>
			<h3>Lazy loading images</h3>
			<p>You can <a id="_idIndexMarker994"/>implement lazy loading for images using JavaScript libraries such as Intersection Observer. This library allows you to load images only when they enter the <span class="No-Break">user’s viewport.</span></p>
			<ol>
				<li>Using Intersection Observer, JavaScript code could look <span class="No-Break">like this:</span><pre class="source-code">
document.addEventListener("DOMContentLoaded", function () {
    var lazyImages = [].slice.call(document.querySelectorAll("img.lazy"));
    if ("IntersectionObserver" in window) {
        let lazyImageObserver = new \
        IntersectionObserver(function (entries, \
        observer) {
            entries.forEach(function (entry) {
                if (entry.isIntersecting) {
                    let lazyImage = entry.target;
                    lazyImage.src = \
                    lazyImage.dataset.src;
                    lazyImage.classList.remove("lazy");
                    lazyImageObserver.unobserve(lazyImage);
                }
            });
        });
        lazyImages.forEach(function (lazyImage) {
            lazyImageObserver.observe(lazyImage);
        });
    }
});</pre><p class="list-inset">You would then <a id="_idIndexMarker995"/>need to assign the <strong class="source-inline">lazy</strong> class to your <strong class="source-inline">&lt;img&gt;</strong> tags and use the <strong class="source-inline">data-src</strong> attribute for the actual <span class="No-Break">image source.</span></p></li>				<li><strong class="bold">Integrating with Odoo views</strong>: To integrate this with Odoo views, you’d need to add this JavaScript code to your Odoo module’s assets and update your XML templates to apply the <strong class="source-inline">lazy</strong> class and <strong class="source-inline">data-src</strong> <a id="_idTextAnchor747"/>attributes to the <span class="No-Break">image tags.</span></li>
			</ol>
			<h1 id="_idParaDest-652"><a id="_idTextAnchor748"/>Adding CSS and JavaScript for a website</h1>
			<p>Managing assets such as CSS, JavaScript, and other static files can be done through the module’s <a id="_idIndexMarker996"/>asset management system. You can control the loading of these assets <a id="_idIndexMarker997"/>in your module by defining them in your manifest file and linking them to views <span class="No-Break">or templates.</span></p>
			<p>Here’s an overview of how to manage CSS and JavaScript <span class="No-Break">in Odoo.</span></p>
			<h3>Defining assets in module manifest (__manifest__.py)</h3>
			<p>In the <a id="_idIndexMarker998"/>manifest file, specify the assets your <span class="No-Break">module requires:</span></p>
			<pre class="source-code">
'assets': {
       'web.assets_frontend': [
           'my_hostel/static/src/scss/hostel.scss',
           'my_hostel/static/src/js/hostel.js',
       ],
   },</pre>			<p>We will add CSS, SCSS, and JavaScript files, which will modify the website. As we are modifying the website, we will need to add the website as a dependency. Modify the manifest file <span class="No-Break">like this:</span></p>
			<pre class="source-code">
'depends': ['base', 'website'],</pre>			<p>Add some SCSS code to <strong class="source-inline">static/src/scss/hostel.scss</strong>, <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
$my-bg-color: #1C2529;
$my-text-color: #D3F4FF;
nav.navbar {
   background-color: $my-bg-color !important;
   .navbar-nav .nav-link span{
       color: darken($my-text-color, 15);
       font-weight: 600;
   }
}
footer.o_footer {
   background-color: $my-bg-color !important;
   color: $my-text-color;
}</pre>			<p>Add some <a id="_idIndexMarker999"/>JavaScript code to <strong class="source-inline">static/src/js/my_library.js</strong>, <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
/** @odoo-module **/
import { _t } from "@web/core/l10n/translation";
import publicWidget from "@web/legacy/js/public/public_widget";
publicWidget.registry.MyHostel = publicWidget.Widget.extend({
    selector: '#wrapwrap',
    init() {
        this._super(...arguments);
        this.orm = this.bindService("orm");
        alert(_t('Hello world'));
    },
});</pre>			<p>After updating your module, you should see that the Odoo website has custom colors in the menu, body, and footer, and a somewhat annoying Hello World popup on each page load, as shown in the <span class="No-Break">following screenshot:</span></p>
			<div>
				<div id="_idContainer121" class="IMG---Figure">
					<img src="image/B20997_14_2.jpg" alt="Figure 14.2 – Screenshot of Hello World popup from JavaScript code"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.2 – Screenshot of Hello World popup from JavaScript code</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">For CSS/SCSS files, sometimes, order matters. So, if you need to override a style defined in another <a id="_idIndexMarker1000"/>add-on, you will have to ensure that your file is loaded after the original file you want to modify. This can be done by either adjusting your view’s priority field or directly inheriting from the add-on’s view that injects the reference to the <span class="No-Break">CSS file.</span></p>
			<p>We have added basic SCSS. Odoo has built-in support for the SCSS preprocessor. Odoo will automatically compile SCSS files into CSS. In our example, we have used basic SCSS with some variables and the <strong class="source-inline">darken</strong> function to make <strong class="source-inline">$my-text-color</strong> darker by 15%. The SCSS <a id="_idIndexMarker1001"/>preprocessor has tons of other features; if you want to learn more about SCS<a id="_idTextAnchor749"/>S, refer <span class="No-Break">to </span><a href="http://sass-lang.com/"><span class="No-Break">http://sass-lang.com/</span></a><span class="No-Break">.</span></p>
			<h1 id="_idParaDest-653"><a id="_idTextAnchor750"/>Creating or modifying templates</h1>
			<p>Website templates are created using QWeb, a templating language that integrates seamlessly with <a id="_idIndexMarker1002"/>the Odoo framework. These templates are used to <a id="_idIndexMarker1003"/>define the structure and appearance of web pages within the Odoo <span class="No-Break">website module.</span></p>
			<p>Here’s an overview of how to <a id="_idTextAnchor751"/>work with website templates <span class="No-Break">in Odoo.</span></p>
			<h2 id="_idParaDest-654"><a id="_idTextAnchor752"/>Understanding QWeb templates</h2>
			<p>QWeb templates in Odoo allow you to create dynamic web pages using XML-like syntax mixed with <a id="_idIndexMarker1004"/>control structures and placeholders. They enable you to define the structure, co<a id="_idTextAnchor753"/>ntent, and presentation of <span class="No-Break">web pages.</span></p>
			<h2 id="_idParaDest-655"><a id="_idTextAnchor754"/>Creating a basic website template</h2>
			<p>To create <a id="_idIndexMarker1005"/>a simple website template, follow <span class="No-Break">these steps:</span></p>
			<p><strong class="bold">Create a view file</strong>: Create a new XML file within your module’s <span class="No-Break"><strong class="source-inline">views</strong></span><span class="No-Break"> directory:</span></p>
			<pre class="source-code">
&lt;!-- Example: custom_template.xml --&gt;
&lt;template id="custom_template" name="Custom Template"&gt;
    &lt;t t-call="website.layout"&gt;
        &lt;t t-set="page_title"&gt;Custom Page&lt;/t&gt;
        &lt;!-- Your content here --&gt;
        &lt;div class="custom-content"&gt;
            &lt;h1&gt;Welcome to my custom page!&lt;/h1&gt;
            &lt;p&gt;This is a custom template created in Odoo.&lt;/p&gt;
        &lt;/div&gt;
    &lt;/t&gt;
&lt;/template&gt;</pre>			<p>Here’s an explanation of <span class="No-Break">the code:</span></p>
			<ul>
				<li><strong class="source-inline">&lt;template&gt;</strong>: Defines the <span class="No-Break">QWeb template</span></li>
				<li><strong class="source-inline">id</strong>: Unique identifier for <span class="No-Break">the template</span></li>
				<li><strong class="source-inline">name</strong>: Name of <span class="No-Break">the template</span></li>
				<li><strong class="source-inline">&lt;t t-call="website.layout"&gt;</strong>: Indicates that this template inherits from the website’s <span class="No-Break">main layout</span></li>
				<li><strong class="source-inline">&lt;t t-set="page_title"&gt;</strong>: Sets the page <span class="No-Break">title dynamically</span></li>
				<li><strong class="source-inline">&lt;div class="custom-content"&gt;</strong>: Example of content within <span class="No-Break">the template</span></li>
			</ul>
			<p><strong class="bold">Include in the manifest file</strong>: Include <a id="_idIndexMarker1006"/>your view file in the module’s <span class="No-Break">manifest file:</span></p>
			<pre class="source-code">
{
    # Other manifest information
    'data': [
        'views/custom_template.xml',
        # Other XML or CSV files
  <a id="_idTextAnchor755"/>  ],
    # Other manifest information
}</pre>			<h2 id="_idParaDest-656"><a id="_idTextAnchor756"/>Using Odoo Website Builder</h2>
			<p>You can <a id="_idIndexMarker1007"/>also use the Odoo Website Builder interface to create and customize web pages using predefined blocks and templates. This allows for a more visual and interactive way to design web pages<a id="_idTextAnchor757"/> without directly editing <span class="No-Break">XML templates.</span></p>
			<h2 id="_idParaDest-657"><a id="_idTextAnchor758"/>Styling and customization</h2>
			<p>For styling<a id="_idIndexMarker1008"/> and customization, you can use CSS, which can be included within your QWeb templates or as separate files linked to <span class="No-Break">your templates.</span></p>
			<p>Remember—the structure <a id="_idIndexMarker1009"/>and styling of your website templates can vary based on your specific needs and the complexity of the web pages you’re creating. Additionally, consider exploring existing Odoo website modules and official documentation for more detailed and advanced usage of<a id="_idTextAnchor759"/> QWeb templates within the <span class="No-Break">Odoo framework.</span></p>
			<h2 id="_idParaDest-658"><a id="_idTextAnchor760"/>Loops</h2>
			<p>To work on <a id="_idIndexMarker1010"/>recordsets or iterable data types, you need a construct to loop through lists. In the QWeb template, this can be done with the <strong class="source-inline">t-foreach</strong> element. Iteration can happen in a <strong class="source-inline">t</strong> element, in which case its contents are repeated for every member of the iterable that was passed in the <strong class="source-inline">t-foreach</strong> attribute, <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
&lt;t t-foreach="[1, 2, 3, 4, 5]" t-as="num"&gt;
    &lt;p&gt;&lt;t t-esc="num"/&gt;&lt;/p&gt;
&lt;/t&gt;</pre>			<p>This will be rendered <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
&lt;p&gt;1&lt;/p&gt;
&lt;p&gt;2&lt;/p&gt;
&lt;p&gt;3&lt;/p&gt;
&lt;p&gt;4&lt;/p&gt;
&lt;p&gt;5&lt;/p&gt;</pre>			<p>You can also place the <strong class="source-inline">t-foreach</strong> and <strong class="source-inline">t-as</strong> attributes in some arbitrary element, at which point this element and its contents will be repeated for every item in the iterable. Take a look at the following code block. This will generate exactly the same result as the <span class="No-Break">previous example:</span></p>
			<pre class="source-code">
&lt;p t-foreach="[1, 2, 3, 4, 5]" t-as="num"&gt;
    &lt;t t-esc="num"/&gt;
&lt;/p&gt;</pre>			<p>In our example, take a look at the inside of the <strong class="source-inline">t-call</strong> element, where the actual content generation happens. The template expects to be rendered with a context that has a variable called <strong class="source-inline">hostel</strong> set that iterates through it in the <strong class="source-inline">t-foreach</strong> element. The <strong class="source-inline">t-as</strong> attribute is <a id="_idIndexMarker1011"/>mandatory and will be used as the name of the iterator variable to access the iterated data. While the most common use for this construction is to iterate over recordsets, y<a id="_idTextAnchor761"/>ou can use it on any iterable <span class="No-Break">Python object.</span></p>
			<h2 id="_idParaDest-659"><a id="_idTextAnchor762"/>Dynamic attributes</h2>
			<p>QWeb templates <a id="_idIndexMarker1012"/>can set attribute values dynamically. This can be done in the following <span class="No-Break">three ways.</span></p>
			<p>The first way is through <strong class="source-inline">t-att-$attr_name</strong>. At the time of template rendering, an attribute, <strong class="source-inline">$attr_name</strong>, is created; its value can be any valid Python expression. This is computed with the current context and the result is set as the value of the attribute, <span class="No-Break">like this:</span></p>
			<pre class="source-code">
&lt;div t-att-total="10 + 5 + 5"/&gt;</pre>			<p>It will be rendered <span class="No-Break">like this:</span></p>
			<pre class="source-code">
&lt;div total="20"&gt;&lt;/div&gt;</pre>			<p>The second way is through <strong class="source-inline">t-attf-$attr_name</strong>. This is similar to the previous option. The only difference is that only strings between <strong class="source-inline">{{ ..}}</strong> and <strong class="source-inline">#{..}</strong> are evaluated. This is helpful when values are mixed with the strings. It is mostly used to evaluate classes, as in <span class="No-Break">this example:</span></p>
			<pre class="source-code">
&lt;t t-foreach="['info', 'danger', 'warning']" t-as="color"&gt;
    &lt;div t-attf-class="alert alert-#{color}"&gt;
        Simple bootstrap alert
    &lt;/div&gt;
&lt;/t&gt;</pre>			<p>It will be rendered <span class="No-Break">like this:</span></p>
			<pre class="source-code">
&lt;div class="alert alert-info"&gt;
    Simple bootstrap alert
&lt;/div&gt;
&lt;div class="alert alert-danger"&gt;
    Simple bootstrap alert
&lt;/div&gt;
&lt;div class="alert alert-warning"&gt;
    Simple bootstrap alert
&lt;/div&gt;</pre>			<p>The third way is through the <strong class="source-inline">t-att=mapping</strong> option. This option accepts the dictionary after <a id="_idIndexMarker1013"/>the template rendering the dictionary’s data is converted into attributes and values. Take a look at the <span class="No-Break">following example:</span></p>
			<pre class="source-code">
&lt;div t-att="{'id': 'my_el_id', 'class': 'alert alert-danger'}"/&gt;</pre>			<p>After rendering this template, it will be converted into <span class="No-Break">the following:</span></p>
			<pre class="source-code">
&lt;div id="my_el_id" class="alert alert-danger"/&gt;</pre>			<p>In our example, we have used <strong class="source-inline">t-attf-class</strong> to g<a id="_idTextAnchor763"/>et a dynamic background based on <span class="No-Break">index values.</span></p>
			<h2 id="_idParaDest-660"><a id="_idTextAnchor764"/>Fields</h2>
			<p>The <strong class="source-inline">h3</strong> and <strong class="source-inline">div</strong> tags use the <strong class="source-inline">t-field</strong> attribute. The value of the <strong class="source-inline">t-field</strong> attribute must be used with the recordset with a length of one; this allows the user to change the content of the <a id="_idIndexMarker1014"/>web page when they open the website in edit mode. When you save the page, updated values will be stored in the database. Of course, this is subject to a permission check and is only allowed if the current user has write permissions for the displayed record. With an optional <strong class="source-inline">t-options</strong> attribute, you can give a dictionary option to be passed to the field renderer, including the widget to be used. Currently, there is not a vast collection of widgets for the backend, so the choices are a bit limited here. For example, if you want to display an image from the binary field, then you can use the <strong class="source-inline">image</strong> widget <span class="No-Break">like this:</span></p>
			<pre class="source-code">
&lt;span t-field="author.image_small" t-options="{'widget': 'image'}"/&gt;</pre>			<p><strong class="source-inline">t-field</strong> has some limitations. It only works on recordsets, and it cannot work on the <strong class="source-inline">&lt;t&gt;</strong> element. For this, you need to use some HTML elements, such as <strong class="source-inline">&lt;span&gt;</strong> or <strong class="source-inline">&lt;div&gt;</strong>. There is an alternative to the <strong class="source-inline">t-field</strong> attribute, which is <strong class="source-inline">t-esc</strong>. The <strong class="source-inline">t-esc</strong> attribute is not limited to recordsets; it can also be used on any data type, but it is not editable on <span class="No-Break">a website.</span></p>
			<p>Another difference between <strong class="source-inline">t-esc</strong> and <strong class="source-inline">t-field</strong> is that <strong class="source-inline">t-field</strong> shows values based on the user’s language, while <strong class="source-inline">t-esc</strong> shows raw values from the database. For example, for users <a id="_idIndexMarker1015"/>who configured the English language in their preferences and set the <strong class="source-inline">datetime</strong> field as used with <strong class="source-inline">t-field</strong>, the result will be rendered in <strong class="source-inline">12/15/2023 14:17:15</strong> format. In contrast, if the <strong class="source-inline">t-esc</strong> attribute is used, then the result will be in a<a id="_idTextAnchor765"/> rendered format like this: <span class="No-Break"><strong class="source-inline">2023-12-15 21:12:07</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-661"><a id="_idTextAnchor766"/>Conditionals</h2>
			<p>Note that the division showing the publication date is wrapped by a <strong class="source-inline">t</strong> element with the <strong class="source-inline">t-if</strong> attribute set. This attribute is evaluated as Python code, and the element is only rendered if the <a id="_idIndexMarker1016"/>result is a truthy value. In the following example, we only show the <strong class="source-inline">div</strong> class if there is actually a publication date set. However, in complex cases, you can use <strong class="source-inline">t-elif</strong> and <strong class="source-inline">t-else</strong>, as in the <span class="No-Break">following example:</span></p>
			<pre class="source-code">
&lt;div t-if="state == 'new'"&gt;
    Text will be added if the state is new.
&lt;/div&gt;
&lt;div t-elif="state == 'progress'"&gt;
    Text will be added if the state is progress.
&lt;/div&gt;
&lt;div t-else=""&gt;
  <a id="_idTextAnchor767"/>  Text will be added for all other stages.
&lt;/div&gt;</pre>			<h2 id="_idParaDest-662"><a id="_idTextAnchor768"/>Setting variables</h2>
			<p>The QWeb <a id="_idIndexMarker1017"/>template is also capable of defining the variable in the template itself. After defining the template, you can use the variable in the subsequent template. You can set the variable <span class="No-Break">like this:</span></p>
			<pre class="source-code">
&lt;t t-<a id="_idTextAnchor769"/>set="my_var" t-value="5 + 1"/&gt;
&lt;t t-esc="my_var"/&gt;</pre>			<h2 id="_idParaDest-663"><a id="_idTextAnchor770"/>Subtemplates</h2>
			<p>If you are developing a big application, managing large templates can be difficult. The QWeb template <a id="_idIndexMarker1018"/>supports subtemplates, so you can divide large templates into smaller subtemplates and you can reuse them in multiple templates. For subtemplates, you can use a <strong class="source-inline">t-call</strong> attribute, as in <span class="No-Break">this example:</span></p>
			<pre class="source-code">
&lt;template id="first_template"&gt;
    &lt;div&gt; Test Template &lt;/div&gt;
&lt;/template&gt;
&lt;template id="second_temp<a id="_idTextAnchor771"/>late"&gt;
    &lt;t t-call="first_template"/&gt;
&lt;/template&gt;</pre>			<h2 id="_idParaDest-664"><a id="_idTextAnchor772"/>Inline editing</h2>
			<p>The user will be able to modify records directly from the website in edit mode. The data loaded with the <strong class="source-inline">t-field</strong> node will be editable by default. If the user changes the value in such a <a id="_idIndexMarker1019"/>node and saves the page, the values will also be updated in the backend. Don’t worry; in order to update the record, a user will need write permissions on the record. Note that <strong class="source-inline">t-field</strong> only works on a recordset. To display other types of data, you can use <strong class="source-inline">t-esc</strong>. This works exactly like <strong class="source-inline">t-field</strong>, but the only difference is that <strong class="source-inline">t-esc</strong> is not editable and can be used with any type <span class="No-Break">of data.</span></p>
			<p>If you want to enable snippet drag-and-drop support on the page, you can use the <strong class="source-inline">oe_structure</strong> class. In our example, we have added this at the top of the template. Using <strong class="source-inline">oe_structure</strong> will enable editing and snippet <span class="No-Break">drag-and-drop support.</span></p>
			<p>If you want to disable the website editing feature on a block, you can use the <strong class="source-inline">contenteditable=False</strong> attribute. This makes an element read-only. We have used this attribute in the last <strong class="source-inline">&lt;</strong><span class="No-Break"><strong class="source-inline">section&gt;</strong></span><span class="No-Break"> tag.</span></p>
			<p class="callout-heading">Note</p>
			<p class="callout">To make the page multi-website compatible, when you edit a page/view through the website editor, Odoo will create a separate copy of the page for that website. This means that subsequent code updates will never make it to the edited website page. In order to also get the ease of use of inline editing and the possibility of updating your HTML code in subsequent releases, create one view that contains semantic HTML elements and a second one that injects editable elements. Then, only the latter view will be copied, and you can still have updates for the <span class="No-Break">parent view.</span></p>
			<p>For the other <a id="_idIndexMarker1020"/>CSS classes used here, consult <span class="No-Break">Bootstrap’s documentation.</span></p>
			<p>In <em class="italic">step 1</em>, we have declared the route to render the template. If you noticed, we have used the <strong class="source-inline">website=True</strong> parameter in <strong class="source-inline">route()</strong>, which will pass some extra context in the template, such as menus, user language, company, and so on. This will be used in <strong class="source-inline">website.layout</strong> to render the menus and footers. The <strong class="source-inline">website=True</strong> parameter also enables multi-language support <a id="_idTextAnchor773"/>in a website and displays exceptions in a <span class="No-Break">better way.</span></p>
			<h1 id="_idParaDest-665"><a id="_idTextAnchor774"/>Managing dynamic routes</h1>
			<p>In website <a id="_idIndexMarker1021"/>development projects, it is often the case that we need to create pages with dynamic URLs. For example, in e-commerce, each product has a detailed page linked with a different URL. In this recipe<a id="_idTextAnchor775"/>, we will create a web page to display <span class="No-Break">hostel detai<a id="_idTextAnchor776"/>ls.</span></p>
			<h2 id="_idParaDest-666"><a id="_idTextAnchor777"/>Getting ready</h2>
			<p>Add basic fields in the <span class="No-Break"><strong class="source-inline">hostel</strong></span><span class="No-Break"> model:</span></p>
			<pre class="source-code">
from odoo import fields, models
class Hostel(models.Model):
   _name = 'hostel.hostel'
   _description = "Information about hostel"
   _order = "id desc, name"
   _rec_name = 'hostel_code'
   name = fields.Char(string="hostel Name", required=True)
   hostel_code = fields.Char(string="Code", required=True)
   street = fields.Char('Street')
   street2 = fields.Char('Street2')
   zip = fields.Char('Zip', change_default=True)
   city = fields.Char('City')
   state_id = fields.Many2one("res.country.state", string='State')
   country_id = fields.Many2one('res.country', string='Country')
   phone = fields.Char('Phone',required=True)
   mobile = fields.Char('Mobile',required=True)
   email = fields.Char('Email')
   hostel_floors = fields.Integer(string="Total Floors")
   image = fields.Binary('Hostel Image')
   active = fields.Boolean("Active", default=True,
       help="Activate/Deactivate hostel record")
   type = fields.Selection([("male", "Boys"), ("female", "Girls"),
       ("common", "Common")], "Type", help="Type of Hostel",
       required=True, default="common")
   other_info = fields.Text("Other Information",
       help="Enter more information")
   description = fields.Html('Description')
   hostel_rating = fields.Float('Hostel Average Rating', digits=(14, 4))</pre>			<h2 id="_idParaDest-667"><a id="_idTextAnchor778"/>How to do it…</h2>
			<p>Follow these <a id="_idIndexMarker1022"/>steps to generate a details page for <span class="No-Break">the hostel:</span></p>
			<ol>
				<li>Add a new route for hostel details in <strong class="source-inline">main.py</strong>, <span class="No-Break">as follows:</span><pre class="source-code">
@http.route('/hostel/&lt;model("hostel.hostel"):hostel&gt;', type='http', auth="user", website=True)
def hostel_room_detail(self, hostel):
    return request.render(
        'my_hostel.hostel_detail', {
            'hostel': hostel,
        })</pre></li>				<li>Add a new template for hostel details in <strong class="source-inline">hostel_templates.xml</strong>, <span class="No-Break">as follows:</span><pre class="source-code">
&lt;template id="hostel_detail" name="Hostel Detail"&gt;
   &lt;t t-call="website.layout"&gt;
       &lt;div class="container"&gt;
           &lt;div class="row mt16"&gt;
               &lt;div class="col-5"&gt;
                   &lt;span t-field="hostel.image" t-options="{
                       'widget': 'image',
                       'class': 'mx-auto d-block img-thumbnail'}"/&gt;
               &lt;/div&gt;
               &lt;div class="offset-1 col-6"&gt;
                   &lt;h1 t-field="hostel.name"/&gt;
                   &lt;p t-esc="hostel.hostel_rating"&gt;&lt;/p&gt;
                   &lt;t t-if="hostel.hostel_code"&gt;
                       &lt;div t-field=
                       "hostel.hostel_code"
                       class="text-muted"/&gt;
                   &lt;/t&gt;
                   &lt;b class="mt8"&gt; State: &lt;/b&gt;
                   &lt;ul&gt;
                       &lt;li t-foreach="hostel.state_id" t-as="state"&gt;
                           &lt;span t-esc="state.name" /&gt;
                       &lt;/li&gt;
                   &lt;/ul&gt;
               &lt;/div&gt;
           &lt;/div&gt;
       &lt;/div&gt;
       &lt;div t-field="hostel.description"/&gt;
   &lt;/t&gt;
&lt;/template&gt;</pre></li>				<li>Add a button in <a id="_idIndexMarker1023"/>the hostel list template, as follows. This button will redirect to the hostel details <span class="No-Break">web page:</span><pre class="source-code">
...
&lt;div t-attf-class="card mt24 #{'bg-light' if hostel_rating else ''}"&gt;
    &lt;div class="card-body"&gt;
        &lt;h3 t-field="hostel.name"/&gt;
        &lt;t t-if="hostel.hostel_rating"&gt;
            &lt;div t-field="hostel.hostel_rating"
            class="text-muted"/&gt;
        &lt;/t&gt;
        &lt;b class="mt8"&gt; Authors &lt;/b&gt;
        &lt;ul&gt;
            &lt;li t-foreach="hostel.state_id"
            t-as="state"&gt;
                &lt;span t-esc="state.name" /&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
        &lt;a t-attf-href="/hostel/#{hostel.id}"
        class="btn btn-primary btn-sm"&gt;
            &lt;i class="fa fa-building"/&gt; Hostel Detail
        &lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;
...</pre></li>			</ol>
			<p>Update the <strong class="source-inline">my_hostel</strong> module to apply changes. After the update, you will see hostel details page links on the hostel card. Upon c<a id="_idTextAnchor779"/>licking those links, the hostel details pages <span class="No-Break">will open.</span></p>
			<h2 id="_idParaDest-668"><a id="_idTextAnchor780"/>How it works…</h2>
			<p>In <em class="italic">step 1</em>, we created a dynamic route for the hostel details page. In this route, we added <strong class="source-inline">&lt;model("hostel.hostel"):hostel&gt;</strong>. This accepts URLs with integers, as in <strong class="source-inline">/hostel/1</strong>. Odoo considers this integer as the ID of the <strong class="source-inline">hostel.hostel</strong> model, and when this <a id="_idIndexMarker1024"/>URL is accessed, Odoo fetches a recordset and passes it to the function as the argument. So, when <strong class="source-inline">/hostel/1</strong> is accessed from the browser, the <strong class="source-inline">hostel</strong> parameter in the <strong class="source-inline">hostel_detail()</strong> function will have a recordset of the <strong class="source-inline">hostel.hostel</strong> model with the ID <strong class="source-inline">1</strong>. We passed this <strong class="source-inline">hostel</strong> recordset and rendered a new template <span class="No-Break">called </span><span class="No-Break"><strong class="source-inline">my_hostel.hostel2_detail</strong></span><span class="No-Break">.</span></p>
			<p>In <em class="italic">step 2</em>, we created a new QWeb template called <strong class="source-inline">hostel_detail</strong> to render a hostel details page. This is simple and is created using the Bootstrap structure. If you check, we have added <strong class="source-inline">html_description</strong> in the details page. The <strong class="source-inline">html_description</strong> field has a field type of HTML, so you can store HTML data in the field. Odoo automatically adds snippet drag-and-drop support to HTML types of fields. So, we are now able to use snippets in the hostel details page. The snippets dropped in the HTML fields are stored in a hostel’s records, so you can design different content for <span class="No-Break">different records.</span></p>
			<p>In <em class="italic">step 3</em>, we added a link with the anchor tag so that a visitor can be redirected to the hostel <span class="No-Break">details page.</span></p>
			<p class="callout-heading">Note</p>
			<p class="callout">The model route also supports domain filtering. For example, if you want to restrict some records based on a condition, you can do so by passing the domain to the route <span class="No-Break">as follows:</span></p>
			<p class="callout"><strong class="source-inline">/hostel/&lt;model("hostel.hostel", "[(name','!=', '</strong><span class="No-Break"><strong class="source-inline">Hostel 1')]"):hostel&gt;</strong></span></p>
			<p class="callout">This will <a id="_idTextAnchor781"/>restrict access to the hostel that has the name <span class="No-Break"><strong class="source-inline">Hostel 1</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-669"><a id="_idTextAnchor782"/>There’s more...</h2>
			<p>Odoo uses <strong class="source-inline">werkzeug</strong> to handle HTTP requests. Odoo adds a thin wrapper around <strong class="source-inline">werkzeug</strong> to easily handle routes. You saw the <strong class="source-inline">&lt;model("hostel.hostel"):hostel&gt;</strong> route in the last example. This is Odoo’s own <a id="_idIndexMarker1025"/>implementation, but it also supports all features from the <strong class="source-inline">werkzeug</strong> routing. Consequently, you can use routing <span class="No-Break">like this:</span></p>
			<ul>
				<li><strong class="source-inline">/page/&lt;int:page&gt;</strong> accepts <span class="No-Break">integer values</span></li>
				<li><strong class="source-inline">/page/&lt;any(about, help):page_name&gt;</strong> accepts <span class="No-Break">selected values</span></li>
				<li><strong class="source-inline">/pages/&lt;page&gt;</strong> <span class="No-Break">accepts strings</span></li>
				<li><strong class="source-inline">/pages/&lt;category&gt;/&lt;int:page&gt;</strong> accepts <span class="No-Break">multiple values</span></li>
			</ul>
			<p>There are lots of variations available for routes, which you can r<a id="_idTextAnchor783"/>ead about <span class="No-Break">at </span><a href="http://werkzeug.pocoo.org/docs/0.14/routing/"><span class="No-Break">http://werkzeug.pocoo.org/docs/0.14/routing/</span></a><span class="No-Break">.</span></p>
			<h1 id="_idParaDest-670"><a id="_idTextAnchor784"/>Offering static snippets to the user</h1>
			<p>Static snippets are reusable components or blocks of HTML, CSS, and JavaScript that can be inserted <a id="_idIndexMarker1026"/>into website pages using Website Builder. These snippets allow for easy customization and construction of web pages without needing to write code <span class="No-Break">from scratch.</span></p>
			<p>Odoo’s website editor offers several editing building blocks, which can be dragged onto the page and edited according to your needs. This recipe will cover how to offer your own building blocks. These blocks are referred to as snippets. There are several types of snippets, but in general, we can categorize them into two types: static and dynamic. A static snippet is fixed and does not change until the user changes it. Dynamic snippets depend on database records and are changed based on record values. <a id="_idTextAnchor785"/>In this recipe, we will see how to create a <span class="No-Break">static snippet.</span></p>
			<h2 id="_idParaDest-671"><a id="_idTextAnchor786"/>How to do it…</h2>
			<p>A snippet is actually just a QWeb view that gets injected into the <strong class="bold">Insert blocks </strong>bar. We will create a small snippet that will show the hostel’s image and its title. You will be able to drag <a id="_idIndexMarker1027"/>and drop the snippet on the page, and you will be able to edit the image and text. Follow these steps to add a new <span class="No-Break">static snippet:</span></p>
			<ol>
				<li>Add a file called <strong class="source-inline">views/snippets.xml</strong>, as follows (do not forget to register the file in <span class="No-Break">the manifest):</span></li>
				<li>Add a QWeb template for the snippet in <strong class="source-inline">views/snippets.xml</strong>, <span class="No-Break">as follows:</span><pre class="source-code">
&lt;template id="snippet_hostel_card" name="Hostel Card"&gt;
       &lt;section class="pt-3 pb-3"&gt;
           &lt;div class="container"&gt;
               &lt;div class="row align-items-center"&gt;
                   &lt;div class="col-lg-6 pt16 pb16"&gt;
                       &lt;h1&gt;This is Hostel Card Block&lt;/h1&gt;
                       &lt;p&gt;
                           Learn snippet development
                           quickly with examples
                        &lt;/p&gt;
                       &lt;a class="btn btn-primary"
                       href="#" &gt;Hostel Details&lt;/a&gt;
                   &lt;/div&gt;
                   &lt;div class="col-lg-6 pt16 pb16"&gt;
                       &lt;img
                         src="/my_hostel/static/src/img/cover.jpeg"
                         class="mx-auto img-thumbnail w-50 img img-fluid shadow"/&gt;
                   &lt;/div&gt;
               &lt;/div&gt;
          &lt;/div&gt;
    &lt;/section&gt;
&lt;/template&gt;</pre></li>				<li>List the template <a id="_idIndexMarker1028"/>in the snippet list <span class="No-Break">like this:</span><pre class="source-code">
&lt;template id="hostel_snippets_options" inherit_id="website.snippets"&gt;
    &lt;xpath    expr="//div[@id='snippet_structure']/div[hasclass('o_panel_body')]" position="inside"&gt;
        &lt;t t-snippet="my_hostel.snippet_hostel_card"
         t-thumbnail="/my_hostel/static/src/img/s_hostel_thumb.png"/&gt;
    &lt;/xpath&gt;
&lt;/template&gt;</pre></li>				<li>Add the cover image and snippet thumbnail image in the <strong class="source-inline">/</strong><span class="No-Break"><strong class="source-inline">my_hostel/static/src/img</strong></span><span class="No-Break"> directory.</span></li>
			</ol>
			<p>Restart the server and update the <strong class="source-inline">my_hostel</strong> module to apply the changes. When you open the website page in edit mode, you will be able to see our snippet in the snippets<a id="_idTextAnchor787"/> <span class="No-Break">blocks panel:</span></p>
			<div>
				<div id="_idContainer122" class="IMG---Figure">
					<img src="image/B20997_14_3.jpg" alt="Figure 14.3 – Screenshot of static snippet"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.3 – Screenshot of static snippet</p>
			<h2 id="_idParaDest-672"><a id="_idTextAnchor788"/>How it works…</h2>
			<p>A static snippet is nothing but a block of HTML code. In <em class="italic">step 1</em>, we created a QWeb template with our HTML for the hostel block. In this HTML, we have just used a Bootstrap column <a id="_idIndexMarker1029"/>structure, but you can use any HTML code. Note that the HTML code you add in the snippet’s QWeb template will be added to the page when you drag and drop. In general, it is a good idea to use <strong class="source-inline">section</strong> elements and Bootstrap classes for snippets, because for them, Odoo’s editor offers edit, background, and resize controls out of <span class="No-Break">the box.</span></p>
			<p>In <em class="italic">step 2</em>, we registered our snippet in the snippet list. You will need to inherit <strong class="source-inline">website.snippets</strong> to register a snippet. In the website editor GUI, snippets are divided into different sections based on their usage. In our example, we have registered our snippet in the <strong class="source-inline">Structure</strong> section via <strong class="source-inline">xpath</strong>. To list your snippet, you need to use a <strong class="source-inline">&lt;t&gt;</strong> tag with the <strong class="source-inline">t-snippet</strong> attribute. The <strong class="source-inline">t-snippet</strong> attribute will have the XML ID of the QWeb template, which is <strong class="source-inline">my_hostel.snippet_hostel_card</strong> in our example. You will also need to use the <strong class="source-inline">t-thumbnail</strong> attribute, which is used to show a small snippet image in the <span class="No-Break">website editor.</span></p>
			<p class="callout-heading">Note</p>
			<p class="callout">The <strong class="source-inline">website.snippets</strong> template contains all the default snippets, and you can learn more about it by exploring the <strong class="source-inline">/</strong><span class="No-Break"><strong class="source-inline">addons/website/views/snippets/snippets.xml</strong></span><span class="No-Break"> file.</span></p>
			<p class="callout">Odoo will add some default options to your snippets when you have a proper Bootstrap structure. For example, in our snippet, you would be able to set a background color, a background image, width, height, and so on. Explore the <strong class="source-inline">/addons/website/views/snippets/snippets.xml</strong> file to see all the snippet options. In the next recipe, we will see how to add our <span class="No-Break">own options.</span></p>
			<p>In <em class="italic">step 3</em>, we listed our <a id="_idIndexMarker1030"/>snippet under the <strong class="source-inline">structure</strong> block. Once you update the module, you will be able to drag and drop the snippet<a id="_idTextAnchor789"/>. In <em class="italic">step 4</em>, we just added an image for the <span class="No-Break">snippet thumbnail.</span></p>
			<h2 id="_idParaDest-673"><a id="_idTextAnchor790"/>There’s more…</h2>
			<p>In such cases, there will be no need for extra JavaScript. Odoo’s editor offers lots of options and controls out of the box, and they are more than enough for static snippets. You will find all existing snippets and options <span class="No-Break">at </span><span class="No-Break"><strong class="source-inline">website/views/snippets.xml</strong></span><span class="No-Break">.</span></p>
			<p>Snippet options also support the <strong class="source-inline">data-exclude</strong>, <strong class="source-inline">data-drop-near</strong>, and <strong class="source-inline">data-drop-in</strong> attributes, which determine where a snippet can be placed when dragging it out of the snippet bar. These are also jQuery selectors, but in <em class="italic">step 3</em> of this recipe, we didn’t use them, because we all<a id="_idTextAnchor791"/>ow putting the snippet basically anywhere that content <span class="No-Break">can go.</span></p>
			<h1 id="_idParaDest-674"><a id="_idTextAnchor792"/>Offering dynamic snippets to the user</h1>
			<p>Dynamic snippets refer to reusable components or blocks that are capable of displaying dynamic content <a id="_idIndexMarker1031"/>pulled from various sources such as databases, models, or external services. These snippets enable the creation of versatile and adaptable web pages that display real-time or <span class="No-Break">context-specific information.</span></p>
			<p>Identify <span class="No-Break">data sources:</span></p>
			<ul>
				<li>Determine the data sources you want to use in your dynamic snippet. This can include Odoo models, databases, APIs, and <span class="No-Break">so on.</span></li>
				<li>Implement dynamic placeholders using QWeb templating tags (<strong class="source-inline">{% %}</strong>) or Odoo-specific directives (<strong class="source-inline">&lt;t </strong><span class="No-Break"><strong class="source-inline">t-foreach="..." t-as="..."&gt;</strong></span><span class="No-Break">).</span></li>
			</ul>
			<p>We will see how we can create dynamic snippe<a id="_idTextAnchor793"/>ts for Odoo. We will generate content based on <span class="No-Break">database values.</span></p>
			<h2 id="_idParaDest-675"><a id="_idTextAnchor794"/>How to do it…</h2>
			<p>Perform the <a id="_idIndexMarker1032"/>following steps to add a dynamic snippet that shows a list of <span class="No-Break">hostel data:</span></p>
			<ol>
				<li>Add a given QWeb template for the snippet <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">views/snippets.xml</strong></span><span class="No-Break">:</span><pre class="source-code">
&lt;template id="snippet_hostel_dynamic" name="Hostel Dynamic"&gt;
    &lt;section class="hostel_list"&gt;
        &lt;div class="container"&gt;
            &lt;h2&gt;Hostel&lt;/h2&gt;
            &lt;table class="table hostel_snippet table-striped"
                   data-number-of-hostel="5"&gt;
                &lt;tr&gt;
                    &lt;th&gt;Name&lt;/th&gt;
                    &lt;th&gt;Available date&lt;/th&gt;
                &lt;/tr&gt;
            &lt;/table&gt;
        &lt;/div&gt;
    &lt;/section&gt;
&lt;/template&gt;</pre></li>				<li>Register the snippet and add an option to change the <span class="No-Break">snippet behavior:</span><pre class="source-code">
&lt;template id="hostel_snippets_options"
           inherit_id="website.snippets"&gt;
    &lt;!-- register snippet --&gt;
    &lt;xpath expr="//div[@id='snippet_structure']/
                 div[hasclass('o_panel_body')]"
           position="inside"&gt;
        &lt;t t-snippet="my_hostel.snippet_hostel_dynamic"
           t-thumbnail="/my_hostel/static/src/img/s_list.png"/&gt;
    &lt;/xpath&gt;
    &lt;xpath expr="//div[@id='snippet_options']" position="inside"&gt;
  &lt;!--Add step 3 here --&gt;
    &lt;/xpath&gt;
&lt;/template&gt;</pre></li>				<li>Then, add <a id="_idIndexMarker1033"/>snippet options for the <span class="No-Break">hostel snippet:</span><pre class="source-code">
&lt;div data-selector=".hostel_snippet"&gt;
    &lt;we-select string="Table Style"&gt;
        &lt;we-button data-select-class="table-striped"&gt;
                Striped
        &lt;/we-button&gt;
        &lt;we-button data-select-class="table-dark"&gt;
                Dark
        &lt;/we-button&gt;
        &lt;we-button data-select-class="table-bordered"&gt;
                Bordered
        &lt;/we-button&gt;
    &lt;/we-select&gt;
    &lt;we-button-group string="No of Rooms"
        data-attribute-name="numberOfRooms"&gt;
        &lt;we-button data-select-data-attribute="5"&gt;
                5
        &lt;/we-button&gt;
        &lt;we-button data-select-data-attribute="10"&gt;
                10
        &lt;/we-button&gt;
        &lt;we-button data-select-data-attribute="15"&gt;
                15
        &lt;/we-button&gt;
    &lt;/we-button-group&gt;
&lt;/div&gt;</pre></li>				<li>Add a new <strong class="source-inline">/static/src/snippets.js</strong> file and add code to render a <span class="No-Break">dynamic snippet.</span></li>
				<li>Add a <strong class="source-inline">public</strong> widget to <a id="_idIndexMarker1034"/>render the hostel <span class="No-Break">snippet dynamically:</span><pre class="source-code">
/** @odoo-module **/
import { _t } from "@web/core/l10n/translation";
import publicWidget from "@web/legacy/js/public/public_widget";
publicWidget.registry.HostelSnippet = publicWidget.Widget.extend({
   selector: '.hostel_snippet',
   disabledInEditableMode: false,
   start: function () {
       var self = this;
       var rows = this.$el[0].dataset.numberOfRooms || '5';
       this.$el.find('td').parents('tr').remove();
       this._rpc({
           model: 'hostel.hostel',
           method: 'search_read',
           domain: [],
           fields: ['name', 'hostel_code'],
           orderBy: [{ name: 'hostel_code', asc: false }],
           limit: parseInt(rows)
       }).then(function (data) {
           _.each(data, function (hostel) {
               self.$el.append(
                   $('&lt;tr /&gt;').append(
                       $('&lt;td /&gt;').text(hostel.name),
                       $('&lt;td /&gt;').text(hostel.hostel_code)
                   ));
           });
       });
   },
});</pre></li>				<li>Load the JavaScript file to the <span class="No-Break"><strong class="source-inline">__manifest__.py</strong></span><span class="No-Break"> module:</span><pre class="source-code">
'assets': {
       'web.assets_frontend': [
           'my_hostel/static/src/js/snippets.js',
       ],
},</pre></li>			</ol>
			<p>After updating the module, you will be offered a new snippet called <strong class="source-inline">Hostels</strong>, which has an option to change the number of recently added rooms. We have also added the option to change the<a id="_idTextAnchor795"/> table design, which can be displayed when you click on <span class="No-Break">the table.</span></p>
			<h2 id="_idParaDest-676"><a id="_idTextAnchor796"/>How it works…</h2>
			<p>In <em class="italic">step 1</em>, we added a <a id="_idIndexMarker1035"/>QWeb template for the new snippet (it is just like the previous recipe). Note that we added a basic structure for the table. We will dynamically add lines for the hostel in <span class="No-Break">the table.</span></p>
			<p>In <em class="italic">step 2</em>, we registered our dynamic snippet and added custom options to change the behavior of our dynamic snippet. The first option we added is <strong class="source-inline">Table Style</strong>. It will be used to change the style of the table. The second option we added is <strong class="source-inline">No of Rooms</strong>. We used the <strong class="source-inline">&lt;we-select&gt;</strong> and <strong class="source-inline">&lt;we-button-group&gt;</strong> tags for our options. These tags will provide different GUIs to the snippet option. The <strong class="source-inline">&lt;we-select&gt;</strong> tag will show the options as a dropdown, while the <strong class="source-inline">&lt;we-button-group&gt;</strong> tag will show the options as a button group. There are several other GUI options, such as <strong class="source-inline">&lt;we-checkbox&gt;</strong> and <strong class="source-inline">&lt;we-colorpicker&gt;</strong>. You can explore more GUI options in the <strong class="source-inline">/</strong><span class="No-Break"><strong class="source-inline">addons/website/views/snippets/snippets.xml</strong></span><span class="No-Break"> file.</span></p>
			<p>If you look at the options closely, you will see we have <strong class="source-inline">data-select-class</strong> and <strong class="source-inline">data-select-data-attribute</strong> attributes for the option buttons. This will let Odoo know which attribute to change when the user chooses an option. <strong class="source-inline">data-select-class</strong> will set the class attribute on the element when the user chooses this option, while <strong class="source-inline">data-select-data-attribute</strong> will set the custom attribute and value on the element. Note that it will use the value of <strong class="source-inline">data-attribute-name</strong> to set <span class="No-Break">the attribute.</span></p>
			<p>Now, we have added the snippet options. If you drag and drop the snippet at this point, you will only see the table header and the snippet options. Changing the snippet options will change the table style, but there is no hostel data yet. For that, we need to write some JavaScript <a id="_idIndexMarker1036"/>code that will fetch the data and display it in the table. In <em class="italic">step 3</em>, we added JavaScript code that will render the hostel data in the table. To map a JavaScript object to an HTML element, Odoo uses <strong class="source-inline">PublicWidget</strong>. Now, <strong class="source-inline">PublicWidget</strong> is available through <strong class="source-inline">import publicWidget from "@web/legacy/js/public/public_widget";</strong>. The key attribute in using <strong class="source-inline">PublicWidget</strong> is the <strong class="source-inline">selector</strong> attribute. In the <strong class="source-inline">selector</strong> attribute, you will need to use the CSS selector of the element, and Odoo will automatically bind the element with <strong class="source-inline">PublicWidget</strong>. You can access the related element in the <strong class="source-inline">$el</strong> attribut<a id="_idTextAnchor797"/>e. The rest of the code is basic JavaScript and jQuery <span class="No-Break">except </span><span class="No-Break"><strong class="source-inline">_rpc</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-677"><a id="_idTextAnchor798"/>There’s more…</h2>
			<p>If you want to create your own snippet option, you can use the <strong class="source-inline">t-js</strong> option on the snippet option. After that, you will need to define your own option in the JavaScript code. Explore the <strong class="source-inline">addons/website/static/src/js/edit<a id="_idTextAnchor799"/>or/snippets.options.js</strong>     file to learn more about <span class="No-Break">snippet options.</span></p>
			<h1 id="_idParaDest-678"><a id="_idTextAnchor800"/>Getting input from website users</h1>
			<p>In Odoo, you can collect input from website users through forms, surveys, or interactive elements <a id="_idIndexMarker1037"/>integrated into your website. Odoo provides functionalities to create forms easily and manage the data collected from these forms. Here’s how you can set up <span class="No-Break">input collection.</span></p>
			<ul>
				<li>Submitted form data is typically stored in the database as records of a specific model associated with <span class="No-Break">the form</span></li>
				<li>Access the collected data either through the website backend or by configuring views to display the <span class="No-Break">form submissions</span></li>
				<li>Optionally, you can link the form submissions to specific models in Odoo, allowing you to manage and process the data within the <a id="_idTextAnchor801"/><span class="No-Break">Odoo backend</span></li>
				<li>Define models and fields to store the form <span class="No-Break">data securely</span></li>
			</ul>
			<h2 id="_idParaDest-679"><a id="_idTextAnchor802"/>Getting ready</h2>
			<p>For this recipe, we will be using the <strong class="source-inline">my_hostel</strong> module. We will need a new model to store hostel booking inquiries submitted <span class="No-Break">by users.</span></p>
			<p>So, before <a id="_idIndexMarker1038"/>starting this recipe, modify the previous code and create one new model for booking <span class="No-Break">inquiries, </span><span class="No-Break"><strong class="source-inline">my_hostel/models/inquiries.py</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
from odoo import fields, models
class Inquiries(models.Model):
    _name = 'hostel.inquiries'
    _description = "Inquiries about hostel"
    _order = "id desc,"
    name = fields.Char(string="Student Name", required=True)
    phone = fields.Char(string="Phone", required=True)
    email = fields.Char(string="Email")
    book_fy = fields.Char(string="Book for Year")
    queries = fields.Html(string="Your Question", required=True)</pre>			<p>Now, create menus, actions, and views in the backend to store the submitted data from the website <span class="No-Break">inquiries form.</span></p>
			<p>For that, create <a id="_idIndexMarker1039"/>an XML file in <strong class="source-inline">my_hostel/views/inquiries_view.xml</strong>, then add menus, actions, and its basic tree and <span class="No-Break">form view:</span></p>
			<pre class="source-code">
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;odoo&gt;
    &lt;data&gt;
        &lt;record id="view_hostel_inquiry_tree" model="ir.ui.view"&gt;
            &lt;field name="name"&gt;hostel.inquiry.tree&lt;/field&gt;
            &lt;field name="model"&gt;hostel.inquiries&lt;/field&gt;
            &lt;field name="arch" type="xml"&gt;
                &lt;tree string="Inquiries"&gt;
                    &lt;field name="name"/&gt;
                    &lt;field name="phone"/&gt;
                    &lt;field name="email"/&gt;
                    &lt;field name="book_fy"/&gt;
                &lt;/tree&gt;
            &lt;/field&gt;
        &lt;/record&gt;
        &lt;record id="view_hostel_inquiry_form" model="ir.ui.view"&gt;
            &lt;field name="name"&gt;hostel.inquiry.form&lt;/field&gt;
            &lt;field name="model"&gt;hostel.inquiries&lt;/field&gt;
            &lt;field name="arch" type="xml"&gt;
                &lt;form string="Inquiries"&gt;
                    &lt;sheet&gt;
                        &lt;div class="oe_title"&gt;
                            &lt;h3&gt;
                                &lt;table&gt;
                                    &lt;tr&gt;
                                        &lt;td style="padding-right:10px;"&gt;&lt;field name="name" required="1"
                                        placeholder="Name" /&gt;&lt;/td&gt;
                                    &lt;/tr&gt;
                                &lt;/table&gt;
                            &lt;/h3&gt;
                        &lt;/div&gt;
                        &lt;group&gt;
                            &lt;group&gt;
                                &lt;field name="phone"/&gt;
                                &lt;field name="email"/&gt;
                                &lt;field name="book_fy"/&gt;
                            &lt;/group&gt;
                        &lt;/group&gt;
                        &lt;group&gt;
                            &lt;field name="queries"/&gt;
                        &lt;/group&gt;
                    &lt;/sheet&gt;
                &lt;/form&gt;
            &lt;/field&gt;
        &lt;/record&gt;
        &lt;record model="ir.actions.act_window"
        id="action_inquiry"&gt;
            &lt;field name="name"&gt;Inquiries&lt;/field&gt;
            &lt;field name="type"&gt;
            ir.actions.act_window&lt;/field&gt;
            &lt;field name="res_model"&gt;
            hostel.inquiries&lt;/field&gt;
            &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;
            &lt;field name="help" type="html"&gt;
                &lt;p class="oe_view_nocontent_create"&gt;
                    Create Inquiries.
                &lt;/p&gt;
            &lt;/field&gt;
        &lt;/record&gt;
        &lt;menuitem id="hostel_inquiry_main_menu" name="Inquiries"
        parent="hostel_main_menu" sequence="2" /&gt;
        &lt;menuitem id="hostel_inquiry_menu" name="Inquiries"
        parent="hostel_inquiry_main_menu"
            action="my_hostel.action_inquiry"
            groups="my_hostel.group_hostel_manager"
            sequence="1"/&gt;
    &lt;/data&gt;
&lt;/odoo&gt;</pre>			<p>Now, create a basic form to get the details from the customers, which is published on the website page. Once a user has submitted that form, all the filled data will be stored in the <span class="No-Break"><strong class="source-inline">Inquiries</strong></span><span class="No-Break"> table.</span></p>
			<p>For that, create <a id="_idIndexMarker1040"/>a new folder in the <span class="No-Break">module, </span><span class="No-Break"><strong class="source-inline">my_hostel/controllers/main.py</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
# -*- coding: utf-8 -*-
from odoo import http, tools, _
from odoo.http import request
class InquiryForm(http.Controller):
    @http.route('/inquiry/form', type='http', auth="public", website=True)
    def inquiry_form_template(self, **kw):
        return request.render("my_hostel.hostel_inquiry_form")
    @http.route('/inquiry/submit', type='http', auth="public", website=True)
    def inquiry_form(self, **kwargs):
        inquiry_obj = request.env['hostel.inquiries']
        form_vals = {
            'name': kwargs.get('name') or '',
            'email': kwargs.get('email') or '',
            'phone': kwargs.get('phone') or '',
            'book_fy': kwargs.get('book_fy') or '',
            'queries': kwargs.get('queries') or '',
            }
        submit_success = inquiry_obj.sudo().create(form_vals)
        return request.redirect('/contactus-thank-you')</pre>			<p>Now, design <a id="_idIndexMarker1041"/>a form for the website <span class="No-Break">called </span><span class="No-Break"><strong class="source-inline">my_hostel/views/form_template.xml</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
&lt;odoo&gt;
  &lt;template id="hostel_inquiry_form"
    name="Hostel Inquiry Form"&gt;
    &lt;t t-call="website.layout"&gt;
      &lt;section class="s_website_form" data-snippet="s_website_form"&gt;
        &lt;div class="container"&gt;
          &lt;div class="row"&gt;
            &lt;div class="col-md-12 mb64"&gt;
              &lt;div class="aboutus-section pl-5 pr-5 p-t-100 p-b-50"&gt;
                &lt;div class="wrapper wrapper--w900"&gt;
                  &lt;div class="card"&gt;
                    &lt;div class="card-body mt8"&gt;
                      &lt;form action="/inquiry/submit" method="POST" class="o_mark_required" id="inquiry_form" enctype="multipart/form-data"&gt;
                        &lt;input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/&gt;
                          &lt;div class="row"&gt;
                            &lt;div class="form-group col-md-12"&gt;
                              &lt;label for="name"&gt; Your Name &lt;/label&gt;
                                &lt;input type="text"
                                class="form-control" name="name"
                                id="name" required="True" /&gt;
                            &lt;/div&gt;
                          &lt;/div&gt;
                          &lt;div class="row"&gt;
                            &lt;div class="form-group col-md-12"&gt;
                              &lt;label for="phone"&gt; Phone &lt;/label&gt;
                                &lt;input type="text" class="form-control"
                                name="phone" id="phone" required="True" /&gt;
                            &lt;/div&gt;
                          &lt;/div&gt;
                          &lt;div class="row"&gt;
                            &lt;div class="form-group col-md-12"&gt;
                              &lt;label for="email"&gt; Email ID &lt;/label&gt;
                                  &lt;input type="text" class="form-control"
                                  name="email" id="email"/&gt;
                              &lt;/div&gt;
                            &lt;/div&gt;
                            &lt;div class="row"&gt;
                              &lt;div class="form-group col-md-12"&gt;
                                &lt;label for="book_fy"&gt; Booking for the Year &lt;/label&gt;
                                  &lt;input type="text" class="form-control"
                                  name="book_fy" id="book_fy"/&gt;
                              &lt;/div&gt;
                            &lt;/div&gt;
                            &lt;div class="row"&gt;
                              &lt;div class="form-group col-md-12"&gt;
                                &lt;label for="queries"&gt; Your Question &lt;/label&gt;
                                  &lt;input type="text" class="form-control"
                                  name="queries" id="queries"/&gt;
                              &lt;/div&gt;
                            &lt;/div&gt;
                            &lt;div class="form-group row"&gt;
                              &lt;div class="col-sm-12"&gt;
                                &lt;button type="submit"
                                class="btn btn-primary btn-lg a-submit"&gt;
                                  &lt;span&gt;Submit&lt;/span&gt;
                                &lt;/button&gt;
                              &lt;/div&gt;
                            &lt;/div&gt;
                          &lt;/form&gt;
                        &lt;/div&gt;
                      &lt;/div&gt;
                    &lt;/div&gt;
                  &lt;/div&gt;
                &lt;/div&gt;
              &lt;/div&gt;<a id="_idTextAnchor803"/>
            &lt;/div&gt;
          &lt;/section&gt;
      &lt;/t&gt;
  &lt;/template&gt;
&lt;/odoo&gt;</pre>			<h2 id="_idParaDest-680"><a id="_idTextAnchor804"/>How to do it…</h2>
			<p>Update the module and open the <strong class="source-inline">/inquiry/form</strong> URL. From this page, you will be able to submit <a id="_idIndexMarker1042"/>queries for the hostel. After submission, you can check them into the respective inquiries form view in <span class="No-Break">the backend.</span></p>
			<h1 id="_idParaDest-681"><a id="_idTextAnchor805"/>Managing SEO options</h1>
			<p>Odoo has built-in <a id="_idIndexMarker1043"/>SEO features for templates (pages). However, some templates are used for multiple URLs. For example, in an online shop, each product page uses the same template but different<a id="_idTextAnchor806"/> product data. For these cases, we need different SEO options for <span class="No-Break">each URL.</span></p>
			<h2 id="_idParaDest-682"><a id="_idTextAnchor807"/>Getting ready</h2>
			<p>For this recipe, we will be using the <strong class="source-inline">my_hostel</strong> module. We will store separate SEO data for each hostel details page. Before following this recipe, you should test the SEO options in the different hostel pages. You can get an SEO dialog from the <strong class="bold">Promote</strong> drop-down menu on the top, as shown in the <span class="No-Break">following screenshot:</span></p>
			<div>
				<div id="_idContainer123" class="IMG---Figure">
					<img src="image/B20997_14_4.jpg" alt="Figure 14.4 – Opening the SEO configuration for a page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.4 – Opening the SEO configuration for a page</p>
			<p>If you test SEO options on different hostel details pages, you will notice that changing the SEO data in one book pag<a id="_idTextAnchor808"/>e will reflect on all hostel pages. We will fix this issue in <span class="No-Break">this recipe.</span></p>
			<h2 id="_idParaDest-683"><a id="_idTextAnchor809"/>How to do it...</h2>
			<p>To manage <a id="_idIndexMarker1044"/>separate SEO options for each hostel, follow <span class="No-Break">these steps:</span></p>
			<ol>
				<li>Inherit the <strong class="source-inline">website.seo.metadata</strong> mixin in the <strong class="source-inline">hostel.hostel</strong> model, <span class="No-Break">as follows:</span><pre class="source-code">
     class Hostel(models.Model):
     _name = 'hostel.hostel'
     _description = "Information about hostel"
     <strong class="bold">_inherit = ['website.seo.metadata']</strong>
     _order = "id desc, name"
     _rec_name = 'hostel_code'</pre></li>				<li>Pass the <strong class="source-inline">hostel</strong> object in the hostel details route as <strong class="source-inline">main_object</strong>, <span class="No-Break">as follows:</span><pre class="source-code">
@http.route('/hostels/&lt;model("hostel.hostel"):hostel&gt;', type='http', auth='public', website = True)
def hostel_detail(self, hostel):
         return request.render(
         'my_hostel.hostel_detail', {
             'hostel': hostel,
             'main_object': hostel
         }
...</pre></li>			</ol>
			<p>Update the module and change the SEO on the different hostel pages. It can be changed through the <strong class="bold">Optimize S<a id="_idTextAnchor810"/>EO</strong> option. Now, you will be able to manage separate SEO details <span class="No-Break">per hostel.</span></p>
			<h2 id="_idParaDest-684"><a id="_idTextAnchor811"/>How it works...</h2>
			<p>To enable SEO on each record of the model, you will need to inherit the <strong class="source-inline">website.seo.metadata</strong> mixin in your model. This will add a few fields and methods to the <strong class="source-inline">hostel.hostel</strong> model. These fields and methods will be used from the website to store separate data for <span class="No-Break">each book.</span></p>
			<p class="callout-heading">Tip</p>
			<p class="callout">If you want to see fields and methods for the SEO mixin, search for the <strong class="source-inline">website.seo.metadata</strong> model in the <strong class="source-inline">/</strong><span class="No-Break"><strong class="source-inline">addons/website/models/website.py</strong></span><span class="No-Break"> file.</span></p>
			<p>All SEO-related <a id="_idIndexMarker1045"/>code is written in <strong class="source-inline">website.layout</strong>, and it gets all the SEO meta-information from the recordset passed as <strong class="source-inline">main_object</strong>. Consequently, in <em class="italic">step 2</em>, we passed a <strong class="source-inline">hostel</strong> object with the <strong class="source-inline">main_object</strong> key so that the website layout will get all SEO information from the hostel. If you don’t pass <strong class="source-inline">main_object</strong> from the controller, then the template recordset will be passed as <strong class="source-inline">ma<a id="_idTextAnchor812"/>in_object</strong>, and that’s why you were getting the same SEO data in <span class="No-Break">all hostels.</span></p>
			<h2 id="_idParaDest-685"><a id="_idTextAnchor813"/>There’s more...</h2>
			<p>In Odoo, you can add custom metatags for Open Graph and Twitter sharing. If you want to add your custom metatags to a page, you can override <strong class="source-inline">_default_website_meta()</strong> after adding the SEO mixin. For example, if we want to use the hostel cover as the social sharing image, then we can use the following code in our <span class="No-Break"><strong class="source-inline">hostel</strong></span><span class="No-Break"> model:</span></p>
			<pre class="source-code">
     def _default_website_meta(self):
         res = super(Hostel, self)._default_website_meta()
         res['default_opengraph']['og:image'] = self.env['website'].image_url(self, 'image')
         res['default_twitter']['twitter:image'] = self.env['website'].image_url(self, 'image')
         return res</pre>			<p>After this, the hostel cover will be displayed on social media when you share the hostel’s URL. Additionall<a id="_idTextAnchor814"/>y, you can also set the page title and the description from the <span class="No-Break">same method.</span></p>
			<h1 id="_idParaDest-686"><a id="_idTextAnchor815"/>Managing sitemaps for the website</h1>
			<p>A website’s sitemaps are crucial for any website. The search engine will use website sitemaps <a id="_idIndexMarker1046"/>to index the pages o<a id="_idTextAnchor816"/>f a website. In this recipe, we will add hostel details pages to <span class="No-Break">the sitemap.</span></p>
			<h2 id="_idParaDest-687"><a id="_idTextAnchor817"/>Getting ready</h2>
			<p>For this recipe, we will be using the <strong class="source-inline">my_hostel</strong> module from the previous recipe. If you want to check the curr<a id="_idTextAnchor818"/>ent sitemap in Odoo, open <strong class="source-inline">&lt;your_odoo_server_url&gt;/sitemap.xml</strong> in <span class="No-Break">your browser.</span></p>
			<h2 id="_idParaDest-688"><a id="_idTextAnchor819"/>How to do it...</h2>
			<p>Follow these steps to modify a hostel’s page <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">sitemap.xml</strong></span><span class="No-Break">:</span></p>
			<ol>
				<li>Import the methods in <strong class="source-inline">main.py</strong>, <span class="No-Break">as follows:</span><pre class="source-code">
from odoo.addons.http_routing.models.ir_http import slug
from odoo.addons.website.models.ir_http import sitemap_qs2dom</pre></li>				<li>Add the <strong class="source-inline">sitemap_hostels</strong> method to <strong class="source-inline">main.py</strong>, <span class="No-Break">as follows:</span><pre class="source-code">
     def sitemap_hostels(env, rule, qs):
         Hostels = env['hostel.hostel']
         dom = sitemap_qs2dom(qs, '/hostels', Hostels._rec_name)
     #Ex. to filter urls
         #dom += [('name', 'ilike', 'abc')]
         for f in Hostels.search(dom):
             loc = '/hostels/%s' % slug(f)
             if not qs or qs.lower() in loc:
                 yield {'loc': loc}</pre></li>				<li>Add the <strong class="source-inline">sitemap_hostels</strong> function reference in a hostel’s detail routes <span class="No-Break">as follows:</span><pre class="source-code">
@http.route('/hostels/&lt;model("hostel.hostel"):hostel&gt;', type='http', auth='public', website = True, 
<strong class="source-inline">sitemap=sitemap_hostels</strong>)
     def hostel_detail(self, hostel):</pre></li>			</ol>
			<p>Update the module <a id="_idIndexMarker1047"/>to apply the changes. A <strong class="source-inline">sitemap.xml</strong> file is generated and stored in <strong class="source-inline">Attachments</strong>. Then, it is regenerated every few hours. To see our changes, you will need to remove the sitemap file from the attachment. To do this, visit <strong class="bold">Settings</strong> | <strong class="bold">Technical</strong> | <strong class="bold">Database Structure</strong> | <strong class="bold">Attachments</strong>, search for the sitemap, and delete the file. Now, access the <strong class="source-inline">/sit<a id="_idTextAnchor820"/>emap.xml</strong> URL in a browser, and you will see the hostel’s pages in <span class="No-Break">the sitemap.</span></p>
			<h2 id="_idParaDest-689"><a id="_idTextAnchor821"/>How it works...</h2>
			<p>In <em class="italic">step 1</em>, we imported a few required functions. <strong class="source-inline">slug</strong> is used to generate a clean, user-friendly URL, based on a record name. <strong class="source-inline">sitemap_qs2dom</strong> is used to generate a domain based on route and <span class="No-Break">query strings.</span></p>
			<p>In <em class="italic">step 2</em>, we created a Python generator function,<strong class="source-inline">sitemap_hostels()</strong>. This function will be called whenever a sitemap is generated. During the call, it will receive three arguments—the <strong class="source-inline">env</strong> Odoo environment, the <strong class="source-inline">rule</strong> route rule, and the <strong class="source-inline">qs</strong> query string. In the function, we generated a domain with <strong class="source-inline">sitemap_qs2dom</strong>. Then, we used the generated domain to search the hostel records, which are used to generate the location through the <strong class="source-inline">slug()</strong> method. With <strong class="source-inline">slug</strong>, you will get a user-friendly URL, such as <strong class="source-inline">/hostels/cambridge-1</strong>. If you do not want to list all the hostels on the sitemap, you can just use a valid domain in the search to filter <span class="No-Break">the hostel.</span></p>
			<p>In <em class="italic">step 3</em>, we passed <a id="_idTextAnchor822"/>the <strong class="source-inline">sitemap_hostels()</strong> function reference to the route with a <span class="No-Break"><strong class="source-inline">sitemap</strong></span><span class="No-Break"> keyword.</span></p>
			<h2 id="_idParaDest-690"><a id="_idTextAnchor823"/>There’s more...</h2>
			<p>In this recipe, we have seen how you can use a custom method to generate a URL for a sitemap. But if <a id="_idIndexMarker1048"/>you do not want to filter hostels and you want to list all hostels in a sitemap, then instead of the function reference, just pass <strong class="source-inline">True</strong> <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
...
@http.route('/hostels/&lt;model("hostel.hostel"):hostel&gt;', type='http', auth='public', website = True, <strong class="bold">sitemap=True</strong>)
...</pre>			<p>In the same way, if you don’t want any URL to display in the sitemap, just pass <strong class="source-inline">False</strong> <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
...
@http.route('/hostels/&lt;model("hostel.ho<a id="_idTextAnchor824"/>stel"):hostel&gt;', type='http', auth='public', website = True, <strong class="bold">sitemap=False</strong>)
...</pre>			<h1 id="_idParaDest-691"><a id="_idTextAnchor825"/>Getting a visitor’s country information</h1>
			<p>The Odoo <a id="_idIndexMarker1049"/>CMS has built-in support for <strong class="bold">GeoIP</strong>. In a live environment, you can track a visitor’s country based on the IP address. In this r<a id="_idTextAnchor826"/>ecipe, we will get the country of the visitor based on the visitor’s <span class="No-Break">IP address.</span></p>
			<h2 id="_idParaDest-692"><a id="_idTextAnchor827"/>Getting ready</h2>
			<p>For this recipe, we will be using the <strong class="source-inline">my_hostel</strong> module from the previous recipe. In this recipe, we will hide some hostels on the web page based on the visitor’s country. You will need to download the GeoIP database for this recipe. After that, you will need to pass the database location from the <strong class="source-inline">cli</strong> option, <span class="No-Break">like this:</span></p>
			<pre class="source-code">
<strong class="bold">./odoo-bin -c config_file --geoip-db=location_of_geoip_DB</strong></pre>			<p>Or, follow the steps from this <span class="No-Break">document sheet:</span></p>
			<p><a href="https://www.odoo.com/documentation/17.0/applications/websites/website/configuration/on-premise_geo-ip-installation.html"><span class="No-Break">https://www.odoo.com/documentation/17.0/applications/websites/website/configuration/on-premise_geo-ip-installation.html</span></a><span class="No-Break">.</span></p>
			<p>If you don’t want to locate the GeoIP database in <strong class="source-inline">/usr/share/GeoIP/</strong>, use the <strong class="source-inline">--geoip-city-db</strong> and <strong class="source-inline">--geoip-country-db</strong> options of the Odoo command-line interface. These options take the absolute path to the GeoIP database file and use it as the <span class="No-Break">GeoIP database.</span></p>
			<h2 id="_idParaDest-693"><a id="_idTextAnchor828"/>How to do it...</h2>
			<p>Follow <a id="_idIndexMarker1050"/>these steps to restrict books based <span class="No-Break">on country:</span></p>
			<ol>
				<li>Add the <strong class="source-inline">restrict_country_ids</strong> <strong class="source-inline">Many2many</strong> field in the <strong class="source-inline">hostel.hostel</strong> model, <span class="No-Break">as follows:</span><pre class="source-code">
class Hostel(models.Model):
    _name = 'library.book'
    _inherit = ['website.seo.metadata']
     ...
    <strong class="bold">restrict_country_ids = fields.Many2many('res.country')</strong>
    ...</pre></li>				<li>Add a <strong class="source-inline">restrict_country_ids</strong> field in the form view of the <strong class="source-inline">hostel.hostel</strong> model, <span class="No-Break">as follows:</span><pre class="source-code">
…
    &lt;field name="restrict_country_ids" widget="many2many_tags"/&gt;
…</pre></li>				<li>Update the <strong class="source-inline">/hostel</strong> controller to restrict books based on country, <span class="No-Break">as follows:</span><pre class="source-code">
@http.route('/hostels', type='http', auth='public', website = True)
     def hostel(self):
         country_id = False
         country_code = request.geoip and request.geoip.get('country_code') or False
         if country_code:
             country_ids = request.env['res.country'].sudo().search([('code', '=', country_code)])
             if country_ids:
                 country_id = country_ids[0].id
         domain = ['|', ('restrict_country_ids', '=', False), ('restrict_country_ids', 'not in', [country_id])]
         hostels = request.env['hostel.hostel'].sudo().search(domain)
         return request.render(
         'my_hostel.hostels', {
             'hostels': hostels,})</pre></li>			</ol>
			<p class="callout-heading">Warning</p>
			<p class="callout">This recipe <a id="_idIndexMarker1051"/>does not work with the local server. It will require a hosted server because, with the local machine, you will get the local IP, wh<a id="_idTextAnchor829"/>ich is not related to any country. You will also need to configure <span class="No-Break">NGINX properly.</span></p>
			<h2 id="_idParaDest-694"><a id="_idTextAnchor830"/>How it works...</h2>
			<p>In <em class="italic">step 1</em>, we added a new <strong class="source-inline">restricted_country_ids</strong> <strong class="source-inline">many2many</strong>-type field in the <strong class="source-inline">hostel.hostel</strong> model. We will hide the book if the website visitor is from a <span class="No-Break">restricted country.</span></p>
			<p>In <em class="italic">step 2</em>, we just added a <strong class="source-inline">restricted_country_ids</strong> field in the book’s form view. If GeoIP and NGINX are configured properly, Odoo will add GeoIP information to <strong class="source-inline">request.geoip</strong>, and then you can get the country code <span class="No-Break">from that.</span></p>
			<p>In <em class="italic">step 3</em>, we fetched the country code from GeoIP, followed by the recordset of the country, based on <strong class="source-inline">country_code</strong>. After getting a visitor’s country information, we filtered <a id="_idIndexMarker1052"/>hostels with domains based on a <span class="No-Break">restricted country.</span></p>
			<p class="callout-heading">Important information</p>
			<p class="callout">If you don’t have a real server and you want to test this anyway, you can add a default country code in the controller, like this: <strong class="source-inline">country_code = request.geoip and request.geoip.get('country_code') </strong><span class="No-Break"><strong class="source-inline">or 'IN'</strong></span><span class="No-Break">.</span></p>
			<p>The GeoIP database gets updated from time t<a id="_idTextAnchor831"/>o time, so you will need to update your copy to get up-to-date <span class="No-Break">country information.</span></p>
			<h1 id="_idParaDest-695"><a id="_idTextAnchor832"/>Tracking a marketing campaign</h1>
			<p>In any <a id="_idIndexMarker1053"/>business or service, it is really important to be familiar <a id="_idIndexMarker1054"/>with the <strong class="bold">return on investment</strong> (<strong class="bold">ROI</strong>). The ROI is used to evaluate the effectiveness of an investment. Investments in ads can be tracked through UTM codes. A UTM code is a small string that you <a id="_idTextAnchor833"/>can add to a URL. This UTM code will help you to track campaigns, sources, <span class="No-Break">and media.</span></p>
			<h2 id="_idParaDest-696"><a id="_idTextAnchor834"/>Getting ready</h2>
			<p>For this recipe, we will be using the <strong class="source-inline">my_library</strong> module. Odoo has built-in support for UTMs. With our hostel application, we don’t have any practical cases where UTMs can be used. However, in this recipe, we will add a UTM in the issues generated by <strong class="source-inline">/books/submit_issues</strong> <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">my_library</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-697"><a id="_idTextAnchor835"/>How to do it...</h2>
			<p>Follow these <a id="_idIndexMarker1055"/>steps to link UTMs in a book issue generated from our web page to the <strong class="source-inline">/</strong><span class="No-Break"><strong class="source-inline">books/submit_issues</strong></span><span class="No-Break"> URL:</span></p>
			<ol>
				<li>Add a <strong class="source-inline">utm</strong> module in the <strong class="source-inline">depends</strong> section of <strong class="source-inline">manifest.py</strong>, <span class="No-Break">as follows:</span><pre class="source-code">
'depends': ['base', 'website', <strong class="bold">'utm'</strong>],</pre></li>				<li>Inherit <strong class="source-inline">utm.mixin</strong> in the <strong class="source-inline">book.issue</strong> model, <span class="No-Break">as follows:</span><pre class="source-code">
class LibraryBookIssues(models.Model):
    _name = 'book.issue'
  <strong class="bold">  _inherit = ['utm.mixin']</strong>
    book_id = fields.Many2one('library.book', required=True)
    submitted_by = fields.Many2one('res.users')
    issue_description = fields.Text()</pre></li>				<li>Add a <strong class="source-inline">campaign_id</strong> field in the tree view of the <strong class="source-inline">book_issue_ids</strong> field, <span class="No-Break">as follows:</span><pre class="source-code">
...
&lt;group string="Book Issues"&gt;
    &lt;field name="book_issue_ids" nolabel="1"&gt;
        &lt;tree name="Book issues"&gt;
            &lt;field name="create_date"/&gt;
            &lt;field name="submitted_by"/&gt;
            &lt;field name="issue_description"/&gt;
<strong class="bold">            &lt;field name="campaign_id"/&gt;</strong>
        &lt;/tree&gt;
    &lt;/field&gt;
&lt;/group&gt;
...</pre></li>			</ol>
			<p>Update the module to apply the changes. To test the UTM, you need to perform the <span class="No-Break">following steps:</span></p>
			<ol>
				<li>In Odoo, a UTM is processed based on cookies, and some browsers do not support cookies in the localhost, so if you are testing it with the localhost, access the instance <span class="No-Break">with </span><span class="No-Break"><strong class="source-inline">http://127.0.0.1:8069</strong></span><span class="No-Break">.</span><p class="list-inset">By default, UTM tracking is blocked for salespeople. Consequently, to test the UTM feature, you need to log in with a <span class="No-Break">portal user.</span></p></li>
				<li>Now, open the <span class="No-Break"><strong class="source-inline">http://127.0.0.1:8069/books/submit_issues?utm_campaign=sale</strong></span><span class="No-Break"> URL.</span></li>
				<li>Submit the book issue and check <a id="_idTextAnchor836"/>the book issue in the backend. This will display the campaign in the book’s <span class="No-Break">form view.</span></li>
			</ol>
			<h2 id="_idParaDest-698"><a id="_idTextAnchor837"/>How it works...</h2>
			<p>In the <a id="_idIndexMarker1056"/>first step, we inherited <strong class="source-inline">utm.mixin</strong> in the <strong class="source-inline">book.issue</strong> model. This will add the following fields to the <span class="No-Break"><strong class="source-inline">book.issue</strong></span><span class="No-Break"> model:</span></p>
			<ul>
				<li><strong class="source-inline">campaign_id</strong>: The <strong class="source-inline">Many2one</strong> field with the <strong class="source-inline">utm.campaign</strong> model. This is used to track different campaigns, such as the <em class="italic">Summer</em> and <em class="italic">Christmas </em><span class="No-Break"><em class="italic">Special</em></span><span class="No-Break"> campaigns.</span></li>
				<li><strong class="source-inline">source_id</strong>: The <strong class="source-inline">Many2one</strong> field with the <strong class="source-inline">utm.source</strong> model. This is used to track different sources, such as search engines and <span class="No-Break">other domains.</span></li>
				<li><strong class="source-inline">medium_id</strong>: The <strong class="source-inline">Many2one</strong> field with the <strong class="source-inline">utm.medium</strong> model. This is used to track different media, such as postcards, emails, and <span class="No-Break">banner ads.</span></li>
			</ul>
			<p>To track the campaign, medium, and source, you need to share a URL in the marketing media like <span class="No-Break">this: </span><span class="No-Break"><strong class="source-inline">your_url?utm_campaign=campaign_name&amp;utm_medium=medium_name&amp;utm_source=source_name</strong></span><span class="No-Break">.</span></p>
			<p>If a visitor visits your website from any marketing media, then the <strong class="source-inline">campaign_id</strong>, <strong class="source-inline">source_id</strong>, and <strong class="source-inline">medium_id</strong> fields are automatically filled when records are created on the <span class="No-Break">website page.</span></p>
			<p>In our <a id="_idIndexMarker1057"/>example, we just tracked <strong class="source-inline">campaign_id</strong>, but you can also add <strong class="source-inline">source_id</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">medium_id</strong></span><span class="No-Break">.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">In our test example, we have used <strong class="source-inline">campaign_id=sale</strong>. Now, <strong class="source-inline">sale</strong> is the name of the record in the <strong class="source-inline">utm.campaign</strong> model. By default, the <strong class="source-inline">utm</strong> module adds a few records of the campaign, medium, and source. The <strong class="source-inline">sale</strong> record is one of them. If you want to create a new campaign, medium, and source, you can do this by visiting the <strong class="source-inline">Link Tracker &gt; UTMs</strong> menu in <span class="No-Break">developer mode.</span></p>
			<h1 id="_idParaDest-699"><a id="_idTextAnchor838"/>Managing multiple websites</h1>
			<p>Odoo has <a id="_idIndexMarker1058"/>built-in support for multiple websites. This means that the same O<a id="_idTextAnchor839"/>doo instance can be run on multiple domains as well as when displaying <span class="No-Break">different records.</span></p>
			<h2 id="_idParaDest-700"><a id="_idTextAnchor840"/>Getting ready</h2>
			<p>For this recipe, we will be using the <strong class="source-inline">my_hostel</strong> mo<a id="_idTextAnchor841"/>dule from the previous recipe. In this recipe, we will hide hostels based on <span class="No-Break">the website.</span></p>
			<h2 id="_idParaDest-701"><a id="_idTextAnchor842"/>How to do it...</h2>
			<p>Follow these steps to make the online website <span class="No-Break">multi-website compatible:</span></p>
			<ol>
				<li>Add <strong class="source-inline">website.multi.mixin</strong> in the <strong class="source-inline">hostel.hostel</strong> model, <span class="No-Break">as follows:</span><pre class="source-code">
class Hostel(models.Model):
     _name = 'hostel.hostel'
     _description = "Information about hostel"
     _inherit = ['website.seo.metadata', <strong class="bold">'website.multi.mixin'</strong>]
...</pre></li>				<li>Add <strong class="source-inline">website_id</strong> in the hostel form view, <span class="No-Break">as follows:</span><pre class="source-code">
...
&lt;group&gt;
<strong class="bold">    &lt;field name="website_id"/&gt;</strong>
&lt;/group&gt;
...</pre></li>				<li>Modify the <a id="_idIndexMarker1059"/>domain in the <strong class="source-inline">/hostels</strong> controller, <span class="No-Break">as follows:</span><pre class="source-code">
@http.route('/hostels', type='http', auth='public', website = True)
     def hostel(self, <strong class="bold">**post</strong>):
...
   domain = ['|', ('restrict_country_ids', '=', False), ('restrict_country_ids', 'not in', [country_id])]
         domain += request.website.website_domain()
    hostels = request.env['hostel.hostel'].sudo().search(domain)
         return request.render(
         'my_hostel.hostels', {
             'hostels': hostels,
         })
...</pre></li>				<li>Import <strong class="source-inline">werkzeug</strong> and modify a hostel details controller to restrict hostel access from <a id="_idIndexMarker1060"/>another website, <span class="No-Break">as follows:</span><pre class="source-code">
import werkzeug
...
@http.route('/hostels/&lt;model("hostel.hostel"):hostel&gt;', type='http', auth='public', website = True, sitemap=sitemap_hostels)
def hostel_detail(self, hostel, **post):
    if not hostel.can_access_from_current_website():
        raise werkzeug.exceptions.NotFound()
    return request.render(
         'my_hostel.hostel_detail', {
             'hostel': hostel,
             'main_object': hostel
         })
...</pre></li>			</ol>
			<p>Update the module to apply the changes. To test this module, set up different websites in some hostels. Now, open the <strong class="source-inline">/hostels</strong> URL and check the list of books. After this, change the website and check the list of books. For testing, you can change the website from the website switcher drop-down menu. Refer to the following screenshot to <span class="No-Break">do that:</span></p>
			<div>
				<div id="_idContainer124" class="IMG---Figure">
					<img src="image/B20997_14_5.jpg" alt="Figure 14.5 – Website switcher"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.5 – Website switcher</p>
			<p>You can also try to access the book details directly from t<a id="_idTextAnchor843"/>he URL, such as for <strong class="source-inline">/hostels/1</strong>. If a hostel is not from that website, it will show <span class="No-Break">as </span><span class="No-Break"><strong class="source-inline">404</strong></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-702"><a id="_idTextAnchor844"/>How it works...</h2>
			<p>In <em class="italic">step 1</em>, we added <strong class="source-inline">website.multi.mixin</strong>. This mixin adds a basic utility to handle multiple <a id="_idIndexMarker1061"/>websites in the model. This mixin adds the <strong class="source-inline">website_id</strong> field in the model. This field is used to determine which website a record is <span class="No-Break">meant for.</span></p>
			<p>In <em class="italic">step 2</em>, we added the <strong class="source-inline">website_id</strong> field in the form view of the hostel so that the hostels would be filtered based on <span class="No-Break">the website.</span></p>
			<p>In <em class="italic">step 3</em>, we modified the domain used to find a list of hostels. <strong class="source-inline">request.website.website_domain()</strong> will return the domain that filters out hostels that are not from <span class="No-Break">the website.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">Notice that there are records that do not have any <strong class="source-inline">website_id</strong> field set. Such records will be displayed on all websites. This means that if you don’t have a <strong class="source-inline">website_id</strong> field on a particular hostel, then that hostel will be displayed on <span class="No-Break">all websites.</span></p>
			<p>Then, we added the domain in the web search, <span class="No-Break">as follows:</span></p>
			<ul>
				<li>In <em class="italic">step 4</em>, we restricted book access. If the book is not meant for the current website, then we will raise a <strong class="source-inline">Not found</strong> error. The <strong class="source-inline">can_access_from_current_website()</strong> method will return a <strong class="source-inline">True</strong> value if a hostel record is meant for the currently active website and <strong class="source-inline">False</strong> if a hostel record is meant for <span class="No-Break">another website.</span></li>
				<li>If you noticed, we added <strong class="source-inline">**post</strong> in both controllers. This is because, without it, <strong class="source-inline">**post</strong> <strong class="source-inline">/hostels</strong> and <strong class="source-inline">/hostels/&lt;model("hostel.hostel"):hostel&gt;</strong> will not accept a query parameter. They will also generate an error while switching the <a id="_idIndexMarker1062"/>website from the website switcher, so we added it. Normally, it is<a id="_idTextAnchor845"/> a good practice to add <strong class="source-inline">**post</strong> in every controller so that they can handle <span class="No-Break">query parameters.</span></li>
			</ul>
			<h1 id="_idParaDest-703"><a id="_idTextAnchor846"/>Redirecting old URLs</h1>
			<p>When you move to the Odoo website from an existing system or website, you must redirect <a id="_idIndexMarker1063"/>your old URLs to new URLs. With proper redirection, all of your SEO rankings will be <a id="_idTextAnchor847"/>moved to new pages. In this recipe, we will see how to redirect old URLs to new URLs <span class="No-Break">in Odoo.</span></p>
			<h2 id="_idParaDest-704"><a id="_idTextAnchor848"/>Getting ready</h2>
			<p>For this recipe, we will be using the <strong class="source-inline">my_hostels</strong> module from the previous recipe. <a id="_idTextAnchor849"/>For this recipe, we are assuming that you used to have a website and have just moved <span class="No-Break">to Odoo.</span></p>
			<h2 id="_idParaDest-705"><a id="_idTextAnchor850"/>How to do it...</h2>
			<p>Imagine that, in your old website, books were listed at the <strong class="source-inline">/my-hostels</strong> URL; as you know, the <strong class="source-inline">my_hostel</strong> module lists hostels on the <strong class="source-inline">/hostels</strong> URL as well. So, we will now add a <strong class="bold">redirection</strong> rule in Odoo that will redirect your old <strong class="source-inline">/my-hostels</strong> URL to the new <strong class="source-inline">/hostels</strong>  URL. Perform the following steps to add the <span class="No-Break">redirection rule:</span></p>
			<ol>
				<li>Activate <span class="No-Break">developer mode.</span></li>
				<li>Open <strong class="bold">Website</strong> | <strong class="bold">Configuration</strong> | <span class="No-Break"><strong class="bold">Redirects</strong></span><span class="No-Break">.</span></li>
				<li>Click on <strong class="bold">New</strong> to add a <span class="No-Break">new rule.</span></li>
				<li>Enter values in the form, as shown in the following screenshot. In <strong class="bold">URL from</strong>, enter <strong class="source-inline">/my-hostels</strong>, and in <strong class="bold">URL to</strong>, <span class="No-Break">enter </span><span class="No-Break"><strong class="source-inline">/hostels</strong></span><span class="No-Break">.</span></li>
				<li>Select the <strong class="bold">Action</strong> value of <strong class="bold">301 </strong><span class="No-Break"><strong class="bold">Moved permanently</strong></span><span class="No-Break">.</span></li>
				<li>Save the record. Once you have filled in the data, your form will look <span class="No-Break">like this:</span></li>
			</ol>
			<div>
				<div id="_idContainer125" class="IMG---Figure">
					<img src="image/B20997_14_6.jpg" alt="     Figure 14.6 – Redirection rule"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">     Figure 14.6 – Redirection rule</p>
			<p>Once you have added this rule, open the <strong class="source-inline">/my-hos<a id="_idTextAnchor851"/>tels</strong> page. You will notice that the page gets redirected automatically to the <strong class="source-inline">/</strong><span class="No-Break"><strong class="source-inline">hostels</strong></span><span class="No-Break"> page.</span></p>
			<h2 id="_idParaDest-706"><a id="_idTextAnchor852"/>How it works...</h2>
			<p>Page redirection is <a id="_idIndexMarker1064"/>simple; it’s just part of the HTTP protocol. In our example, we moved <strong class="source-inline">/my-hostels</strong> to <strong class="source-inline">/hostels</strong>. We used a <strong class="bold">301 Moved permanently</strong> redirect for redirection. Here are all the redirection options that are available <span class="No-Break">in Odoo:</span></p>
			<ul>
				<li><strong class="bold">404 Not Found</strong>: This option is used if you want to give a <strong class="source-inline">404 Not Found</strong> response for a page. Note that Odoo will display the default <strong class="source-inline">404</strong> page for <span class="No-Break">such requests.</span></li>
				<li><strong class="bold">301 Moved permanently</strong>: This option redirects old URLs to new ones permanently. This type of redirection will move SEO rankings to a <span class="No-Break">new page.</span></li>
				<li><strong class="bold">302 Moved temporarily</strong>: This option redirects old URLs to new ones temporarily. Use this option when you need to redirect a URL for a limited time. This type of redirection will not move SEO rankings to a <span class="No-Break">new page.</span></li>
				<li><strong class="bold">308 Redirect/Rewrite</strong>: An interesting option – with this, you will be able to change/rewrite existing Odoo URLs to <span class="No-Break">new ones.</span></li>
			</ul>
			<p>In this recipe, this <a id="_idIndexMarker1065"/>would allow us to rewrite the old <strong class="source-inline">/my-hostels</strong> URL to the new <strong class="source-inline">/hostels</strong> URL. Hence, we would have no need to redirect the old URL by using the <strong class="bold">301 Moved permanently</strong> rule <span class="No-Break">for </span><span class="No-Break"><strong class="source-inline">/my-hostels</strong></span><span class="No-Break">.</span></p>
			<p>There are a few more fields on the redirection rule form. One of them is the <strong class="bold">Active</strong> field, which can used if you want to enable/disable rules from time to time. A second important field is <strong class="bold">Website</strong>. The <strong class="bold">Website</strong> field is used when you are using the multi-website feature and you want to limit the redire<a id="_idTextAnchor853"/>ction rule to one website only. By default, however, the rule will be applied to <span class="No-Break">all websites.</span></p>
			<h1 id="_idParaDest-707"><a id="_idTextAnchor854"/>Publish management for website-related records</h1>
			<p>In business flows, there are some cases where you need to allow or revoke page access to public <a id="_idIndexMarker1066"/>users. One such case is e-commerce products, where you need to publish or unpublish products based on availability. In this <a id="_idIndexMarker1067"/>recipe, we will see how you can publish and unpublish hostel records for <span class="No-Break">public users.</span></p>
			<h2 id="_idParaDest-708"><a id="_idTextAnchor855"/>Getting ready</h2>
			<p>For this recipe, we will be using the <strong class="source-inline">my_hostel</strong> module from the <span class="No-Break">previous recipe.</span></p>
			<p class="callout-heading">Important note</p>
			<p class="callout">If you notice, we have put <strong class="source-inline">auth='user'</strong> on the <strong class="source-inline">/hostels</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">/hostels/&lt;model</strong></span><strong class="source-inline"> ("hostel.hostel"):ho<a id="_idTextAnchor856"/>stel&gt;</strong> routes. Please change this to <strong class="source-inline">auth='public'</strong> to make those URLs accessible to <span class="No-Break">public users.</span></p>
			<h2 id="_idParaDest-709"><a id="_idTextAnchor857"/>How to do it…</h2>
			<p>Perform the following steps to enable a publish/unpublish option for hostel <span class="No-Break">details pages:</span></p>
			<ol>
				<li>Add <strong class="source-inline">website.published.mixin</strong> to the <strong class="source-inline">hostel.hostel</strong> model <span class="No-Break">like this:</span><pre class="source-code">
class Hostel(models.Model):
     _name = 'hostel.hostel'
     _description = "Information about hostel"
     _inherit = ['website.seo.metadata', 'website.multi.mixin', ' website.published.mixin']
     _order = "id desc, name"
    ...</pre></li>				<li>Add a <a id="_idIndexMarker1068"/>new file to <strong class="source-inline">my_hostel/security/rules.xml</strong> and add a record rule for hostels like <a id="_idIndexMarker1069"/>this (make sure you register the file in <span class="No-Break">the manifest):</span><pre class="source-code">
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;odoo noupdate="1"&gt;
     &lt;record id="hostels_rule_portal_public" model="ir.rule"&gt;
         &lt;field name="name"&gt;Portal/Public user: View published Hostels&lt;/field&gt;
         &lt;field name="model_id" ref="my_hostel.model_hostel_hostel"/&gt;
         &lt;field name="groups" eval="[(4, ref('base.group_portal')), (
         4, ref('base.group_public'))]"/&gt;
         &lt;field name="domain_force"&gt;
         [('website_published','=', True)]&lt;/field&gt;
         &lt;field name="perm_read" eval="True"/&gt;
     &lt;/record&gt;
&lt;/odoo&gt;</pre><ul><li>Update the <strong class="source-inline">my_hostel</strong> module to apply the changes. Now, you can publish and unpublish <span class="No-Break">hostel pages:</span></li></ul></li>			</ol>
			<div>
				<div id="_idContainer126" class="IMG---Figure">
					<img src="image/B20997_14_7.jpg" alt="Figure 14.7 – The Publish/Unpublish toggle"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 14.7 – The Publish/Unpublish toggle</p>
			<p>To publish/unpublish hostels, you can use the toggle shown in the preceding screenshot of a hostel <span class="No-Break">details page.</span></p>
			<h2 id="_idParaDest-710"><a id="_idTextAnchor858"/>How it works...</h2>
			<p>Odoo provides <a id="_idIndexMarker1070"/>a ready-made mixin to handle publish management for your records. It does most of the job for you. All you <a id="_idIndexMarker1071"/>need to do is add <strong class="source-inline">website.published.mixin</strong> to your model. In <em class="italic">step 1</em>, we added <strong class="source-inline">website.published.mixin</strong> to our <strong class="source-inline">hostel</strong> model. This will add all the fields and methods required to publish and unpublish hostels. Once you add this mixin to the book model, you will be able to see the button to toggle the state on the book details page, as shown in the <span class="No-Break">preceding screenshot.</span></p>
			<p class="callout-heading">Note</p>
			<p class="callout">We are sending a hostel record as <strong class="source-inline">main_object</strong> from our hostel details route. Without this, you will not be able to see the publish/unpublish button on the hostel <span class="No-Break">details page.</span></p>
			<p>Adding the mixin will show the publish/unpublish button on the hostel’s details page, but it will not restrict a public user from accessing it. To do this, we need to add a record rule. In <em class="italic">step 2</em>, we added a record rule to restrict access to unpub<a id="_idTextAnchor859"/>lished hostels. If you want to learn more about record rules, refer to <a href="B20997_10.xhtml#_idTextAnchor549"><span class="No-Break"><em class="italic">Chapter 10</em></span></a>, <span class="No-Break"><em class="italic">Security Access</em></span><span class="No-Break">.</span></p>
			<h2 id="_idParaDest-711"><a id="_idTextAnchor860"/>There’s more…</h2>
			<p>The <strong class="source-inline">publish</strong> mixin will enable the publish/unpublish button on the website. But if you want to show <a id="_idIndexMarker1072"/>a redirect button on the <a id="_idIndexMarker1073"/>backend form view, the publish mixin can provide a means for that too. The following steps show how to add a redirect button to a hostel’s <span class="No-Break">form view:</span></p>
			<ol>
				<li>Add a method in the <strong class="source-inline">hostel.hostel</strong> model to compute the URL for <span class="No-Break">a hostel:</span><pre class="source-code">
@api.depends('name')
def _compute_website_url(self):
    for hostel in self:
        hostel.website_url = '/hostels/%s' % (slug(hostel))</pre></li>				<li>Add a button in the form view to redirect to <span class="No-Break">the website:</span><pre class="source-code">
...
&lt;sheet&gt;
    &lt;div class="oe_button_box" name="button_box"&gt;
        &lt;field name="is_published"
               widget="website_redirect_button"/&gt;
    &lt;/div&gt;
...</pre></li>			</ol>
			<p>Once you add the button, you will be able to see the button in the hostel’s form view, and by clicking on it, you will be redirected to the hostel’s <span class="No-Break">details page.</span></p>
		</div>
	</body></html>