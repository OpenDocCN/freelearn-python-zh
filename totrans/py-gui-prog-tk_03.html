<html><head></head><body>
  <div><h1 class="chapterNumber">3</h1>
    <h1 id="_idParaDest-55" class="chapterTitle">Creating Basic Forms with Tkinter and Ttk Widgets</h1>
    <p class="normal">Good news! Your design has been reviewed and approved by the director. Now it's time to start implementing it! In this chapter, we'll be creating a very simple application that delivers the core functionality of the specification and little else. This is known as a <strong class="keyword">minimum viable product</strong> or <strong class="keyword">MVP</strong>. The MVP will not be<a id="_idIndexMarker141"/> production-ready, but it will give us something to show our users and help us better understand the problem and the technologies we're working with. We'll cover this in the following topics:</p>
    <ul>
      <li class="bullet">In <em class="italic">The Ttk widget set</em>, we'll learn about a better widget set for Tkinter, Ttk.</li>
      <li class="bullet">In <em class="italic">Implementing the application</em>, we'll build our form design using Python, Tkinter, and Ttk.</li>
    </ul>
    <p class="normal">Let's get coding!</p>
    <h1 id="_idParaDest-56" class="title">The Ttk widget set</h1>
    <p class="normal">In <em class="chapterRef">Chapter 1</em>, <em class="italic">Introduction to Tkinter</em>, we created a survey application using the default Tkinter widgets. These widgets are perfectly functional and still used in many Tkinter applications, but modern Tkinter applications tend to prefer an improved set of widgets called <strong class="keyword">Ttk</strong>. Ttk is a sub-module<a id="_idIndexMarker142"/> of Tkinter that provides themed versions of many (but not all) Tkinter widgets. These widgets are mostly identical to the traditional widgets but provide advanced styling options in an aim to look more modern and natural on Windows, macOS, and Linux. </p>
    <p class="normal">On each platform, Ttk includes platform-specific themes that mimic the platform's native widgets. In addition, Ttk adds a few extra widgets that offer functionality not found in the default library.</p>
    <div><p class="Information-Box--PACKT-">Although this chapter will cover the basic usage of Ttk widgets, full coverage of the fonts, colors, and other style customization for Ttk widgets can be found in <em class="chapterRef">Chapter 9</em>, <em class="italic">Improving the Look with Styles and Themes</em>.</p>
    </div>
    <p class="normal">Ttk is already included as part of Tkinter, so we do not need to install anything extra. To use Ttk widgets in our Tkinter applications, we will need to import <code class="Code-In-Text--PACKT-">ttk</code> like this:</p>
    <pre class="programlisting code"><code class="hljs-code">from tkinter import ttk
</code></pre>
    <p class="normal">In this section, we'll take a deeper look at the Ttk widgets<a id="_idIndexMarker143"/> that will be useful in our application. Remember from our design that we need the following types of widgets for our application:</p>
    <ul>
      <li class="bullet">Labels</li>
      <li class="bullet">Date entry</li>
      <li class="bullet">Text entry</li>
      <li class="bullet">Number entry</li>
      <li class="bullet">Check boxes</li>
      <li class="bullet">Radio buttons</li>
      <li class="bullet">Select list</li>
      <li class="bullet">Long text entry</li>
      <li class="bullet">Buttons</li>
      <li class="bullet">Boxed frames with headers</li>
    </ul>
    <p class="normal">Let's look at the Ttk widgets that we can use to meet these needs.</p>
    <h2 id="_idParaDest-57" class="title">The Label widget</h2>
    <p class="normal">We made good use<a id="_idIndexMarker144"/> of the Tkinter <code class="Code-In-Text--PACKT-">Label</code> widget in <em class="chapterRef">Chapter 1</em>, <em class="italic">Introduction to Tkinter</em>, and the Ttk version<a id="_idIndexMarker145"/> is essentially the same. We can create one like so:</p>
    <pre class="programlisting code"><code class="hljs-code">mylabel = ttk.Label(root, text='This is a label')
</code></pre>
    <p class="normal">This results in a label that looks like this:</p>
    <figure class="mediaobject"><img src="img/B17578_03_01.png" alt=""/></figure>
    <p class="packt_figref">Figure 3.1: A Ttk Label widget</p>
    <p class="normal">The Ttk <code class="Code-In-Text--PACKT-">Label</code> widget shares<a id="_idIndexMarker146"/> most of the same options as the Tk version, the most common<a id="_idIndexMarker147"/> of which are listed here:</p>
    <table id="table001-1" class="No-Table-Style _idGenTablePara-1">
      <colgroup>
        <col/>
        <col/>
        <col/>
      </colgroup>
      <tbody>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Argument</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Values</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Description</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">text</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">String</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The text content of the label</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">textvariable</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">StringVar</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The variable to bind to the contents of the label</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">anchor</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Cardinal direction</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The position of the text relative to the inner margins</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">justify</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">left</code>, <code class="Code-In-Text--PACKT-">right</code>, or <code class="Code-In-Text--PACKT-">center</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The alignment of the lines of text relative to one another</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">foreground</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Color string</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The color of the text</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">wraplength</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Integer</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Number of pixels before the text is wrapped to the next line</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">underline</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Integer</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The index of a character in <code class="Code-In-Text--PACKT-">text</code> to underline</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">font</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Font string or tuple</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The font to be used</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="normal">Note that a label's text can either be specified directly using <code class="Code-In-Text--PACKT-">text</code>, or bound to a <code class="Code-In-Text--PACKT-">StringVar</code>, allowing for dynamic label text. The <code class="Code-In-Text--PACKT-">underline</code> argument allows for underlining a single character in the label text; this is useful for indicating a keybinding for the user, for example, to activate a control widget labeled by the label. No keybinding is actually created by this argument; it's merely cosmetic. We'll learn to create keybindings in <em class="chapterRef">Chapter 10</em>, <em class="italic">Maintaining Cross-Platform Compatibility</em>.</p>
    <h2 id="_idParaDest-58" class="title">The Entry widget</h2>
    <p class="normal">The <code class="Code-In-Text--PACKT-">ttk.Entry</code> widget is a simple<a id="_idIndexMarker148"/> one-line text entry, just like the<a id="_idIndexMarker149"/> Tkinter version. It looks like this:</p>
    <figure class="mediaobject"><img src="img/B17578_03_02.png" alt=""/></figure>
    <p class="packt_figref">Figure 3.2: A Ttk Entry widget</p>
    <p class="normal">We can create an <code class="Code-In-Text--PACKT-">Entry</code> widget using this code:</p>
    <pre class="programlisting code"><code class="hljs-code">myentry = ttk.Entry(root, textvariable=my_string_var, width=20)
</code></pre>
    <p class="normal">The Ttk <code class="Code-In-Text--PACKT-">Entry</code> is very similar<a id="_idIndexMarker150"/> to the Tkinter <code class="Code-In-Text--PACKT-">Entry</code> widget we've already seen, and supports many of the same<a id="_idIndexMarker151"/> arguments. Here is a selection of the more common <code class="Code-In-Text--PACKT-">Entry</code> options:</p>
    <table id="table002-1" class="No-Table-Style _idGenTablePara-1">
      <colgroup>
        <col/>
        <col/>
        <col/>
      </colgroup>
      <tbody>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Argument</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Values</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Description</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">textvariable</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">StringVar</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Tkinter control variable to bind.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">show</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">String</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Character or string to show when the user types. Useful for password fields, for example.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">justify</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">left</code>, <code class="Code-In-Text--PACKT-">right</code>, or <code class="Code-In-Text--PACKT-">center</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Alignment of the text in the entry. <code class="Code-In-Text--PACKT-">left</code> is default.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">foreground</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Color string</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Color of text.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="normal">We'll learn some more options for the <code class="Code-In-Text--PACKT-">Entry</code> as we dig deeper into the capabilities of Ttk widgets in future chapters. The <code class="Code-In-Text--PACKT-">Entry</code> will be used for all of our text entry fields, as well as our <code class="Code-In-Text--PACKT-">Date</code> field. Ttk does not have a dedicated <code class="Code-In-Text--PACKT-">date</code> widget, but we'll learn in <em class="chapterRef">Chapter 5</em>, <em class="italic">Reducing User Error with Validation and Automation</em>, how to turn our <code class="Code-In-Text--PACKT-">Entry</code> into a <code class="Code-In-Text--PACKT-">date</code> field.</p>
    <h2 id="_idParaDest-59" class="title">The Spinbox widget</h2>
    <p class="normal">Like the Tkinter version, the Ttk <code class="Code-In-Text--PACKT-">Spinbox</code> adds increment<a id="_idIndexMarker152"/> and decrement buttons<a id="_idIndexMarker153"/> to the standard <code class="Code-In-Text--PACKT-">Entry</code> widget, making it suitable for numerical data.</p>
    <p class="normal">The Ttk <code class="Code-In-Text--PACKT-">Spinbox</code> is shown here:</p>
    <figure class="mediaobject"><img src="img/B17578_03_03.png" alt=""/></figure>
    <p class="packt_figref">Figure 3.3: A Ttk Spinbox widget</p>
    <p class="normal">We can create<a id="_idIndexMarker154"/> one like this:</p>
    <pre class="programlisting code"><code class="hljs-code">myspinbox = ttk.Spinbox(
  root,
  from_=0, to=100, increment=.01,
  textvariable=my_int_var,
  command=my_callback
)
</code></pre>
    <p class="normal">As this code shows, the Ttk <code class="Code-In-Text--PACKT-">Spinbox</code> takes a number of arguments that control the behavior<a id="_idIndexMarker155"/> of its arrow buttons, listed in this table:</p>
    <table id="table003-1" class="No-Table-Style _idGenTablePara-1">
      <colgroup>
        <col/>
        <col/>
        <col/>
      </colgroup>
      <tbody>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Argument</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Values</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Description</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">from_</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Float or Int</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Minimum value the arrows will decrement to.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">to</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Float or Int</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Maximum value the arrows will increment to.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">increment</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Float or Int</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Value that will be added or subtracted by the arrows.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">command</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Python function</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Callback to be executed when either button is pushed.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">textvariable</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Control variable (any type)</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Variable bound to the field value.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">values</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">List of strings or numbers</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Set of choices the buttons will scroll through. Overrides the <code class="Code-In-Text--PACKT-">from_</code> and <code class="Code-In-Text--PACKT-">to</code> values.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="normal">Note that these arguments do <em class="italic">not</em> restrict what is entered into the <code class="Code-In-Text--PACKT-">Spinbox</code>; they only impact the behavior of the arrows. Also, be aware that if you specify only one of <code class="Code-In-Text--PACKT-">from_</code> or <code class="Code-In-Text--PACKT-">to</code>, the other defaults to <code class="Code-In-Text--PACKT-">0</code> automatically. This can lead to unexpected behavior; for example, if you set <code class="Code-In-Text--PACKT-">from_=1</code> without specifying <code class="Code-In-Text--PACKT-">to</code>, then <code class="Code-In-Text--PACKT-">to</code> will default to <code class="Code-In-Text--PACKT-">0</code> and your arrows will only toggle between <code class="Code-In-Text--PACKT-">1</code> and <code class="Code-In-Text--PACKT-">0</code>. To explicitly set no limit, you can use <code class="Code-In-Text--PACKT-">from_='-infinity'</code> and <code class="Code-In-Text--PACKT-">to='infinity'</code>.</p>
    <p class="normal">The <code class="Code-In-Text--PACKT-">Spinbox</code> widget is not merely for numbers, even though that's primarily how we'll be using it. As you can see, it can also take a <code class="Code-In-Text--PACKT-">values</code> argument, which is a list of strings or numbers that can be scrolled<a id="_idIndexMarker156"/> through using the arrow buttons. Because of this, the <code class="Code-In-Text--PACKT-">Spinbox</code> can be<a id="_idIndexMarker157"/> bound to any kind of control variable, not just <code class="Code-In-Text--PACKT-">IntVar</code> or <code class="Code-In-Text--PACKT-">DoubleVar</code> variables.</p>
    <div><p class="Information-Box--PACKT-">Remember, none of these parameters actually limit what can be typed into a <code class="Code-In-Text--PACKT-">Spinbox</code> widget. It's really nothing more than an <code class="Code-In-Text--PACKT-">Entry</code> widget with buttons tacked on, and you can type not only numeric values outside the valid range but letters and symbols as well. Doing so can cause an exception if you've bound the widget to a non-string variable. In <em class="chapterRef">Chapter 5</em>, <em class="italic">Reducing User Error with Validation and Automation</em>, we'll learn how to make the <code class="Code-In-Text--PACKT-">Spinbox</code> widget limit entry to valid numeric characters only.</p>
    </div>
    <h2 id="_idParaDest-60" class="title">The Checkbutton widget</h2>
    <p class="normal">The Ttk <code class="Code-In-Text--PACKT-">Checkbutton</code> widget is a labeled<a id="_idIndexMarker158"/> checkbox ideal for entering Boolean data. It can<a id="_idIndexMarker159"/> be created like so:</p>
    <pre class="programlisting code"><code class="hljs-code">mycheckbutton = ttk.Checkbutton(
  root,
  variable=my_bool_var,
  textvariable=my_string_var,
  command=my_callback
)
</code></pre>
    <p class="normal"><code class="Code-In-Text--PACKT-">Checkbutton</code> widgets can take a number of arguments in addition to those listed above, as shown in this table:</p>
    <table id="table004-1" class="No-Table-Style _idGenTablePara-1">
      <colgroup>
        <col/>
        <col/>
        <col/>
      </colgroup>
      <tbody>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Argument</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Values</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Description</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">variable</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Control variable</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The variable to which the checked/unchecked state of the box is bound</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">text</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">String</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The label text</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">textvariable</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">StringVar</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The variable to which the label text is bound</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">command</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Python function</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">A callback to execute whenever the box is checked or unchecked</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">onvalue</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Any</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Value to set <code class="Code-In-Text--PACKT-">variable</code> when the box is checked</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">offvalue</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Any</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Value to set <code class="Code-In-Text--PACKT-">variable</code> when the box is unchecked</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">underline</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Integer</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Index of a character in <code class="Code-In-Text--PACKT-">text</code> to underline</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="normal">The label included in the <code class="Code-In-Text--PACKT-">Checkbutton</code> can be set directly using the <code class="Code-In-Text--PACKT-">text</code> argument, or it can be bound to a control<a id="_idIndexMarker160"/> variable using <code class="Code-In-Text--PACKT-">textvariable</code>. This allows for dynamic labeling<a id="_idIndexMarker161"/> of the widget, which can be useful in many situations.</p>
    <p class="normal">Although the <code class="Code-In-Text--PACKT-">Checkbutton</code> is ideal for Boolean data and defaults to setting its bound variable to <code class="Code-In-Text--PACKT-">True</code> or <code class="Code-In-Text--PACKT-">False</code>, we can override this behavior with the <code class="Code-In-Text--PACKT-">onvalue</code> and <code class="Code-In-Text--PACKT-">offvalue</code> arguments, allowing it to be usable with any type of control variable.</p>
    <p class="normal">For example, we can use it with a <code class="Code-In-Text--PACKT-">DoubleVar</code> like so:</p>
    <pre class="programlisting code"><code class="hljs-code">mycheckbutton2 = ttk.Checkbutton(
  root,
  variable=my_dbl_var,
  text='Would you like Pi?',
  onvalue=3.14159,
  offvalue=0,
  underline=15
)
</code></pre>
    <p class="normal">The Ttk <code class="Code-In-Text--PACKT-">Checkbutton</code> places the label to the right of the box, as shown in this screenshot:</p>
    <figure class="mediaobject"><img src="img/B17578_03_04.png" alt=""/></figure>
    <p class="packt_figref">Figure 3.4: A Ttk Checkbutton widget with its built-in label</p>
    <h2 id="_idParaDest-61" class="title">The Radiobutton widget</h2>
    <p class="normal">Like its Tkinter counterpart, the Ttk <code class="Code-In-Text--PACKT-">Radiobutton</code> widget<a id="_idIndexMarker162"/> is used for selection among a set of mutually<a id="_idIndexMarker163"/> exclusive options. A single <code class="Code-In-Text--PACKT-">Radiobutton</code> by itself is not a terribly useful widget; instead, they are usually created as a group, as shown here:</p>
    <figure class="mediaobject"><img src="img/B17578_03_05.png" alt=""/></figure>
    <p class="packt_figref">Figure 3.5: A pair of Ttk Radiobutton widgets</p>
    <p class="normal">The following code<a id="_idIndexMarker164"/> shows how to create<a id="_idIndexMarker165"/> these buttons:</p>
    <pre class="programlisting code"><code class="hljs-code">buttons = tk.Frame(root)
r1 = ttk.Radiobutton(
  buttons,
  variable=my_int_var,
  value=1,
  text='One'
)
r2 = ttk.Radiobutton(
  buttons,
  variable=my_int_var,
  value=2,
  text='Two'
)
</code></pre>
    <p class="normal">To group <code class="Code-In-Text--PACKT-">Radiobutton</code> widgets, you simply need to assign them all the same control variable, then add a distinct <code class="Code-In-Text--PACKT-">value</code> to each button. In our example, we've also grouped them on the same parent widget, but this is merely for visual reasons and not strictly necessary.</p>
    <p class="normal">This table shows some of the various arguments you can use with a <code class="Code-In-Text--PACKT-">Radiobutton</code>:</p>
    <table id="table005" class="No-Table-Style _idGenTablePara-1">
      <colgroup>
        <col/>
        <col/>
        <col/>
      </colgroup>
      <tbody>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Argument</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Values</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Description</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">variable</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Control variable</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">A variable to be bound to the button's selected state</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">value</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Any</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">A value to set the variable to when the button is selected</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">command</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Python function</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">A callback to execute when the button is clicked</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">text</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">String</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The label connected to the radio button</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">textvariable</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">StringVar</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">A variable bound to the button's label text</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">underline</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Integer</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Index of a character in <code class="Code-In-Text--PACKT-">text</code> to underline</p>
          </td>
        </tr>
      </tbody>
    </table>
    <h2 id="_idParaDest-62" class="title">The Combobox widget</h2>
    <p class="normal">In <em class="chapterRef">Chapter 1</em>, <em class="italic">Introduction to Tkinter</em>, we learned about a couple of options for providing a selection between distinct<a id="_idIndexMarker166"/> options: the <code class="Code-In-Text--PACKT-">Listbox</code> and <code class="Code-In-Text--PACKT-">OptionMenu</code> widgets. Ttk offers<a id="_idIndexMarker167"/> a new widget for this purpose, <code class="Code-In-Text--PACKT-">Combobox</code>. The <code class="Code-In-Text--PACKT-">Combobox</code> widget is an <code class="Code-In-Text--PACKT-">Entry</code> widget that has a drop-down listbox added. It not only allows for mouse selection, but also keyboard entry. Although it may seem like <code class="Code-In-Text--PACKT-">OptionMenu</code> is a better fit for our application in some ways, we're going to exploit the <code class="Code-In-Text--PACKT-">Combobox</code> widget's keyboard functionality to build a superior drop-down widget.</p>
    <p class="normal">We can create a <code class="Code-In-Text--PACKT-">Combobox</code> widget like so:</p>
    <pre class="programlisting code"><code class="hljs-code">mycombo = ttk.Combobox(
  root, textvariable=my_string_var,
  values=['This option', 'That option', 'Another option']
)
</code></pre>
    <p class="normal">Running that code will give us a combo box that looks something like this:</p>
    <figure class="mediaobject"><img src="img/B17578_03_06.png" alt=""/></figure>
    <p class="packt_figref">Figure 3.6: A Ttk Combobox widget</p>
    <p class="normal">Note that while we can specify a list of possible values to populate the drop-down listbox, the <code class="Code-In-Text--PACKT-">Combobox</code> widget is not limited to those values. Users can type any text they wish into the box and the bound variable will be updated accordingly. By default, the <code class="Code-In-Text--PACKT-">Combobox</code> is not suited to a list of values that must remain constrained to a set list; however, in <em class="chapterRef">Chapter 5</em>, <em class="italic">Reducing User Error with Validation and Automation</em>, we'll learn how to address this.</p>
    <p class="normal">This table shows some of the common arguments used with a <code class="Code-In-Text--PACKT-">Combobox</code>:</p>
    <table id="table006" class="No-Table-Style _idGenTablePara-1">
      <colgroup>
        <col/>
        <col/>
        <col/>
      </colgroup>
      <tbody>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Argument</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Values</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Description</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">textvariable</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">StringVar</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Variable bound to the contents of the <code class="Code-In-Text--PACKT-">Combobox</code></p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">values</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">List of strings</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Values to populate the drop-down <code class="Code-In-Text--PACKT-">listbox</code></p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">postcommand</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Python function</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Callback to run just before the <code class="Code-In-Text--PACKT-">listbox</code> is displayed</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">justify</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">left</code>, <code class="Code-In-Text--PACKT-">right</code>, or <code class="Code-In-Text--PACKT-">center</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Alignment of text in the box</p>
          </td>
        </tr>
      </tbody>
    </table>
    <h2 id="_idParaDest-63" class="title">The Text widget</h2>
    <p class="normal">The <code class="Code-In-Text--PACKT-">Text</code> widget, which we have already met in <em class="chapterRef">Chapter 1</em>, <em class="italic">Introduction to Tkinter</em>, is the only widget we'll use that <em class="italic">does not</em> have a Ttk version. While this widget is most often used for multi-line<a id="_idIndexMarker168"/> text entry, it actually offers much more than that. The <code class="Code-In-Text--PACKT-">Text</code> widget<a id="_idIndexMarker169"/> can be used to display or edit text that contains images, multicolored text, hyperlink-style clickable text, and much more.</p>
    <p class="normal">We can add one to an application as follows:</p>
    <pre class="programlisting code"><code class="hljs-code">mytext = tk.Text(
  root,
  undo=True, maxundo=100,
  spacing1=10, spacing2=2, spacing3=5,
  height=5, wrap='char'
)
</code></pre>
    <p class="normal">The above code will produce something that looks like this:</p>
    <figure class="mediaobject"><img src="img/B17578_03_07.png" alt=""/></figure>
    <p class="packt_figref">Figure 3.7: A Tk Text widget</p>
    <p class="normal">The <code class="Code-In-Text--PACKT-">Text</code> widget has a large<a id="_idIndexMarker170"/> number of arguments we can specify to control its appearance<a id="_idIndexMarker171"/> and behavior. Some of the more useful ones are listed in this table:</p>
    <table id="table007" class="No-Table-Style _idGenTablePara-1">
      <colgroup>
        <col/>
        <col/>
        <col/>
      </colgroup>
      <tbody>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Argument</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Values</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Description</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">height</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Integer</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Height of the widget in lines of text.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">width</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Integer</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Width of the widget in number of characters. For variable-width fonts, the width of a "0" character is used to calculate the width.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">undo</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Boolean</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Activates or deactivates the undo functionality. Undo and redo actions are activated using the platform's default shortcuts.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">maxundo</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Integer</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Maximum number of edits that will be stored for undo.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">wrap</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">none</code>, <code class="Code-In-Text--PACKT-">char</code>, or <code class="Code-In-Text--PACKT-">word</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Specifies how a line of text will be broken and wrapped when it exceeds the width of the widget.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">spacing1</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Integer</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The number of pixels to pad above each complete line of text.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">spacing2</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Integer</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The number of pixels to pad between displayed lines of wrapped text.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">spacing3</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Integer</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The number of pixels to pad below each complete line of text.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="normal">More advanced visual configuration of the <code class="Code-In-Text--PACKT-">Text</code> widget is implemented using <strong class="keyword">tags</strong>. We'll discuss tags in <em class="chapterRef">Chapter 9</em>, <em class="italic">Improving the Look with Styles and Themes</em>.</p>
    <h3 id="_idParaDest-64" class="title">Text widget indices</h3>
    <p class="normal">Remember that a <code class="Code-In-Text--PACKT-">Text</code> widget cannot be bound to a control variable; to access, set, or clear its contents, we need to use its <code class="Code-In-Text--PACKT-">get()</code>, <code class="Code-In-Text--PACKT-">insert()</code>, and <code class="Code-In-Text--PACKT-">delete()</code> methods, respectively.</p>
    <p class="normal">When reading or modifying with these methods, you are required to pass in one or two <strong class="keyword">index values</strong> to select<a id="_idIndexMarker172"/> the character or range of characters that you're operating<a id="_idIndexMarker173"/> on. These index values are strings that can take any of the following formats:</p>
    <ul>
      <li class="bullet">The line number and character number separated by a dot. Lines are numbered from 1 and characters from 0, so the first character on the first line is <code class="Code-In-Text--PACKT-">1.0</code>, while the twelfth character on the fourth line would be <code class="Code-In-Text--PACKT-">4.11</code>. Note that a <em class="italic">line</em> is determined by the presence of a newline character; a wrapped line of text is still only considered one line for index purposes.</li>
      <li class="bullet">The string literal <code class="Code-In-Text--PACKT-">end</code>, or the Tkinter constant <code class="Code-In-Text--PACKT-">END</code>, indicating the end of the text.</li>
      <li class="bullet">A numerical index plus one of the words <code class="Code-In-Text--PACKT-">linestart</code>, <code class="Code-In-Text--PACKT-">lineend</code>, <code class="Code-In-Text--PACKT-">wordstart</code>, or <code class="Code-In-Text--PACKT-">wordend</code>, indicating the start or end of the line or word relative to the numerical index. For example:<ul>
          <li class="bullet-l2"><code class="Code-In-Text--PACKT-">6.2 wordstart</code> would be the start of the word containing the third character on line 6</li>
          <li class="bullet-l2"><code class="Code-In-Text--PACKT-">2.0 lineend</code> would be the end of line 2</li>
        </ul>
      </li>
      <li class="bullet">Any of the preceding, a plus or minus operator, and a number of characters or lines. For example:<ul>
          <li class="bullet-l2"><code class="Code-In-Text--PACKT-">2.5 wordend - 1 chars</code> would be the character before the end of the word containing the sixth character on line 2</li>
        </ul>
      </li>
    </ul>
    <p class="normal">The following example<a id="_idIndexMarker174"/> shows these indices in action:</p>
    <pre class="programlisting code"><code class="hljs-code"># insert a string at the beginning
mytext.insert('1.0', "I love my text widget!")
# insert a string into the current text
mytext.insert('1.2', 'REALLY ')
# get the whole string
mytext.get('1.0', tk.END)
# delete the last character.
mytext.delete('end - 2 chars')
</code></pre>
    <p class="normal">Note in the last example<a id="_idIndexMarker175"/> that we deleted two characters in order to delete the last character. The <code class="Code-In-Text--PACKT-">Text</code> widget automatically appends a newline to the end of its text content, so we always need to remember to account for that extra character when dealing with indices or the extracted text.</p>
    <div><p class="Tip--PACKT-">Remember, these indices should be <em class="italic">strings</em>, not float values! Float values will sometimes work due to implicit type casting, but don't rely on that behavior.</p>
    </div>
    <h2 id="_idParaDest-65" class="title">The Button widget</h2>
    <p class="normal">The Ttk <code class="Code-In-Text--PACKT-">Button</code> is a simple clickable<a id="_idIndexMarker176"/> pushbutton that can activate a callback function. It appears<a id="_idIndexMarker177"/> something like this:</p>
    <figure class="mediaobject"><img src="img/B17578_03_08.png" alt=""/></figure>
    <p class="packt_figref">Figure 3.8: A Ttk Button widget</p>
    <p class="normal">We can create one like so:</p>
    <pre class="programlisting code"><code class="hljs-code">mybutton = ttk.Button(
  root,
  command=my_callback,
  text='Click Me!',
  default='active'
)
</code></pre>
    <p class="normal">The button is a pretty straightforward widget, but it has a few options that can be used to configure it. These are shown in the table below:</p>
    <table id="table008" class="No-Table-Style _idGenTablePara-1">
      <colgroup>
        <col/>
        <col/>
        <col/>
      </colgroup>
      <tbody>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Arguments</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Values</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Description</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">text</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">String</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Label text on the button.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">textvariable</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">StringVar</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Variable bound to the label text of the button.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">command</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Python function</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Callback to be executed when the button is clicked.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">default</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">normal</code>, <code class="Code-In-Text--PACKT-">active</code>, <code class="Code-In-Text--PACKT-">disabled</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">If the button executes when <code class="Code-In-Text--PACKT-">Enter</code> is pushed. <code class="Code-In-Text--PACKT-">active</code> means it will execute in response to <code class="Code-In-Text--PACKT-">Enter</code>, <code class="Code-In-Text--PACKT-">normal</code> means it will only if selected first, and <code class="Code-In-Text--PACKT-">disabled</code> means it will not respond to <code class="Code-In-Text--PACKT-">Enter</code>.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">underline</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Integer</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Index of a character in <code class="Code-In-Text--PACKT-">text</code> to underline.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="normal">Buttons can also be configured to display images rather than text. We'll learn more about that in <em class="chapterRef">Chapter 9</em>, <em class="italic">Improving the Look with Styles and Themes</em>.</p>
    <h2 id="_idParaDest-66" class="title">The LabelFrame widget</h2>
    <p class="normal">In <em class="chapterRef">Chapter 1</em>, <em class="italic">Introduction to Tkinter</em>, we used the <code class="Code-In-Text--PACKT-">Frame</code> widget to group together our widgets. Ttk offers us a more powerful option in the <code class="Code-In-Text--PACKT-">LabelFrame</code>, which provides a frame with a border<a id="_idIndexMarker178"/> and a label. This is a very useful widget to provide visual grouping<a id="_idIndexMarker179"/> for widgets in our GUI.</p>
    <p class="normal">This code shows an example of a <code class="Code-In-Text--PACKT-">LabelFrame</code>:</p>
    <pre class="programlisting code"><code class="hljs-code">mylabelframe = ttk.LabelFrame(
  root,
  text='Button frame'
)
b1 = ttk.Button(
  mylabelframe,
  text='Button 1'
)
b2 = ttk.Button(
  mylabelframe,
  text='Button 2'
)
b1.pack()
b2.pack()
</code></pre>
    <p class="normal">The resulting GUI would look like this:</p>
    <figure class="mediaobject"><img src="img/B17578_03_09.png" alt=""/></figure>
    <p class="packt_figref">Figure 3.9: A Ttk LabelFrame widget</p>
    <p class="normal">The <code class="Code-In-Text--PACKT-">LabelFrame</code> widget offers us a few arguments for configuration, shown here:</p>
    <table id="table009" class="No-Table-Style _idGenTablePara-1">
      <colgroup>
        <col/>
        <col/>
        <col/>
      </colgroup>
      <tbody>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Argument</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Values</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Heading--PACKT-">Description</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">text</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">String</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The text of the label to display.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">labelanchor</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Cardinal direction</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Where to anchor the text label.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">labelwidget</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">ttk.Label</code> object</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">A label widget to use for the label. Overrides <code class="Code-In-Text--PACKT-">text</code>.</p>
          </td>
        </tr>
        <tr class="No-Table-Style">
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-"><code class="Code-In-Text--PACKT-">underline</code></p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">Integer</p>
          </td>
          <td class="No-Table-Style">
            <p class="Table-Column-Content--PACKT-">The index of a character in <code class="Code-In-Text--PACKT-">text</code> to underline.</p>
          </td>
        </tr>
      </tbody>
    </table>
    <p class="normal">As you can see, we can configure the label of the <code class="Code-In-Text--PACKT-">LabelFrame</code> either by specifying the <code class="Code-In-Text--PACKT-">text</code> argument, or by creating a <code class="Code-In-Text--PACKT-">Label</code> widget and assigning it using the <code class="Code-In-Text--PACKT-">labelwidget</code> argument. The latter case<a id="_idIndexMarker180"/> may be preferable if we want to take advantage of some of the <code class="Code-In-Text--PACKT-">Label</code> widget's advanced<a id="_idIndexMarker181"/> features, such as binding a <code class="Code-In-Text--PACKT-">textvariable</code> to it. If we use it, it will override the <code class="Code-In-Text--PACKT-">text</code> argument.</p>
    <div><p class="Information-Box--PACKT-">Tkinter and Ttk contain many more widgets, some of which we'll encounter later in this book. Python also ships with a widget library called <code class="Code-In-Text--PACKT-">tix</code>, which contains several dozen widgets. However, <code class="Code-In-Text--PACKT-">tix</code> is very outdated, and we won't be covering it in this book. You should know that it exists, though.</p>
    </div>
    <h1 id="_idParaDest-67" class="title">Implementing the application</h1>
    <p class="normal">So far, we've learned some Tkinter basics, researched the user's needs, designed our application, and determined which Ttk widgets will be useful in our application. Now it's time to put<a id="_idIndexMarker182"/> all of this together and actually code the first version of the ABQ Data Entry application. Recall our design from <em class="chapterRef">Chapter 2</em>, <em class="italic">Designing GUI Applications</em>, shown here:</p>
    <figure class="mediaobject"><img src="img/B17578_03_10.png" alt=""/></figure>
    <p class="packt_figref">Figure 3.10: The ABQ Data Entry application layout</p>
    <p class="normal">Take a moment to review the widgets we need to create, and we'll begin coding.</p>
    <h2 id="_idParaDest-68" class="title">First steps</h2>
    <p class="normal">Open a new file in your<a id="_idIndexMarker183"/> editor called <code class="Code-In-Text--PACKT-">data_entry_app.py</code>, and let's begin like this:</p>
    <pre class="programlisting code"><code class="hljs-code"># data_entry_app.py
"""The ABQ Data Entry application"""
import tkinter as tk
from tkinter import ttk
from datetime import datetime
from pathlib import Path
import csv
</code></pre>
    <p class="normal">Our script starts with a <strong class="keyword">docstring</strong>, as all Python scripts should. This string at a minimum should give the name<a id="_idIndexMarker184"/> of the application to which the file belongs, and may also include notes about usage, authorship, or other items a future maintainer would need to know.</p>
    <p class="normal">Next, we're importing the Python modules<a id="_idIndexMarker185"/> that we'll need for this application; these are:</p>
    <ul>
      <li class="bullet"><code class="Code-In-Text--PACKT-">tkinter</code> and <code class="Code-In-Text--PACKT-">ttk</code>, of course, for our GUI items</li>
      <li class="bullet">The <code class="Code-In-Text--PACKT-">datetime</code> class, from the <code class="Code-In-Text--PACKT-">datetime</code> module, which we'll use to generate a datestring for the filename</li>
      <li class="bullet">The <code class="Code-In-Text--PACKT-">Path</code> class, from the <code class="Code-In-Text--PACKT-">pathlib</code> module, which is used for some file operations in our save routine</li>
      <li class="bullet">The <code class="Code-In-Text--PACKT-">csv</code> module, which we'll use to interact with the CSV file</li>
    </ul>
    <p class="normal">Next, let's create some global variables that the app will use to keep track of information:</p>
    <pre class="programlisting code"><code class="hljs-code">variables = dict()
records_saved = 0
</code></pre>
    <p class="normal">The <code class="Code-In-Text--PACKT-">variables</code> dictionary will hold all of the form's control variables. Keeping them in a dictionary will make it a little easier to manage them and will keep our global namespace lean and clean. The <code class="Code-In-Text--PACKT-">records_saved</code> variable will store how many records the user has saved since opening the app.</p>
    <p class="normal">Now it's time to create and configure the root window:</p>
    <pre class="programlisting code"><code class="hljs-code">root = tk.Tk()
root.title('ABQ Data Entry Application')
root.columnconfigure(0, weight=1)
</code></pre>
    <p class="normal">We've set the window title for the application and also configured its layout grid so that the first column is allowed to expand. The root window will only have one column, but by setting this it will allow the form to remain centered on the application if the window is expanded. Without it, the form would be stuck to the left side of the window when the window is expanded.</p>
    <p class="normal">Now we'll add a heading for the application:</p>
    <pre class="programlisting code"><code class="hljs-code">ttk.Label(
  root, text="ABQ Data Entry Application",
  font=("TkDefaultFont", 16)
).grid()
</code></pre>
    <p class="normal">Because we won't need to refer to this widget again, we won't bother assigning it to a variable. This also allows us to call <code class="Code-In-Text--PACKT-">grid()</code> on the <code class="Code-In-Text--PACKT-">Label</code> on the same line, keeping our code more concise and the namespace less cluttered. We'll do this for most of the widgets in the application, unless there is some reason we may need to interact with the widget elsewhere in the code.</p>
    <div><p class="Information-Box--PACKT-">Note that we used <code class="Code-In-Text--PACKT-">TkDefaultFont</code> as the font family value for this label widget. This is an alias defined in Tkinter that points to the default window font on your platform. We'll learn more about fonts in <em class="chapterRef">Chapter 9</em>, <em class="italic">Improving the Look with Styles and Themes</em>.</p>
    </div>
    <h2 id="_idParaDest-69" class="title">Building the data record form</h2>
    <p class="normal">With the initial application<a id="_idIndexMarker186"/> window set up, let's start building the actual data entry form. We'll create a frame to contain the entire data<a id="_idIndexMarker187"/> record form, called <code class="Code-In-Text--PACKT-">drf</code>:</p>
    <pre class="programlisting code"><code class="hljs-code">drf = ttk.Frame(root)
drf.grid(padx=10, sticky=(tk.E + tk.W))
drf.columnconfigure(0, weight=1)
</code></pre>
    <p class="normal">The <code class="Code-In-Text--PACKT-">drf</code> frame is added to the main window with a bit of horizontal padding, and the <code class="Code-In-Text--PACKT-">sticky</code> argument ensures that it will stretch when the containing column is stretched. We're also going to configure its grid to expand the first column.</p>
    <div><p class="Tip--PACKT-">For windows or frames using a grid layout, if you want to make the child widgets stretch when the parent is stretched, you need to make sure both the container will expand (using <code class="Code-In-Text--PACKT-">columnconfigure</code> and <code class="Code-In-Text--PACKT-">rowconfigure</code> on the parent) <em class="italic">and</em> the child widget will expand with the container (using <code class="Code-In-Text--PACKT-">sticky</code> when you call <code class="Code-In-Text--PACKT-">grid()</code> on the child widget).</p>
    </div>
    <h3 id="_idParaDest-70" class="title">The Record Information section</h3>
    <p class="normal">The first section<a id="_idIndexMarker188"/> of our form is the <code class="Code-In-Text--PACKT-">Record Information</code> section. Let's create and configure a <code class="Code-In-Text--PACKT-">LabelFrame</code> to store that:</p>
    <pre class="programlisting code"><code class="hljs-code">r_info = ttk.LabelFrame(drf, text='Record Information')
r_info.grid(sticky=(tk.W + tk.E))
for i in range(3):
  r_info.columnconfigure(i, weight=1)
</code></pre>
    <p class="normal">We start by creating a Ttk <code class="Code-In-Text--PACKT-">LabelFrame</code> widget with the data record form as its parent. We add it to the<a id="_idIndexMarker189"/> parent's grid, setting the <code class="Code-In-Text--PACKT-">sticky</code> argument so that it will expand when the window is resized. Each frame of this form is going to have three columns of input widgets, and we want each column to expand evenly to fill the width of the frame. So, we have used a <code class="Code-In-Text--PACKT-">for</code> loop to set the <code class="Code-In-Text--PACKT-">weight</code> attribute of each column to <code class="Code-In-Text--PACKT-">1</code>.</p>
    <p class="normal">Now we can begin creating the contents of the frame, starting with the first input widget, the <code class="Code-In-Text--PACKT-">Date</code> field:</p>
    <pre class="programlisting code"><code class="hljs-code">variables['Date'] = tk.StringVar()
ttk.Label(r_info, text='Date').grid(row=0, column=0)
ttk.Entry(
  r_info, textvariable=variables['Date']
).grid(row=1, column=0, sticky=(tk.W + tk.E))
</code></pre>
    <p class="normal">First, we created a control variable and put it in the <code class="Code-In-Text--PACKT-">variables</code> dictionary. Then we created our <code class="Code-In-Text--PACKT-">Label</code> widget for the <code class="Code-In-Text--PACKT-">Date</code> field and added it to the <code class="Code-In-Text--PACKT-">LabelFrame</code> widget's grid. We're going to use explicit <code class="Code-In-Text--PACKT-">row</code> and <code class="Code-In-Text--PACKT-">column</code> values here, even when it's not strictly necessary, because we're going to be placing objects a little out of order. Without explicit coordinates, things could get confusing.</p>
    <p class="normal">Finally, we create the <code class="Code-In-Text--PACKT-">Entry</code> widget, passing in the control variable. Note that we aren't going to save any references to our widgets if we can use a variable to store the value. This will keep the code more concise. We've added our widget to the grid, placing it <em class="italic">below</em> its label by specifying the first column of the next row. For both the <code class="Code-In-Text--PACKT-">Entry</code> and the <code class="Code-In-Text--PACKT-">Label</code>, we've used the <code class="Code-In-Text--PACKT-">sticky</code> argument to make sure the widget stretches when the GUI is expanded.</p>
    <p class="normal">Now let's add the rest of the first line, the <code class="Code-In-Text--PACKT-">Time</code> and <code class="Code-In-Text--PACKT-">Technician</code> fields:</p>
    <pre class="programlisting code"><code class="hljs-code">time_values = ['8:00', '12:00', '16:00', '20:00']
variables['Time'] = tk.StringVar()
ttk.Label(r_info, text='Time').grid(row=0, column=1)
ttk.Combobox(
  r_info, textvariable=variables['Time'], values=time_values
).grid(row=1, column=1, sticky=(tk.W + tk.E))
variables['Technician'] = tk.StringVar()
ttk.Label(r_info, text='Technician').grid(row=0, column=2)
ttk.Entry(
  r_info, textvariable=variables['Technician']
).grid(row=1, column=2, sticky=(tk.W + tk.E))
</code></pre>
    <p class="normal">Once again, we create a variable, <code class="Code-In-Text--PACKT-">Label</code>, and input widget for each item. Recall that the <code class="Code-In-Text--PACKT-">Combobox</code> widget takes a list of strings for its <code class="Code-In-Text--PACKT-">values</code> argument, which will populate the drop-down part<a id="_idIndexMarker190"/> of the widget. That takes care of the first row.</p>
    <p class="normal">On the second row, we'll start with the <code class="Code-In-Text--PACKT-">Lab</code> inputs:</p>
    <pre class="programlisting code"><code class="hljs-code">variables['Lab'] = tk.StringVar()
ttk.Label(r_info, text='Lab').grid(row=2, column=0)
labframe = ttk.Frame(r_info)
for lab in ('A', 'B', 'C'):
  ttk.Radiobutton(
    labframe, value=lab, text=lab, variable=variables['Lab']
).pack(side=tk.LEFT, expand=True)
labframe.grid(row=3, column=0, sticky=(tk.W + tk.E))
</code></pre>
    <p class="normal">Like before, we've created the control variable and <code class="Code-In-Text--PACKT-">Label</code>, but for the input widget we've created a <code class="Code-In-Text--PACKT-">Frame</code> to hold the three <code class="Code-In-Text--PACKT-">Radiobutton</code> widgets. We're also creating our <code class="Code-In-Text--PACKT-">Radiobutton</code> widgets using a <code class="Code-In-Text--PACKT-">for</code> loop to keep the code more concise and consistent.</p>
    <p class="normal">The <code class="Code-In-Text--PACKT-">pack()</code> geometry manager comes in handy here because we can populate from left to right without having to explicitly manage column numbers. The <code class="Code-In-Text--PACKT-">expand</code> argument causes the widget to use extra space when the window is resized; this will help our buttons to utilize available space and not be scrunched into the left side of the window.</p>
    <p class="normal">Now let's do the remaining portion of line two, the <code class="Code-In-Text--PACKT-">Plot</code> and <code class="Code-In-Text--PACKT-">Seed Sample</code> fields:</p>
    <pre class="programlisting code"><code class="hljs-code">variables['Plot'] = tk.IntVar()
ttk.Label(r_info, text='Plot').grid(row=2, column=1)
ttk.Combobox(
  r_info,
  textvariable=variables['Plot'],
  values=list(range(1, 21))
).grid(row=3, column=1, sticky=(tk.W + tk.E))
variables['Seed Sample'] = tk.StringVar()
ttk.Label(r_info, text='Seed Sample').grid(row=2, column=2)
ttk.Entry(
  r_info,
  textvariable=variables['Seed Sample']
).grid(row=3, column=2, sticky=(tk.W + tk.E))
</code></pre>
    <p class="normal">We have the same thing going<a id="_idIndexMarker191"/> on here: create a variable, create a <code class="Code-In-Text--PACKT-">Label</code>, create the input widget. Note that for the <code class="Code-In-Text--PACKT-">Plot</code> values we're generating a list using <code class="Code-In-Text--PACKT-">range()</code> to keep our code concise.</p>
    <h3 id="_idParaDest-71" class="title">The Environment Data section</h3>
    <p class="normal">The next part<a id="_idIndexMarker192"/> of the form is the <code class="Code-In-Text--PACKT-">Environment Data</code> frame. Let's begin that section as follows:</p>
    <pre class="programlisting code"><code class="hljs-code">e_info = ttk.LabelFrame(drf, text="Environment Data")
e_info.grid(sticky=(tk.W + tk.E))
for i in range(3):
  e_info.columnconfigure(i, weight=1)
</code></pre>
    <p class="normal">This is exactly what we did for the last <code class="Code-In-Text--PACKT-">LabelFrame</code>, with only the names updated. Let's start populating it with the <code class="Code-In-Text--PACKT-">Humidity</code>, <code class="Code-In-Text--PACKT-">Light</code>, and <code class="Code-In-Text--PACKT-">Temperature</code> widgets:</p>
    <pre class="programlisting code"><code class="hljs-code">variables['Humidity'] = tk.DoubleVar()
ttk.Label(e_info, text="Humidity (g/m)").grid(row=0, column=0)
ttk.Spinbox(
  e_info, textvariable=variables['Humidity'],
  from_=0.5, to=52.0, increment=0.01,
).grid(row=1, column=0, sticky=(tk.W + tk.E))
variables['Light'] = tk.DoubleVar()
ttk.Label(e_info, text='Light (klx)').grid(row=0, column=1)
ttk.Spinbox(
  e_info, textvariable=variables['Light'],
  from_=0, to=100, increment=0.01
).grid(row=1, column=1, sticky=(tk.W + tk.E))
variables['Temperature'] = tk.DoubleVar()
ttk.Label(e_info, text='Temperature (C)').grid(row=0, column=2)
ttk.Spinbox(
  e_info, textvariable=variables['Temperature'],
  from_=4, to=40, increment=.01
).grid(row=1, column=2, sticky=(tk.W + tk.E))
</code></pre>
    <p class="normal">Good! Now, for the second row of this section, we only need to add in the <code class="Code-In-Text--PACKT-">Equipment Fault</code> check button:</p>
    <pre class="programlisting code"><code class="hljs-code">variables['Equipment Fault'] = tk.BooleanVar(value=False)
ttk.Checkbutton(
  e_info, variable=variables['Equipment Fault'],
  text='Equipment Fault'
).grid(row=2, column=0, sticky=tk.W, pady=5)
</code></pre>
    <p class="normal">The first three values<a id="_idIndexMarker193"/> are all floating-point numbers, so we're using <code class="Code-In-Text--PACKT-">DoubleVar</code> control variables and <code class="Code-In-Text--PACKT-">Spinbox</code> widgets for entry. Don't forget to populate the <code class="Code-In-Text--PACKT-">from_</code>, <code class="Code-In-Text--PACKT-">to</code>, and <code class="Code-In-Text--PACKT-">increment</code> values for the <code class="Code-In-Text--PACKT-">Spinbox</code> widgets, so that the arrows behave properly. Our <code class="Code-In-Text--PACKT-">Checkbutton</code> takes a <code class="Code-In-Text--PACKT-">BooleanVar</code> control variable and doesn't need a <code class="Code-In-Text--PACKT-">Label</code> widget due to its built-in label. Also, note that because we've started a new frame, our rows and columns for the grid start over. This is a benefit of breaking up the form into smaller frames: we don't have to keep track of ever-increasing row or column numbers.</p>
    <h3 id="_idParaDest-72" class="title">The Plant Data section</h3>
    <p class="normal">We'll create the next frame, <code class="Code-In-Text--PACKT-">Plant Data</code>, just like the other two:</p>
    <pre class="programlisting code"><code class="hljs-code">p_info = ttk.LabelFrame(drf, text="Plant Data")
p_info.grid(sticky=(tk.W + tk.E))
for i in range(3):
  p_info.columnconfigure(i, weight=1)
</code></pre>
    <p class="normal">Now, having created<a id="_idIndexMarker194"/> and configured the frame, let's add in the first row of inputs, <code class="Code-In-Text--PACKT-">Plants</code>, <code class="Code-In-Text--PACKT-">Blossoms</code>, and <code class="Code-In-Text--PACKT-">Fruit</code>:</p>
    <pre class="programlisting code"><code class="hljs-code">variables['Plants'] = tk.IntVar()
ttk.Label(p_info, text='Plants').grid(row=0, column=0)
ttk.Spinbox(
  p_info, textvariable=variables['Plants'],
  from_=0, to=20, increment=1
).grid(row=1, column=0, sticky=(tk.W + tk.E))
variables['Blossoms'] = tk.IntVar()
ttk.Label(p_info, text='Blossoms').grid(row=0, column=1)
ttk.Spinbox(
  p_info, textvariable=variables['Blossoms'],
  from_=0, to=1000, increment=1
).grid(row=1, column=1, sticky=(tk.W + tk.E))
variables['Fruit'] = tk.IntVar()
ttk.Label(p_info, text='Fruit').grid(row=0, column=2)
ttk.Spinbox(
  p_info, textvariable=variables['Fruit'],
  from_=0, to=1000, increment=1
).grid(row=1, column=2, sticky=(tk.W + tk.E))
</code></pre>
    <p class="normal">There is nothing really new<a id="_idIndexMarker195"/> here, except that, since we're using <code class="Code-In-Text--PACKT-">IntVar</code> control variables, we've set the <code class="Code-In-Text--PACKT-">Spinbox</code> increment to <code class="Code-In-Text--PACKT-">1</code>. That won't really stop anyone from entering a decimal (or any arbitrary string for that matter), but at least the buttons won't steer the user wrong. In <em class="chapterRef">Chapter 5</em>, <em class="italic">Reducing User Error with Validation and Automation</em>, we'll see how to enforce <code class="Code-In-Text--PACKT-">increment</code> more thoroughly.</p>
    <p class="normal">And now finally our last row of inputs, <code class="Code-In-Text--PACKT-">Min Height</code>, <code class="Code-In-Text--PACKT-">Max Height</code>, and <code class="Code-In-Text--PACKT-">Med Height</code>:</p>
    <pre class="programlisting code"><code class="hljs-code">variables['Min Height'] = tk.DoubleVar()
ttk.Label(p_info, text='Min Height (cm)').grid(row=2, column=0)
ttk.Spinbox(
  p_info, textvariable=variables['Min Height'],
  from_=0, to=1000, increment=0.01
).grid(row=3, column=0, sticky=(tk.W + tk.E))
variables['Max Height'] = tk.DoubleVar()
ttk.Label(p_info, text='Max Height (cm)').grid(row=2, column=1)
ttk.Spinbox(
  p_info, textvariable=variables['Max Height'],
  from_=0, to=1000, increment=0.01
).grid(row=3, column=1, sticky=(tk.W + tk.E))
variables['Med Height'] = tk.DoubleVar()
ttk.Label(p_info, text='Median Height (cm)').grid(row=2, column=2)
ttk.Spinbox(
  p_info, textvariable=variables['Med Height'],
  from_=0, to=1000, increment=0.01
).grid(row=3, column=2, sticky=(tk.W + tk.E))
</code></pre>
    <p class="normal">We've made three more <code class="Code-In-Text--PACKT-">DoubleVar</code> objects, three more labels, and three more <code class="Code-In-Text--PACKT-">Spinbox</code> widgets. If this feels a little repetitive, don't be surprised; GUI code can tend to be quite repetitive. In <em class="chapterRef">Chapter 4</em>, <em class="italic">Organizing Our Code with Classes</em>, we'll find ways to reduce this repetitiveness.</p>
    <h3 id="_idParaDest-73" class="title">Finishing the GUI</h3>
    <p class="normal">That finishes our three info sections; now we need to add the <code class="Code-In-Text--PACKT-">Notes</code> input. We'll add it directly to the <code class="Code-In-Text--PACKT-">drf</code> frame with a label, like so:</p>
    <pre class="programlisting code"><code class="hljs-code">ttk.Label(drf, text="Notes").grid()
notes_inp = tk.Text(drf, width=75, height=10)
notes_inp.grid(sticky=(tk.W + tk.E))
</code></pre>
    <p class="normal">Since we cannot associate<a id="_idIndexMarker196"/> a control variable with the <code class="Code-In-Text--PACKT-">Text</code> widget, we'll need to keep a regular variable reference to it.</p>
    <div><p class="Information-Box--PACKT-">When you do need to save a reference to a widget, don't forget to call <code class="Code-In-Text--PACKT-">grid()</code> in a separate statement! Since <code class="Code-In-Text--PACKT-">grid()</code> (and other geometry manager methods) returns <code class="Code-In-Text--PACKT-">None</code>, if you create and position the widget in one statement your saved widget reference will just be <code class="Code-In-Text--PACKT-">None</code>.</p>
    </div>
    <p class="normal">We're almost finished with the form! We just need to add some buttons:</p>
    <pre class="programlisting code"><code class="hljs-code">buttons = tk.Frame(drf)
buttons.grid(sticky=tk.E + tk.W)
save_button = ttk.Button(buttons, text='Save')
save_button.pack(side=tk.RIGHT)
reset_button = ttk.Button(buttons, text='Reset')
reset_button.pack(side=tk.RIGHT)
</code></pre>
    <p class="normal">To keep the form's grid layout simpler, we've packed the two buttons into a sub-frame, using <code class="Code-In-Text--PACKT-">pack()</code> with the <code class="Code-In-Text--PACKT-">side</code> argument to keep them over on the right.</p>
    <p class="normal">That finishes the data record form; to finish out the application GUI, we only need to add in a status bar with an associated variable, like so:</p>
    <pre class="programlisting code"><code class="hljs-code">status_variable = tk.StringVar()
ttk.Label(
  root, textvariable=status_variable
).grid(sticky=tk.W + tk.E, row=99, padx=10)
</code></pre>
    <p class="normal">The status bar is simply a <code class="Code-In-Text--PACKT-">Label</code> widget, which we've placed on the <code class="Code-In-Text--PACKT-">root</code> window's grid at row <code class="Code-In-Text--PACKT-">99</code> to ensure that it stays at the bottom in case of any future additions to the application. Note that we have not added the status variable to the <code class="Code-In-Text--PACKT-">variables</code> dictionary; that dictionary is reserved for variables that will hold user input. This variable is just going to be used to display messages to the user.</p>
    <h2 id="_idParaDest-74" class="title">Writing the callback functions</h2>
    <p class="normal">Now that our layout is done, let's work<a id="_idIndexMarker197"/> on creating the functionality of our application. Our form has two buttons<a id="_idIndexMarker198"/> that need callback functions: <code class="Code-In-Text--PACKT-">Reset</code> and <code class="Code-In-Text--PACKT-">Save</code>.</p>
    <h3 id="_idParaDest-75" class="title">The Reset function</h3>
    <p class="normal">The job of our reset function is to return the entire form to a blank state so the user can enter in more data. We'll need<a id="_idIndexMarker199"/> this function not only as a callback to the <code class="Code-In-Text--PACKT-">Reset</code> button, but<a id="_idIndexMarker200"/> also to prepare the form for the next record after the user saves a record. Otherwise, the user would have to manually delete and overwrite the data in each field for every new record.</p>
    <p class="normal">Since we'll need to call the reset callback from the save callback, we need to write the reset function first. At the end of <code class="Code-In-Text--PACKT-">data_entry_app.py</code>, start a new function like so:</p>
    <pre class="programlisting code"><code class="hljs-code"># data_entry_app.py
def on_reset():
  """Called when reset button is clicked, or after save"""
</code></pre>
    <p class="normal">The function is called <code class="Code-In-Text--PACKT-">on_reset()</code>. Recall from <em class="chapterRef">Chapter 1</em>, <em class="italic">Introduction to Tkinter</em>, that, by convention, callback functions are typically named <code class="Code-In-Text--PACKT-">on_&lt;eventname&gt;</code>, where <code class="Code-In-Text--PACKT-">eventname</code> refers to the event that triggers it. Since this will be triggered by clicking the <code class="Code-In-Text--PACKT-">Reset</code> button, we'll call it <code class="Code-In-Text--PACKT-">on_reset()</code>.</p>
    <p class="normal">Inside the function, we need to reset all the widgets to an empty value. But wait! We didn't save references to any of the widgets, apart from the <code class="Code-In-Text--PACKT-">Notes</code> input. What do we need to do?</p>
    <p class="normal">Simple: we reset all the <em class="italic">variables</em> to a blank string, like this:</p>
    <pre class="programlisting code"><code class="hljs-code">  for variable in variables.values():
    if isinstance(variable, tk.BooleanVar):
      variable.set(False)
    else:
      variable.set('')
  notes_inp.delete('1.0', tk.END)
</code></pre>
    <p class="normal"><code class="Code-In-Text--PACKT-">StringVar</code>, <code class="Code-In-Text--PACKT-">DoubleVar</code>, and <code class="Code-In-Text--PACKT-">IntVar</code> objects can be set to a blank string, which will cause any widgets bound to them to be blank. <code class="Code-In-Text--PACKT-">BooleanVar</code> variables will raise an exception if we try to do that, so instead we'll check if our variable is a <code class="Code-In-Text--PACKT-">BooleanVar</code> using Python's built-in <code class="Code-In-Text--PACKT-">isinstance()</code> function. If it is, we simply set it to <code class="Code-In-Text--PACKT-">False</code>.</p>
    <p class="normal">For the <code class="Code-In-Text--PACKT-">Notes</code> input, we can use the <code class="Code-In-Text--PACKT-">Text</code> widget's <code class="Code-In-Text--PACKT-">delete()</code> method to clear its contents. This method takes a start and end location, just like the <code class="Code-In-Text--PACKT-">get()</code> method does. The values <code class="Code-In-Text--PACKT-">1.0</code> and <code class="Code-In-Text--PACKT-">tk.END</code> indicate<a id="_idIndexMarker201"/> the entire contents of the widget. Recall from our earlier discussion<a id="_idIndexMarker202"/> of the <code class="Code-In-Text--PACKT-">Text</code> widget that this index is the <em class="italic">string</em> <code class="Code-In-Text--PACKT-">1.0</code>, <em class="italic">not</em> a float value.</p>
    <p class="normal">That's all we need in our reset callback. To bind it to the button, use the button's <code class="Code-In-Text--PACKT-">configure()</code> method:</p>
    <pre class="programlisting code"><code class="hljs-code">reset_button.configure(command=on_reset)
</code></pre>
    <div><p class="Tip--PACKT-">The <code class="Code-In-Text--PACKT-">configure()</code> method can be called on any Tkinter widget to change its properties. It accepts the same keyword arguments as the widget's constructor.</p>
    </div>
    <h3 id="_idParaDest-76" class="title">The Save callback</h3>
    <p class="normal">Our last bit of functionality, and the<a id="_idIndexMarker203"/> most important, is the <code class="Code-In-Text--PACKT-">Save</code> callback. Recall from our program<a id="_idIndexMarker204"/> specification that our application needs to append the entered data to a <strong class="keyword">CSV</strong> (<strong class="keyword">comma-separated values</strong>) file with<a id="_idIndexMarker205"/> the filename <code class="Code-In-Text--PACKT-">abq_data_record_CURRENTDATE.csv</code>, where <code class="Code-In-Text--PACKT-">CURRENTDATE</code> is the date in ISO format (year-month-day). The CSV should be created if it doesn't exist, and have the column headers written to the first row. Therefore, this function needs to do the following:</p>
    <ul>
      <li class="bullet">Determine the current date and generate the filename</li>
      <li class="bullet">Determine if the file exists, and if not create it and write a header row</li>
      <li class="bullet">Extract the data from the form and do any clean-up necessary</li>
      <li class="bullet">Append the row of data to the file</li>
      <li class="bullet">Increment <code class="Code-In-Text--PACKT-">records_saved</code> and alert the user that the record was saved</li>
      <li class="bullet">Reset the form for the next record</li>
    </ul>
    <p class="normal">Let's start the function out this way:</p>
    <pre class="programlisting code"><code class="hljs-code">def on_save():
  """Handle save button clicks"""
  global records_saved
</code></pre>
    <p class="normal">Once again, we're using the <code class="Code-In-Text--PACKT-">on_&lt;eventname&gt;</code> naming convention. The first thing we've done is declared <code class="Code-In-Text--PACKT-">records_saved</code> as a global variable. If we don't do this, Python will interpret the name <code class="Code-In-Text--PACKT-">records_saved</code> as a local variable and we won't be able to update it. </p>
    <p class="normal">Modifying global variables is generally bad form, but Tkinter doesn't really give us many options here: we can't use a return<a id="_idIndexMarker206"/> value to update the variable, because this is a callback function that is called<a id="_idIndexMarker207"/> in response to an event, not at any place in our code where we have direct access to <code class="Code-In-Text--PACKT-">records_saved</code>. In <em class="chapterRef">Chapter 4</em>, <em class="italic">Organizing Our Code with Classes</em>, we'll learn a better way to implement this functionality without global variables; for now, though, we're stuck with it.</p>
    <p class="normal">Next, let's figure out the details of the filename and whether it exists or not:</p>
    <pre class="programlisting code"><code class="hljs-code">  datestring = datetime.today().strftime("%Y-%m-%d")
  filename = f"abq_data_record_{datestring}.csv"
  newfile = not Path(filename).exists()
</code></pre>
    <p class="normal">The <code class="Code-In-Text--PACKT-">datetime.today()</code> function returns a <code class="Code-In-Text--PACKT-">Date</code> object for the current day, and its <code class="Code-In-Text--PACKT-">strftime()</code> method allows us to format that date into a string in any way we specify. The syntax for <code class="Code-In-Text--PACKT-">strftime()</code> has its roots in C programming, so it's rather cryptic in some cases; but hopefully it is clear that <code class="Code-In-Text--PACKT-">%Y</code> means year, <code class="Code-In-Text--PACKT-">%m</code> means month, and <code class="Code-In-Text--PACKT-">%d</code> means day. This will return the date in ISO format; for example, 2021-10-31 for October 31, 2021.</p>
    <p class="normal">With the <code class="Code-In-Text--PACKT-">datestring</code> in hand, we can use it to build the filename for the day's CSV file. In the next line, <code class="Code-In-Text--PACKT-">Path(filename).exists()</code> tells us whether the file exists in the current working directory. It does this by constructing a <code class="Code-In-Text--PACKT-">Path</code> object using the filename, then calling its <code class="Code-In-Text--PACKT-">exists()</code> method to see if the file is already on the filesystem. We'll save this information to a variable called <code class="Code-In-Text--PACKT-">newfile</code>.</p>
    <p class="normal">Now it's time to get the data from the form:</p>
    <pre class="programlisting code"><code class="hljs-code">  data = dict()
  fault = variables['Equipment Fault'].get()
  for key, variable in variables.items():
    if fault and key in ('Light', 'Humidity', 'Temperature'):
      data[key] = ''
    else:
      try:
        data[key] = variable.get()
      except tk.TclError:
        status_variable.set(
          f'Error in field: {key}.  Data was not saved!'
        )
        return
  # get the Text widget contents separately
  data['Notes'] = notes_inp.get('1.0', tk.END)
</code></pre>
    <p class="normal">We're going to store the data in a new dictionary object called <code class="Code-In-Text--PACKT-">data</code>. To do this, we'll iterate through our <code class="Code-In-Text--PACKT-">variables</code> dictionary, calling <code class="Code-In-Text--PACKT-">get()</code> on each variable. Of course, if there is an equipment fault, we want to skip the values for <code class="Code-In-Text--PACKT-">Light</code>, <code class="Code-In-Text--PACKT-">Humidity</code>, and <code class="Code-In-Text--PACKT-">Temperature</code>, so we're first getting the value of <code class="Code-In-Text--PACKT-">Equipment Fault</code> and checking it before those field values are being<a id="_idIndexMarker208"/> retrieved. If we do need to retrieve a value from<a id="_idIndexMarker209"/> the variable, we'll do this in a <code class="Code-In-Text--PACKT-">try</code> block. Remember that variables will raise a <code class="Code-In-Text--PACKT-">TclError</code> if the <code class="Code-In-Text--PACKT-">get()</code> method is called when there is an invalid value in them, so we need to handle that exception. In this case, we'll let the user know that there was a problem with that particular field and exit the function immediately.</p>
    <p class="normal">Finally, we need to get the data from the <code class="Code-In-Text--PACKT-">Notes</code> field using <code class="Code-In-Text--PACKT-">get()</code>.</p>
    <p class="normal">Now that we have the data, we need to write it to a CSV. Add the following code next:</p>
    <pre class="programlisting code"><code class="hljs-code">  with open(filename, 'a', newline='') as fh:
    csvwriter = csv.DictWriter(fh, fieldnames=data.keys())
    if newfile:
      csvwriter.writeheader()
    csvwriter.writerow(data)
</code></pre>
    <p class="normal">First, we're opening the file using a context manager (the <code class="Code-In-Text--PACKT-">with</code> keyword). Doing it this way ensures that the file will be closed when we exit the indented block. We're opening in <em class="italic">append</em> mode (indicated by the <code class="Code-In-Text--PACKT-">a</code> argument to <code class="Code-In-Text--PACKT-">open</code>), which means any data we write will simply be added to the end of whatever is already there. Note the <code class="Code-In-Text--PACKT-">newline</code> argument, which we've set to an empty string. This is to work around a bug in the CSV module on Windows that causes an extra empty line to appear between each record. It does no harm on other platforms.</p>
    <p class="normal">Inside the block, we need to create something called a <strong class="keyword">CSV Writer object</strong>. The standard library <code class="Code-In-Text--PACKT-">csv</code> module contains<a id="_idIndexMarker210"/> a few different types of objects that can write data into a CSV file. The <code class="Code-In-Text--PACKT-">DictWriter</code> class is handy in that it can take a dictionary of values in any order and write them to the proper fields of the CSV, provided the first row contains the names of the columns. We can tell the <code class="Code-In-Text--PACKT-">DictWriter</code> what those header values should be by passing it <code class="Code-In-Text--PACKT-">data.keys()</code>, which is all the names of our data values.</p>
    <p class="normal">Append mode will create the file if it does not exist, but it won't write the header row automatically. Therefore, we need to check if the file is a new file (using the <code class="Code-In-Text--PACKT-">newfile</code> value we found earlier), and if it is, we'll write the header row. The <code class="Code-In-Text--PACKT-">DictWriter</code> object has a method for this, which causes it to just write a single row containing all the field names.</p>
    <p class="normal">Finally, we can use the <code class="Code-In-Text--PACKT-">DictWriter</code> object's <code class="Code-In-Text--PACKT-">writerow()</code> method to pass in our dictionary of data to be written to the file. As we exit the indented block, Python closes the file and saves it to disk.</p>
    <p class="normal">That leaves us with just a few final lines in the <code class="Code-In-Text--PACKT-">on_save()</code> function:</p>
    <pre class="programlisting code"><code class="hljs-code">  records_saved += 1
  status_variable.set(
    f"{records_saved} records saved this session"
  )
  on_reset()
</code></pre>
    <p class="normal">First, we'll increment the <code class="Code-In-Text--PACKT-">records_saved</code> variable, then alert the user in the status bar how many records<a id="_idIndexMarker211"/> have been saved so far. This is good feedback that helps<a id="_idIndexMarker212"/> the user know their actions were successful. Finally, we call <code class="Code-In-Text--PACKT-">on_reset()</code> to prepare the form for the next record to be entered.</p>
    <p class="normal">With the save method implemented, let's go ahead and bind it to our button:</p>
    <pre class="programlisting code"><code class="hljs-code">save_button.configure(command=on_save)
</code></pre>
    <p class="normal">Last of all, let's reset the form and launch the main event loop:</p>
    <pre class="programlisting code"><code class="hljs-code">on_reset()
root.mainloop()
</code></pre>
    <p class="normal">That's it, your first application for ABQ is finished and ready to go!</p>
    <h2 id="_idParaDest-77" class="title">Finishing up and testing</h2>
    <p class="normal">Before we send our application<a id="_idIndexMarker213"/> out into the world, let's fire it up and give it a test:</p>
    <figure class="mediaobject"><img src="img/B17578_03_11.png" alt=""/></figure>
    <p class="packt_figref">Figure 3.11: Our first ABQ Data Entry application</p>
    <p class="normal">Looking good! And it works, too. Go ahead and enter some test data and save it. Of course, this isn't the end  we haven't quite addressed everything on the program specification, and once users get<a id="_idIndexMarker214"/> their hands on the application, the feature requests will undoubtedly begin. But for now, we can celebrate the victory of a working MVP.</p>
    <h1 id="_idParaDest-78" class="title">Summary</h1>
    <p class="normal">Well, we've come a long way in this chapter! You took your design from a specification and some drawings to a running MVP of the application that already covers the basic functionality you need. You learned about basic Ttk widgets, such as <code class="Code-In-Text--PACKT-">Entry</code>, <code class="Code-In-Text--PACKT-">Spinbox</code>, <code class="Code-In-Text--PACKT-">Combobox</code>, <code class="Code-In-Text--PACKT-">Radiobutton</code>, and <code class="Code-In-Text--PACKT-">Checkbutton</code>, as well as the Tkinter <code class="Code-In-Text--PACKT-">Text</code> widget. You learned how to assemble these widgets into a complex but organized GUI using nested <code class="Code-In-Text--PACKT-">LabelFrame</code> widgets, and how to save a file using a callback method.</p>
    <p class="normal">In the next chapter, we're going to utilize classes and object-oriented programming techniques to clean up our code and expand the capabilities of our widgets.</p>
  </div>
</body></html>