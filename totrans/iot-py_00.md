# 前言

物联网（IoT）正在改变我们的生活方式，代表着 IT 行业最大的挑战之一。开发者正在创建低成本设备，收集大量数据，相互交互，并利用云服务和基于云的存储。全世界的制造商都在进行令人着迷的项目，将日常物体转变为带有传感器和执行器的智能设备。

咖啡杯不再是简单的物体了——它可以向你的智能手表发送消息，表明里面的液体已经达到合适的温度，这样你就可以放心地喝，无需担心是否太热。在你收到消息之前移动咖啡杯，你的可穿戴设备会振动以表明你还不必喝它。

你可以在智能手机上检查咖啡机的咖啡水平，无需担心订购更多的咖啡：当咖啡水平不足以覆盖剩余的一天时，咖啡机会自动在线订购咖啡。你只需在智能手表上批准咖啡机建议的在线订单。基于某些统计算法，咖啡机将知道订购的最佳时间。

当更常见的访客到达办公室时会发生什么？他们的智能手表或智能手机将与咖啡机通信，并在脱咖啡因咖啡的消耗量增加过多的情况下下订单。我们有智能咖啡杯、智能咖啡机、智能手表、智能手机和可穿戴设备。所有这些设备都利用云服务创建一个智能生态系统，能够为我们提供我们一天中所需的所有不同类型的咖啡。

英特尔 Galileo Gen 2 板是一个功能强大且多功能的迷你计算机板，适用于物联网项目。我们可以启动 Linux 版本，并轻松执行与板上不同组件交互的 Python 脚本。本书将指导你如何使用 Python 2.7.3、其库和工具，从选择硬件到所有必要的堆栈开发物联网原型。如果你需要一个更小的板或替代品，书中包含的所有示例都与英特尔 Edison 板兼容，因此，在你需要的情况下，你可以切换到这块板。

Python 是最受欢迎的编程语言之一。它是开源的、多平台的，你可以用它开发任何类型的应用程序，从网站到极其复杂的科学计算应用程序。总有一个 Python 包可以让我们更容易地完成任务，避免重复造轮子并更快地解决问题。Python 是开发完整物联网堆栈的理想选择。本书涵盖了将日常物体转变为物联网项目所需了解的所有内容。

本书将使您能够使用 Python 作为编程语言从头开始原型设计和开发物联网（IoT）解决方案。您将利用您现有的 Python 知识从现实世界捕获数据，与物理对象交互，开发 API，并使用不同的物联网协议。您将使用特定的库轻松地与底层硬件、传感器、执行器、总线和显示器一起工作。您将学习如何利用 Intel Galileo Gen 2 板上的所有 Python 包。您将准备好成为一名创造者，并成为激动人心的物联网世界的一部分。

# 本书涵盖内容

第一章，*理解和设置基础物联网硬件*，将我们引入使用 Python 和 Intel Galileo Gen 2 板迈向物联网（IoT）的旅程。我们将了解该板提供的不同功能，并可视化其不同组件。我们将理解不同引脚、LED 和连接器的含义。我们将学习如何检查板的固件版本，并在必要时进行更新。

第二章，*在 Intel Galileo Gen 2 上使用 Python*，引导我们通过许多程序，使我们能够使用 Python 作为主要编程语言，使用我们的 Intel Galileo Gen 2 板创建物联网项目。我们将编写 Linux Yocto 镜像到 microSD 卡，配置板使其启动此镜像，更新许多库以使用它们的最新版本，并启动 Python 解释器。

第三章，*使用 Python 与数字输出交互*，教我们如何使用两个不同的库在 Python 中控制数字输出：mraa 和 wiring-x86。我们将把 LED 和电阻连接到面包板上，并编写代码来点亮 0 到 9 个 LED。然后，我们将改进我们的 Python 代码以利用 Python 的面向对象特性，并准备代码以便构建一个 API，该 API 将允许我们通过 REST API 打印 LED 上的数字。

第四章，*使用 RESTful API 和脉冲宽度调制*，让我们使用 Tornado Web 服务器、Python、HTTPie 命令行 HTTP 客户端以及 mraa 和 wiring-x86 库。我们将生成许多版本的 RESTful API，这将允许我们在连接到局域网的计算机和设备上与板进行交互。我们将能够编写和发送 HTTP 请求，在 LED 上打印数字，改变三个 LED 的亮度级别，以及使用 RGB LED 生成数百万种颜色。

第五章，*使用数字输入、轮询和中断*，解释了使用轮询读取按钮状态与使用中断和中断处理程序之间的区别。我们将编写代码，使用户可以通过面包板上的按钮或 HTTP 请求执行相同的操作。我们将结合代码，该代码对按钮状态的改变做出反应，与使用 Tornado Web Server 构建的 RESTful API 一起工作。我们将创建类来封装按钮以及与 mraa 和 wiring-x86 库相关的必要配置。

第六章，*使用模拟输入和本地存储*，解释了如何使用模拟输入来测量电压值。我们将使用模拟引脚和 mraa 以及 wiring-x86 库来测量电压。我们将能够将可变电阻转换为电压源，并使其能够通过模拟输入、光敏电阻和分压器来测量黑暗程度。当环境光线变化时，我们将触发动作，并且我们将处理模拟输入和输出。我们将利用 Python 标准库中的日志功能以及 Intel Galileo Gen 2 板中包含的 USB 2.0 连接器来注册事件。

第七章，*使用传感器从现实世界获取数据*，让我们使用各种传感器从现实世界获取数据。我们将利用 upm 库中包含的模块和类，这将使我们能够轻松地开始使用模拟和数字传感器。我们将了解考虑测量单位的重要性，因为传感器总是以特定的单位提供测量值，我们必须考虑这一点。我们将测量适当的加速度或 g 力的幅度和方向、环境温度和湿度。

第八章，*显示信息和执行操作*，教我们如何通过 I²C 总线将不同的显示连接到我们的板上。我们将使用带有 RGB 背光的 LCD 显示器，然后将其替换为 OLED 点阵显示器。我们将编写代码，利用 upm 库中包含的模块和类来处理 LCD 和 OLED 显示器，并在其上显示文本。我们还将编写与模拟伺服机构交互的代码。我们将控制轴以允许我们创建一个仪表图表来显示通过传感器获取的温度值。我们的 Python 代码将使物体移动。

第九章, *与云服务合作*，教您如何结合许多基于云的服务，这将使我们能够轻松发布从传感器收集的数据，并在基于网络的仪表板上可视化它。我们将使用 MQTT 协议及其发布/订阅模型来处理板上的命令，并通过消息指示命令是否成功处理。首先，我们将与使用 MQTT 协议的 PubNub 云服务合作。然后，我们将使用 Mosquitto 和 Eclipse Paho 开发相同的示例。我们将能够编写能够与我们的 IoT 设备建立双向通信的应用程序。

第十章, *使用基于云的 IoT 分析分析大量数据*，解释了物联网与大数据之间的紧密关系。我们将使用英特尔 IoT 分析，这是一种基于云的服务，允许我们组织由多个 IoT 设备及其传感器收集的大量数据。我们将使用 `requests` 包编写几行 Python 代码来与英特尔 IoT 分析 REST API 进行交互。我们将了解英特尔 IoT 分析为我们提供分析大量数据的不同选项，并将定义触发警报的规则。

# 您需要为本书准备的东西

为了使用连接到英特尔 Galileo Gen 2 板和启动 Python 示例所需的不同工具，您需要任何具有英特尔 Core i3 或更高 CPU 和至少 4 GB RAM 的计算机。您可以使用以下任何操作系统：

+   Windows 7 或更高版本（Windows 8、Windows 8.1 或 Windows 10）

+   Mac OS X Mountain Lion 或更高版本

+   任何能够运行 Python 2.7.x 的 Linux 版本

+   任何支持 JavaScript 的现代浏览器。

您还需要一块英特尔 Galileo Gen 2 板和一块带有 830 个连接点（用于连接的孔）和 2 条电源线的面包板。

此外，您还需要不同的电子元件和分线板来构建许多章节中包含的示例。

# 本书面向的对象

本书非常适合想要探索 Python 生态系统中的工具以构建自己的 IoT 网络栈和 IoT 相关项目的 Python 程序员。来自创意和设计背景的人也会发现本书同样有用。

# 习惯用法

在本书中，您将找到许多文本样式，用于区分不同类型的信息。以下是一些这些样式的示例及其含义的解释。

文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和推特用户名如下所示：“默认情况下，`pip` 软件包管理系统，它使得安装和管理用 Python 编写的软件包变得容易，并未安装。”

代码块设置如下：

```py
if __name__ == "__main__":
    print ("Mraa library version: {0}".format(mraa.getVersion()))
    print ("Mraa detected platform name: {0}".format(mraa.getPlatformName()))

    number_in_leds = NumberInLeds()
    # Count from 0 to 9
    for i in range(0, 10):
        number_in_leds.print_number(i)
        time.sleep(3)
```

当我们希望将你的注意力引到代码块的一个特定部分时，相关的行或项目将以粗体显示：

```py
class NumberInLeds:
    def __init__(self):
        self.leds = []
 for i in range(9, 0, -1):
 led = Led(i, 10 - i)
            self.leds.append(led)

    def print_number(self, number):
        print("==== Turning on {0} LEDs ====".format(number))
        for j in range(0, number):
            self.leds[j].turn_on()
        for k in range(number, 9):
            self.leds[k].turn_off()
```

**新术语**和**重要词汇**以粗体显示。屏幕上看到的单词，例如在菜单或对话框中，在文本中显示如下：“下次你需要在板上上传文件时，你不需要在**站点管理器**对话框中设置一个新的站点，以便建立 SFTP 连接。”

### 注意

警告或重要提示会出现在这样的框中。

### 小贴士

小贴士和技巧看起来像这样。

# 读者反馈

我们始终欢迎读者的反馈。请告诉我们你对这本书的看法——你喜欢什么或不喜欢什么。读者的反馈对我们来说很重要，因为它帮助我们开发出你真正能从中获得最大收益的图书。

要发送给我们一般性的反馈，只需发送电子邮件至 `<feedback@packtpub.com>`，并在邮件的主题中提及书名。

如果你在一个领域有专业知识，并且你对撰写或为图书做出贡献感兴趣，请参阅我们的作者指南，网址为[www.packtpub.com/authors](http://www.packtpub.com/authors)。

# 客户支持

现在你已经是 Packt 图书的骄傲拥有者，我们有许多事情可以帮助你从购买中获得最大收益。

## 下载示例代码

你可以从你的账户中下载这本书的示例代码文件。[`www.packtpub.com`](http://www.packtpub.com)。如果你在其他地方购买了这本书，你可以访问[`www.packtpub.com/support`](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给你。

你可以通过以下步骤下载代码文件：

1.  使用你的电子邮件地址和密码登录或注册我们的网站。

1.  将鼠标指针悬停在顶部的**支持**标签上。

1.  点击**代码下载与勘误**。

1.  在**搜索**框中输入书名。

1.  选择你想要下载代码文件的图书。

1.  从下拉菜单中选择你购买这本书的地方。

1.  点击**代码下载**。

你也可以通过点击 Packt Publishing 网站上图书网页上的**代码文件**按钮来下载代码文件。你可以通过在**搜索**框中输入书名来访问此页面。请注意，你需要登录到你的 Packt 账户。

下载文件后，请确保使用最新版本的软件解压缩或提取文件夹：

+   WinRAR / 7-Zip for Windows

+   Zipeg / iZip / UnRarX for Mac

+   7-Zip / PeaZip for Linux

该书的代码包也托管在 GitHub 上，网址为[`github.com/PacktPublishing/Internet-of-Things-with-Python`](https://github.com/PacktPublishing/Internet-of-Things-with-Python)。我们还有其他来自我们丰富图书和视频目录的代码包可供下载，网址为[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)。请查看它们！

## 下载本书的颜色图像

我们还为您提供了一个包含本书中使用的截图/图表彩色图像的 PDF 文件。彩色图像将帮助您更好地理解输出的变化。您可以从[`www.packtpub.com/sites/default/files/downloads/InternetofThingswithPython_ColorImages.pdf`](https://www.packtpub.com/sites/default/files/downloads/InternetofThingswithPython_ColorImages.pdf)下载此文件。

## 勘误

尽管我们已经尽最大努力确保内容的准确性，错误仍然可能发生。如果您在我们的某本书中发现错误——可能是文本或代码中的错误——如果您能向我们报告这一点，我们将不胜感激。通过这样做，您可以避免其他读者感到沮丧，并帮助我们改进本书的后续版本。如果您发现任何勘误，请通过访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择您的书籍，点击**勘误提交表单**链接，并输入您的勘误详情来报告它们。一旦您的勘误得到验证，您的提交将被接受，勘误将被上传到我们的网站或添加到该标题的勘误部分下的现有勘误列表中。

要查看之前提交的勘误，请访问[`www.packtpub.com/books/content/support`](https://www.packtpub.com/books/content/support)，并在搜索字段中输入书籍名称。所需信息将出现在**勘误**部分下。

## 盗版

互联网上版权材料的盗版是一个持续存在的问题，涉及所有媒体。在 Packt，我们非常重视保护我们的版权和许可证。如果您在互联网上发现任何形式的我们作品的非法副本，请立即提供位置地址或网站名称，以便我们可以寻求补救措施。

请通过`<copyright@packtpub.com>`与我们联系，并附上疑似盗版材料的链接。

我们感谢您的帮助，以保护我们的作者和我们为您提供有价值内容的能力。

## 问题

如果您对本书的任何方面有问题，您可以通过`<questions@packtpub.com>`联系我们，我们将尽力解决问题。
