<html><head></head><body><div class="chapter" title="Chapter&#xA0;6.&#xA0;Home Automation Using BeagleBone"><div class="titlepage"><div><div><h1 class="title"><a id="ch06"/>Chapter 6. Home Automation Using BeagleBone</h1></div></div></div><p>In this chapter, we will be learning how to build a home automation system using BeagleBone Black. To get started, first we will be learning about Internet connected home automation systems and how they work. Then, we will move on to setting up Python Flask library that lets you run the HTTP server on your BeagleBone Black using Python.</p><p>Once we<a id="id278" class="indexterm"/> are up and running with the server using a Flask library on Python, we will use it to go ahead and create a program in which you can turn a GPIO on and turn off using the input from the webpage created by the server. This GPIO pin will be used to turn on and turn off an electrical relay to switch a lamp on and off.</p><p>The contents of the chapter are divided into the following:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Prerequisites</li><li class="listitem" style="list-style-type: disc">The structure of home automation systems</li><li class="listitem" style="list-style-type: disc">An introduction to webservers</li><li class="listitem" style="list-style-type: disc">An introduction to Flask for Python</li><li class="listitem" style="list-style-type: disc">Setting up Flask for Python on a BeagleBone board</li><li class="listitem" style="list-style-type: disc">Creating a webserver using Flask</li><li class="listitem" style="list-style-type: disc">Transistors, relays, and power switches</li><li class="listitem" style="list-style-type: disc">Advanced project: An Internet-controlled power switch – controlling an AC bulb from the Internet</li></ul></div><div class="section" title="Prerequisites"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec42"/>Prerequisites</h1></div></div></div><p>This<a id="id279" class="indexterm"/> topic will cover what parts you need in this Chapter. You can buy them from any electrical store or online.</p><div class="section" title="Materials needed"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec12"/>Materials needed </h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">1x BeagleBone Black </li><li class="listitem" style="list-style-type: disc">1x microSD card<a id="id280" class="indexterm"/> with latest version of Debian flashed on it to boot the BeagleBone board from a microSD card</li><li class="listitem" style="list-style-type: disc">1x 5V DC, 2A power supply</li><li class="listitem" style="list-style-type: disc">1x Ethernet cable</li><li class="listitem" style="list-style-type: disc">1x BreadBoard</li><li class="listitem" style="list-style-type: disc">1x relay board</li></ul></div></div></div></div>
<div class="section" title="The structure of home automation systems"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec43"/>The structure of home automation systems</h1></div></div></div><p>This<a id="id281" class="indexterm"/> section will give you a basic idea about home automation systems that are connected to the Internet. In the following picture you can see that the mobile phone and the IoT devices are connected to Internet via the LAN Routers:</p><div class="mediaobject"><img src="graphics/4602_06_01.jpg" alt="The structure of home automation systems"/></div><p>We will also be doing something similar in this chapter using the BeagleBone board, connected to<a id="id282" class="indexterm"/> Internet via our home router, to control an AC bulb using the relay circuit which is interfaced with the BeagleBone board. To do this, we will have setup a webserver on our BeagleBone board. We will see how to do this in the next topic of this chapter.</p></div>
<div class="section" title="Introduction to web servers"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec44"/>Introduction to web servers</h1></div></div></div><p>Web servers<a id="id283" class="indexterm"/> are computers that are connected to the Internet, or intranet, to serve the requests that comes from the web browser of client computers or mobile devices. To understand this better, look at the following picture:</p><div class="mediaobject"><img src="graphics/4602_06_02.jpg" alt="Introduction to web servers"/></div><p>So, as shown in the preceding picture, a webserver is basically the computer which hosts the webpages and does the processing based on the requests sent from the web browser on the client's device. The client's device can be either a PC, laptop, mobile phone, tablet, or anything else which has a web browser, or a Linux shell that can make HTTP requests.</p><p>Go ahead and look at the following picture to understand this better:</p><div class="mediaobject"><img src="graphics/4602_06_03.jpg" alt="Introduction to web servers"/></div><p>Now in <a id="id284" class="indexterm"/>this you can see that multiple clients are connected to multiple servers via the Internet, that is the <a id="id285" class="indexterm"/>
<span class="strong"><strong>World Wide Web</strong></span> (<span class="strong"><strong>WWW</strong></span>), <span class="strong"><strong>TCP/IP Network</strong></span>.</p><p>What is <a id="id286" class="indexterm"/>TCP/IP? What exactly happens when you type a URL into your browser and hit enter? </p><p>Look at the following picture to understand more:</p><div class="mediaobject"><img src="graphics/4602_06_04.jpg" alt="Introduction to web servers"/></div><p>Similarly, in <a id="id287" class="indexterm"/>our system we have a webserver that goes through all the process as show in the preceding picture. A slight difference is that our webpage will be able to control the AC bulb. Now, that we know how webservers work, let's get ahead and setup a webserver on our BeagleBone board using Flask Python.</p></div>
<div class="section" title="Python-Flask on BeagleBone Black"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec45"/>Python-Flask on BeagleBone Black</h1></div></div></div><p>Flask<a id="id288" class="indexterm"/> is a Python framework to set up web servers using<a id="id289" class="indexterm"/> Python. In this topic, we will look at how we can set up a web server on BeagleBone Black using Python. The first thing we need to do to get started is to install the Python-Flask package on your BeagleBone Black from the Python package index. The steps below will walk you through how you can set up Flask and test it, followed by writing a Python code to interface it with your relay circuit. We will see this in the next topic followed by the main project of controlling an AC bulb from the Internet in the last topic of this chapter:</p><p>Step 1: Installing PIP as <a id="id290" class="indexterm"/>follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">sudo apt-get install python-pip</code>:<p>You should see that it's been already installed, since we have the latest version of Debian installed, and its already available in version. Some of the other versions might not have this, and it will be installed if it's not available, or upgraded if a newer version is available than the one that is installed in the current operating system.</p><div class="mediaobject"><img src="graphics/4602_06_05.jpg" alt="Python-Flask on BeagleBone Black"/></div><p>PIP installs and manages <a id="id291" class="indexterm"/>software packages that are written in Python. Many software packages can be found in the <a id="id292" class="indexterm"/>
<span class="strong"><strong>Python Package Index</strong></span> (<span class="strong"><strong>PyPI</strong></span>).</p></li></ul></div><p>Step 2: Install <a id="id293" class="indexterm"/>Flask-Python library as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">sudo pip install flask</code><div class="mediaobject"><img src="graphics/4602_06_06.jpg" alt="Python-Flask on BeagleBone Black"/></div></li></ul></div><p>Create a basic web application to test whether the package was installed successfully as follows:</p><p>Step 1: Create a directory on your BeagleBone Black:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">mkdir HomeAutomation</code><div class="mediaobject"><img src="graphics/4602_06_07.jpg" alt="Python-Flask on BeagleBone Black"/></div></li></ul></div><p>Step 2: Change to the directory you created:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">cd HomeAutomation</code><div class="mediaobject"><img src="graphics/4602_06_08.jpg" alt="Python-Flask on BeagleBone Black"/></div></li></ul></div><p>Step 3: Create a <a id="id294" class="indexterm"/>Python file and write the code to setup a Hello World printing webpage server as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">nano WebApp.py</code><div class="mediaobject"><img src="graphics/4602_06_09.jpg" alt="Python-Flask on BeagleBone Black"/></div></li></ul></div><p>Now type down the code on the file you created as shown in the following and save it:</p><div class="mediaobject"><img src="graphics/4602_06_10.jpg" alt="Python-Flask on BeagleBone Black"/></div><p>Step 4: Run the <a id="id295" class="indexterm"/>Python program as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">sudo python WebApp.py</code><div class="mediaobject"><img src="graphics/4602_06_11.jpg" alt="Python-Flask on BeagleBone Black"/></div></li></ul></div><p>If you see<a id="id296" class="indexterm"/> the output as shown in the preceding picture, then you have done the previous steps correctly, and we have a server up and running on our BeagleBone board.</p><p>Now open the web server that we have running on the BeagleBone board by opening a webpage on the browser of a PC or mobile phone connected to the same LAN network to which the BeagleBone is connected. In order to do this type the following: <code class="literal">IPAddress_of_BeagleBone_Board:5000</code>, so, in my case, it would be <code class="literal">192.168.1.20:5000</code> on the URL address bar on the browser where <code class="literal">5000</code> is the default port number at which Python-Flask routes its connection. You can change this to different port numbers. Read more on the web to better understand different ports of web servers.</p><p>When <a id="id297" class="indexterm"/>you make the call to the server from the browser, you should see something like this:</p><div class="mediaobject"><img src="graphics/4602_06_12.jpg" alt="Python-Flask on BeagleBone Black"/></div><p>You will also be able to see the request call made by the browser to the server on BeagleBone as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_06_13.jpg" alt="Python-Flask on BeagleBone Black"/></div><p>Hit <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>C</em></span> to stop it:</p><div class="mediaobject"><img src="graphics/4602_06_14.jpg" alt="Python-Flask on BeagleBone Black"/></div><p>Now that<a id="id298" class="indexterm"/> was a very basic thing we did using Python-Flask by echoing a text line.</p><p>Let's go ahead and do something using HTML layouts to make the web page look better. To do this create a directory called <code class="literal">templates</code> inside the home automation directory:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">mkdir templates</code><div class="mediaobject"><img src="graphics/4602_06_15.jpg" alt="Python-Flask on BeagleBone Black"/></div></li></ul></div><p>Switch to the new templates directory you created in order to create and save the HTML file inside it:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">cd templates</code><div class="mediaobject"><img src="graphics/4602_06_16.jpg" alt="Python-Flask on BeagleBone Black"/></div></li></ul></div><p>So this directory will be the place where you will find the HTML and CSS files through which you can route the web server to respond to requests from the client devices browser.</p><p>Now let's go ahead and create an HTML page inside this directory as shown in the following screenshot:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">nano index.html</code><div class="mediaobject"><img src="graphics/4602_06_17.jpg" alt="Python-Flask on BeagleBone Black"/></div></li></ul></div><p>Once you<a id="id299" class="indexterm"/> are done with typing the content in the HTML file, as shown in the preceding picture, you can save the file by hitting <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>X</em></span> to save it. Once you have saved it, go ahead and switch back to the home automation directory:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">cd ..</code><div class="mediaobject"><img src="graphics/4602_06_18.jpg" alt="Python-Flask on BeagleBone Black"/></div></li></ul></div><p>Now we need to write a different program to route the web server to the HTML file that we created. Instead of writing something from scratch, let us modify the <code class="literal">WebApp.py</code> file that we created before and save it as <code class="literal">WebAppFromTemplate.py</code>, as most of the lines of code are same. See in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_06_19.jpg" alt="Python-Flask on BeagleBone Black"/></div><p>Once you <a id="id300" class="indexterm"/>have edited the file and saved it as <code class="literal">WebAppFromTemplate.py</code>, you can go ahead and run the code as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">sudo python WebAppFromTemplate.py</code></li></ul></div><p>Again, let's go ahead and open the URL from the browser and check the output. You should see something similar to the web page shown in the picture below:</p><div class="mediaobject"><img src="graphics/4602_06_20.jpg" alt="Python-Flask on BeagleBone Black"/></div><p>Now you can see that the text <span class="strong"><strong>Webpage from a template!</strong></span> is formatted using HTML, and you can see it as an HTML based web page.</p><p>Like last time, you will see the HTTP call from the browser for debugging the shell:</p><div class="mediaobject"><img src="graphics/4602_06_21.jpg" alt="Python-Flask on BeagleBone Black"/></div><p>For the <a id="id301" class="indexterm"/>project that we have in this chapter to control an AC bulb from Internet, we should have buttons on the web page instead of just the text that we displayed previously.</p><p>In order to have buttons on the HTML page we need to write HTML code for the webpage template and similarly we should write Python code to read the input when the buttons are clicked on the webpage. We can use these inputs to change the states of the GPIOs on the BeagleBone Black using Python code.</p><p>We will be looking into the details of how we can toggle the GPIO states from HTML button click inputs in the project section of this chapter. Before that, as the last part of this topic, let's create an HTML page with button inputs, read those inputs when they are made, and print a text that this particular button was clicked. We will have two buttons on the web<a id="id302" class="indexterm"/> page and these will be <span class="strong"><strong>ON</strong></span> and <span class="strong"><strong>OFF</strong></span>. Whenever any of these are clicked on the web page, the Python code will print that the particular button was clicked. Let's go ahead and do that.</p><p>First, switch back to the templates folder and create a file named <code class="literal">main.html</code> file with the content as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_06_22.jpg" alt="Python-Flask on BeagleBone Black"/></div><p>Now you can see that it has two button elements with ID on and off.</p><p>Once you are done with creating this file, save it and go back to the home automation directory, edit the file <code class="literal">WebAppFromTemplate.py</code> as shown in following screenshot, and save it as <code class="literal">ControlWebApp.py</code>:</p><div class="mediaobject"><img src="graphics/4602_06_23.jpg" alt="Python-Flask on BeagleBone Black"/></div><p>Once you <a id="id303" class="indexterm"/>have saved it, you can go ahead and run the program as follows:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><code class="literal">sudo python ControlWebApp.py</code><div class="mediaobject"><img src="graphics/4602_06_24.jpg" alt="Python-Flask on BeagleBone Black"/></div></li></ul></div><p>Now you can open the webpage and see how it looks. You should see something similar to the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_06_25.jpg" alt="Python-Flask on BeagleBone Black"/></div><p>When you<a id="id304" class="indexterm"/> click on the <span class="strong"><strong>ON</strong></span> button, you should see something like the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_06_26.jpg" alt="Python-Flask on BeagleBone Black"/></div><p>The <a id="id305" class="indexterm"/>output is as follows:</p><div class="mediaobject"><img src="graphics/4602_06_27.jpg" alt="Python-Flask on BeagleBone Black"/></div><p>When you click on the <span class="strong"><strong>OFF</strong></span> button, you should see something like the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_06_28.jpg" alt="Python-Flask on BeagleBone Black"/></div><p>So <a id="id306" class="indexterm"/>now we have a program that can print which button was clicked. All we need is to write a program to change the state of the GPIO available on BeagleBone Black to HIGH and LOW whenever a button is pressed on the web page. We will be doing this in the project topic of this chapter. Before doing that, in the topic of this chapter, we will learn how a relay circuit works and how we can switch a relay circuit using the very little voltage that we get from the GPIO pins of the BeagleBone Black. In this way we will be able to use the relay to switch the AC Bulb on and off. </p></div>
<div class="section" title="Transistors, relays, power switches"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec46"/>Transistors, relays, power switches</h1></div></div></div><p>So basically, to <a id="id307" class="indexterm"/>switch an AC appliance or any circuit, you will <a id="id308" class="indexterm"/>need a switch, just like you have in your houses, where <a id="id309" class="indexterm"/>you have a switch to turn on a bulb or a fan. There is a basic circuit involved which looks very much like the following picture:</p><div class="mediaobject"><img src="graphics/4602_06_29.jpg" alt="Transistors, relays, power switches"/></div><p>So, as we <a id="id310" class="indexterm"/>can see in the preceding picture, if you toggle the switch it's going to open and close the circuit. This in turn will make the bulb <a id="id311" class="indexterm"/>go off and on. But<a id="id312" class="indexterm"/> this is done mechanically in normal mechanical switches.</p><p>Whenever we want the same action to be performed, we will be using the electrically controlled switches, which are on an electrical relay. The image below shows an electrically controlled relay in off and on states:</p><div class="mediaobject"><img src="graphics/4602_06_30.jpg" alt="Transistors, relays, power switches"/></div><p>In the <a id="id313" class="indexterm"/>preceding diagram you can see that whenever the power is supplied to the coil from the <span class="strong"><strong>3V</strong></span> power supply, the coil energizes and acts like a <a id="id314" class="indexterm"/>magnet pulling the terminal down. This connects the other terminal and closes the circuit and current flows through the circuit from the <span class="strong"><strong>6V</strong></span> battery to the DC lamp. You can see this in action in Figure 2 in <a id="id315" class="indexterm"/>the preceding image. And when the coil is de-energized, as shown in Figure 1, the terminal is left open, which cuts off the circuit and opens it up so the lamp is in the off state, as no current flows through the circuit. Again, in the preceding example, you can see that a mechanical switch is used to switch the low voltage supply (3V) and the electrical relay is switching the high voltage supply.</p><p>Usually the easily available relays are off 5V DC operated where the voltage needed to energize the coil is 5V and enough current supply. But the GPIOs available on BeagleBone board are 3.3V at HIGH and 0V at LOW states respectively. We will be using a new electronic element in between to switch the low voltage supply, and this element is the transistor. I won't be going into details of types of transistor and their operation. You can browse around to learn more about it in detail. But in basic terms, it's an electronically controlled switch whenever base of the transistor is given supply i.e. on conduction happens via collector emitter and when base of transistor is low i.e. off, no conduction takes place. </p><p>Look at <a id="id316" class="indexterm"/>the following diagram to understand how our circuit is going to be with a transistor interfaced with the relay when the relay is used to make a connection for the AC Bulb:</p><div class="mediaobject"><img src="graphics/4602_06_31.jpg" alt="Transistors, relays, power switches"/></div><p>So <a id="id317" class="indexterm"/>whenever the base driver is ON, that is to say HIGH, it will switch on the relay and whenever the base of the transistor is OFF, or LOW it will <a id="id318" class="indexterm"/>switch off the relay and, in turn, switch off the AC bulb.</p><p>You can directory connect the base of the transistor to the GPIO of the BeagleBone board which will turn the transistor on and off whenever the GPIO pin is HIGH and LOW respectively.</p><p>Relays board are available that are ready-made with transistors and relays. You can directly interface these with BeagleBone boards or with any other microcontroller boards as you can see in the following picture:</p><div class="mediaobject"><img src="graphics/4602_06_32.jpg" alt="Transistors, relays, power switches"/></div><p>Getting <a id="id319" class="indexterm"/>one of these will make your work simple, but if <a id="id320" class="indexterm"/>you want to make one by yourself you can also do that researching it on the Internet. To make it easier for the next steps, I got one of the ready-made modules and interfaced it to the GPIO of the BeagleBone Black. The <a id="id321" class="indexterm"/>connections are pretty straightforward, as shown in the previous figures. D1 of the relay module is connected to GPIO_60 i.e. P9_12 and Vcc to 5V on BeagleBone Black, and the Gnd pin of the relay module is connected to the Gnd Pin of the relay module. Connect the phase and neutral wire from the AC bulb via the K1 NO and C terminals of the relay, as the D1 input corresponds to switching the K1 relay in the module. </p><div class="mediaobject"><img src="graphics/4602_06_47.jpg" alt="Transistors, relays, power switches"/></div><p>You <a id="id322" class="indexterm"/>can see the schematic given above for more <a id="id323" class="indexterm"/>clear <a id="id324" class="indexterm"/>details about the circuit connections.</p><div class="mediaobject"><img src="graphics/4602_06_33.jpg" alt="Transistors, relays, power switches"/></div><p>Once you are done with the circuit connections, use the blink code that we used in the second<a id="id325" class="indexterm"/> chapter <a id="id326" class="indexterm"/>to test whether the relay is switching on and off, or else go ahead to the next topic to write <a id="id327" class="indexterm"/>down the code to control the circuit from the web page.</p></div>
<div class="section" title="Advanced project: An Internet controlled power switch &#x2013; controlling an AC bulb from the Internet"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec47"/>Advanced project: An Internet controlled power switch – controlling an AC bulb from the Internet</h1></div></div></div><p>Now we have set <a id="id328" class="indexterm"/>up the circuit from the previous topic, we <a id="id329" class="indexterm"/>will code it on Python to switch the GPIO to HIGH and LOW from the web page. You can proceed and write the code as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_06_34.jpg" alt="Advanced project: An Internet controlled power switch – controlling an AC bulb from the Internet"/></div><p>Now save the file as <code class="literal">GPIOControlWebApp.py</code>.</p><p>Let's run<a id="id330" class="indexterm"/> the code to switch the lamp on and off, and go ahead and open the page from the Android tablet. The tablet is connected to the same LAN Wi-Fi router as the BeagleBone board. Click the on and off buttons and you will see the output in the shell terminal as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_06_35.jpg" alt="Advanced project: An Internet controlled power switch – controlling an AC bulb from the Internet"/></div><p>And the bulb will turn on and off as shown in the following pictures:</p><div class="mediaobject"><img src="graphics/4602_06_36.jpg" alt="Advanced project: An Internet controlled power switch – controlling an AC bulb from the Internet"/><div class="caption"><p>Bulb is in the off state</p></div></div><div class="mediaobject"><img src="graphics/4602_06_37.jpg" alt="Advanced project: An Internet controlled power switch – controlling an AC bulb from the Internet"/><div class="caption"><p>Bulb is in the on state</p></div></div><p>But right now, we are just doing this on our local network within our home router LAN network to which the BeagleBone board is connected. What if we wanted to control the bulb via a 3G connection available on our phone? In this case you need to route your BeagleBone <a id="id331" class="indexterm"/>Black and connect to it via the Internet from your phone, which is connected to the Internet via 3G. If you go back to web servers topic in this chapter you can see that there are lots of routers, DNS gateways in between to connect to a server from one end of the Internet from a client to the server. In our case, our BeagleBone board device itself is acting as a server. We will be just be port forwarding our router to redirect the requests that comes to the router's public IP address to the particular port at which BeagleBone Black is hosting its server, that is 5000, in our case, the default port at which Python-Flask routes its requests. So, let's go ahead and do the port forwarding to access the web server on the BeagleBone board via the public IP assigned to our router by the Internet service provider.</p><div class="section" title="Setting up port forwarding"><div class="titlepage"><div><div><h2 class="title"><a id="ch06lvl2sec13"/>Setting up port forwarding</h2></div></div></div><p>Follow<a id="id332" class="indexterm"/> the steps to set up port forwarding:</p><div class="orderedlist"><ol class="orderedlist arabic"><li class="listitem">As we did in <a class="link" href="ch01.html" title="Chapter 1. Getting Started with BeagleBone">Chapter 1</a><span class="emphasis"><em>, Getting Started with BeagleBone</em></span>, login into your router's configuration page:<div class="mediaobject"><img src="graphics/4602_06_38.jpg" alt="Setting up port forwarding"/></div></li><li class="listitem">Go to <span class="strong"><strong>ADVANCED</strong></span> settings:<div class="mediaobject"><img src="graphics/4602_06_39.jpg" alt="Setting up port forwarding"/></div></li><li class="listitem">Go <a id="id333" class="indexterm"/>to <span class="strong"><strong>Advanced Setup</strong></span>:<div class="mediaobject"><img src="graphics/4602_06_40.jpg" alt="Setting up port forwarding"/></div></li><li class="listitem">Click <a id="id334" class="indexterm"/>on <span class="strong"><strong>Port Forwarding</strong></span>:<div class="mediaobject"><img src="graphics/4602_06_41.jpg" alt="Setting up port forwarding"/></div></li><li class="listitem">Click <a id="id335" class="indexterm"/>on <span class="strong"><strong>Add Custom Service</strong></span>.You will see the page as shown in the following screenshot:<div class="mediaobject"><img src="graphics/4602_06_42.jpg" alt="Setting up port forwarding"/></div></li></ol></div><p>Fill in the <a id="id336" class="indexterm"/>details and save the configuration by clicking on <span class="strong"><strong>Apply</strong></span>:</p><div class="mediaobject"><img src="graphics/4602_06_43.jpg" alt="Setting up port forwarding"/></div><div class="mediaobject"><img src="graphics/4602_06_44.jpg" alt="Setting up port forwarding"/></div><p>Once you are done<a id="id337" class="indexterm"/> with this. Go to Google and type in <code class="literal">what is my ip?</code> This will check your public IP Address, and you should get the output as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_06_45.jpg" alt="Setting up port forwarding"/></div><p>Once you<a id="id338" class="indexterm"/> have this, pull out your phone and connect to 3G, using this public IP address followed by port number <code class="literal">5000</code> to access your BeagleBone board. This will allow you to switch the AC bulb on and off from your phone. You will get a web page as shown in the following screenshot:</p><div class="mediaobject"><img src="graphics/4602_06_46.jpg" alt="Setting up port forwarding"/></div><p>Now you can give the web link <code class="literal">183.82.111.33:5000</code> to any person who is connected to the Internet to access you BeagleBone board and control the bulb from any place around the world. Thus, you have your home automation system connected to the Internet. You can also call it <a id="id339" class="indexterm"/>as you have built your Internet of Things project by end of this chapter. Try it out on your own to control two appliances, change the style of the HTML webpage and add colors and control graphics to the webpage to learn and have more fun.</p></div></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch06lvl1sec48"/>Summary</h1></div></div></div><p>In this chapter, we learnt how web servers work to setup our own home automation system where an AC bulb is controlled from any place around the world via the Internet. In the process of building it we learnt how to set up a web server on a BeagleBone board using a Python-Flask web framework. Then we also learnt how to interface an AC circuit with a BeagleBone board using a relay circuit to control an AC bulb via the web server running on the BeagleBone board. In this way, you have built an advanced Internet of Things project in this chapter. In the next chapter, we will be looking at how to interface a camera with the BeagleBone Black and work with OpenCV for image processing on BeagleBone Black.</p></div></body></html>