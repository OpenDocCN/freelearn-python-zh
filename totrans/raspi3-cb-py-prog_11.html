<html><head></head><body><div><h1 class="header-title">Building Neural Network Modules for Optical Character Recognition</h1>
                
            
            
                
<p>This chapter presents the following recipes:</p>
<ul>
<li>Using the <strong>Optical Character Recognition</strong> (<strong>OCR</strong>) system</li>
<li>Visualizing optical characters using the software</li>
<li>Building an optical character recognizer using neural networks</li>
<li>Application of the OCR system</li>
</ul>


            

            
        
    </div>



  
<div><h1 class="header-title">Introduction</h1>
                
            
            
                
<p>The OCR system is used to convert images of text into letters, words, and sentences. It is widely used in various fields to convert/extract the information from the image. It is also used in signature recognition, automated data evaluation, and security systems. It is commercially used to validate data records, passport documents, invoices, bank statements, computerized receipts, business cards, printouts of static data, and so on. OCR is a field of research in pattern recognition, artificial intelligence, and computer vision.</p>


            

            
        
    </div>



  
<div><h1 class="header-title">Visualizing optical characters</h1>
                
            
            
                
<p>Optical character visualization is a common method of digitizing printed texts so that such texts can be electronically edited, searched, stored compactly, and displayed online. Currently, they are widely used in cognitive computing, machine translation, text-to-speech conversion, text mining, and so on.</p>


            

            
        
    </div>



  
<div><h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Import the following packages:</li>
</ol>
<pre style="padding-left: 60px">import os 
import sys 
import cv2 
import numpy as np </pre>
<ol start="2">
<li>Load the input data:</li>
</ol>
<pre style="padding-left: 60px">in_file = 'words.data'  </pre>
<ol start="3">
<li>Define the visualization parameters:</li>
</ol>
<pre style="padding-left: 60px">scale_factor = 10 
s_index = 6 
e_index = -1 
h, w = 16, 8 </pre>
<ol start="4">
<li>Loop until you encounter the <em>Esc</em> key:</li>
</ol>
<pre style="padding-left: 60px">with open(in_file, 'r') as f: 
  for line in f.readlines(): 
    information = np.array([255*float(x) for x in line.split('t')[s_index:e_index]]) 
    image = np.reshape(information, (h,w)) 
    image_scaled = cv2.resize(image, None, fx=scale_factor, fy=scale_factor) 
    cv2.imshow('Image', image_scaled) 
    a = cv2.waitKey() 
    if a == 10: 
      break </pre>
<ol start="5">
<li>Type <kbd>python visualize_character.py</kbd> to execute the code:</li>
</ol>
<div><img class="aligncenter size-full wp-image-673 image-border" src="img/e9bbb694-b220-4496-9741-02875e981ca5.png" style="width:45.92em;height:2.25em;" width="551" height="27"/><br/></div>
<ol start="6">
<li>The result obtained when <kbd>visualize_character.py</kbd> is executed is shown here:</li>
</ol>
<div><img src="img/b0e515ef-ae47-4ce6-8413-78e59dbd3ea9.png" style="width:36.08em;height:22.33em;" width="370" height="229"/></div>


            

            
        
    </div>



  
<div><h1 class="header-title">Building an optical character recognizer using neural networks</h1>
                
            
            
                
<p>This section describes the neural network based optical character identification scheme.</p>


            

            
        
    </div>



  
<div><h1 class="header-title">How to do it...</h1>
                
            
            
                
<ol>
<li>Import the following packages:</li>
</ol>
<pre style="padding-left: 60px">import numpy as np 
import neurolab as nl </pre>
<ol start="2">
<li>Read the input file:</li>
</ol>
<pre style="padding-left: 60px">in_file = 'words.data'</pre>
<ol start="3">
<li>Consider 20 data points to build the neural network based system:</li>
</ol>
<pre style="padding-left: 60px"># Number of datapoints to load from the input file 
num_of_datapoints = 20</pre>
<ol start="4">
<li>Represent the distinct characters:</li>
</ol>
<pre style="padding-left: 60px">original_labels = 'omandig' 
# Number of distinct characters 
num_of_charect = len(original_labels) </pre>
<ol start="5">
<li>Use 90% of data for training the neural network and the remaining 10% for testing:</li>
</ol>
<pre style="padding-left: 60px">train_param = int(0.9 * num_of_datapoints) 
test_param = num_of_datapoints - train_param </pre>
<ol start="6">
<li>Define the dataset extraction parameters:</li>
</ol>
<pre style="padding-left: 60px">s_index = 6 
e_index = -1 </pre>
<ol start="7">
<li>Build the dataset:</li>
</ol>
<pre style="padding-left: 60px">information = [] 
labels = [] 
with open(in_file, 'r') as f: 
  for line in f.readlines(): 
    # Split the line tabwise 
    list_of_values = line.split('t') </pre>
<ol start="8">
<li>Implement an error check to confirm the characters:</li>
</ol>
<pre style="padding-left: 60px">    if list_of_values[1] not in original_labels: 
      continue </pre>
<ol start="9">
<li>Extract the label and attach it to the main list:</li>
</ol>
<pre style="padding-left: 60px">    label = np.zeros((num_of_charect , 1)) 
    label[original_labels.index(list_of_values[1])] = 1 
    labels.append(label)</pre>
<ol start="10">
<li>Extract the character and add it to the main list:</li>
</ol>
<pre style="padding-left: 60px">    extract_char = np.array([float(x) for x in     list_of_values[s_index:e_index]]) 
    information.append(extract_char)</pre>
<ol start="11">
<li>Exit the loop once the required dataset has been loaded:</li>
</ol>
<pre style="padding-left: 60px">    if len(information) &gt;= num_of_datapoints: 
      break </pre>
<ol start="12">
<li>Convert information and labels to NumPy arrays:</li>
</ol>
<pre style="padding-left: 60px">information = np.array(information) 
labels = np.array(labels).reshape(num_of_datapoints, num_of_charect) </pre>
<ol start="13">
<li>Extract the number of dimensions:</li>
</ol>
<pre style="padding-left: 60px">num_dimension = len(information[0]) </pre>
<ol start="14">
<li>Create and train the neural network:</li>
</ol>
<pre style="padding-left: 60px">neural_net = nl.net.newff([[0, 1] for _ in range(len(information[0]))], [128, 16, num_of_charect]) 
neural_net.trainf = nl.train.train_gd 
error = neural_net.train(information[:train_param,:], labels[:train_param,:], epochs=10000, show=100, goal=0.01) </pre>
<ol start="15">
<li>Predict the output for the test input:</li>
</ol>
<pre style="padding-left: 60px">p_output = neural_net.sim(information[train_param:, :]) 
print "nTesting on unknown data:" 
  for i in range(test_param): 
    print "nOriginal:", original_labels[np.argmax(labels[i])] 
    print "Predicted:", original_labels[np.argmax(p_output[i])]</pre>
<ol start="16">
<li>The result obtained when <kbd>optical_character_recognition.py</kbd> is executed is shown in the following screenshot:</li>
</ol>
<div><img class="aligncenter size-full wp-image-674 image-border" src="img/38229cfd-debb-4b0a-bee3-2a57a92d77a7.png" style="width:50.17em;height:40.83em;" width="602" height="490"/></div>


            

            
        
    </div>



  
<div><h1 class="header-title">How it works...</h1>
                
            
            
                
<p>A neural network-supported optical character recognition system is constructed to extract the text from the images. This procedure involves training the neural network system, testing, and validation using the character dataset.</p>
<p>Readers can refer to the article <em>Neural network based optical character recognition system</em> to learn the basic principles behind OCR: <a href="http://ieeexplore.ieee.org/document/6419976/">http://ieeexplore.ieee.org/document/6419976/</a>.</p>


            

            
        
    </div>



  
<div><h1 class="header-title">See also</h1>
                
            
            
                
<p>Please refer to the following:</p>
<ul>
<li><a href="https://searchcontentmanagement.techtarget.com/definition/OCR-optical-character-recognition">https://searchcontentmanagement.techtarget.com/definition/OCR-optical-character-recognition</a></li>
<li><a href="https://thecodpast.org/2015/09/top-5-ocr-apps/">https://thecodpast.org/2015/09/top-5-ocr-apps/</a></li>
<li><a href="https://convertio.co/ocr/">https://convertio.co/ocr/</a></li>
</ul>


            

            
        
    </div>



  
<div><h1 class="header-title">Applications of an OCR system</h1>
                
            
            
                
<p>An OCR system is widely used to convert/extract the text (the alphabet and numbers) from an image. The OCR system is widely used to validate business documents, in automatic number plate recognition, and in key character extraction from documents. It is also used to make electronic images of printed documents searchable and to build assistive technology for blind and visually impaired users.</p>


            

            
        
    </div>



  </body></html>