<html><head></head><body><div><div><h1 id="_idParaDest-283"><em class="italic"><a id="_idTextAnchor287"/></em><a href="B16119_10_Final_PD_ePub.xhtml#_idTextAnchor287"><em class="italic">Chapter 10</em></a>: Backend Views – Designing the User Interface</h1>
			<p>This chapter describes how to create views to implement the user interface for business applications. The Odoo user interface starts with the menu items and various actions being executed on menu clicks, so these are the first components we will learn about.</p>
			<p>The most used view type is the <em class="italic">form view</em>, and there are a few elements we must learn about, from organizing the disposition of the elements in the view to understanding all the options that are available for fields and buttons.</p>
			<p>Some other frequently used views include list views and search views. Finally, other view types are available that are useful for specific purposes, such as the pivot and graph views. An overview of these will be provided toward the end of this chapter.</p>
			<p>The following topics will be covered in this chapter:</p>
			<ul>
				<li>Adding menu items</li>
				<li>Understanding window actions</li>
				<li>Exploring the form view's structure</li>
				<li>Using fields</li>
				<li>Using buttons</li>
				<li>Adding dynamic view elements</li>
				<li>Exploring list views</li>
				<li>Exploring search views</li>
				<li>Understanding the other available view types</li>
			</ul>
			<p>By the end of this chapter, you should be familiar with all the Odoo view types and have the resources to use them. In particular, you will be confident with designing non-trivial form views and providing an adequate user experience.</p>
			<h1 id="_idParaDest-284"><a id="_idTextAnchor288"/>Technical requirements</h1>
			<p>We'll continue working with the <code>library_checkout</code> add-on module. The model layer for it is already complete; now, it needs the view layer for the user interface.</p>
			<p>The code in this chapter is based on the code that we created in <a href="B16119_08_Final_PD_ePub.xhtml#_idTextAnchor227"><em class="italic">Chapter 8</em></a>, <em class="italic">Business Logic – Supporting Business Processes</em>. The necessary code can be found in this book's GitHub repository at <a href="https://github.com/PacktPublishing/Odoo-15-Development-Essentials">https://github.com/PacktPublishing/Odoo-15-Development-Essentials</a>, in the <code>ch10</code> directory.</p>
			<h1 id="_idParaDest-285"><a id="_idTextAnchor289"/>Adding menu items</h1>
			<p>Menu items are the starting point for user interface navigation. They form a hierarchical structure, where the top-level items represent applications, and the level below is the application main menu. Further sub-menu levels can be added.</p>
			<p>Menu items <a id="_idIndexMarker778"/>with no sub-menus are <em class="italic">actionable</em> and can trigger an action that tells the web client what to do, such as opening a view.</p>
			<p>Menu items are stored in the <code>ir.ui.menu</code> model and can be browsed via the <strong class="bold">Settings </strong>| <strong class="bold">Technical</strong> | <strong class="bold">User Interface</strong> | <strong class="bold">Menu Items</strong> menu.</p>
			<p>The <code>library_app</code> add-on module created a top-level menu for the library books, while the <code>library_checkout</code> add-on module added the menu items for the checkouts and checkout stages. These are both implemented in <code>library_checkout/views/library_menu.xml</code>.</p>
			<p>This is the XML for the checkout menu item:</p>
			<pre>    &lt;menuitem id="menu_library_checkout"
              name="Checkout"
              action="action_library_checkout"
              parent="library_app.library_menu"
    /&gt;</pre>
			<p>The preceding code uses a <code>&lt;menuitem&gt;</code> shortcut element, which is an abbreviated way to create a menu record that's more convenient than a <code>&lt;record model="ir.ui.menu"&gt;</code> element.</p>
			<p>The most<a id="_idIndexMarker779"/> used <code>&lt;menuitem&gt;</code> attributes are as follows:</p>
			<ul>
				<li><code>name</code> is the menu item's title and is present in the user interface.</li>
				<li><code>action</code> is the XML ID of the action to run when clicking on the menu item.</li>
				<li><code>parent</code> is the XML ID of the parent menu item. In this case, the parent was created in another module, so it needs to be referenced using the complete XML ID; that is, <code>&lt;module&gt;.&lt;XML ID&gt;</code>.</li>
			</ul>
			<p>Some <a id="_idIndexMarker780"/>other attributes are also available:</p>
			<ul>
				<li><code>sequence</code> sets a number to order the presentation of the menu items; for example, <code>sequence="10"</code>.</li>
				<li><code>groups</code> is a comma-separated list of XML IDs of the security groups that have access to the menu item; for example, <code>groups="library_app.library_group_user,library_app.library_group_manager"</code>.</li>
				<li><code>web_icon</code> is the path to the icon to use. It's only relevant for top-level menu items in the enterprise edition. The path value should follow the <code>web_icon="library_app,static/description/icon.png"</code> format.</li>
			</ul>
			<p>Menu items can run an action, as identified by the <code>action</code> attribute, and in most cases, this will be a <strong class="bold">window action</strong>. The next section will explain how to create actions and what they are capable of.</p>
			<h1 id="_idParaDest-286"><a id="_idTextAnchor290"/>Understanding window actions</h1>
			<p>A <strong class="bold">window action</strong> on a <a id="_idIndexMarker781"/>menu gives the web client instructions on what to do, such as opening a view, and can be used in menu items or buttons in views.</p>
			<p>Window actions identify the model to use and the views to present in the user interface. They can also filter the available records using a <code>domain</code> filter and can set default values and filters using the <code>context</code> attribute.</p>
			<p>Window actions are stored in the <code>ir.actions.act_window</code> model and can be browsed by going to the <strong class="bold">Settings</strong> | <strong class="bold">Technical</strong> | <strong class="bold">Actions</strong> | <strong class="bold">Window Actions</strong> menu.</p>
			<p>The <code>library_checkout/views/library_menu.xml</code> file contains the definition for the window action that's used by the checkout menu item:</p>
			<pre>    &lt;record id="action_library_checkout" 
            model="ir.actions.act_window"&gt;
        &lt;field name="name"&gt;Checkouts&lt;/field&gt;
        &lt;field name="res_model"&gt;library.checkout&lt;/field&gt;
        &lt;field name="view_mode"&gt;tree,form&lt;/field&gt;
    &lt;/record&gt;</pre>
			<p>A window action<a id="_idIndexMarker782"/> is an <code>ir.actions.act_window</code> record. The most important fields are as follows:</p>
			<ul>
				<li><code>name</code> is the title that will be displayed on the view that's opened through the action.</li>
				<li><code>res_model</code> is the identifier of the target model.</li>
				<li><code>view_mode</code> is a comma-separated list of the view types to make available. The first in the list is the one to open by default.</li>
			</ul>
			<p>The other relevant<a id="_idIndexMarker783"/> window actions fields are as follows:</p>
			<ul>
				<li><code>target</code> defaults to <code>current</code> and opens the view inline in the main content area. If it's set to <code>new</code>, it will open the view in a pop-up dialog window; for example, <code>target="new"</code>.</li>
				<li><code>context</code> sets context information on the target views, which can set default values or activate filters, among other things; for example, <code>&lt;field name="context"&gt;{'default_user_id': uid}&lt;/field&gt;</code>.</li>
				<li><code>domain</code> is a domain expression that forces a filter for the records that can be browsed in the opened views; for example, <code>domain="[('user_id', '=', uid)]"</code>.</li>
				<li><code>limit</code> is the number of records for each page in the list view; for example, <code>limit="80"</code>.</li>
				<li><code>view_id</code> is a<a id="_idIndexMarker784"/> reference to a particular view to be used. It can't be used together with <code>view_mode</code>. It is often used together with <code>target="new"</code>, to open a particular form as a popup.<p class="callout-heading">Changes in Odoo 13</p><p class="callout">Until Odoo 12, the <code>&lt;act_window&gt;</code> shortcut element could be used to create window actions. This was removed in Odoo 13. Now, window actions must be created using a <code>&lt;record model="ir.actions.act_window"&gt;</code> element.</p></li>
			</ul>
			<p>In this chapter, we will add view types for the <code>library.checkout</code> model. By doing so, we will showcase the other available view types, other than form and tree/list views.</p>
			<p>The view types to be <a id="_idIndexMarker785"/>made available must be indicated by the window action. So, let's edit the <code>library_checkout/views/library_menu.xml</code> file to add the new view types, as highlighted in the following code:</p>
			<pre>    &lt;record id="action_library_checkout" 
            model="ir.actions.act_window"&gt;
        &lt;field name="name"&gt;Checkouts&lt;/field&gt;
        &lt;field name="res_model"&gt;library.checkout&lt;/field&gt;
        &lt;field name="view_mode"
            &gt;tree,form<strong class="bold">,activity, calendar,graph,pivot</strong>&lt;/field&gt;
    &lt;/record&gt;</pre>
			<p>These changes can't be made yet. The definitions of the corresponding view types should be implemented before they are added to the window action's <code>view_mode</code>.</p>
			<p>Other than the menu items or view buttons, actions can also be used in the <strong class="bold">Action</strong> context menu, which is available near the search box. The next section explains this in detail.</p>
			<h1 id="_idParaDest-287"><a id="_idTextAnchor291"/>Adding options to the Action context menu</h1>
			<p>Window actions <a id="_idIndexMarker786"/>can also be used from the <strong class="bold">Action</strong> menu button, available at the top of form views, and also in list views when records are selected:</p>
			<div><div><img src="img/Figure_10.1_B16119.jpg" alt="Figure 10.1 – The Action context menu&#13;&#10;" width="1185" height="352"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.1 – The Action context menu</p>
			<p>This menu is contextual because the action will apply to the record or records currently selected.</p>
			<p>To have an action available in the <strong class="bold">Action</strong> menu, two more fields have to be set on the window action:</p>
			<ul>
				<li><code>binding_model_id</code> is a reference to the model to use the action for; for example, <code>&lt;field name="binding_model_id" ref="model_library_checkout" /&gt;</code>.</li>
				<li><code>binding_view_types</code> can be used to limit the option's visibility to specific view types, such as <code>form</code> or <code>list</code>; for example, <code>&lt;field name="binding_view_types"&gt;form,list&lt;/field&gt;</code>.</li>
			</ul>
			<p>An example of this has already been implemented in the <code>library_checkout</code> module, in the <code>wizard/checkout_mass_message_wizard_view.xml</code> file. This has been copied here for reference:</p>
			<pre>  &lt;record id="action_checkout_message"
          model="ir.actions.act_window"&gt;
    &lt;field name="name"&gt;Send Messages&lt;/field&gt;
    &lt;field name="res_model"&gt;
      library.checkout.massmessage&lt;/field&gt;
    &lt;field name="view_mode"&gt;form&lt;/field&gt;
    <strong class="bold">&lt;field name="binding_model_id" </strong>
<strong class="bold">      ref="model_library_checkout" /&gt;</strong>
    <strong class="bold">&lt;field name="binding_view_types"&gt;form,list&lt;/field&gt;</strong>
    &lt;field name="target"&gt;new&lt;/field&gt;
  &lt;/record&gt;</pre>
			<p>The settings that are related to binding to the <strong class="bold">Action</strong> menu are highlighted in the previous code.</p>
			<p>The following<a id="_idIndexMarker787"/> screenshot illustrates the corresponding action menu item:</p>
			<div><div><img src="img/Figure_10.2_B16119.jpg" alt="Figure 10.2 – The Send Message action menu options&#13;&#10;" width="1172" height="768"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.2 – The Send Message action menu options</p>
			<p class="callout-heading">Changes in Odoo 13</p>
			<p class="callout">The action binding fields were changed in Odoo 13. Until Odoo 12, <code>src_model</code> set the binding and used the model identifier, <code>library.checkout</code>, for example. It is available in the form view, and it can also be made available in the list view by setting <code>multi</code> to <code>true</code>.</p>
			<p>Once a <a id="_idIndexMarker788"/>window action has been triggered, the corresponding views are opened. The most used view types are form and list. The next section details how to create form views.</p>
			<h1 id="_idParaDest-288"><a id="_idTextAnchor292"/>Exploring the form view structure</h1>
			<p>Form views are<a id="_idIndexMarker789"/> the main way users can interact with data records. Form views can either follow a simple layout or a business document layout, similar to a paper document. In this section, we'll learn how to design these business document views and how to use the elements and widgets that are available.</p>
			<p>In <a href="B16119_08_Final_PD_ePub.xhtml#_idTextAnchor227"><em class="italic">Chapter 8</em></a>, <em class="italic">Business Logic – Supporting Business Processes</em>, we created a library checkout model and prepared a basic form for it. We will revisit and enhance it in this section.</p>
			<p>The following screenshot shows what the form view will look like when we're done:</p>
			<div><div><img src="img/Figure_10.3_B16119.jpg" alt="Figure 10.3 – The enhanced Checkouts form view&#13;&#10;" width="1175" height="867"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.3 – The enhanced Checkouts form view</p>
			<p>You can<a id="_idIndexMarker790"/> refer to this screenshot while we gradually add the different elements throughout this chapter.</p>
			<h2 id="_idParaDest-289"><a id="_idTextAnchor293"/>Using business document views</h2>
			<p>Historically, organizations<a id="_idIndexMarker791"/> use paper forms to support their internal <a id="_idIndexMarker792"/>processes. Business application models support digital versions of these paper forms, and in the process, they can add automation and make operations more efficient.</p>
			<p>For a more intuitive user interface, form views can mimic these paper documents, helping users to visualize processes they are used to running on paper forms.</p>
			<p>For example, for the <strong class="bold">Library</strong> app, book checkouts are probably a process where a paper form has to be filled in. It is probably a good idea to let the checkout form have a layout that looks like a paper document.</p>
			<p>A business document is a form that contains two elements: a <code>&lt;head&gt;</code> section and a <code>&lt;sheet&gt;</code> section. <code>head</code> contains buttons and widgets to control the document's business workflow, while <code>sheet</code> contains the actual document content. After the <code>sheet</code> section, we can also have the message and activity widgets.</p>
			<p>To add this <a id="_idIndexMarker793"/>structure to the checkout form, start by editing <a id="_idIndexMarker794"/>the <code>library_checkout/views/checkout_view.xml</code> file and changing the form view record to the following basic skeleton:</p>
			<pre>&lt;record id="view_form_checkout" model="ir.ui.view"&gt; 
  &lt;field name="model"&gt;library.checkout&lt;/field&gt; 
  &lt;field name="arch" type="xml"&gt; 
    &lt;form&gt; 
      &lt;header&gt;  
        <strong class="bold">&lt;!-- To add buttons and status widget --&gt;</strong>
      &lt;/header&gt;
      &lt;sheet&gt; 
        <strong class="bold">&lt;!-- To add form content --&gt;</strong>
      &lt;/sheet&gt; 
      &lt;!-- Discuss widgets --&gt;
      &lt;div class="oe_chatter"&gt;  
        &lt;field name="message_follower_ids"  
               widget="mail_followers" /&gt; 
        &lt;field name="activity_ids"
               widget="mail_activity" /&gt; 
        &lt;field name="message_ids"
               widget="mail_thread" /&gt; 
      &lt;/div&gt; 
    &lt;/form&gt;
  &lt;/field&gt; 
&lt;/record&gt;</pre>
			<p>The view name is optional and automatically generated if it's missing. So, for simplicity, the <code>&lt;field name="name"&gt;</code> element was omitted from the preceding view record.</p>
			<p>The <code>&lt;head&gt;</code> and <code>&lt;sheet&gt;</code> sections are empty for now, and will be expanded next.</p>
			<p>The<a id="_idIndexMarker795"/> messaging section at the bottom uses the widgets <a id="_idIndexMarker796"/>provided by the <code>mail</code> add-on module, as explained in <a href="B16119_08_Final_PD_ePub.xhtml#_idTextAnchor227"><em class="italic">Chapter 8</em></a>, <em class="italic">Business Logic – Supporting Business Processes</em>.</p>
			<p>The first section to check is the form header.</p>
			<h2 id="_idParaDest-290"><a id="_idTextAnchor294"/>Adding a header section</h2>
			<p>The header <a id="_idIndexMarker797"/>at the top usually features the steps that the document will move through in its life cycle and the related action buttons. These action buttons are regular form buttons, and the button for moving on will usually be highlighted, to help the user.</p>
			<h3>Adding header buttons</h3>
			<p>Let's start by <a id="_idIndexMarker798"/>adding a button to the currently empty header section.</p>
			<p>While editing the <code>&lt;header&gt;</code> section in the form view, add a button to move a checkout to the <code>done</code> state:</p>
			<pre>&lt;header&gt; 
  &lt;field name="state" invisible="True" /&gt;
  &lt;button name="button_done"
    type="object"
    string="Return Books"
    attrs="{'invisible':
      [('state', 'in', ['new', 'done', 'cancel'])]}"
    class="oe_highlight"
  /&gt;
&lt;/header&gt;</pre>
			<p>By using the preceding code, the <code>Return Books</code> button is added to the header with <code>type="object"</code>, meaning that a model method is called. <code>name="button_done"</code> declares the method name to call.</p>
			<p><code>class="oe_highlight"</code> is used to highlight the button. When we have several buttons to choose from, the main or more usual course of action can be highlighted to help users.</p>
			<p>The <code>attrs</code> attribute is used to have the button visible only in the states where it makes sense. It should be visible in the <code>open</code> state, so it should be set to invisible for the <code>new</code>,  <code>done</code>, and <code>cancel</code> states.</p>
			<p>The condition to<a id="_idIndexMarker799"/> do this uses the <code>state</code> field, which otherwise is not used on the form. For the <code>attrs</code> condition to work, the <code>state</code> field needs to be loaded into the web client. To ensure this, it was added as an invisible field.</p>
			<p>In this particular case, the special <code>state</code> field name is being used, and the visibility condition to be implemented with <code>attrs</code> can be achieved with the simpler <code>states</code> attribute. The <code>states</code> attribute lists the states where the element will be visible.</p>
			<p>By using <code>states</code> instead of <code>attrs</code>, the button will only be visible in the <code>open</code> state and will look like this:</p>
			<pre>  &lt;button name="button_done" 
    type="object" 
    string="Return Books"
    <strong class="bold">states="open"</strong>
    class="oe_highlight"
  /&gt;</pre>
			<p>The <code>attrs</code> and <code>states</code> element visibility features can also be used on other view elements, such as fields. We'll explore them in more detail later in this chapter.</p>
			<p>For this button to <a id="_idIndexMarker800"/>work, the method that's being called must be implemented. For this, in the <code>library_checkout/models/library_checkout.py</code> file, add the following code to the <code>checkout</code> class:</p>
			<pre>    def button_done(self):
        Stage = self.env["library.checkout.stage"]
        done_stage = Stage.search([("state", "=", "done")], 
          limit=1)
        for checkout in self:
            checkout.stage_id = done_stage
        return True</pre>
			<p>First, the code looks up <code>done</code> state. It will be used to set the records to that stage.</p>
			<p>The <code>self</code> recordset will usually be a single record, but the API allows it to be called for a multi-record recordset, so this possibility should be addressed. This can be done with a <code>for</code> loop on <code>self</code>. Then, for each record in the <code>self</code> recordset, the <code>stage_id</code> field must be set to the <code>done</code> stage.</p>
			<p>Alongside the buttons, the header can feature a status bar widget to present the available <em class="italic">stages</em> or <em class="italic">states</em>.</p>
			<h3>Adding a status bar pipeline</h3>
			<p>Another helpful element in the <a id="_idIndexMarker801"/>header is a pipeline diagram presenting the process steps and where the current document is at. This can be based either on a <em class="italic">stages</em> or a <em class="italic">states</em> list. This pipeline widget can be clickable or not, in case we want the changes to only be made through buttons.</p>
			<p>The status bar widget is added with a <code>&lt;field&gt;</code> element using the <code>statusbar</code> widget. The checkout model has the <code>stage_id</code> field that we will use:</p>
			<pre>&lt;header&gt;  
  &lt;field name="state" invisible="True" /&gt;
  &lt;button name="do_clear_done" type="object" 
    string="Clear Done"
    states="open,cancel"
    class="oe_highlight" /&gt;
<strong class="bold">  &lt;field name="stage_id"</strong>
<strong class="bold">    widget="statusbar"</strong>
<strong class="bold">    </strong><strong class="bold">options="{'clickable': True, 'fold_field': 'fold'}" /&gt;</strong>
&lt;/header&gt;</pre>
			<p>The <code>statusbar</code> widget<a id="_idIndexMarker802"/> can be used either with a <strong class="bold">state</strong> selection field or a <strong class="bold">stage</strong> many-to-one field. These two kinds of fields can be found across several Odoo core modules.</p>
			<p>The <code>clickable</code> option allows the user to change the document stage by clicking on the status bar. Having it enabled provides flexibility to the user. But there are also cases where we need more control over the workflow, and require the users to progress through the stages using only the available action buttons.</p>
			<p class="callout-heading">Changes in Odoo 12</p>
			<p class="callout">Until Odoo 11, the clickable option was a field attribute, <code>&lt;field widget="statusbar" clickable="True" /&gt;</code>. In Odoo 12, it was converted into a widget option, <code>&lt;field widget="statusbar" options="{'clickable': True}" /&gt;</code>.</p>
			<p>The <code>fold_field</code> option is used to allow less important stages, such as <em class="italic">canceled</em>, to be hidden (folded) in a <code>fold_field</code> is set with the field name that's used for this. In this case, it is named <code>fold</code>.</p>
			<h3>Using states instead of stages</h3>
			<p>The <strong class="bold">stage</strong> is a <a id="_idIndexMarker803"/>many-to-one field that uses a supporting model to set up the steps of the process. It is flexible, can be configured by end users to fit their specific business process, and is perfect for supporting Kanban boards. The library checkouts model is using it.</p>
			<p>The <strong class="bold">state</strong> is a closed<a id="_idIndexMarker804"/> selection list featuring fixed process steps, such as <strong class="bold">New</strong>, <strong class="bold">In Progress</strong>, and <strong class="bold">Done</strong>. It can be used in business logic since the available states can't change. But it can't be configured by end users.</p>
			<p>Each of the approaches has pros and cons. It is possible to benefit from the best of both options by using stages and having each stage mapped into a state. The checkout model implemented this, adding a state field in the checkout stages model, which is also directly available in the checkout model through a related field.</p>
			<p>If a model is using states only, the status bar pipeline can also be used, with the <code>statusbar</code> widget. However, the <code>fold_field</code> option is not available; instead, the <code>statusbar_visible</code> attribute can be used, listing the states to make visible.</p>
			<p>Using the status bar with a state <code>field</code> looks like this:</p>
			<pre>&lt;field name="state"
  widget="statusbar"
  options="{'clickable': True}"
  statusbar_visible="draft,open,done"
/&gt;</pre>
			<p>Notice that the previous code is not used in the <code>library_checkout</code> module. Since it supports the more flexible stages, we prefer to use them on the user interface.</p>
			<p>Now that we're are done with the header section, let's look at the main form section.</p>
			<h2 id="_idParaDest-291"><a id="_idTextAnchor295"/>Designing the document sheet</h2>
			<p>The sheet canvas<a id="_idIndexMarker805"/> is the main area of the form and is where the actual data<a id="_idIndexMarker806"/> elements are placed. It is designed to look like an actual paper document.</p>
			<p>Usually, a document sheet structure will contain the following areas:</p>
			<ul>
				<li>A document title at the top</li>
				<li>A button box at the top-right corner</li>
				<li>Document header data fields</li>
				<li>A notebook at the bottom, for additional fields that can be organized into tabs or pages</li>
			</ul>
			<p>The document will often contain detailed lines of code. These are usually presented on the notebook's first page.</p>
			<p>Here is the expected XML structure:</p>
			<pre>      &lt;sheet&gt;
        <strong class="bold">&lt;!-- Button box --&gt;</strong>
        &lt;div class="oe_button_box" name="button_box" /&gt;
        <strong class="bold">&lt;!-- Header title --&gt;</strong>
        &lt;div class="oe_title" /&gt;
        <strong class="bold">&lt;!-- Header fields --&gt;</strong>
        &lt;group /&gt;
        <strong class="bold">&lt;!-- Notebook --&gt;</strong>
        &lt;notebook /&gt;
      &lt;/sheet&gt;</pre>
			<p>After the sheet, we usually have the Chatter widget, which contains the document followers, discussion messages, and planned activities.</p>
			<p>Let's go through each of these areas. The button box will be discussed later, so next, we will discuss the header title.</p>
			<h2 id="_idParaDest-292"><a id="_idTextAnchor296"/>Adding a header title</h2>
			<p>The header title will<a id="_idIndexMarker807"/> usually display the document's title in large letters. It may be followed by a subtitle and may also have an image next to it.</p>
			<p>First, a couple of fields need to be added to the checkout model. A field needs to be used as the title, and an image needs to be used to represent the borrower. Edit the <code>library_checkout/models/library_checkout.py</code> file and add the following code:</p>
			<pre>    name = fields.Char(string="Title")
    member_image = fields.Binary(related=
      "member_id.image_128")</pre>
			<p>The header title goes inside a <code>&lt;div class="oe_title"&gt;</code> element. Regular HTML elements, such as <code>div</code>, <code>span</code>, <code>h1</code>, and <code>h3</code>, can be used.</p>
			<p>In the following code, the <code>&lt;sheet&gt;</code> element has been expanded to include the title, plus some additional fields as subtitles:</p>
			<pre>&lt;sheet&gt; 
  &lt;div name="button_box" class="oe_button_box" /&gt;
  &lt;field name="member_image" widget="image" 
    class="oe_avatar" /&gt;
  &lt;div class="oe_title"&gt; 
    &lt;label for="name" class="oe_edit_only"/&gt; 
    &lt;h1&gt;&lt;field name="name"/&gt;&lt;/h1&gt; 
    &lt;h3&gt; 
      &lt;span class="oe_read_only"&gt;By &lt;/span&gt; 
      &lt;label for="member_id" class="oe_edit_only"/&gt; 
      &lt;field name="member_id" class="oe_inline" /&gt; 
    &lt;/h3&gt; 
  &lt;/div&gt; 
  &lt;!-- More elements will be added from here... --&gt; 
&lt;/sheet&gt;</pre>
			<p>The preceding XML<a id="_idIndexMarker808"/> render includes the following:</p>
			<ul>
				<li>A button box <code>&lt;div&gt;</code> element. It is empty now but can be used to add smart buttons.</li>
				<li>An image field, for <code>member_image</code>, using an avatar-like image widget.</li>
				<li>A <code>&lt;div&gt;</code> element containing the document title elements. Inside the title, there is the following:<ul><li>A <code>&lt;label&gt;</code> for the <code>name</code> field, which is only visible in edit mode.</li><li>The <code>name</code> field, which is rendered as an HTML <code>&lt;h1&gt;</code> heading.</li><li>A <code>&lt;h3&gt;</code> subtitle heading containing the <code>member_id</code> field. This is only visible in read mode. The <code>&lt;field&gt;</code> tag uses <code>oe_inline</code> to let the HTML elements manage the text flow.</li></ul></li>
			</ul>
			<p>Fields outside a <code>&lt;group&gt;</code> element don't have labels rendered for them. The preceding XML has no <code>&lt;group&gt;</code> element, so labels need to be explicitly added.</p>
			<p>After the title element, there will usually be header fields, organized into groups.</p>
			<h2 id="_idParaDest-293"><a id="_idTextAnchor297"/>Organizing the form content using groups</h2>
			<p>The main content of the <a id="_idIndexMarker809"/>form should be organized using <code>&lt;group&gt;</code> tags.</p>
			<p>The <code>&lt;group&gt;</code> tag inserts <a id="_idIndexMarker810"/>two columns in the canvas. Fields that are added inside a group use these two columns – the first for the field label and the second for the field value widget. Adding more fields to the group will stack them vertically as new fields are added in a new row.</p>
			<p>A common pattern is to have two columns of fields, side by side. You can do this by adding two <code>&lt;group&gt;</code> tags nested into a top group.</p>
			<p>Continuing with our form view, we'll use this to add the main content, after the title's <code>&lt;div&gt;</code> section:</p>
			<pre>&lt;!-- More elements will be added from here... --&gt; 
<strong class="bold">&lt;group name="group_top"&gt;</strong> 
  <strong class="bold">&lt;group name="group_col1"&gt;</strong> 
    &lt;field name="request_date" /&gt; 
  &lt;/group&gt; 
  <strong class="bold">&lt;group name="group_col2"&gt; </strong>
    &lt;field name="close_date" /&gt; 
    &lt;field name="user_id" /&gt; 
  &lt;/group&gt; 
&lt;/group&gt;</pre>
			<p>The top <code>&lt;group&gt;</code> element creates two columns in the canvas. Each of the two nested <code>&lt;group&gt;</code> elements uses one of these columns. The first nested group uses the left column, while the second group takes the right column.</p>
			<p>The <code>&lt;group&gt;</code> elements <a id="_idIndexMarker811"/>were assigned a <code>name</code>. This is not required but<a id="_idIndexMarker812"/> is recommended so that the module is easier to extend.</p>
			<p>The <code>&lt;group&gt;</code> element can also have a <code>string</code> attribute, which is used to display title text for it.</p>
			<p class="callout-heading">Changes in Odoo 11</p>
			<p class="callout">The <code>string</code> attribute cannot be used as an anchor for inheritance anymore. This is because the corresponding text can be translated, and this can break inherited/extension views. The <code>name</code> attribute should be used instead.</p>
			<p>The following elements can be used to adjust the view layout:</p>
			<ul>
				<li>The <code>&lt;newline&gt;</code> element can be used to force a new line so that the next element is rendered in the next row's first column.</li>
				<li>The <code>&lt;separator&gt;</code> element can be added to add section titles. A title text can be set using the <code>string</code> attribute.</li>
			</ul>
			<p>The <code>col</code> and <code>colspan</code> attributes provide additional control over the grid layout:</p>
			<ul>
				<li>The <code>col</code> attribute is used on <code>&lt;group&gt;</code> elements to customize the number of columns it contains. By default, a <code>&lt;group&gt;</code> element contains two columns, but that can be changed to any other number. Even numbers work better since, by default, each field that's added takes up two columns – one for the label and one for the value.</li>
				<li>The <code>colspan</code> attribute can be used on group-contained elements to set a specific number of columns they should take. By default, a field takes two columns.</li>
			</ul>
			<p>The following <a id="_idIndexMarker813"/>code shows an alternative version of the top <a id="_idIndexMarker814"/>group element and uses <code>col="4"</code> to present the four fields in two columns:</p>
			<pre>&lt;group name="group_top" col="4"&gt; 
  &lt;field name="request_date" /&gt;
  &lt;field name="user_id" /&gt; 
  &lt;span colspan="2" /&gt;
  &lt;field name="close_date" /&gt; 
&lt;/group&gt;</pre>
			<p>Notice that the order of the fields is different because the fields are placed from left to right, and then from top to bottom. The <code>&lt;span colspan="2"&gt;</code> element was used to occupy the two first columns of the second row so that the <code>close_date</code> field takes the last two columns.</p>
			<p>Some forms also feature a notebook section to organize the additional fields on different pages.</p>
			<h2 id="_idParaDest-294"><a id="_idTextAnchor298"/>Adding tabbed notebooks</h2>
			<p>The notebook element <a id="_idIndexMarker815"/>is another way to organize the form's content. It is a container with multiple tabbed pages. These can be used to keep less-used data out of sight until it's needed or to organize a large number of fields by topic.</p>
			<p>The checkout form will have a notebook element, and the first page will contain the list of borrowed books. For this, after the <code>&lt;group name="group_top"&gt;</code> element, which we added in the previous section, include the following XML:</p>
			<pre>&lt;notebook&gt; 
  &lt;page name="page_lines" string="Borrowed Books"&gt;
    &lt;field name="line_ids" /&gt;
  &lt;/page&gt;
&lt;/notebook&gt;</pre>
			<p>This notebook contains only one page. To add more, just include more <code>&lt;page&gt;</code> elements inside the <code>&lt;notebook&gt;</code> element. The page canvas does not render field labels by default. For that to happen, the fields should be placed inside a <code>&lt;group&gt;</code> section, just like for the form main canvas.</p>
			<p>In this case, the one-to-many <code>line_ids</code> field was added inside the page, with no <code>&lt;group&gt;</code> element, so no label will be rendered for it.</p>
			<p>The <code>page</code> element supports the following attributes:</p>
			<ul>
				<li><code>string</code>, for the page title. This is required.</li>
				<li><code>attrs</code> is a dictionary for mapping the <code>invisible</code> and <code>required</code> attribute values to the result of a domain expression.</li>
				<li><code>accesskey</code>, an HTML access key.</li>
			</ul>
			<p>This section discussed the typical layout for a form view, as well as the most important elements to use for this. The most important elements are the data fields. The next section discusses them in detail.</p>
			<h1 id="_idParaDest-295"><a id="_idTextAnchor299"/>Using fields</h1>
			<p>Inside a form or list view, fields <a id="_idIndexMarker816"/>widgets are the way to present and edit data from model fields.</p>
			<p>View fields have <a id="_idIndexMarker817"/>a few attributes available to them. Most of these attribute values have defaults that are taken from the model definition, but these can be overridden in the view.</p>
			<p>Here is a quick reference for the <a id="_idIndexMarker818"/>common field attributes:</p>
			<ul>
				<li><code>name</code> is the field name in the model and identifies the field that's being rendered by this element.</li>
				<li><code>string</code> is the label text to be used. It overrides the model definition.</li>
				<li><code>help</code> provides some tooltip help text that's shown when the mouse is hovered over the field.</li>
				<li><code>placeholder</code> provides suggestion text to be displayed inside the field.</li>
				<li><code>widget</code> sets a specific widget to be used to render the field. The available widgets will be discussed later in this section.</li>
				<li><code>options</code> is a JSON data structure that's used to pass additional options to the widget. The values to use depend on the widget being used.</li>
				<li><code>Class</code> is a comma-separated list of CSS classes to use for the field HTML rendering process.</li>
				<li><code>nolabel="True"</code> prevents the automatic field label from being presented. It only makes sense for fields inside a <code>&lt;group&gt;</code> element and is often used along with a <code>&lt;label for="..."&gt;</code> element.</li>
				<li><code>invisible="True"</code> makes the field not visible, but its data is fetched from the server and is available on the form. Note that forms can't write on invisible fields.</li>
				<li><code>readonly="True"</code> makes the field read-only on the form.</li>
				<li><code>required="True"</code> makes the field mandatory on the form.</li>
			</ul>
			<p>The following special attributes are only supported by specific field types:</p>
			<ul>
				<li><code>password="True"</code> is used for text fields. It is displayed as a password field, masking the characters that are typed in.</li>
				<li><code>filename</code> is used for <a id="_idIndexMarker819"/>binary fields and is the name of the model field to be used for the name of the uploaded file.</li>
			</ul>
			<p>Two more topics are worth further discussion. One is how to have additional control of the field label's presentation, while the other is about using different web client widgets for a better user experience.</p>
			<h2 id="_idParaDest-296"><a id="_idTextAnchor300"/>Modifying field labels</h2>
			<p>Fields won't automatically<a id="_idIndexMarker820"/> render labels unless they're inside a <code>&lt;group&gt;</code> element. In that case, labels will be explicitly suppressed using <code>nolabel="True"</code>.</p>
			<p>Labels can be explicitly added using a <code>&lt;label for="..."/&gt;</code> element. This gives you more control over where to display field labels. The following code was used in the form title:</p>
			<pre>&lt;label for="name" class="oe_edit_only" /&gt;</pre>
			<p>The <code>for</code> attribute identifies the field we should get the label text from. The optional <code>string</code> attribute can set specific text for the label. CSS classes can also be used. The previous code used the following:</p>
			<ul>
				<li><code>class="oe_edit_only"</code> makes the element visible in edit mode only.</li>
				<li><code>class="oe_read_only"</code> makes the element visible in read mode only.</li>
			</ul>
			<p>This can be used to control how field labels are presented. How the field data is presented can also be adjusted using different widgets.</p>
			<h2 id="_idParaDest-297"><a id="_idTextAnchor301"/>Choosing field widgets</h2>
			<p>Field content is<a id="_idIndexMarker821"/> presented using a web client widget. This can influence the way data is presented to the user, as well as the interaction when setting a value on the field.</p>
			<p>Each field type is displayed using the appropriate default widget. However, additional alternative widgets may be available.</p>
			<h3>Text field widgets</h3>
			<p>For text fields, the following<a id="_idIndexMarker822"/> widgets can be used:</p>
			<ul>
				<li><code>email</code> renders <a id="_idIndexMarker823"/>as an actionable <code>mailto</code> HTML link.</li>
				<li><code>phone</code> renders as an actionable phone HTML link.</li>
				<li><code>url</code> is used to format the text as a clickable URL.</li>
				<li><code>html</code> is used to render the text as HTML content. In edit mode, it features a WYSIWYG editor to allow you to format the content without the need to use HTML syntax.</li>
			</ul>
			<h3>Numeric field widgets</h3>
			<p>For numeric fields, the <a id="_idIndexMarker824"/>following <a id="_idIndexMarker825"/>widgets are available:</p>
			<ul>
				<li><code>handle</code> is specifically designed for sequence fields in list views and displays a handle to drag lines and reorganize their order.</li>
				<li><code>float_time</code> formats a <code>float</code> field as hours and minutes.</li>
				<li><code>monetary</code> displays a <code>float</code> field as a currency amount. It expects the currency that's used to be in a <code>currency_id</code> companion field. If the <code>currency</code> field has a different name, it can be set with <code>options="{'currency_field': '&lt;field name&gt;'}"</code>.</li>
				<li><code>progressbar</code> represents a <code>float</code> as a percentage progress bar, which is useful for fields representing a completion rate.</li>
				<li><code>percentage</code> and <code>percentpie</code> are other<a id="_idIndexMarker826"/> widgets that can be used <a id="_idIndexMarker827"/>with float fields.</li>
			</ul>
			<h3>Relation and selection field widgets</h3>
			<p>For relation<a id="_idIndexMarker828"/> and <a id="_idIndexMarker829"/>selection fields, the<a id="_idIndexMarker830"/> following <a id="_idIndexMarker831"/>widgets are available:</p>
			<ul>
				<li><code>many2many_tags</code> displays values as a list of button-like labels.</li>
				<li><code>many2many_checkboxes</code> displays the selectable values as a list of checkboxes.</li>
				<li><code>selection</code> uses the <code>selection</code> field widget for a many-to-one field.</li>
				<li><code>radio</code> displays the <code>selection</code> field options using radio buttons.</li>
				<li><code>priority</code> represents the <code>selection</code> field as a list of clickable stars. The selection options are usually numeric digits.</li>
				<li><code>state_selection</code> shows a traffic light button and is typically used for the Kanban state selection list. The <code>normal</code> state is gray, <code>done</code> is green, and any other state is represented in red.<p class="callout-heading">Changes in Odoo 11</p><p class="callout">The <code>state_selection</code> widget was introduced in Odoo 11 and replaces the former <code>kanban_state_selection</code>, which has been deprecated.</p></li>
			</ul>
			<h3>Binary field widgets</h3>
			<p>For <a id="_idIndexMarker832"/>binary fields, the<a id="_idIndexMarker833"/> following widgets are available:</p>
			<ul>
				<li><code>image</code> presents the binary data as an image.</li>
				<li><code>pdf_viewer</code> presents the binary data in a PDF preview widget (introduced in Odoo 12).</li>
			</ul>
			<h2 id="_idParaDest-298"><a id="_idTextAnchor302"/>Relation fields</h2>
			<p>The relation field<a id="_idIndexMarker834"/> widget allows you to search for and select a related record.</p>
			<p>It also allows you to open<a id="_idIndexMarker835"/> the related record's form or navigate to the corresponding form and create new records on the fly, also known as<strong class="bold"> quick create</strong>.</p>
			<p>These features can be disabled using the <code>options</code> field attribute:</p>
			<pre>options="{'no_open': True, 'no_create': True}"</pre>
			<p>The <code>context</code> and <code>domain</code> field attributes are particularly useful in relational fields:</p>
			<ul>
				<li><code>context</code> can set default values for related records that are created from the field.</li>
				<li><code>domain</code> limits the selectable records. A common example is for a field to have the selection options depend on the value of another field that's present in the form.</li>
			</ul>
			<p>To-many fields can also use the <code>mode</code> attribute to set the view types to use to display the records. A <code>tree</code> view is used by default, but other options include <code>form</code>, <code>kanban</code>, and <code>graph</code>. It can be a comma-separated list of view modes.</p>
			<p>Relation fields can include inline specific view definitions to use. These are declared as nested view definitions, inside the <code>&lt;field&gt;</code> element. For example, the <code>line_ids</code> checkout can define a specific list and form views for these lines:</p>
			<pre>&lt;notebook&gt; 
  &lt;page name="page_lines" string="Borrowed Books" &gt; 
    &lt;field name="line_ids"&gt; 
      &lt;tree&gt;
        &lt;field name="book_id" /&gt;
      &lt;/tree&gt;
      &lt;form&gt;
        &lt;field name="book_id" /&gt;
      &lt;/form&gt;
    &lt;/field&gt;
  &lt;/page&gt; 
&lt;/notebook&gt;</pre>
			<p>The line list <a id="_idIndexMarker836"/>will use the inline <code>&lt;tree&gt;</code> definition provided. When you click on a line, a <a id="_idIndexMarker837"/>form dialog will appear and use the structure in the inline <code>&lt;form&gt;</code> definition.</p>
			<p>We've seen everything that can be done with fields. The next most important view element is buttons, which are used to run actions.</p>
			<h1 id="_idParaDest-299"><a id="_idTextAnchor303"/>Using buttons</h1>
			<p>Buttons allow the user to trigger<a id="_idIndexMarker838"/> actions, such as opening another view or running business logic in a server function. They were introduced previously in this chapter, when we discussed the form header, but they can also be added anywhere in form and list views.</p>
			<p>Buttons support the <a id="_idIndexMarker839"/>following attributes:</p>
			<ul>
				<li><code>string</code> is the button text label, or the HTML <code>alt</code> text when an icon is used.</li>
				<li><code>type</code> is the type of action to perform. Possible values include <code>object</code>, to call a Python method, or <code>action</code>, to run a window action.</li>
				<li><code>name</code> identifies the specific action to perform, according to the chosen type: either a model method name or the database ID of a window action to run. The <code>%(&lt;xmlid&gt;)d</code> formula can be used to translate an XML ID into the necessary database ID when the view is being loaded.</li>
				<li><code>args</code> is used when <code>type="object"</code> is used to pass additional parameters to the method call.</li>
				<li><code>context</code> sets the values on the context. This could be used in the called method or affect the view that's opened by the windows action.</li>
				<li><code>confirm</code> is the text for a confirmation message box when the button is clicked. This is displayed before the action is run.</li>
				<li><code>special="cancel"</code> is used on wizard forms to add a <strong class="bold">Cancel</strong> button, which is used for closing the form without performing any action.</li>
				<li><code>icon</code> is an icon image to <a id="_idIndexMarker840"/>be shown in the button. The available icons are from the Font Awesome set and they should be specified using the corresponding CSS class, such as <code>icon="fa-question"</code>. For an icon reference, check out <a href="https://fontawesome.com/">https://fontawesome.com/</a>.<p class="callout-heading">Changes in Odoo 11</p><p class="callout">Before Odoo 11, the button icons were images that originated from the GTK client library and were limited to the ones available in <code>addons/web/static/src/img/icons</code>.</p><p class="callout">The workflow engine was deprecated and removed in Odoo 11. In previous versions, where workflows were supported, buttons could trigger workflow engine signals using <code>type="workflow"</code>. In this case, the <code>name</code> attribute was supposed to have a workflow signal name.</p></li>
			</ul>
			<p>A particular kind of button that's found at the top right area of some forms is called a <strong class="bold">smart button</strong>. Let's have a closer look at it.</p>
			<h2 id="_idParaDest-300"><a id="_idTextAnchor304"/>Using smart buttons</h2>
			<p>It's not uncommon for <a id="_idIndexMarker841"/>document forms to have a smart button area in the<a id="_idIndexMarker842"/> top-right section. Smart buttons are shown as rectangles with a statistic indicator that can be followed through when clicked.</p>
			<p>The Odoo UI pattern is to have an invisible box for smart buttons. This button box is usually the first element in <code>&lt;sheet&gt;</code> and looks like this:</p>
			<pre>&lt;div name="button_box" class="oe_button_box"&gt;
 <strong class="bold">&lt;!-- Smart buttons will go here... --&gt;</strong>
&lt;/div&gt;</pre>
			<p>The container for the buttons is just a <code>div</code> element with the <code>oe_button_box</code> class. In Odoo versions before 11.0, the <code>oe_right</code> class may also be needed to ensure that the button box stays aligned to the right-hand side of the form.</p>
			<p>For the library checkout module, a smart button will be added for the still open checkouts that are being made by this library member. The button should present a statistic with the count of those checkouts and, when clicked, should open a checkout list that contains those items.</p>
			<p>For the button <a id="_idIndexMarker843"/>statistic, a <a id="_idIndexMarker844"/>computed field needs to be created in the <code>library.checkout</code> model, in the <code>library_checkout/models/library_checkout.py</code> file:</p>
			<pre>    count_checkouts = fields.Integer(
        compute="_compute_count_checkouts")
    def _compute_count_checkouts(self):
        for checkout in self:
            domain = [
                ("member_id", "=", checkout.member_id.id),
                ("state", "not in", ["done", "cancel"]),
            ]
            checkout.count_checkouts = 
              self.search_count(domain)</pre>
			<p>The preceding computation loops through each checkout record to compute and runs a search query for that member, counting the number of open checkouts.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">The preceding implementation goes against a performance principle: don't do record search operations inside loops.</p>
			<p>For performance optimization, the search operation should be done in bulk, before the loop, and the result should be used inside the loop. An example of this implementation is shown next. This involves non-trivial code, so feel free to skip it if you feel it is too difficult to understand right now.</p>
			<p>The <code>read_group()</code> method can be used to get the grouped data. It returns a list of <code>dict</code> rows, such as <code>[{'member_id_count': 1, 'member_id': (1, 'John Doe'), …), …]</code>. It is hard to look up a <code>member_id</code> in this data structure. This lookup can become a trivial <a id="_idIndexMarker845"/>operation if the list of rows is converted into a dictionary that's <a id="_idIndexMarker846"/>mapping a <code>member_id</code> to a record count.</p>
			<p>Here is the alternative implementation, using these techniques:</p>
			<pre>    def _compute_count_checkouts(self):
        members = self.mapped("member_id")
        domain = [
            ("member_id", "in", members.ids),
            ("state", "not in ", ["done", "cancel"]),
        ]
        raw = self.read_group(domain, ["id:count"], 
          ["member_id"])
        data = {
            x["member_id"][0]: x["member_id_count"] for 
              x in raw
        }
        for checkout in self:
            checkout.count_checkouts = data.get(
                checkout.member_id.id, 0)</pre>
			<p>Now that there is a field computing the number to display, the smart button can be added to the view. Right at the top of the <code>&lt;sheet&gt;</code> section, replace the button box placeholder we added previously with the following code:</p>
			<pre>&lt;div name="button_box" class="oe_button_box"&gt;
  &lt;button type="action"
    name="%(action_library_checkout)d"
    class="oe_stat_button"
    icon="fa-book"
    domain="[('member_id', '=', member_id)]"
    context="{'default_member_id': member_id}"
  &gt;
    &lt;field name="count_checkouts"
      string="Checkouts" 
      widget="statinfo" /&gt;
  &lt;/button&gt;
&lt;/div&gt;</pre>
			<p>The <code>button</code> element itself is a container, and fields for displaying statistics should be added inside it. These statistics are regular fields that use a specific <code>statinfo</code> widget. The number of open checkouts is presented using the <code>count_checkouts</code> field, inside the button definition.</p>
			<p>The smart button<a id="_idIndexMarker847"/> must have the <code>class="oe_stat_button"</code> CSS style and <a id="_idIndexMarker848"/>should have an icon set with the <code>icon</code> attribute.</p>
			<p>In this case, it contains <code>type="action"</code>, meaning that a button runs a <em class="italic">window action</em>, as identified by the <code>name</code> attribute. The <code>%(action_library_checkout)d</code> expression returns the database ID for the action to run. This <em class="italic">window action</em> opens the checkout list. To ensure only the relevant records are displayed there, the <code>domain</code> attribute is used. And if a new record is created on that view, it is convenient that the current member is set as a default value. This can be done using the <code>default_member_id</code> key in the <code>context</code> attribute.</p>
			<p>For reference, these are the attributes that can be used with smart buttons:</p>
			<ul>
				<li><code>class="oe_stat_button"</code> renders a rectangle instead of a regular button.</li>
				<li><code>icon</code> sets the icon to use, as chosen from the <em class="italic">Font Awesome</em> set. Visit <a href="http://fontawesome.com">http://fontawesome.com</a> to browse the available icons.</li>
				<li><code>type</code> and <code>name</code> are the button type and the name of the action to trigger, respectively. For smart buttons, the type will usually be <code>action</code> for a <em class="italic">window action</em>, while <code>name</code> will be the ID of the action to execute. <code>"%(action-xmlid)d"</code> can be used to convert an XML ID into the needed database ID.</li>
				<li><code>string</code> adds label text to the button. It wasn't used in the preceding code example because the field is providing a text label.</li>
				<li><code>context</code> can be <a id="_idIndexMarker849"/>used to set default values on the target view, for <a id="_idIndexMarker850"/>new records that are created on the view that's being navigated from the button.</li>
				<li><code>help</code> adds a help tooltip that's displayed when the mouse pointer hovers over the button.</li>
			</ul>
			<p>Other than buttons and smart buttons, dynamic elements can be added to views to change the values or visibility of elements. This will be discussed in the next section.</p>
			<h1 id="_idParaDest-301"><a id="_idTextAnchor305"/>Adding dynamic view elements</h1>
			<p>View elements can<a id="_idIndexMarker851"/> dynamically change their appearance or behavior, depending on the field values. Field values can be dynamically set values of domain filters on other form fields through the <em class="italic">onchange</em> mechanism. These features will be discussed next.</p>
			<h2 id="_idParaDest-302"><a id="_idTextAnchor306"/>Using onchange events</h2>
			<p>The <strong class="bold">onchange</strong> mechanism <a id="_idIndexMarker852"/>allows us to trigger server logic while the user is modifying data on an unsaved form. For example, when setting the product field, a unit price on the same form can be automatically set.</p>
			<p>In older Odoo versions, the onchange events were defined at the view level, but since Odoo 8, they are declared directly on the model layer, without the need for any specific view markup. This can be done with methods that use the <code>@api.onchange('field1', 'field2', ...)</code> decorator. It binds onchange logic to the declared fields. The onchange model methods were discussed in more detail in <a href="B16119_08_Final_PD_ePub.xhtml#_idTextAnchor227"><em class="italic">Chapter 8</em></a>, <em class="italic">Business Logic – Supporting Business Processes</em>, and an example was discussed there.</p>
			<p>The onchange mechanism also takes care of automatically recalculating the computed fields, reacting immediately to user input. Continuing with the previous example, if the price field is changed, a computed field with the total amount would also be automatically updated with the new price information.</p>
			<h2 id="_idParaDest-303"><a id="_idTextAnchor307"/>Using dynamic attributes</h2>
			<p>View elements can have some attributes <a id="_idIndexMarker853"/>react to changes on field values; for example, to become visible or mandatory.</p>
			<p>The following attributes can be used to control the visibility of view elements:</p>
			<ul>
				<li><code>groups</code> make an element visible, depending on the security groups the current user belongs to. Only the members of the specified groups will see it. It expects a comma-separated list of group XML IDs.</li>
				<li><code>states</code> make an element visible, depending on the record's <code>state</code> field. It expects a comma-separated list of state values. Of course, the model must have a <code>state</code> selection field.</li>
				<li><code>attrs</code> can set both the invisible and required attributes based on certain conditions. It uses a dictionary, with <code>invisible</code>, <code>readonly</code>, and <code>required</code> as the possible keys. These keys map to a domain expression that evaluates to true or false.</li>
			</ul>
			<p>Here is an example of using <code>attrs</code>. To have the <code>closed_date</code> field only visible in the <code>done</code> state, the following code can be used:</p>
			<pre>&lt;field name="closed_date"
       attrs="{'invisible':[('state', 'not in', 
         ['done'])]}"
/&gt;</pre>
			<p>The <code>invisible</code> attribute is <a id="_idIndexMarker854"/>available in any element, not only fields. For example, it can also be used on notebook pages and <code>group</code> elements.</p>
			<p>The <code>readonly</code> and <code>required</code> attributes are only available for data fields and allow us to implement basic client-side logic, such as making a field mandatory while depending on other record values, such as the state.</p>
			<p>This closes our discussion of form views. However, there are still a few view types to explore. Next, we will discuss list/tree views.</p>
			<h1 id="_idParaDest-304"><a id="_idTextAnchor308"/>Exploring list views</h1>
			<p>List views are<a id="_idIndexMarker855"/> probably <a id="_idIndexMarker856"/>the most used view type, closely followed by form views. List views present records as lines and data fields as columns. By default, they are read-only, but they can also be made editable.</p>
			<p>The list view's basic definition is simple. It is a sequence of field elements inside a <code>&lt;tree&gt;</code> element. <code>library_checkout</code> already contains a simple list view, in the <code>views/checkout_view.xml</code> file, that looks like this:</p>
			<pre>  &lt;record id="view_tree_checkout" model="ir.ui.view"&gt;
    &lt;field name="name"&gt;Checkout Tree&lt;/field&gt;
    &lt;field name="model"&gt;library.checkout&lt;/field&gt;
    &lt;field name="arch" type="xml"&gt;
<strong class="bold">      &lt;tree&gt;</strong>
<strong class="bold">        &lt;field name="request_date" /&gt;</strong>
<strong class="bold">        &lt;field name="member_id" /&gt;</strong>
<strong class="bold">      &lt;/tree&gt;</strong>
    &lt;/field&gt;
  &lt;/record&gt;</pre>
			<p>A list view <a id="_idIndexMarker857"/>can contain fields and buttons, and the attributes that are described for forms<a id="_idIndexMarker858"/> are also valid in list views.</p>
			<p>Moving on from the basics, a few additional features can be used on list views. In the next section, we will introduce the new list header section. </p>
			<h2 id="_idParaDest-305"><a id="_idTextAnchor309"/>Adding a list view header section</h2>
			<p>Similar to form views, list views <a id="_idIndexMarker859"/>can also have a header section, where buttons can be added to perform actions on the model. The syntax is the same as for views.</p>
			<p>For example, there is a <strong class="bold">Send Messages</strong> option available in the <strong class="bold">Action</strong> menu. This is not directly visible to the users, and it can be made more visible as a header button.</p>
			<p>Editing the tree view to add this button looks like this:</p>
			<pre>      &lt;tree&gt;
<strong class="bold">        &lt;header&gt;</strong>
<strong class="bold">          &lt;button type="action"</strong>
<strong class="bold">            name="%(action_checkout_messag)d"</strong>
<strong class="bold">            string="Send Messages"</strong>
<strong class="bold">          /&gt;</strong>
<strong class="bold">        &lt;header&gt;</strong>
        &lt;field name="request_date" /&gt;
        &lt;field name="member_id" /&gt;
      &lt;/tree&gt;</pre>
			<p>The button actions work similarly to the <strong class="bold">Action</strong> menu options. The buttons are only visible when list records are selected.</p>
			<p class="callout-heading">New in Odoo 14</p>
			<p class="callout">The <code>&lt;header&gt;</code> element on list views was introduced in Odoo 14. This feature is not available in previous versions.</p>
			<p>In terms of<a id="_idIndexMarker860"/> the list view's content, rows can use different colors to highlight specific conditions to the user, such as a late activity in red. The next section explains how to use such decorations.</p>
			<h2 id="_idParaDest-306"><a id="_idTextAnchor310"/>Using line decoration</h2>
			<p>The following expanded <a id="_idIndexMarker861"/>version of the list adds a few additional fields, as well as some decorator attributes, to the <code>&lt;tree&gt;</code> root element:</p>
			<pre>      &lt;tree
        decoration-muted="state in ['done', 'cancel']"
        decoration-bf="state=='open'"
      &gt;
        &lt;header&gt;
          &lt;button type="action"
            name="%(action_checkout_messag)d"
            string="Send Messages"
          /&gt;
        &lt;header&gt;
        &lt;field name="state" invisible="True" /&gt;
        &lt;field name="name" /&gt;
        &lt;field name="request_date" /&gt;
        &lt;field name="member_id" /&gt;
        &lt;field name="stage_id" /&gt;
      &lt;/tree&gt;</pre>
			<p>The tree element is using two decoration attributes by using expressions with the <code>state</code> field. <code>decoration-muted</code> uses gray lines to show the done or canceled state. <code>decoration-bf</code> highlights the open state with bold lines.</p>
			<p>The fields that are used in these expressions must be declared in a <code>&lt;field&gt;</code> element of the view to ensure that the necessary data is retrieved from the server. If it doesn't need to be displayed, it can have the <code>invisible="1"</code> attribute set on it.</p>
			<p>The row's <a id="_idIndexMarker862"/>text color and font can change based on the evaluation of a Python expression. This can be done through the <code>decoration–NAME</code> attributes, which can be set with an expression to evaluate. The available attributes are as follows:</p>
			<ul>
				<li><code>decoration-bf</code> sets the font to bold.</li>
				<li><code>decoration-it</code> sets the font to italic.</li>
				<li><code>decoration-muted</code> sets the text color to gray.</li>
				<li><code>decoration-primary</code> sets the text color to a dark blue.</li>
				<li><code>decoration-success</code> sets the text color to a light blue.</li>
				<li><code>decoration-warning</code> sets the text color to yellow.</li>
				<li><code>decoration-danger</code> sets the text color to red.</li>
			</ul>
			<p>The preceding decoration names are based on the Bootstrap library. See <a href="https://getbootstrap.com/docs/3.3/css/#helper-classes">https://getbootstrap.com/docs/3.3/css/#helper-classes</a> for more details.</p>
			<p>Other than the decoration attributes, a few others are available to control the behavior of the list view.</p>
			<h2 id="_idParaDest-307"><a id="_idTextAnchor311"/>Other list view attributes</h2>
			<p>Some of the other <a id="_idIndexMarker863"/>relevant attributes of the tree element are as follows:</p>
			<ul>
				<li><code>default_order</code> is used to set a specific sort order for the rows. Its value is a comma-separated list of field names that's compatible with a SQL <code>ORDER BY</code> clause.</li>
				<li><code>create</code>, <code>delete</code>, and <code>edit</code>, if set to <code>false</code> (in lowercase), disable the corresponding action on the list view.</li>
				<li><code>editable</code> makes<a id="_idIndexMarker864"/> records editable directly on the list view. Possible values include <code>top</code> and <code>bottom</code>; that is, the location where the new records will be added.</li>
			</ul>
			<p>These attributes allow you to control the default row order and whether the record can be edited directly in the view.</p>
			<p>One more relevant feature is the ability to calculate totals and subtotals for list view columns, as shown in the next section.</p>
			<h2 id="_idParaDest-308"><a id="_idTextAnchor312"/>Adding column totals</h2>
			<p>List views also <a id="_idIndexMarker865"/>support column totals for numeric fields. Summary values can be displayed using one of the aggregation attributes that's available — <code>sum</code>, <code>avg</code>, <code>min</code>, or <code>max</code>.</p>
			<p>The aggregation attribute that's used should be set with label text for the summary value.</p>
			<p>For example, let's consider that the checkout model has added a field stating the number of borrowed books, <code>num_books</code>. To see the corresponding total sum on the list view, the following field element should be added:</p>
			<pre>    &lt;field name="num_books" sum="Num. Books" /&gt;</pre>
			<p>The <code>num_books</code> field counts the number of borrowed books in each checkout. It's a computed field, and we need to add it to the model:</p>
			<pre>    num_books = fields.Integer(compute=
      "_compute_num_books")
    @api.depends("line_ids")
    def _compute_num_books(self):
        for book in self:
            book.num_books = len(book.line_ids)</pre>
			<p>The group subtotal is only available for stored fields. So, in the previous example, <code>store=True</code> needs to<a id="_idIndexMarker866"/> be added if group subtotals are an important feature for the library app users.</p>
			<p>After form and list views, the next most important UI element is the search view, which lets us perform a default search and group by a filter.</p>
			<h1 id="_idParaDest-309"><a id="_idTextAnchor313"/>Exploring search views</h1>
			<p>At the top right of the<a id="_idIndexMarker867"/> view, there is a search box with a few buttons <a id="_idIndexMarker868"/>underneath it, including <strong class="bold">Filters</strong> and <strong class="bold">Group By</strong>. When you're typing in the search box, you will see suggestions regarding the field to be searched.</p>
			<p>The search options that are proposed are configured in the <strong class="bold">search view</strong>. The current search view can be inspected using the developer menu and by choosing the <strong class="bold">Edit ControlPanelView</strong> option.</p>
			<p>Search views are defined through the <code>&lt;search&gt;</code> view type. It can provide the following types of elements:</p>
			<ul>
				<li><code>&lt;field&gt;</code> elements to add filter options when typing in the search box.</li>
				<li><code>&lt;filter&gt;</code> elements to add predefined filters under the <strong class="bold">Filters</strong> and <strong class="bold">Group By</strong> buttons.</li>
				<li>A <code>&lt;searchpanel&gt;</code> element, to include a navigation tree on the left-hand side of the user interface.<p class="callout-heading">Changes in Odoo 13</p><p class="callout">The <code>&lt;searchpanel&gt;</code> widget for the list and Kanban views was introduced in Odoo 13 and is not available in earlier versions.</p></li>
			</ul>
			<p>To add these search options to the <code>library_checkout</code> module, edit the <code>views/checkout_view.xml</code> file and add the following record:</p>
			<pre>&lt;record id="view_filter_checkout" model="ir.ui.view"&gt; 
  &lt;field name="model"&gt;library.checkout&lt;/field&gt; 
  &lt;field name="arch" type="xml"&gt; 
<strong class="bold">    &lt;search&gt;</strong>
<strong class="bold">      &lt;!-- Add content here --&gt;</strong>
<strong class="bold">      &lt;field name="name" /&gt;</strong>
<strong class="bold">    &lt;/search&gt;</strong>
  &lt;/field&gt;
&lt;/record&gt;</pre>
			<p>Now, let's walk through each of the element types that can be added here. The <code>&lt;field&gt;</code> element will be explained next.</p>
			<h2 id="_idParaDest-310"><a id="_idTextAnchor314"/>Understanding the &lt;field&gt; element</h2>
			<p>When typing in the <a id="_idIndexMarker869"/>search box, the user will see suggestions that will let them apply this search to particular fields. These options are defined using <code>&lt;field&gt;</code> elements.</p>
			<p>For example, adding the following XML inside the <code>&lt;search&gt;</code> element will propose searching the text in additional fields:</p>
			<pre>      &lt;field name="name"/&gt;
      &lt;field name="member_id"/&gt;
      &lt;field name="user_id"/&gt;</pre>
			<p>This code adds search result suggestions for the <code>title</code>, <code>member</code>, and <code>user</code> fields.</p>
			<p>The search <code>&lt;field&gt;</code> elements can use the following attributes:</p>
			<ul>
				<li><code>name</code> is the field name to be searched.</li>
				<li><code>string</code> is the text label to use.</li>
				<li><code>operator</code> can be used as a comparison operator that's different from the default one; that is, <code>=</code> for numeric fields and <code>ilike</code> for the other field types.</li>
				<li><code>filter_domain</code> sets a specific domain expression to use for the search, providing one flexible alternative to the operator attribute. The searched text string is referred to in the expression as <code>self</code>. A trivial example is <code>filter_domain="[('name', 'ilike', self)]"</code>.</li>
				<li><code>groups</code> makes searching on the field available only to users that belong to some security groups. It expects a comma-separated list of XML IDs.</li>
			</ul>
			<p>These filters<a id="_idIndexMarker870"/> can be activated independently and will be joined by an <code>OR</code> logic operation. Blocks of filters separated with a <code>&lt;separator/&gt;</code> element will be joined by an <code>AND</code> logic operation.</p>
			<p>This section provided a good summary of how <code>&lt;field&gt;</code> elements can be used. Now, let's learn about the <code>&lt;filter&gt;</code> elements that are available.</p>
			<h2 id="_idParaDest-311"><a id="_idTextAnchor315"/>Understanding the &lt;filter&gt; element</h2>
			<p>Predefined options are <a id="_idIndexMarker871"/>available upon clicking the <strong class="bold">Filter</strong> and <strong class="bold">Group By</strong> buttons, under the search box. These can be clicked by users to apply their filter conditions.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Filter elements can also be used by window actions, which can activate them, by adding a <code>search_default_&lt;filter name&gt;: True</code> key to the context.</p>
			<p>Filter options can be added with the <code>&lt;filter&gt;</code> element, along with a <code>domain</code> attribute setting for specific search conditions to use, through a domain filter. The following is an example:</p>
			<pre>      &lt;filter name="filter_not_done"
              string="To Return"
              domain="[('state','=','open')]"/&gt;
      &lt;filter name="filter_my_checkouts"
              string="My Checkouts"
              domain="[('user_id','=',uid)]"/&gt;</pre>
			<p>This adds two selectable filters. They will be available for selection in the <code>open</code> state. The second one filters the checkout where the current user is the responsible librarian, filtering <code>user_id</code> by the current user. This is available from the context <code>uid</code> key.</p>
			<p>The filter element is<a id="_idIndexMarker872"/> also used to add options to the <strong class="bold">Group By</strong> button. Here is an example:</p>
			<pre>      &lt;filter name="group_user"
              string="By Member"
              context="{'group_by': 'member_id'}"/&gt;</pre>
			<p>This filter sets a <code>group by</code> context key with the field name to group by. In this case, it will group by  <code>member_id</code>.</p>
			<p>For the <code>&lt;filter&gt;</code> elements, the following attributes are available:</p>
			<ul>
				<li><code>name</code> is an identifier to be used for later inheritance/extension or to be enabled using a window action context key. It is not mandatory, but it is good practice to always provide it.</li>
				<li><code>string</code> is the label text to be displayed for the filter. It is mandatory.</li>
				<li><code>domain</code> is the domain expression to be added to the current domain.</li>
				<li><code>context</code> is a context dictionary to be added to the current context. It will usually be used to set the <code>group_by</code> key with the field name to group by.</li>
				<li><code>groups</code> makes this element field available only for a list of security groups (XML IDs).</li>
			</ul>
			<p>Upon adding the preceding code to the <code>library_checkout</code> module, the module will be upgraded. These filter and group by options will be available in the buttons near the search box.</p>
			<p>Another search view element that's available is the search panel. We'll look at this in the next section.</p>
			<h2 id="_idParaDest-312"><a id="_idTextAnchor316"/>Adding a search panel</h2>
			<p>Search views can also add a <a id="_idIndexMarker873"/>search panel, which will be visible on the left-hand side of the selected view. It lists the available values in a field. Clicking on a value filters the records by that value. By default, this search panel is only visible in the list and Kanban views, although this can be changed.</p>
			<p>The following code adds a search panel to the library checkout view. Add the following XML inside the <code>&lt;search&gt;</code> view element:</p>
			<pre>      &lt;searchpanel&gt;
        &lt;field name="member_id" enable_counters="1" /&gt;
        &lt;field name="stage_id" select="multi" /&gt;
      &lt;/searchpanel&gt;</pre>
			<p>The preceding code adds two fields to the search panel called members and stages. Each of them lists several available values, and clicking on these values applies the corresponding filter.</p>
			<p>The <code>&lt;searchpanel&gt;</code> element has one attribute available, <code>view_type</code>, that can set the view types where the panel is to be made visible. By default, its value is <code>view_type="tree,kanban"</code>.</p>
			<p>The <code>&lt;field&gt;</code> elements inside <code>&lt;searchpanel&gt;</code> support a few attributes. Here is a selection of the most important ones:</p>
			<ul>
				<li><code>string</code> sets specific label text to use.</li>
				<li><code>icon</code> sets an icon to be presented.</li>
				<li><code>color</code> sets the icon's color. It uses an HTML hex code, such as <code>#8F3A84</code>.</li>
				<li><code>select="multi"</code> adds selection checkboxes, which allow the user to select multiple values. This is only available for many-to-one and many-to-many fields.</li>
				<li><code>groups</code> sets a list XML IDs of the security groups that can see the search panel.</li>
				<li><code>enable_counters="1"</code> adds a record number counter next to each value. Beware that this can have a performance impact on the view.</li>
				<li><code>limit</code> sets the number of selected values that are allowed. The default is 200 and can be set to zero so that there's no limit.<p class="callout-heading">Changes in Odoo 13</p><p class="callout">The search panel element was introduced in Odoo 13 and is not available in previous versions.</p></li>
			</ul>
			<p>This is what the <a id="_idIndexMarker874"/>list view with the search panel looks like, after making these changes:</p>
			<div><div><img src="img/Figure_10.4_B16119.jpg" alt="Figure 10.4 – List view with the search panel&#13;&#10;" width="1179" height="391"/>
				</div>
			</div>
			<p class="figure-caption">Figure 10.4 – List view with the search panel</p>
			<p>The form, list, and search views are the most frequently used view types. But there are a few more view types that are available for designing our user interfaces. We'll look at these in the next section.</p>
			<h1 id="_idParaDest-313"><a id="_idTextAnchor317"/>Understanding the other available view types</h1>
			<p>The form and list <a id="_idIndexMarker875"/>views are essential user interface components, but other than them, a few other specific view types can be used.</p>
			<p>We're already familiar with the three basic views: <code>form</code>, <code>tree</code>, and <code>search</code>. Beyond these, the following view types are also available in Odoo Community Edition:</p>
			<ul>
				<li><code>kanban</code> presents <a id="_idIndexMarker876"/>records as cards that can be organized in columns to create Kanban boards.</li>
				<li><code>activity</code> presents <a id="_idIndexMarker877"/>a summary of scheduled activities.</li>
				<li><code>calendar</code> present <a id="_idIndexMarker878"/>records in a calendar format.</li>
				<li><code>graph</code> presents data <a id="_idIndexMarker879"/>as a graphical chart.</li>
				<li><code>pivot</code> presents<a id="_idIndexMarker880"/> data as an interactive pivot table.</li>
				<li><code>qweb</code> is used to <a id="_idIndexMarker881"/>declare QWeb templates to be used in reports, Kanban views, or web pages. However, this is not a web client-supported view type like forms and lists are.</li>
			</ul>
			<p>Kanban views will be presented in depth in <a href="B16119_11_Final_PD_ePub.xhtml#_idTextAnchor324"><em class="italic">Chapter 11</em></a>, <em class="italic">Kanban Views and Client-Side QWeb</em>, so they won't be addressed here.</p>
			<p class="callout-heading">Changes in Odoo 14</p>
			<p class="callout">The <code>diagram</code> view type, which could be used to present relationships between records, was removed in<a id="_idIndexMarker882"/> Odoo 14. The last piece of documentation that's available for this, for Odoo 13, can be found at <a href="https://www.odoo.com/documentation/13.0/developer/reference/addons/views.html#diagram">https://www.odoo.com/documentation/13.0/developer/reference/addons/views.html#diagram</a>.</p>
			<p>Odoo Enterprise Edition supports a few more views types:</p>
			<ul>
				<li><code>dashboard</code>, which <a id="_idIndexMarker883"/>presents aggregate data using subviews, such as pivots and graphs.</li>
				<li><code>cohort</code>, which is <a id="_idIndexMarker884"/>used to show how data changes over a certain period.</li>
				<li><code>map</code>, which presents<a id="_idIndexMarker885"/> records in a map and can display routes between them.</li>
				<li><code>Gantt</code>, which <a id="_idIndexMarker886"/>presents date scheduling information in a Gantt chart. This is commonly used in project management.</li>
				<li><code>grid</code>, which<a id="_idIndexMarker887"/> presents data organized in a grid with rows and columns.</li>
			</ul>
			<p>The official documentation provides good references to all of the views and their available attributes: https://www.odoo.com/documentation/15.0/developer/reference/backend/views.html#view-types.</p>
			<p class="callout-heading">Tip</p>
			<p class="callout">Additional view types can be found as community add-on modules. Under the Odoo Community Association umbrella, web client extensions, including view types and widgets, can be found in the <a href="https://github.com/OCA/web">https://github.com/OCA/web</a> GitHub repository. For example, the <code>web_timeline</code> add-on module provides a <code>timeline</code> view type, which is also capable of presenting scheduling information as Gantt charts. It is a Community Edition alternative to the <code>gantt</code> view type.</p>
			<p>The following sections provide a brief explanation of the additional view types that are available in Odoo Community Edition.</p>
			<h2 id="_idParaDest-314"><a id="_idTextAnchor318"/>Exploring the activity view</h2>
			<p>The activity <a id="_idIndexMarker888"/>view provides<a id="_idIndexMarker889"/> a summary of the scheduled activities. It is provided by the <code>mail</code> add-on module, so it needs to be installed for this view type to be available.</p>
			<p>It can be enabled by adding the <code>activity</code> view type to the <code>view_mode</code> field of the window action. From the <code>action_library_checkout</code> window action:</p>
			<pre>        &lt;field name="view_mode"&gt;tree,form<strong class="bold">,activity</strong>&lt;/field&gt;</pre>
			<p>If no view definition exists, one will be automatically generated.</p>
			<p>This is a simple definition that's equivalent to the default generated one:</p>
			<pre>&lt;record id="view_activity_checkout" model="ir.ui.view"&gt;
  &lt;field name="model"&gt;library.checkout&lt;/field&gt;
  &lt;field name="arch" type="xml"&gt;
<strong class="bold">     &lt;activity string="Checkouts"&gt;</strong>
<strong class="bold">       &lt;templates&gt;</strong>
<strong class="bold">         &lt;div t-name="activity-box"&gt;</strong>
<strong class="bold">           &lt;div&gt;</strong>
<strong class="bold">             &lt;field name="ntame" /&gt;</strong>
<strong class="bold">           &lt;/div&gt;</strong>
<strong class="bold">         </strong><strong class="bold">&lt;/div&gt;</strong>
<strong class="bold">       &lt;/templates&gt;</strong>
<strong class="bold">     &lt;/activity&gt;</strong>
  &lt;/field&gt;
&lt;/record&gt;</pre>
			<p>The <a id="_idIndexMarker890"/>HTML in<a id="_idIndexMarker891"/> the <code>&lt;templates&gt;</code> element is used to describe the record information.</p>
			<h2 id="_idParaDest-315"><a id="_idTextAnchor319"/>Exploring the calendar view</h2>
			<p>This view type presents the <a id="_idIndexMarker892"/>records in a calendar that can be viewed using <a id="_idIndexMarker893"/>different periods: per year, month, week, or day.</p>
			<p>This is a calendar view for the library checkouts that shows the items on a calendar according to their request date:</p>
			<pre>&lt;record id="view_calendar_checkout" model="ir.ui.view"&gt;
  &lt;field name="model"&gt;library.checkout&lt;/field&gt;
  &lt;field name="arch" type="xml"&gt;
<strong class="bold">    &lt;calendar date_start="request_date"</strong>
<strong class="bold">              </strong><strong class="bold">color="user_id"&gt;</strong>
<strong class="bold">      &lt;field name="member_id" /&gt;</strong>
<strong class="bold">      &lt;field name="stage_id" /&gt;</strong>
<strong class="bold">    &lt;/calendar&gt;</strong>
  &lt;/field&gt;
&lt;/record&gt;</pre>
			<p>The following <a id="_idIndexMarker894"/>attributes are supported by the calendar view:</p>
			<ul>
				<li><code>date_start</code> is the field for the start date (required).</li>
				<li><code>date_stop</code> is the field for the end date (optional).</li>
				<li><code>date_delay</code> in the field containing the duration in days. It is to be used instead of <code>date_end</code>.</li>
				<li><code>all_day</code> provides the name of a Boolean field that is to be used to signal full-day events. In these events, the duration is ignored.</li>
				<li><code>color</code> is the field that's used to color a group of calendar entries. Each distinct value in this field will be assigned a color, and all of its entries will have the same color.</li>
				<li><code>mode</code> is the default display mode for the calendar. It can be either <code>day</code>, <code>week</code>, <code>month</code>, or <code>year</code>.</li>
				<li><code>scales</code> is a <a id="_idIndexMarker895"/>comma-separated list of modes available. By default, they all are.</li>
				<li><code>form_view_id</code> can provide the identifier for a specific form view to use when you're opening records from the calendar view.</li>
				<li><code>event_open_popup="True"</code> opens the form view as a dialog window.</li>
				<li><code>quick_add</code> lets you quickly create a new record. Only a description needs to be given by the user.<p class="callout-heading">Changes in Odoo 11</p><p class="callout">The <code>display</code> calendar attribute was removed in Odoo 11. In previous versions, it could be used to customize the format of the calendar entry's title text; for example, <code>display="[name], Stage [stage_id]"</code>.</p></li>
			</ul>
			<p>For this view to be available in the <code>view_mode</code> area of the corresponding window with the <code>action_library_checkout</code> identifier:</p>
			<pre>&lt;field name="view_mode"&gt;tree,form<strong class="bold">,calendar</strong>&lt;/field&gt;</pre>
			<p>After making this module upgrade and reloading the page, the calendar view should be available.</p>
			<h2 id="_idParaDest-316"><a id="_idTextAnchor320"/>Exploring the pivot view</h2>
			<p>The data can also be seen in a <a id="_idIndexMarker896"/>pivot table; that is, a dynamic analysis matrix. For this, we<a id="_idIndexMarker897"/> have the pivot view.</p>
			<p>The <code>num_books</code> field will be used in the pivot view to add the checkouts model. Data aggregations are only available for database stored fields; this is not the case for the <code>num_books</code> field. So, it needs to be modified to add the <code>store=True</code> attribute:</p>
			<pre>    num_books = fields.Integer(
        compute="_compute_num_books",
        store=True)</pre>
			<p>To also add a pivot table to the library checkouts, use the following code:</p>
			<pre>&lt;record id="view_pivot_checkout" model="ir.ui.view"&gt;
  &lt;field name="model"&gt;library.checkout&lt;/field&gt;
  &lt;field name="arch" type="xml"&gt;
    &lt;pivot&gt;
      &lt;field name="stage_id" type="col" /&gt;
      &lt;field name="member_id" /&gt;
      &lt;field name="request_date" interval="week" /&gt;
      &lt;field name="num_books" type="measure" /&gt;
    &lt;/pivot&gt;
  &lt;/field&gt;
&lt;/record&gt;</pre>
			<p>The graph and pivot views should contain field elements that describe the axes and measures to use. Most of the <a id="_idIndexMarker898"/>available attributes are common to both view types:</p>
			<ul>
				<li><code>name</code> identifies the field to use in the graph, just like in other views.</li>
				<li><code>type</code> is how the field will be used; that is, as a <code>row</code> group (default),  <code>measure</code>, or <code>col</code> (only for pivot tables; it is used for column groups).</li>
				<li><code>interval</code> is meaningful <a id="_idIndexMarker899"/>for date fields and is the time interval that's used to group time data by <code>day</code>, <code>week</code>, <code>month</code>, <code>quarter</code>, or <code>year</code>.</li>
			</ul>
			<p>Other than these essential attributes, more are available and are documented at <a href="https://www.odoo.com/documentation/15.0/developer/reference/backend/views.html#pivot">https://www.odoo.com/documentation/15.0/developer/reference/backend/views.html#pivot</a>.</p>
			<p>For this view to be available in the <code>view_mode</code> area of the <code>action_library_checkout</code> window action:</p>
			<pre>&lt;field name="view_mode"&gt;tree,form<strong class="bold">,pivot</strong>&lt;/field&gt;</pre>
			<p>After making this module upgrade and reloading the page, the calendar view should be available.</p>
			<h2 id="_idParaDest-317"><a id="_idTextAnchor321"/>Exploring the graph view</h2>
			<p>Graph views present charts <a id="_idIndexMarker900"/>with data aggregations. The available charts include <a id="_idIndexMarker901"/>bar, line, and pie charts.</p>
			<p>Here is an example of a graph view for the checkout model:</p>
			<pre>&lt;record id="view_graph_checkout" model="ir.ui.view"&gt;
  &lt;field name="model"&gt;library.checkout&lt;/field&gt;
  &lt;field name="arch" type="xml"&gt;
    &lt;graph type="bar"&gt;
      &lt;field name="stage_id" /&gt;
      &lt;field name="num_books" type="measure" /&gt;
    &lt;/graph&gt;
  &lt;/field&gt;
&lt;/record&gt;</pre>
			<p>The <code>graph</code> view element can have a <code>type</code> attribute that can be set to <code>bar</code> (the default), <code>pie</code>, or <code>line</code>. In the case of <code>bar</code>, the additional <code>stacked="True"</code> element can be used to make it a stacked bar chart.</p>
			<p>The graph uses two types of fields:</p>
			<ul>
				<li><code>type="row"</code> is the default and sets the criteria to aggregate values.</li>
				<li><code>type="measure"</code> is used for the fields that are to be used as metrics – that is, the actual values being aggregated.</li>
			</ul>
			<p>Most of the <a id="_idIndexMarker902"/>available graph <a id="_idIndexMarker903"/>view attributes are common to the pivot view type. The official documentation provides a good reference: <a href="https://www.odoo.com/documentation/15.0/developer/reference/backend/views.html#reference-views-graph">https://www.odoo.com/documentation/15.0/developer/reference/backend/views.html#reference-views-graph</a>.</p>
			<p>For this view to be available in the <code>view_mode</code> area of the <code>action_library_checkout</code> window action:</p>
			<pre>&lt;field name="view_mode"&gt;tree,form<strong class="bold">,graph</strong>&lt;/field&gt;</pre>
			<p>After making this module upgrade and reloading the page, the calendar view should be available.</p>
			<h1 id="_idParaDest-318"><a id="_idTextAnchor322"/>Summary</h1>
			<p>Well-designed views are key for a good user experience. Applications need to support the business logic, but an easy-to-use user interface is also important to help users navigate efficiently through the business processes and minimize errors.</p>
			<p>The Odoo web client provides a rich set of tools to build such user interfaces. This includes a menu system, several view types, and different field widgets to choose from.</p>
			<p>Adding menu items is the first step, and these use window actions to let the web client know what views should be presented.</p>
			<p>Most of the user interaction will happen on form views, and it is important to understand all the elements that can be used there. We started by presenting the general structure that form views are expected to follow, as well as the elements to be added to each.</p>
			<p>This includes the header section, the title fields, the other form fields, a possible notebook section with pages, and a final messaging area.</p>
			<p>Record data is presented and modified using field elements. Details were presented on how to use them and the several options that can be used to adjust their presentation. Another important element is buttons, which allow us to navigate to other views or run server functions.</p>
			<p>The next view type we discussed was the list view. While simpler than the form view, it is an important record navigation tool. The search view was also discussed and is useful for adding predefined filter and grouping options to the search box area. This is important for users to quickly access the data that's needed for their regular operations.</p>
			<p>Finally, an overview was provided of the other view types available, such as the pivot, graph, and calendar views. There are used less often, but they still have an important role in specific cases.</p>
			<p>In the next chapter, we'll learn more about a specific view type that we've not covered in this chapter: the Kanban view and the templating syntax that's used by it, QWeb.</p>
			<h1 id="_idParaDest-319"><a id="_idTextAnchor323"/>Further reading</h1>
			<p>The following reference materials complement the topics that were described in this chapter:</p>
			<ul>
				<li>The official Odoo documentation:<ul><li>On actions: <a href="https://www.odoo.com/documentation/15.0/developer/reference/backend/actions.html%20">https://www.odoo.com/documentation/15.0/developer/reference/backend/actions.html</a></li><li>On views: <a href="https://www.odoo.com/documentation/15.0/developer/reference/backend/views.html">https://www.odoo.com/documentation/15.0/developer/reference/backend/views.html</a></li></ul></li>
				<li>The Font Awesome icon index: <a href="https://fontawesome.com/v4.7.0/icons/">https://fontawesome.com/v4.7.0/icons/</a></li>
			</ul>
		</div>
	</div></body></html>