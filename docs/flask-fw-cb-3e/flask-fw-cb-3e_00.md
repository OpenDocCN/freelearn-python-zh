# 前言

Flask，这个轻量级的 Python Web 框架，因其强大的模块化设计而受到欢迎，这使得你可以构建可扩展的 Web 应用程序。通过这本基于食谱的指南，你将探索使用 Flask 构建 Web 应用程序的现代解决方案和最佳实践。

本版更新至 Flask 2.2.x 和 Python 3.11.x 的最新版本，这是《Flask 框架食谱》的第三版，它摒弃了一些旧的和过时的库，并引入了关于前沿技术的食谱。你将发现使用 Flask 创建、部署和管理微服务的不同方法。

本书通过一系列食谱带你了解 Flask 及其扩展的强大功能。你将从探索 Flask 应用程序可以利用的不同配置开始。从这里，你将学习如何处理模板，然后了解 ORM 和视图层，它们是 Web 应用程序的基础。接着，你将学习如何使用 Flask 编写 RESTful API，在学习了各种认证技术之后。

随着你继续前进，你将学习如何编写管理界面，随后是 Flask 中的调试和错误记录。你还将学习如何使你的应用程序多语言，并深入了解各种测试技术。你将了解在 Apache、Tornado、NGINX、Gunicorn、Sentry、New Relic 和 Datadog 等平台上的不同部署和部署后技术。最后，你将了解一些流行的微服务工具，如 Docker、Kubernetes、Google Cloud Run 和 GitHub Actions，这些工具可以用来构建高度可扩展的服务。

新增了一章关于当前引起轰动的最新技术——那就是 GPT。在这里，你将了解一些简单、基本但强大的 GPT 实现，用于构建自动文本补全字段、聊天机器人和 AI 驱动的图像生成。在完成本书之前，你将了解一些额外的技巧和窍门，这些技巧和窍门将有助于处理特定用例，例如全文搜索、缓存、电子邮件和异步操作。

到本书结束时，你将拥有使用这个令人难以置信的微框架所需的所有信息，无论是编写小型还是大型应用程序，都可以使用行业标准进行扩展。

# 本书面向对象

如果你是一名希望学习更多关于在 Flask 中开发可扩展和可生产的应用程序的 Web 开发者，这本书就是为你准备的。即使你已经熟悉 Flask 的主要扩展并希望将它们用于更好的应用程序开发，这本书也会很有用。如果你需要快速查阅 Flask、其流行的扩展或某些特定用例的任何特定主题，这本书也会很有帮助。假设你具备基本的 Python 编程经验，并对 Web 开发及其相关术语有一定的了解。

# 本书涵盖内容

*第一章*，*Flask 配置*，解释了 Flask 可以以不同的方式配置，以适应任何项目的各种需求。它首先告诉我们如何设置开发环境，然后继续介绍不同的配置技术。

*第二章*，*使用 Jinja 进行模板化*，从 Flask 的角度介绍了 Jinja2 模板化的基础知识，并解释了如何使用模块化和可扩展的模板来创建应用程序。

*第三章*，*Flask 中的数据建模*，处理了任何应用程序最重要的部分之一——即它与数据库系统的交互。我们将看到 Flask 如何连接到不同的数据库系统，定义模型，以及查询数据库以检索和提供数据。

*第四章*，*与视图一起工作*，讨论了网络框架的核心。它讲述了如何与网络请求交互以及对这些请求的适当响应。它涵盖了处理请求的各种正确方法以及最佳设计方式。

*第五章*，*使用 WTForms 进行 Web 表单*，涵盖了表单处理，这是任何 Web 应用程序的重要部分。尽管表单很重要，但它们的验证同样重要，甚至更重要。以交互式方式向用户展示这些信息可以为应用程序增添很多价值。

*第六章*，*在 Flask 中进行身份验证*，讨论了身份验证，它是应用程序安全与不安全的红线。它详细介绍了多种社交和企业登录技术。身份验证是任何应用程序的重要部分，无论是基于网络的、桌面还是移动的。

*第七章*，*构建 RESTful API*，解释了 REST 作为协议，然后讨论了使用库以及完全自定义的 API 为 Flask 应用程序编写 RESTful API。API 可以概括为开发人员访问应用程序的接口。

*第八章*，*Flask 应用的 Admin 界面*，专注于为 Flask 应用程序编写管理视图。首先，我们将编写完全自定义的视图，然后借助扩展来编写它们。与非常流行的基于 Python 的网络框架 Django 不同，Flask 默认不提供管理界面。尽管这可能会被许多人视为缺点，但这给了开发者根据其需求创建管理界面的灵活性，并完全控制应用程序。

*第九章*，*国际化与本地化*，扩展了 Flask 应用的范围，并涵盖了如何启用对多种语言支持的基本知识。Web 应用通常不仅限于一个地理区域，也不限于服务于一个语言领域的人。例如，旨在为欧洲用户设计的 Web 应用将需要支持其他欧洲语言，如德语、法语、意大利语、西班牙语等，而不仅仅是英语。

*第十章*，*调试、错误处理和测试*，从完全面向开发转向测试我们的应用。有了更好的错误处理和测试，应用的健壮性会大大提高，调试使开发者的生活更加轻松。了解我们的应用有多健壮，以及它如何工作并表现，非常重要。当应用出现问题时，及时得到通知是非常必要的。测试本身是一个非常大的主题，有数本书籍专门讨论它。

*第十一章*，*部署和部署后*，介绍了应用可以部署的各种方式和工具。然后，你将了解应用监控，这有助于我们跟踪应用性能。应用的部署和管理部署后的应用与开发它一样重要。部署应用的方式有很多，选择最佳方式取决于需求。

*第十二章*，*微服务和容器*，探讨了如何使用 Docker 打包 Flask 应用，并使用 Kubernetes 进行部署。我们还将看到如何通过利用 Google Cloud Run 和 GitHub Actions 以无服务器的方式提供服务。*微服务*是现代软件技术中最热门的术语之一。它们既实用又受欢迎，使开发者的生活更加轻松。它们允许人们专注于开发，而不是将时间花在思考应用的部署上。

*第十三章*，*使用 Flask 的 GPT*，实现了 GPT 中最受欢迎、最常见且功能强大的 API，用于构建带有 Flask 的 AI 应用。我们将看到如何使用 GPT 自动化文本补全，以构建高度用户直观的搜索字段。然后，演示了一个简单的使用 ChatGPT 的聊天机器人实现，接着是 AI 驱动的图像生成。

*第十四章*，*额外技巧和窍门*，介绍了一些可以用来增加应用价值的额外食谱，如果需要的话。

# 要充分利用这本书

您需要在计算机上安装 *Python* 作为先决条件。本书中的所有代码都是在基于 UNIX 的操作系统 *macOS* 或 *Ubuntu* 上的 *Python 3.11.x* 上编写和测试的。本书使用 *Flask 2.2.x*，并非所有代码都适用于 Flask 和/或 Python 的早期版本。然而，除非引入了破坏性更改，否则大多数代码应该适用于未来的版本。对于其他相关的包或库，版本号在相关食谱中直接提及。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Python 3.11.x | Windows、macOS 或 Linux |
| Flask 2.2.x | Windows、macOS 或 Linux |

有一些食谱专注于一些付费的 SaaS 软件，例如 *Sentry*、*New Relic*、*Datadog*、**亚马逊网络服务**（**AWS**）、**谷歌云平台**（**GCP**）、*GitHub* 和 *OpenAI (GPT)*。尽管它们都存在试用版或免费版，但如果您超过了免费限制，可能需要购买它们。

**如果您正在使用本书的数字版，我们建议您亲自输入代码或从本书的 GitHub 仓库（下一节中有一个链接）获取代码。这样做将帮助您避免与代码的复制和粘贴相关的任何潜在错误。**

# 下载示例代码文件

您可以从 GitHub（[`github.com/PacktPublishing/Flask-Framework-Cookbook-Third-Edition`](https://github.com/PacktPublishing/Flask-Framework-Cookbook-Third-Edition)）下载本书的示例代码文件。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有其他来自我们丰富的图书和视频目录的代码包可供下载，请访问[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)。查看它们！

# 下载彩色图像

我们还提供了一份包含本书中使用的截图和图表的彩色图像的 PDF 文件。您可以从这里下载：[`packt.link/KWUib`](https://packt.link/KWUib)。

# 使用的约定

本书使用了多种文本约定。

`文本中的代码`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“在先前的代码中，首先从给定路径加载实例文件夹；然后，从给定实例文件夹中的 config.cfg 文件加载配置文件。”

代码块设置如下：

```py
PRODUCTS = {
    'iphone': {
        'name': 'iPhone 5S',
        'category': 'Phones',
        'price': 699,
},
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```py
from flask_wtf.file import FileField, FileRequired
class Product(db.Model):
    image_path = db.Column(db.String(255))
    def __init__(self, name, price, category, image_path):
        self.image_path = image_path
```

任何命令行输入或输出都按以下方式编写：

```py
$ sudo apt update 
$ sudo apt install python3-dev 
$ sudo apt install apache2 apache2-dev
```

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词以**粗体**显示。以下是一个示例：“它还可以处理**记住我**功能、账户恢复功能等。”

小贴士或重要注意事项

看起来是这样的。

# 联系我们

我们始终欢迎读者的反馈。

`customercare@packtpub.com`，并在邮件主题中提及书籍标题。

**勘误表**：尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们非常感谢您能向我们报告。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

`copyright@packt.com`，并附上相关材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享您的想法

一旦您阅读了《Flask 框架食谱》，我们非常乐意听到您的想法！请[点击此处直接转到该书的 Amazon 评论页面](https://packt.link/r/1-804-61110-7)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载本书的免费 PDF 副本

感谢您购买这本书！

您喜欢在移动中阅读，但无法携带您的印刷书籍到任何地方吗？

您的电子书购买是否与您选择的设备不兼容？

不要担心，现在，随着每本 Packt 书籍，您都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何设备上阅读。直接从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠不会就此停止，您还可以获得独家折扣、时事通讯和每日免费内容的每日邮箱访问权限。

按照以下简单步骤获取福利：

1.  扫描二维码或访问以下链接

![](img/B19111_QR_Free_PDF.jpg)

https://packt.link/free-ebook/9781804611104

1.  提交您的购买证明

1.  就这样！我们将直接将您的免费 PDF 和其他福利发送到您的邮箱

# 第一部分：Flask 基础

正如名称所示，本书的这一部分专注于任何 Flask 网络应用程序的基本构建块。对这些主题有清晰的理解对于使用 Flask 构建可扩展、可配置和可扩展的网络应用程序至关重要，随着我们转向更复杂的话题。

开发者通常在如何设置他们的 Flask 应用程序配置以适应不同环境（如开发和生产）方面感到困难。有时，他们可能会发现很难选择最佳的方式来构建他们的 Flask 应用程序。第一章有助于回答这些问题以及更多。

接下来的三章将重点介绍任何网络应用程序的基础支柱——即，模型、视图和模板。这些章节中涵盖的一个非常重要的概念是连接多种类型的数据库与您的应用程序。

这些章节的内容在复杂度上将是基础到中级，它将为本书下一部分的更复杂用例提供基础。

在本书的第一部分结束时，你将能够创建一个功能齐全的 Flask 应用程序，它将具有基本功能。

本部分包含以下章节：

+   *第一章**，Flask 配置*

+   *第二章**，使用 Jinja 模板化*

+   *第三章**，Flask 中的数据建模*

+   *第四章**，与视图一起工作*
