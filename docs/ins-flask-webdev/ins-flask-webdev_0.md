# 前言

Flask 作为一个项目开始，向您展示如何在现有的 Python 工具包上构建自己的框架。实际上，Flask 最初是在 2010 年愚人节时作为一个玩笑开始的。Python 社区中出现了几个微框架，它们提供了自己的接口集，可以在一个`.py`文件中完全构建 Web 服务和应用程序。Armin Ronacher 构建了 Werkzeug（一个 Web 编程工具包）和 Jinja（一个模板引擎），将这两个项目压缩成一个 zip 文件，将 zip 文件进行 base64 编码，放入一个`.py`文件中，添加了一些小函数，然后将其称为**Denied**微框架。

Denied 的 4 月 1 日营销网站包括几行代码中的“Hello World”应用程序，一个恶搞的视频演示，一些虚假的推荐，零文档，以及一些暗示您不应该相信互联网上的一切。Denied 是对开源项目如何出错的批评-主要是通过缺少文档和设计缺陷，这可能会在生产程序中引起严重问题。

这就是 Flask 的开始，一个怀着良好意图的微框架。Flask 旨在通过清晰、简单的接口、有用的文档、完整的测试套件以及对生产问题和版本间向前/向后兼容性的深思熟虑，提供良好的开发者体验。Flask 演示了如何在 Werkzeug 和 Jinja 的基础上构建一个薄层。然后 Flask 自己变得流行起来，发展了一个社区，现在有几个基于 Flask 构建的应用程序正在生产中使用，大小不一。

作为 Flask 项目的贡献者，我观察到大多数新用户提出的问题是“使用 Flask 的方式是什么？”大多数情况下，问题更好地陈述为“使用 Python 的方式是什么？”Flask 在使用方式上没有太多选择，这使得它成为一个很好的工具，可以简单地开始，并在项目变得庞大时谨慎地发展，而不必与嵌入在框架中的选项进行斗争。

也就是说，当您开始使用 Flask 时，您会想知道一个典型的应用程序是什么样子。这本书将向您展示这一点。我将我的 Flask 经验压缩成一个小而完整的应用程序，我们将一步一步地从底层构建。在此过程中，我将提供一些建议，帮助您考虑自己项目中的问题。如果在阅读本书结束时，您还想了解更多，请查看我们构建的调度应用程序，确定您想要设计自己改进的领域，并将这些领域用于练习您的 Web 开发技能。

# 本书涵盖的内容

*为开发做准备（简单）*解释了如何设置开发环境，并确保您已经准备好使用 Python 和 Flask 开发 Web 项目所需的一切。

*运行简单应用程序（简单）*展示了如何使用最简单的“Hello World” Flask 应用程序进行热身。

*路由 URL 和接受请求（简单）*展示了如何根据您的 URL 规则接受 Web 请求来启动您的项目。

*处理请求和响应（简单）*解释了 Flask 如何处理 Web 请求以及如何构建响应。

*处理静态文件*（简单）解释了如何将磁盘上的文件作为响应发送。

*使用数据库*（简单）解释了如何声明数据结构，将数据存储到应用程序中，并使用 SQLAlchemy 管理查询。

*处理表单和文件上传*（简单）解释了如何使用 WTForms 构建一个与应用程序数据结构匹配的表单，提供 HTML 输入并验证用户输入。

*使用 Jinja 进行模板设置-设置基本模板*（简单）解释了如何设置应用程序的基本 HTML 结构，使用 Twitter Bootstrap 提供页面结构和主题样式，使用 jQuery 进行 JavaScript 页面操作。

*创建新记录*（中级）解释了如何提供一个 Web 表单来创建数据库记录。

*显示记录*（中级）解释了如何从数据库中检索记录并在 HTML 中显示它。

*编辑记录*（中级）解释了如何提供一个 Web 表单来编辑现有的数据库记录。

*列出所有记录*（简单）解释了如何构建一个索引视图，在 HTML 中显示来自数据库的所有记录。

*删除记录*（高级）解释了如何添加一个 JavaScript 触发的`DELETE`请求来从数据库中删除记录。

*在 Jinja 中使用自定义模板过滤器*（高级）解释了如何扩展 Jinja 以包括数据的自定义显示格式。

*发送错误响应*（简单）解释了如何使用样式化的 HTML 页面响应错误。

*用户认证*（高级）解释了如何构建一个用户数据模型，其中包括一个哈希密码字段，用于验证只有用户才知道的凭据。

*处理会话和用户*（中级）解释了如何在身份验证后保持用户登录以进行持续请求。

*部署到世界*（高级）解释了如何在 Ubuntu 上使用 nginx 和 gunicorn 发布您的应用程序，并指出如何使用 HTTP 代理在任何操作系统上部署。

# 本书适用对象

本书假定您已经具备 Python 和对网页开发的兴趣。您需要了解或愿意学习一些 Python 和一些网页技术，如 HTTP、HTML、CSS 和 JavaScript。本书专门涵盖了使用 Flask 进行网页开发，这是 Python 编程语言的第三方软件包。如果您是 Python 或网页开发的新手，请确保有 Python 语言和各种网页技术的良好资源。

在撰写本文时，Flask 的版本为 0.10，稳定且可用于生产。从一开始，Flask 项目已经尽最大努力保持向后兼容性，并提供了主要版本发布的升级说明。请参阅[`pypi.python.org/pypi/Flask`](https://pypi.python.org/pypi/Flask)获取最新版本和 Flask 的安装说明。

本书使用**virtualenv**来安装第三方软件包，在撰写本文时为 1.9 版本。请注意，virtualenv 1.9 在安装软件包时添加了 SSL 支持，因此如果您已经安装了 virtualenv，请务必升级。请参阅[`pypi.python.org/pypi/virtualenv`](https://pypi.python.org/pypi/virtualenv)获取最新版本和 virtualenv 的说明。

### 注意

本书同时使用 Python 2.7 和 Python 3.3。

在撰写本文时，Flask 在其 0.10 版本中支持 Python 3.3+。然而，社区中可用的软件包并不总是支持 Python 3。我鼓励您在项目中使用 Python 3。Python 社区仍在向 Python 3 过渡，这与 Python 2 不兼容，但现在投资于 Python 3 将使您能够使用现代 Python 扩展您的代码库，其中新功能正在被添加到语言中。

如果您使用的是**CPython**之外的 Python 实现，如**pypy**，请下载 Flask 源代码并运行其测试，以验证 Flask 与您的解释器兼容。

其他材料列在*准备开发*配方下的*开发环境清单*部分。

# 本书适用对象

本书适用于新手网页编程或熟悉网页编程但是新手 Flask 的读者。本书适用于三类读者：

+   刚开始进行网页开发的程序员，从对 Python 的兴趣开始，逐渐掌握如何构建网页应用程序的工作知识

+   熟悉网页开发的程序员，从熟悉如何在熟悉的语言中构建应用程序（可能是 Python 也可能不是）的工作知识开始，向 Flask 在日常工作中的使用

+   决定学习编程的设计师，从用户界面设计开始，逐渐构建出一个自建的功能应用程序。

在这三种情况下，Flask 都非常适合作为 Python Web 开发的起点，而 Python 作为一种语言对于刚开始学习编程的读者来说是易于接触的。

# 惯例

在本书中，您将找到一些文本样式，用以区分不同类型的信息。以下是一些这些样式的示例，以及它们的含义解释。

文本中的代码词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 句柄显示如下：“这将创建一个 Python 对象`app`，它是一个 WSGI 应用程序。”

代码块设置如下：

```py
from flask import Flask

app = Flask(__name__)

@app.route('/')
def hello():
    return 'Hello, world!'

if __name__ == '__main__':
    app.run()
```

当我们希望引起您对代码块的特定部分的注意时，相关行或项目以粗体显示：

```py
from flask import Flask

app = Flask(__name__)

@app.route('/')
def hello():
    return 'Hello, world!'

if __name__ == '__main__':
    app.run()
```

任何命令行输入或输出都是这样写的：

```py
$ python manage.py runserver –t 0.0.0.0 –p 8080

```

**新术语**和**重要单词**以粗体显示。屏幕上看到的单词，例如菜单或对话框中的单词，以这种方式出现在文本中：“我们重用与创建表单相同的模板，但我们用**编辑**代替**添加**。”

### 注意

警告或重要提示出现在这样的框中。

### 提示

提示和技巧看起来像这样。
