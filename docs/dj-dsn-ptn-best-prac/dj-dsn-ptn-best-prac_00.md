# 前言

Django 是当今最受欢迎的 Web 框架之一。它为大型网站提供动力，例如 Pinterest、Instagram、Disqus 和 NASA。只需几行代码，您就可以快速构建一个功能齐全且安全的网站，可以扩展到数百万用户。

本书试图分享解决 Django 开发人员面临的几个常见设计问题的解决方案。有时，有几种解决方案，但我们经常想知道是否有推荐的方法。经验丰富的开发人员经常使用某些习惯用法，同时故意避免其他一些习惯用法。

本书是这些模式和见解的集合。它分为几章，每章涵盖框架的一个关键领域，例如模型，或 Web 开发的一个方面，例如调试。重点是构建清洁、模块化和更易维护的代码。

我们已经尽力提供最新信息并使用最新版本。Django 1.7 充满了令人兴奋的新功能，例如内置模式迁移和应用程序重新加载。Python 3.4 是该语言的最前沿，具有几个新模块，例如 asyncio。这两者都在这里使用了。

超级英雄是本书中的一个不断出现的主题。大多数代码示例都是关于构建 SuperBook——一个超级英雄的社交网络。作为呈现 Web 开发项目挑战的一种新颖方式，每章都以故事框的形式编织了一个令人兴奋的虚构叙述。

# 本书涵盖的内容

第一章，“Django 和模式”，通过告诉我们为什么创建 Django 以及它如何随着时间的推移而发展，帮助我们更好地理解 Django。然后，介绍设计模式、其重要性和几种流行的模式集合。

第二章，“应用程序设计”，指导我们通过应用程序生命周期的早期阶段，例如收集要求和创建模型。我们还将看到如何通过我们的运行项目 SuperBook 将项目分解为模块化应用程序。

第三章，“模型”，让我们了解模型如何以图形方式表示，使用几种模式进行结构化，并使用迁移（内置于 Django 1.7）进行后续更改。

第四章，“视图和 URL”，向我们展示了如何将基于函数的视图演变为具有强大混合概念的基于类的视图，使我们熟悉有用的视图模式，并教会我们如何设计简短而有意义的 URL。

第五章，“模板”，通过 Django 模板语言构造，解释其设计选择，建议如何组织模板文件，介绍方便的模板模式，并指出几种集成和自定义 Bootstrap 的方法。

第六章，“管理界面”，向我们展示了如何更有效地使用 Django 出色的开箱即用的管理界面，以及多种自定义方式，从增强模型到改进其默认外观和感觉。

第七章，“表单”，说明了常常令人困惑的表单工作流程，以及渲染表单的不同方式，如何使用 crispy forms 改善表单的外观以及各种应用表单模式。

第八章，“处理遗留代码”，解决了遗留 Django 项目的常见问题，例如确定正确的版本、定位文件、从何处开始阅读大型代码库，以及如何通过添加新功能来增强遗留代码。

第九章，“测试和调试”，概述了各种测试和调试工具和技术，介绍了测试驱动开发、模拟、日志记录和调试器。

第十章，*安全性*，使您熟悉各种 Web 安全威胁及其对策，特别是 Django 如何保护您。最后，一个方便的安全性检查表提醒您常常被忽视的领域。

第十一章，*准备投产*，介绍了部署面向公众的应用程序的速成课程，从选择 Web 堆栈开始，了解托管选项，并走过典型的部署过程。我们在这个阶段深入了解监控和性能的细节。

附录，*Python 2 与 Python 3*，向 Python 2 开发人员介绍了 Python 3。首先展示了最相关的差异，然后在 Django 中工作时，我们转向 Python 3 中提供的新模块和工具。

# 本书需要什么

您只需要一台计算机（PC 或 Mac）和互联网连接即可开始。然后，请确保已安装以下内容：

+   Python 3.4（或 Python 2.7，在阅读附录之后，*Python 2 与 Python 3*）或更高版本

+   Django 1.7 或更高版本

+   文本编辑器（或 Python IDE）

+   Web 浏览器（请使用最新版本）

我建议使用基于 Linux 的系统，如 Ubuntu 或 Arch Linux。如果您使用 Windows，可以使用 Vagrant 或 VirtualBox 在 Linux 虚拟机上工作。这里有一个充分的披露：我更喜欢命令行界面、Emacs 和荷包蛋。

某些章节可能需要安装特定的 Python 库或 Django 包。它们将被提及，比如说`factory_boy`包。在大多数情况下，它们可以使用`pip`进行安装，如下所示：

```py
$ pip install factory_boy
```

因此，强烈建议您首先创建一个单独的虚拟环境，如第二章中所述，*应用程序设计*。

# 这本书是为谁准备的

本书旨在帮助开发人员洞察使用 Django 构建高度可维护的网站。它将帮助您更深入地了解框架，但也会使您熟悉几个 Web 开发概念。

它对于初学者和有经验的 Django 开发人员都很有用。它假设您熟悉 Python，并已完成了 Django 的基本教程（尝试官方的投票教程或来自[`arunrocks.com`](http://arunrocks.com)的视频教程）。

您不必是 Django 或 Python 的专家。阅读本书不需要对模式有先验知识。更具体地说，本书不是关于经典的四人帮模式，尽管它们可能会被提及。

这里的许多实用信息可能不仅仅适用于 Django，而是适用于 Web 开发。在本书结束时，您应该是一个更高效和务实的 Web 开发人员。

# 惯例

在本书中，您会发现许多文本样式，用于区分不同类型的信息。以下是一些这些样式的示例，以及它们的含义解释。

文本中的代码词、文件夹名称、文件名、包名称和用户输入显示如下：“`HttpResponse`对象被呈现为字符串。”

代码块设置如下：

```py
from django.db import models

class SuperHero(models.Model):
    name = models.CharField(max_length=100)
```

任何命令行（通常是 Unix）的输入或输出都写成如下形式：

```py
$ django-admin.py --version
1.6.1

```

以美元提示符（$符号）开头的行是要在 shell 中输入的（但跳过提示本身）。其余行是系统输出，如果输出非常长，可能会使用省略号（…）进行修剪。

每个章节（除了第一章）都将有一个故事框，样式如下：

### 注意

**超级书籍章节标题**

那是一个漆黑而风雨交加的夜晚；披着斗篷的超级英雄的剪影在烧焦的里克森数字图书馆的废墟中移动。捡起一块看起来像是半融化的硬盘盒；显而易见队长咬紧牙关喊道：“我们需要备份！”

故事框最好按顺序阅读，以遵循线性叙事。

本书中描述的模式以《本书中的模式》一节中提到的格式编写，位于第一章 *Django 和模式* 中。

提示和最佳实践的风格如下：

### 提示

最佳实践

每 5 年更换你的超级服装。

**新术语**和**重要单词**以粗体显示。
