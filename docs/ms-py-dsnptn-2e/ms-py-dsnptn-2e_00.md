# 前言

使用这本综合指南，在 Python 编程语言的背景下探索设计原则和设计模式的世界。了解经典和现代设计模式以及如何使用它们来解决作为 Python 开发人员或软件架构师在日常工作中遇到的问题。 

通过代码示例、现实世界的案例研究和详细的解决方案实现，本书是希望提升编程技能的 Python 开发者的必读之作。本书由拥有二十多年经验的 Python 专家合著，新版本扩大了范围，涵盖了更多设计模式类别。深入了解现代软件设计的重要模式，如并发、异步和性能模式，包括创建型、结构型、行为型、架构型和其他模式。学习如何在事件处理系统、并发、分布式系统和测试等各个领域应用这些模式。本书还介绍了 Python 反模式，帮助你避免常见的陷阱。

无论你是在开发用户界面、Web 应用、API、数据管道还是 AI 模型，本书都为你提供了构建健壮和可维护软件的知识。

本书采用实践导向的方法，为每个设计模式提供代码示例。每一章都包括逐步指导来测试代码，使其成为互动式学习体验。对于每个设计原则或模式，本书至少提供一个现实世界的例子，这个例子可能基于 Python，也可能不是，以及至少一个基于 Python 的例子。

# 本书面向对象

本书面向希望深化对设计模式及其在各种类型项目中应用理解的 Python 开发者。本书专注于中级和高级 Python 程序员，还包括入门章节，使其对相对较新的语言用户也易于理解。无论你是 Web 开发者、数据工程师还是 AI 专家，本书都提供了基于现实世界例子和几十年经验的软件设计最佳实践的有价值见解。它也是软件架构师和团队领导者的优秀资源，他们希望提高项目中的代码质量和可维护性。

# 本书涵盖内容

*第一章*，*基础设计原则*，涵盖了封装、组合、面向接口编程和松耦合的原则，以帮助你创建更适应性和可维护的系统。

*第二章*，*SOLID 原则*，提供了设计健壮、可维护和可扩展软件的指南。这些原则中的每一个都有助于创建干净和可适应的代码。

*第三章*，*创建型设计模式*，探讨了帮助通过控制要实例化的类来管理对象创建的模式。

*第四章*，*结构设计模式*，提供了通过识别建立实体之间关系的简单方法来促进设计过程的见解。本章深入探讨了六个基本结构模式，为您提供高效且优雅地构建代码的技能。

*第五章*，*行为设计模式*，分享了关注对象交互和职责的模式，促进有效沟通和灵活分配职责。本章探讨了关键模式，如策略、观察者和命令，展示了它们如何简化对象协作并增强代码的适应性。

*第六章*，*架构设计模式*，深入探讨了提供解决常见架构问题模板的模式，促进可扩展、可维护和可重用系统的开发。

*第七章*，*并发和异步模式*，探讨了有助于开发既快速又用户友好的应用程序的模式，尤其是在具有大量 I/O 操作或重大计算工作的环境中。

*第八章*，*性能模式*，提供了针对常见瓶颈和优化挑战的指导，提供了经过验证的方法来提高执行时间、减少内存使用并有效扩展。

*第九章*，*分布式系统模式*，展示了使开发者能够构建健壮分布式系统的模式，从管理节点间的通信到确保容错性和一致性。

*第十章*，*测试模式*，介绍了有助于隔离组件、提高测试可靠性和促进代码重用性的模式。

*第十一章*，*Python 反模式*，探讨了虽然不一定错误，但往往导致代码效率低下、可读性差和/或可维护性差的常见编程实践。您将学会理解和避免这些陷阱。

# 要充分利用这本书

使用装有最新版 Windows、Linux 或 macOS 的机器。

安装 Python 3.12。从 Python 安装中创建一个虚拟环境也很有用，这样当您添加一些章节所需的第三方模块时，就不会污染您的全局 Python。这是使用 Python 提高生产力的基本最佳实践，您将在互联网上找到许多解释如何做到这一点的资源。

在您的机器上安装和使用 Docker。这将有助于满足某些外部软件服务或工具的需求，例如 LocalStack（用于*第六章*）和 Redis 服务器（用于*第八章*）。

| **本书涵盖的软件/硬件** | **操作系统要求** |
| --- | --- |
| Python 3.12 | Windows、macOS 或 Linux |
| MyPy 1.10.0 |  |
| Docker |  |
| Redis-server 6.2.6 |  |
| LocalStack 3.4.0 |  |

如果你使用的是这本书的数字版，我们建议你亲自输入代码或从书的 GitHub 仓库（下一节中有一个链接）获取代码。这样做将帮助你避免与代码复制和粘贴相关的任何潜在错误。

# 下载示例代码文件

你可以从 GitHub 下载本书的示例代码文件：[`github.com/PacktPublishing/Mastering-Python-Design-Patterns-Third-Edition`](https://github.com/PacktPublishing/Mastering-Python-Design-Patterns-Third-Edition)。如果代码有更新，它将在 GitHub 仓库中更新。

我们还有其他丰富的图书和视频的代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

# 使用的约定

在整本书中使用了多种文本约定和格式化特定要求。

## 大部分代码已经自动格式化

格式化使用的是 Black 工具，这是 Python 开发者为了提高生产力而通常使用的。因此，它可能看起来并不完全像你自己写的代码。但是它是有效的；它是一个 PEP 8 兼容的代码。目标是提高代码片段的可读性。

因此，代码文件以及书页上的某些代码片段可能看起来如下：

```py
State = Enum(
    "State",
    "NEW RUNNING SLEEPING RESTART ZOMBIE",
)
```

另一个例子可能是以下内容：

```py
msg = (
    f"trying to create process '{name}' "
    f"for user '{user}'"
)
print(msg)
```

## 书页上的代码片段可能会缩短

为了提高可读性，当函数或类的文档字符串（docstring）过长时，我们从书中的代码片段中移除它。

当某些代码（类或函数）太长而无法在章节页面上显示时，我们可能会缩短它，并指导读者查看文件中的完整代码。

注意

如果长命令因多行而分散（以‘`/`’字符为分隔符），你可以重新格式化长命令文本，移除‘`/`’字符，以确保命令在终端中正确解释。

## 其他约定

`Code in text`: 表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。以下是一个示例：“使用`log`方法定义`Logger`接口。”

代码块按照以下方式设置：

```py
class MyInterface(ABC):
    @abstractmethod
    def do_something(self, param: str):
        pass
```

任何命令行输入或输出都按照以下方式编写：

```py
python3.12 –m pip install -–user mypy
```

粗体：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词以粗体显示。以下是一个示例：“这是面向对象编程（OOP）的核心概念之一，它使单个接口能够表示不同的类型。”

小贴士或重要注意事项

它看起来像这样。

# 联系我们

我们欢迎读者的反馈。

一般反馈：如果您对本书的任何方面有疑问，请通过 customercare@packtpub.com 给我们发邮件，并在邮件主题中提及书名。

错误清单：尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，如果您能向我们报告，我们将不胜感激。请访问[www.packtpub.com/support/errata](http://www.packtpub.com/support/errata)并填写表格。

盗版：如果您在互联网上以任何形式发现我们作品的非法副本，如果您能提供位置地址或网站名称，我们将不胜感激。请通过 copyright@packt.com 与我们联系，并提供材料的链接。

如果您有兴趣成为作者：如果您在某个主题上具有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问[authors.packtpub.com](http://authors.packtpub.com)。

# 分享你的想法

一旦您阅读了《精通 Python 设计模式》，我们很乐意听到您的想法！请[点击此处直接转到该书的亚马逊评论页面](https://packt.link/r/1837639612)并分享您的反馈。

您的评论对我们和科技社区非常重要，并将帮助我们确保我们提供高质量的内容。

# 下载本书的免费 PDF 副本

感谢您购买本书！

你喜欢在路上阅读，但又无法携带你的印刷书籍到处走？

你的电子书购买是否与您选择的设备不兼容？

不要担心，现在，随着每本 Packt 书籍，你都可以免费获得该书的 DRM 免费 PDF 版本。

在任何地方、任何地点、任何设备上阅读。直接从您最喜欢的技术书籍中搜索、复制和粘贴代码到您的应用程序中。

优惠不会就此停止，您还可以获得独家折扣、时事通讯和每日收件箱中的精彩免费内容。

按照以下简单步骤获取优惠：

1.  扫描二维码或访问以下链接

![](img/B21896_QR_Free_PDF.jpg)

[`packt.link/free-ebook/9781837639618`](https://packt.link/free-ebook/9781837639618)

2. 提交你的购买证明

3. 就这样！我们将直接将您的免费 PDF 和其他优惠发送到您的电子邮件地址

# 第一部分：从原则开始

这一部分向您介绍了基础软件设计原则以及建立在它们之上的 S.O.L.I.D.原则。本部分包括以下章节：

+   *第一章*, *基础设计原则*

+   *第二章*, *SOLID 原则*
