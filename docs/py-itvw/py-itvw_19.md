# 第十九章。迈克·贝耶

![迈克·贝耶](img/B08180_06_01.jpg)

迈克·贝耶（Mike Bayer）是一位美国软件开发者，同时也是红帽（Red Hat）的高级软件工程师，该公司销售开源软件产品。他之前的工作经历包括在许多纽约的互联网公司，如 MLB.com。他还曾在美国职业棒球大联盟（Major League Baseball）从事内容管理软件的开发工作。迈克是多个 Python 开源编程库的创造者，例如 SQLAlchemy，这是一个 SQL 工具包和对象关系映射器。他通过推广良好的数据库软件实践在 Python 社区中发挥着积极作用。迈克是 PyCon US 和欧洲较小会议的常客演讲者。

> **讨论主题：SQLAlchemy、AI、v2.7/v3.x。**
> 
> **在这里了解迈克·贝耶的最新动态：@zzzeek**

**迈克·德里斯科尔（Mike Driscoll）**：是什么让你成为了一名程序员？

**迈克·贝耶**：我从 1980 年开始对电脑产生兴趣，那时我第一次接触到早期的个人电脑。我试图用汇编语言学习早期的 8 位电脑的游戏编程，但并没有取得太大的成功。在高中时，我接触到了 Pascal 语言中的数据结构和过程式编程。

我觉得成为一名程序员似乎是顺理成章的，但结果却是，我从计算机工程转到了音乐专业，并且有几年时间完全没接触过电脑。我发现自己在公告板上与其他程序员竞争过于激烈，而且我不喜欢自己变成的样子。

我重新回到电脑行业纯粹是因为这是我能吃饭和付房租的唯一方式。大约在那个时期，互联网成为了一个商业行业，我立即参与了那种工作。

一旦第一个互联网泡沫出现，纽约市的程序员突然变得紧张而兴奋。每个人都想让你为他们工作。编程的竞争性实际上多年来一直给我带来持续的问题。我不得不努力减少这个问题。

**德里斯科尔（Driscoll）**：你是如何开始接触 Python 的？

**贝耶（Bayer）**：我的 Python 之前的大部分职业生涯都是在使用 Perl、Java 和一点 C 进行编程。我非常热衷于面向对象的应用程序设计，并最终经历了一个深度的架构宇航员阶段，这在 1990 年代末和 2000 年代初的 Java 程序员中非常普遍。

我喜欢脚本语言的想法，因为它们允许你直接跳入文本文件。你会得到一些可以立即工作而不需要 Java 那种正式性、样板和编译步骤的东西。因此，我也花了很多时间试图在 Perl 中实现面向对象设计，但这并不令人满意。

> **迈克·贝耶：'拒绝接受大量空白符的几年后，我终于开始接触 Python。'**

我意识到 Python 可能真的能够在两个世界之间找到一个平衡点。在拒绝接受大量空白符的几年后，我终于开始接触 Python，并意识到这门语言实际上是我一直在寻找的一切。

**迈克·德里斯科尔**：Python 对你来说有什么特别之处？

**拜耳**：给我留下深刻印象的是 Python 的这种方式，即你的解释器中的所有东西都是 Python 对象，包括你导入的所有模块。

现在，这种看待事物的方式对我来说已经习以为常了。但当我第一次了解到我可以像查看更多数据一样检查程序本身的元素时，我所接触到的所有其他语言都完全不一样。

Python 非常容易理解，尤其是在我花费多年时间真正弄不懂 Perl 的 use 语句之后。我还观察到 Python 在脚本语言中一般不常见的对一致性和正确性的强调。

我预测，我将与之合作的 Python 程序员将比我之前接触到的开发者质量更高，因为他们被 Python 所吸引！结果证明这完全正确。

**德里斯科尔**：那么是什么启发了你创建 SQLAlchemy？

**拜耳**：嗯，我一直有一个目标，就是找出我想在哪个编程语言中安家。在这个语言中，我想构建一套完整的工具，我可以用它来做任何事情。我想能够独立行动，为人们构建应用程序。

> **迈克·拜耳**：“我想能够独立行动，为人们构建应用程序。”

在我的各种工作中，我总是不得不创建某种类型的数据库抽象层，然后在许多项目中使用它。我总是在使用我所使用的任何语言构建小型模板引擎、微型 Web 框架和数据库抽象层，并试图为所有项目标准化。

当我开始接触 Python 时，我对当时可用的 Web 框架工具和数据库抽象工具并不满意。我之前也已经编写了许多模板引擎和数据库访问工具，所以我有很多想法。

> **迈克·拜耳**：“当我开始接触 Python 时，我对当时可用的 Web 框架工具和数据库抽象工具并不满意。”

我首先编写了一个名为 Myghty 的模板引擎，它是 Perl 模板引擎 HTML::Mason 的几乎逐行移植。Myghty 很糟糕，但它还是获得了一些短暂的流行，并成为了 Pylons Web 框架第一个版本的基石。

当我开始编写 SQLAlchemy 时，我采取了非常深入和缓慢的方法，试图让它变得非常出色。在那个阶段，我作为一个程序员，尤其是作为一个 Python 程序员，仍然有很多缺陷。早期的 SQLAlchemy 有很多糟糕的设计选择，但它仍然以其真正独特和可能非常出色的特性而闪耀。第一次看到工作单元执行刷新时，我感到非常惊讶。我意识到这件事可能对人们有深远的影响。

**德里斯科尔**：那么 Mako 是如何产生的？

**Bayer**：Mako 非常简单地被创建出来，以取代 Myghty 及其所有糟糕的设计选择，这样 Pylons 就可以有一个不那么令人尴尬的模板引擎。

Mako 原本打算成为一个非常强大和稳定的模板引擎，一旦完成就可以基本让它自行发展。虽然 Mako 在多年中增加了更多功能，但我已经认为它在很多年前就已经完成了。我仍然在使用 Mako，但我很高兴 Jinja2 成为 Python 事实上的模板引擎。毕竟，Armin Ronacher 将 Mako 的架构归功于他创建 Jinja2 的许多灵感来源。

> **Mike Bayer**：“我仍然使用 Mako，但我很高兴 Jinja2 成为 Python 的事实上的模板引擎。”

**Driscoll**：如果你能重新开始使用 SQLAlchemy，你会做些什么不同的事情？

**Bayer**：我犯了一些错误，这些错误最终极大地促进了项目的发展。所以，如果我没有犯这些错误，我不确定事情会怎样发展。

我之前提到的关于竞争性的问题，导致我在早期与一些贡献者有不良的互动。驱逐那些有良好想法的人，在很多情况下，比我所看到的问题更清晰，这是一个巨大的错误。

我也应该花更多的时间阅读其他 Python 代码，并提高使用正确的惯用模式的技能，而不是在我了解 Python 的新知识后，不得不回过头来修复所有代码。

如果我能重新开始使用 SQLAlchemy，我也会做其他不同的事情。在 0.1 版本中有很多设计模式，我试图在 0.2 或 0.3 版本中消除这些模式。我无法完全去除这些模式。

版本 0.1 在核心和 ORM 级别都严重依赖于对象与数据库连接的隐式关联。如今，其中两种模式仍然以绑定元数据和无连接执行的形式存在。这些模式仍然非常受欢迎，但与基于明确性的新模式相比，继续产生微妙的混淆。

> **Mike Bayer**：“如果我现在从我所知的一切开始，SQLAlchemy 一开始就会更接近目标。”

这些年来，许多其他 API 模式都经历了大幅度的修订。如果我现在从我所知的一切开始，那么 SQLAlchemy 一开始就会更接近目标。在早期版本中也就没有必要经历重大的 API 更改。

我也应该及早认识到需要一个良好的 SQL 迁移工具的需求，尽管 sqlalchemy-migrate 在处理这个问题上做得很好，直到我有时间创建 Alembic 迁移。

**Driscoll**：从创建开源项目中，你学到了什么？

**贝耶**：嗯，首先，如果你的开源项目变得流行，那么它永远不会结束。如果你的项目与某些不断变化的技术相关联，比如 Python 数据库 API，那么你的工作将永远不会完成。

> **迈克·贝耶：'如果你的开源项目变得流行，那么它永远不会结束。'**

我完全没有想到，修复 bug 的速度会保持恒定超过十年。我还了解到，要在开源领域取得成功，你确实需要很多运气。你必须足够幸运，在正确的时间做项目。我比社区中的大多数人更早地接触到了 Python，并在最佳时机发布了我的软件。

最后，我学到了很多关于当用户想要某个功能或行为 X 时必须应用的微积分知识。你真的不能仅仅根据他们的字面意思来对待他们。通常，当用户认为他们想要 X 时，他们实际上想要 Y。有时他们认为他们想要 X，但他们没有充分考虑其后果。

你在添加 X 时必须非常小心。同时，你不想让用户因为拒绝他们的功能请求而感到不高兴。最重要的是，作为维护者，你需要尽可能有礼貌。这非常困难，因为很多用户都很无礼且自以为是。尽管如此，对此进行发泄也毫无益处。

**德里斯科尔**：我们看到 Python 在人工智能和机器学习中被大量使用。你认为为什么 Python 是这种应用如此出色的语言？

**贝耶**：我们在该领域所做的是开发我们的数学和算法。我们将我们肯定想要保留和优化的算法放入 scikit-learn 等库中。然后我们继续迭代并分享我们如何组织和思考数据的笔记。

> **迈克·贝耶**：'高级脚本语言非常适合人工智能和机器学习，因为我们可以快速移动事物并再次尝试。我们创建的代码大部分行数都用于表示实际的数学和数据结构，而不是样板代码。'

高级脚本语言非常适合人工智能和机器学习，因为我们可以快速移动事物并再次尝试。我们创建的代码大部分行数都用于表示实际的数学和数据结构，而不是样板代码。

类似 Python 这样的脚本语言甚至更好，因为它既严格又一致。每个人都能比在其他一些具有混乱和不一致编程范式的语言中更好地理解彼此的 Python 代码。

工具如 IPython 笔记本的可用性使得在全新的层面上迭代和分享我们的数学和算法成为可能。Python 强调我们试图做的核心工作，并最大限度地减少我们如何向计算机下达指令的其他所有方面，这正是它应该做的。自动化你不需要思考的事情。

> **迈克·贝耶**：'自动化你不需要思考的事情。'

**德里斯科尔**：你认为 Python 如何能成为人工智能和机器学习更好的语言？

**贝耶**：机器学习是一个 CPU 密集型任务，因此我们需要继续迭代如何更好地利用所有这些处理器核心，不幸的是，这意味着全局解释器锁（GIL）。目前，唯一的方法是使用多进程。

> **迈克·贝耶：'Python 仍然缺少一个合适的并发范式。'**

Python 仍然缺少一个介于线程和进程之间的合适的并发范式，其中线程意味着 Python 的动态合约意味着我们有一个 GIL，而进程则涉及到如何共享数据的复杂性和成本。可能有一个类似于多进程的解释器概念会有所帮助，但它在单个进程空间内完成。这个概念将使用操作系统级别的线程，同时仍然将进程隔离到足够程度，以至于它们不共享同一个 GIL。

**德里斯科尔**：你会给一个刚开始学习编程的人什么建议？

**贝耶**：在计算机编程中有很多传统智慧。你应该总是对传统智慧进行考验。

> **迈克·贝耶：'你应该总是对传统智慧进行考验。'**

在编程中存在一些规则，比如不要使用可变的全局变量，这些规则实际上更像是为初学者准备的训练轮。它们是好的规则，其中包含了很多真理，但它们并不适用于所有情况。

当你从初学者成长为更高级的程序员时，你想要能够独立思考。你还想通过寻找新颖和创造性的方法来解决问题来积累经验。这些想法可能并不总是有效，但建立一个核心实践，即始终挑战现状，希望有一天你能找到解决某个问题的绝佳新方案。

**德里斯科尔**：你会推荐哪种语言给一个刚开始编程的人？

**贝耶**：我认为 Python 是我见过的最好的入门语言。在你编程的前几年里，你只需使用 Python，你很可能还会用到 JavaScript，因为浏览器是不可避免的。

在某个时候，编写某种脚本语言解释器或编译器也是一个很好的主意。理解在高级别声明的指令，如 Python 函数，如何最终表现为 CPU 执行的指令，是一个必须拥有的视角。

**德里斯科尔**：今天，Python 有什么让你最兴奋的？

**贝耶**：我很兴奋地看到 Python 正在成为几乎每个想要用数据做有思想的工作的人首选的语言，尤其是在新闻领域。

> **迈克·贝耶：'我期待着一群既能编写 Python 代码又能撰写标题的记者。'**

新闻业正变得更加数据驱动，我期待着新一代记者，他们既能编写 Python 代码，也能撰写标题。我们需要能够从底层产生基于数据的故事的记者。这样，随着需求的增加，可能会有更多的数据可用。想象一下，每次我们在《华盛顿邮报》上阅读故事时，那里也有一份 IPython 笔记本，我们可以用它来分析故事中的数据。

**Driscoll**: 现在人们应该放弃 Python 2.7 吗？

**Bayer**: 从 Python 2.7 迁移是一个会自行解决的问题。我认为在数据领域，人们现在肯定是从 3.x 系列开始的。在我工作的基础设施领域，我们理解地需要更长的时间才能达到那里，但我们会的。

> **贝耶**: 从 Python 2.7 迁移是一个会自行解决的问题。我认为在数据领域，人们现在肯定是从 3.x 系列开始的。

**Driscoll**: 你希望在未来 Python 版本中看到哪些变化？

**Bayer**: 老实说，我希望未来对 `asyncio` 系统的重视程度降低，我认为这是一个被广泛误解的 API。

新程序员开始他们的项目时，使用异步技术从头到尾构建整个系统。因此，他们创建的带有错误和过于复杂的应用程序，其性能并不比使用传统技术更好。

异步 I/O 确实有它的位置，但在几乎任何实际应用中，它应该仅限于处理与外部资源和客户的交互。这应该只发生在外部数据交互的规模非常广泛且并发时（例如，抓取成千上万的网站，或等待成千上万的客户端的命令）。

我们应用程序的核心引擎（那些与本地数据交互并执行我们的业务逻辑和算法的），应该使用传统的多线程编写。异步和同步组件可以很好地互相通信，然而程序员需要很好地理解这两种范式。当前的异步文化根本不强调这一点。

**Driscoll**: 谢谢，迈克·贝耶。
