# 前言

这是一本关于软件工程原则应用于 Python 的书。

关于软件工程有很多书籍，也有很多关于 Python 的信息资源。然而，这两个集合的交集需要行动，这就是这本书试图弥补的差距。

在一本书中涵盖软件工程的所有可能主题是不现实的，因为这个领域是如此广阔，以至于有整本书专门讨论某些主题。这本书侧重于软件工程的主要实践或原则，这些实践或原则将帮助我们编写更易于维护的代码，并且同时利用 Python 的特性来编写它。

智者之言：解决软件问题没有单一的解决方案。通常涉及权衡。每种解决方案都有优势和劣势，必须遵循一些标准来在它们之间进行选择，接受成本并获得收益。通常没有单一的最佳解决方案，但有原则可循，只要我们遵循这些原则，我们就会走上更安全的道路。这本书的目的就是激励读者遵循原则并做出最佳选择，因为即使面临困难，如果我们遵循良好的实践，我们也会好得多。

说到良好的实践，虽然一些解释遵循已建立和经过验证的原则，其他部分则是主观的。但这并不意味着只能以这种特定的方式来完成。作者并不声称自己是任何一种清洁代码的权威，因为这样的头衔根本不存在。鼓励读者进行批判性思考：采用最适合您项目的方法，并且可以自由地提出异议。鼓励不同的观点，只要它们能产生启发性的辩论。

我写这本书的目的是分享 Python 的乐趣，以及我从经验中学到的习惯用法，希望读者会发现它们对提高他们的语言专业知识有用。

这本书通过代码示例来解释主题。这些示例假定在撰写本文时使用的是 Python 的最新版本，即 Python 3.7，尽管未来版本也应该兼容。代码中没有任何将其绑定到特定平台的特殊性，因此使用 Python 解释器，可以在任何操作系统上测试代码示例。

在大多数示例中，为了尽可能保持代码简单，实现及其测试都是使用纯 Python 编写的，只使用标准库。在一些章节中，需要额外的库，并且为了运行这些案例的示例，已经提供了相应的`requirements.txt`文件的说明。

在本书中，我们将发现 Python 提供的所有功能，使我们的代码更好，更易读，更易于维护。我们不仅通过探索语言的特性来做到这一点，还通过分析软件工程实践如何应用于 Python 来实现。读者会注意到 Python 中一些参考实现的不同之处，其他原则或模式略有变化，有些甚至可能根本不适用。理解每种情况都代表着更深入地了解 Python。

# 这本书适合谁

这本书适合所有对软件设计感兴趣或想了解更多关于 Python 的软件工程从业者。假定读者已经熟悉面向对象软件设计原则，并具有一定的编写代码经验。

就 Python 而言，本书适合所有级别的读者。它适合学习 Python，因为它以递增的复杂性组织内容。最初的章节将涵盖 Python 的基础知识，这是学习主要习语、函数和语言中可用的实用程序的好方法。这个想法不仅仅是用 Python 解决一些问题，而是以一种惯用的方式来解决问题。

有经验的程序员也会从本书的主题中受益，因为一些部分涵盖了 Python 中的高级主题，如装饰器、描述符和异步编程的介绍。它将帮助读者更多地了解 Python，因为其中一些案例是从语言本身的内部分析的。

值得强调的是本节第一句中的“从业者”一词。这是一本务实的书。示例仅限于案例研究所需的内容，但也意在类似于真实软件项目的背景。这不是一本学术书，因此所做的定义、备注和建议应以谨慎的态度对待。读者应该以批判和务实的态度来审视这些建议，而不是教条地接受。毕竟，实用性胜过纯粹。

# 本书涵盖的内容

第一章《介绍、代码格式和工具》是介绍你需要设置 Python 开发环境的主要工具。我们涵盖了 Python 开发人员建议了解的基础知识，以及一些维护项目中可读代码的指南，如静态分析工具、文档、类型检查和代码格式化。

第二章《Pythonic Code》探讨了 Python 中的第一个习语，我们将在接下来的章节中继续使用。我们涵盖了 Python 的特定特性，以及它们应该如何使用，并开始建立围绕 Pythonic 代码通常更高质量的代码的知识。

第三章《良好代码的一般特征》回顾了专注于编写可维护代码的软件工程的一般原则。我们探讨了这个想法，并应用了语言中的工具。

第四章《SOLID 原则》涵盖了面向对象软件设计的一组设计原则。这个首字母缩略词是软件工程的术语或行话的一部分，我们看到它们每一个如何应用到 Python 中。由于语言的性质，可以说并非所有原则都完全适用。

第五章《使用装饰器改进我们的代码》探讨了 Python 最伟大的特性之一。在理解如何创建装饰器（用于函数和类）之后，我们将它们应用于重用代码、分离责任和创建更细粒度的函数。

第六章《使用描述符更充分地利用我们的对象》探讨了 Python 中的描述符，它将面向对象设计提升到一个新的水平。虽然这是一个更与框架和工具相关的特性，但我们可以看到如何通过描述符来提高我们代码的可读性，并重用代码。

第七章《使用生成器》表明生成器可能是 Python 最好的特性。迭代是 Python 的核心组件，这可能让我们认为它导致了一种新的编程范式。通过使用生成器和迭代器，我们可以思考我们编写程序的方式。通过生成器学到的经验，我们进一步学习了 Python 中的协程和异步编程的基础知识。

第八章，*单元测试和重构*，讨论了在任何声称可维护的代码库中进行单元测试的重要性。该章节审查了单元测试的重要性，我们探讨了主要的框架（`unittest`和`pytest`）。

第九章，*常见设计模式*，审查了如何在 Python 中实现最常见的设计模式，而不是从解决问题的角度，而是通过研究它们如何通过更好和更易维护的解决方案来解决问题。该章节提到了 Python 的一些特点，使得一些设计模式变得不可见，并采取了实用的方法来实现其中一些设计模式。

第十章，*干净的架构*，着重于干净的代码是良好架构的基础这一观念。我们在第一章提到的所有细节，以及沿途重新审视的一切，在系统部署时将在整个设计中发挥关键作用。

# 充分利用本书

读者应熟悉 Python 的语法，并安装有效的 Python 解释器，可从[`www.python.org/downloads/`](https://www.python.org/downloads/)下载。

建议按照本书中的示例并在本地测试代码。为此，强烈建议使用 Python 3.7 创建虚拟环境，并使用该解释器运行代码。有关创建虚拟环境的说明，请访问[`docs.python.org/3/tutorial/venv.html`](https://docs.python.org/3/tutorial/venv.html)。

# 下载示例代码文件

您可以从[www.packtpub.com](http://www.packtpub.com)的账户中下载本书的示例代码文件。如果您在其他地方购买了本书，可以访问[www.packtpub.com/support](http://www.packtpub.com/support)并注册，文件将直接通过电子邮件发送给您。

您可以按照以下步骤下载代码文件：

1.  在[www.packtpub.com](http://www.packtpub.com/support)上登录或注册。

1.  选择 SUPPORT 选项卡。

1.  单击“代码下载和勘误”。

1.  在搜索框中输入书名，然后按照屏幕上的指示操作。

文件下载完成后，请确保使用最新版本的解压缩软件解压缩文件夹：

+   Windows 系统使用 WinRAR/7-Zip

+   Mac 系统使用 Zipeg/iZip/UnRarX

+   Linux 系统使用 7-Zip/PeaZip

本书的代码包也托管在 GitHub 上，网址为[`github.com/PacktPublishing/Clean-Code-in-Python`](https://github.com/PacktPublishing/Clean-Code-in-Python)。如果代码有更新，将在现有的 GitHub 存储库上进行更新。

我们还提供来自我们丰富书籍和视频目录的其他代码包，可在**[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)**上查看！

# 使用的约定

本书中使用了许多文本约定。

`CodeInText`：表示文本中的代码词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 用户名。例如："然后，只需运行`pylint`命令就足以在代码中进行检查。"

代码块设置如下：

```py
class Point:
    def __init__(self, lat, long):
        self.lat = lat
        self.long = long
```

当我们希望引起您对代码块的特定部分的注意时，相关行或项目将以粗体显示：

```py
setup(
    name="apptool",
    description="Description of the intention of the package",
    long_description=long_description,
```

任何命令行输入或输出都以以下方式书写：

```py
>>> locate.__annotations__
 {'latitude': float, 'longitue': float, 'return': __main__.Point}
```

**粗体**：表示新术语、重要单词或屏幕上看到的单词。例如，菜单或对话框中的单词会以这种方式出现在文本中。例如："从管理面板中选择系统信息。"

警告或重要提示会以这种方式出现。技巧和窍门会以这种方式出现。
