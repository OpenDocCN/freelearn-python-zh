# 第十五章：企业应用集成及其模式

在本书的过程中，我们已经介绍了如何实现企业应用程序。这些应用程序要么是实现了大量组件以提供一定功能集的大型单体，要么是基于微服务的应用程序，其中应用程序由多个小型服务组成，所有这些服务都通过网络相互交互，以根据业务需求提供某种功能并提供输出。

但是，在任何企业中，我们很少会开发的应用程序是唯一存在的应用程序。相反，大多数情况下，企业基础设施将包括许多应用程序，这些应用程序具有...

# 技术要求

本章的后续不需要任何特殊工具或在开发系统上存在特定软件。但对中间件和企业服务总线解决方案功能的了解将有助于理解本章的上下文。

# EAI 的需求

在任何大型企业中，可能存在一些应用程序来解决特定的问题领域。这些系统中的每一个都致力于解决一组特定的问题。通常，这种方法对于在企业内部构建应用程序是可取的，因为现在应用程序可以使用最佳的可用技术栈来解决其领域的问题。

但要使这些应用程序产生任何有用的业务影响，通常情况下这些应用程序需要以某种方式相互通信，以促进可能存在于一个应用程序中并且另一个应用程序需要的数据的交换。

但由于不同应用程序的集成是一项具有挑战性的任务，因为...

# 点对点集成

解决问题的方法之一是实现应用程序之间的点对点集成。这意味着每个应用程序都有一组连接器，允许它与另一个应用程序通信。对于需要彼此通信的每一对应用程序，都需要存在一个单独的连接器来促进应用程序之间的通信。

当需要相互通信的应用程序数量较少时，这种方法是完全可以接受的。但随着企业的发展，其需求也会增长，这意味着需要将新应用程序纳入基础设施中。现在，随着应用程序数量的增加，需要用于促进不同应用程序之间通信的连接器数量也将开始增长，达到一个基础设施变得过于复杂以至无法管理和维护的水平。

为了在企业内部集成大量应用程序，可能会随着时间的推移而增长，我们可能需要一些更灵活的东西，可以帮助我们标准化这些应用程序之间的通信方式。转向 EAI 正是我们正在考虑的架构类型，因为它旨在帮助我们实现这些目标。因此，现在让我们来看看 EAI 为我们提供了什么。

# 走向 EAI

当我们的目标是标准化基础设施中运行的不同应用程序之间的通信方式以及它们将如何存储数据时，EAI 方法确实为我们提供了一种选择，不仅具有灵活性，而且可扩展，而不会给基础设施引入不必要的复杂性。

EAI 模式为我们提供了一个框架，其中包含帮助我们标准化不同应用程序之间通信方式的工具和技术。EAI 框架通常配备了促进应用程序之间数据交换和数据从一种格式转换为另一种格式的组件，并充当不同应用程序之间的粘合层的组件。

# 传统的 EAI 方法

在 EAI 的早期，应用程序需要以各种格式相互交互，这可能包括通信一些信息或交换数据。为了促进这种交换，组织采用了 EAI 的中心枢纽模型。

在这种中心枢纽模型中，有一个基于路由器的中间件组件和事件的概念。每当一个应用程序的状态发生变化时，该应用程序会生成一个事件。其他应用程序订阅它们感兴趣的事件流。

现在，每当生成新事件时，路由器负责将事件传递给感兴趣的应用程序，并处理数据从一种格式转换为另一种格式，以便应用程序之间可以相互通信。在这种方法中，路由器成为促进不同应用程序之间集成的中心点。

路由器提供了许多功能，例如以下功能：

+   **适配器和 SDK：** 应用程序需要与路由器通信以触发事件，它们需要一种促进应用程序和路由器之间连接的粘合剂。路由中间件提供的适配器用于提供必要的粘合层。如果某个应用程序没有受支持的适配器，路由中间件将提供 SDK 以促进适配器的开发。

+   **消息转换：** 当生成新事件时，路由器根据一组预定义的规则，将与事件相关的消息转换为另一个应用程序可以消费的格式。这种功能对于促进两个不同应用程序之间的通信非常重要，每个应用程序都有自己的数据存储格式和通信风格。

+   **智能路由：** 应用程序需要无缝地相互配合，必须保证正确的事件能够到达正确的目标受众。路由中间件用于实现基于应用程序生成的事件和对该事件感兴趣的应用程序的智能路由，以便将作为事件一部分生成的消息传递给正确的接收者。

这种方法提供了一种很好的机制，可以消除企业基础设施中不必要的复杂性，如果每个应用程序都必须直接与其他应用程序通信，管理自己的连接器并处理数据一致性，那么这种复杂性将会增加。而采用这种方法，路由器促进了不同应用程序之间的通信。

但是，尽管这种方法带来了许多好处，但它也存在一些严重的缺点：

+   **单点故障：** EAI 的经纪模型被证明是一个单点故障。如果路由中间件出现故障，不同应用程序之间的所有通信将停止。

+   **集中逻辑：** 数据转换的逻辑以及数据的路由都集中在单个路由器中。这使得经纪成为一个复杂的组件，使得经纪的运营和维护成为一项艰巨的任务。

+   **扩展性差：** 当路由器的负载增加时，路由器处理消息的能力会受到影响。这会导致不同应用程序之间的数据状态不一致。此外，如果试图连接到彼此的应用程序位于世界各地的不同地理位置，那么单一的、集中位置的路由器将成为路由器地理扩展的障碍。

+   **专有解决方案：**在早期，当存在基于路由器的集线器和分支集成企业应用程序的方法时，大多数解决方案通常是专有的，只支持供应商的子集。对于从不受支持的供应商集成的应用程序，这对开发人员来说是一个巨大的问题，然后他们需要基于提供的 SDK 编写和维护自己的适配器。

所有这些问题都需要实施更好的方法，不会遭受基于路由器的方法所遇到的问题。最终，企业开始转向**面向服务的架构**（**SOA**）模型，并引入了**企业服务总线**（**ESB**）来集成 SOA 内部的不同服务。因此，让我们看看 ESB 如何改变了 EAI 的发生方式。

# ESB 的引入

随着时代的推移，企业转向了一种新的应用程序开发模式。这种模式用于将应用程序建模为服务，其中每个服务提供一定的业务能力。因此，例如，在一个企业中将有一个工资服务，该服务将提供与员工工资管理相关的所有必要功能，例如处理新员工的数据，记录他们获得的薪水金额并生成每月的工资单。

现在，这些服务需要相互集成，以便在这些服务之间促进数据交换。在这一点上，企业需要一些...

# EAI 中的模式

EAI 是一种方法，与之相关的有几种模式，它们规定了应用程序如何集成。通常使用哪种模式取决于企业基础架构中存在的应用程序类型，以及集成中存在哪些挑战。

因此，让我们看看这些模式通常是如何实现的。

# 集成模式

在 EAI 期间，集成模式定义了应用程序如何相互集成。这可能会定义不同应用程序如何相互通信以及这些应用程序如何转换数据。因此，让我们看看应用程序如何相互集成的两种广泛方式。

# 调解模式

在 EAI 的调解模式中，有一个负责事件传播的中央组件。例如，在基于代理的中间件模型中，每当一个应用程序生成一个事件时，该事件由中间件代理处理，然后负责将事件传播到对该事件感兴趣的其他应用程序。

在这种集成模式中，通常应用程序直接相互交互，由中间件代理进行便利，中间件代理传递发生的事件，之后另一个应用程序的事件处理程序负责。

另一种通常实现调解模式的集成方法是消息总线方法，其中消息总线充当不同应用程序之间传递消息以促进它们之间通信的调解者。

# 联邦模式

联邦模式在功能上与调解模式完全相反。虽然调解模式侧重于应用程序之间的直接通信，而不提供任何障碍，联邦模式通常限制应用程序之间的自由通信。

在联合模式中，中间件公开一组标准的端点，通过这些端点，其他应用程序可以与其通信。一旦应用程序向联合中间件的 API 发出请求，联合中间件就负责翻译并将该请求传递给后端应用程序。一旦后端应用程序处理了请求，联合中间件...

# 访问模式

访问模式定义了企业基础设施内应用程序对数据的访问方式。

通常有两种访问模式：异步和同步访问模式。让我们看看这些模式的目标是什么。

# 异步访问模式

异步访问模式遵循“发出请求并忘记”的数据访问方式。在这种情况下，一旦中间件转发了请求，它就不会等待该请求的响应返回，而是继续处理它正在接收的新请求。

异步访问模式通常在调解方法中使用，其中路由器中间件一旦被通知发生某个事件，就会传播该事件并忘记该事件的回复而不等待。

消息总线模型也是如此；一旦消息总线传递了消息，它就不再关心消息生成的响应，因此使得该过程...

# 同步访问模式

同步访问模式与异步模式相反。同步访问模式不是转发请求然后忘记响应，而是发出请求，然后等待其他应用程序生成响应。

这种模式通常在联合集成的情况下使用，其中中间件充当中间人，处理对其管理的后端应用程序的访问。

例如，在基于网关的模式中，中间件通常接受请求，将请求转发给后端应用程序，然后等待响应到达，然后再处理下一个请求。

这些只是控制 EAI 过程的一些基本模式。目前仍在使用近 65 种 EAI 模式，以促进 EAI 的概念。

现在，让我们来看一下一些常见的问题，这些问题阻碍了不同企业应用之间成功集成。

# EAI 中的问题

企业应用程序的成功集成通常受到许多因素的影响；让我们来看一下：

+   **专有数据格式：**一些应用程序使用自己的专有数据格式，并且几乎没有关于如何与它们集成的文档，阻止了应用程序之间的集成，或导致应用程序集成质量不佳，从而导致一系列问题。

+   **数据一致性问题：**维护数据一致性可能成为 EAI 的问题。当每个应用程序都维护自己的数据源时，跨不同数据源的数据一致性可能会成为问题，特别是如果中间件遇到重负载，导致...

# 总结

在本章中，我们看到了为什么 EAI 对企业业务流程的正常运行是必要的。一旦我们了解了 EAI 的必要性，我们就开始了解 EAI 的方法，我们探讨了应用程序点对点集成以及为什么点对点集成的过程存在问题。然后我们探讨了通过使用经纪人中间件模型来实现 EAI 的传统方式，然后继续讨论模型是如何随着 SOA 的出现而转变的，以及 ESB 如何取代基于经纪人的模型。

然后我们继续理解 EAI 中的不同模式，并了解连接不同应用程序的调解和联合集成模式，然后理解不同访问模式（如异步和同步访问）在信息从一个应用程序传输到另一个应用程序时是如何工作的。我们通过探讨一些困扰企业成功集成应用程序的问题来结束本章。

随着我们进入下一章，我们将了解微服务的引入如何改变了 EAI 的格局，并取代了 ESB 的使用，现在被分布式消息代理和 API 网关所取代。

# 问题

1.  在点对点集成过程中通常会面临哪些问题？

1.  ESB 如何连接不同类型的应用程序？

1.  存在哪些不同类型的 EAI 模式，促进了应用程序集成的方法？
