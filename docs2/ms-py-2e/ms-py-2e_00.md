# 前言

Python 是一种易于学习的语言，任何人都可以在几分钟内通过“Hello, World!”脚本开始学习。然而，掌握 Python 却是一个完全不同的问题。

每个编程问题都有多种可能的解决方案，选择 Pythonic（惯用 Python）的解决方案并不总是显而易见的；它也可能随着时间的推移而变化。这本书不仅将展示一系列不同且新的技术，还将解释何时何地应该应用某种方法。引用 Tim Peters 的*Python 之禅*：

> “应该只有一个——最好是唯一一个——明显的方法来做这件事。尽管一开始可能不明显，除非你是荷兰人。”

尽管这并不总是有帮助，但本书的作者实际上是荷兰人。

这本书不是 Python 入门指南。它是一本可以教你 Python 中可能的高级技术的书，例如`asyncio`。它甚至详细介绍了 Python 3.10 的新特性，如结构化模式匹配（Python 的`switch`语句）。

作为一名拥有多年经验的 Python 程序员，我将尝试用相关的背景信息来合理化本书中做出的选择。然而，这些合理化并不是严格的指南，因为这些情况最终往往归结为个人风格。只需知道，它们源于经验，在许多情况下，是 Python 社区推荐的解决方案。

如果你不是蒙提·派森的粉丝，这本书中的一些参考文献可能对你来说并不明显。这本书在代码示例中通常使用`spam`和`eggs`代替`foo`和`bar`，因为 Python 编程语言是以蒙提·派森命名的。为了提供一些关于`spam`和`eggs`的背景信息，我建议你观看蒙提·派森的*Spam*片段。它非常滑稽。

# 这本书适合谁阅读

这本书是为已经熟悉 Python 并希望了解 Python 提供的更多高级特性的程序员而编写的。凭借本书的深度，我可以保证，如果他们愿意，几乎每个人都可以在这里学到新的东西。

如果你只知道 Python 的基础知识，请不要担心。本书从相对简单的部分开始，逐步过渡到更高级的主题，所以你应该没问题。

# 这本书涵盖了什么内容

*第一章*，*入门——每个项目一个环境*，展示了管理 Python 版本、虚拟环境和包依赖的几种选项。

*第二章*，*交互式 Python 解释器*，探讨了 Python 解释器的选项。Python 的默认解释器功能齐全，但还有更好的替代方案。通过一些修改或替换，你可以获得自动完成、语法高亮和图形输出。

*第三章*，*Pythonic 语法和常见陷阱*，讨论了 Pythonic 编码，这是编写美观且易于阅读的 Python 代码的艺术。这章不是圣杯，但它充满了实现类似效果的技巧和最佳实践。

*第四章*，*Pythonic 设计模式*，继续探讨了*第三章*的主题。编写 Pythonic 代码不仅仅是关于代码风格，还涉及到使用正确的设计模式和数据结构。本章将介绍可用的数据结构及其性能特征。

*第五章*，*函数式编程 – 可读性与简洁性的权衡*，涵盖了函数式编程。有些人认为函数式编程是一种有点神秘的技艺，但正确应用时，它可以是一个非常强大的工具，使代码重用变得简单。它可能是你在编程中能接触到的基础数学的极致。

*第六章*，*装饰器 – 通过装饰实现代码重用*，讨论了装饰器，这是一个用于重用方法的神奇工具。使用装饰器，你可以用其他函数包装函数和类，以修改它们的参数和返回值——这是一个极其有用的工具。

*第七章*，*生成器和协程 – 一次一步的无限*，讨论了生成器。如果你已经知道将要使用每个元素，列表和元组是极好的，但更快的替代方案是只计算你实际需要的元素。这正是生成器为你做的事情：按需生成项目。

*第八章*，*元类 – 使类（而非实例）更智能*，探讨了元类，即创建其他类的类。这是一种你很少需要但确实有实际用例的魔法，例如插件系统。

*第九章*，*文档 – 如何使用 Sphinx 和 reStructuredText*，提供了有关文档的一些提示。编写文档可能不是大多数程序员的喜好活动，但它是有用的。本章展示了如何通过使用 Sphinx 和 reStructuredText 自动生成大量内容来简化这个过程。

*第十章*，*测试和日志记录 – 为虫子做准备*，涵盖了如何实现测试和日志记录以防止和检测虫子。虫子是不可避免的，通过使用日志，我们可以追踪原因。通常，可以通过使用测试来防止虫子。

*第十一章*，*调试 – 解决虫子*，基于*第十章*。上一章帮助我们找到虫子；现在我们需要解决它们。调试器在追踪困难虫子时可以提供巨大的帮助，本章展示了几个调试选项。

*第十二章*，*性能 – 跟踪和减少你的内存和 CPU 使用*，讨论了代码的性能。程序员常见的常见问题是尝试优化不需要优化的代码，这是一个有趣但通常徒劳的练习。本章帮助你找到需要优化的代码。

*第十三章*，*asyncio – 无线程的多线程*，涵盖了`asyncio`。等待外部资源，如网络资源，是应用程序最常见的瓶颈。使用`asyncio`，我们可以停止等待这些瓶颈，转而执行其他任务。

*第十四章*，*多进程 – 单个 CPU 核心不够用时*，从不同的角度讨论了性能。使用多进程，我们可以并行使用多个处理器（甚至远程）。当你的处理器是瓶颈时，这可以大有帮助。

*第十五章*，*科学 Python 和绘图*，涵盖了科学计算最重要的库。Python 已经成为科学目的的首选语言。

*第十六章*，*人工智能*，展示了众多人工智能算法及其实现所需的库。除了是科学目的的首选语言外，大多数人工智能库目前也正在使用 Python 构建。

*第十七章*，*C/C++扩展、系统调用和 C/C++库*，展示了如何从 Python 中使用现有的 C/C++库，这不仅允许重用，还可以极大地加快执行速度。Python 是一种很棒的语言，但通常并不是最快的解决方案。

*第十八章*，*打包 – 创建你自己的库或应用程序*，将帮助你将代码打包成一个完全功能的 Python 包，供他人使用。在你构建了美妙的新库之后，你可能希望与世界分享它。

# 为了最大限度地利用这本书

根据你的经验水平，你应该从开头开始阅读，或者快速浏览章节，跳到对你有吸引力的部分。这本书适合中级到高级的 Python 程序员，但并非所有章节对每个人来说都同样有用。

例如，前两章是关于设置你的环境和 Python 解释器，看起来像是你可以完全跳过的章节，尤其是对于高级或专家级别的 Python 程序员来说，但我建议不要完全跳过，因为其中涉及了一些你可能不熟悉的实用工具和库。

本书各章节在一定程度上相互关联，但并没有严格的阅读顺序，你可以轻松挑选你想要阅读的部分。如果引用了早期章节，会有明确的指示。

代码示例的最新版本始终可以在[`github.com/mastering-python/code_2`](https://github.com/mastering-python/code_2)找到。

本存储库中的代码会自动进行测试，如果你有任何建议，欢迎提交 pull requests。

本书的大部分章节也包含结尾的练习，这将允许您测试您所学到的知识。由于问题通常有多个解决方案，您和其他本书的读者都可以在 GitHub 上提交并比较您的解决方案：[`github.com/mastering-python/exercises`](https://github.com/mastering-python/exercises)

鼓励您提交一个包含您解决方案的 pull request。当然，您也可以从这里学习他人的经验。

## 下载示例代码文件

本书代码包托管在 GitHub 上，网址为[`github.com/mastering-python/code_2`](https://github.com/mastering-python/code_2)，欢迎提交改进的 pull request。我们还有其他来自我们丰富图书和视频目录的代码包，可在[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)找到。查看它们吧！

## 下载彩色图像

我们还提供了一份包含本书中使用的截图/图表彩色图像的 PDF 文件。您可以从这里下载：[`static.packt-cdn.com/downloads/9781800207721_ColorImages.pdf`](https://static.packt-cdn.com/downloads/9781800207721_ColorImages.pdf)（_ColorImages.pdf）。

## 使用的约定

本书使用了多种文本约定。

虽然本书主要遵循 PEP8 样式约定，但由于书籍格式的空间限制，做了一些妥协。简单来说，跨越多页的代码示例难以阅读，因此某些部分使用的空白比您通常期望的要少。完整的代码版本可在 GitHub 上找到，并且已自动测试以确保符合 PEP8 规范。

`CodeInText`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 昵称。例如：“`itertools.chain()`生成器是 Python 库中最简单但也是最实用的生成器之一。”

代码块设置如下：

```py
from . import base

class A(base.Plugin):
    pass 
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```py
 :show-inheritance:
 `:private-members:`
 `:special-members:`
 `:inherited-members:` 
```

任何命令行输入或输出都按照以下方式编写：

```py
$ pip3 install -U mypy 
```

**粗体**：表示新术语、重要单词或您在屏幕上看到的单词，例如在菜单或对话框中。例如：“有时交互式解释器被称为**REPL**。这代表**读取-评估-打印-循环**。”

警告或重要提示看起来像这样。

技巧和窍门看起来像这样。

# 联系我们

我们始终欢迎读者的反馈。

**一般反馈**：请发送电子邮件至 `feedback@packtpub.com`，并在邮件主题中提及本书的标题。如果您对本书的任何方面有疑问，请通过 `questions@packtpub.com` 发送电子邮件给我们。

**勘误**: 尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果你在这本书中发现了错误，我们将不胜感激，如果你能向我们报告这个错误。请访问[`www.packtpub.com/submit-errata`](http://www.packtpub.com/submit-errata)，选择你的书籍，点击**勘误提交表单**链接，并输入详细信息。

**盗版**: 如果你在互联网上以任何形式遇到我们作品的非法副本，如果你能提供位置地址或网站名称，我们将不胜感激。请通过`copyright@packtpub.com`与我们联系，并附上材料的链接。

**如果你有兴趣成为作者**: 如果你有一个你擅长的主题，并且你对撰写或为书籍做出贡献感兴趣，请访问[`authors.packtpub.com`](http://authors.packtpub.com)。

# 分享你的想法

一旦你阅读了《精通 Python 第二版》，我们很乐意听听你的想法！请[点击此处直接进入亚马逊评论页面](https://packt.link/r/1800207727)并分享你的反馈。

你的评论对我们和科技社区都很重要，并将帮助我们确保我们提供高质量的内容。
