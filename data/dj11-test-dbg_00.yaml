- en: Preface
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 前言
- en: Bugs are a time consuming burden during software development. Django's built-in
    test framework and debugging support help lessen this burden. This book will teach
    you quick and efficient techniques for using Django and Python tools to eradicate
    bugs and ensure your Django application works correctly.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在软件开发过程中，错误是一个耗时的负担。Django的内置测试框架和调试支持有助于减轻这一负担。本书将教你使用Django和Python工具快速高效地消除错误，并确保Django应用程序正常运行。
- en: This book will walk you step-by-step through the development of a complete sample
    Django application. You will learn how best to test and debug models, views, URL
    configuration, templates, and template tags. This book will help you integrate
    with and make use of the rich external environment of testing and debugging tools
    for Python and Django applications.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本书将逐步引导你开发一个完整的样本Django应用程序。你将学习如何最好地测试和调试模型、视图、URL配置、模板和模板标签。本书将帮助你集成并利用Python和Django应用程序丰富的外部测试和调试工具环境。
- en: This book starts with a basic overview of testing. It will highlight areas to
    look out for while testing. You will learn about the different kinds of tests
    available, the pros and cons of each, and details of test extensions provided
    by Django that simplify the task of testing Django applications. You will see
    an illustration of how external tools that provide even more sophisticated testing
    features can be integrated into Django's framework.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本书从基本的测试概述开始。它将强调测试时需要注意的地方。你将了解到不同类型的测试，每种测试的优缺点，以及Django提供的测试扩展的细节，这些扩展简化了测试Django应用程序的任务。你将看到外部工具如何集成到Django的框架中，提供更复杂的测试功能。
- en: On the debugging front, the book illustrates how to interpret the extensive
    debugging information provided by Django's debug error pages, and how to utilize
    logging and other external tools to learn what code is doing.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在调试方面，本书说明了如何解释Django调试错误页面提供的大量调试信息，以及如何利用日志记录和其他外部工具来了解代码的运行情况。
- en: This book is a step-by-step guide to running tests using Django's test support
    and making best use of Django and Python debugging tools.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 这本书是一个逐步指南，教你如何使用Django的测试支持，并充分利用Django和Python调试工具。
- en: What this book covers
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 本书内容
- en: In [Chapter 1](ch01.html "Chapter 1. Django Testing Overview"), *Django Testing
    Overview*, we begin development of a sample Django survey application. The example
    tests automatically generated by Django are described and run. All of the options
    available for running tests are covered.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在第1章，“Django测试概述”中，我们开始开发一个样本Django调查应用程序。描述并运行了Django自动生成的示例测试。介绍了运行测试的所有选项。
- en: In [Chapter 2](ch02.html "Chapter 2. Does This Code Work? Doctests in Depth"),
    *Does This Code Work? Doctests in Depth*, the models used by the sample application
    are developed. Using doctests to test models is illustrated by example. The pros
    and cons of doctests are discussed. Specific caveats for using doctests with Django
    applications are presented.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在第2章，“这段代码有效吗？深入了解doctests”中，开发了样本应用程序使用的模型。通过示例说明了使用doctests来测试模型。讨论了doctests的优缺点。介绍了在Django应用程序中使用doctests的特定注意事项。
- en: 'In [Chapter 3](ch03.html "Chapter 3. Testing 1, 2, 3: Basic Unit Testing"),
    *Testing 1, 2, 3: Basic Unit Testing*, the doctests implemented in the previous
    chapter are re-implemented as unit tests and assessed in light of the pros, cons,
    and caveats of doctests discussed in the previous chapter. Additional tests are
    developed that need to make use of test data. Using fixture files to load such
    data is demonstrated. In addition, some tests where fixture files are inappropriate
    for test data are developed.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 在第3章，“测试1, 2, 3：基本单元测试”中，上一章实施的doctests被重新实施为单元测试，并根据上一章讨论的doctests的优缺点和注意事项进行评估。开发了需要使用测试数据的其他测试。演示了使用fixture文件加载此类数据。此外，还开发了一些不适合使用fixture文件的测试数据的测试。
- en: 'In [Chapter 4](ch04.html "Chapter 4. Getting Fancier: Django Unit Test Extensions"),
    *Getting Fancier: Django Unit Test Extensions*, we begin to write the views that
    serve up web pages for the application. The number of tests is starting to become
    significant, so this chapter begins by showing how to replace use of a single
    `tests.py` file for tests with a tests directory, so that tests may be kept well-organized.
    Then, tests for views are developed that illustrate how unit test extensions provided
    by Django simplify the task of testing web applications. Testing form behavior
    is demonstrated by development of a test for an admin customization made in this
    chapter.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在第4章，“变得更加花哨：Django单元测试扩展”中，我们开始编写为应用程序提供网页的视图。测试的数量开始变得显著，因此本章首先展示了如何用一个tests目录替换单个`tests.py`文件，以便更好地组织测试。然后，开发了用于视图的测试，演示了Django提供的单元测试扩展如何简化测试Web应用程序的任务。通过开发本章中进行的管理自定义的测试，演示了测试表单行为。
- en: '[Chapter 5](ch05.html "Chapter 5. Filling in the Blanks: Integrating Django
    and Other Test Tools"), *Filling in the Blanks: Integrating Django and Other Test
    Tools*, shows how Django supports integration of other test tools into its framework.
    Two examples are presented. The first illustrates how an add-on application can
    be used to generate test coverage information while the second demonstrates how
    use of the `twill` test tool (which allows for much easier testing of form behavior)
    can be integrated into Django application tests.'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 第5章，“填空：集成Django和其他测试工具”，展示了Django如何支持将其他测试工具集成到其框架中。书中介绍了两个例子。第一个例子说明了如何使用附加应用程序来生成测试覆盖信息，而第二个例子演示了如何将“twill”测试工具（允许更轻松地测试表单行为）集成到Django应用程序测试中。
- en: '[Chapter 6](ch06.html "Chapter 6. Django Debugging Overview"), *Django Debugging
    Overview*, provides an introduction to the topic of debugging Django applications.
    All of the settings relevant for debugging are described. Debug error pages are
    introduced. The database query history maintained by Django when debugging is
    turned on is described, as well as features of the development server that aid
    in debugging. Finally, the handling of errors that occur during production (when
    debug is off) is detailed, and all the settings necessary to ensure that information
    about such errors is captured and sent to the appropriate people are mentioned.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '[第6章](ch06.html "第6章。Django调试概述")，“Django调试概述”，介绍了调试Django应用程序的主题。描述了所有与调试相关的设置。介绍了调试错误页面。描述了在调试打开时Django维护的数据库查询历史，以及开发服务器的功能，有助于调试。最后，详细介绍了在生产过程中（调试关闭时）发生的错误处理，并提到了确保捕获并发送有关此类错误信息的所有必要设置。'
- en: 'In [Chapter 7](ch07.html "Chapter 7. When the Wheels Fall Off: Understanding
    a Django Debug Page"), *When the Wheels Fall Off: Understanding a Django Debug
    Page*, development of the sample application continues, making some typical mistakes
    along the way. These mistakes result in Django debug pages. All of the information
    available on these pages is described, and guidance on what pieces are likely
    most helpful to look at in what situations is given. Several different kinds of
    debug pages are encountered and discussed in depth.'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第7章](ch07.html "第7章。当车轮脱落时：理解Django调试页面")，“当车轮脱落时：理解Django调试页面”，继续开发示例应用程序，在这个过程中犯了一些典型的错误。这些错误导致了Django调试页面。描述了这些页面上提供的所有信息，并给出了在什么情况下最有帮助的部分的指导。深入讨论了几种不同类型的调试页面。
- en: '[Chapter 8](ch08.html "Chapter 8. When Problems Hide: Getting More Information"),
    *When Problems Hide: Getting More Information*, focuses on how to get more information
    about how code is behaving in cases where a problem doesn''t result in a debug
    error page. It walks through the development of a template tag to embed the query
    history for a view in the rendered page, and then shows how the Django debug toolbar
    can be used to get the same information, in addition to much more. Finally, some
    logging utilities are developed.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '[第8章](ch08.html "第8章。当问题隐藏时：获取更多信息")，“当问题隐藏时：获取更多信息”，着重介绍了在问题不会导致调试错误页面的情况下如何获取有关代码行为的更多信息。它演示了开发模板标签以在呈现页面中嵌入视图的查询历史的过程，然后展示了如何使用Django调试工具栏来获取相同的信息，以及更多信息。最后，开发了一些日志记录工具。'
- en: '[Chapter 9](ch09.html "Chapter 9. When You Don''t Even Know What to Log: Using
    Debuggers"), *When You Don''t Even Know What to Log: Using Debuggers*, walks through
    examples of using the Python debugger (pdb) to track down what is going wrong
    in cases where no debug page appears and even logging isn''t helpful. All of the
    most useful pdb commands are illustrated by example. In addition, we see how pdb
    can be used to ensure correct code behavior for code that is subject to multi-process
    race conditions.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: '[第9章](ch09.html "第9章。当您甚至不知道要记录什么时：使用调试器")，“当您甚至不知道要记录什么时：使用调试器”，通过示例演示了如何使用Python调试器（pdb）来跟踪在没有调试页面出现甚至日志也无法帮助的情况下出现问题。通过示例演示了所有最有用的pdb命令。此外，我们还看到了如何使用pdb来确保对于受多进程竞争条件影响的代码的正确行为。'
- en: '[Chapter 10](ch10.html "Chapter 10. When All Else Fails: Getting Outside Help"),
    *When All Else Fails: Getting Outside Help*, describes what to do when none of
    the techniques covered so far have solved a problem. Possibly, it is a bug in
    external code: tips are given on how to search to see if others have experienced
    the same and if there are any fixes available. Possibly it''s a bug in our code
    or a misunderstanding about how some things work; avenues for asking questions
    and tips on writing good questions are included.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: '[第10章](ch10.html "第10章。当一切都失败时：寻求外部帮助")，“当一切都失败时：寻求外部帮助”，描述了当迄今为止的技术都未能解决问题时该怎么办。可能是外部代码中的错误：提供了如何搜索以查看其他人是否有相同经历以及是否有任何修复的提示。可能是我们代码中的错误或对某些工作原理的误解；包括了提问的途径和写好问题的提示。'
- en: 'In [Chapter 11](ch11.html "Chapter 11. When it''s Time to Go Live: Moving to
    Production"), *When it''s Time to Go Live: Moving to Production*, we move the
    sample application into production, using Apache and `mod_wsgi` instead of the
    development server. Several of the most common problems encountered during this
    step are covered. In addition, the option of using Apache with `mod_wsgi` during
    development is discussed.'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第11章](ch11.html "第11章。当是时候上线了：转向生产")，“当是时候上线了：转向生产”，我们将示例应用程序移入生产环境，使用Apache和`mod_wsgi`代替开发服务器。涵盖了在此步骤中遇到的几种常见问题。此外，还讨论了在开发过程中使用Apache与`mod_wsgi`的选项。
- en: What you need for this book
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 本书需要以下内容：
- en: You will need a computer running a Django 1.1 release—the latest 1.1.X release
    is recommended. You will also need an editor to edit code files and a web browser.
    You may choose to use whatever operating system, editing, and browsing tools you
    are most comfortable with, so long as you choose an operating system that can
    run Django. For more information on Django's requirements, consult [http://docs.djangoproject.com/en/1.1/intro/install/](http://docs.djangoproject.com/en/1.1/intro/install/).
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 您需要一台运行Django 1.1版本的计算机——建议使用最新的1.1.X版本。您还需要一个编辑器来编辑代码文件和一个网络浏览器。您可以选择使用您最熟悉的操作系统、编辑和浏览工具，只要选择一个可以运行Django的操作系统。有关Django要求的更多信息，请参阅[http://docs.djangoproject.com/en/1.1/intro/install/](http://docs.djangoproject.com/en/1.1/intro/install/)。
- en: 'For your reference, the example console output and screenshots in this book
    are all taken from a machine running:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 供您参考，本书中的示例控制台输出和屏幕截图都来自一台运行以下内容的计算机：
- en: Ubuntu 8.10
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Ubuntu 8.10
- en: Python 2.5.2
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Python 2.5.2
- en: Django 1.1 (early in the book) and 1.1.1 (later in the book)
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Django 1.1（书中早期）和1.1.1（书中后期）
- en: Firefox 3.5.7
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Firefox 3.5.7
- en: You can use any database supported by Django. For illustration purposes, different
    databases (SQLite, MySQL, PostgreSQL) are used at different points in the book.
    You will likely prefer to choose one to use throughout.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用Django支持的任何数据库。为了说明的目的，在本书的不同部分使用了不同的数据库（SQLite、MySQL、PostgreSQL）。您可能更愿意选择一个数据库来贯穿使用。
- en: 'Additional software is used at specific points in the book. Wherever a software
    package is introduced, notes on where to obtain it for installation are included.
    For your reference, the following is a list of additional software packages and
    the versions used in the book:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 本书在特定的点使用了额外的软件。每当引入一个软件包时，都会包括有关在哪里获取它以进行安装的说明。供您参考，以下是本书中使用的额外软件包及其版本的列表：
- en: '[Chapter 5](ch05.html "Chapter 5. Filling in the Blanks: Integrating Django
    and Other Test Tools"), *Filling in the Blanks: Integrating Django and Other Test
    Tools*, uses:'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第5章](ch05.html "第5章 填补空白：集成Django和其他测试工具") *填补空白：集成Django和其他测试工具* 使用：'
- en: coverage 3.2
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: coverage 3.2
- en: django_coverage 1.0.1
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: django_coverage 1.0.1
- en: twill 0.9 (and latest development level)
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: twill 0.9（和最新的开发级别）
- en: '[Chapter 8](ch08.html "Chapter 8. When Problems Hide: Getting More Information"),
    *When Problems Hide: Getting More Information*, uses:'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第8章](ch08.html "第8章 当问题隐藏时：获取更多信息") *当问题隐藏时：获取更多信息* 使用：'
- en: django-debug-toolbar 0.8.0
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: django-debug-toolbar 0.8.0
- en: '[Chapter 9](ch09.html "Chapter 9. When You Don''t Even Know What to Log: Using
    Debuggers"), *When You Don''t Even Know What to Log: Using Debuggers*, uses:'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第9章](ch09.html "第9章 当你甚至不知道要记录什么：使用调试器") *当你甚至不知道要记录什么：使用调试器* 使用：'
- en: pygooglechart 0.2.0
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: pygooglechart 0.2.0
- en: matplotlib 0.98.3
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: matplotlib 0.98.3
- en: '[Chapter 11](ch11.html "Chapter 11. When it''s Time to Go Live: Moving to Production"),
    *When it''s Time to Go Live: Moving to Production*, uses:'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[第11章](ch11.html "第11章 当是时候上线了：转向生产") *当是时候上线了：转向生产* 使用：'
- en: Apache 2.2
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Apache 2.2
- en: mod_wsgi 2.3
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: mod_wsgi 2.3
- en: siege 2.6.6
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: siege 2.6.6
- en: Note that you do not need to have any of these additional packages installed
    when you start working through this book, they can each be added at the specific
    point where you want to start using them. The versions listed are those used for
    the output shown in the book; it is expected that later versions will work as
    well, though the output produced may be slightly different if you use a newer
    version.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，当您开始阅读本书时，您不需要安装这些额外的软件包中的任何一个，它们可以在您想要开始使用它们的特定点上添加。列出的版本是书中显示的输出所使用的版本；预计稍后的版本也将起作用，尽管如果您使用更新的版本，产生的输出可能会略有不同。
- en: Who this book is for
  id: totrans-41
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 本书的受众
- en: If you are a Django application developer who wants to create robust applications
    quickly that work well and are easy to maintain in the long term, this book is
    for you. This book is the right pick if you want to be smartly tutored to make
    best use of Django's rich testing and debugging support and make development an
    effortless task.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您是一名Django应用程序开发人员，希望快速创建稳健的应用程序，并且长期易于维护，那么本书适合您。如果您希望聪明地学习如何充分利用Django丰富的测试和调试支持，并使开发变得轻松，那么本书是您的不二选择。
- en: Basic knowledge of Python, Django, and the overall structure of a database-driven
    web application is assumed. However, the code samples are fully explained so that
    even beginners who are new to the area can learn a great deal from this book.
    If you are new to Django, it is recommended that you work through the online Django
    tutorial before beginning this book.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 假定您具有Python、Django和基于数据库的Web应用程序的整体结构的基本知识。但是，代码示例已经得到充分解释，以便即使是对这个领域新手的初学者也可以从本书中学到很多知识。如果您是Django的新手，建议您在开始阅读本书之前先完成在线Django教程。
- en: Conventions
  id: totrans-44
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 约定
- en: In this book, you will find a number of styles of text that distinguish between
    different kinds of information. Here are some examples of these styles, and an
    explanation of their meaning.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书中，您将找到一些文本样式，用于区分不同类型的信息。以下是一些这些样式的示例，以及它们的含义解释。
- en: 'Code words in text are shown as follows: "Now we have the basic skeleton of
    a Django project and application: A `settings.py` file, a `urls.py` file, the
    `manage.py` utility, and a `survey` directory containing `.py` files for models,
    views, and tests."'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 文本中的代码词如下所示：“现在我们有了Django项目和应用的基本骨架：一个`settings.py`文件，一个`urls.py`文件，`manage.py`实用程序，以及一个包含模型、视图和测试的`.py`文件的`survey`目录。”
- en: 'A block of code is set as follows:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 代码块设置如下：
- en: '[PRE0]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'When we wish to draw your attention to a particular part of a code block, the
    relevant lines or items are set in bold:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们希望引起您对代码块的特定部分的注意时，相关行或项目将以粗体显示：
- en: '[PRE1]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Any command-line input or output is written as follows:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 任何命令行输入或输出都以以下方式编写：
- en: '[PRE2]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '**New terms** and **important words** are shown in bold. Words that you see
    on the screen, in menus or dialog boxes for example, appear in the text like this:
    "This drop-down box contains a full list of the ticket attributes we could search
    on, such as **Reporter**, **Owner**, **Status**, and **Component**."'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '**新术语**和**重要单词**以粗体显示。您在屏幕上看到的单词，例如菜单或对话框中的单词，会以这样的方式出现在文本中：“此下拉框包含我们可以搜索的所有票据属性的完整列表，例如**报告人**、**所有者**、**状态**和**组件**。”'
- en: Note
  id: totrans-54
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Warnings or important notes appear in a box like this.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 警告或重要说明会以这样的方式出现在框中。
- en: Tip
  id: totrans-56
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Tips and tricks appear like this.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 提示和技巧会以这样的方式出现。
