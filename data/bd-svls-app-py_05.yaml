- en: Logging and Monitoring
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 日志记录和监视
- en: We have learned about the concepts of serverless architectures and understood
    the basics and the internals of AWS's serverless service, AWS Lambda. We have
    also created some example serverless projects to understand the concepts better.
    During the course of our learning, we have also learned the basics of several
    other AWS services, such as alarms, SNS, SQS, S3 buckets, and CloudWatch.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经了解了无服务器架构的概念，并了解了AWS的无服务器服务AWS Lambda的基础知识和内部工作原理。我们还创建了一些示例无服务器项目，以更好地理解这些概念。在学习过程中，我们还学习了其他几个AWS服务的基础知识，例如警报、SNS、SQS、S3存储桶和CloudWatch。
- en: In this chapter, we will learn about how to do the logging and monitoring for
    the serverless systems that we are building. Logging and monitoring software code
    and systems are very important, as they helps us with the telemetry and disaster
    recovery. Logging is a process where we store the logs emitted by our code or
    by our architecture as a whole. Monitoring is a process where we closely monitor
    the activities, status, and health of the components and processes in our code
    or architecture.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将学习如何为我们构建的无服务器系统进行日志记录和监视。日志记录和监视软件代码和系统非常重要，因为它们帮助我们进行遥测和灾难恢复。日志记录是一个过程，我们在其中存储代码或整体架构发出的日志。监视是一个过程，我们密切监视代码或架构中组件和进程的活动、状态和健康状况。
- en: So, you will be learning how to set up and understand the monitoring suite of
    AWS Lambda, which is closely integrated with the monitoring service of AWS, the
    CloudWatch Dashboards. We will also learn about the logging service of AWS, the
    CloudWatch Logs service. Finally, we will also learn about and understand the
    distributed tracing and monitoring service of AWS, the CloudTrail service.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，您将学习如何设置和了解AWS Lambda的监视套件，它与AWS的监视服务CloudWatch仪表板紧密集成。我们还将学习AWS的日志记录服务CloudWatch
    Logs服务。最后，我们还将学习和了解AWS的分布式跟踪和监视服务CloudTrail服务。
- en: 'This chapter covers the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖以下主题：
- en: Understanding CloudWatch
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 了解CloudWatch
- en: Understanding CloudTrail
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 了解CloudTrail
- en: Lambda's metrics in CloudWatch
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CloudWatch中的Lambda指标
- en: Lambda's logs in CloudWatch
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CloudWatch中的Lambda日志
- en: Logging statements in Lambda
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Lambda中的日志记录
- en: Understanding CloudWatch
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 了解CloudWatch
- en: As mentioned earlier, CloudWatch is the logging and monitoring service of AWS.
    We have already looked at and learned about the CloudWatch Alarms, which are a
    sub-feature of CloudWatch. We will now learn about the graphing suite of the service.
    Almost every service in the AWS environment has a way to send it's logs and metrics
    to CloudWatch for logging and monitoring purposes. Each service might have several
    metrics which can be monitored, depending on the function.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，CloudWatch是AWS的日志记录和监视服务。我们已经了解并学习了CloudWatch警报，这是CloudWatch的一个子功能。现在我们将学习该服务的图形套件。AWS环境中几乎每个服务都有一种方法将其日志和指标发送到CloudWatch进行日志记录和监视。每个服务可能有多个可以监视的指标，具体取决于其功能。
- en: 'Similarly, AWS Lambda also has some metrics, such as the invocation count,
    the invocation''s running time, and so on, which it sends to CloudWatch. It is
    also helpful to note that the developers can also send custom metrics to CloudWatch.
    So in the following steps, we shall be learning about the different parts and
    functions of AWS CloudWatch corresponding to AWS Lambda:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，AWS Lambda也有一些指标，例如调用次数、调用运行时间等，它会发送到CloudWatch。值得注意的是开发人员也可以将自定义指标发送到CloudWatch。因此，在接下来的步骤中，我们将学习与AWS
    Lambda对应的AWS CloudWatch的不同部分和功能：
- en: 'Firstly, let us see what the CloudWatch console looks like and also get a feel
    for it by navigating around the console. Browse to [console.aws.amazon.com/cloudwatch/](https://signin.aws.amazon.com/signin?redirect_uri=https%3A%2F%2Fconsole.aws.amazon.com%2Fcloudwatch%2F%3Fstate%3DhashArgs%2523%26isauthcode%3Dtrue&client_id=arn%3Aaws%3Aiam%3A%3A015428540659%3Auser%2Fcloudwatch&forceMobileApp=0):'
  id: totrans-13
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先，让我们看看CloudWatch控制台的外观，并通过浏览控制台来感受一下。浏览至[console.aws.amazon.com/cloudwatch/](https://signin.aws.amazon.com/signin?redirect_uri=https%3A%2F%2Fconsole.aws.amazon.com%2Fcloudwatch%2F%3Fstate%3DhashArgs%2523%26isauthcode%3Dtrue&client_id=arn%3Aaws%3Aiam%3A%3A015428540659%3Auser%2Fcloudwatch&forceMobileApp=0)：
- en: '![](img/1046303e-63ab-4f58-8dd5-3757559e8d88.png)'
  id: totrans-14
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1046303e-63ab-4f58-8dd5-3757559e8d88.png)'
- en: As we can see, there is a lot of information in the CloudWatch console. So,
    we shall now try to understand each component one after the other. In the left
    side, we can see a list of options, which includes Dashboards, Alarms, Billing,
    and so on. We shall try to understand all of them and their functionality as part
    of understanding the CloudWatch console.
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正如我们所看到的，CloudWatch控制台中有大量信息。因此，我们现在将尝试逐个了解每个组件。在左侧，我们可以看到一系列选项，包括仪表板、警报、计费等。我们将尝试了解它们以及它们作为了解CloudWatch控制台的一部分的功能。
- en: 'A dashboard here is a panel of CloudWatch Metrics that the user can configure.
    For example, a user might want to have a particular set of server (EC2) metrics
    at a single place to be able to monitor them better. This is where AWS CloudWatch
    Dashboards come into play. When you click on the Dashboards option on the left,
    you can see the Dashboards console, which looks like this:'
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这里的仪表板是用户可以配置的CloudWatch指标面板。例如，用户可能希望在一个地方拥有一组特定的服务器（EC2）指标，以便更好地监视它们。这就是AWS
    CloudWatch仪表板发挥作用的地方。当您点击左侧的“仪表板”选项时，您可以看到仪表板控制台，它看起来像这样：
- en: '![](img/8a4bc481-d9a3-4ff4-96be-c025773752b8.png)'
  id: totrans-17
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8a4bc481-d9a3-4ff4-96be-c025773752b8.png)'
- en: 'Let us go ahead and create a new dashboard by clicking the blue Create dashboard
    button on the top left-hand side of the console. The following box appears:'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们继续点击控制台左上角的蓝色“创建仪表板”按钮，创建一个新的仪表板。将出现以下框：
- en: '![](img/22ac5911-7102-4b57-b57c-67f86a992261.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](img/22ac5911-7102-4b57-b57c-67f86a992261.png)'
- en: 'This will take you to the next step, where you will be asked to select a widget
    type for the dashboard. There are four types of widgets which are currently available.
    The widget selection screen looks like this:'
  id: totrans-20
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这将带您进入下一步，您将被要求为仪表板选择一个小部件类型。目前有四种类型的小部件可用。小部件选择屏幕如下所示：
- en: '![](img/98a3e0c5-f7bb-465a-8b7d-d719c5067d18.png)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
  zh: '![](img/98a3e0c5-f7bb-465a-8b7d-d719c5067d18.png)'
- en: 'For the sake of this tutorial, I am choosing the Line style widget. You can
    choose whatever widget would fit your graphing style and the monitoring you need
    to do. Once you select a widget style and click the blue Configure button, you
    will be redirected to a wizard where you will be asked to add a metric as shown
    in the following screenshot:'
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 出于本教程的目的，我选择了线条样式小部件。您可以选择适合您的图表样式和所需监视的任何小部件。一旦您选择了小部件样式并单击蓝色的“配置”按钮，您将被重定向到一个向导，在那里您将被要求添加一个度量，如下面的屏幕截图所示：
- en: '![](img/03495b0c-d00c-4397-bf4f-0435e606b263.png)'
  id: totrans-23
  prefs: []
  type: TYPE_IMG
  zh: '![](img/03495b0c-d00c-4397-bf4f-0435e606b263.png)'
- en: 'Select one of the available metrics at the bottom and it will be added to the
    widget. Once you are done with selecting the metrics, click on the blue Create
    widget button in the lower-right part of the page as shown in the following screenshot:'
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在底部选择一个可用的度量，并将其添加到小部件中。一旦您选择了度量标准，点击页面右下角的蓝色“创建小部件”按钮，如下面的屏幕截图所示：
- en: '![](img/49439599-8f9f-4604-8795-a45411ba4eeb.png)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](img/49439599-8f9f-4604-8795-a45411ba4eeb.png)'
- en: 'Now, you can see the dashboard that you have just created in the Dashboards section:'
  id: totrans-26
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，您可以在“仪表板”部分看到您刚刚创建的仪表板：
- en: '![](img/0d9b4553-1e12-4e4f-bb4f-e0ee8f81352b.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0d9b4553-1e12-4e4f-bb4f-e0ee8f81352b.png)'
- en: We have successfully learned and created an AWS CloudWatch Dashboard. We will
    now move on to learning about CloudWatch Events. We have already learned about
    CloudWatch Alarms in the previous chapters, looking at both their functionality
    and how to create and work with them.
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们已经成功学习并创建了AWS CloudWatch仪表板。现在我们将继续学习CloudWatch事件。在前几章中，我们已经了解了CloudWatch警报，查看了它们的功能以及如何创建和使用它们。
- en: 'Click on the Events link in the CloudWatch menu on the left. You will be redirected
    to the page of CloudWatch Events, as shown in the following screenshot:'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在CloudWatch菜单的左侧单击“事件”链接。您将被重定向到CloudWatch事件页面，如下面的屏幕截图所示：
- en: '![](img/db25848e-e62f-43ab-ba37-ccb0fa4fb150.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](img/db25848e-e62f-43ab-ba37-ccb0fa4fb150.png)'
- en: 'Once you click on the blue Create rule button, you will be redirected to the
    Events creation wizard, which looks like this:'
  id: totrans-31
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦您单击蓝色的“创建规则”按钮，您将被重定向到事件创建向导，它看起来像这样：
- en: '![](img/cb2ad2e0-c2b9-4499-9e65-55274aa727ce.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cb2ad2e0-c2b9-4499-9e65-55274aa727ce.png)'
- en: 'There can be two types of events, namely Event Pattern and Schedule, each of
    which have different purposes. Here we will only learn about the Schedule type,
    as it comes in handy for scheduling Lambda functions:'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可以有两种类型的事件，即事件模式和计划，它们各自有不同的目的。在这里，我们只会了解计划类型，因为它对于调度Lambda函数非常方便：
- en: '![](img/52498f0f-822b-47b8-a1cf-5d9f9072ffcd.png)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![](img/52498f0f-822b-47b8-a1cf-5d9f9072ffcd.png)'
- en: 'The rate can be either set in terms of Minutes, Hours, or Days, or can be set
    as a cron expression, whichever way you are comfortable with. Now, the target
    needs to be selected. The target can be any valid Lambda function, as shown in
    the following drop-down menu:'
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 速率可以以分钟、小时或天为单位设置，也可以设置为cron表达式，无论您喜欢哪种方式。现在，需要选择目标。目标可以是任何有效的Lambda函数，如下拉菜单所示：
- en: '![](img/a0c2d995-161b-4f16-b852-448fbcc6b48f.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a0c2d995-161b-4f16-b852-448fbcc6b48f.png)'
- en: 'Once you have selected the function, you can click on the blue Configure details
    at the bottom. It will take you to the Configure rule details page as shown in
    the following screenshot:'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦您选择了函数，您可以在底部单击蓝色的“配置详细信息”。这将带您到配置规则详细信息页面，如下面的屏幕截图所示：
- en: '![](img/c7c5f05a-3898-404f-9493-e6565f19fbe7.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c7c5f05a-3898-404f-9493-e6565f19fbe7.png)'
- en: 'Once you enter the name and the description of the rule that you want to create,
    you can click on the blue Create rule button at the bottom. This will successfully
    create an event, and the same will be reflected in your CloudWatch console:'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦您输入要创建的规则的名称和描述，您可以单击底部的蓝色“创建规则”按钮。这将成功创建一个事件，并将在您的CloudWatch控制台中反映出来：
- en: '![](img/2f488395-182b-46db-ab1b-bd33a090ef0f.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2f488395-182b-46db-ab1b-bd33a090ef0f.png)'
- en: We have successfully added a cron event for a Lambda function which means that
    Lambda will be invoked at regular intervals, as specified by the user in the settings
    of the event.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已成功为Lambda函数添加了一个cron事件，这意味着Lambda将按照用户在事件设置中指定的间隔定期调用。
- en: 'Now, we shall try to understand the Logs feature of AWS CloudWatch. This is
    where the Lambda functions store their logs. You can click on the Logs link in
    the menu on the left-hand side to access the console of CloudWatch Logs:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，我们将尝试了解AWS CloudWatch的日志功能。这是Lambda函数存储其日志的地方。您可以单击左侧菜单中的“日志”链接，以访问CloudWatch日志的控制台：
- en: '![](img/d2d37382-f5b9-4a68-a770-a3f74538479d.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d2d37382-f5b9-4a68-a770-a3f74538479d.png)'
- en: 'We can see the complete list of logs for all of the Lambda functions we have
    ever created throughout the course of the book. When you click on a log group,
    you can find more details about it, and also options for customization. Each log
    stream is an invocation of the Lambda function that the log is associated with:'
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们可以看到我们在整本书中创建的所有Lambda函数的完整日志列表。当您单击日志组时，您可以找到有关它的更多详细信息，以及自定义选项。每个日志流都是与Lambda函数相关联的调用：
- en: '![](img/eef02958-3237-4aeb-84d1-4724fdf4f25d.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![](img/eef02958-3237-4aeb-84d1-4724fdf4f25d.png)'
- en: 'You can also make use of the additional functionality provided by CloudWatch
    for handling the logs data, which can be seen in the drop-down Actions menu in Log
    Groups:'
  id: totrans-46
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您还可以利用CloudWatch提供的附加功能来处理日志数据，这可以在“日志组”中的下拉“操作”菜单中看到：
- en: '![](img/922f928e-2eb2-4130-a62f-abbddb68aa90.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![](img/922f928e-2eb2-4130-a62f-abbddb68aa90.png)'
- en: 'Finally, we will wrap up by exploring and learning about the CloudWatch Metrics.
    The metrics console can be accessed by clicking on the Metrics option on the left-hand
    side of the CloudWatch console:'
  id: totrans-48
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，我们将通过探索和学习CloudWatch指标来结束。可以通过单击CloudWatch控制台左侧的“指标”选项来访问指标控制台：
- en: '![](img/8841372c-f770-4656-b97b-c4042c14eb8d.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8841372c-f770-4656-b97b-c4042c14eb8d.png)'
- en: 'You can select any option in the menu at the bottom for graphing the metrics.
    For the purpose of this tutorial, I have added a Lambda metric, which is the number
    of errors in the function, `serverless-api`:'
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以在底部菜单中选择任何选项来绘制指标。在本教程中，我已添加了一个Lambda指标，即函数“serverless-api”中的错误数量：
- en: '![](img/159fc81d-ca6b-4b58-acba-becd2c391461.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](img/159fc81d-ca6b-4b58-acba-becd2c391461.png)'
- en: Understanding CloudTrail
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 了解CloudTrail
- en: CloudTrail is another monitoring service of AWS where you can look at all of
    the events and trails that have happened in your AWS account. This service is
    a bit more detailed than the CloudWatch service in how it records and stores the
    events and trails.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: CloudTrail是AWS的另一个监控服务，您可以查看在您的AWS帐户中发生的所有事件和路径。该服务比CloudWatch服务更详细，因为它记录和存储事件和路径的方式更详细。
- en: 'So, we shall explore and learn about this service in the following steps:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们将在以下步骤中探索和学习有关此服务的信息：
- en: 'The AWS CloudTrail''s dashboard can be accessed at [console.aws.amazon.com/cloudtrail/](https://signin.aws.amazon.com/signin?redirect_uri=https%3A%2F%2Fconsole.aws.amazon.com%2Fcloudtrail%2Fhome%3Fstate%3DhashArgs%2523%26isauthcode%3Dtrue&client_id=arn%3Aaws%3Aiam%3A%3A015428540659%3Auser%2Fcloudtrail&forceMobileApp=0):'
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 可以在[console.aws.amazon.com/cloudtrail/](https://signin.aws.amazon.com/signin?redirect_uri=https%3A%2F%2Fconsole.aws.amazon.com%2Fcloudtrail%2Fhome%3Fstate%3DhashArgs%2523%26isauthcode%3Dtrue&client_id=arn%3Aaws%3Aiam%3A%3A015428540659%3Auser%2Fcloudtrail&forceMobileApp=0)访问AWS
    CloudTrail的仪表板：
- en: '![](img/ce2500b6-f225-4255-8023-d255bbee795b.png)'
  id: totrans-56
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ce2500b6-f225-4255-8023-d255bbee795b.png)'
- en: 'The list of events in your AWS account can be seen on the left-hand side of
    the CloudTrail menu when you click on the Event history button. The Event history
    page looks like this:'
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当您单击“事件历史记录”按钮时，您可以在CloudTrail菜单的左侧看到AWS帐户中的事件列表。事件历史记录页面如下所示：
- en: '![](img/6b2bab2d-c948-45e8-9594-0b29c27bd9db.png)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6b2bab2d-c948-45e8-9594-0b29c27bd9db.png)'
- en: 'The third functionality of CloudTrail is the trails. The user can set up trails
    for their AWS services, such as Lambda. The trails that have been set up can be
    found on the Trails dashboard. This can be accessed by going to the Trails console
    by clicking on the Trails option in the menu on the left-hand side:'
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: CloudTrail的第三个功能是路径。用户可以为他们的AWS服务设置路径，例如Lambda。已设置的路径可以在路径仪表板上找到。这可以通过单击左侧菜单中的“路径”选项来访问：
- en: '![](img/623c5cb7-de80-48fd-b9ac-7d36933a3b27.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![](img/623c5cb7-de80-48fd-b9ac-7d36933a3b27.png)'
- en: 'Now, let us understand how to create a trail in the CloudTrail dashboard. You
    can go to the main dashboard of CloudTrail and click on the blue Create trail
    button. This will take you to the trail creation wizard:'
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，让我们了解如何在CloudTrail仪表板中创建路径。您可以转到CloudTrail的主仪表板，然后单击蓝色的“创建路径”按钮。这将带您进入路径创建向导：
- en: '![](img/46c4272b-7b8d-47f9-818a-f1beeaa44072.png)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![](img/46c4272b-7b8d-47f9-818a-f1beeaa44072.png)'
- en: 'You can enter the details of your trail here. You can leave the default options
    as they are for the Apply trail to all regions and the Management events options:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您可以在此处输入您的路径的详细信息。您可以将默认选项保留为“将路径应用于所有区域”和“管理事件”选项：
- en: '![](img/1617ea6b-b03a-4308-ad6e-894561bd5025.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1617ea6b-b03a-4308-ad6e-894561bd5025.png)'
- en: 'Now, moving on to the next setting, select the Lambda option and click on the
    Log all current and future functions in the options list. This will ensure that
    all of our Lambda functions are logged properly with CloudTrail:'
  id: totrans-65
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，继续下一个设置，选择Lambda选项，然后单击选项列表中的“记录所有当前和未来的函数”。这将确保我们所有的Lambda函数都能够正确记录在CloudTrail中：
- en: '![](img/9c69f7dd-45b8-40d7-997f-157529678aa4.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9c69f7dd-45b8-40d7-997f-157529678aa4.png)'
- en: 'Now, in the final Storage location option, select an S3 bucket for storing
    the CloudTrail logs. This can be an already existing bucket or you can also ask
    CloudTrail to create a new bucket for this purpose. I am using an existing bucket:'
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，在最终的“存储位置”选项中，选择一个S3存储桶来存储CloudTrail日志。这可以是已经存在的存储桶，或者您也可以要求CloudTrail为此创建一个新的存储桶。我正在使用一个现有的存储桶：
- en: '![](img/d39c4224-9ae5-41d8-9ac0-6f220f628439.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](img/d39c4224-9ae5-41d8-9ac0-6f220f628439.png)'
- en: 'After all of the details and settings have been configured accordingly, you
    can click on the blue Create trail button to create the trail. Now, you see the
    trail you have just created in your CloudTrail dashboard as shown in the following
    screenshot:'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在所有详细信息和设置都已相应配置后，您可以单击蓝色的“创建路径”按钮来创建路径。现在，您可以在CloudTrail仪表板中看到您刚刚创建的路径，如下面的屏幕截图所示：
- en: '![](img/93727858-8059-47b2-a5be-3975204b45d8.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![](img/93727858-8059-47b2-a5be-3975204b45d8.png)'
- en: 'Now, when you click on the trail that you have just created, you can see all
    of the details with which it has been configured as shown in the following screenshot:'
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，当您单击刚刚创建的路径时，您可以看到所有配置详细信息，如下面的屏幕截图所示：
- en: '![](img/b8ecaae1-742f-4432-89f3-9eb34c7bc33e.png)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b8ecaae1-742f-4432-89f3-9eb34c7bc33e.png)'
- en: 'You can also notice a very interesting option that enables you to configure
    CloudWatch Logs along with SNS to notify you of any specific activities, for example
    when there is an error in a Lambda function:'
  id: totrans-73
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您还可以注意到一个非常有趣的选项，它使您能够配置CloudWatch日志以及SNS，以通知您任何特定的活动，例如当Lambda函数出现错误时：
- en: '![](img/70560b9e-6ef6-4e5f-af54-6692315440a6.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![](img/70560b9e-6ef6-4e5f-af54-6692315440a6.png)'
- en: 'And finally, you can also add tags to the trail, just like you can with the
    rest of your AWS services:'
  id: totrans-75
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 最后，您还可以像其他AWS服务一样为路径添加标记：
- en: '![](img/1b11d26e-56a2-4116-b352-2001c689eaf2.png)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1b11d26e-56a2-4116-b352-2001c689eaf2.png)'
- en: 'Additionally, let us understand how to configure CloudWatch Logs for our trail.
    So, for this you need to click on the blue Configure button in the CloudWatch
    Logs section above the Tags section:'
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此外，让我们了解如何为我们的路径配置CloudWatch日志。因此，您需要单击标记部分上方的蓝色“配置”按钮：
- en: '![](img/eaea7387-216c-46d9-b4f3-70f3d8c5531d.png)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![](img/eaea7387-216c-46d9-b4f3-70f3d8c5531d.png)'
- en: 'When you click Continue, it takes you to the creation wizard where you need
    to configure the permissions accordingly with your IAM role settings. For the
    purpose of this tutorial, I have selected the Create a new IAM Role option as
    shown in the following screenshot:'
  id: totrans-79
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击“继续”将带您到创建向导，您需要根据IAM角色设置相应地配置权限。在本教程中，我已选择了“创建新的IAM角色”选项，如下截图所示：
- en: '![](img/f6d4dba6-f006-463b-81a7-1ba5f14f6833.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f6d4dba6-f006-463b-81a7-1ba5f14f6833.png)'
- en: 'After you have finished configuring the IAM role settings, you can click on
    the blue Allow button at the bottom. After a couple of seconds of validation,
    the CloudWatch Logs get configured, which you can see in the same CloudWatch Logs
    section here:'
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 完成IAM角色设置配置后，您可以单击底部的蓝色“允许”按钮。经过几秒钟的验证后，CloudWatch日志将被配置，您可以在此处的同一CloudWatch日志部分中看到：
- en: '![](img/8129a3da-2968-47ea-b627-f3db726c986e.png)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8129a3da-2968-47ea-b627-f3db726c986e.png)'
- en: Lambda’s metrics in CloudWatch
  id: totrans-83
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Lambda在CloudWatch中的指标
- en: As we have learned and understood how the CloudWatch and the CloudTrail services
    work with respect to logging and monitoring, we shall move on to try and implement
    them for our Lambda function(s). In this section, you will learn about the types
    of metrics that Lambda possesses, which are monitored by CloudWatch, and how to
    create a dashboard with all those metrics.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们已经学习和了解了CloudWatch和CloudTrail服务在日志记录和监视方面的工作原理，我们将继续尝试为我们的Lambda函数实现它们。在本节中，您将了解Lambda拥有的CloudWatch监控的指标类型，并学习如何创建包含所有这些指标的仪表板。
- en: 'Similar to previous sections in this chapter and book, we shall try and understand
    the concepts in the form of the following steps:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 与本章和本书中的先前部分类似，我们将尝试以以下步骤的形式理解概念：
- en: 'When you navigate over to your AWS Lambda console, you will see the Lambda
    function which you have already created, in the list of available functions:'
  id: totrans-86
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当您导航到AWS Lambda控制台时，您将看到您已经创建的Lambda函数在可用函数列表中：
- en: '![](img/b2c86ede-f9c1-4044-b7bf-bc4e5627be16.png)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b2c86ede-f9c1-4044-b7bf-bc4e5627be16.png)'
- en: 'When you click on the function, you will see two available options on the top:
    Configuration and Monitoring. Navigate to the Monitoring section. You will see
    a dashboard of metrics, which contains the following:'
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当您单击函数时，您将在顶部看到两个可用选项：配置和监视。导航到监视部分。您将看到包含以下内容的指标仪表板：
- en: Invocations
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调用
- en: Duration
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 持续时间
- en: Errors
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 错误
- en: Throttles
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 节流
- en: Iterator age
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 迭代器年龄
- en: DLQ errors
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: DLQ错误
- en: '![](img/45c11785-1c42-40f6-9a4d-5dab9bdadb50.png)'
  id: totrans-95
  prefs: []
  type: TYPE_IMG
  zh: '![](img/45c11785-1c42-40f6-9a4d-5dab9bdadb50.png)'
- en: Invocations and duration
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 调用和持续时间
- en: '![](img/6ec83c08-9292-429f-b6c1-dcd95e98e439.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6ec83c08-9292-429f-b6c1-dcd95e98e439.png)'
- en: Errors and Throttles
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 错误和节流
- en: '![](img/f494d4c8-8651-4c69-8d14-7d47ca414b94.png)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f494d4c8-8651-4c69-8d14-7d47ca414b94.png)'
- en: Iterator age and DLQ errors
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 迭代器年龄和DLQ错误
- en: 'Let us understand each of them in detail. The first metric is the Invocations
    metric, which has the time on the *x* axis and the number of invocations of the
    Lambda function on the *y *axis. This metric helps us understand when and how
    many times our Lambda function has been invocated:'
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 让我们逐一详细了解每一个。第一个指标是调用指标，*x*轴上是时间，*y*轴上是Lambda函数的调用次数。该指标帮助我们了解Lambda函数何时以及多少次被调用：
- en: '![](img/97cc9acf-9a68-4bbe-99dc-17d3ef287af2.png)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![](img/97cc9acf-9a68-4bbe-99dc-17d3ef287af2.png)'
- en: 'When you click Jump to Logs, it takes you to the CloudWatch Logs console of
    the Lambda invocations, which looks like this:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 单击“跳转到日志”将带您到Lambda调用的CloudWatch日志控制台，看起来像这样：
- en: '![](img/7ce781ee-0bf6-48a6-b992-eac28a1924db.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7ce781ee-0bf6-48a6-b992-eac28a1924db.png)'
- en: 'And when you click on the Jump to Metrics option, it will take you to the CloudWatch
    Metrics dashboard of that particular metric, which gives you a much more customized
    and granular graph of the same metric, which looks like this:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 当您单击“跳转到指标”选项时，它将带您到该特定指标的CloudWatch指标仪表板，该仪表板为您提供了同一指标的更加定制和细粒度的图表，看起来像这样：
- en: '![](img/87642e50-d03f-4d24-abfe-78bba3540f4f.png)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![](img/87642e50-d03f-4d24-abfe-78bba3540f4f.png)'
- en: 'The second metric in the Lambda''s monitoring dashboard is the Duration metric,
    which tells you the duration of each invocation of our Lambda function. It also
    has time as the *X *axis, and the duration time in the *Y *axis in the unit of
    milliseconds. It also tells you the maximum, average, and the minimum duration
    of your Lambda function over a period of time:'
  id: totrans-107
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Lambda监控仪表板中的第二个指标是持续时间指标，它告诉您每次调用Lambda函数的持续时间。它还将时间作为*X*轴，并以毫秒为单位在*Y*轴上显示持续时间。它还告诉您在一段时间内Lambda函数的最大、平均和最小持续时间：
- en: '![](img/2d2da06d-39b3-420f-b81d-735af4e8f75a.png)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2d2da06d-39b3-420f-b81d-735af4e8f75a.png)'
- en: 'Again, clicking on the Jump to Logs button will take you to the same page as
    that of the previous metric. Clicking on the Jump to Metrics button will take
    you to the CloudWatch metric page of the Duration metric, which looks like this:'
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 再次单击“跳转到日志”按钮将带您到与先前指标相同的页面。单击“跳转到指标”按钮将带您到持续时间指标的CloudWatch指标页面，看起来像这样：
- en: '![](img/b79022ab-c988-4ba6-80d1-dd7a5c4e69ce.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b79022ab-c988-4ba6-80d1-dd7a5c4e69ce.png)'
- en: 'The third metric is the Errors metric, which helps us keep a look out for errors
    in our invocations of the Lambda function. The *Y *axis is the number of errors
    while the *X *axis is the timeline:'
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 第三个指标是错误指标，它帮助我们查看Lambda函数调用中的错误。*Y*轴是错误数量，*X*轴是时间轴：
- en: '![](img/8973a822-31e5-4b64-bbd7-93dac36607b5.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8973a822-31e5-4b64-bbd7-93dac36607b5.png)'
- en: 'The CloudWatch Dashboard of the same metric can be seen by clicking on the
    Jump to Metrics link:'
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 单击“跳转到指标”链接，可以看到相同指标的CloudWatch仪表板：
- en: '![](img/25fa346e-6462-4fe2-a095-99dc0b74e996.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![](img/25fa346e-6462-4fe2-a095-99dc0b74e996.png)'
- en: 'The fourth metric is Throttles. This metric counts the number of times your
    Lambda functions have been throttled, which means the number of times the concurrent
    executions of the functions have breached the set limit of 1,000 per region. We
    won''t encounter this metric very frequently as the Lambda functions which we
    build as examples in this book stay well within the concurrency limits:'
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 第四个指标是节流。这个指标计算了您的Lambda函数被节流的次数，也就是函数的并发执行次数超过了每个区域的设定限制1,000次的次数。我们不会经常遇到这个指标，因为我们在本书中构建的Lambda函数示例都远远低于并发限制：
- en: '![](img/531b1e5a-cf88-4c3f-b9f8-f9bab88de0ef.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![](img/531b1e5a-cf88-4c3f-b9f8-f9bab88de0ef.png)'
- en: 'By clicking on the Jump to Metrics link, we can also see this metric in our
    CloudWatch Metrics dashboard:'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过单击跳转到指标链接，我们还可以在我们的CloudWatch指标仪表板中看到这个指标：
- en: '![](img/c45abd31-7c67-47cb-943d-41607e64ac3f.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c45abd31-7c67-47cb-943d-41607e64ac3f.png)'
- en: 'The fifth metric is the iterator age. This is only valid for functions which
    are triggered by the DynamoDB stream or the Kinesis stream. It gives the age of
    the last record which is processed by the function:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 第五个指标是迭代器年龄。这仅对由DynamoDB流或Kinesis流触发的函数有效。它给出了函数处理的最后一条记录的年龄：
- en: '![](img/1d65a61c-c6c5-49bd-a23c-dd9a014a0b3e.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1d65a61c-c6c5-49bd-a23c-dd9a014a0b3e.png)'
- en: 'The Jump to Metrics link takes you to the CloudWatch Metrics dashboard of this
    metric:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 跳转到指标链接将带您到此指标的CloudWatch指标仪表板：
- en: '![](img/335da45d-9628-435e-b9db-b7c9a5c6d562.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](img/335da45d-9628-435e-b9db-b7c9a5c6d562.png)'
- en: 'The sixth and the last metric is the DLQ errors metric. This gives the number
    of errors that occurred while sending messages (failed event payloads) to a dead
    letter queue. Most often the errors would be caused due to faulty permission configurations
    and timeouts:'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 第六个也是最后一个指标是DLQ错误指标。这给出了在将消息（失败的事件负载）发送到死信队列时发生的错误数量。大多数情况下，错误是由于故障的权限配置和超时引起的：
- en: '![](img/089213e4-6e0e-4b56-aa5e-56af3eb17f52.png)'
  id: totrans-124
  prefs: []
  type: TYPE_IMG
  zh: '![](img/089213e4-6e0e-4b56-aa5e-56af3eb17f52.png)'
- en: 'The Jump to Metrics link will take you to the CloudWatch Metrics dashboard
    of the same metric:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 单击跳转到指标链接将带您到相同指标的CloudWatch指标仪表板：
- en: '![](img/062ee619-3b95-4949-85b3-054c50481d1e.png)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![](img/062ee619-3b95-4949-85b3-054c50481d1e.png)'
- en: Lambda's logs in CloudWatch
  id: totrans-127
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: CloudWatch中的Lambda日志
- en: 'So far, we have learned about and understood the metrics of AWS Lambda in great
    detail. Now, we will move on to understanding the logs of the Lambda functions.
    As always, we will try to understand them via the following steps:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经非常详细地了解了AWS Lambda的指标。现在，我们将继续了解Lambda函数的日志。与往常一样，我们将尝试通过以下步骤来理解它们：
- en: Logs for AWS Lambda functions are stored in CloudWatch's Logs service. You can
    access the CloudWatch Logs service by going to the Logs dashboard by clicking
    on the main CloudWatch dashboard.
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS Lambda函数的日志存储在CloudWatch的日志服务中。您可以通过单击主CloudWatch仪表板上的日志仪表板来访问CloudWatch日志服务。
- en: 'When you click on the logs of the serverless-api, /aws/lambda/serverless-api,
    in the list, we go to the log stream of the serverless API, which looks like this:'
  id: totrans-130
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当您单击服务器端API的日志，/aws/lambda/serverless-api，在列表中，我们转到无服务器API的日志流，它看起来像这样：
- en: '![](img/40d6b9b7-3963-428a-8659-c65aace1b751.png)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![](img/40d6b9b7-3963-428a-8659-c65aace1b751.png)'
- en: 'Each log stream here is a Lambda invocation. So, whenever your Lambda function
    is invoked, it creates a new log stream here. If the invocation is a part of Lambda''s
    retry process, then the logs for that particular invocation will be written under
    the most recent log stream. A single log stream can contain several details. But
    firstly, let us look at what a particular log stream looks like:'
  id: totrans-132
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 这里的每个日志流都是一个Lambda调用。因此，每当您的Lambda函数被调用时，它都会在这里创建一个新的日志流。如果调用是Lambda的重试过程的一部分，那么该特定调用的日志将被写入最近的日志流下。单个日志流可以包含多个细节。但首先，让我们看看特定的日志流是什么样子的：
- en: '![](img/9b532fda-5179-4224-bb3b-8b3368ae8fba.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9b532fda-5179-4224-bb3b-8b3368ae8fba.png)'
- en: 'Also, if you look closely, you can observe that Lambda''s logs also give out
    information about the duration of the Lambda function''s invocation, the duration
    for which it is billed for, and also the memory used by the function. These metrics
    help in understanding our functions'' performance better and for further optimization
    and fine tuning:'
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 此外，如果您仔细观察，您会发现Lambda的日志还提供有关Lambda函数调用的持续时间、计费持续时间以及函数使用的内存的信息。这些指标有助于更好地了解我们函数的性能，并进行进一步的优化和微调：
- en: '![](img/5737c445-d61e-4dfe-9c50-06eb9be58965.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5737c445-d61e-4dfe-9c50-06eb9be58965.png)'
- en: 'There are several columns in CloudWatch Logs for you to select from, which
    are not shown in the preceding screenshots. These are the available options:'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: CloudWatch日志中有几列可供选择，这些列在前面的截图中没有显示。这些是可用选项：
- en: '![](img/b8580207-9fe8-444e-aa6b-7b34ee5e997e.png)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b8580207-9fe8-444e-aa6b-7b34ee5e997e.png)'
- en: 'So, when you select more of those, you will see them in your dashboard as columns.
    These come in handy when you''re doing a much more fine-grained debugging of our
    Lambda functions:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，当您选择更多的选项时，您将在仪表板中看到它们作为列。当您对我们的Lambda函数进行更精细的调试时，这些选项非常有用：
- en: '![](img/613ad444-0922-42a9-bf3b-43c226ad3014.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![](img/613ad444-0922-42a9-bf3b-43c226ad3014.png)'
- en: Logging statements in Lambda
  id: totrans-140
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Lambda中的日志记录语句
- en: 'Logging your comments and errors clearly is always a good software practice.
    So, we shall now understand how to log from inside of Lambda functions. There
    are broadly two ways of logging inside Lambda functions. We shall now learn and
    understand them via examples from the following steps:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 清楚地记录您的评论和错误始终是一个良好的软件实践。因此，我们现在将了解如何从Lambda函数内部记录日志。在Lambda函数内部记录日志有两种广泛的方法。我们现在将通过以下步骤的示例来学习和理解它们：
- en: 'The first way is to use Python''s `logging` library. This is widely used as
    a standard practice for logging in Python scripts. We shall edit the code we have
    written previously for the serverless API and add in the logging statements in
    it. The code will look like this:'
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 第一种方法是使用Python的`logging`库。这在Python脚本中作为标准的日志记录实践被广泛使用。我们将编辑之前为无服务器API编写的代码，并在其中添加日志记录语句。代码将如下所示：
- en: '![](img/efddfce9-0f57-47c1-b818-f2e354229456.png)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![](img/efddfce9-0f57-47c1-b818-f2e354229456.png)'
- en: 'The code which is in the preceding screenshot is as follows:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的截图中的代码如下：
- en: '[PRE0]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Now, when you run the Lambda function after saving, you can see a successful
    execution statement in green color, which looks like this:'
  id: totrans-146
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，当您保存后运行Lambda函数，您可以看到一个绿色的成功执行语句，看起来像这样：
- en: '![](img/947377e1-12e7-4197-844a-9f7433a0a6b6.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![](img/947377e1-12e7-4197-844a-9f7433a0a6b6.png)'
- en: 'When you click on the Details option, you can see the logging statements being
    executed clearly:'
  id: totrans-148
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当您点击“详细”选项时，您可以清楚地看到执行日志语句：
- en: '![](img/dac4ea52-e0f2-4246-8c51-aaedc2db9558.png)'
  id: totrans-149
  prefs: []
  type: TYPE_IMG
  zh: '![](img/dac4ea52-e0f2-4246-8c51-aaedc2db9558.png)'
- en: 'The next way of logging statements is by simply using the `print` statements
    in Python. It is the most common way of printing out logging statements in Python
    scripts. So, we shall add a `Hello from Lambda` print statement in our function
    code and see if we get the logs in our Lambda execution or not:'
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 记录语句的下一种方式是简单地在Python中使用`print`语句。这是在Python脚本中打印日志语句的最常见方式。因此，我们将在我们的函数代码中添加一个`Hello
    from Lambda`的打印语句，看看我们是否在Lambda执行中获得日志：
- en: '![](img/bfdb14b4-bbaf-4f5f-b5e1-ddef710ef470.png)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![](img/bfdb14b4-bbaf-4f5f-b5e1-ddef710ef470.png)'
- en: 'The code for this Lambda function is as follows:'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 此Lambda函数的代码如下：
- en: '[PRE1]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'When we click on Test for executing the code, we should see a green color message,
    which indicates a successful execution:'
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 当我们点击“测试”来执行代码时，我们应该看到一个绿色的消息，表示成功执行：
- en: '![](img/935ec9df-157e-478f-8eae-ca699d5d7b0c.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![](img/935ec9df-157e-478f-8eae-ca699d5d7b0c.png)'
- en: 'Again, just like we did previously, clicking on the Details toggle will give
    you the complete execution logs:'
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 同样，就像之前所做的那样，点击“详细”切换将给您完整的执行日志：
- en: '![](img/912656a0-9fa1-4946-a70d-0989ce6f2563.png)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![](img/912656a0-9fa1-4946-a70d-0989ce6f2563.png)'
- en: We can see the `Hello from Lambda` message too. Out of the two available logging
    options for our Lambda functions, it is always preferable to use the first option
    which is via the Python's logging module. This is because that module gives greater
    flexibility and helps you differentiate between info, error, and debug logs.
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们也可以看到`Hello from Lambda`的消息。对于我们的Lambda函数有两种可用的日志记录选项，始终最好使用第一种选项，即通过Python的日志记录模块。这是因为该模块提供了更大的灵活性，并帮助您区分信息、错误和调试日志。
- en: Summary
  id: totrans-159
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we have learned about the monitoring and the logging capabilities
    of AWS. We also learned about the available monitoring and logging tools inside
    the AWS environment. We have also learned how to monitor our Lambda functions
    and how to set up logging for our Lambda functions.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们已经了解了AWS的监控和日志记录功能。我们还了解了AWS环境中可用的监控和日志记录工具。我们还学习了如何监控我们的Lambda函数以及如何为我们的Lambda函数设置日志记录。
- en: We have learned about the logging and monitoring practices that are followed
    by the industry and the various ways one can log statements in Python from inside
    of a Lambda function.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经了解了行业遵循的日志记录和监控实践，以及在Lambda函数内部记录语句的各种方式。
- en: In the next chapter, we will learn how to scale up our serverless architectures
    to become distributed and to be able to handle massive workloads while still preserving
    the positives of a serverless setup.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将学习如何扩展我们的无服务器架构，使其变得分布式，并能够处理大规模的工作负载，同时仍然保留无服务器设置的优点。
