- en: '7'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '7'
- en: Monitoring Applications via CloudWatch
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 通过CloudWatch监控应用程序
- en: In this chapter, we are going to learn about one of the important AWS services,
    CloudWatch. CloudWatch is a serverless service that allows you to collect and
    monitor application logs within AWS. It has extensive integrations with most AWS
    services. When you start using any AWS service, it helps to observe an application
    via CloudWatch tools.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将学习AWS的一个重要服务之一，CloudWatch。CloudWatch是一个无服务器服务，允许你在AWS内部收集和监控应用程序日志。它与大多数AWS服务有广泛的集成。当你开始使用任何AWS服务时，它有助于通过CloudWatch工具观察应用程序。
- en: 'In this chapter, we are going to cover the following topics:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下主题：
- en: What is CloudWatch?
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 什么是CloudWatch？
- en: Collecting Lambda Logs via CloudWatch
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过CloudWatch收集Lambda日志
- en: CloudWatch logs Insights
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CloudWatch日志洞察
- en: CloudWatch alarms
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: CloudWatch警报
- en: What is CloudWatch?
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 什么是CloudWatch？
- en: When you deploy any application, it is important to track that it meets the
    set expectations regarding availability, performance, and stability. It is possible
    an issue may have occurred in the application. It’s important to note that some
    of the AWS services could be down or run incorrectly. This is a very bad experience
    from a customer’s point of view, and it would be better to observe these issues
    before the customer finds out. If you service an application via AWS, you need
    to use CloudWatch to monitor your applications to observe how they behave.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 当你部署任何应用程序时，跟踪它是否满足关于可用性、性能和稳定性的预期是很重要的。可能应用程序中发生了问题。重要的是要注意，一些AWS服务可能处于关闭状态或运行不正确。从客户的角度来看，这是一个非常糟糕的体验，最好在客户发现这些问题之前观察这些问题。如果你通过AWS服务维护应用程序，你需要使用CloudWatch来监控你的应用程序以观察它们的行为。
- en: 'CloudWatch is a monitoring service in AWS; it provides different features to
    observe an application. The features of CloudWatch are as follows:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: CloudWatch是AWS的一个监控服务；它提供了不同的功能来观察应用程序。CloudWatch的功能如下：
- en: Collecting and storing logs from AWS services such as Lambda and EC2.
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从Lambda和EC2等AWS服务收集和存储日志。
- en: Providing a dashboard to monitor metrics and logs.
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提供一个仪表板来监控指标和日志。
- en: The ability to create an alarm. For example, if an application has consumed
    significant memory on a server, you can create an alarm in order to be notified.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建警报的能力。例如，如果一个应用程序在服务器上消耗了大量的内存，你可以创建一个警报以便被通知。
- en: The ability to correlate different metrics. For example, you can aggregate EC2
    memory logs and CPU logs to have a better overall view of a situation.
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关联不同指标的能力。例如，你可以聚合EC2内存日志和CPU日志，以获得更好的整体情况视图。
- en: The detection of anomalous behavior with the machine learning-based CloudWatch
    anomaly detection feature.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 利用基于机器学习的CloudWatch异常检测功能检测异常行为。
- en: Collecting Lambda logs via CloudWatch
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 通过CloudWatch收集Lambda日志
- en: 'In this topic, we are going to deploy a simple Python function in order to
    investigate logs via the CloudWatch service. Let’s do so step by step:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个主题中，我们将部署一个简单的Python函数，以便通过CloudWatch服务调查日志。让我们一步一步来做：
- en: 'Create a Lambda function in AWS. In [*Chapter 3*](B19195_03.xhtml#_idTextAnchor002),
    where we covered Lambda, the basic steps of the Lambda deployment were explained.
    Hence, here, we will provide a summary of the Lambda steps. The name of the Lambda
    function is `TestLogs`:'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在AWS中创建一个Lambda函数。在[*第3章*](B19195_03.xhtml#_idTextAnchor002)，我们介绍了Lambda，Lambda部署的基本步骤被解释了。因此，在这里，我们将提供Lambda步骤的摘要。Lambda函数的名称是`TestLogs`：
- en: '![](img/Figure_7.01_B19195.jpg)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/Figure_7.01_B19195.jpg)'
- en: Figure 7.1 – Creating a Lambda function
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.1 – 创建Lambda函数
- en: 'The Lambda function creates a basic template, like the following:'
  id: totrans-21
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Lambda函数创建了一个基本模板，如下所示：
- en: '![](img/Figure_7.02_B19195.jpg)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/Figure_7.02_B19195.jpg)'
- en: Figure 7.2 – The Lambda template
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.2 – Lambda模板
- en: 'Copy the following code block to the handler:'
  id: totrans-24
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将以下代码块复制到处理器：
- en: '[PRE0]'
  id: totrans-25
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '`os` will import the operating system module; hence, you can see the environment
    variables via the logging print (`os.environ`) variable. Once we add the code
    block, Lambda code should be seen as follows:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '`os`将导入操作系统模块；因此，你可以通过日志打印(`os.environ`)变量查看环境变量。一旦我们添加了代码块，Lambda代码应该如下所示：'
- en: '![](img/Figure_7.03_B19195.jpg)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/Figure_7.03_B19195.jpg)'
- en: Figure 7.3 – Lambda with logs
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.3 – 带日志的Lambda
- en: 'Next, click the **Deploy** button to deploy the latest changes to Lambda and
    click the **Test** button. After testing the Lambda function, you are able to
    see the execution results:'
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 接下来，点击**部署**按钮将最新的更改部署到Lambda，并点击**测试**按钮。在测试Lambda函数后，你能够看到执行结果：
- en: '![](img/Figure_7.04_B19195.jpg)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/Figure_7.04_B19195.jpg)'
- en: Figure 7.4 – The execution results
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.4 – 执行结果
- en: 'Let’s use the CloudWatch service to investigate the logs:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们使用CloudWatch服务来调查日志：
- en: 'Open the CloudWatch service from AWS Management Console:'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从AWS管理控制台打开CloudWatch服务：
- en: '![](img/Figure_7.05_B19195.jpg)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.05_B19195.jpg)'
- en: Figure 7.5 – The CloudWatch service
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.5 – CloudWatch服务
- en: 'Click **Log groups** under the **Logs** dropdown in the left pane:'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左侧面板的 **日志** 下拉菜单中点击 **日志组**：
- en: '![](img/Figure_7.06_B19195.jpg)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.06_B19195.jpg)'
- en: Figure 7.6 – The CloudWatch log group
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.6 – CloudWatch 日志组
- en: 'Once you click **Log groups**, you will see a list. This list represents the
    running AWS services that create a log. In this list, find the Lambda function
    that you run:'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦点击 **日志组**，你将看到一个列表。这个列表代表了创建日志的运行中的AWS服务。在这个列表中，找到你运行的Lambda函数：
- en: '![](img/Figure_7.07_B19195.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.07_B19195.jpg)'
- en: Figure 7.7 – Log list
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.7 – 日志列表
- en: 'Click **/aws/lambda/TestLogs**. The new page consists of the logs that Lambda
    creates. You can see a log stream. When the Lambda function runs, the logs are
    created in this list. At the beginning of the list, you can see the most up-to-date
    logs:'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **/aws/lambda/TestLogs**。新页面包含Lambda创建的日志。你可以看到一个日志流。当Lambda函数运行时，日志将创建在这个列表中。列表的顶部，你可以看到最新的日志：
- en: '![](img/Figure_7.08_B19195.jpg)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.08_B19195.jpg)'
- en: Figure 7.8 – The log page for Lambda
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.8 – Lambda的日志页面
- en: 'Let’s click the latest link under **Log stream**:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们点击 **日志流** 下的最新链接：
- en: '![](img/Figure_7.09_B19195.jpg)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.09_B19195.jpg)'
- en: Figure 7.9 – Log stream
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.9 – 日志流
- en: 'After clicking the link, you can see the detailed logs that Lambda creates:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 点击链接后，你可以看到Lambda创建的详细日志：
- en: '![](img/Figure_7.10_B19195.jpg)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.10_B19195.jpg)'
- en: Figure 7.10 – Lambda logs
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.10 – Lambda日志
- en: 'This list shows a summary view of the log. When you click the down arrow to
    the left, the panel will open and you can investigate the detailed logs. In Lambda,
    we have logged the operating system variables for Lambda. Hence, you will see
    some details for that, such as region, memory size, and language:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 这个列表显示了日志的概览。当你点击左侧的向下箭头时，面板将展开，你可以调查详细的日志。在Lambda中，我们已经记录了Lambda的操作系统变量。因此，你会看到一些详细信息，例如区域、内存大小和语言：
- en: '![](img/Figure_7.11_B19195.jpg)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.11_B19195.jpg)'
- en: Figure 7.11 – Log details
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.11 – 日志详情
- en: Congratulations! You are able to investigate Lambda logs via the CloudWatch
    service. It is simple to use CloudWatch to investigate a log for any AWS service.
    In the next topic, we will learn some tricks regarding filtering logs.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！你现在可以通过CloudWatch服务调查Lambda日志了。使用CloudWatch调查任何AWS服务的日志都非常简单。在下一个主题中，我们将学习一些关于过滤日志的小技巧。
- en: CloudWatch Log Insights
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: CloudWatch 日志洞察
- en: 'In this topic, we will take a look at **Log Insights**. If you have massive
    lines of logs, it is not easy to search and find the respective log that you are
    searching for. For this use case, Log Insights comes into play. CloudWatch Log
    Insights allows you to search logs with the filtering feature. Let’s see how Log
    Insights helps us to search logs:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个主题中，我们将查看 **日志洞察**。如果你有大量的日志行，搜索和找到你正在寻找的相应日志并不容易。对于这个用例，日志洞察就派上用场了。CloudWatch
    日志洞察允许你使用过滤功能搜索日志。让我们看看日志洞察如何帮助我们搜索日志：
- en: 'Click **Log Insights** under the **Logs** dropdown in the left pane:'
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在左侧面板的 **日志** 下拉菜单中点击 **日志洞察**：
- en: '![](img/Figure_7.12_B19195.jpg)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.12_B19195.jpg)'
- en: Figure 7.12 – Log Insights
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.12 – 日志洞察
- en: 'Select the log that you want to investigate. In the previous example, we ran
    the TestLogs Lambda function, and I am also selecting that one here:'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择你想要调查的日志。在上一个示例中，我们运行了TestLogs Lambda函数，我这里也选择了那个：
- en: '![](img/Figure_7.13_B19195.jpg)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.13_B19195.jpg)'
- en: Figure 7.13 – The Log Insights window
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.13 – 日志洞察窗口
- en: 'Once you select it, you can see the default query:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦选择，你就可以看到默认的查询：
- en: '![](img/Figure_7.14_B19195.jpg)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.14_B19195.jpg)'
- en: Figure 7.14 – The Log Insights filter
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.14 – 日志洞察过滤器
- en: 'Click the `fields` represents the columns that will be listed, whereas the
    `sort` keyword indicates the sorting method, and you can see only 20 records with
    the `limit` keyword:'
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 `fields` 表示将要列出的列，而 `sort` 关键字表示排序方法，你可以使用 `limit` 关键字只查看20条记录：
- en: '![](img/Figure_7.15_B19195.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.15_B19195.jpg)'
- en: Figure 7.15 – Logs
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图7.15 – 日志
- en: 'Let’s add one more filter to search for a keyword within the message. You can
    use the following query format:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在消息中添加一个额外的过滤器来搜索关键词。你可以使用以下查询格式：
- en: '[PRE1]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'With this query, we search for logs that contain `AWS_DEFAULT_REGION`. Paste
    that and click **Run query** again. After running the query, you will see that
    the message lines are reduced:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 使用此查询，我们搜索包含 `AWS_DEFAULT_REGION` 的日志。粘贴并再次点击 **运行查询**。查询运行后，您将看到消息行减少：
- en: '![](img/Figure_7.16_B19195.jpg)'
  id: totrans-72
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.16_B19195.jpg)'
- en: Figure 7.16 – Filtered logs
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.16 – 过滤后的日志
- en: 'When you expand the message, you will find what you searched for – in this
    case, `AWS_DEFAULT_REGION`:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 当您展开消息时，您将找到您要查找的内容——在本例中是 `AWS_DEFAULT_REGION`：
- en: '![](img/Figure_7.17_B19195.jpg)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.17_B19195.jpg)'
- en: Figure 7.17 – Detailed logs
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.17 – 详细日志
- en: As you can see, Log Insights is very helpful to search and filter logs within
    a massive log block. In the next topic, we will take a look at how to create an
    alarm.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，日志洞察功能在搜索和过滤大量日志块中的日志方面非常有帮助。在下一个主题中，我们将探讨如何创建一个警报。
- en: CloudWatch alarms
  id: totrans-78
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: CloudWatch警报
- en: AWS has more than 100 services, and it is not easy to control the behavior of
    all the services. You need to be informed if some AWS services achieve a specific
    metric. In [*Chapter 4*](B19195_04.xhtml#_idTextAnchor006), we covered how to
    create a server with an EC2 service. For example, you define a server for an EC2
    service, and sometimes, its CPU usage is more than 90%, causing some performance
    problems. Another example would be to add a notification if you exceed a specific
    cost in AWS. For these kinds of scenarios, you can define a metric, and if the
    metric is reached, you will be notified via email.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: AWS拥有超过100个服务，控制所有服务的行为了解起来并不容易。如果您的一些AWS服务达到特定的指标，您需要得到通知。在[*第4章*](B19195_04.xhtml#_idTextAnchor006)中，我们介绍了如何使用EC2服务创建服务器。例如，您为EC2服务定义了一个服务器，有时其CPU使用率会超过90%，导致一些性能问题。另一个例子是，如果您在AWS中超过特定成本，可以添加通知。对于这类场景，您可以定义一个指标，如果达到该指标，您将通过电子邮件收到通知。
- en: 'In this topic, we are going to create an alarm to notify us if AWS cost exceeds
    $10 in a month. Let’s implement the application:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个主题中，我们将创建一个警报，以在一个月内AWS成本超过10美元时通知我们。让我们实现这个应用程序：
- en: 'Click **In alarm** under the **Alarms** dropdown in the **CloudWatch** pane:'
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在 **CloudWatch** 窗格下的 **警报** 下拉菜单中点击 **在警报中**：
- en: '![](img/Figure_7.18_B19195.jpg)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.18_B19195.jpg)'
- en: Figure 7.18 – In alarm
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.18 – 在警报中
- en: 'Click **Create Alarm**. You can click either the button to the right or the
    one at the bottom:'
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **创建警报**。您可以选择右侧或底部的按钮：
- en: '![](img/Figure_7.19_B19195.jpg)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.19_B19195.jpg)'
- en: Figure 7.19 – Creating an alarm
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.19 – 创建警报
- en: 'Click the **Select** **metric** button:'
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **选择指标** 按钮：
- en: '![](img/Figure_7.20_B19195.jpg)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.20_B19195.jpg)'
- en: Figure 7.20 – Select metric
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.20 – 选择指标
- en: 'Once you click the **Select metric** button, you will be able to see a list
    of categories with which to narrow down your metric:'
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦您点击 **选择指标** 按钮，您将能够看到一系列用于缩小指标范围的类别：
- en: '![](img/Figure_7.21_B19195.jpg)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.21_B19195.jpg)'
- en: Figure 7.21 – Metric types
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.21 – 指标类型
- en: 'In this list, you can see different types of metrics. **Billing** allows you
    to define cost-related metrics, while **Lambda** allows you to define Lambda-related
    metrics. In this example, we are going to define a monthly budget for our AWS
    account. The aim is to receive an alarm if our monthly cost exceeds a specific
    threshold:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 在此列表中，您可以查看不同类型的指标。**计费**允许您定义与成本相关的指标，而**Lambda**允许您定义与Lambda相关的指标。在这个例子中，我们将为我们的AWS账户定义一个月度预算。目标是如果我们的月度成本超过特定阈值，则接收警报：
- en: 'Click **Billing** from the categories:'
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从类别中选择 **计费**：
- en: '![](img/Figure_7.22_B19195.jpg)'
  id: totrans-95
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.22_B19195.jpg)'
- en: Figure 7.22 – The Billing category
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.22 – 计费类别
- en: 'Click **Total Estimated Charge**. The intention is to define a metric if your
    total monthly AWS cost exceeds a target budget:'
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击 **总估计费用**。目的是如果您的总月度AWS成本超过目标预算，则定义一个指标：
- en: '![](img/Figure_7.23_B19195.jpg)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.23_B19195.jpg)'
- en: Figure 7.23 – Total Estimated Change
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.23 – 总估计变化
- en: 'From the list, select **USD** and click **Select metric**. The currency type
    may vary, depending on your AWS account:'
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从列表中选择 **USD** 并点击 **选择指标**。货币类型可能因您的AWS账户而异：
- en: '![](img/Figure_7.24_B19195.jpg)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![](img/Figure_7.24_B19195.jpg)'
- en: Figure 7.24 – The currency type
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.24 – 货币类型
- en: 'On the next screen, go to the **Define the threshold value** field. For this
    example, I added **10**, which means that if the total cost is greater than $10
    for a month, an alarm will be activated. In this panel, you can also change the
    currency type, calculation type, and so on. In this case, the most important value
    is defining the target budget to receive an alarm. After you have done that, click
    the **Next** button:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一屏幕上，转到**定义阈值值**字段。对于此示例，我添加了**10**，这意味着如果一个月的总成本超过 10 美元，则会激活警报。在此面板中，您还可以更改货币类型、计算类型等。在这种情况下，最重要的值是定义目标预算以接收警报。完成此操作后，点击**下一步**按钮：
- en: '![](img/Figure_7.25_B19195.jpg)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/Figure_7.25_B19195.jpg)'
- en: Figure 7.25 – Threshold value
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.25 – 阈值值
- en: 'In the next panel, we are going to define the alarm endpoint. In this case,
    we have selected the **Create new topic** radio button. **Simple Notification
    Service** (**SNS**) is used to communicate between services and end users. This
    is a choice under **Send a notification to the following SNS**. Once we select
    **Create new topic**, we can define an email address in the **Email endpoints
    that will receive the notification…** section. SNS is an access point to filter
    messages in order to send them to different subscribers such as Lambda or email.
    You can keep the topic name as is; it is the same as the SNS topic name. When
    completed, click **Create topic**:'
  id: totrans-106
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在下一面板中，我们将定义警报端点。在这种情况下，我们选择了**创建新主题**单选按钮。**简单通知服务**（**SNS**）用于在服务和最终用户之间进行通信。这是在**发送通知到以下
    SNS**下的一个选择。一旦我们选择**创建新主题**，我们就可以在**以下电子邮件端点将接收通知…**部分定义一个电子邮件地址。SNS 是一个访问点，用于过滤消息以便将它们发送到不同的订阅者，如
    Lambda 或电子邮件。您可以保留主题名称不变；它与 SNS 主题名称相同。完成操作后，点击**创建主题**：
- en: '![](img/Figure_7.26_B19195.jpg)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/Figure_7.26_B19195.jpg)'
- en: Figure 7.26 – Receiver
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.26 – 接收器
- en: 'After **Create topic** is clicked, AWS will create an endpoint in order to
    send an email:'
  id: totrans-109
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击**创建主题**后，AWS 将创建一个端点以发送电子邮件：
- en: '![](img/Figure_7.27_B19195.jpg)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/Figure_7.27_B19195.jpg)'
- en: Figure 7.27 – Creating an endpoint
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.27 – 创建端点
- en: Now, you have an endpoint, and you can proceed by clicking the **Next** button.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您有一个端点，可以通过点击**下一步**按钮继续操作。
- en: 'The next step is to define the alarm name. In this case, I named it `BillingAlarmGreaterThan10`,
    since it sends an alarm if the billing cost goes above than $10:'
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步是定义警报名称。在这种情况下，我将其命名为`BillingAlarmGreaterThan10`，因为如果计费成本超过 10 美元，则会发送警报：
- en: '![](img/Figure_7.28_B19195.jpg)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/Figure_7.28_B19195.jpg)'
- en: Figure 7.28 – Naming the alarm
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.28 – 命名警报
- en: 'The next step is to review the input and click **Create alarm**:'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步是检查输入并点击**创建警报**：
- en: '![](img/Figure_7.29_B19195.jpg)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/Figure_7.29_B19195.jpg)'
- en: Figure 7.29 – Creating the alarm
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.29 – 创建警报
- en: 'If you successfully create the alarm, you will be redirected to the **Alarm**
    list to see the alarm that you created. We can see the alarm as follows:'
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 如果您成功创建了警报，您将被重定向到**警报**列表以查看您创建的警报。我们可以如下查看警报：
- en: '![](img/Figure_7.30_B19195.jpg)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![图片](img/Figure_7.30_B19195.jpg)'
- en: Figure 7.30 – The billing alarm type
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7.30 – 计费警报类型
- en: In this topic, we have created an alarm. An alarm is useful if we need to create
    a notification for the AWS service behaviors. This example will send a notification
    if, for example, we reach the defined cost limit.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 在本主题中，我们创建了一个警报。如果需要为 AWS 服务行为创建通知，警报非常有用。此示例将在达到定义的成本限制时发送通知。
- en: Summary
  id: totrans-123
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we learned about the AWS CloudWatch service and how to investigate
    service logs in AWS. CloudWatch is very useful for logging; it also allows you
    to define some metrics and alarms to monitor services. In the following chapter,
    we will take a look at database operations within AWS.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们学习了 AWS CloudWatch 服务以及如何在 AWS 中调查服务日志。CloudWatch 对于日志记录非常有用；它还允许您定义一些指标和警报以监控服务。在下一章中，我们将查看
    AWS 中的数据库操作。
